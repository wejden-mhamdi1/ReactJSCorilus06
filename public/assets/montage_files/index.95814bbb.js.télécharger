var e,t=Object.defineProperty,a=(e,a,o)=>(((e,a,o)=>{a in e?t(e,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[a]=o})(e,"symbol"!=typeof a?a+"":a,o),o);import{_ as o,R as n,r,a as i,l as s,M as l,b as d,c,d as u,e as m,f as p,g as h,h as g,v as y,u as f,C as E,i as v,j as w,k as b,m as _,s as T,n as S,o as I,p as x,q as k,t as C,w as A,x as N,y as P,D as R,z as L,A as D,B as O,E as F,F as M,G as U,H as B,I as W,J as V,K as j,L as G,N as H,O as z,P as $,Q as K,S as Y,T as q,U as X,V as J,W as Q,X as Z,Y as ee,Z as te,$ as ae,a0 as oe,a1 as ne,a2 as re,a3 as ie,a4 as se,a5 as le,a6 as de,a7 as ce,a8 as ue,a9 as me,aa as pe,ab as he,ac as ge,ad as ye,ae as fe,af as Ee,ag as ve,ah as we,ai as be,aj as _e,ak as Te,al as Se,am as Ie,an as xe,ao as ke,ap as Ce,aq as Ae,ar as Ne,as as Pe,at as Re,au as Le,av as De,aw as Oe,ax as Fe,ay as Me,az as Ue,aA as Be,aB as We,aC as Ve,aD as je,aE as Ge,aF as He,aG as ze,aH as $e,aI as Ke,aJ as Ye,aK as qe,aL as Xe,aM as Je,aN as Qe,aO as Ze,aP as et,aQ as tt,aR as at,aS as ot,aT as nt,aU as rt,aV as it,aW as st,aX as lt,aY as dt,aZ as ct,a_ as ut,a$ as mt,b0 as pt,b1 as ht,b2 as gt,b3 as yt,b4 as ft,b5 as Et,b6 as vt,b7 as wt,b8 as bt,b9 as _t,ba as Tt,bb as St,bc as It,bd as xt,be as kt,bf as Ct,bg as At,bh as Nt,bi as Pt,bj as Rt,bk as Lt,bl as Dt,bm as Ot,bn as Ft,bo as Mt,bp as Ut,bq as Bt,br as Wt,bs as Vt,bt as jt,bu as Gt,bv as Ht,bw as zt,bx as $t,by as Kt,bz as Yt,bA as qt,bB as Xt,bC as Jt,bD as Qt,bE as Zt,bF as ea,bG as ta,bH as aa,bI as oa,bJ as na,bK as ra,bL as ia,bM as sa,bN as la,bO as da,bP as ca,bQ as ua,bR as ma,bS as pa,bT as ha,bU as ga,bV as ya,bW as fa,bX as Ea,bY as va,bZ as wa,b_ as ba,b$ as _a,c0 as Ta,c1 as Sa,c2 as Ia,c3 as xa,c4 as ka,c5 as Ca,c6 as Aa,c7 as Na,c8 as Pa,c9 as Ra,ca as La,cb as Da,cc as Oa,cd as Fa,ce as Ma,cf as Ua,cg as Ba,ch as Wa,ci as Va,cj as ja,ck as Ga,cl as Ha,cm as za,cn as $a,co as Ka,cp as Ya,cq as qa,cr as Xa,cs as Ja,ct as Qa,cu as Za,cv as eo,cw as to,cx as ao,cy as oo,cz as no,cA as ro,cB as io,cC as so,cD as lo,cE as co,cF as uo,cG as mo,cH as po,cI as ho,cJ as go,cK as yo,cL as fo,cM as Eo,cN as vo,cO as wo,cP as bo,cQ as _o,cR as To,cS as So,cT as Io,cU as xo,cV as ko,cW as Co,cX as Ao,cY as No,cZ as Po,c_ as Ro,c$ as Lo,d0 as Do,d1 as Oo,d2 as Fo,d3 as Mo,d4 as Uo,d5 as Bo,d6 as Wo,d7 as Vo,d8 as jo,d9 as Go,da as Ho}from"./vendor.96643be6.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();let zo=!1;const $o=new Set,Ko=e=>zo?(e(),()=>{}):($o.add(e),()=>{zo||$o.delete(e)});class Yo extends EventTarget{constructor(){super(...arguments),a(this,"totals",new Map),a(this,"eventThrottle")}forceUpdate(){const e=new CustomEvent("update");this.dispatchEvent(e)}dispatchUpdate(){this.eventThrottle||(this.eventThrottle=setInterval((()=>this.forceUpdate()),100))}clear(){this.totals=new Map,this.forceUpdate()}getSortedCategories(){this.totals=new Map([...this.totals].sort(((e,t)=>"uncategorized"===e[0]?-1:"uncategorized"===t[0]?1:t[1].total.time-e[1].total.time)));for(const[e,t]of this.totals)t.totalByKey=new Map([...t.totalByKey].sort(((e,t)=>t[1].time-e[1].time)));return this.totals}push(e){const t=e.labels.join(".");if(this.totals.has(e.category)){const a=this.totals.get(e.category);if(a.total.time+=e.time,a.total.hits+=e.hits,a.totalByKey.has(t)){const o=a.totalByKey.get(t);o.time+=e.time,o.hits+=e.hits}else a.totalByKey.set(t,{time:e.time,hits:e.hits})}else{const a={time:e.time,hits:e.hits};this.totals.set(e.category,{total:a,totalByKey:new Map([[t,{...a}]])})}this.dispatchUpdate()}}const qo=new Yo,Xo=(e,t,a)=>{function o(...o){const n=performance.now(),r=a.apply(this,o),i=()=>{const a=performance.now();qo.push({category:e,labels:t,time:a-n,hits:1})};return r instanceof Promise?r.then((e=>(i(),e))):(i(),r)}return o.displayName=`profiled(${a.name})`,o},Jo=WebSocket.prototype.send;let Qo=0;Ko((()=>{WebSocket.prototype.send=function(...e){return Qo+=1,Jo.apply(this,e)}}));let Zo=null;try{Zo="undefined"!=typeof window?o():null}catch(YEe){console.error(YEe)}Zo&&Zo.listen((e=>{n.pageview(e.pathname)}));const en=Zo;function tn(){if(!globalThis.globalStore)throw new Error("No Global Store Available");const e=globalThis.globalStore,t=e.dispatch,a=e.getState();return{dispatch:t,history:en,get layers(){return function(e){let t=[];const{scenes:a}=e||{};if(a)for(const o of a)t=[...t,...o.layers];return t}(a.studio)},state:a,store:e,subscribe:e.subscribe}}function an(e){n.event({category:e,action:e,label:e})}var on=(e=>(e.Email="email",e.InApp="inApp",e))(on||{}),nn=(e=>(e.Export="export",e.Invite="invite",e.Comment="comment",e.Request="request",e.Scheduled="scheduled",e.Joined="joined",e.Welcome="welcome",e))(nn||{}),rn=(e=>(e.unsent="unsent",e.sent="sent",e.read="read",e))(rn||{}),sn=(e=>(e.project="project",e.folder="folder",e.team="team",e))(sn||{}),ln=(e=>(e.Audio="audio",e.Image="image",e.Shape="shape",e.Subtitle="subtitle",e.Text="text",e.Video="video",e.Placeholder="placeholder",e))(ln||{}),dn=(e=>(e.None="none",e.Drop="drop",e.FlickerInGlow="flicker-in-glow",e.FocusIn="focus-in",e.HueRotate="hue-rotate",e.PopInBounce="pop-in-bounce",e.ProgressBar="progress-bar",e.Reveal="reveal",e.SlideUp="slide-up",e.Vibrate="vibrate",e.WipeRectangle="wipe-rectangle",e.BlurIn="blur-in",e.BlurOut="blur-out",e.FadeIn="fade-in",e.FadeOut="fade-out",e.HideIn="hide-in",e.HideOut="hide-out",e.MagicFade="magic-fade",e.MagicFlip="magic-flip",e.MagicPop="magic-pop",e.MagicWBW="magic-wbw",e))(dn||{}),cn=(e=>(e.CrossDissolve="cross-dissolve",e.CrossBlur="cross-blur",e))(cn||{});function un(e){return"audio"===e.type}function mn(e){return"image"===e.type}var pn=(e=>(e.magic="magic",e.classic="classic",e))(pn||{});function hn(e){return"text"===e.type&&"ttsAudio"in e&&void 0!==e.ttsAudio}function gn(e){return!!e&&("type"in e&&"video"===e.type)}var yn=(e=>(e.School="School",e.Work="Work",e.PersonalProjects="Personal Projects",e))(yn||{});function fn(e){return"start"in e}function En(e){const[t]=e;return!!t&&fn(t)}function vn(e){const[t]=e.words;return!!t&&fn(t)}var wn=(e=>(e[e.AlwaysInvitationOnly=-1]="AlwaysInvitationOnly",e[e.InvitationOnly=0]="InvitationOnly",e[e.RequestToJoin=1]="RequestToJoin",e[e.AnyoneCanJoin=2]="AnyoneCanJoin",e))(wn||{}),bn=(e=>(e.PATCH="patch",e.FULL_VIDEO="full_video",e.IMAGE_FRAME="image_frame",e.EXPORTING="exporting",e.FAILED="failed",e))(bn||{}),_n=(e=>(e.SAME="SAME",e.PRIVATE_TO_SHARED="PRIVATE_TO_SHARED",e.SHARED_TO_PRIVATE="SHARED_TO_PRIVATE",e.CHANGE_TEAMS="CHANGE_TEAMS",e))(_n||{}),Tn=(e=>(e.COPY="Copy",e.MOVE="Move",e))(Tn||{}),Sn=(e=>(e.POSITION="position",e.ROTATION="rotation",e.ZOOM="zoom",e.COLOR="color",e.VOLUME="volume",e.OPACITY="opacity",e.BRIGHTNESS="brightness",e.CONTRAST="contrast",e.SATURATION="saturate",e.BLUR="blurPercent",e.BACKGROUND="background",e))(Sn||{});const In={COMMIT:"a84754b9",IN_GKE:!0,NODE_ENV:"production",REACT_APP_KAPWING_SERVER:"production",SENTRY_ENV:"production",VERSION:"v2023.06.13.1"}.JEST_WORKER_ID,xn={COMMIT:"a84754b9",IN_GKE:!0,NODE_ENV:"production",REACT_APP_KAPWING_SERVER:"production",SENTRY_ENV:"production",VERSION:"v2023.06.13.1"}.KAPWING_NOTIFICATION_URL,kn=In||document.domain.startsWith("localhost"),Cn={tooltip:"tooltips-module_tooltip_XFJWd",tooltipBubble:"tooltips-module_tooltipBubble_Bv6aR",tooltipTextBottomAlignRight:"tooltips-module_tooltipTextBottomAlignRight_u0253",tooltipTextBottomAlignLeft:"tooltips-module_tooltipTextBottomAlignLeft_t70M4",tooltipTextSlightTop:"tooltips-module_tooltipTextSlightTop_xWCYX",tooltipTextTop:"tooltips-module_tooltipTextTop_WGoTp",keyboardShortcut:"tooltips-module_keyboardShortcut_ZCE9l",keyboardShortcutWithOutline:"tooltips-module_keyboardShortcutWithOutline_wrPrH"},An=e=>r.exports.createElement("svg",{width:20,height:20,viewBox:"0 0 10 10",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},r.exports.createElement("path",{d:"M5 9C7.20914 9 9 7.20914 9 5C9 2.79086 7.20914 1 5 1C2.79086 1 1 2.79086 1 5",stroke:"white"})),Nn="ProSparkle-module_proSparkle_I0j5q",Pn=({className:e=""})=>i.createElement("svg",{viewBox:"0 0 13 13",className:`${Nn} ${e}`},i.createElement("g",null,i.createElement("path",{d:"M4.63007 7.7206C4.63007 7.7206 6.69155 7.47571 7.37872 6.74119C8.06586 6.00663 8.2949 3.80298 8.2949 3.80298C8.2949 3.80298 8.52399 6.00663 9.21112 6.74119C9.8983 7.47571 11.9598 7.7206 11.9598 7.7206C11.9598 7.7206 9.8983 7.96544 9.21112 8.69996C8.52399 9.43453 8.2949 11.6382 8.2949 11.6382C8.2949 11.6382 8.06586 9.43453 7.37872 8.69996C6.69155 7.96544 4.63007 7.7206 4.63007 7.7206Z"}),i.createElement("path",{d:"M1.89838 3.53465C1.89838 3.53465 3.2938 3.36891 3.75894 2.87169C4.22409 2.37447 4.37912 0.882812 4.37912 0.882812C4.37912 0.882812 4.53415 2.37447 4.99933 2.87169C5.46446 3.36891 6.85987 3.53465 6.85987 3.53465C6.85987 3.53465 5.46446 3.70039 4.99933 4.19761C4.53415 4.69482 4.37912 6.18649 4.37912 6.18649C4.37912 6.18649 4.22409 4.69482 3.75894 4.19761C3.2938 3.70039 1.89838 3.53465 1.89838 3.53465Z"}),i.createElement("path",{d:"M0.278259 10.1277C0.278259 10.1277 1.67368 9.9619 2.13882 9.46469C2.60396 8.96747 2.75901 7.47583 2.75901 7.47583C2.75901 7.47583 2.91406 8.96747 3.37919 9.46469C3.84433 9.9619 5.23976 10.1277 5.23976 10.1277C5.23976 10.1277 3.84433 10.2934 3.37919 10.7906C2.91406 11.2878 2.75901 12.7795 2.75901 12.7795C2.75901 12.7795 2.60396 11.2878 2.13882 10.7906C1.67368 10.2934 0.278259 10.1277 0.278259 10.1277Z"}))),Rn={home:"common-module_home_dwxJm",homeHowBackgroundWhite:"common-module_homeHowBackgroundWhite_vmec3",largeButton:"common-module_largeButton_ZMjCV",sectionContent:"common-module_sectionContent_RXf2a",sectionHeader:"common-module_sectionHeader_Wp-GR",spacer:"common-module_spacer_dKAl-",chevron:"common-module_chevron_kc7ia",splashText:"common-module_splashText_si5Bf",splashSubtext:"common-module_splashSubtext_hi-6Y",aboutSection:"common-module_aboutSection_gbps9",mobile:"common-module_mobile_zBvYh",desktop:"common-module_desktop_TC-Uw",screenReaderOnlyLabel:"common-module_screenReaderOnlyLabel_K9b41",disabled:"common-module_disabled_UJAXz",noScrollBar:"common-module_noScrollBar_fcjeZ",textOverflowEllipsis:"common-module_textOverflowEllipsis_XXKqM",genericButtonBlue:"common-module_genericButtonBlue_AEzLO",button:"common-module_button_xffcT",buttonDisabled:"common-module_buttonDisabled_IFyWt",buttonSelected:"common-module_buttonSelected_Ynozr",buttonOk:"common-module_buttonOk_Mxmkv",buttonStacked:"common-module_buttonStacked_J-0Fc",doneButton:"common-module_doneButton_rJmqx",desktopNoWrap:"common-module_desktopNoWrap_RFpGQ",mobileNoWrap:"common-module_mobileNoWrap_Yzb8i",controlSectionContainer:"common-module_controlSectionContainer_7gwIs",section:"common-module_section_tLwa-",input:"common-module_input_YbU5B",cyanDoneButton:"common-module_cyanDoneButton_pVp-o",cyanDoneButton__disabled:"common-module_cyanDoneButton__disabled_dV8Rs",cyanDoneButtonContainer:"common-module_cyanDoneButtonContainer_gG-ju",genericButton:"common-module_genericButton_bMQdF",genericButtonSelected:"common-module_genericButtonSelected_neH99",groupControlContainer:"common-module_groupControlContainer_Ey5GV",controlSectionRows:"common-module_controlSectionRows_JRA98",controlSectionRowsTimeline:"common-module_controlSectionRowsTimeline_IfCRi",controlSectionRowsTwoPerRow:"common-module_controlSectionRowsTwoPerRow_uBMyX",controlSectionRowsExpandChildren:"common-module_controlSectionRowsExpandChildren_3U8le",controlSectionRowsFullWidth:"common-module_controlSectionRowsFullWidth_eQl5U",controlSectionRowsNoWrap:"common-module_controlSectionRowsNoWrap_qtGru",controlSectionRowsNoPadding:"common-module_controlSectionRowsNoPadding_eyQne",controlSectionRowsIconAndControl:"common-module_controlSectionRowsIconAndControl_WfBUs",controlSectionWrapColumns:"common-module_controlSectionWrapColumns_RbiTX",controlSectionScrollableColumn:"common-module_controlSectionScrollableColumn_Ggc8c",controlSectionTitle:"common-module_controlSectionTitle_eK-7P",controlSectionTitleNoPadding:"common-module_controlSectionTitleNoPadding_wYK6s",controlSectionDescription:"common-module_controlSectionDescription_g3zFo",smallControlButton:"common-module_smallControlButton_66vuT",smallControlButtonDisabled:"common-module_smallControlButtonDisabled_y37ZO",smallControlButtonSelected:"common-module_smallControlButtonSelected_Ljg8h",smallControlButtonLabel:"common-module_smallControlButtonLabel_snP0-",controlSectionRow:"common-module_controlSectionRow_u6iL8",controlButtonIcon:"common-module_controlButtonIcon_M-TfZ",controlButtonOnlyIcon:"common-module_controlButtonOnlyIcon_fPWdJ",controlButtonOnlyIconRoundedSmallTheme:"common-module_controlButtonOnlyIconRoundedSmallTheme_CWvZU",bigOverlayButton:"common-module_bigOverlayButton_xX5iR",bigOverlayButtonSelected:"common-module_bigOverlayButtonSelected_-Wj3h",bigOverlayButtonDisabled:"common-module_bigOverlayButtonDisabled_l7MKa",bigOverlayButtonIcon:"common-module_bigOverlayButtonIcon_eIKka",incrementDecrementControl:"common-module_incrementDecrementControl_2Gekm",incrementDecrementControlLightTheme:"common-module_incrementDecrementControlLightTheme_jDQCZ",incrementDecrementControlSmallTheme:"common-module_incrementDecrementControlSmallTheme_J08Hq",incrementDecrementControlExtraSmallTheme:"common-module_incrementDecrementControlExtraSmallTheme_y-tuh",incrementDecrementButton:"common-module_incrementDecrementButton_gr5Cg",incrementDecrementButtonLightTheme:"common-module_incrementDecrementButtonLightTheme_4A7Ux",incrementDecrementButtonSmallTheme:"common-module_incrementDecrementButtonSmallTheme_o--rH",incrementDecrementControlValue:"common-module_incrementDecrementControlValue_GbQCR",incrementDecrementControlValueSmallTheme:"common-module_incrementDecrementControlValueSmallTheme_vk7eF",incrementControl:"common-module_incrementControl_nJorQ",decrementControl:"common-module_decrementControl_m0KqN",disabledIncrementDecrementButton:"common-module_disabledIncrementDecrementButton_R3Vsm",tooltip:"common-module_tooltip_IEcJR",selectDropDownContainer:"common-module_selectDropDownContainer_NlKZJ",selectDropDownDisplay:"common-module_selectDropDownDisplay_HFrQe",selectDropDownLabel:"common-module_selectDropDownLabel_gFBNq",selectDropDownLink:"common-module_selectDropDownLink_Yjwua",selectDropDownList:"common-module_selectDropDownList_7W4-g",selectDropDownItem:"common-module_selectDropDownItem_KByJA",bottomDivider:"common-module_bottomDivider_mOCEg",selectDropDownItemSelected:"common-module_selectDropDownItemSelected_77MOH",selectDropDownShowing:"common-module_selectDropDownShowing_5vpeC",dropDownButtonIcon:"common-module_dropDownButtonIcon_9RNVn",selectOptionIcon:"common-module_selectOptionIcon_XBQgr",transparentSelectInput:"common-module_transparentSelectInput_KUrCa",selectOptionContainer:"common-module_selectOptionContainer_6qHq3",dropDownHeader:"common-module_dropDownHeader_Gmc9r",noMargin:"common-module_noMargin_JdSFY",halfWidth:"common-module_halfWidth_y05xy",fullWidth:"common-module_fullWidth_X1atg",selectDropDownIcon:"common-module_selectDropDownIcon_TQcn4",controlButtonsContainer:"common-module_controlButtonsContainer_6EXgl",loadingIcon:"common-module_loadingIcon_Rj4Hi",spin:"common-module_spin_YSTXy",iconAndLabelRow:"common-module_iconAndLabelRow_tMdJT",dropdownDirectInput:"common-module_dropdownDirectInput_m4-FD"},Ln=({style:e={},children:t})=>i.createElement("div",{className:Rn.smallControlButtonLabel,style:e,"data-testid":"small-control-button-label"},t),Dn=i.forwardRef((({icon:e,title:t,label:a,children:o,handleClick:n,disabled:r=!1,selected:s,tooltip:l,hasSparkle:d,iconStyles:c={},buttonStyles:u={},showLoadingIcon:m=!1},p)=>{const h={[Rn.bigOverlayButton]:!0,[Rn.bigOverlayButtonDisabled]:r,[Rn.bigOverlayButtonSelected]:s,[Cn.tooltip]:l};let g=`big-overlay-button-${t}`;return g=g.replace(/ +/g,"-"),i.createElement("div",{className:Object.keys(h).filter((e=>h[e])).join(" "),onClick:e=>{n(),e.stopPropagation()},style:u,"data-cy":g,"data-testid":"big-overlay-button__button","data-selected":s,ref:p},m?i.createElement(An,{style:{...c,height:17},className:Rn.loadingIcon,"data-testid":"big-overlay-button__loading-icon","data-cy":`${g}-loading-icon`}):"string"==typeof e?i.createElement("img",{src:e,alt:t,style:c,className:Rn.bigOverlayButtonIcon,"data-testid":"big-overlay-button__image-icon"}):"function"==typeof e?i.createElement("div",{style:c,className:Rn.bigOverlayButtonIcon},e({})):null,a&&i.createElement(Ln,null,a),o,d&&i.createElement(Pn,null),i.createElement("div",{className:Cn.tooltipTextBottomAlignLeft,"data-testid":"big-overlay-button__tooltip"},l))})),On={menuMessage:"MenuMessage-module_menuMessage_AIVAN"},Fn=e=>{const{children:t,style:a,noPadding:o}=e;return i.createElement("div",{className:o?Rn.controlSectionTitleNoPadding:Rn.controlSectionTitle,style:a},t)},Mn="SliderControl-module_controlSlider_AhEXT",Un="SliderControl-module_controlSliderContainer_Jjmfq",Bn="SliderControl-module_controlSliderTicks_2O89s",Wn="SliderControl-module_controlSliderTick_dBBal",Vn="SliderControl-module_controlSliderPrecisionInput_-FEqj",jn="SliderControl-module_controlSliderPrecisionUnit_GozJo",Gn="SliderControl-module_header_G3gxJ",Hn="SliderControl-module_labelIcon_ICEFR",zn="SliderControl-module_label_nukbN",$n="SliderControl-module_reset_8UK09",Kn=({className:e,label:t,labelIcon:a,min:o,max:n,defaultValue:s,step:l=1,onSliderChange:d,ticks:c=[],disabled:u=!1,tooltip:m=!1,dataCy:p="",onReset:h,precisionOptions:g})=>{const y=void 0===s?+o+(+n-+o)/2:s,[f,E]=r.exports.useState(String(y)),v=r.exports.useRef(null),w=Mn;r.exports.useEffect((()=>{E(String(y))}),[y]);const b=e=>{const t=Number(e);if(isNaN(t))return null;let a=Math.round(+t/l)*l;return t>n&&(a=n),t<o&&(a=o),a},_=e=>{const t=e.target,{value:a}=t;E(a);const o=b(a);null!==o&&d(o,!1)},T=()=>{const e=b(f);null!==e&&(E(String(e)),d(e,!0))};return i.createElement("div",{className:e},(a||t||h)&&i.createElement("div",{className:Gn},a&&i.createElement("div",{className:Hn},a),t&&i.createElement("div",{className:zn},t),h&&i.createElement("button",{type:"button",className:$n,onClick:h},"Reset")),i.createElement("div",{className:m?Cn.tooltip:""},m&&i.createElement("span",{className:Cn.tooltipTextTop,style:(()=>{let e=+f/+n*100;return e>90?e=90:e<10&&(e=10),{left:`${e}%`}})()},Math.round(100*+f),"%"),i.createElement("div",{className:Un},c&&c.length>0&&i.createElement("div",{className:Bn},c.map((e=>i.createElement("div",{onMouseDown:e=>e.preventDefault(),className:Wn,key:e,style:{left:`calc(${e}% - 0.05em)`}})))),i.createElement("input",{ref:v,"data-testid":"slider","data-cy":(p?`${p}-`:"")+"slider-control",className:w,style:u?{opacity:.2,pointerEvents:"none"}:void 0,type:"range",min:o,max:n,step:l,value:f,onChange:_,onMouseUp:T,onTouchEnd:T,disabled:u,list:"ticks"}),c&&c.length>0&&i.createElement("datalist",{id:"ticks"},c.map((e=>{const t=e/100*(+n-+o)+ +o;return i.createElement("option",{key:t,value:t})}))),g&&i.createElement(i.Fragment,null,i.createElement("input",{"data-testid":"slider-input",className:Vn,min:o,max:n,value:f,onChange:_,onBlur:T,onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),e.currentTarget.blur(),T())},disabled:u}),i.createElement("span",{className:jn},g.unit)))))},Yn=i.forwardRef((({containerStyle:e,dataTestId:t,decrement:a,disableDecrement:o=!1,disableIncrement:n=!1,extraSmallTheme:s=!1,increment:l,incrementDecrementValueStyles:d,lightTheme:c=!1,smallTheme:u,symbol:m,value:p},h)=>{const g=r.exports.useRef(null),y=r.exports.useRef(0),f=r.exports.useRef(o),E=r.exports.useRef(n),v=r.exports.useRef(a),w=r.exports.useRef(l);let b=Rn.incrementDecrementControl,_=Rn.incrementDecrementControlValue,T=Rn.incrementDecrementButton,S=Rn.controlButtonOnlyIcon;u||s?(b=s?Rn.incrementDecrementControlExtraSmallTheme:Rn.incrementDecrementControlSmallTheme,_=Rn.incrementDecrementControlValueSmallTheme,T=Rn.incrementDecrementButtonSmallTheme,S=Rn.controlButtonOnlyIconRoundedSmallTheme):c&&(b=Rn.incrementDecrementControlLightTheme,T=Rn.incrementDecrementButtonLightTheme);const I=e=>{x();const t=()=>e?E.current?(x(),!1):(w.current(),!0):f.current?(x(),!1):(v.current(),!0);t()&&(g.current=window.setInterval((()=>{y.current+=1,y.current>=4&&t()}),150))},x=()=>{g.current&&clearInterval(g.current),g.current=null,y.current=0};return r.exports.useEffect((function(){return x}),[]),r.exports.useEffect((function(){f.current=o}),[o]),r.exports.useEffect((function(){E.current=n}),[n]),r.exports.useEffect((function(){w.current=l}),[l]),r.exports.useEffect((function(){v.current=a}),[a]),i.createElement("div",{className:b,style:e,"data-testid":t,ref:h},i.createElement("div",{className:Rn.decrementControl},i.createElement("div",{className:o?Rn.disabledIncrementDecrementButton:T,onMouseDown:()=>I(!1),onMouseLeave:x,onMouseUp:x,"data-cy":"decrement-control","data-testid":"decrement-control"},i.createElement("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANIAAAAeCAYAAABZs0CNAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAB4SURBVHgB7dyxDcAgAANBiLL/ysAOfEFxJ3mEbz3XMYAb6xvANSFBQEgQEBIEhAQBIUFASBAQEgSEBAEhQUBIEBASBIQEASFBQEgQEBIEhAQBIUFASBAQEgSEBAEhQUBIEBASBIQEASFBQEgQEBIE/jMn+u+bg6dt4RYGOdVsFE0AAAAASUVORK5CYII=",alt:"Decrement",className:S}))),i.createElement("div",{className:_,style:d,"data-cy":"increment-decrement-value","data-testid":"increment-decrement-value"},i.createElement("span",null,p),m&&m),i.createElement("div",{className:Rn.incrementControl},i.createElement("div",{className:n?Rn.disabledIncrementDecrementButton:T,onMouseDown:()=>I(!0),onMouseLeave:x,onMouseUp:x,"data-cy":"increment-control","data-testid":"increment-control"},i.createElement("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMoAAADKCAYAAADkZd+oAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAKYSURBVHgB7d1BasMwFABRpeRe7U0aerJepReLmkD3HUjkgP0eaG2MPQJt9MdgiTnnZW7ren/mYIm3AfxLKBAIBQKhQCAUCIQCgVAgEAoEQoFAKBAIBQKhQCAUCIQCgVAgEAoEQoFAKBAIBQKhQCAUCIQCgVAgEAoEQoFAKBAIBQKhQCAUCIQCgVAgEAoEQoFAKBAIBQKhQCAUCIQCgVAgEAoEQoFAKBAIBQKhQCAUCIQCgVAgEAoEQoFAKBAIBQKhQCAUCIQCgVAgEAoEQoFAKBAIBQKhQCAUCIQCgVAgEAoEQoFAKBAIBQKhQCAUCIQCgVAgEAoEQoFAKBAIBQKhQCAUCIQCgVAgEAoEQoFAKBAIBQKhQHAe8KA559i78+0lL4MVPsa2Trf1/oKf9jT2b57mEbYDeMx0RoFAKBAIBQKhQCAUCIQCgVAgEAoEQoFAKBAIBQKhQCAUCIQCgVAgEAoEQoFAKBAIBQKhQCAUCIQCgVAgEAoEQoFAKBDcL+l2peoar7qT1/d8vnkP5WuwwsdtfY5tfd/Wz+DZbD6r3KcEzG1dTSZYxxkFAqFAIBQIhAKBUCAQyjpHmG14GEJZwFjM/REKBEKBQCgQCAUCoUAgFAiEAoFQIBAKBEKBQCgQCAUCoUAgFAiEAoFQIBAKBEKBQCgQCAUCoUAgFAiEAoFQIBAKBEKBQCgQCAUCoUAgFAiEAoFQIBAKBEKBQCgQCAUCoUAgFAiEAoFQIBAKBEKBQCgQCAUCoUAgFAiEAoFQIBAKBEKBQCgQCAUCoUAgFAiEAoFQIBAKBEKBQCgQCAUCoUAgFAiEAoFQIBAKBEKBQCgQCAUCoUAgFAiEAoFQIBAKBEKBQCgQCAUCoUBwHqwy/9Zen3cov+TEC2aS5UVtAAAAAElFTkSuQmCC",alt:"Increment",className:S}))))})),qn=i.forwardRef((({icon:e,title:t="",label:a="",selected:o=!1,disabled:n=!1,children:r,handleClick:s,labelFont:l,style:d,iconStyle:c,labelFontStyle:u,className:m="",selectedClassName:p="",type:h="",dataCy:g="",dataCyString:y="",dataTestId:f="",hasSparkle:E=!1,isLoading:v=!1,onMouseEnter:w,onMouseLeave:b},_)=>{let T,S=l?{fontFamily:l}:{};u&&(S={...S,...u}),T=g||(y?`${y.replace(/ /g,"-").replace(/[:#]/g,"")}-small-control-button`:a&&"string"==typeof a?`${a.replace(/ /g,"-").replace(/[:#]/g,"")}-small-control-button`:h?`${h}-small-control-button`:"small-control-button");let I=`${Rn.smallControlButton}`;return n?I=`${Rn.smallControlButton} ${Rn.smallControlButtonDisabled}`:o&&(I=`${Rn.smallControlButton} ${Rn.smallControlButtonSelected}`,p&&(I+=` ${p}`)),m&&(I+=` ${m}`),i.createElement("div",{ref:_,"data-cy":T,"data-cy-selected":!!o,"data-testid":f,className:I,onMouseEnter:w,onMouseLeave:b,onClick:()=>{n||s&&s()},style:d},r,"string"==typeof e?i.createElement("img",{src:e,alt:t,className:a?Rn.controlButtonIcon:Rn.controlButtonOnlyIcon,style:c,"data-testid":"small-control-button__image-icon"}):"function"==typeof e?i.createElement("div",{className:a?Rn.controlButtonIcon:Rn.controlButtonOnlyIcon,style:c,"data-testid":"small-control-button__icon"},e({})):"object"==typeof e?e:null,a&&i.createElement(Ln,{style:S},v?i.createElement(i.Fragment,null,i.createElement(An,{className:Rn.loadingIcon,style:{right:0,marginRight:4,top:2.2,height:14}}),a):a),E&&i.createElement(Pn,null))})),Xn=.7,Jn=600.5,Qn=[.7,1.3,2.8,5.3,10,20,40,85,150,600.5];function Zn(e){let t=0,a=Number.MAX_SAFE_INTEGER;return Qn.forEach(((o,n)=>{const r=Math.abs(o-e);r<a&&(t=n,a=r)})),t}const er=({isMobile:e,pxInSecond:t,setPxInSecond:a})=>{const o=null!=t?t:Qn[0],[n,c]=r.exports.useState(Zn(o));r.exports.useEffect((function(){c(Zn(o))}),[o]);const u=e=>{const t=[.2,.4,.5,1,1,10,10,10,100,100];let n=null!=o?o:.7;if(o)if(o<.7&&1===e)a(.7);else if(.7!==o||-1!==e)if(o>600.5&&-1===e)a(600.5);else if(600.5!==o||1!==e){for(let a=0;a<Qn.length-1;a+=1){const r=Qn[a],i=Qn[a+1],s=t[a];if(r&&i&&s&&(r<o&&o<i||o===r||o===i)){n+=s*e;break}}a(n)}},m=r.exports.useMemo((()=>s.exports.debounce((e=>a(e)),30)),[a]);return i.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"}},i.createElement(l,{"data-cy":"zoom-out",size:24,onClick:()=>u(-1),style:{marginLeft:8,cursor:"pointer"}}),!e&&i.createElement(Kn,{min:0,max:Qn.length-1,step:1,defaultValue:n,onSliderChange:e=>{c(e);const t=Qn[e];t&&m(t)}}),i.createElement(d,{"data-cy":"zoom-in",size:24,onClick:()=>u(1),style:{marginLeft:4,marginRight:5,cursor:"pointer"}}))},tr=m.exports.useSelector,ar=m.exports.shallowEqual,or=c((e=>e.studio.scenes),(e=>e.some((({layers:e})=>e.some((({type:e})=>"audio"===e||"video"===e))))));let nr=!1;const rr=e=>{var t,a,o;const n=e.playbackRate||1;let r=0;if(e.isTrimmed){const{endTime:a,startTime:o=0}=e;r=Math.min(a,(null==(t=e.preview)?void 0:t.duration)||a)-o}else e.duration&&(r=(null==(a=e.preview)?void 0:a.duration)||e.duration,(null==(o=e.preview)?void 0:o.duration)&&Math.abs(e.duration-e.preview.duration)>.5&&!nr&&(p("Preview duration very different from original",{extra:{layerId:e.id}}),nr=!0));return r/n};function ir(e){for(const t in e)delete e[t]}const sr=u(h,ar);const lr=new class{constructor(){a(this,"_queued",[]),a(this,"_pending",{})}clear(){this._pending={},this._queued=[]}getAllPendingOps(){return Object.values(this._pending)}push(e){this._queued.push(e),"presence"!==e.p[0]&&(this._pending[e.__localMd.id]=e)}dequeueAll(){return this._queued.splice(0)}removePending(e){delete this._pending[e.__localMd.id]}toJSON(){}},dr={pendingOps:lr},cr=g({initialState:dr,name:"projectSessionSettings",reducers:{showOverlayWithKey:(e,t)=>{e.overlay=t.payload},hideOverlay:e=>{e.overlay=null},setMediaSidebar:(e,t)=>{e.mediaSidebar=t.payload},updateTimelinePosition:(e,t)=>{e.timelinePosition=t.payload},setPxInSecond:(e,t)=>{t.payload<=600.5?e.pxInSecond=t.payload:e.pxInSecond=600.5},setCopiedModifications:(e,t)=>{e.copiedModifications=t.payload},setPreservedTextOptions:(e,t)=>{e.preservedTextOptions=t.payload},setSessionSettings:(e,t)=>{var a;ir(e),Object.assign(e,t.payload),lr.clear();for(const o of null!=(a=t.payload.offlineOps)?a:[])lr.push(o);e.pendingOps=lr},logAddLayer:e=>{e.addLayerLogged?e.addLayerLogged+=1:e.addLayerLogged=1},logSplitVideo:e=>{e.splitsLogged?e.splitsLogged+=1:e.splitsLogged=1},logUsedTrimmer:(e,t)=>{const a=t.payload;if(e.trimsLogged){const t=e.trimsLogged[a]||0;e.trimsLogged={...e.trimsLogged,[a]:t+1}}else e.trimsLogged={[a]:1}},addPendingUpload:(e,t)=>{e.pendingUploadMediaCacheIds||(e.pendingUploadMediaCacheIds=[]),e.pendingUploadMediaCacheIds.includes(t.payload)||e.pendingUploadMediaCacheIds.push(t.payload)},removePendingUpload:(e,t)=>{e.pendingUploadMediaCacheIds&&(e.pendingUploadMediaCacheIds=e.pendingUploadMediaCacheIds.filter((e=>e!==t.payload)))},setDraftEmailRef:(e,t)=>{e.draftEmailRef=t.payload},setDisableKeyframingHelper:(e,t)=>{e.disableKeyframingHelper=t.payload},setTrimWithTranscriptEnabledAssets:(e,t)=>{e.trimWithTranscriptEnabledAssets=t.payload},updateTrimWithTranscriptAnalytics:(e,t)=>{e.trimWithTranscriptAnalytics={...e.trimWithTranscriptAnalytics,...t.payload}},updateSidebarCollapsedState:(e,t)=>{e.collapsibleSectionOpenStates||(e.collapsibleSectionOpenStates={}),e.collapsibleSectionOpenStates[t.payload.key]=t.payload.open}},extraReducers:e=>e.addDefaultCase(((e,t)=>{switch(t.type){case"RESET_STUDIO":case"RESET_STATE_PRESERVE_USER":case"JEST_CLEAR_STORE":return lr.clear(),{...dr};case"SET_STUDIO":return t.projectIdChanged?(lr.clear(),{...dr}):e;default:return e}}))}),{addPendingUpload:ur,hideOverlay:mr,logAddLayer:pr,logSplitVideo:hr,logUsedTrimmer:gr,removePendingUpload:yr,setCopiedModifications:fr,setDraftEmailRef:Er,setMediaSidebar:vr,setPxInSecond:wr,setPreservedTextOptions:br,setSessionSettings:_r,showOverlayWithKey:Tr,updateTimelinePosition:Sr,setDisableKeyframingHelper:Ir,setTrimWithTranscriptEnabledAssets:xr,updateTrimWithTranscriptAnalytics:kr,updateSidebarCollapsedState:Cr}=cr.actions,Ar=g({initialState:{assetIdToMediaCacheId:{},mediaCacheIdToAssetId:{},mediaCacheIdToUploadId:{},uploadIdToMediaCacheId:{}},name:"mediaCache",reducers:{linkAssetToMediaCache:(e,t)=>{e.assetIdToMediaCacheId[t.payload.assetId]=t.payload.mediaCacheId,e.mediaCacheIdToAssetId[t.payload.mediaCacheId]=t.payload.assetId},linkUploadToMediaCache:(e,t)=>{e.uploadIdToMediaCacheId[t.payload.uploadId]=t.payload.mediaCacheId,e.mediaCacheIdToUploadId[t.payload.mediaCacheId]=t.payload.uploadId}}}),{linkAssetToMediaCache:Nr,linkUploadToMediaCache:Pr}=Ar.actions,Rr=(e,t=tn().state.mediaCache)=>{const{dispatch:a}=tn(),o=Lr(e,t);if(o)return o;const n=y();let r=!1;const i=e.ttsAudio?e.ttsAudio.assetId:e.asset_id;return i&&(a(Nr({assetId:i,mediaCacheId:n})),r=!0),e.uploadId&&(a(Pr({mediaCacheId:n,uploadId:e.uploadId})),r=!0),r||console.error("Could not link media cache id to anything",e),n};function Lr(e,t=tn().state.mediaCache){const{assetIdToMediaCacheId:a,uploadIdToMediaCacheId:o}=t;if(e.mediaLibraryID)return e.mediaLibraryID;if(e.ttsAudio){const t=a[e.ttsAudio.assetId];if(t)return t}if(e.asset_id){const t=a[e.asset_id];if(t)return t}if(e.uploadId){const t=o[e.uploadId];if(t)return t}return null}function Dr(e){const t=new Map;for(const a of Object.values(e.allLayers.byId)){if(!un(a)&&!gn(a))continue;const{asset_id:e}=a;if(!e)continue;const o=t.get(e)||0;t.set(e,o+1)}return Array.from(t.values()).reduce(((e,t)=>e+(t-1)),0)}const Or="kapwing-useast1",Fr="https://storage.googleapis.com",Mr="https://cdn.kapwing.com",Ur="https://cdn-useast1.kapwing.com",Br=1048576,Wr=1024*Br,Vr=1e3,jr=6e4,Gr=864e5,Hr={justForYou20:{discountPercentage:20,activeOnDay:7,expiresOnDay:10},justForYou25:{discountPercentage:25,activeOnDay:10,expiresOnDay:14},justForYou30:{discountPercentage:30,activeOnDay:14,expiresOnDay:21}},zr=Object.keys(Hr),$r=1e3,Kr="639a7747d4a7387dad8ae8ff",Yr="Anonymous User",qr="0.7",Xr="0.7".split(".").map((e=>parseInt(e)));var Jr=(e=>(e[e.personal=0]="personal",e[e.team=1]="team",e))(Jr||{});const Qr="Studio Project",Zr="Untitled Export",ei="Saved Draft",ti="62962eab0af119277ab7c9c3",ai="62d61954f85729d3ec1db3f4",oi=["#53E4DC","#F35D93","#FFD53F"],ni=["https://cdn-useast1.kapwing.com/static/MHQ-workspace_default_logo_1.webp","https://cdn-useast1.kapwing.com/static/9X9-workspace_default_logo_2.webp","https://cdn-useast1.kapwing.com/static/7k2-workspace_default_logo_3.webp","https://cdn-useast1.kapwing.com/static/4Y--workspace_default_logo_4.webp","https://cdn-useast1.kapwing.com/static/Jm2-workspace_default_logo_5.webp","https://cdn-useast1.kapwing.com/static/62Z-workspace_default_logo_6.webp"],ri=Object.freeze({failed:-1,pending:0,uploading:1,uploaded:2});Object.freeze({teamImage:0,brandkitMedia:1,brandkitFont:2}),Object.freeze({live:0,videoArchived:1,blobArchived:2});var ii=(e=>(e[e.public_write=-1]="public_write",e[e.unlisted=0]="unlisted",e[e.private=1]="private",e))(ii||{}),si=(e=>(e.unlisted="unlisted",e.private="private",e))(si||{});const li=Object.freeze({editor:0,admin:1});Object.freeze({public:0,restricted:1});const di=Object.freeze({admin:100,free:0,student:"student",teacher:"teacher",googleAppLicenseUser:"googleAppLicenseUser"}),ci=Object.freeze({creator:0,workspaceMember:1,invited:2,pending:3}),ui=Object.freeze({member:0,owner:1}),mi="shared-with-me",pi="Shared with Me";var hi=(e=>(e.ScheduledMarketingEmail="SME",e.RequestToEditEmail="RTE",e.RequestToJoinEmail="RTJ",e))(hi||{});const gi="1080p",yi="4K",fi=["AUTO","480p","720p","1080p","4K"];var Ei=(e=>(e.IMAGE="image",e.MP4="mp4",e.MP3="mp3",e.GIF="gif",e))(Ei||{});const vi=e=>{var t;if(void 0!==window.TouchEvent&&e instanceof window.TouchEvent)return!0;return!!(null==(t=null==e?void 0:e.touches)?void 0:t.length)},wi=e=>{var t,a,o,n;if(vi(e)){const r=e;return[(null==(a=null==(t=null==r?void 0:r.touches)?void 0:t[0])?void 0:a.clientX)||0,(null==(n=null==(o=null==r?void 0:r.touches)?void 0:o[0])?void 0:n.clientY)||0]}const r=e;return[r.clientX,r.clientY]};async function bi(e,t,a){let o;const n=new Promise((t=>{o=setTimeout((()=>{t({winner:"timeout"})}),e)})),r=new Promise((e=>{t.then((()=>{e({winner:"result"})})).catch((()=>{e({winner:"result"})}))})),{winner:i}=await Promise.race([n,r]);if("result"===i)return clearTimeout(o),t;if(a)return a;throw new Error(`Timed out in ${e} ms.`)}const _i=(e,t=(e=>e))=>{if(e.length<=1)return!0;const[a,...o]=e;if(!a)return!1;const n=t(a);return o.every((e=>Object.is(t(e),n)))},Ti=e=>{if("undefined"!=typeof window&&window.matchMedia){const[t,a]=r.exports.useState(window.matchMedia(e).matches);return r.exports.useEffect((()=>{const o=window.matchMedia(e);o.matches!==t&&a(o.matches);const n=()=>a(o.matches);return o.addListener(n),()=>o.removeListener(n)}),[t,e]),t}return!1},Si=()=>tr((e=>e.isMobile)),Ii=()=>{const e=window,t=document,a=t.documentElement,o=t.body;return(e.innerWidth||a.clientWidth||o.clientWidth)<=768},xi=e=>{if(e.dataTransfer.types)for(let t=0;t<e.dataTransfer.types.length;t+=1)if("Files"===e.dataTransfer.types[t])return!0;return!1},ki=()=>{const e=Si(),t=Ti("(orientation: landscape)");return!(!e||!t)},Ci=(e,t,a)=>Math.min(Math.max(parseFloat(e),t),a),Ai=(e,t)=>e?e.length<=t?e:`${e.substring(0,t-3)}...`:"";function Ni(e){return Object.keys(e).filter((t=>e[t])).join(" ").trim()}const Pi=(e,t=3)=>{const a=10**t;return Math.round(e*a)/a},Ri=.05625,Li=.6,Di="#0083e2",Oi="bar",Fi="40%",Mi="100%",Ui="30%",Bi=1920,Wi=1280,Vi=3e3,ji=10,Gi=325,Hi=280,zi=854,$i=100,Ki=["#0083e2","#a15164","#11dabf","#79d304","#0936b1","#034748","#74be2f","#886F68","#E34A6F","#FFBA08","#D00000","#75DDDD","#4B2E39","#6E9075","#f7c306","#d4ae12","#074c5a","#07d86f","#d1680c","#04248b","#7d8aee"],Yi={backgroundColor:"rgba(0, 0, 0, 0.6)",backgroundOpacity:.6,backgroundStyle:"wrap",fixedPosition:.95,font:"Arial",fontColor:"#ffffff",fontSize:18,fontSizeRaw:18,fontSizeRatio:.05625,fontStyle:"normal",fontWeight:"bold",lineHeight:1.2,lineWidth:0,textAlign:"center",textShadow:"#000000",textVerticalAlign:"bottom",updateSubtitlePosition:y()},qi=-1,Xi="background-asset",Ji=[{en:"Afrikaans",label:"Afrikaans (Suid-Afrika)",translateCode:"af",transcriptionVariants:[{en:"Afrikaans",code:"af-ZA",label:"Afrikaans (Suid-Afrika)"}]},{en:"Albanian",label:"shqip (Shqipëri)",translateCode:"sq",transcriptionVariants:[{en:"Albanian",code:"sq-AL",label:"shqip (Shqipëri)"}]},{en:"Amharic",label:"አማርኛ (ኢትዮጵያ)",translateCode:"am",transcriptionVariants:[{en:"Amharic",code:"am-ET",label:"አማርኛ (ኢትዮጵያ)"}]},{en:"Arabic",label:"العربية",translateCode:"ar",transcriptionVariants:[{en:"Arabic",code:"ar-SA",label:"العربية"}]},{en:"Armenian",label:"Հայ (Հայաստան)",translateCode:"hy",transcriptionVariants:[{en:"Armenian",code:"hy-AM",label:"Հայ (Հայաստան)"}]},{en:"Azerbaijani",label:"Azərbaycan (Azərbaycan)",translateCode:"az",transcriptionVariants:[{en:"Azerbaijani",code:"az-AZ",label:"Azərbaycan (Azərbaycan)"}]},{en:"Basque",label:"Euskara (Espainia)",translateCode:"eu",transcriptionVariants:[{en:"Basque",code:"eu-ES",label:"Euskara (Espainia)"}]},{en:"Bengali",label:"বাংলা",translateCode:"bn",transcriptionVariants:[{en:"Bangla",code:"bn-BD",label:"বাংলা (বাংলাদেশ)"},{en:"Bangla",code:"bn-IN",label:"বাংলা (ভারত)"}]},{en:"Bulgarian",label:"Български (България)",translateCode:"bg",transcriptionVariants:[{en:"Bulgarian",code:"bg-BG",label:"Български (България)"}]},{en:"Burmese",label:"ဗမာ (မြန်မာ)",translateCode:"my",transcriptionVariants:[{en:"Burmese",code:"my-MM",label:"ဗမာ (မြန်မာ)"}]},{en:"Catalan",label:"Català (Espanya)",translateCode:"ca",transcriptionVariants:[{en:"Catalan",code:"ca-ES",label:"Català (Espanya)"}]},{en:"Chinese (Simplified)",label:"普通話",noSpaces:!0,translateCode:"zh",transcriptionVariants:[{en:"Chinese, Cantonese ",code:"yue-Hant-HK",label:"粵語"},{en:"Chinese, Mandarin (Simplified)",code:"cmn-Hans-CN",label:"普通话 简体"}]},{en:"Chinese (Traditional)",label:"國語 (台灣)",translateCode:"zh-TW",transcriptionVariants:[]},{en:"Croatian",label:"Hrvatski (Hrvatska)",translateCode:"hr",transcriptionVariants:[{en:"Croatian",code:"hr-HR",label:"Hrvatski (Hrvatska)"}]},{en:"Czech",label:"Čeština (Česká republika)",translateCode:"cs",transcriptionVariants:[{en:"Czech",code:"cs-CZ",label:"Čeština (Česká republika)"}]},{en:"Danish",label:"Dansk (Danmark)",translateCode:"da",transcriptionVariants:[{en:"Danish",code:"da-DK",label:"Dansk (Danmark)"}]},{en:"Dutch",label:"Nederlands (Nederland)",translateCode:"nl",transcriptionVariants:[{en:"Dutch",code:"nl-NL",label:"Nederlands (Nederland)"}]},{en:"English",label:"English",translateCode:"en",transcriptionVariants:[{en:"English",code:"en-AU",label:"English (Australia)"},{en:"English",code:"en",label:"English (Global)"},{en:"English",code:"en-GB",label:"English (United Kingdom)"},{en:"English",code:"en-US",label:"English (United States)"}]},{en:"Estonian",label:"eesti keel (Eesti)",translateCode:"et",transcriptionVariants:[{en:"Estonian",code:"et-EE",label:"eesti keel (Eesti)"}]},{en:"Finnish",label:"Suomi (Suomi)",translateCode:"fi",transcriptionVariants:[{en:"Finnish",code:"fi-FI",label:"Suomi (Suomi)"}]},{en:"French",label:"Français",translateCode:"fr",transcriptionVariants:[{en:"French",code:"fr-FR",label:"Français"}]},{en:"Galician",label:"Galego (España)",translateCode:"gl",transcriptionVariants:[{en:"Galician",code:"gl-ES",label:"Galego (España)"}]},{en:"Georgian",label:"ქართული (საქართველო)",translateCode:"ka",transcriptionVariants:[{en:"Georgian",code:"ka-GE",label:"ქართული (საქართველო)"}]},{en:"German",label:"Deutsch (Deutschland)",translateCode:"de",transcriptionVariants:[{en:"German",code:"de-DE",label:"Deutsch (Deutschland)"}]},{en:"Greek",label:"Ελληνικά (Ελλάδα)",translateCode:"el",transcriptionVariants:[{en:"Greek",code:"el-GR",label:"Ελληνικά (Ελλάδα)"}]},{en:"Gujarati",label:"ગુજરાતી (ભારત)",translateCode:"gu",transcriptionVariants:[{en:"Gujarati",code:"gu-IN",label:"ગુજરાતી (ભારત)"}]},{en:"Hebrew",label:"עברית (ישראל)",translateCode:"he",transcriptionVariants:[{en:"Hebrew",code:"he-IL",label:"עברית (ישראל)"}]},{en:"Hindi",label:"हिन्दी (भारत)",translateCode:"hi",transcriptionVariants:[{en:"Hindi",code:"hi-IN",label:"हिन्दी (भारत)"}]},{en:"Hungarian",label:"Magyar (Magyarország)",translateCode:"hu",transcriptionVariants:[{en:"Hungarian",code:"hu-HU",label:"Magyar (Magyarország)"}]},{en:"Icelandic",label:"Íslenska (Ísland)",translateCode:"is",transcriptionVariants:[{en:"Icelandic",code:"is-IS",label:"Íslenska (Ísland)"}]},{en:"Indonesian",label:"Bahasa Indonesia",translateCode:"id",transcriptionVariants:[{en:"Indonesian",code:"id-ID",label:"Bahasa Indonesia (Indonesia)"}]},{en:"Italian",label:"Italiano (Italia)",translateCode:"it",transcriptionVariants:[{en:"Italian",code:"it-IT",label:"Italiano (Italia)"}]},{en:"Japanese",label:"日本語（日本）",noSpaces:!0,translateCode:"ja",transcriptionVariants:[{en:"Japanese",code:"ja-JP",label:"日本語（日本）"}]},{en:"Javanese",label:"Jawa (Indonesia)",translateCode:"jv",transcriptionVariants:[{en:"Javanese",code:"jv-ID",label:"Jawa (Indonesia)"}]},{en:"Kannada",label:"ಕನ್ನಡ (ಭಾರತ)",translateCode:"kn",transcriptionVariants:[{en:"Kannada",code:"kn-IN",label:"ಕನ್ನಡ (ಭಾರತ)"}]},{en:"Kazakh",label:"қазақ (Қазақстан)",translateCode:"kk",transcriptionVariants:[{en:"Kazakh",code:"kk-KZ",label:"қазақ (Қазақстан)"}]},{en:"Khmer",label:"ភាសាខ្មែរ (កម្ពុជា)",translateCode:"km",noSpaces:!0,transcriptionVariants:[{en:"Khmer",code:"km-KH",label:"ភាសាខ្មែរ (កម្ពុជា)"}]},{en:"Kinyarwanda",label:"Kinyarwanda (Rwanda)",translateCode:"rw",transcriptionVariants:[{en:"Kinyarwanda",code:"rw-RW",label:"Kinyarwanda (Rwanda)"}]},{en:"Korean",label:"한국어 (대한민국)",translateCode:"ko",transcriptionVariants:[{en:"Korean",code:"ko-KR",label:"한국어 (대한민국)"}]},{en:"Lao",label:"ລາວ (ລາວ)",translateCode:"lo",noSpaces:!0,transcriptionVariants:[{en:"Lao",code:"lo-LA",label:"ລາວ (ລາວ)"}]},{en:"Latvian",label:"Latviešu (latviešu)",translateCode:"lv",transcriptionVariants:[{en:"Latvian",code:"lv-LV",label:"Latviešu (latviešu)"}]},{en:"Lithuanian",label:"Lietuvių (Lietuva)",translateCode:"lt",transcriptionVariants:[{en:"Lithuanian",code:"lt-LT",label:"Lietuvių (Lietuva)"}]},{en:"Macedonian",label:"македонски (Северна Македонија)",translateCode:"mk",transcriptionVariants:[{en:"Macedonian",code:"mk-MK",label:"македонски (Северна Македонија)"}]},{en:"Malay",label:"Bahasa Melayu (Malaysia)",translateCode:"ms",transcriptionVariants:[{en:"Malay",code:"ms-MY",label:"Bahasa Melayu (Malaysia)"}]},{en:"Malayalam",label:"മലയാളം (ഇന്ത്യ)",translateCode:"ml",transcriptionVariants:[{en:"Malayalam",code:"ml-IN",label:"മലയാളം (ഇന്ത്യ)"}]},{en:"Marathi",label:"मराठी (भारत)",translateCode:"mr",transcriptionVariants:[{en:"Marathi",code:"mr-IN",label:"मराठी (भारत)"}]},{en:"Mongolian",label:"Монгол (Монгол)",translateCode:"mn",transcriptionVariants:[{en:"Mongolian",code:"mn-MN",label:"Монгол (Монгол)"}]},{en:"Nepali",label:"नेपाली (नेपाल)",translateCode:"ne",transcriptionVariants:[{en:"Nepali",code:"ne-NP",label:"नेपाली (नेपाल)"}]},{en:"Norwegian",label:"Norsk",translateCode:"no",transcriptionVariants:[{en:"Norwegian",code:"no-NO",label:"Norsk bokmål (Norge)"}]},{en:"Oromo",label:"Afaan Oromoo",translateCode:"om",transcriptionVariants:[]},{en:"Persian",label:"فارسی",translateCode:"fa",transcriptionVariants:[{en:"Persian",code:"fa-IR",label:"فارسی (ایران)"}]},{en:"Polish",label:"Polski (Polska)",translateCode:"pl",transcriptionVariants:[{en:"Polish",code:"pl-PL",label:"Polski (Polska)"}]},{en:"Portuguese",label:"Português",translateCode:"pt",transcriptionVariants:[{en:"Portuguese",code:"pt-BR",label:"Português (Brasil)"},{en:"Portuguese",code:"pt-PT",label:"Português (Portugal)"}]},{en:"Punjabi",label:"ਪੰਜਾਬੀ (ਗੁਰਮੁਖੀ ਭਾਰਤ)",translateCode:"pa",transcriptionVariants:[{en:"Punjabi",code:"pa-Guru-IN",label:"ਪੰਜਾਬੀ (ਗੁਰਮੁਖੀ ਭਾਰਤ)"}]},{en:"Romanian",label:"Română (România)",translateCode:"ro",transcriptionVariants:[{en:"Romanian",code:"ro-RO",label:"Română (România)"}]},{en:"Russian",label:"Русский (Россия)",translateCode:"ru",transcriptionVariants:[{en:"Russian",code:"ru-RU",label:"Русский"}]},{en:"Serbian",label:"Српски (Србија)",translateCode:"sr",transcriptionVariants:[{en:"Serbian",code:"sr-RS",label:"Српски (Србија)"}]},{en:"Sesotho",label:"Sesotho (Afrika Borwa)",translateCode:"st",transcriptionVariants:[{en:"Sesotho",code:"st-ZA",label:"Sesotho (Afrika Borwa)"}]},{en:"Sinhala (Sinhalese)",label:"සිංහල (ශ්රී ලංකාව)",translateCode:"si",transcriptionVariants:[{en:"Sinhala",code:"si-LK",label:"සිංහල (ශ්රී ලංකාව)"}]},{en:"Slovak",label:"Slovenčina (Slovensko)",translateCode:"sk",transcriptionVariants:[{en:"Slovak",code:"sk-SK",label:"Slovenčina (Slovensko)"}]},{en:"Slovenian",label:"Slovenščina (Slovenija)",translateCode:"sl",transcriptionVariants:[{en:"Slovenian",code:"sl-SI",label:"Slovenščina (Slovenija)"}]},{en:"Spanish",label:"Español",translateCode:"es",transcriptionVariants:[{en:"Spanish",code:"es-MX",label:"Español"}]},{en:"Sundanese",label:"Urang (Indonesia)",translateCode:"su",transcriptionVariants:[{en:"Urang",code:"su-ID",label:"Urang (Indonesia)"}]},{en:"Swahili",label:"Swahili",translateCode:"sw",transcriptionVariants:[{en:"Swahili",code:"sw-KE",label:"Swahili (Kenya)"},{en:"Swahili",code:"sw-TZ",label:"Swahili (Tanzania)"}]},{en:"Swedish",label:"Svenska (Sverige)",translateCode:"sv",transcriptionVariants:[{en:"Swedish",code:"sv-SE",label:"Svenska (Sverige)"}]},{en:"Tagalog",label:"Filipino (Pilipinas)",translateCode:"tl",transcriptionVariants:[{en:"Filipino",code:"fil-PH",label:"Filipino (Pilipinas)"}]},{en:"Tamil",label:"தமிழ்",translateCode:"ta",transcriptionVariants:[{en:"Tamil",code:"ta-IN",label:"தமிழ் (இந்தியா)"},{en:"Tamil",code:"ta-MY",label:"தமிழ் (மலேசியா)"},{en:"Tamil",code:"ta-SG",label:"தமிழ் (சிங்கப்பூர்)"},{en:"Tamil",code:"ta-LK",label:"தமிழ் (இலங்கை)"}]},{en:"Telugu",label:"తెలుగు (భారతదేశం)",translateCode:"te",transcriptionVariants:[{en:"Telugu",code:"te-IN",label:"తెలుగు (భారతదేశం)"}]},{en:"Thai",label:"ไทย (ประเทศไทย)",translateCode:"th",noSpaces:!0,transcriptionVariants:[{en:"Thai",code:"th-TH",label:"ไทย (ประเทศไทย)"}]},{en:"Turkish",label:"Türkçe (Türkiye)",translateCode:"tr",transcriptionVariants:[{en:"Turkish",code:"tr-TR",label:"Türkçe (Türkiye)"}]},{en:"Ukrainian",label:"Українська (Україна)",translateCode:"uk",transcriptionVariants:[{en:"Ukrainian",code:"uk-UA",label:"Українська (Україна)"}]},{en:"Urdu",label:"اردو",translateCode:"ur",transcriptionVariants:[{en:"Urdu",code:"ur-IN",label:"اردو (بھارت)"},{en:"Urdu",code:"ur-PK",label:"اردو (پاکستان)"}]},{en:"Uzbek",label:"O'zbek (O'zbekiston)",translateCode:"uz",transcriptionVariants:[{en:"Uzbek",code:"uz-UZ",label:"O'zbek (O'zbekiston)"}]},{en:"Vietnamese",label:"Tiếng Việt (Việt Nam)",translateCode:"vi",transcriptionVariants:[{en:"Vietnamese",code:"vi-VN",label:"Tiếng Việt (Việt Nam)"}]},{en:"Xhosa",label:"IsiXhosa (eMzantsi Afrika)",translateCode:"xh",transcriptionVariants:[{en:"Xhosa",code:"xh-ZA",label:"IsiXhosa (eMzantsi Afrika)"}]},{en:"Zulu",label:"IsiZulu (Ningizimu Afrika)",translateCode:"zu",transcriptionVariants:[{en:"Zulu",code:"zu-ZA",label:"IsiZulu (Ningizimu Afrika)"}]}],Qi=new Map(Object.values(Ji).map((e=>[e.translateCode,e])));Object.freeze({write:0,read_only:1}),Object.freeze({stripe:0,paypal:1}),Object.freeze({individual:"individual"}),Object.freeze({stripe:"stripe",paypal:"paypal"});const Zi={failed:-1,started:0,completed:1},es=Ji.flatMap((({translateCode:e,transcriptionVariants:t})=>t.map((t=>({en:t.en,code:t.code,label:t.label,translateCode:e}))))).sort(((e,t)=>e.en.localeCompare(t.en))),ts=Ji.map((e=>({en:e.en,label:e.label,code:e.translateCode}))),as=3,os="Untitled Folder",ns="Studio Draft",rs=6e4,is=6e4,ss="Trending Now",ls=Math.random().toString(36).substring(2);function ds(){return"v2023.06.13.1"}function cs(){let e="local";return e="a84754b9","a84754b9"}const us=()=>{try{if("undefined"!=typeof window&&"undefined"!=typeof document){const e=document.domain||"",t=e.endsWith(".kapwing-dev.com")||e.startsWith("kapwing-dev")&&e.endsWith(".herokuapp.com")||e.startsWith("localhost")&&["3000","4000","5000","3030"].includes(window.location.port),a=t?"461b8b8947f81e4f070013ded04799df":"e3eca64f2da6246ee6a22cd63f455a07",o={includeUtm:!0,includeReferrer:!0,includeGclid:!0,includeFbclid:!0,useDynamicConfig:!0,onExitPage:()=>{window.amplitudeOnExit&&window.amplitudeOnExit()}};amplitude.getInstance().init(a,null,o);const n="v2023.06.13.1",r=cs(),i=t?r:`0.0.${n}`;return amplitude.setVersionName(i),amplitude}}catch(YEe){}return null},ms={basicTier:{control:.9,test:.1},canvasWatermark:{control:.9,test:.1},inHouse:{control:.2,test:.8},inHouseTranscriptionV2:{control:1,test:0},inHouseCleanAudio:{control:.5,test:.5},inHouseCleanAudioV2:{control:.4,test:.6},mse:{control:.9,test:.1}};function ps(e){localStorage.setItem("EXPERIMENTS_LOCAL_STORAGE_KEY",JSON.stringify(e))}function hs(){const e=localStorage.getItem("EXPERIMENTS_LOCAL_STORAGE_KEY")||"{}";return JSON.parse(e)||{}}let gs;const ys=()=>{const e=hs(),t=(e=>{const t=Object.keys(e);return Object.keys(ms).filter((e=>!t.includes(e)))})(e);if(t.length){const a=(()=>{const e={};return Object.keys(ms).forEach((t=>{const a=Math.random();let o=0;const n=ms[t];if(n)for(const[r,i]of Object.entries(n))if(o+=i,a<o){e[t]=r;break}})),e})();t.forEach((t=>{e[t]=a[t]})),ps(e)}return gs=e,e},fs=()=>(null==gs&&(gs=ys()),gs);var Es=(e=>(e.Month="month",e.Year="year",e.None="none",e))(Es||{}),vs=(e=>(e.Free="free",e.Basic="basic",e.Pro="pro",e.Team="team",e.Edu="edu",e))(vs||{});const ws=250,bs=6,_s=420,Ts=7,Ss=7200,Is=2,xs=10,ks=3600,Cs=3,As=10800,Ns=3;var Ps=(e=>(e.NO_UPSELLS="NO_UPSELLS",e.REPORT_ISSUE="REPORT_ISSUE",e.ALLOW_STOCK_CONTENT="ALLOW_STOCK_CONTENT",e.CHANGE_PRIVACY="CHANGE_PRIVACY",e.CLEAN_AUDIO="CLEAN_AUDIO",e.CREATE_NEW_FOLDER="CREATE_NEW_FOLDER",e.EXPORT_ALL_WITHOUT_WATERMARK="EXPORT_ALL_WITHOUT_WATERMARK",e.EXPORT_30_SEC_WITHOUT_WATERMARK="EXPORT_30_SEC_WITHOUT_WATERMARK",e.HIGH_QUALITY="HIGH_QUALITY",e.UNLIMITED_EXPORT_DURATION_LIMIT="UNLIMITED_EXPORT_DURATION_LIMIT",e.UNLIMITED_UPLOAD_SIZE_LIMIT="UNLIMITED_UPLOAD_SIZE_LIMIT",e.REMOVE_BACKGROUND="REMOVE_BACKGROUND",e.SMART_CUT="SMART_CUT",e.AUDIOGRAM="AUDIOGRAM",e.UNLIMITED_STORAGE="UNLIMITED_STORAGE",e.NO_CUMULATIVE_DURATION_LIMIT="NO_CUMULATIVE_DURATION_LIMIT",e.SUBTITLER="SUBTITLER",e.TRANSCRIBE="TRANSCRIBE",e.TEXT_TO_SPEECH="TEXT_TO_SPEECH",e.BRANDKIT="BRANDKIT",e.FAST_EXPORT="FAST_EXPORT",e.ROYALTY_FREE="ROYALTY_FREE",e.CHANGE_MEMBER_ROLES="CHANGE_MEMBER_ROLES",e.SUBTITLE_PRESETS="SUBTITLE_PRESETS",e.TEXT_PRESETS="TEXT_PRESETS",e.TEXT_TEMPLATES="TEXT_TEMPLATES",e.GENERATE_IMAGES="GENERATE_IMAGES",e.GENERATE_SCRIPT="GENERATE_SCRIPT",e.GENERATE_DOCUMENT_TO_VIDEO="GENERARATE_DOCUMENT_TO_VIDEO",e.GENERATE_MEME="GENERATE_MEME",e.GENERATE_VIDEO="GENERATE_VIDEO",e))(Ps||{}),Rs=(e=>(e.AUDIOGRAM_BAR="audiogram-bar",e.AUDIOGRAM_WAVE="audiogram-wave",e.BACKGROUND_IMAGE_ERASE="background-image-erase",e.BRAND_TEMPLATES="brand-templates",e.BRANDKIT="brandkit",e.CHANGE_MEMBER_ROLES="change-member-roles",e.CLEAN_AUDIO="clean-audio",e.CREATE_NEW_FOLDER="create-new-folder",e.CUMULATIVE_EXPORT_DURATION="cumulative-export-duration",e.DEFAULT="default",e.DEFAULT_PRIVACY="default-privacy",e.DELETION_WARNING="deletion-warning",e.FULL_HD="full-hd",e.HEADER="header",e.HIGH_QUALITY="high-quality",e.LINK="link",e.MAGIC_SUBTITLE_FILE_DL="magic-subtitle-file-download",e.MAGIC_TRANSCRIBE="magic-transcribe",e.ONBOARDING_SURVEY="onboarding-survey",e.PRICING="pricing",e.PRICING_PAGE="pricing-page",e.PRIVACY="privacy",e.REACTIVATE_LICENSE="reactivate-license",e.REMOVE_30_SEC_WATERMARK="remove-30-sec-watermark",e.REMOVE_VIDEO_BACKGROUND="remove-video-background",e.REMOVE_WATERMARK="remove-watermark",e.ROYALTY_FREE="royalty-free",e.SETTINGS="settings",e.SIDEBAR="sidebar",e.SINGLE_VIDEO_DURATION_LIMIT="single-video-duration-limit",e.SMART_CUT_AUDIO="smart-cut-audio",e.SMART_CUT_VIDEO="smart-cut-video",e.STOCK_ASSETS_IMAGE="stock-assets-image",e.STOCK_ASSETS_MUSIC="stock-assets-music",e.STOCK_ASSETS_SFX="stock-assets-sfx",e.STOCK_ASSETS_VIDEO="stock-assets-video",e.STORAGE_LIMIT="storage-limit",e.STUDIO="studio",e.STUDIO_MEDIA_SIDEBAR="studio-media-sidebar",e.SUBTITLER="subtitler",e.TEXT_TO_SPEECH="text-to-speech",e.TRIM_WITH_TRANSCRIPT_TRANSCRIBE="trim-with-transcript-transcribe",e.TWO_WEEK_POST_ONBOARDING_MULTI_ACCOUNT_UPSELL="two-week-post-onboarding-multi-account-upsell",e.TWO_WEEK_POST_ONBOARDING_SINGLE_ACCOUNT_UPSELL="two-week-post-onboarding-single-account-upsell",e.TWO_WEEK_RECURRING_MULTI_ACCOUNT_UPSELL="two-week-recurring-multi-account-upsell",e.TWO_WEEK_RECURRING_SINGLE_ACCOUNT_UPSELL="two-week-recurring-single-account-upsell",e.UNKNOWN="unknown",e.UNLIMITED_CONTENT="unlimited-content",e.UPLOAD_FONTS="upload-fonts",e.UPLOAD_LIMIT="upload-limit",e.WORKSPACE_SETTINGS="workspace-settings",e.SUBTITLE_PRESETS="subtitle-presets",e.TEXT_PRESETS="text-presets",e.TEXT_TEMPLATES="text-templates",e.GENERATE_IMAGES="generate-images",e.GENERATE_SCRIPT="generate-script",e.GENERATE_DOCUMENT_TO_VIDEO="generate-document-to-video",e.GENERARATE_MEME="generate-meme",e.GENERATE_VIDEO="generate-video",e))(Rs||{});const Ls={free:{isFree:!0,planTier:"free",basePrice:{[Es.Month]:0,[Es.Year]:0,[Es.None]:0},modalReasons:[],cancelReasons:["All projects export with Kapwing watermark","Auto subtitler limited to 10 mins/month","Videos limited to 7 minutes","Files limited to 250 MB","Video quality limited to 720p resolution"]},basic:{upsellsTo:"pro",isFree:!1,planTier:"basic",basePrice:{[Es.Month]:10,[Es.Year]:72,[Es.None]:0},everythingIn:["free"],modalReasons:["Remove watermarks on images or videos shorter than 30 seconds."],cancelReasons:["Remove watermarks on images or videos shorter than 30 seconds."]},pro:{isFree:!1,planTier:"pro",basePrice:{[Es.Month]:24,[Es.Year]:192,[Es.None]:0},everythingIn:["free","basic"],modalReasons:["Remove all watermarks","Upload files up to 6 GB","Store and edit unlimited projects","Increased transcription limits and SRT downloads","Export projects up to 2 hours long","Export content in 4K resolution","Premium support"],andMuchMore:!0,cancelReasons:["Store projects with no duration limit","Export without a Kapwing watermark","Unrestricted video transcription","Export projects up to 1 hour long","Export projects in 4K resolution","Use Brand Kit templates, media, fonts, and colors","Remove Background on images","Export projects with Clean Audio","Edit more than 3 projects at a time","Create new folders","Download SRT and VTT files","Premium support"]},edu:{isFree:!1,planTier:"edu",basePrice:{[Es.Month]:0,[Es.Year]:0,[Es.None]:0},modalReasons:[],cancelReasons:[]},team:{isFree:!1,planTier:"team",basePrice:{[Es.Month]:24,[Es.Year]:192,[Es.None]:0},everythingIn:["pro"],chooseModalReasons:["Collaborative workspace","Brand controls for your whole team","Pay as you grow"],modalReasons:["Remove all watermarks","Ensure consistency with Brand Kit templates and other assets","Upload files up to 6 GB","Export content up to 1 hour long","Export content in 4K resolution","Unlimited transcription and SRT / VTT downloads","Consolidated billing"],cancelReasons:["Store projects with no duration limit","Export without a Kapwing watermark","Unrestricted video transcription","Export projects up to 1 hour long","Export projects in 4K resolution","Use Brand Kit templates, media, fonts, and colors","Remove Background on images","Export projects with Clean Audio","Edit more than 3 projects at a time","Create new folders","Download SRT and VTT files","Premium support"]}},Ds={_id:"anon_team",name:"My Team",users:[{_id:"anon_user",email:" ",hasLicense:!1,userId:"anon_user",role:li.admin,createdAt:new Date,firstName:"",lastName:"",name:"",teamId:"anon_team"}],creatorId:"anon_user",planTier:"free",createdAt:new Date,emailDomain:"",settings:{inviteByLink:!0,defaultPrivacy:ii.unlisted},limits:{cumulativeExportDuration:0,lastUpdatedCumulativeDuration:new Date,transcribeUsage:0,lastUpdatedTranscribe:new Date,generatedDocumentToVideo:0,generatedMemes:0,generatedScripts:0,generatedVideos:0,generatedImages:0}},Os=Ps.NO_UPSELLS,Fs=[vs.Basic,vs.Pro,vs.Team,vs.Edu],Ms=[vs.Pro,vs.Team,vs.Edu],Us={[Ps.NO_UPSELLS]:{planTiers:Ms},[Ps.REPORT_ISSUE]:{planTiers:Fs},[Ps.FAST_EXPORT]:{planTiers:Ms},[Ps.BRANDKIT]:{planTiers:Ms,heroHeader:"Staying on brand has never been easier",heroBody:"Upgrade so you can stay on-brand all the time with Brand Kit. Set up your own Brand Templates and upload your own brand colors, fonts, images, and videos to make the same assets available to everyone in this workspace.",heroImg:"https://cdn-useast1.kapwing.com/static/51e-brandkit-upgrade-banner-spot.webp",upgradeReason:"to set up your own Brand Kit with templates, logos, and more"},[Ps.UNLIMITED_UPLOAD_SIZE_LIMIT]:{planTiers:Ms},[Ps.NO_CUMULATIVE_DURATION_LIMIT]:{planTiers:Ms},[Ps.TRANSCRIBE]:{planTiers:Ms,upgradeReason:"to get unlimited transcriptions"},[Ps.SUBTITLER]:{planTiers:Ms,upgradeReason:"to download .SRT and .VTT files"},[Ps.TEXT_TO_SPEECH]:{planTiers:Ms,upsellHeading:"Text to Speech",upsellBody:"Upgrade to export with Text to Speech",upgradeReason:"to export with Text to Speech"},[Ps.REMOVE_BACKGROUND]:{planTiers:Ms,upgradeReason:"to export with Remove Background",upsellHeading:"Background remover",upsellBody:"Upgrade to export with Remove Background",imgSrc:"https://cdn-useast1.kapwing.com/static/tB5-remove-video-background-cta-image.webp"},[Ps.CLEAN_AUDIO]:{planTiers:Ms,upgradeReason:"to export with Clean Audio",upsellHeading:"Clearer audio",upsellBody:"Upgrade to export projects with Clean Audio applied",imgSrc:"https://cdn-useast1.kapwing.com/static/LII-clean-audio-upsell-banner-image.webp"},[Ps.SMART_CUT]:{planTiers:Ms,upgradeReason:"to export projects edited with Smart Cut",upsellHeading:"Remove silences automatically with Smart Cut",upsellBody:"Upgrade to export projects edited with Smart Cut",imgSrc:"https://cdn-useast1.kapwing.com/static/EwQ-smart-cut-upsell-block-image.webp"},[Ps.AUDIOGRAM]:{planTiers:Ms,upsellHeading:"Use a dynamic waveform layer to visualize audio",upsellBody:"Upgrade to export projects with waveform layers",imgSrc:"https://cdn-useast1.kapwing.com/static/zlv-bars.webp"},[Ps.UNLIMITED_EXPORT_DURATION_LIMIT]:{planTiers:Ms},[Ps.CREATE_NEW_FOLDER]:{planTiers:Ms,upgradeReason:"to create new workspace folders"},[Ps.HIGH_QUALITY]:{planTiers:Ms,upgradeReason:"to export in 4K resolution"},[Ps.ALLOW_STOCK_CONTENT]:{planTiers:Ms,upgradeReason:"to access all available stock assets",upsellHeading:"Thousands of stock assets",upsellBody:"Upgrade to load all available stock assets",imgSrc:"https://cdn-useast1.kapwing.com/static/XYa-Frame-307.webp"},[Ps.UNLIMITED_STORAGE]:{planTiers:Ms,upsellHeading:"Bigger, bolder assets",upsellBody:"Upgrade to upload and store assets over 250+ megabytes",imgSrc:"https://cdn-useast1.kapwing.com/static/C4x-img_upsell_media.webp"},[Ps.CHANGE_PRIVACY]:{planTiers:Ms,upgradeReason:"to set your content to private"},[Ps.EXPORT_ALL_WITHOUT_WATERMARK]:{planTiers:Ms,upgradeReason:"to remove all watermarks"},[Ps.EXPORT_30_SEC_WITHOUT_WATERMARK]:{planTiers:Fs,upgradeReason:"to remove all watermarks"},[Ps.ROYALTY_FREE]:{planTiers:Ms,upgradeReason:"to enable royalty-free assets"},[Ps.CHANGE_MEMBER_ROLES]:{planTiers:Ms,upgradeReason:"to set permissions for your team workspace members"},[Ps.SUBTITLE_PRESETS]:{planTiers:Ms,upgradeReason:"to enable Brand Kit subtitle presets"},[Ps.TEXT_PRESETS]:{planTiers:Ms,upgradeReason:"to enable Brand Kit text presets"},[Ps.TEXT_TEMPLATES]:{planTiers:Ms,upgradeReason:"to enable Brand Kit text templates"},[Ps.GENERATE_IMAGES]:{planTiers:Ms,upgradeReason:"to generate images with AI"},[Ps.GENERATE_DOCUMENT_TO_VIDEO]:{planTiers:Ms,upgradeReason:"to convert unlimited documents to videos with AI"},[Ps.GENERATE_VIDEO]:{planTiers:Ms,upgradeReason:"to generate unlimited videos with AI"},[Ps.GENERATE_MEME]:{planTiers:Ms,upgradeReason:"to generate unlimited memes with AI"},[Ps.GENERATE_SCRIPT]:{planTiers:Ms,upgradeReason:"to generate unlimited scripts with AI"}},Bs={[Rs.UNKNOWN]:{metadata:{prettyUpgradeSource:"Unknown"}},[Rs.CHANGE_MEMBER_ROLES]:{permission:Ps.CHANGE_MEMBER_ROLES,metadata:{prettyUpgradeSource:"Change Member Roles"}},[Rs.ROYALTY_FREE]:{permission:Ps.ROYALTY_FREE,metadata:{prettyUpgradeSource:"Filter Royalty Free"}},[Rs.SUBTITLE_PRESETS]:{permission:Ps.SUBTITLE_PRESETS,metadata:{prettyUpgradeSource:"Subtitle Presets"}},[Rs.TEXT_PRESETS]:{permission:Ps.TEXT_PRESETS,metadata:{prettyUpgradeSource:"Text Presets"}},[Rs.TEXT_TEMPLATES]:{permission:Ps.TEXT_TEMPLATES,metadata:{prettyUpgradeSource:"Text Templates"}},[Rs.TEXT_TO_SPEECH]:{permission:Ps.TEXT_TO_SPEECH,metadata:{prettyUpgradeSource:"Text to Speech"}},[Rs.DEFAULT_PRIVACY]:{permission:Ps.CHANGE_PRIVACY,metadata:{prettyUpgradeSource:"Default Privacy",upgradeReason:"to change videos from unlisted to private"}},[Rs.DELETION_WARNING]:{permission:Ps.UNLIMITED_STORAGE,metadata:{prettyUpgradeSource:"Deletion Warning",upgradeReason:"to store and edit unlimited projects"}},[Rs.HEADER]:{metadata:{prettyUpgradeSource:"Link in Header"}},[Rs.HIGH_QUALITY]:{permission:Ps.HIGH_QUALITY,metadata:{prettyUpgradeSource:"High Quality",upsellHeading:"Export in full HD quality",upsellBody:"Upgrade to export your projects in Full HD resolution"}},[Rs.PRICING]:{metadata:{prettyUpgradeSource:"Pricing Page"}},[Rs.PRIVACY]:{permission:Ps.CHANGE_PRIVACY,metadata:{prettyUpgradeSource:"Video Privacy"}},[Rs.SETTINGS]:{metadata:{prettyUpgradeSource:"Account Settings"}},[Rs.SIDEBAR]:{metadata:{prettyUpgradeSource:"Link in Sidebar"}},[Rs.SINGLE_VIDEO_DURATION_LIMIT]:{permission:Ps.NO_CUMULATIVE_DURATION_LIMIT,metadata:{prettyUpgradeSource:"Single Video Duration Limit",upgradeReason:"to export videos longer than 7 minutes"}},[Rs.STORAGE_LIMIT]:{permission:Ps.UNLIMITED_STORAGE,metadata:{prettyUpgradeSource:"Storage Limit",upgradeReason:"to view, edit, and manage locked projects"}},[Rs.STUDIO]:{metadata:{prettyUpgradeSource:"Link in Studio",upgradeReason:"to unlock the full experience of Studio"}},[Rs.SUBTITLER]:{permission:Ps.SUBTITLER,metadata:{prettyUpgradeSource:"Download SRT"}},[Rs.CUMULATIVE_EXPORT_DURATION]:{permission:Ps.UNLIMITED_STORAGE,metadata:{prettyUpgradeSource:"Total Video Duration"}},[Rs.UNLIMITED_CONTENT]:{permission:Ps.UNLIMITED_STORAGE,metadata:{prettyUpgradeSource:"Load More Button",upgradeReason:"to access older projects"}},[Rs.UPLOAD_FONTS]:{permission:Ps.BRANDKIT,metadata:{prettyUpgradeSource:"Upload font",upgradeReason:"to use custom fonts"}},[Rs.UPLOAD_LIMIT]:{permission:Ps.UNLIMITED_UPLOAD_SIZE_LIMIT,metadata:{prettyUpgradeSource:"Upload Limit",upgradeReason:"Your video uses files over 250MB, upgrade to use files up to 6GB"}},[Rs.MAGIC_TRANSCRIBE]:{permission:Ps.TRANSCRIBE,metadata:{prettyUpgradeSource:"Magic Transcription Limit"}},[Rs.TRIM_WITH_TRANSCRIPT_TRANSCRIBE]:{permission:Ps.TRANSCRIBE,metadata:{prettyUpgradeSource:"Trim with Transcript Transcription Limit"}},[Rs.REMOVE_30_SEC_WATERMARK]:{permission:Ps.EXPORT_30_SEC_WITHOUT_WATERMARK,metadata:{prettyUpgradeSource:"Remove Watermark",upsellHeading:"Create watermark-free content",upsellBody:"Upgrade to remove our watermark from your projects",imgSrc:"https://cdn-useast1.kapwing.com/static/ouU-img_upsell_remove_watermark.webp"}},[Rs.REMOVE_WATERMARK]:{permission:Ps.EXPORT_ALL_WITHOUT_WATERMARK,metadata:{prettyUpgradeSource:"Remove Watermark",upsellHeading:"Create watermark-free content",upsellBody:"Upgrade to remove our watermark from your projects",imgSrc:"https://cdn-useast1.kapwing.com/static/ouU-img_upsell_remove_watermark.webp"}},[Rs.FULL_HD]:{permission:Ps.HIGH_QUALITY,metadata:{prettyUpgradeSource:"Full HD"}},[Rs.BACKGROUND_IMAGE_ERASE]:{permission:Ps.REMOVE_BACKGROUND,metadata:{prettyUpgradeSource:"Background Image Erase",upsellBody:"Upgrade to export projects with Remove Background applied to images",imgSrc:"https://cdn-useast1.kapwing.com/static/nOm-remove-background-banner-image.svg"}},[Rs.BRAND_TEMPLATES]:{permission:Ps.BRANDKIT,metadata:{prettyUpgradeSource:"Use Brand Kit",heroBody:"Stay on-brand all the time with Brand Kit, now including templates. Create your own templates and easily start from them to save time and stay consistent across projects and team members.",heroHeader:"Introducing Brand Templates"}},[Rs.BRANDKIT]:{permission:Ps.BRANDKIT,metadata:{prettyUpgradeSource:"Use Brand Kit"}},[Rs.STUDIO_MEDIA_SIDEBAR]:{permission:Ps.UNLIMITED_STORAGE,metadata:{prettyUpgradeSource:"Media Sidebar",upgradeReason:"to upload files up to 6GB"}},[Rs.CREATE_NEW_FOLDER]:{permission:Ps.CREATE_NEW_FOLDER,metadata:{prettyUpgradeSource:"New Folder"}},[Rs.ONBOARDING_SURVEY]:{metadata:{prettyUpgradeSource:"Onboarding Survey"}},[Rs.MAGIC_SUBTITLE_FILE_DL]:{permission:Ps.SUBTITLER,metadata:{prettyUpgradeSource:"Magic Subtitle File Dl"}},[Rs.TWO_WEEK_POST_ONBOARDING_SINGLE_ACCOUNT_UPSELL]:{metadata:{prettyUpgradeSource:"Two Week Post Onboarding Single Account Upsell"}},[Rs.TWO_WEEK_POST_ONBOARDING_MULTI_ACCOUNT_UPSELL]:{metadata:{prettyUpgradeSource:"Two Week Post Onboarding Multi-Account Upsell"}},[Rs.TWO_WEEK_RECURRING_SINGLE_ACCOUNT_UPSELL]:{metadata:{prettyUpgradeSource:"Two Week Recurring Single Account Upsell"}},[Rs.TWO_WEEK_RECURRING_MULTI_ACCOUNT_UPSELL]:{metadata:{prettyUpgradeSource:"Two Week Recurring Multi Account Upsell"}},[Rs.WORKSPACE_SETTINGS]:{metadata:{prettyUpgradeSource:"Workspace Settings"}},[Rs.DEFAULT]:{metadata:{prettyUpgradeSource:"Default"}},[Rs.CLEAN_AUDIO]:{permission:Ps.CLEAN_AUDIO,metadata:{prettyUpgradeSource:"Clean Audio"}},[Rs.SMART_CUT_VIDEO]:{permission:Ps.SMART_CUT,metadata:{prettyUpgradeSource:"Smart Cut Video"}},[Rs.SMART_CUT_AUDIO]:{permission:Ps.SMART_CUT,metadata:{prettyUpgradeSource:"Smart Cut Audio"}},[Rs.REMOVE_VIDEO_BACKGROUND]:{permission:Ps.REMOVE_BACKGROUND,metadata:{prettyUpgradeSource:"Remove Video Background"}},[Rs.AUDIOGRAM_WAVE]:{permission:Ps.AUDIOGRAM,metadata:{prettyUpgradeSource:"Waveform Audiogram",imgSrc:"https://cdn-useast1.kapwing.com/static/F-T-white_waveform.webp"}},[Rs.AUDIOGRAM_BAR]:{permission:Ps.AUDIOGRAM,metadata:{prettyUpgradeSource:"Waveform Audiogram",imgSrc:"https://cdn-useast1.kapwing.com/static/zlv-bars.webp"}},[Rs.STOCK_ASSETS_MUSIC]:{permission:Ps.ALLOW_STOCK_CONTENT,metadata:{prettyUpgradeSource:"Stock Assets Music"}},[Rs.STOCK_ASSETS_SFX]:{permission:Ps.ALLOW_STOCK_CONTENT,metadata:{prettyUpgradeSource:"Stock Assets SFX"}},[Rs.STOCK_ASSETS_VIDEO]:{permission:Ps.ALLOW_STOCK_CONTENT,metadata:{prettyUpgradeSource:"Stock Assets Video"}},[Rs.STOCK_ASSETS_IMAGE]:{permission:Ps.ALLOW_STOCK_CONTENT,metadata:{prettyUpgradeSource:"Stock Assets Image"}},[Rs.PRICING_PAGE]:{metadata:{prettyUpgradeSource:"Pricing Page"}},[Rs.LINK]:{metadata:{prettyUpgradeSource:"Checkout Link"}},[Rs.REACTIVATE_LICENSE]:{metadata:{prettyUpgradeSource:"Reactivate License"}},[Rs.GENERATE_IMAGES]:{permission:Ps.GENERATE_IMAGES,metadata:{prettyUpgradeSource:"AI Image Generator",upsellBody:"Upgrade for unlimited image generation."}},[Rs.GENERATE_DOCUMENT_TO_VIDEO]:{permission:Ps.GENERATE_DOCUMENT_TO_VIDEO,metadata:{prettyUpgradeSource:"Document to Video Generator",upsellBody:"Upgrade for to convert unlimited documents to video."}},[Rs.GENERARATE_MEME]:{permission:Ps.GENERATE_MEME,metadata:{prettyUpgradeSource:"AI Meme Generator",upsellBody:"Upgrade for to convert unlimited documents to video."}},[Rs.GENERATE_SCRIPT]:{permission:Ps.GENERATE_SCRIPT,metadata:{prettyUpgradeSource:"AI Script Generator",upsellBody:"Upgrade for to generate unlimited scripts."}},[Rs.GENERATE_VIDEO]:{permission:Ps.GENERATE_VIDEO,metadata:{prettyUpgradeSource:"AI Video Generator",upsellBody:"Upgrade for to generate unlimited videos."}}},Ws=e=>Bs[e].permission||Os,Vs="https://cdn-useast1.kapwing.com/static/9EB-img_upsell_sidebar.webp",js=e=>{var t,a,o,n,r,i,s,l;const d=e&&Bs[e],c=(null==d?void 0:d.permission)&&Us[null==d?void 0:d.permission];return{img:{imgSrc:(null==(t=null==d?void 0:d.metadata)?void 0:t.imgSrc)||(null==c?void 0:c.imgSrc)||Vs,imgAlt:(null==(a=null==d?void 0:d.metadata)?void 0:a.upsellHeading)||(null==c?void 0:c.upsellHeading)||"Upgrade to store unlimited projects, comment, and more."},heroImg:{imgSrc:(null==(o=null==d?void 0:d.metadata)?void 0:o.heroImg)||(null==c?void 0:c.heroImg)||Vs,imgAlt:(null==(n=null==d?void 0:d.metadata)?void 0:n.heroHeader)||(null==c?void 0:c.heroHeader)||"Staying on brand has never been easier"},upsellHeroHeading:(null==(r=null==d?void 0:d.metadata)?void 0:r.heroHeader)||(null==c?void 0:c.heroHeader)||"Staying on brand has never been easier",upsellHeroBody:(null==(i=null==d?void 0:d.metadata)?void 0:i.heroBody)||(null==c?void 0:c.heroBody)||"Upgrade so you can stay on-brand all the time with Brand Kit. Set up your own Brand Templates and upload your own brand colors, fonts, images, and videos to make the same assets available to everyone in this workspace.",upsellBlockHeading:(null==(s=null==d?void 0:d.metadata)?void 0:s.upsellHeading)||(null==c?void 0:c.upsellHeading)||"Unlock the full Kapwing experience",upsellBlockBody:(null==(l=null==d?void 0:d.metadata)?void 0:l.upsellBody)||(null==c?void 0:c.upsellBody)||"Upgrade to store unlimited projects, comment, and more.",upgradePermission:Ws(e),buttonText:"Upgrade"}},Gs=e=>{switch(e){case vs.Free:return new zs;case vs.Basic:return new Ks;case vs.Pro:return new Ys;case vs.Edu:return new qs;case vs.Team:return new Xs;default:return new zs}};class Hs{constructor(e){a(this,"_planTier"),this._planTier=e}get planTier(){return this._planTier}get name(){return Js(this._planTier)}get planDescription(){switch(this._planTier){case vs.Free:return"Perfect for anyone getting started with video editing.";case vs.Basic:return"Edit images and short videos quickly and easily.";case vs.Pro:return"Remove all watermarks and get access to PRO features.";case vs.Team:return"Unlock the full power of Kapwing for your business.";default:return""}}get upgrades(){const e=[];let t=this.planData.upsellsTo;for(;t;)e.push(t),t=Ls[t].upsellsTo;return e}get className(){return this._planTier.toLowerCase()}get planData(){return Ls[this._planTier]}get isPaid(){return this._planTier!==vs.Free}get isFree(){return this._planTier===vs.Free}get isEdu(){return this._planTier===vs.Edu}get showUpgrades(){return!this.hasPermission(Ps.NO_UPSELLS)}is(e){return this._planTier===e}hasPermission(e){return Us[e].planTiers.includes(this.planTier)}getBasePrice(){return this.planData.basePrice}getPriceForInterval(e){return this.getBasePrice()[e]}}class zs extends Hs{constructor(){super(vs.Free)}}class $s extends Hs{constructor(e){super(e),a(this,"_planTier"),this._planTier=e}get planTier(){return this._planTier}}class Ks extends $s{constructor(){super(vs.Basic)}}class Ys extends $s{constructor(){super(vs.Pro)}}class qs extends $s{constructor(){super(vs.Edu)}}class Xs extends $s{constructor(){super(vs.Team),this.planTier}}const Js=e=>e.toLowerCase().split(" ").map((e=>e.charAt(0).toUpperCase()+e.substring(1))).join(" "),Qs=(e,t,a)=>1===Math.abs(a)?e:t,Zs=new Date,el=(e,t)=>{const a=e.getTime(),o=t.getTime();return Math.round(Math.abs(a-o)/864e5)},tl=(e,t)=>{if(!Gs(e.planTier).isPaid)return 0;const a=e.users.length;return Math.max(0,t.quantity-a)};function al(e){const[t,a]=r.exports.useState(1);return r.exports.useEffect((()=>{const t=setInterval((()=>{a((e=>e+1))}),e);return()=>clearInterval(t)}),[e]),t}function ol(e,t,a,o){const[n,r]=e<t?[e,t]:[t,e],[i,s]=a<o?[a,o]:[o,a];return n<s&&i<r}function nl(e){return null!==e}function rl(e){return null!=e}function il(e){return new Promise((t=>setTimeout(t,e)))}function sl(){return void 0!==In}const ll="You might want to add { supportsPortals: true } to your render.";function dl(e){return e.map((e=>({value:e,sort:Math.random()}))).sort(((e,t)=>e.sort-t.sort)).map((({value:e})=>e))}function cl(e,t){return[...e].some((e=>t.has(e)))}function ul(e,t){var a;return null!=(a=e.studioLocal.layerTempValues[t])?a:{}}function ml(e,t){var a;return null!=(a=ul(e,t).isEditing)&&a}function pl(e,t){const{idbAssetIds:a}=e.studioLocal;return null!==a&&a.includes(t)}function hl(e){var t;return null==(t=e.studioLocal.layerTempValues.ghost)?void 0:t.mIGhostLayerAbsolutePosition}function gl(e,t){const{draggedTracksOverrides:a}=e.studioLocal;return!!(a||{})[t]}const yl=c((e=>e.studioLocal.isProjectFetched),(e=>e.studioLocal.lastSyncedWithServer),(e=>e.userPermissions.canWrite),((e,t,a)=>{const{attempted:o,firstAttemptSinceLastSuccess:n,succeeded:r}=t;if(!a)return!1;if(!e)return!1;if(!(o.websocket||o.http))return!1;const i=[r.websocket,r.http].filter(nl),s=[n.websocket,n.http].filter(nl);if(0===s.length)return!1;if(1===s.length){if(n.websocket&&n.websocket<=(r.http||0))return!1;if(n.http&&n.http<=(r.websocket||0))return!1}const l=i.length>0?Math.max(...i):0;if(Date.now()-l<122e3)return!1;const d=s.length>0?Math.max(...s):0;return Date.now()-d>122e3})),fl="media-sidebar",El={audio:"Audio",elements:"Elements",emojis:"Emojis",help:"Help",images:"Images",layers:"Layers",media:"Media",more:"More",plugins:"Plugins",record:"Record",scenes:"Scenes",shapes:"Shapes",soundEffects:"Sound Effects",subtitles:"Subtitles",templates:"Templates",text:"Text",transcript:"Transcript",transitions:"Transitions",videos:"Videos"},vl=6,wl=12,bl=6,_l=12,Tl=4,Sl=8,Il=s.exports.memoize((e=>{const t=new f.exports.UAParser;return{browser:t.getBrowser(),device:t.getDevice(),os:t.getOS()}})),xl=()=>{var e;return Il(null==(e=null==window?void 0:window.navigator)?void 0:e.userAgent)};function kl(){return"chrome"in window}function Cl(){const e=xl().browser.name;return"Chromium"===e||(null==e?void 0:e.startsWith("Chrome"))||!1}function Al(){return"mobile"===xl().device.type}function Nl(){return"iOS"===xl().os.name}function Pl(){var e;return null==(e=xl().browser.name)?void 0:e.includes("Mobile Safari")}function Rl(){var e;return null==(e=xl().browser.name)?void 0:e.includes("Safari")}function Ll(){var e;return null==(e=xl().browser.name)?void 0:e.includes("Firefox")}function Dl(){return["fullscreen","standalone","minimal-ui"].some((e=>window.matchMedia(`(display-mode: ${e})`).matches))}class Ol{static getOS(){return xl().os}static isMac(){var e;return null==(e=xl().os.name)?void 0:e.includes("Mac OS")}static isWindows(){var e;return null==(e=xl().os.name)?void 0:e.includes("Windows")}static isLinux(){var e;return null==(e=xl().os.name)?void 0:e.includes("Linux")}static isChromium(){var e;return null==(e=xl().os.name)?void 0:e.includes("Chromium OS")}}const Fl=e=>{var t;return null!=(t=e.sessionValues.hideTimeline)&&t},Ml=e=>{var t;return null==(t=Vl(e,"snapInTimeline"))||t},Ul=e=>{var t,a;const o=Al();if(!e.userPermissions.canWrite){return(null==(t=e.selectedTabs)?void 0:t["media-sidebar"])===El.help}return null!=(a=e.projectSessionSettings.mediaSidebar)?a:!o},Bl=e=>{var t;return null!=(t=Vl(e,"rippleMode"))&&t},Wl=e=>{var t;return null!=(t=e.projectSessionSettings.pxInSecond)?t:null};function Vl(e,t){var a,o,n;return e.currentUser.user._id?null==(o=null==(a=e.studio.userSpecificSettings)?void 0:a[e.currentUser.user._id])?void 0:o[t]:null==(n=e.studio.userSpecificSettingsAnonymous)?void 0:n[t]}function jl(e){const{selectedItem:t,groups:a,timelineGap:o,allLayers:n}=e.studio,r=(null==t?void 0:t.id)||"";return a&&a[r]?{type:"group"}:o&&o.gapId===r?{type:"gap"}:n.byId[r]}const Gl=c((e=>e.studio.showCanvas),(e=>!!Object.entries(e.studio.allLayers.byId).length),((e,t)=>!e&&!t));function Hl(e,t=!1){return{type:"SET_EDIT_HISTORY_INDEX",historyIndex:e,usedUndo:t}}function zl(e){return{type:"SET_EDIT_HISTORY_INDEX_MINIMUM",historyIndexMinimum:e}}const $l={index:-1,actions:[],batches:[]},Kl={...$l};function Yl(e){return!!e.func}function ql(e,t){const{dispatch:a}=tn();e&&(t?Yl(e.undo)?e.undo.func(e.undo):a(e.undo):Yl(e.redo)?e.redo.func(e.redo):a(e.redo))}const Xl=(e,t)=>{Jl.add({undo:{func:()=>{t()}},redo:{func:()=>{e()}}})},Jl={getState:()=>Kl,setMinimumIndex(e=!0){const{dispatch:t}=tn();t(zl(e?Kl.index:-1))},beginBatch(){const{batches:e}=Kl;e.push([])},endBatch(){const{batches:e}=Kl,t=e.pop();null!=t?0!==t.length&&Jl.add({undo:{func(){m.exports.batch((()=>{for(let e=t.length-1;e>=0;e-=1){ql(t[e],!0)}}))},batch:t},redo:{func(){m.exports.batch((()=>{for(let e=0;e<t.length;e+=1){ql(t[e],!1)}}))},batch:t}}):console.error("Tried to endBatch while no batch is active.")},execInUndoBatch(e){try{this.beginBatch(),e()}catch(YEe){console.error(YEe)}finally{this.endBatch()}},withUndoBatch(e){return(...t)=>{try{return this.beginBatch(),e(...t)}finally{this.endBatch()}}},withUndoBatchAsync(e){return async(...t)=>{try{return this.beginBatch(),await e(...t)}finally{this.endBatch()}}},add(e){var t;const{actions:a,batches:o,index:n}=Kl,r=o.pop(),i=r||a;let l=null!=(t=null==r?void 0:r.length)?t:n,d=[...i];r||(n!==i.length-1&&(d=i.slice(0,n+1)),i.length>=1e3&&(d=d.slice(1),l-=1),i.length>-1&&(l+=1)),d.push(s.exports.cloneDeep(e)),r?o.push(d):(Kl.actions=d,Kl.index=l,Zl())},canUndo(){const{state:e}=tn(),{index:t}=Kl,a=Ql();return!(e.studio.overlayMounted||e.studio.disableUndo||e.studio.historyIndexMinimum===t||a&&ml(e,a.id)||"isStudio"in e&&!0!==e.isStudio||t<0||!e.userPermissions.canWrite)},undo(){const{dispatch:e}=tn(),{index:t,batches:a}=Kl;if(a.length>0)throw Error("Tried to undo while batch exists.");if(!Jl.canUndo())return;const o=t-1;Kl.index=o;const n=Kl.actions[t];n&&ql(n,!0),e(Hl(o,!0)),Zl()},canRedo(){const{state:e}=tn(),{index:t,actions:a}=Kl,o=Ql();return!(e.studio.overlayMounted||e.studio.disableUndo||o&&ml(e,o.id)||"isStudio"in e&&!0!==e.isStudio||t===a.length-1||!e.userPermissions.canWrite)},redo(){const{dispatch:e}=tn(),{index:t,batches:a}=Kl;if(a.length>0)throw Error("Tried to redo while batch exists.");const o=t+1;if(!Jl.canRedo())return;Kl.index=o;const n=Kl.actions[o];n&&ql(n,!1),e(Hl(o,!0)),Zl()},reset(){const{dispatch:e}=tn();Object.assign(Kl,$l),e(Hl(-1)),Zl()}},Ql=()=>{const{state:e}=tn(),t=jl(e);return t?"group"===t.type||"gap"===t.type?null:t:null};let Zl=()=>{setTimeout((()=>{ed.forEach((e=>e()))}),0)};const ed=new Set,td=()=>{const[e,t]=r.exports.useState(0);r.exports.useEffect((()=>{const e=()=>t((e=>e+1));return ed.add(e),()=>{ed.delete(e)}}),[])},ad=()=>(td(),Jl.canUndo()),od=()=>(td(),Jl.canRedo());"undefined"!=typeof window&&(window.editHistoryState=Kl);const nd=e=>{const{teams:t}=null!=e?e:tn().state,{allTeams:a,selectedTeamId:o}=t;if(!o||!a.length)return Ds;try{return t.allTeams.find((e=>e._id===t.selectedTeamId))}catch(YEe){throw console.error("Unable to find current team..."),new Error(`Unable to find team - ${t} - ${null==t?void 0:t.selectedTeamId}`)}},rd=e=>{const{teams:{allTeams:t}}=tn().state;return t.find((t=>t._id===e))||Ds},id=()=>{const{allTeams:e,selectedTeamId:t}=tr((e=>{var t,a;return{allTeams:null==(t=e.teams)?void 0:t.allTeams,selectedTeamId:null==(a=e.teams)?void 0:a.selectedTeamId}}),ar),a=e[0];if(!t||!a)return Ds;const o=null==e?void 0:e.filter((e=>!!e)).find((e=>e._id===t));return o||a},sd=()=>{const e=id();if(!e)return Gs(vs.Free);let{planTier:t}=e;return t||(t=vs.Free),Gs(t)},ld=()=>{const e=nd();if(!e)return Gs(vs.Free);let{planTier:t}=e;return t||(t=vs.Free),Gs(t)},dd=e=>{const t=rd(e);let{planTier:a}=t;return a||(a=vs.Free),Gs(a)},cd=e=>{let{planTier:t}=e;return t||(t=vs.Free),Gs(t)},ud=e=>e?e.status:"unknown",md=e=>e&&e.plan&&e.plan.interval?e.plan.interval:Es.Month,pd=e=>!!e&&"past_due"===e.status,hd=e=>!!e&&"active"===e.status,gd=e=>e?{status:ud(e),interval:md(e),isPastDue:pd(e),isActive:hd(e),isCancelled:!!e.cancel_at_period_end,numPaidSeats:e.quantity}:{status:"unknown",interval:Es.None,isPastDue:!1,isActive:!1,isCancelled:!1,numPaidSeats:0},yd=e=>{const{interval:t}=gd(e);return"month"===t},fd=e=>{const{cancel_at_period_end:t}=e;if(yd(e))return!!t;return el(new Date(e.current_period_end),Zs)<30},Ed=({interval:e,capitalize:t=!0})=>{switch(e){case Es.Month:return t?"Monthly":"monthly";case Es.Year:return t?"Annually":"annually";case Es.None:default:return t?"Never":"never"}};function vd(e){return e.type===ln.Audio}function wd(e){return e.type===ln.Image}function bd(e){return e.type===ln.Shape&&"progressBar"===e.shapeType}function _d(e){return e.type===ln.Video}function Td(e){return e.type===ln.Text&&"ttsAudio"in e&&void 0!==e.ttsAudio}function Sd(e){return e.type===ln.Text}function Id(e){return e.type===ln.Shape}function xd(e){return wd(e)||vd(e)||_d(e)}function kd(e){return wd(e)||Id(e)||Sd(e)||_d(e)}function Cd(e){return e.type===ln.Subtitle}function Ad(e){const t=[];return e.forEach((e=>{(_d(e)||vd(e)||Td(e))&&t.push(e)})),t}function Nd(e,t){if(e){const a=e[t];null!=a&&"number"!=typeof a&&(e[t]=Number(a))}}function Pd(e){let{startTime:t,endTime:a,videoDelay:o,duration:n,playbackRate:r}=e;return null==n&&(n=3),null==t&&(t=0),null==a&&(a=n),null==o&&(o=0),null==r&&(r=1),{startTime:t,endTime:a,videoDelay:o,duration:n,playbackRate:r}}const Rd=(e,t=0,a=!1)=>{if(!e||0===Object.keys(e).length)return{start:0,end:0};Nd(e,"startTime"),Nd(e,"endTime"),Nd(e,"duration"),Nd(e,"videoDelay");const o=e.type===ln.Video||e.type===ln.Audio?e.videoDelay||0:e.startTime||0;let n=Ld(e)||t;e.loopMode&&"duration"===e.loopMode&&t&&!a&&(n=t);return{start:o,end:n+o}},Ld=e=>{const t=e.playbackRate||1;let a=0;return e.isTrimmed?a=e.endTime-e.startTime:e.duration&&(a=e.duration),a/t},Dd=e=>e&&0!==Object.keys(e).length?(Nd(e,"globalAlpha"),e.globalAlpha):0,Od=(e,t,a)=>{const{crop:o}=a;let n=e,r=t;if(a.width&&a.height){let e=a.width/a.height;o&&(e*=o.width/o.height),n/r>e?r=n/e:n=r*e,o&&(n*=100/o.width,r*=100/o.height)}return{width:n,height:r}};function Fd(e,t){return Math.floor(Math.ceil(100*e*t.maxFramerate)/100)}function Md(e,t,a){const{start:o,end:n}=Rd(e,a.duration),r=Fd(o,a),i=Fd(n,a);return 0===o&&0===n&&0===a.duration||r<=t&&t<i}function Ud(e,t,a){const{start:o,end:n}=Rd(e,a.duration);return o<=t&&t<n}var Bd=(e=>(e.REQUEST_TO_EDIT_SENT="Request to Edit Sent",e.SYNC_VIDEO_TO_SHARED_DOC="Sync Video To Shared Doc",e.PROJECT_STUDIO_LINK_VISITED="Project Studio Link Visited",e.FAILED_TO_DISPATCH_TO_EXPORT_CLUSTERS="Failed to Dispatch to Export Clusters",e.ACCESS_FINAL_VIDEO_PAGE="Access Final Video Page",e.ACCESS_SNAPSHOT_PAGE="Access Snapshot Page",e.ACCESS_EXPIRED_EXPORT="Access Expired Export",e.SHARE_FINAL_VIDEO="Share Final Video",e.CONVERT_PROJECT_TO_BRAND_TEMPLATE_DROPDOWN="Make a brand template from the project's workspace dropdown",e.COPY_PROJECT="Copy Project",e.DELETE_TEAM_WORKSPACE="Delete Workspace",e.INITIATE_DELETE_WORKSPACE="Initiate Delete Team Workspace",e.MOVE_PROJECT="Move Project",e.NEW_BRAND_TEMPLATE_STUDIO="Start a new brand template within the studio",e.NEW_PROJECT_STUDIO="Start a new project within the studio",e.TRIM_WITH_TRANSCRIPT_OPEN_TAB="Trim with Transcript - Opened Tab",e.TRIM_WITH_TRANSCRIPT_START_GENERATE="Trim with Transcript - Started Generation",e.TRIM_WITH_TRANSCRIPT_VIEW_TRANSCRIPT="Trim with Transcript - Viewed Transcript",e.TRIM_WITH_TRANSCRIPT_TRIMMED_TRANSCRIPT="Trim with Transcript - Trimmed Transcript",e.DISMISSED_WORKSPACE_DETAILS_SIDEBAR_UPSELL="Dismissed Workspace Details Sidebar Upsell",e.RECENT_EXPORTS_TO_VERSION_HISTORY="Recent Exports to Version History",e.SHOWN_WORKSPACE_DETAILS_SIDEBAR_UPSELL="Shown Workspace Details Sidebar Upsell",e.UPDATE_TEAM_JOIN_LINK="Update Team Join Link",e.OPEN_SEAT_ADDED="Open Seat Added",e.OPEN_SEAT_REMOVED="Open Seat Removed",e.LEFT_TEAM="Left Team",e.UPGRADE_MONTHLY_TO_ANNUAL="Upgrade Monthly to Annual",e.TEAM_CREATED="Team Created - Team",e.TEAM_DISBANDED="Team Disbanded - Team",e.TEAM_UPGRADE_WORKSPACE="Upgrade Workspace - Team",e.TEAM_DOWNGRADE_WORKSPACE="Downgrade Workspace - Team",e.TEAM_PAID_SEATS_ADDED="Paid Seats Added - Team",e.TEAM_PAID_SEATS_REMOVED="Paid Seats Removed - Team",e.CANCEL_SCHEDULED_PROJECT_DELETION_EMAILS="Cancel Scheduled Project Deletion Emails",e.RETRY_DISPATCH_FROM_HEROKU="Retry Dispatch From Heroku",e))(Bd||{});const Wd={videoId:"Video ID",diffInSec:"diffInSec",projectOwnerEmail:"Project Owner Email",shareType:"Share Type",url:"URL",amountTrimmedSec:"Amount Trimmed (sec)",message:"message",statusMessage:"statusMessage",destinationTeamId:"Destination Team ID",isOriginalOwner:"Is Original Owner",numberOfProjects:"Number of Projects",originalTeamId:"Original Team ID",projectAction:"Project Action",numberWorkspaceMembers:"Number of Workspace Members",isTeamMember:"Is Team Member",teamId:"Team ID",teamPlan:"Team Plan",userId:"User ID",currentPlan:"Current Plan",filledOrOpen:"Filled or Open",interval:"Monthly/Annual",monthlyAnnual:"Monthly/Annual",newPaidSeats:"New Paid Seats",numSeatsAdded:"Number of Paid Seats Added",numSeatsRemoved:"Number of Paid Seats Removed",purchasedPlan:"Purchased Plan",quantity:"Quantity",seatsCancelled:"Seats cancelled",subscriptionStatus:"Subscription Status",entryPoint:"Entry Point",appType:"App Type",appVersion:"App Version",canaryServer:"Canary Server",hostname:"hostname",action:"Action",snapshotId:"Snapshot ID",exportType:"Export Type",attempt:"attempt",success:"success"},Vd={currentPlan:jd,purchasedPlan:jd};function jd(e){var t;if(!e)return;return null==(t=Gs(e))?void 0:t.name}const Gd=(e={})=>{const t={};for(const a in e)if(Object.prototype.hasOwnProperty.call(e,a)&&void 0!==e[a]){const o=Vd[a]||(e=>e);t[Wd[a]]=o(e[a])}return t};function Hd(e){var t;if(!e)return"";if("string"!=typeof e)return"";try{const a=(null!=(t=e.split(/#|\?/)[0])?t:"").split(".").pop();return(null!=a?a:"").trim()}catch{return""}}function zd(e){const t=Hd(e);return""===t?"project":"jpg"===t||"png"===t||"jpeg"===t?"image":"gif"===t||"webp"===t?"gif":"mp3"===t?"audio":"video"}function $d(e){let t="";const{isCreator:a,origin:o}=e;t=e.isTrimmedOnly||e.isAudioTrimmedOnly?"Trimmed":e.memeTemplate||a&&"memeMaker"===o?"Meme":e.isStopMotionVideo?"Stop Motion":a&&"subtitler"===o?"Subtitled":e.isLooped?"Looped":e.isMontage?"Montage":e.isCollage||a&&"collage"===o?"Collage":e.isMuted?"Muted":e.isReversed?"Reversed":e.isImageVideo?"Converted Image":e.isTextVideo||a&&"addText"===o?"Text Added":e.isRotate?"Rotated":e.isSpeedVideo?"Speed Change":e.isConvertVideo?"Converted":e.isCreator||e.isStudio?"Studio":"Edited";const n=zd(e.fullPath);return t+=` ${n.charAt(0).toUpperCase()}${n.slice(1)}`,t}function Kd(e){const{state:t}=tn(),{currentUser:a}=t;return e===a.user._id}function Yd(e){const{state:t}=tn(),{teams:a}=t;return!!a.allTeams.find((t=>t._id===e))}const qd=e=>{var t;return null==(t=null==window?void 0:window.fbq)?void 0:t.call(window,"trackCustom",e)};function Xd(e,t=0){const[a,o]=[Math.min(e,t),Math.max(e,t)],n=Math.abs(o-a);return[...Array(n+1).keys()].map((e=>e+a))}function Jd(e,t,a){return`${e} ${1===e||-1===e?t:a||`${t}s`}`}function Qd(e,t=2){return+parseFloat((null!=e?e:0).toString()).toFixed(t)}function Zd(e){return e.reduce(((e,t)=>(e[t.id]=t,e)),{})}const ec=(e,t)=>{if(!e||!t)return!1;return e.split("@")[1]===t.split("@")[1]};function tc(e,t){return e.length>t?`${e.substr(0,t-1)}...`:e}const ac=()=>{const e=document.domain||"",t=e.startsWith("localhost");return e.endsWith(".kapwing-dev.com")||e.startsWith("kapwing-dev")&&e.endsWith(".herokuapp.com")||t&&["3000","4000","5000"].includes(window.location.port)||e.startsWith("192.")||e.startsWith("10.0.")||e.startsWith("10.1.")},oc=e=>e.toLowerCase().split(" ").map((e=>e.charAt(0).toUpperCase()+e.substring(1))).join(" ");let nc=1e5;function rc(e){return(e/100).toLocaleString("en-US",{style:"currency",currency:"USD"})}function ic(e,t,a){let o;return e.has(t)?(o=e.get(t),a.update&&(o=a.update(o),e.set(t,o))):(o=a.insert(),e.set(t,o)),o}function sc(e){const{user:t,token:a}=e||{};return!(s.exports.isEmpty(t)||!a)}const lc=()=>sc(tr((e=>e.currentUser)));function dc(e){if(!sc(e))return!1;const{accountType:t}=e.user;return t===di.admin}function cc(e){var t;if(!sc(e))return!1;const{onboarding:a}=e.user,o=null==(t=null==a?void 0:a.survey)?void 0:t.occupation;return"student"===o||"teacher"===o}function uc(e){if(!sc(e))return"";const{user:t}=e,{name:a,firstName:o,lastName:n}=t;return a||(o&&n?`${o} ${n}`:o||(n||""))}function mc(e){if(!sc(e))return"";const{user:t}=e,{name:a,firstName:o}=t;let n="";try{if(o){const e=o.split(" ")[0];e&&(n=tc(e,24))}else if(a){const e=a.split(" ")[0];e&&(n=tc(e,24))}}catch(YEe){}return n}function pc(e){if(!sc(e))return"";const{user:t}=e,{email:a}=t;return a||""}function hc(){if("undefined"==typeof window||"undefined"==typeof document)return!1;let e=null;try{e=localStorage.getItem("isTWA")}catch(YEe){console.error(YEe)}return"getDigitalGoodsService"in window&&e&&window.matchMedia("(display-mode: standalone)").matches}var gc=(e=>(e.GetStarted="Get Started",e.Sample="Sample",e.NewContentWorkspace="New Content (Workspace)",e.EditThisTemplate="Edit this Template",e.PasteALink="Paste a Link",e.UploadFiles="Upload File(s)",e))(gc||{});us();let yc=!1;if("undefined"!=typeof window){const e=document.domain||"",t=e.startsWith("localhost");yc=e.endsWith(".kapwing-dev.com")||e.startsWith("kapwing-dev")&&e.endsWith(".herokuapp.com")||t&&["3000","4000","5000"].includes(window.location.port)||e.startsWith("192.")||e.startsWith("10.0.")||e.startsWith("10.1.")}let fc=[];"undefined"!=typeof window&&(window.onload=()=>{us()},window.addEventListener("online",(()=>{const e=[...fc];fc=[],e.forEach((e=>{e.userId&&amplitude.getInstance().setUserId(e.userId),amplitude.getInstance().logEvent(e.eventName,{...e.eventProperties,"Event Sent While Offline":!0,"Offline Event Time":e.dateTime},(()=>{}),(()=>{navigator.onLine?console.error(`Error submitting event ${e.eventName}: `,e.eventProperties):fc.push(e)}))}))})));const Ec=(e,t={},a={})=>{var o,n;try{const{state:r}=tn(),i=null==(n=null==(o=r.currentUser)?void 0:o.user)?void 0:n._id;(a.overrideUserId||i)&&amplitude.getInstance().setUserId(a.overrideUserId||i);const s=((e={})=>{var t,a,o;const{state:n}=tn(),{currentVideo:r,studio:i,teams:s}=n||{};if(amplitude.getInstance().setUserProperties({"Workspace Count":s.allTeams.length}),!e.videoId){const{_id:t}=r||{},{_id:a}=i||{},o=a||t;o&&(e.videoId=o)}if(!e.currentPlan){const t=ld();e.currentPlan=t.planTier,e.teamPlan=t.name}if(!e.teamId){const n=nd();n&&(e.teamId=n._id,e.numberWorkspaceMembers=null!=(o=null==(t=n.teamUserDTOs)?void 0:t.length)?o:null==(a=n.users)?void 0:a.length)}const l=cs(),d=yc?l:"v2023.06.13.1";return e.appVersion=d,e.canaryServer=!1,e.appType=hc()?"Android":"Web",e.hostname=window.location.hostname,{...e,...Tc()}})(t);amplitude.getInstance().logEvent(e,Gd(s),(()=>a.onSuccess?a.onSuccess():null),(()=>{navigator.onLine?console.error(`Error submitting event ${e}: `,t):fc.push({eventName:e,eventProperties:t,dateTime:new Date,userId:i})}))}catch(YEe){console.error(`Error submitting event ${e}: `,t)}};function vc(e,t={}){const{state:a}=tn(),{currentUser:o,currentVideo:n,studio:r,teams:i}=a||{},{user:s}=o||{},{_id:l}=s||{};if(l&&amplitude.getInstance().setUserId(l),amplitude.getInstance().setUserProperties({"Workspace Count":i.allTeams.length}),!t["Video ID"]){const{_id:e}=n||{},{_id:a}=r||{},o=a||e;o&&(t["Video ID"]=o)}if(l&&(t["Team ID"]=i.selectedTeamId),!t["Current Plan"]){const e=ld();t["Current Plan"]=e.name}const d=cs(),c=yc?d:"v2023.06.13.1";t["App Version"]=c,t["Canary Server"]=!1,t["App Type"]=hc()?"Android":"Web",t.hostname=window.location.hostname,Object.assign(t,Tc()),amplitude.getInstance().logEvent(e,t,(()=>{}),(()=>{navigator.onLine?console.error(`Error submitting event ${e}: `,t):fc.push({eventName:e,eventProperties:t,dateTime:new Date,userId:l})}))}function wc(){const{state:e,dispatch:t}=tn();(e.projectSessionSettings.splitsLogged||0)<100&&(vc("Split Video Layer",{}),t(hr()))}function bc(e,t){const{state:a,dispatch:o}=tn();(a.projectSessionSettings.addLayerLogged||0)<50&&"video"===e&&(vc("Add Video Layer To Project",{place:t}),o(pr()))}function _c(e){var t;const{state:a,dispatch:o}=tn();((null==(t=a.projectSessionSettings.trimsLogged)?void 0:t[e])||0)<2&&(o(gr(e)),vc("Used Trimmer",{location:e}))}function Tc(){return{...hs(),maxExportDurationNonPro:420}}function Sc(e,t,a,o=!1){let n={Email:e.email,"Entry Point":a};o&&(n={...n,"Google One-Tap":!0}),amplitude.getInstance().setUserId(e._id),amplitude.getInstance().setUserProperties({Email:e.email}),t?(amplitude.getInstance().logEvent("Create Account",n),qd("Create Account"),an("Create Account")):amplitude.getInstance().logEvent("Log In",n)}function Ic({interval:e,planTier:t,upgradeSource:a,teamId:o,quantity:n,extraAmplitudeEventProperties:r,couponId:i=null}){const s=kc(a),l=Js(t);vc("Upgrade Workspace",{"Monthly/Annual":Ed({interval:e}),"License Tier Purchased":l,"Upgrade Source":s,"Team ID":o,"Number of Workspace Members":n,Coupon:i,...r});const d={"Account Type":l};i&&(d.Coupon=i),amplitude.getInstance().setUserProperties(d),qd("Upgraded")}function xc(e,t){vc("Timing Tab Exact Time Set",{"Layer Type":t,"Start or End Input":e})}const kc=e=>{var t;return e&&(null==(t=Bs[e].metadata)?void 0:t.prettyUpgradeSource)||e};function Cc(e,t,a){const{analytics:o,magicSubtitles:n,scenes:r}=t;if(o&&(o.usedSplit&&(e["Used Split"]=!0),e["Number of Video Splits"]=Dr(a.studio),o.usedCollaboration&&(e["User Collaboration"]=!0),o.usedCollaborationWithOtherUser&&(e["User Collaboration With Other User"]=!0),o.usedSmartCut&&(e["Used Smart Cut"]=!0),o.usedSceneSplit&&(e["Used Scene Split"]=!0),o.usedCanvasResize&&(e["Used Canvas Resize"]=!0),o.usedGroupDrag&&(e["Used Group Drag"]=!0),o.usedGroupTrim&&(e["Used Group Trim"]=!0)),r){let t=0;const o=new Set;for(const n of r)for(const r of n.layers){const n=Lr(r,a.mediaCache);r.type===ln.Video&&n&&o.add(n),r.type===ln.Subtitle&&(e["Has Subtitles"]=!0),r.type===ln.Text&&(e["Has Text"]=!0,t+=1)}e["Number of Video Input Files"]=o.size,e["Number of Text Layers"]=t,(e=>{for(const t of e)for(const e of t.layers)if("text-to-speech"===e.usedProFeature)return!0;return!1})(r)&&(e["Used Text to Speech"]=!0)}n&&Object.values(n).some((e=>null==e?void 0:e.enabled))&&(e["Has Magic Subtitles"]=!0),t.duration&&(e.Duration=t.duration)}function Ac(e=window.location.pathname){var t,a,o,n;const{state:{currentUser:r,mediaCache:i,studioLocal:{initialIDBAssetIdLoadDone:s,isProjectFetched:l,idbAssetIds:d,isNewProject:c},studio:u}}=tn(),{creatorEmail:m,scenes:p}=u;if(!(s&&l||c))return;const h=new Set(d);let g=0,y=!1;for(const S of p)for(const e of S.layers){const t=Lr(e,i);xd(e)&&t&&!h.has(t)&&(g+=1,e.type===ln.Video&&(y=!0))}const f={"Video Id":u._id,"N Remote Layers":g,"Has Remote Video":y,"Project Owner Email":m};let E=u.origin;const v=e.includes("/sharing");v&&(E="Project Share");const{history:w}=tn(),b=(null==(t=w.location.state)?void 0:t.from)===mi;b&&(E="Shared with Me");let _=!1;const T=null==(a=r.user)?void 0:a.email;sc(r)&&(_=ec(T,m)),f.Origin=E,f["Owner And Collaborator Domain Match"]=_,f["Project Collaborator Email"]=T||"Anonymous",f["Is Team Member"]=Yd(null!=(o=u.teamId)?o:""),f["Is Project Owner"]=Kd(null!=(n=u.creatorId)?n:""),(g>0||v||b)&&vc("Remote Re-Edit Started",f)}const Nc=new Map;function Pc({accountType:e}){switch(e){case di.student:return"Student";case di.teacher:return"Teacher"}switch(e){case di.admin:return"Admin";case di.free:return"Free"}return null}function Rc(e,t){const a={};a["Add Transition Method"]=e,a["Transition Name"]=t,vc("Add Transition",a)}const Lc=[];function Dc(e,t={}){const a=()=>vc(e,t);return Lc.push(a),()=>{const e=Lc.indexOf(a);e>-1&&Lc.splice(e,1)}}"undefined"!=typeof window&&(window.amplitudeOnExit=()=>{for(const e of Lc)e()});const Oc=(e,t,a,o)=>{if(!o.includes("/sharing")&&!o.includes("/invites"))return;const{currentFolderId:n,currentVideoId:r,creatorEmail:i,workspaceOwnerEmail:s,teamId:l,teamOwnerEmail:d}={currentFolderId:(c=tn().state).workspaces.sharedWorkspaceId,currentVideoId:c.studio._id,creatorEmail:c.studio.creatorEmail,workspaceOwnerEmail:c.workspaces.workspaceOwnerEmail,teamId:c.teams.sharedTeamId,teamOwnerEmail:c.teams.sharedTeamOwnerEmail};var c;const u=null==o?void 0:o.includes("/studio/editor"),m=null==o?void 0:o.includes("team");let p,h,g,y,f;u?(p="Studio Project",h="Video ID",g=r,y="Project Owner Email",f=i):m?(p="Team",h="Team ID",g=l,y="Team Owner Email",f=d):(p="Folder",h="Folder ID",g=n,y="Folder Owner Email",f=s);const E=ec(e.email,f),v={"Share Flow":p,"Sign In Method":a,Email:e.email,"New User":t,[h]:g,[y]:f,"Owner and Collaborator Domain Match":E};amplitude.getInstance().setUserId(e._id),amplitude.getInstance().setUserProperties({Email:e.email}),amplitude.getInstance().logEvent("Share Sign In Success",v)},Fc=(e,t,a,o,n,r)=>{const i={"Project Owner Email":a,"Sharer Email":e.email,"Share Type":n,"Video ID":t,"Share Origin":o};void 0!==r&&(i["Is Sharing with Team Member"]=r),amplitude.getInstance().setUserId(e._id),amplitude.getInstance().setUserProperties({Email:e.email}),amplitude.getInstance().logEvent("Project Share Completed",i)},Mc=(e,t,a={})=>{const{includeTimestamp:o,teamId:n,creatorId:r}=a,i={"Activity type":e,"Comment location":t};o&&(i["Timestamp included"]=o),n&&(i["Is Team Member"]=Yd(n)),r&&(i["Is Project Owner"]=Kd(r)),vc("New Comment Activity",i)},Uc=(e,t)=>{vc("Changed Text Outline Color",{layerType:e,color:t})},Bc=()=>{var e,t;return null==(t=null==(e=null==amplitude?void 0:amplitude.getInstance())?void 0:e.getSessionId)?void 0:t.call(e)},Wc=e=>e/1024/1024,Vc=()=>{if(!("memory"in performance))return{};const e=performance.memory;return{"Heap Size Limit":Wc(e.jsHeapSizeLimit),"Total Heap Size":Wc(e.totalJSHeapSize),"Used Heap Size":Wc(e.usedJSHeapSize)}};const jc=new class{constructor(){if(a(this,"storageEvictionAttempts",0),a(this,"supported"),a(this,"evictOldVideoUsageKeys",s.exports.throttle((()=>{const e=Date.now();try{for(let t=0;t<localStorage.length;t++){const a=localStorage.key(t);if(a.startsWith("video_usage_")){const t=this.get(a,{disabled:null});t&&e-t.lastUpdated>432e6&&this.remove(a)}}}catch{}}),216e5,{leading:!0,trailing:!1})),"undefined"==typeof window)return void(this.supported=!1);let e;try{e=typeof localStorage}catch(t){console.error(t)}this.supported=!!e}get(e,t){if(!this.supported)return t.disabled||null;const a=localStorage.getItem(e);if(null===a)return null;try{return JSON.parse(a)}catch(o){return null}}set(e,t){if(!this.supported)return;const a=JSON.stringify(t);try{localStorage.setItem(e,a)}catch(o){this.evictOldSessionsFromStorage(),this.evictOldVideoUsageKeys()}try{localStorage.setItem(e,a)}catch(o){console.error(`Failed to write ${e} in localstorage`,o)}}getAndUnset(e){const t=this.get(e,{disabled:null});return this.remove(e),t}remove(e){this.supported&&localStorage.removeItem(e)}evictOldSessionsFromStorage(){this.storageEvictionAttempts+=1;const e=[];for(let t=0;t<localStorage.length;t+=1){const a=localStorage.key(t);a&&a.startsWith("session_")&&e.push(a)}(1===this.storageEvictionAttempts||Math.random()<.1)&&vc("Localstorage Quota Exceeded",{"Cached Sessions":e.length,"Storage Size (MB)":this.getLocalStorageSizeMB(),"Eviction Attempts":this.storageEvictionAttempts});for(const t of e)Math.random()<.3&&localStorage.removeItem(t)}getLocalStorageSizeMB(){return new Blob(Object.values(localStorage)).size/1e3/1e3}},Gc=()=>!!jc.get("devMode",{disabled:null}),Hc=()=>{(()=>{if(!zo){zo=!0;for(const e of $o)e();$o.clear()}})(),jc.set("devMode",!0)},zc=()=>{jc.remove("devMode")};Gc()&&Hc();const $c=["arrowup","arrowup","arrowdown","arrowdown","arrowleft","arrowright","arrowleft","arrowright","b","a"],Kc=e=>{let t=0;const a=o=>{$c[t]===o.key.toLowerCase()?(t+=1,$c.length===t&&(Hc(),null==e||e(),document.removeEventListener("keydown",a))):t=0};document.addEventListener("keydown",a);return()=>{document.removeEventListener("keydown",a)}},Yc={plugins:(e=[],t)=>{switch(t.type){case"OPEN_PLUGIN":{const a=e.map((e=>e.id));return t.pluginName&&!a.includes(t.pluginName)?[...e,{id:t.pluginName,isMediaLibraryUpload:t.isMediaLibraryUpload,idOfLayerToReplace:t.idOfLayerToReplace}]:[...e]}case"CLOSE_PLUGIN":{const a=e.map((e=>e.id));if(t.pluginName&&a.includes(t.pluginName)){const o=a.indexOf(t.pluginName);if(o>-1)return e.splice(o,1),[...e]}return[...e]}case"RESET_EDITOR":return[];default:return e}},pluginOrder:(e=[],t)=>{switch(t.type){case"OPEN_PLUGIN":return t.pluginName&&!e.includes(t.pluginName)?[...e,t.pluginName]:[...e];case"CLOSE_PLUGIN":if(t.pluginName&&e.includes(t.pluginName)){const a=e.indexOf(t.pluginName);if(a>-1)return e.splice(a,1),[...e]}return[...e];case"PLUGIN_TO_TOP":if(e.includes(t.pluginName)){const a=e.indexOf(t.pluginName);if(a>-1&&a!==e.length-1){const[t]=e.splice(a,1);return[...e,t]}}return[...e];case"RESET_EDITOR":return[];default:return e}}};function qc(e,t,a=null){var o;const n=31536e3;return(new E).set("ssrSignedInCookie",t,{path:"/",expires:new Date(Date.now()+31536e6),maxAge:n,secure:!0}),e.email&&(null==(o=window.profitwell)||o.call(window,"user_email",e.email)),function(e){const t=Pc(e),a=Nc.get(e._id);t&&t!==a&&(amplitude.getInstance().setUserProperties({"Account Type":t}),Nc.set(e._id,t))}(e),{type:"RECEIVE_USER_AND_SET_TOKEN",user:e,token:t,receivedAt:Date.now(),impersonatingAdminEmail:a}}function Xc(){return{type:"REQUEST_USER"}}function Jc(){return(new E).remove("ssrSignedInCookie",{path:"/"}),{type:"SIGN_OUT"}}function Qc(e,t=!1){return a=>gu("/api/v1/users/google/findUser",{body:{user:e}}).then((e=>{a(qc(e.user,e.token));Sc(e.user,e.newUser,"Google",t)}))}function Zc(){return new Worker("/assets/gzip-worker.462a36ed.js")}const eu={Accept:"application/json","Content-Type":"application/json"},tu={method:"GET",parseJSON:!0,timeout:3e4},au="undefined"!=typeof window;function ou(){return au?window.location.host:"localhost:5000"}function nu(){let e=ou();return e=e.startsWith("http")?e.replace("http","ws"):e.startsWith("localhost")?`ws://${e}/websocket`:`wss://${e}/websocket`,e=e.replace("localhost:3000","localhost:5000"),e}function ru(){return["127.0.0.1","localhost"].some((e=>ou().startsWith(e)))}function iu(e){if(e.includeAuth){const o=(null==(a=null==(t=tn().state)?void 0:t.currentUser)?void 0:a.token)||"";o&&(e.headers={"x-access-token":o,...e.headers||{}})}var t,a}function su(e,t){let a=e;const{params:o}=t;if(o){const t=e.includes("?")?"&":"?",n=function(e){return Object.entries(e).filter((([,e])=>null!=e)).map((([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`)).join("&")}(o);a+=`${t}${n}`}return a}async function lu(e,t={}){const a={...tu,...t},{body:o,parseJSON:n,timeout:r,retries:i=0,zipBody:s}=a;let l,d;delete a.parseJSON,delete a.zipBody,a.headers={...eu,...a.headers||{}},"object"==typeof o&&(a.body=JSON.stringify(a.body)),s&&"string"==typeof a.body&&(a.headers={...a.headers,"Content-Encoding":"gzip"},a.body=await async function(e){return new Promise(((t,a)=>{const o=new Zc;o.postMessage(e),o.onmessage=e=>{o.terminate(),t(e.data)},o.onerror=()=>{o.terminate(),a()}}))}(a.body));const c=new Date;let u=null,m=0;const p=au&&window.openReplayFetch;for(;m<=i;){r&&(delete a.timeout,d=new(p?window.AbortController:AbortController),a.signal=t.signal||d.signal,l=setTimeout((()=>{console.debug("timeout on url",e," req sent on ",c," options are ",JSON.stringify(a)),d.abort()}),r));const o=su(e,a);try{const e=p?window.openReplayFetch:v;u=await e(o,a);break}catch(h){if(m>=i||sl())throw h;w({category:"fetch retry",message:`Url ${e} retry ${m}`}),m+=1,await new Promise((e=>setTimeout(e,2**m*1e3)))}finally{l&&clearTimeout(l)}}return u&&!u.ok&&await du(e,u),n?u.json():u}async function du(e,t){let a=t.statusText||"An unexpected error occurred.",o=null;try{const e=await t.json(),{message:n,statusText:r,invalid_token:i,...s}=e;a=n||r||n,Object.keys(s).length>0&&(o=s),i&&(tn().dispatch(Jc()),a="Your token was invalid. Please sign in again.")}catch(n){try{a=await t.text()||a}catch(r){}}throw new cu(a,t.status,e,o)}class cu extends Error{constructor(e,t,o,n){super(e),a(this,"name","FetchStatusError"),this.status=t,this.url=o,this.additionalData=n}}async function uu(e,t={}){return async function(e,t={}){const a={...t,includeAuth:!0};let o;if(iu(a),xn)o=xn;else{o=`https://notifications.${ru()||ou().includes("dev")?"kapwing-dev":"kapwing"}.com`}return lu(`${o}/${e}`,a)}(e,{...t,method:"POST"})}async function mu(e,t={}){const a={zipBody:!0,...t,includeAuth:!0};iu(a);return lu(`${ru()?"http":"https"}://${ou()}${e}`,a)}function pu(e,t={}){return mu(e,{...t,method:"DELETE"})}function hu(e,t={}){return mu(e,{...t,method:"GET"})}function gu(e,t={}){return mu(e,{...t,method:"POST"})}function yu(e,t={}){return mu(e,{...t,method:"PUT"})}function fu(e,t={}){return mu(e,{...t,method:"PATCH"})}function Eu(e,t={}){return function(e,t={}){iu(t);const{CLOUD_FUNCTIONS_PREFIX:a}=tn().state.config;return lu(`https://us-central1-kapwing-181323.cloudfunctions.net/${a}${e}`,t)}(e,{...t,method:"POST"})}const vu={},wu=g({name:"toasts",initialState:vu,reducers:{clearToasts:()=>vu,hideToast:(e,t)=>{const a=e[t.payload];a&&(a.open=!1)},removeToast:(e,t)=>{delete e[t.payload]},showToast:(e,t)=>{if(Object.values(e).some((e=>e.open&&e.type===t.payload.type&&e.link===t.payload.link&&e.description===t.payload.description&&e.subDescription===t.payload.subDescription)))return;e[(nc+=1,String(nc))]={...t.payload,open:!0}}}}),{clearToasts:bu,hideToast:_u,removeToast:Tu,showToast:Su}=wu.actions;function Iu({description:e,error:t}){try{const{dispatch:a}=tn(),{message:o,reportToSentry:n}=xu(t);a(Su({description:e,subDescription:o,type:"error"})),console.error(t),n&&b(t,{extra:{toastDescription:e},tags:{triggeredToast:!0}});let r=e;o&&(r+=`(${o})`),vc("Displayed Toast For Unexpected Error",{message:r})}catch(a){console.error("error handling error: ",a)}}function xu(e,t=""){if(e instanceof cu)return{message:e.message,reportToSentry:!1};if(e instanceof Response)try{du(e.url,e)}catch(o){return xu(o)}let a=t;return"string"==typeof e&&(a=e),e&&"object"==typeof e&&"message"in e&&"string"==typeof e.message&&(a=e.message),{message:a,reportToSentry:!0}}var ku=(e=>(e.DELETE_ACCOUNT="DELETE_ACCOUNT",e.MOVE_PROJECT="MOVE_PROJECT",e.COPY_PROJECT="COPY_PROJECT",e.EMBED_CODE="EMBED_CODE",e))(ku||{});const Cu=g({name:"modal",initialState:{modalProps:{}},reducers:{showModal:(e,t)=>{e.modalProps=t.payload,e.modalResult=void 0},hideModal:(e,t)=>{e.modalResult=t.payload.modalResult,e.modalProps={},e.title=void 0,e.subtitle=void 0},setModalTitle:(e,t)=>{e.title=t.payload.title,e.subtitle=t.payload.subtitle}}}),Au=Cu.actions,Nu=e=>{const{dispatch:t}=tn();return t({type:Au.hideModal.type,payload:{modalResult:e}})},Pu=e=>{const{dispatch:t}=tn();return t({type:Au.showModal.type,payload:{modalType:e.modalType,name:e.name,teamId:e.teamId,projectIds:e.projectIds,projectId:e.projectId,modalStyle:e.modalStyle,onSubmit:async(...t)=>{if(e.onSubmit)try{await e.onSubmit(...t),Nu()}catch(YEe){return void Iu({description:"Failed to submit",error:YEe})}Nu()},onCancel:()=>{e.onCancel&&e.onCancel(),Nu()}}})},Ru=g({name:"explorer",initialState:{teams:[],folders:[]},reducers:{setTeams:(e,t)=>{e.teams=t.payload.teams,t.payload.folders.find((e=>e.sharedAt))&&(e.teams=t.payload.teams.concat({_id:mi,name:"Shared with Me"})),e.folders=t.payload.folders.map((e=>e.sharedAt?{...e,teamId:mi}:e))}}}),Lu=(e=!1)=>async(t,a)=>{const{explorer:o,currentUser:n}=a();if(!sc(n)||o.teams.length&&!e)return;const r=await hu("/api/v1/explorer");t({type:Ru.actions.setTeams.type,payload:r})},Du=e=>{const t=m.exports.useDispatch(),a=lc();r.exports.useEffect((()=>{t(Lu(e))}),[t,e,a]);return{refetchExplorer:r.exports.useCallback((()=>{t(Lu(!0))}),[t])}},Ou=()=>tr((e=>e.explorer)).folders.length>1,Fu=g({initialState:{},name:"sessionValues",reducers:{setOnboarding:(e,t)=>{e.onboarding=t.payload},setShowRequestEditModal:(e,t)=>{e.showRequestEditModal=t.payload},setHideTimeline:(e,t)=>{e.hideTimeline=t.payload}},extraReducers:e=>e.addCase("SIGN_OUT",(e=>{ir(e)}))}),{setOnboarding:Mu,setShowRequestEditModal:Uu,setHideTimeline:Bu}=Fu.actions,Wu=["ABeeZee","Abel","Abhaya Libre","Abril Fatface","Aclonica","Acme","Actor","Adamina","Advent Pro","Aguafina Script","Akronim","Aladin","Alata","Alatsi","Aldrich","Alef","Alegreya","Alegreya SC","Alegreya Sans","Alegreya Sans SC","Aleo","Alex Brush","Alfa Slab One","Alice","Alike","Alike Angular","Allan","Allerta","Allerta Stencil","Allura","Almarai","Almendra","Almendra Display","Almendra SC","Amarante","Amaranth","Amatic SC","Amethysta","Amiko","Amiri","Amita","Anaheim","Andada","Andika","Angkor","Annie Use Your Telescope","Anonymous Pro","Antic","Antic Didone","Antic Slab","Anton","Arapey","Arbutus","Arbutus Slab","Architects Daughter","Archivo","Archivo Black","Archivo Narrow","Aref Ruqaa","Arima Madurai","Arimo","Arizonia","Armata","Arsenal","Artifika","Arvo","Arya","Asap","Asap Condensed","Asar","Asset","Assistant","Astloch","Asul","Athiti","Atma","Atomic Age","Aubrey","Audiowide","Autour One","Average","Average Sans","Averia Gruesa Libre","Averia Libre","Averia Sans Libre","Averia Serif Libre","B612","B612 Mono","Bad Script","Bahiana","Bahianita","Bai Jamjuree","Baloo 2","Baloo Bhai 2","Baloo Bhaina 2","Baloo Chettan 2","Baloo Da 2","Baloo Paaji 2","Baloo Tamma 2","Baloo Tammudu 2","Baloo Thambi 2","Balsamiq Sans","Balthazar","Bangers","Barlow","Barlow Condensed","Barlow Semi Condensed","Barriecito","Barrio","Basic","Baskervville","Battambang","Baumans","Bayon","Be Vietnam","Bebas Neue","Belgrano","Bellefair","Belleza","Bellota","Bellota Text","BenchNine","Bentham","Berkshire Swash","Beth Ellen","Bevan","Big Shoulders Display","Big Shoulders Text","Bigelow Rules","Bigshot One","Bilbo","Bilbo Swash Caps","BioRhyme","BioRhyme Expanded","Biryani","Bitter","Black And White Picture","Black Han Sans","Black Ops One","Blinker","Bokor","Bonbon","Boogaloo","Bowlby One","Bowlby One SC","Brawler","Bree Serif","Bubblegum Sans","Bubbler One","Buda","Buenard","Bungee","Bungee Hairline","Bungee Inline","Bungee Outline","Bungee Shade","Butcherman","Butterfly Kids","Cabin","Cabin Condensed","Cabin Sketch","Caesar Dressing","Cagliostro","Cairo","Caladea","Calistoga","Calligraffitti","Cambay","Cambo","Candal","Cantarell","Cantata One","Cantora One","Capriola","Cardo","Carme","Carrois Gothic","Carrois Gothic SC","Carter One","Catamaran","Caudex","Caveat","Caveat Brush","Cedarville Cursive","Ceviche One","Chakra Petch","Changa","Changa One","Chango","Charm","Charmonman","Chathura","Chau Philomene One","Chela One","Chelsea Market","Chenla","Cherry Cream Soda","Cherry Swash","Chewy","Chicle","Chilanka","Chivo","Chonburi","Cinzel","Cinzel Decorative","Clicker Script","Coda","Coda Caption","Codystar","Coiny","Combo","Comfortaa","Comic Neue","Coming Soon","Concert One","Condiment","Content","Contrail One","Convergence","Cookie","Copse","Corben","Cormorant","Cormorant Garamond","Cormorant Infant","Cormorant SC","Cormorant Unicase","Cormorant Upright","Courgette","Courier Prime","Cousine","Coustard","Covered By Your Grace","Crafty Girls","Creepster","Crete Round","Crimson Pro","Crimson Text","Croissant One","Crushed","Cuprum","Cute Font","Cutive","Cutive Mono","DM Mono","DM Sans","DM Serif Display","DM Serif Text","Damion","Dancing Script","Dangrek","Darker Grotesque","David Libre","Dawning of a New Day","Days One","Dekko","Delius","Delius Swash Caps","Delius Unicase","Della Respira","Denk One","Devonshire","Dhurjati","Didact Gothic","Diplomata","Diplomata SC","Do Hyeon","Dokdo","Domine","Donegal One","Doppio One","Dorsa","Dosis","Dr Sugiyama","Duru Sans","Dynalight","EB Garamond","Eagle Lake","East Sea Dokdo","Eater","Economica","Eczar","El Messiri","Electrolize","Elsie","Elsie Swash Caps","Emblema One","Emilys Candy","Encode Sans","Encode Sans Condensed","Encode Sans Expanded","Encode Sans Semi Condensed","Encode Sans Semi Expanded","Engagement","Englebert","Enriqueta","Epilogue","Erica One","Esteban","Euphoria Script","Ewert","Exo","Exo 2","Expletus Sans","Fahkwang","Fanwood Text","Farro","Farsan","Fascinate","Fascinate Inline","Faster One","Fasthand","Fauna One","Faustina","Federant","Federo","Felipa","Fenix","Finger Paint","Fira Code","Fira Mono","Fira Sans","Fira Sans Condensed","Fira Sans Extra Condensed","Fjalla One","Fjord One","Flamenco","Flavors","Fondamento","Fontdiner Swanky","Forum","Francois One","Frank Ruhl Libre","Freckle Face","Fredericka the Great","Fredoka One","Freehand","Fresca","Frijole","Fruktur","Fugaz One","GFS Didot","GFS Neohellenic","Gabriela","Gaegu","Gafata","Galada","Galdeano","Galindo","Gamja Flower","Gayathri","Gelasio","Gentium Basic","Gentium Book Basic","Geo","Geostar","Geostar Fill","Germania One","Gidugu","Gilda Display","Girassol","Give You Glory","Glass Antiqua","Glegoo","Gloria Hallelujah","Goblin One","Gochi Hand","Gorditas","Gothic A1","Gotu","Goudy Bookletter 1911","Graduate","Grand Hotel","Grandstander","Gravitas One","Great Vibes","Grenze","Grenze Gotisch","Griffy","Gruppo","Gudea","Gugi","Gupter","Gurajada","Habibi","Halant","Hammersmith One","Hanalei","Hanalei Fill","Handlee","Hanuman","Happy Monkey","Harmattan","Headland One","Heebo","Henny Penny","Hepta Slab","Herr Von Muellerhoff","Hi Melody","Hind","Hind Guntur","Hind Madurai","Hind Siliguri","Hind Vadodara","Holtwood One SC","Homemade Apple","Homenaje","IBM Plex Mono","IBM Plex Sans","IBM Plex Sans Condensed","IBM Plex Serif","IM Fell DW Pica","IM Fell DW Pica SC","IM Fell Double Pica","IM Fell Double Pica SC","IM Fell English","IM Fell English SC","IM Fell French Canon","IM Fell French Canon SC","IM Fell Great Primer","IM Fell Great Primer SC","Ibarra Real Nova","Iceberg","Iceland","Imprima","Inconsolata","Inder","Indie Flower","Inika","Inknut Antiqua","Inria Sans","Inria Serif","Inter","Irish Grover","Istok Web","Italiana","Italianno","Itim","Jacques Francois","Jacques Francois Shadow","Jaldi","Jim Nightshade","Jockey One","Jolly Lodger","Jomhuria","Jomolhari","Josefin Sans","Josefin Slab","Jost","Joti One","Jua","Judson","Julee","Julius Sans One","Junge","Jura","Just Another Hand","Just Me Again Down Here","K2D","Kadwa","Kalam","Kameron","Kanit","Kantumruy","Karla","Karma","Katibeh","Kaushan Script","Kavivanar","Kavoon","Kdam Thmor","Keania One","Kelly Slab","Kenia","Khand","Khmer","Khula","Kirang Haerang","Kite One","Knewave","KoHo","Kodchasan","Kosugi","Kosugi Maru","Kotta One","Koulen","Kranky","Kreon","Kristi","Krona One","Krub","Kufam","Kulim Park","Kumar One","Kumar One Outline","Kumbh Sans","Kurale","La Belle Aurore","Lacquer","Laila","Lakki Reddy","Lalezar","Lancelot","Lateef","Lato","League Script","Leckerli One","Ledger","Lekton","Lemon","Lemonada","Lexend Deca","Lexend Exa","Lexend Giga","Lexend Mega","Lexend Peta","Lexend Tera","Lexend Zetta","Libre Barcode 128","Libre Barcode 128 Text","Libre Barcode 39","Libre Barcode 39 Extended","Libre Barcode 39 Extended Text","Libre Barcode 39 Text","Libre Baskerville","Libre Caslon Display","Libre Caslon Text","Libre Franklin","Life Savers","Lilita One","Lily Script One","Limelight","Linden Hill","Literata","Liu Jian Mao Cao","Livvic","Lobster","Lobster Two","Londrina Outline","Londrina Shadow","Londrina Sketch","Londrina Solid","Long Cang","Lora","Love Ya Like A Sister","Loved by the King","Lovers Quarrel","Luckiest Guy","Lusitana","Lustria","M PLUS 1p","M PLUS Rounded 1c","Ma Shan Zheng","Macondo","Macondo Swash Caps","Mada","Magra","Maiden Orange","Maitree","Major Mono Display","Mako","Mali","Mallanna","Mandali","Manjari","Manrope","Mansalva","Manuale","Marcellus","Marcellus SC","Marck Script","Margarine","Markazi Text","Marko One","Marmelad","Martel","Martel Sans","Marvel","Mate","Mate SC","Maven Pro","McLaren","Meddon","MedievalSharp","Medula One","Meera Inimai","Megrim","Meie Script","Merienda","Merienda One","Merriweather","Merriweather Sans","Metal","Metal Mania","Metamorphous","Metrophobic","Michroma","Milonga","Miltonian","Miltonian Tattoo","Mina","Miniver","Miriam Libre","Mirza","Miss Fajardose","Mitr","Modak","Modern Antiqua","Mogra","Molengo","Molle","Monda","Monofett","Monoton","Monsieur La Doulaise","Montaga","Montez","Montserrat","Montserrat Alternates","Montserrat Subrayada","Moul","Moulpali","Mountains of Christmas","Mouse Memoirs","Mr Bedfort","Mr Dafoe","Mr De Haviland","Mrs Saint Delafield","Mrs Sheppards","Mukta","Mukta Mahee","Mukta Malar","Mukta Vaani","Mulish","MuseoModerno","Mystery Quest","NTR","Nanum Brush Script","Nanum Gothic","Nanum Gothic Coding","Nanum Myeongjo","Nanum Pen Script","Neucha","Neuton","New Rocker","News Cycle","Niconne","Niramit","Nixie One","Nobile","Nokora","Norican","Nosifer","Notable","Nothing You Could Do","Noticia Text","Noto Sans","Noto Sans HK","Noto Sans JP","Noto Sans KR","Noto Sans SC","Noto Sans TC","Noto Serif","Noto Serif JP","Noto Serif KR","Noto Serif SC","Noto Serif TC","Nova Cut","Nova Flat","Nova Mono","Nova Oval","Nova Round","Nova Script","Nova Slim","Nova Square","Numans","Nunito","Nunito Sans","Odibee Sans","Odor Mean Chey","Offside","Old Standard TT","Oldenburg","Oleo Script","Oleo Script Swash Caps","Open Sans","Open Sans Condensed","Oranienbaum","Orbitron","Oregano","Orienta","Original Surfer","Oswald","Over the Rainbow","Overlock","Overlock SC","Overpass","Overpass Mono","Ovo","Oxanium","Oxygen","Oxygen Mono","PT Mono","PT Sans","PT Sans Caption","PT Sans Narrow","PT Serif","PT Serif Caption","Pacifico","Padauk","Palanquin","Palanquin Dark","Pangolin","Paprika","Parisienne","Passero One","Passion One","Pathway Gothic One","Patrick Hand","Patrick Hand SC","Pattaya","Patua One","Pavanam","Paytone One","Peddana","Peralta","Permanent Marker","Petit Formal Script","Petrona","Philosopher","Piazzolla","Piedra","Pinyon Script","Pirata One","Plaster","Play","Playball","Playfair Display","Playfair Display SC","Podkova","Poiret One","Poller One","Poly","Pompiere","Pontano Sans","Poor Story","Poppins","Port Lligat Sans","Port Lligat Slab","Pragati Narrow","Prata","Preahvihear","Press Start 2P","Pridi","Princess Sofia","Prociono","Prompt","Prosto One","Proza Libre","Public Sans","Puritan","Purple Purse","Quando","Quantico","Quattrocento","Quattrocento Sans","Questrial","Quicksand","Quintessential","Qwigley","Racing Sans One","Radley","Rajdhani","Rakkas","Raleway","Raleway Dots","Ramabhadra","Ramaraja","Rambla","Rammetto One","Ranchers","Rancho","Ranga","Rasa","Rationale","Ravi Prakash","Recursive","Red Hat Display","Red Hat Text","Red Rose","Redressed","Reem Kufi","Reenie Beanie","Revalia","Rhodium Libre","Ribeye","Ribeye Marrow","Righteous","Risque","Roboto","Roboto Condensed","Roboto Mono","Roboto Slab","Rochester","Rock Salt","Rokkitt","Romanesco","Ropa Sans","Rosario","Rosarivo","Rouge Script","Rowdies","Rozha One","Rubik","Rubik Mono One","Ruda","Rufina","Ruge Boogie","Ruluko","Rum Raisin","Ruslan Display","Russo One","Ruthie","Rye","Sacramento","Sahitya","Sail","Saira","Saira Condensed","Saira Extra Condensed","Saira Semi Condensed","Saira Stencil One","Salsa","Sanchez","Sancreek","Sansita","Sansita Swashed","Sarabun","Sarala","Sarina","Sarpanch","Satisfy","Sawarabi Gothic","Sawarabi Mincho","Scada","Scheherazade","Schoolbell","Scope One","Seaweed Script","Secular One","Sedgwick Ave","Sedgwick Ave Display","Sen","Sevillana","Seymour One","Shadows Into Light","Shadows Into Light Two","Shanti","Share","Share Tech","Share Tech Mono","Shojumaru","Short Stack","Shrikhand","Siemreap","Sigmar One","Signika","Signika Negative","Simonetta","Single Day","Sintony","Sirin Stencil","Six Caps","Skranji","Slabo 13px","Slabo 27px","Slackey","Smokum","Smythe","Sniglet","Snippet","Snowburst One","Sofadi One","Sofia","Solway","Song Myung","Sonsie One","Sora","Sorts Mill Goudy","Source Code Pro","Source Sans Pro","Source Serif Pro","Space Mono","Spartan","Special Elite","Spectral","Spectral SC","Spicy Rice","Spinnaker","Spirax","Squada One","Sree Krushnadevaraya","Sriracha","Srisakdi","Staatliches","Stalemate","Stalinist One","Stardos Stencil","Stint Ultra Condensed","Stint Ultra Expanded","Stoke","Strait","Stylish","Sue Ellen Francisco","Suez One","Sulphur Point","Sumana","Sunflower","Sunshiney","Supermercado One","Sura","Suranna","Suravaram","Suwannaphum","Swanky and Moo Moo","Syncopate","Syne","Tajawal","Tangerine","Taprom","Tauri","Taviraj","Teko","Telex","Tenali Ramakrishna","Tenor Sans","Text Me One","Thasadith","The Girl Next Door","Tienne","Tillana","Timmana","Tinos","Titan One","Titillium Web","Tomorrow","Trade Winds","Trirong","Trocchi","Trochut","Trykker","Tulpen One","Turret Road","Ubuntu","Ubuntu Condensed","Ubuntu Mono","Ultra","Uncial Antiqua","Underdog","Unica One","UnifrakturCook","UnifrakturMaguntia","Unkempt","Unlock","Unna","VT323","Vampiro One","Varela","Varela Round","Varta","Vast Shadow","Vesper Libre","Viaoda Libre","Vibes","Vibur","Vidaloka","Viga","Voces","Volkhov","Vollkorn","Vollkorn SC","Voltaire","Waiting for the Sunrise","Wallpoet","Walter Turncoat","Warnes","Wellfleet","Wendy One","Wire One","Work Sans","Yanone Kaffeesatz","Yantramanav","Yatra One","Yellowtail","Yeon Sung","Yeseva One","Yesteryear","Yrsa","ZCOOL KuaiLe","ZCOOL QingKe HuangYou","ZCOOL XiaoWei","Zeyada","Zhi Mang Xing","Zilla Slab","Zilla Slab Highlight"],Vu=["Arial","Impact","Comic Sans MS","Bebas Neue","Georgia","Raleway","Nunito","Times New Roman","Lato","Roboto Mono","Roboto Slab","Libre Baskerville","Dancing Script","Fredoka One","Sacramento","Luckiest Guy","Orbitron","Satisfy","Permanent Marker","Playfair Display","Noto Sans","Amatic SC","Days One","Rock Salt","New Rocker","Passion One","Indie Flower","Quicksand","Shadows Into Light","Source Code Pro","Aladin","Calligraffitti","Trebuchet MS","Courier New","Montserrat"],ju=new Set;Vu.forEach((e=>{Wu.includes(e)||ju.add(e)}));const Gu={"B Koodak":"BKoodak.ttf","B Titr":"BTitr.ttf",Nazanin:"Nazanin.ttf","Noto Kufi Arabic":"NotoKufiArabic-Regular.ttf","Noto Naskh Arabic":"NotoNaskhArabicUI-Regular.ttf","Noto Sans Arabic":"NotoSansArabic-Regular.ttf",Yekan:"Yekan.ttf","The Bold Font":"TheBoldFont.ttf"},Hu=[...new Set([...Vu,...Wu,...Object.keys(Gu)])].sort(),zu=new Set(Wu),$u={};ju.forEach((e=>{$u[e]="success"}));const Ku=g({initialState:$u,name:"loadedFonts",reducers:{updateFontLoadStatus:(e,t)=>{e[t.payload.font]=t.payload.status}}}),{updateFontLoadStatus:Yu}=Ku.actions,qu=g({name:"theme",initialState:{darkMode:!1},reducers:{setDarkMode:(e,t)=>{e.darkMode=t.payload}}}),{setDarkMode:Xu}=qu.actions,Ju={backgroundColor:"rgba(0, 0, 0, 0.8)",backgroundPadding:10,backgroundStyle:"wrap",borderRadius:15,fontColor:"#ffffff",fontFamily:{type:"default",fontFamily:"Montserrat"},fontSize:30,fontStyle:"normal",fontWeight:"bold",lineHeight:1.2,textAlign:"center",textTransform:"none",textShadow:"transparent",underline:!1,italic:!1},Qu={[dn.None]:{},Color:{active:{color:"#3de1d9"}},Reveal:{unspoken:{color:"transparent",textShadow:"none",textDecoration:"none",display:"inline-block"}},Highlight:{active:{backgroundColor:"#3de1d9",borderRadius:"0.25em"}},Bounce:{active:{bottom:"0.25em"}},Paint:{spoken:{color:"#3de1d9"}},Custom:{spoken:{color:"#18E1D6",borderRadius:"0.125em",backgroundColor:"transparent",bottom:"0rem"},active:{color:"#FF4D8D",borderRadius:"0.125em",backgroundColor:"transparent",bottom:"0rem"},unspoken:{borderRadius:"0.125em",backgroundColor:"transparent",bottom:"0rem"}}};function Zu(e){return{animationId:dn.MagicWBW,animationName:e,wordByWordStyles:{[e]:Qu[e]}}}function em(e){var t,a;const o=Zu("Color");return{...o,wordByWordStyles:{Color:{active:{...null==(a=null==(t=o.wordByWordStyles)?void 0:t.Color)?void 0:a.active,...e}}}}}function tm(e){var t,a;const o=Zu("Highlight");return{...o,wordByWordStyles:{Highlight:{active:{...null==(a=null==(t=o.wordByWordStyles)?void 0:t.Highlight)?void 0:a.active,...e}}}}}function am(e){var t,a;const o=Zu("Paint");return{...o,wordByWordStyles:{Paint:{spoken:{...null==(a=null==(t=o.wordByWordStyles)?void 0:t.Paint)?void 0:a.spoken,...e}}}}}const om={transitionId:dn.MagicFade,transitionDuration:.25,transitionOverlapDuration:.15,transitionSpeed:50},nm={transitionId:dn.MagicFlip,transitionDuration:.1,transitionOverlapDuration:0,transitionSpeed:50},rm={transitionId:dn.MagicPop,transitionDuration:.1,transitionOverlapDuration:0,transitionSpeed:50},im={presetId:"DEFAULT_PRESET",title:"Default",style:Ju,wordByWordAnimations:em({color:"#18E1D6"})},sm={presetId:"CLASSIC_PRESET",title:"Classic",style:{...Ju,backgroundColor:"#FFFFFF",backgroundPadding:25,borderRadius:25,fontColor:"#000000",fontFamily:{type:"default",fontFamily:"Montserrat"},fontWeight:"normal"},wordByWordAnimations:em({color:"#0083E2"}),transition:rm},lm={presetId:"TYPEWRITER_PRESET",title:"Typewriter",style:{...Ju,backgroundColor:"#FFFFFF",backgroundPadding:25,borderRadius:0,fontColor:"#000000",fontFamily:{type:"default",fontFamily:"Courier New"},fontWeight:"normal"},wordByWordAnimations:Zu("Reveal"),transition:nm},dm={presetId:"STRONG_PRESET",title:"Strong",style:{...Ju,backgroundColor:"#D23E3E",backgroundPadding:25,borderRadius:0,fontColor:"#FFFFFF",fontFamily:{type:"default",fontFamily:"Impact"},fontWeight:"bold",textTransform:"uppercase"},wordByWordAnimations:em({color:"#FF9B97"}),transition:rm},cm={presetId:"HANDWRITING_PRESET",title:"Handwriting",style:{...Ju,backgroundColor:"#FFDCDC",backgroundPadding:25,borderRadius:25,fontColor:"#D23E3E",fontFamily:{type:"default",fontFamily:"Dancing Script"},fontWeight:"normal"},wordByWordAnimations:Zu("Reveal"),transition:om},um={presetId:"COMIC_PRESET",title:"Comic",style:{...Ju,backgroundColor:"#FFE279",backgroundPadding:25,borderRadius:0,fontColor:"#000000",fontFamily:{type:"default",fontFamily:"Comic Sans MS"},fontWeight:"normal",textTransform:"uppercase"},wordByWordAnimations:Zu("Bounce"),transition:rm},mm={presetId:"MEME_TEXT_PRESET",title:"Meme Text",style:{...Ju,backgroundColor:"transparent",backgroundPadding:25,borderRadius:0,fontColor:"#FFFFFF",fontFamily:{type:"default",fontFamily:"Impact"},fontWeight:"normal"},wordByWordAnimations:Zu("Paint"),transition:rm},pm={presetId:"FORMAL_PRESET",title:"Formal",style:{...Ju,backgroundColor:"#000000",backgroundPadding:25,borderRadius:25,fontColor:"#FFFFFF",fontFamily:{type:"default",fontFamily:"Times New Roman"},fontWeight:"normal"},wordByWordAnimations:tm({backgroundColor:"#404040"}),transition:om},hm={presetId:"GRAFITTI_PRESET",title:"Grafitti",style:{...Ju,backgroundColor:"#C5E6FF",backgroundPadding:25,borderRadius:0,fontColor:"#21A2FF",fontFamily:{type:"default",fontFamily:"Permanent Marker"},fontWeight:"normal",textTransform:"uppercase"},wordByWordAnimations:am({color:"#196794"}),transition:rm},gm={presetId:"EARTH_TONED_PRESET",title:"Earth Toned",style:{...Ju,backgroundColor:"#CCDEBF",backgroundPadding:25,borderRadius:25,fontColor:"#3D6422",fontFamily:{type:"default",fontFamily:"Playfair Display"},fontWeight:"normal"},wordByWordAnimations:tm({backgroundColor:"#3D6422",color:"#FFFFFF"}),transition:om},ym={presetId:"PLAYFUL_PRESET",title:"Playful",style:{...Ju,backgroundColor:"#93518C",backgroundPadding:25,borderRadius:25,fontColor:"#FFFFFF",fontFamily:{type:"default",fontFamily:"Amatic SC"},fontWeight:"normal",textTransform:"uppercase"},wordByWordAnimations:Zu("Bounce"),transition:rm},fm={presetId:"HARDCORE_PRESET",title:"Hardcore",style:{...Ju,backgroundColor:"#000000",backgroundPadding:50,borderRadius:0,fontColor:"#FFFFFF",fontFamily:{type:"default",fontFamily:"New Rocker"},fontWeight:"normal",textTransform:"uppercase"},wordByWordAnimations:function(e,t,a){var o,n,r,i,s,l;const d=Zu("Custom");return{...d,wordByWordStyles:{Custom:{spoken:{...null==(n=null==(o=d.wordByWordStyles)?void 0:o.Custom)?void 0:n.spoken,...e},active:{...null==(i=null==(r=d.wordByWordStyles)?void 0:r.Custom)?void 0:i.active,...t},unspoken:{...null==(l=null==(s=d.wordByWordStyles)?void 0:s.Custom)?void 0:l.unspoken,...a}}}}}({color:"#917F7F"},{},{}),transition:om},Em={presetId:"BOLD_PRESET",title:"Bold",style:{...Ju,backgroundColor:"#0047FF",backgroundPadding:25,borderRadius:0,fontColor:"#FFFFFF",fontFamily:{type:"default",fontFamily:"Passion One"},fontWeight:"bold"},wordByWordAnimations:Zu("Color"),transition:rm},vm={presetId:"INDIE_PRESET",title:"Indie",style:{...Ju,backgroundColor:"#FFF5E9",backgroundPadding:25,borderRadius:25,fontColor:"#794718",fontFamily:{type:"default",fontFamily:"Indie Flower"},fontWeight:"normal"},wordByWordAnimations:am({color:"#D81B60"}),transition:nm},wm={presetId:"CONSOLE_PRESET",title:"Console",style:{...Ju,backgroundColor:"#000000",backgroundPadding:25,borderRadius:0,fontColor:"#3EFF51",fontFamily:{type:"default",fontFamily:"Source Code Pro"},fontWeight:"normal"},wordByWordAnimations:Zu("Reveal"),transition:om},bm={presetId:"BUBBLE_GUM_PRESET",title:"Bubble Gum",style:{...Ju,backgroundColor:"#FF66A6",backgroundPadding:25,borderRadius:50,fontColor:"#FFFFFF",fontFamily:{type:"default",fontFamily:"Fredoka One"},fontWeight:"normal"},wordByWordAnimations:Zu("Bounce"),transition:nm},_m={presetId:"GOOFY_PRESET",title:"Goofy",style:{...Ju,backgroundColor:"#F08253",backgroundPadding:25,borderRadius:0,fontColor:"#FFFFFF",fontFamily:{type:"default",fontFamily:"Luckiest Guy"},fontWeight:"normal"},wordByWordAnimations:tm({backgroundColor:"#F25D37"}),transition:nm},Tm={presetId:"CLEAN_PRESET",title:"Clean",style:{...Ju,backgroundColor:"#622424",backgroundPadding:25,borderRadius:0,fontColor:"#FFFFFF",fontFamily:{type:"default",fontFamily:"Quicksand"},fontWeight:"normal",textTransform:"uppercase"},wordByWordAnimations:Zu("Color"),transition:om},Sm={presetId:"OLIVE_PRESET",title:"Olive",style:{...Ju,backgroundColor:"#6a8268",backgroundPadding:25,borderRadius:25,fontColor:"#FFFFFF",fontFamily:{type:"default",fontFamily:"Raleway"},fontWeight:"normal",textShadow:"#35442F"},wordByWordAnimations:em({color:"#FFFF00"}),transition:om},Im={presetId:"FRESH_PRESET",title:"Fresh",style:{...Ju,backgroundColor:"#E7FBFF",backgroundPadding:25,borderRadius:0,fontColor:"#3589B9",fontFamily:{type:"default",fontFamily:"Georgia"},fontWeight:"normal",textTransform:"uppercase"},wordByWordAnimations:am({color:"#1B3445"}),transition:nm},xm=[im,sm,lm,dm,cm,pm,gm,ym,fm,Em,vm,wm,bm,_m,Tm,Sm,Im,um,mm,hm],km=e=>!!(e=>xm.find((t=>t.presetId===e.presetId)))(e);function Cm(e,t,a,o){const n=o,r=e.find((e=>e[n]===t));if(!r)return console.error("moveToNdx: src not found"),e;let i=!0;const s=[];return e.forEach(((e,o)=>{e[n]!==t?o!==a?s.push(e):i?(s.push(r),s.push(e)):(s.push(e),s.push(r)):i=!1})),s}function Am(e,t,a){return Cm(e,t,a,"presetId")}function Nm(e,t,a){return Am(e,t,a)}function Pm(e,t,a){return Am(e,t,a)}function Rm(e,t,a){return Cm(e,t,a,"templateId")}const Lm={brandkitPresets:[],customPreset:null,lastExportedPresets:[],presets:xm,lastAssetUrlSignedAt:void 0},Dm="custom",Om=g({name:"magicSubtitlePresets",initialState:Lm,reducers:{setSubtitlePresets:(e,t)=>{const{presets:a,undoable:o}=t.payload;if(o){const o={type:t.type,payload:{presets:e.presets,undoable:!1}},n={type:t.type,payload:{presets:a,undoable:!1}};Jl.add({undo:o,redo:n})}e.presets=a;const n=new Set(a.map((({presetId:e})=>e)));e.lastExportedPresets=e.lastExportedPresets.filter((({presetId:e,teamId:t})=>!!t||n.has(e)))},setSubtitleBrandkitPresets:(e,t)=>{const{brandkitPresets:a,undoable:o}=t.payload;if(o){const o={type:t.type,payload:{brandkitPresets:e.brandkitPresets,undoable:!1}},n={type:t.type,payload:{brandkitPresets:a,undoable:!1}};Jl.add({undo:o,redo:n})}e.brandkitPresets=a},setSubtitlePresetTitle:(e,t)=>{const{presetId:a,title:o,undoable:n}=t.payload;if(n){const n=e.presets.find((e=>e.presetId===a)),r={type:t.type,payload:{presetId:a,title:(null==n?void 0:n.title)||"",undoable:!1}},i={type:t.type,payload:{presetId:a,title:o,undoable:!1}};Jl.add({undo:r,redo:i})}const r=e=>e.presetId===a?{...e,title:o}:e;e.presets=e.presets.map(r),e.brandkitPresets=e.brandkitPresets.map(r),e.lastExportedPresets=e.lastExportedPresets.map(r)},addSubtitlePreset:(e,t)=>{const{preset:a,index:o,undoable:n}=t.payload;if(n){const e={type:"magicSubtitlePresets/removeSubtitlePreset",payload:{presetId:a.presetId,undoable:!1}},n={type:t.type,payload:{preset:a,index:o,undoable:!1}};Jl.add({undo:e,redo:n})}void 0!==o?e.presets.splice(o,0,a):e.presets.push(a)},moveSubtitlePreset:(e,t)=>{const{srcPresetId:a,dstPresetId:o,undoable:n}=t.payload;if(n){const n={type:"magicSubtitlePresets/setSubtitlePresets",payload:{presets:e.presets,undoable:!1}},r={type:t.type,payload:{srcPresetId:a,dstPresetId:o,undoable:!1}};Jl.add({undo:n,redo:r})}if(void 0===e.presets.find((({presetId:e})=>e===a)))return void console.error("Cannot moveSubtitlePreset, srcPreset is undefined");const r=e.presets.findIndex((({presetId:e})=>e===o));-1!==r?e.presets=Nm(e.presets,a,r):console.error("Cannot moveSubtitlePreset, dstPresetId is not found")},removeSubtitlePreset:(e,t)=>{const{presetId:a,undoable:o}=t.payload;if(o){const o=e.presets.findIndex((e=>e.presetId===a)),n=e.presets[o];if(n){const e={type:"magicSubtitlePresets/addSubtitlePreset",payload:{preset:n,index:o,undoable:!1}},r={type:t.type,payload:{presetId:a,undoable:!1}};Jl.add({undo:e,redo:r})}}const n=e=>e&&e.presetId&&e.presetId!==a;e.presets=e.presets.filter(n),e.lastExportedPresets=e.lastExportedPresets.filter(n)},addSubtitleBrandkitPreset:(e,t)=>{const{preset:a,index:o}=t.payload;void 0!==o?e.brandkitPresets.splice(o,0,a):e.brandkitPresets.push(a)},moveSubtitleBrandkitPreset:(e,t)=>{const{srcPresetId:a,dstPresetId:o}=t.payload;if(void 0===e.brandkitPresets.find((({presetId:e})=>e===a)))return void console.error("Cannot moveSubtitleBrandkitPreset, srcPreset is undefined");const n=e.brandkitPresets.findIndex((({presetId:e})=>e===o));-1!==n?e.brandkitPresets=Nm(e.brandkitPresets,a,n):console.error("Cannot moveSubtitleBrandkitPreset, dstPresetId is not found")},removeSubtitleBrandkitPreset:(e,t)=>{const{presetId:a}=t.payload,o=e=>e&&e.presetId&&e.presetId!==a;e.brandkitPresets=e.brandkitPresets.filter(o),e.lastExportedPresets=e.lastExportedPresets.filter(o)},saveSubtitlePresetOnExport:(e,t)=>{const{preset:a}=t.payload,o=e=>e&&e.presetId&&e.presetId!==a.presetId;e.presets=[a,...e.presets.filter(o)],e.lastExportedPresets=[a,...e.lastExportedPresets.filter(o)]},setSubtitleCustomPreset:(e,t)=>{const a=t.payload;e.customPreset=a},setLastAssetUrlSignedAt:(e,t)=>{e.lastAssetUrlSignedAt=t.payload}},extraReducers:e=>e.addDefaultCase(((e,t)=>{switch(t.type){case"RESET_STUDIO":case"RESET_STATE_PRESERVE_USER":return{...Lm,presets:e.presets,lastExportedPresets:(e.lastExportedPresets||[]).slice(0,20),lastAssetUrlSignedAt:e.lastAssetUrlSignedAt};default:return e}}))}),{setSubtitleCustomPreset:Fm,setSubtitlePresets:Mm,setSubtitleBrandkitPresets:Um,setSubtitlePresetTitle:Bm,addSubtitlePreset:Wm,moveSubtitlePreset:Vm,removeSubtitlePreset:jm,addSubtitleBrandkitPreset:Gm,moveSubtitleBrandkitPreset:Hm,removeSubtitleBrandkitPreset:zm,saveSubtitlePresetOnExport:$m,setLastAssetUrlSignedAt:Km}=Om.actions,Ym={runningExports:[],snapshots:[],snapshotsLoading:!1,pendingExport:!1,roughCutSurvey:!1,downloadSurvey:!1},qm=g({name:"exports",initialState:Ym,reducers:{clearExportStore:()=>Ym,runningExportsFetched:(e,t)=>{e.runningExports.length!==t.payload.length&&(e.pendingExport=!1),e.runningExports=t.payload},snapshotsLoading:e=>{e.snapshotsLoading=!0},snapshotsFetched:(e,t)=>{e.snapshots.length&&e.snapshots.length!==t.payload.length&&(e.pendingExport=!1),e.snapshots=t.payload,e.snapshotsLoading=!1},exportStarted:e=>{e.pendingExport=!0},finishPendingExport:e=>{e.pendingExport=!1},showRoughCutSurvey:e=>{e.roughCutSurvey=!0},hideRoughCutSurvey:e=>{e.roughCutSurvey=!1},showDownloadSurvey:e=>{e.downloadSurvey=!0},hideDownloadSurvey:e=>{e.downloadSurvey=!1}}}),{runningExportsFetched:Xm,snapshotsFetched:Jm,snapshotsLoading:Qm,exportStarted:Zm,finishPendingExport:ep,showRoughCutSurvey:tp,hideRoughCutSurvey:ap,showDownloadSurvey:op,hideDownloadSurvey:np,clearExportStore:rp}=qm.actions,ip=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,sp=/^rgba?\((-?\d{1,3}), ?(-?\d{1,3}), ?(-?\d{1,3})(?:(?:, ?)(\d+(?:\.\d*)?|undefined))?\)$/i,lp="rgba(-255,-255,-255,0)";function dp(e){var t,a,o,n;const r=sp.exec(e);if(!r)return null;return{r:parseInt(null!=(t=r[1])?t:"0",10),g:parseInt(null!=(a=r[2])?a:"0",10),b:parseInt(null!=(o=r[3])?o:"0",10),a:5===r.length?parseFloat(null!=(n=r[4])?n:"1"):1}}function cp(e){if(!e||"none"===e)return null;let t=null;return"#"===e[0]?t=function(e){var t,a,o;const n=ip.exec(e);return n?{r:parseInt(null!=(t=n[1])?t:"0",16),g:parseInt(null!=(a=n[2])?a:"0",16),b:parseInt(null!=(o=n[3])?o:"0",16),a:1}:null}(e):e.startsWith("rgb")&&(t=dp(e)),t}function up(e,t){if(!e)return e;const a=cp(e);if(!a)return e;Object.assign(a,t);const{r:o,g:n,b:r}=a;return`#${o.toString(16).padStart(2,"0")}${n.toString(16).padStart(2,"0")}${r.toString(16).padStart(2,"0")}`.toLocaleUpperCase()}const mp={presetId:"DEFAULT",style:{fontFamily:"Montserrat",fontWeight:"normal",textAlign:"center",textTransform:"none",textShadow:lp,color:"#fff",backgroundColor:"black",textPadding:12.5,wrapOrFill:"wrap",borderRadius:{relative:"25%"},underline:!1,italic:!1,globalAlpha:1,lineHeight:1}},pp={presetId:"GLOW",style:{...mp.style,backgroundColor:lp,textEffect:"dropShadow",textBlur:.2,textShadowBlur:.35,textShadowDist:.07,textShadowRot:35,textEffectColor:"#FFFFFF"}},hp={presetId:"OLIVE",style:{...mp.style,fontFamily:"Source Code Pro",backgroundColor:"#6F8F72",textShadow:"#000000"}},gp={presetId:"THREE_D",style:{...mp.style,fontFamily:"Bebas Neue",backgroundColor:lp,color:"#53E4DC",textShadow:"#000000",textEffect:"dropShadow",textShadowBlur:0,textShadowDist:.11,textShadowRot:45,textEffectColor:"#FF005C",textTransform:"uppercase"}},yp={presetId:"CLASSIC",style:{...mp.style,color:"#000000",backgroundColor:"#FFFFFF"}},fp={presetId:"BLURRY",style:{...mp.style,fontFamily:"Bebas Neue",color:"#FFFFFF",backgroundColor:lp,textEffect:"textBlur",textShadowBlur:0,textShadowDist:.25,textShadowRot:69,textEffectColor:"#FFEA00",textBlur:.5,textTransform:"uppercase"}},Ep={presetId:"HANDWRITING",style:{...mp.style,fontFamily:"Dancing Script",color:"#D23E3E",backgroundColor:"#FFDCDC"}},vp={presetId:"MUTANT",style:{...mp.style,fontFamily:"Impact",color:"#A3FF78",backgroundColor:lp,textEffect:"dropShadow",textBlur:.2,textShadowBlur:.35,textShadowDist:.07,textShadowRot:35,textEffectColor:"#A3FF78"}},wp={presetId:"ARCADE",style:{...mp.style,fontFamily:"Permanent Marker",backgroundColor:lp,color:"#FFE279",textShadow:"#000000",textEffect:"dropShadow",textShadowBlur:0,textShadowDist:.15,textShadowRot:45,textEffectColor:"#E05353",textTransform:"uppercase"}},bp={presetId:"TYPEWRITER",style:{...mp.style,fontFamily:"Courier New",color:"#000000",backgroundColor:"#FFFFFF"}},_p={presetId:"HARDCORE",style:{...mp.style,fontFamily:"New Rocker",borderRadius:{relative:"0%"}}},Tp={presetId:"PLAYFUL",style:{...mp.style,fontFamily:"Amatic SC",backgroundColor:"#93518C",textTransform:"uppercase"}},Sp={presetId:"BOLD",style:{...mp.style,fontFamily:"Passion One",backgroundColor:"#0047FF",borderRadius:{relative:"0%"}}},Ip={presetId:"CLEAN",style:{...mp.style,fontFamily:"Quicksand",backgroundColor:"#622424",borderRadius:{relative:"0%"}}},xp={presetId:"INDIE",style:{...mp.style,fontFamily:"Indie Flower",backgroundColor:"#FFF5E9",color:"#794718"}},kp=[mp,Ep,hp,gp,Tp,{presetId:"FORMAL",style:{...mp.style,fontFamily:"Times New Roman"}},yp,fp,pp,vp,wp,bp,_p,Sp,Ip,xp,{presetId:"GOOFY",style:{...mp.style,fontFamily:"Luckiest Guy",backgroundColor:"#F25D37",color:"#FFFFFF",borderRadius:{relative:"0%"},textPadding:20,textTransform:"uppercase"}},{presetId:"STRONG",style:{...mp.style,fontFamily:"Impact",backgroundColor:"#D23E3E",color:"#FFFFFF",borderRadius:{relative:"0%"}}},{presetId:"FRESH",style:{...mp.style,fontFamily:"Georgia",backgroundColor:"#E7FBFF",color:"#174560",borderRadius:{relative:"0%"}}},{presetId:"BUBBLE_GUM",style:{...mp.style,fontFamily:"Georgia",backgroundColor:"#FF66A6",color:"#FFFFFF",borderRadius:{relative:"50%"},textPadding:20}},{presetId:"CONSOLE",style:{...mp.style,fontFamily:"Source Code Pro",backgroundColor:"#000000",color:"#3EFF51",borderRadius:{relative:"0%"}}},{presetId:"EARTH_TONED",style:{...mp.style,fontFamily:"Playfair Display",backgroundColor:"#CCDEBF",color:"#3D6422",borderRadius:{relative:"0%"}}},{presetId:"MEME",style:{...mp.style,fontFamily:"Impact",backgroundColor:lp,color:"#FFFFFF",textShadow:"#000000"}},{presetId:"COMIC",style:{...mp.style,fontFamily:"Comic Sans MS",backgroundColor:"#FFE279",color:"#000000"}},{presetId:"GRAFITTI",style:{...mp.style,fontFamily:"Permanent Marker",backgroundColor:"#C5E6FF",color:"#21A2FF",borderRadius:{relative:"0%"},textTransform:"uppercase"}}];function Cp(e){return kp.find((t=>t.presetId===e.presetId))}function Ap(e){return!!Cp(e)}function Np(e){const{fontFamily:t,asset_id:a,hasCustomFont:o}=e.style;return!(o&&!a)&&!(!a&&-1===Hu.indexOf(t))}const Pp=e=>e.filter(Np).map((e=>{const t=Cp(e);return t?{...e,style:t.style}:e})),Rp={brandkitPresets:[],presets:kp,lastAssetUrlSignedAt:void 0},Lp=g({name:"textPresets",initialState:Rp,reducers:{setTextPresets:(e,t)=>{const{presets:a,undoable:o}=t.payload;if(o){const o={type:t.type,payload:{presets:e.presets,undoable:!1}},n={type:t.type,payload:{presets:a,undoable:!1}};Jl.add({undo:o,redo:n})}e.presets=a},setTextBrandkitPresets:(e,t)=>{const{brandkitPresets:a,undoable:o}=t.payload;if(o){const o={type:t.type,payload:{brandkitPresets:e.brandkitPresets,undoable:!1}},n={type:t.type,payload:{brandkitPresets:a,undoable:!1}};Jl.add({undo:o,redo:n})}e.brandkitPresets=a},addTextPreset:(e,t)=>{const{preset:a,index:o,undoable:n}=t.payload;if(n){const e={type:"textPresets/removeTextPreset",payload:{presetId:a.presetId,undoable:!1}},n={type:t.type,payload:{preset:a,index:o,undoable:!1}};Jl.add({undo:e,redo:n})}void 0!==o?e.presets.splice(o,0,a):e.presets.push(a)},moveTextPreset:(e,t)=>{const{srcPresetId:a,dstPresetId:o,undoable:n}=t.payload;if(n){const n={type:"textPresets/setTextPresets",payload:{presets:e.presets,undoable:!1}},r={type:t.type,payload:{srcPresetId:a,dstPresetId:o,undoable:!1}};Jl.add({undo:n,redo:r})}if(void 0===e.presets.find((({presetId:e})=>e===a)))return void console.error("Cannot moveTextPreset, srcPreset is undefined");const r=e.presets.findIndex((({presetId:e})=>e===o));-1!==r?e.presets=Pm(e.presets,a,r):console.error("Cannot moveTextPreset, dstPresetId is not found")},removeTextPreset:(e,t)=>{const{presetId:a,undoable:o}=t.payload;if(o){const o=e.presets.findIndex((e=>e.presetId===a)),n=e.presets[o];if(n){const e={type:"textPresets/addTextPreset",payload:{preset:n,index:o,undoable:!1}},r={type:t.type,payload:{presetId:a,undoable:!1}};Jl.add({undo:e,redo:r})}}e.presets=e.presets.filter((e=>e&&e.presetId&&e.presetId!==a))},addTextBrandkitPreset:(e,t)=>{const{preset:a,index:o}=t.payload;void 0!==o?e.brandkitPresets.splice(o,0,a):e.brandkitPresets.push(a)},moveTextBrandkitPreset:(e,t)=>{const{srcPresetId:a,dstPresetId:o}=t.payload;if(void 0===e.brandkitPresets.find((({presetId:e})=>e===a)))return void console.error("Cannot moveTextBrandkitPreset, srcPreset is undefined");const n=e.brandkitPresets.findIndex((({presetId:e})=>e===o));-1!==n?e.brandkitPresets=Pm(e.brandkitPresets,a,n):console.error("Cannot moveTextBrandkitPreset, dstPresetId is not found")},removeTextBrandkitPreset:(e,t)=>{const{presetId:a}=t.payload;e.brandkitPresets=e.brandkitPresets.filter((e=>e&&e.presetId&&e.presetId!==a))},saveTextPresetOnExport:(e,t)=>{const{preset:a}=t.payload;e.presets=[a,...e.presets.filter((e=>e&&e.presetId&&e.presetId!==a.presetId))]},setLastAssetUrlSignedAt:(e,t)=>{e.lastAssetUrlSignedAt=t.payload}},extraReducers:e=>e.addDefaultCase(((e,t)=>{switch(t.type){case"RESET_STUDIO":case"RESET_STATE_PRESERVE_USER":return{...Rp,presets:Pp(e.presets||[]),lastAssetUrlSignedAt:e.lastAssetUrlSignedAt};default:return e}}))}),{setTextPresets:Dp,setTextBrandkitPresets:Op,addTextPreset:Fp,moveTextPreset:Mp,removeTextPreset:Up,addTextBrandkitPreset:Bp,moveTextBrandkitPreset:Wp,removeTextBrandkitPreset:Vp,saveTextPresetOnExport:jp,setLastAssetUrlSignedAt:Gp}=Lp.actions,Hp=[{templateId:"DISCORD",ratio:[16,9],layers:[{id:"",type:"shape",shapeType:"rectangle",background:"#5865F2",stroke:"rgba(-255,-255,-255,0)",position:{x:"8.341247892962494%",y:"35.484484563577475%",width:"83.31750421407502%",height:"29.031030872845047%",rotation:0},lineCap:"butt",globalAlpha:1,lineWidth:"0.3%",isTrimmed:!0,borderRadius:{relative:"50%"}},{id:"",url:"https://cdn-useast1.kapwing.com/static/WnR-th-3020716033.webp",type:"image",isTrimmed:!0,position:{x:"14.651621515370575%",y:"38.89106632736083%",width:"12.112823443951266%",height:"22.217867345278346%",rotation:0}},{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",baseWidth:441.1782553729456,color:"#FFFFFF",fontFamily:"Open Sans",fontSize:73,fontWeight:"bold",globalAlpha:1,lineHeight:1,lockAspectRatio:!1,position:{x:"30.84286590938378%",y:"43.24074074074074%",width:"51.956068268015166%",height:"13.518518518518519%",rotation:0},text:"@username",textAlign:"left",textShadow:"transparent",baseHeight:73.11629525355087,isTrimmed:!0,textEffect:null,textBlur:.2,textShadowBlur:0,textShadowDist:.08,textShadowRot:33,textEffectColor:"#FFFFFF",hasCustomFont:!1,italic:!1,borderRadius:{relative:"0%"},wrapOrFill:"fill",underline:!1}]},{templateId:"TWITCH",ratio:[16,9],layers:[{id:"",type:"shape",shapeType:"rectangle",background:"#8849F6",stroke:"rgba(-255,-255,-255,0)",position:{x:"8.341247892962494%",y:"35.484484563577475%",width:"83.31750421407502%",height:"29.031030872845047%",rotation:0},lineCap:"butt",globalAlpha:1,lineWidth:"0.3%",isTrimmed:!0,borderRadius:{relative:"50%"}},{id:"",url:"https://cdn-useast1.kapwing.com/static/s-4-TwitchGlitchWhite-JN7ET3dtT9.webp",type:"image",isTrimmed:!0,position:{x:"15.651621515370575%",y:"38.89106632736083%",width:"10.712823443951266%",height:"22.217867345278346%",rotation:0}},{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",baseWidth:441.1782553729456,color:"#FFFFFF",fontFamily:"Open Sans",fontSize:73,fontWeight:"bold",globalAlpha:1,lineHeight:1,lockAspectRatio:!1,position:{x:"30.84286590938378%",y:"43.24074074074074%",width:"51.956068268015166%",height:"13.518518518518519%",rotation:0},text:"@username",textAlign:"left",textShadow:"transparent",baseHeight:73.11629525355087,isTrimmed:!0,textEffect:null,textBlur:.2,textShadowBlur:0,textShadowDist:.08,textShadowRot:33,textEffectColor:"#FFFFFF",hasCustomFont:!1,italic:!1,borderRadius:{relative:"0%"},wrapOrFill:"fill",underline:!1}]},{templateId:"FACEBOOK",ratio:[16,9],layers:[{id:"",type:"shape",shapeType:"rectangle",background:"#1C4274",stroke:"rgba(-255,-255,-255,0)",position:{x:"8.341247892962494%",y:"35.48448456357748%",width:"83.31750421407502%",height:"29.031030872845047%",rotation:0},lineCap:"butt",globalAlpha:1,lineWidth:"0.3%",isTrimmed:!0,borderRadius:{relative:"50%"}},{id:"",url:"https://cdn-useast1.kapwing.com/static/GYQ-facebookIcon.png",type:"image",isTrimmed:!0,position:{x:"14.817448266778765%",y:"39.1515860314291%",width:"12.204465714642247%",height:"21.696827937141776%",rotation:0}},{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",baseWidth:441.1782553729456,color:"#FFFFFF",fontFamily:"Open Sans",fontSize:73,fontWeight:"bold",globalAlpha:1,lineHeight:1,lockAspectRatio:!1,position:{x:"30.84286590938378%",y:"43.24074074074074%",width:"51.956068268015166%",height:"13.518518518518519%",rotation:0},text:"@username",textAlign:"left",textShadow:"transparent",baseHeight:73.11629525355087,isTrimmed:!0,textEffect:null,textBlur:.2,textShadowBlur:0,textShadowDist:.08,textShadowRot:33,textEffectColor:"#FFFFFF",hasCustomFont:!1,italic:!1,borderRadius:{relative:"0%"},wrapOrFill:"fill",underline:!1}]},{templateId:"TWITTER",ratio:[16,9],layers:[{id:"",type:"shape",shapeType:"rectangle",background:"#1D9BF0",stroke:"rgba(-255,-255,-255,0)",position:{x:"8.341247892962494%",y:"35.484484563577475%",width:"83.31750421407502%",height:"29.031030872845047%",rotation:0},lineCap:"butt",globalAlpha:1,lineWidth:"0.3%",isTrimmed:!0,borderRadius:{relative:"50%"}},{id:"",url:"https://cdn-useast1.kapwing.com/static/XZ7-2021_Twitter_logo_white-sggXAaIEr3.webp",type:"image",position:{x:"14.888509358032383%",y:"40.82231347916707%",width:"12.545174906414708%",height:"18.355373041665874%",rotation:0},isTrimmed:!0},{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",baseWidth:441.1782553729456,color:"#FFFFFF",fontFamily:"Open Sans",fontSize:73,fontWeight:"bold",globalAlpha:1,lineHeight:1,lockAspectRatio:!1,position:{x:"30.84286590938378%",y:"43.24074074074075%",width:"51.956068268015166%",height:"13.518518518518519%",rotation:0},text:"@username",textAlign:"left",textShadow:"transparent",baseHeight:73.11629525355087,isTrimmed:!0,textEffect:null,textBlur:.2,textShadowBlur:0,textShadowDist:.08,textShadowRot:33,textEffectColor:"#FFFFFF",hasCustomFont:!1,italic:!1,borderRadius:{relative:"0%"},wrapOrFill:"fill",underline:!1}]},{templateId:"INSTAGRAM",ratio:[16,9],layers:[{id:"",type:"shape",shapeType:"rectangle",background:"#5A1531",stroke:"rgba(-255,-255,-255,0)",position:{x:"8.341247892962494%",y:"35.48448456357748%",width:"83.31750421407502%",height:"29.031030872845047%",rotation:0},lineCap:"butt",globalAlpha:1,lineWidth:"0.3%",isTrimmed:!0,borderRadius:{relative:"50%"}},{id:"",url:"https://cdn-useast1.kapwing.com/static/Ppl-zoT-instagramIcon.png",type:"image",isTrimmed:!0,position:{x:"14.796282058452114%",y:"38.63139638587815%",width:"12.789679065887087%",height:"22.737207228243715%",rotation:0}},{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",baseWidth:441.1782553729456,color:"#FFFFFF",fontFamily:"Open Sans",fontSize:73,fontWeight:"bold",globalAlpha:1,lineHeight:1,lockAspectRatio:!1,position:{x:"30.84286590938378%",y:"43.24074074074074%",width:"51.956068268015166%",height:"13.518518518518519%",rotation:0},text:"@username",textAlign:"left",textShadow:"transparent",baseHeight:73.11629525355087,isTrimmed:!0,textEffect:null,textBlur:.2,textShadowBlur:0,textShadowDist:.08,textShadowRot:33,textEffectColor:"#FFFFFF",hasCustomFont:!1,italic:!1,borderRadius:{relative:"0%"},wrapOrFill:"fill",underline:!1}]},{templateId:"YOUTUBE",ratio:[16,9],layers:[{id:"",type:"shape",shapeType:"rectangle",background:"#FF0000",stroke:"rgba(-255,-255,-255,0)",position:{x:"8.341247892962494%",y:"35.484484563577475%",width:"83.31750421407502%",height:"29.031030872845047%",rotation:0},lineCap:"butt",globalAlpha:1,lineWidth:"0.3%",isTrimmed:!0,borderRadius:{relative:"50%"}},{id:"",url:"https://cdn-useast1.kapwing.com/static/FEE-yt_logo_mono_dark-EBaKqfaZMq.webp",isTrimmed:!0,type:"image",position:{x:"15.05126627558372%",y:"41.2575640084404%",width:"14.08981081504867%",height:"17.48487198311922%",rotation:0}},{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",baseWidth:441.1782553729456,color:"#FFFFFF",fontFamily:"Open Sans",fontSize:73,fontWeight:"bold",globalAlpha:1,lineHeight:1,lockAspectRatio:!1,position:{x:"30.84286590938378%",y:"43.24074074074074%",width:"51.956068268015166%",height:"13.518518518518519%",rotation:0},text:"@username",textAlign:"left",textShadow:"transparent",baseHeight:73.11629525355087,isTrimmed:!0,textEffect:null,textBlur:.2,textShadowBlur:0,textShadowDist:.08,textShadowRot:33,textEffectColor:"#FFFFFF",hasCustomFont:!1,italic:!1,borderRadius:{relative:"0%"},wrapOrFill:"fill",underline:!1}]},{templateId:"FOLLOW_ME",ratio:[480,159],layers:[{id:"",url:"https://cdn-useast1.kapwing.com/static/H8C-source_63d461b154645c002563c781.webp",objectFit:"cover",mime:"image/gif",width:480,height:159,type:"image",position:{x:"0%",y:"0%",rotation:0,width:"100%",height:"100%"},isTrimmed:!0},{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",borderRadius:{relative:"25%"},color:"#000000",fontFamily:"Montserrat",fontSize:55.23428571428571,baseWidth:1035.8490566037735,baseHeight:61,italic:!1,fontWeight:"bold",globalAlpha:1,lineHeight:1,lockAspectRatio:!0,position:{x:"1.7761146832507666%",y:"32.853729665155825%",width:"96.44777063349846%",height:"17.146270334844175%",rotation:0},text:"Follow me @username",textAlign:"center",textShadow:"transparent",underline:!1,wrapOrFill:"wrap",textPadding:12.5,startTime:0,endTime:0,isTrimmed:!1,textWithLineBreaks:"Follow me @username",hasCustomFont:!1}]},{templateId:"ARROW_DOWN",ratio:[662,794],layers:[{id:"",url:"https://cdn-useast1.kapwing.com/static/bGK-source_63d46014824fa4001f93237c.webp",source:"upload",objectFit:"cover",mime:"image/gif",height:480,type:"image",width:400,position:{x:"19.733376885858352%",y:"6.8391074454402485%",rotation:180,width:"60.533246228283296%",height:"60.53324622828329%"},isTrimmed:!0},{id:"",type:"text",backgroundColor:"#137f9c",borderRadius:{relative:"50%"},color:"#000000",fontFamily:"Nunito",fontSize:54,baseWidth:346,baseHeight:60.10198974609375,italic:!1,fontWeight:"bold",globalAlpha:1,lineHeight:1,lockAspectRatio:!0,position:{x:"24.146948941469486%",y:"74.09231084336724%",width:"51.70610211706103%",height:"6.724782067247821%",rotation:0},text:"CLICK HERE",textAlign:"center",textTransform:"uppercase",textShadow:"transparent",underline:!1,wrapOrFill:"wrap",textPadding:25,startTime:0,endTime:0,isTrimmed:!1,textWithLineBreaks:"CLICK HERE",hasCustomFont:!1}]},{templateId:"LOVE",ratio:[1,1],layers:[{id:"",url:"https://cdn-useast1.kapwing.com/static/Qgu-source_63d461cec507e800180d0866.webp",objectFit:"cover",uploadId:"42441174-0950-461e-bf9e-c1a35ec98256",height:480,type:"image",width:480,position:{x:"0%",y:"0%",rotation:0,width:"100%",height:"100%"},isTrimmed:!0},{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",borderRadius:{relative:"50%"},color:"#8c0f41",fontFamily:"Amatic SC",fontSize:82.59428571428572,baseWidth:516.9140625,baseHeight:176,italic:!1,fontWeight:"bold",globalAlpha:1,lineHeight:1,lockAspectRatio:!0,position:{x:"17.81357020547945%",y:"39.714285714285715%",width:"64.3728595890411%",height:"20.57142857142857%",rotation:0},text:"Thanks for 100k \r\nsubscribers!",textAlign:"center",textTransform:"uppercase",textShadow:"rgba(-255,-255,-255,0)",underline:!1,wrapOrFill:"wrap",textPadding:25,startTime:0,endTime:0,isTrimmed:!1,textWithLineBreaks:"Thanks for 100k \r\nsubscribers!",hasCustomFont:!1}]},{templateId:"THANK_YOU",ratio:[16,9],layers:[{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",borderRadius:{relative:"10.5%"},color:"#202020",fontFamily:"Impact",fontSize:190.5140186915888,baseWidth:877.2570181758513,baseHeight:219.09112149532712,italic:!1,fontWeight:"normal",globalAlpha:1,lineHeight:1.15,lockAspectRatio:!0,position:{x:"20.885529199475123%",y:"6.314473508646749%",width:"58.09649126992392%",height:"25.79439252336449%",rotation:0},text:"THANK YOU",textAlign:"center",textTransform:"uppercase",textShadow:"#FF1744",underline:!1,wrapOrFill:"wrap",textPadding:13,isTrimmed:!1,hasCustomFont:!1,textEffect:null,textShadowBlur:0,textShadowDist:.08,textShadowRot:69,textEffectColor:"#000000",textBlur:.35,startTime:0,endTime:0,textWithLineBreaks:"THANK YOU"},{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",borderRadius:{relative:"10.5%"},color:"#FF1744",fontFamily:"Impact",fontSize:190.51401869158877,baseWidth:879.2570181758513,baseHeight:219.0911214953271,italic:!1,fontWeight:"normal",globalAlpha:1,lineHeight:1.15,lockAspectRatio:!0,position:{x:"20.885529199475123%",y:"32.108866032011235%",width:"58.228941601049755%",height:"25.794392523364486%",rotation:0},text:"THANK YOU",textAlign:"center",textTransform:"uppercase",textShadow:"transparent",underline:!1,wrapOrFill:"wrap",textPadding:13,isTrimmed:!1,hasCustomFont:!1,textEffect:null,textShadowBlur:0,textShadowDist:.08,textShadowRot:69,textEffectColor:"#000000",textBlur:.35,startTime:0,endTime:0,textWithLineBreaks:"THANK YOU",timelineRow:1},{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",borderRadius:{relative:"10.5%"},color:"#202020",fontFamily:"Impact",fontSize:190.5140186915888,baseWidth:881.7570181758512,baseHeight:219.09112149532712,italic:!1,fontWeight:"normal",globalAlpha:1,lineHeight:1.15,lockAspectRatio:!0,position:{x:"20.885529199475123%",y:"57.90325855537573%",width:"58.394504514957035%",height:"25.79439252336449%",rotation:0},text:"THANK YOU",textAlign:"center",textTransform:"uppercase",textShadow:"#FF1744",underline:!1,wrapOrFill:"wrap",textPadding:13,isTrimmed:!1,hasCustomFont:!1,textEffect:null,textShadowBlur:0,textShadowDist:.08,textShadowRot:69,textEffectColor:"#000000",textBlur:.35,startTime:0,endTime:0,textWithLineBreaks:"THANK YOU",timelineRow:2}]},{templateId:"LOCATION",ratio:[16,9],layers:[{id:"",type:"shape",shapeType:"rectangle",background:"#000000",stroke:"rgba(-255,-255,-255,0)",position:{x:"12.283178472258854%",y:"36.42797737095318%",width:"75.43364305548229%",height:"23.88534336489991%",rotation:0},lineCap:"butt",globalAlpha:1,lineWidth:"0.3%",isTrimmed:!0,borderRadius:{relative:"21.75%"}},{id:"",type:"image",isTrimmed:!0,position:{x:"18.286542401450337%",y:"40.12380349456986%",rotation:0,width:"9.331765163585688%",height:"16.49369111766655%"},url:"https://cdn-useast1.kapwing.com/static/aM4-locationPin.png"},{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",borderRadius:{relative:"23.5%"},color:"#FFFFFF",fontFamily:"Montserrat",fontSize:51,baseWidth:382.06575232597686,baseHeight:51.833433539287675,italic:!1,fontWeight:"bold",globalAlpha:1,lineHeight:1,lockAspectRatio:!0,position:{x:"27.11538700428837%",y:"42.4127051281695%",width:"56.21308076714065%",height:"11.91588785046729%",rotation:0},text:"San Francisco",textAlign:"center",textShadow:"transparent",underline:!1,wrapOrFill:"fill",textPadding:12.5,isTrimmed:!0}]},{templateId:"SPEECH",ratio:[16,9],layers:[{id:"",type:"image",isTrimmed:!0,position:{x:"11.398644755019275%",y:"35.83280704512436%",rotation:0,width:"77.20271048996145%",height:"34.57510696273633%"},url:"https://cdn-useast1.kapwing.com/static/glR-speechBubbleBackground.png"},{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",borderRadius:{relative:"10.5%"},fontFamily:"Montserrat",fontSize:48,baseWidth:528.7088713047926,baseHeight:55.2491211968903,italic:!1,fontWeight:"bold",globalAlpha:1,lineHeight:1.15,lockAspectRatio:!0,position:{x:"15.771028037383179%",y:"41.18452896007446%",width:"69.48568694134248%",height:"12.897196261682243%",rotation:0},text:"Let's go to the beach",textAlign:"center",textShadow:"transparent",underline:!1,wrapOrFill:"wrap",textPadding:1,isTrimmed:!0,hasCustomFont:!1,color:"#FFFFFF"}]},{templateId:"BIG_TITLE_SUBTITLE",ratio:[16,9],layers:[{id:"",type:"shape",shapeType:"rectangle",background:"#1E88E5",stroke:"rgba(-255,-255,-255,0)",position:{x:"8.682344251764397%",y:"61.99825089305037%",width:"42.68620202826241%",height:"21.774263185842386%",rotation:0},lineCap:"butt",globalAlpha:1,lineWidth:"0.3%",isTrimmed:!0},{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",baseWidth:201.3658438599773,color:"#FFFFFF",fontFamily:"Lato",fontSize:40,fontWeight:"bold",globalAlpha:1,lineHeight:1,lockAspectRatio:!1,position:{x:"11.388012334851842%",y:"73.87687322539333%",width:"20.9756087354143%",height:"7.4074074074074066%",rotation:0},text:"SUB TITLE",textAlign:"left",textShadow:"transparent",baseHeight:40.57336753099969,isTrimmed:!0,textWithLineBreaks:"SUB TITLE",textEffect:null,textBlur:.2,textShadowBlur:0,textShadowDist:.08,textShadowRot:33,textEffectColor:"#FFFFFF",hasCustomFont:!1,italic:!0,borderRadius:{relative:"0%"},wrapOrFill:"fill",underline:!1},{id:"",type:"text",backgroundColor:"#FFFFFF",baseWidth:642.8904444655042,color:"#000000",fontFamily:"Lato",fontSize:116,fontWeight:"bold",globalAlpha:1,lineHeight:1,lockAspectRatio:!1,position:{x:"11.388012334851842%",y:"52.2822621899652%",width:"66.96775463182335%",height:"21.48148148148148%",rotation:0},text:"BIG TITLE",textAlign:"left",textTransform:"uppercase",textShadow:"transparent",baseHeight:116.6484316516241,isTrimmed:!0,textEffect:null,textBlur:.2,textShadowBlur:0,textShadowDist:.08,textShadowRot:33,textEffectColor:"#FFFFFF",hasCustomFont:!1,italic:!1,borderRadius:{relative:"0%"},wrapOrFill:"fill"}]},{templateId:"TOPIC",ratio:[16,9],layers:[{id:"",type:"shape",shapeType:"rectangle",background:"rgba(-255,-255,-255,0)",stroke:"#BDBDBD",position:{x:"4.529629504418395%",y:"37.99436537284588%",width:"90.94074099116322%",height:"24.011269254308246%",rotation:0},lineCap:"butt",globalAlpha:1,lineWidth:"0.3%",isTrimmed:!0,animation:{animationName:dn.Reveal,transitionDuration:1}},{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",borderRadius:{relative:"25.25%"},color:"#BDBDBD",fontFamily:"Montserrat",fontSize:57,baseWidth:571.7571451788612,baseHeight:65.7268420869861,italic:!1,fontWeight:"bold",globalAlpha:1,lineHeight:1.15,lockAspectRatio:!0,position:{x:"8.428341803375067%",y:"42.34228971962615%",width:"83.14331639324986%",height:"15.315420560747661%",rotation:0},text:"YOUR FIRST TOPIC",textAlign:"center",textTransform:"uppercase",textShadow:"transparent",underline:!1,wrapOrFill:"fill",textPadding:13,isTrimmed:!0,hasCustomFont:!1,textEffect:null,textShadowBlur:0,textShadowDist:.08,textShadowRot:69,textEffectColor:"#000000",textBlur:.35,animation:{animationName:dn.Drop,transitionDuration:.5}}]},{templateId:"QUOTE",ratio:[16,9],layers:[{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",baseWidth:629.8381619349678,color:"#BDBDBD",fontFamily:"Bebas Neue",fontSize:60,fontWeight:"normal",globalAlpha:1,lineHeight:1,lockAspectRatio:!0,position:{x:"13.195929065887093%",y:"40.76359041946626%",width:"73.60814186822583%",height:"11.111111111111114%",rotation:0},text:"QUOTE OF INFINITE WISDOM",textAlign:"center",textTransform:"uppercase",textShadow:"transparent",baseHeight:60.76050077294487,isTrimmed:!0,textWithLineBreaks:"QUOTE OF INFINITE WISDOM",textEffect:null,textBlur:.2,textShadowBlur:0,textShadowDist:.08,textShadowRot:33,textEffectColor:"#FFFFFF",hasCustomFont:!1,italic:!1,borderRadius:{relative:"7.25%"},wrapOrFill:"fill",underline:!1},{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",baseWidth:629.8381619349678,color:"#BDBDBD",fontFamily:"Libre Baskerville",fontSize:22,fontWeight:"normal",globalAlpha:1,lineHeight:1,lockAspectRatio:!0,position:{x:"13.19592906588709%",y:"55.22398117489916%",width:"73.60814186822583%",height:"4.074074074074075%",rotation:0},text:"Albert Einstein",textAlign:"center",textShadow:"transparent",baseHeight:22.094727553798133,isTrimmed:!0,textWithLineBreaks:"Albert Einstein",textEffect:null,textBlur:.2,textShadowBlur:0,textShadowDist:.08,textShadowRot:33,textEffectColor:"#FFFFFF",hasCustomFont:!1,italic:!0,borderRadius:{relative:"7.25%"},wrapOrFill:"fill",underline:!1}]},{templateId:"CHAPTER_TITLE",ratio:[16,9],layers:[{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",borderRadius:{relative:"10.5%"},color:"#BDBDBD",fontFamily:"Georgia",fontSize:60,baseWidth:116.51289582208477,baseHeight:60.47965037786101,italic:!1,fontWeight:"bold",globalAlpha:1,lineHeight:1,lockAspectRatio:!0,position:{x:"42.34363272197165%",y:"26.81470499878485%",width:"15.3127345560567%",height:"14.018691588785046%",rotation:0},text:"01",textAlign:"center",textShadow:"transparent",underline:!1,wrapOrFill:"wrap",textPadding:12.5,isTrimmed:!0,hasCustomFont:!1},{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",borderRadius:{relative:"10.5%"},color:"#BDBDBD",fontFamily:"Georgia",fontSize:55,baseWidth:354.3064660621435,baseHeight:55.91514846255075,italic:!1,fontWeight:"bold",globalAlpha:1,lineHeight:1,lockAspectRatio:!0,position:{x:"26.71759495794913%",y:"43.01220183238608%",width:"46.56481008410181%",height:"12.85046728971963%",rotation:0},text:"CHAPTER 1",textAlign:"center",textTransform:"uppercase",textShadow:"transparent",underline:!1,wrapOrFill:"wrap",textPadding:12.5,isTrimmed:!0,hasCustomFont:!1},{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",borderRadius:{relative:"10.5%"},fontFamily:"Georgia",fontSize:21,baseWidth:518.268088798585,baseHeight:24.933591712382327,italic:!1,fontWeight:"normal",globalAlpha:1,lineHeight:1.15,lockAspectRatio:!0,position:{x:"15.943247669485515%",y:"67.50726447148135%",width:"68.11350466102898%",height:"5.64252336448598%",rotation:0},text:"Short description of what this chapter is about.",textAlign:"center",textShadow:"transparent",underline:!1,wrapOrFill:"wrap",textPadding:12.5,isTrimmed:!0,hasCustomFont:!1,color:"#BDBDBD"}]},{templateId:"TITLE",ratio:[16,9],layers:[{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",borderRadius:{relative:"10.5%"},color:"#BDBDBD",fontFamily:"Roboto Mono",fontSize:51,baseWidth:554.4835338077232,baseHeight:51.080562857726285,italic:!1,fontWeight:"normal",globalAlpha:1,lineHeight:1,lockAspectRatio:!0,position:{x:"13.563436008546226%",y:"47.06723259608451%",width:"72.87312798290755%",height:"11.915887850467291%",rotation:0},text:"TITLE TEXT HERE",textAlign:"center",textTransform:"uppercase",textShadow:"transparent",underline:!1,wrapOrFill:"wrap",textPadding:12.5,isTrimmed:!0},{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",borderRadius:{relative:"10.5%"},color:"#BDBDBD",fontFamily:"Roboto Mono",fontSize:34,baseWidth:388.1442650146144,baseHeight:34.05370857181752,italic:!1,fontWeight:"normal",globalAlpha:1,lineHeight:1,lockAspectRatio:!0,position:{x:"25.4407685385936%",y:"58.9762144777332%",width:"51.011950717458085%",height:"7.943925233644861%",rotation:0},text:"SUBTITLE TEXT HERE",textAlign:"center",textTransform:"uppercase",textShadow:"transparent",underline:!1,wrapOrFill:"wrap",textPadding:12.5,isTrimmed:!0},{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",borderRadius:{relative:"10.5%"},color:"#BDBDBD",fontFamily:"Roboto Mono",fontSize:30,baseWidth:299.08071951909176,baseHeight:30.124434505838575,italic:!1,fontWeight:"normal",globalAlpha:1,lineHeight:1,lockAspectRatio:!0,position:{x:"30.346623279265284%",y:"79.83136568787435%",width:"39.30675344146942%",height:"7.009345794392523%",rotation:0},text:"DATES/AUTHORS",textAlign:"center",textTransform:"uppercase",textShadow:"transparent",underline:!1,wrapOrFill:"wrap",textPadding:12.5,isTrimmed:!0}]},{templateId:"OUR_TEAM",ratio:[16,9],layers:[{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",baseWidth:703.2588439740796,color:"#BDBDBD",fontFamily:"Alfa Slab One",fontSize:111,fontWeight:"normal",globalAlpha:1,lineHeight:1,lockAspectRatio:!1,position:{x:"3.6214945728164345%",y:"19.344714856619564%",width:"60.62576241155858%",height:"17.065333238335366%",rotation:0},text:"Our team",textAlign:"left",textShadow:"transparent",baseHeight:111.35129938013827,isTrimmed:!0,textEffect:null,textBlur:.2,textShadowBlur:0,textShadowDist:.08,textShadowRot:33,textEffectColor:"#FFFFFF",hasCustomFont:!1,italic:!1,borderRadius:{relative:"7.25%"},wrapOrFill:"fill"},{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",baseWidth:1075.9813259106588,color:"#BDBDBD",fontFamily:"Montserrat",fontSize:37,fontWeight:"normal",globalAlpha:1,lineHeight:1.5,lockAspectRatio:!0,position:{x:"3.6214945728164345%",y:"37.23593532625004%",width:"92.75701085436714%",height:"43.41934981713042%",rotation:0},text:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, \r\nsed do eiusmod tempor incididunt ut labore et dolore \r\nmagna aliqua. Ut enim ad minim veniam, quis nostrud \r\nexercitation ullamco laboris nisi ut aliquip ex ea \r\ncommodo consequat. ",textAlign:"left",textShadow:"transparent",baseHeight:283.31125755677596,isTrimmed:!0,textEffect:null,textBlur:.2,textShadowBlur:0,textShadowDist:.08,textShadowRot:33,textEffectColor:"#FFFFFF",hasCustomFont:!1,italic:!1,borderRadius:{relative:"7.25%"},wrapOrFill:"fill",underline:!1}]},{templateId:"QUOTE_CURSIVE",ratio:[16,9],layers:[{id:"",type:"text",backgroundColor:"rgba(-255,-255,-255,0)",borderRadius:{relative:"10.5%"},fontFamily:"Satisfy",fontSize:58,baseWidth:621.5613293127642,baseHeight:134.04961914299054,italic:!1,fontWeight:"normal",globalAlpha:1,lineHeight:1.15,lockAspectRatio:!0,position:{x:"7.155578535230159%",y:"34.4158878504673%",width:"85.68884292953969%",height:"31.168224299065418%",rotation:0},text:'"Quote something your \r\ncustomer says."',textAlign:"center",textShadow:"transparent",underline:!1,wrapOrFill:"wrap",textPadding:1,isTrimmed:!0,hasCustomFont:!1,color:"#BDBDBD"}]}];function zp(e){return Hp.find((t=>t.templateId===e.templateId))}function $p(e){return!!zp(e)}const Kp=e=>e.map((e=>{const t=zp(e);return t?{...e,layers:t.layers}:e})),Yp={brandkitTemplates:[],templates:Hp,lastAssetUrlSignedAt:void 0},qp=g({name:"textTemplates",initialState:Yp,reducers:{setTextTemplates:(e,t)=>{const{templates:a,undoable:o}=t.payload;if(o){const o={type:t.type,payload:{templates:e.templates,undoable:!1}},n={type:t.type,payload:{templates:a,undoable:!1}};Jl.add({undo:o,redo:n})}e.templates=a},setTextBrandkitTemplates:(e,t)=>{const{brandkitTemplates:a,undoable:o}=t.payload;if(o){const o={type:t.type,payload:{brandkitTemplates:e.brandkitTemplates,undoable:!1}},n={type:t.type,payload:{brandkitTemplates:a,undoable:!1}};Jl.add({undo:o,redo:n})}e.brandkitTemplates=a},addTextTemplate:(e,t)=>{const{template:a,index:o,undoable:n}=t.payload;if(n){const e={type:"textTemplates/removeTextTemplate",payload:{templateId:a.templateId,undoable:!1}},n={type:t.type,payload:{template:a,index:o,undoable:!1}};Jl.add({undo:e,redo:n})}void 0!==o?e.templates.splice(o,0,a):e.templates.push(a)},moveTextTemplate:(e,t)=>{const{srcTemplateId:a,dstTemplateId:o,undoable:n}=t.payload;if(n){const n={type:"textTemplates/setTextTemplates",payload:{templates:e.templates,undoable:!1}},r={type:t.type,payload:{srcTemplateId:a,dstTemplateId:o,undoable:!1}};Jl.add({undo:n,redo:r})}if(void 0===e.templates.find((({templateId:e})=>e===a)))return void console.error("Cannot moveTextTemplate, srcTemplate is undefined");const r=e.templates.findIndex((({templateId:e})=>e===o));-1!==r?e.templates=Rm(e.templates,a,r):console.error("Cannot moveTextTemplate, dstTemplateId is not found")},removeTextTemplate:(e,t)=>{const{templateId:a,undoable:o}=t.payload;if(o){const o=e.templates.findIndex((e=>e.templateId===a)),n=e.templates[o];if(n){const e={type:"textTemplates/addTextTemplate",payload:{template:n,index:o,undoable:!1}},r={type:t.type,payload:{templateId:a,undoable:!1}};Jl.add({undo:e,redo:r})}}e.templates=e.templates.filter((e=>e&&e.templateId&&e.templateId!==a))},addTextBrandkitTemplate:(e,t)=>{const{template:a,index:o}=t.payload;void 0!==o?e.brandkitTemplates.splice(o,0,a):e.brandkitTemplates.push(a)},moveTextBrandkitTemplate:(e,t)=>{const{srcTemplateId:a,dstTemplateId:o}=t.payload;if(void 0===e.brandkitTemplates.find((({templateId:e})=>e===a)))return void console.error("Cannot moveTextBrandkitTemplate, srcTemplate is undefined");const n=e.brandkitTemplates.findIndex((({templateId:e})=>e===o));-1!==n?e.brandkitTemplates=Rm(e.brandkitTemplates,a,n):console.error("Cannot moveTextBrandkitTemplate, dstTemplateId is not found")},removeTextBrandkitTemplate:(e,t)=>{const{templateId:a}=t.payload;e.brandkitTemplates=e.brandkitTemplates.filter((e=>e&&e.templateId&&e.templateId!==a))},saveTextTemplateOnExport:(e,t)=>{const{template:a}=t.payload;e.templates=[a,...e.templates.filter((e=>e&&e.templateId&&e.templateId!==a.templateId))]},setLastAssetUrlSignedAt:(e,t)=>{e.lastAssetUrlSignedAt=t.payload}},extraReducers:e=>e.addDefaultCase(((e,t)=>{switch(t.type){case"RESET_STUDIO":case"RESET_STATE_PRESERVE_USER":return{...Yp,templates:Kp(e.templates||[]),lastAssetUrlSignedAt:e.lastAssetUrlSignedAt};default:return e}}))}),{setTextTemplates:Xp,setTextBrandkitTemplates:Jp,addTextTemplate:Qp,moveTextTemplate:Zp,removeTextTemplate:eh,addTextBrandkitTemplate:th,moveTextBrandkitTemplate:ah,removeTextBrandkitTemplate:oh,saveTextTemplateOnExport:nh,setLastAssetUrlSignedAt:rh}=qp.actions,ih={CLOUD_FUNCTIONS_PREFIX:""};function sh(e){return e.type===ln.Video}var lh=(e=>(e[e.unstarted=0]="unstarted",e[e.errored=1]="errored",e[e.inProgress=2]="inProgress",e[e.onGCSUploadFinish=3]="onGCSUploadFinish",e[e.createAsset=4]="createAsset",e[e.assetCreated=5]="assetCreated",e[e.runConversion=6]="runConversion",e[e.addPendingConversion=7]="addPendingConversion",e[e.updateCompletedUploadInIDB=8]="updateCompletedUploadInIDB",e[e.handleFinish=9]="handleFinish",e[e.done=10]="done",e))(lh||{}),dh=(e=>(e.PreExtractValidation="Pre-Extraction Validation",e.Extraction="Extraction",e.ExtractionValidation="Extraction Validation",e.AssetCreation="Asset Creation",e.LayerCreation="Layer Creation",e.HandleFinish="Handle Finish",e.Finish="Finish",e))(dh||{}),ch=(e=>(e.trim="trim",e.smartCut="smart_cut",e.sceneSplit="scene_split",e))(ch||{}),uh=(e=>(e.SETTINGS="settings",e.HISTORY="history",e))(uh||{}),mh=(e=>(e.Studio="studio",e.Export="export",e))(mh||{}),ph=(e=>(e.Command="command",e.Shift="shift",e.Control="control",e.Option="option",e.Alt="alt",e))(ph||{}),hh=(e=>(e.background="background",e.gap="gap",e.layer="layer",e.row="row",e.track="track",e.trackpad="trackpad",e))(hh||{}),gh=(e=>(e.CML_FILE="CML_FILE",e.SIDEBAR_IMAGE="SIDEBAR_IMAGE",e.SIDEBAR_VIDEO="SIDEBAR_VIDEO",e.TRANSITION_TILE="TRANSITION_TILE",e.UPLOADING_LAYER="UPLOADING_LAYER",e.MAGIC_SUBTITLE_PRESET="MAGIC_SUBTITLE_PRESET",e.TEXT_PRESET="TEXT_PRESET",e.TEXT_TEMPLATE="TEXT_TEMPLATE",e))(gh||{}),yh=(e=>(e.BROWSER_WARN="BROWSER_WARN",e))(yh||{}),fh=(e=>(e.EyedropperMode="eyedropperMode",e.ImageExport="imageExport",e.Thumbnail="thumbnail",e.None="none",e))(fh||{});function Eh(e,t){return{type:"ADD_ANIMATION",animationInstance:e,undoable:t}}function vh(e,t){return{type:"UPDATE_ANIMATION",animationId:e,layerAnim:t,undoable:!0}}function wh(e,t){return{type:"DELETE_ANIMATION",animationId:e,undoable:t}}function bh({layers:e,layerIndex:t,isUndoable:a=!1,fromUndo:o=!1}){return{type:"ADD_LAYERS",layers:e,layerIndex:t,isUndoable:a,fromUndo:o}}function _h(e,t,a){return{type:"REMOVE_LAYER",layer:e,source:t,undoable:a}}function Th(e,t,a,o,n,r){return{type:"RESIZE_LAYER",layer:e,x:t,y:a,width:o,height:n,undoable:r}}function Sh(e,t,a,o,n,r,i,s){return{type:"RESIZE_LINE_LAYER",layer:e,x:t,y:a,width:o,height:n,linePointStartCorner:r,lineRightAngle:i,undoable:s}}function Ih(e,t,a){return{type:"SET_SCALE",layer:e,scaleX:t,scaleY:a}}function xh(e,t,a){return{type:"SET_STUDIO_ROTATION",layer:e,rotation:t,undoable:a}}function kh(e,t,a){return{type:`SET_STUDIO_FLIP_${{x:"HORIZONTAL",y:"VERTICAL"}[t]}`,layer:e,axis:t,undoable:a}}function Ch(e,t){return{type:"BRING_LAYER_FORWARD",layer:e,undoable:t}}function Ah(e,t){return{type:"SEND_LAYER_BACK",layer:e,undoable:t}}function Nh(e,t,a){return{type:"MOVE_LAYER_TO_INDEX",layer:e,targetIndex:t,undoable:a}}function Ph(e,t){return{type:"ENHANCE_LAYER",assetId:e,enhanceJobId:t}}function Rh(e,t,a){return{type:"UPDATE_ALL_LAYERS",layers:e,sceneIndex:t,undoable:a}}function Lh(e,t=!1){return setTimeout((()=>{(()=>{var e,t,a,o;const{dispatch:n,state:r}=tn(),i=r.studio.allLayers.byId[null!=(t=null==(e=r.studio.selectedItem)?void 0:e.id)?t:""];if(!(null==i?void 0:i.fromTextDefaults)&&i&&"text"===i.type){const e={backgroundColor:i.backgroundColor,borderRadius:i.borderRadius,color:i.color,fontFamily:i.fontFamily,fontSize:i.fontSize,baseWidth:i.baseWidth,baseHeight:i.baseHeight,fontWeight:i.fontWeight,globalAlpha:i.globalAlpha,lineHeight:i.lineHeight,lockAspectRatio:i.lockAspectRatio,italic:i.italic,textAlign:i.textAlign,textTransform:i.textTransform,textShadow:i.textShadow,width:null==(a=i.position)?void 0:a.width,height:null==(o=i.position)?void 0:o.height,underline:i.underline,wrapOrFill:i.wrapOrFill,textPadding:i.textPadding};i.hasCustomFont&&(e.font={type:"custom",asset_id:i.asset_id||"",fontType:i.fontType||"",fontFamily:i.fontFamily||"",url:i.url||"",source:i.source||"upload"}),n(br(e))}})()}),0),{type:"UPDATE_LAYERS",updates:e,undoable:t}}function Dh(e){return{type:"SELECT_TRANSITION",payload:e,undoable:!1}}function Oh(e){return{type:"SHOW_SNAP_LINES",lines:e}}function Fh(e,t,a,o){return Mh([e],t,a,o)}function Mh(e,t,a,o){return{type:"ADD_LAYERS_TO_GROUP",layerIds:e,groupId:t,isTimelineGroup:a,undoable:o}}function Uh(e,t,a){return function(e,t,a){return{type:"REMOVE_LAYERS_FROM_GROUP",layerIds:e,groupId:t,undoable:a}}([e],t,a)}function Bh(e,t,a,o){return{type:"SET_LAYER_DESELECTION_IN_GROUP",layerId:e,groupId:t,deselect:a,undoable:o}}function Wh(e,t=!0){return{type:"REMOVE_GROUP",groupId:e,undoable:t}}function Vh(e,t,a){return{type:"SAVE_LAYER_GROUP",groupId:e,saved:t,undoable:a}}function jh(e){return{type:"SET_SELECTED_TIMELINE_ROWS",timelineRows:e}}function Gh(e){return{type:"ADD_SELECTED_TIMELINE_ROWS",timelineRows:e}}function Hh(){return{type:"UPDATE_SELECTED_TIMELINE_ROWS"}}function zh(e){return{type:"SET_LAYER_DUPLICATED",layerDuplicated:e}}function $h(){return{type:"SORT_SUBTITLE_LAYERS"}}function Kh(e,t=!1){const{state:a}=tn();return a.userPermissions.canWrite?{type:"SELECT_ITEM",item:e,undoable:t}:{type:"SELECT_ITEM",item:null,undoable:!1}}var Yh=(e=>(e.ADD_IDB_ASSET_IDS="ADD_IDB_ASSET_IDS",e.ADD_TEXT_LAYER_ID_ADDED_IN_SESSION="ADD_TEXT_LAYER_ID_ADDED_IN_SESSION",e.ALT_IS_BEING_PRESSED="ALT_IS_BEING_PRESSED",e.CLEAR_DRAG_PREVIEW_DISPLACEMENTS="CLEAR_DRAG_PREVIEW_DISPLACEMENTS",e.CLEAR_IDB_ASSET_IDS="CLEAR_IDB_ASSET_IDS",e.COMMAND_IS_BEING_PRESSED="COMMAND_IS_BEING_PRESSED",e.CONTROL_IS_BEING_PRESSED="CONTROL_IS_BEING_PRESSED",e.REMOVE_IDB_ASSET_ID="REMOVE_IDB_ASSET_ID",e.SET_BOX_SELECTED_IDS="SET_BOX_SELECTED_IDS",e.SET_DRAG_PREVIEW_DISPLACEMENTS="SET_DRAG_PREVIEW_DISPLACEMENTS",e.SET_DRAGGED_TRACKS_OVERRIDES="SET_DRAGGED_TRACKS_OVERRIDES",e.SET_IDB_ASSET_IDS="SET_IDB_ASSET_IDS",e.SET_INITIAL_IDB_ASSET_ID_LOAD_DONE="SET_INITIAL_IDB_ASSET_ID_LOAD_DONE",e.SET_IS_NEW_PROJECT="SET_IS_FIRST_EDIT",e.SET_LOCAL_LAYER_VALUES="SET_LOCAL_LAYER_VALUE",e.BATCHED_SET_LOCAL_LAYER_VALUES="BATCHED_SET_LOCAL_LAYER_VALUES",e.SET_IS_INLINE_CROPPING="SET_IS_INLINE_CROPPING",e.SET_MEDIA_ITEM_DRAG_OFFSET="SET_MEDIA_ITEM_DRAG_OFFSET",e.SET_MEDIA_ITEM_GHOST_TRACK="SET_MEDIA_ITEM_GHOST_TRACK",e.SET_MEDIA_ITEM_LOCATION="SET_MEDIA_ITEM_LOCATION",e.SET_MEDIA_LIBRARY_SELECTED_TAB="SET_MEDIA_LIBRARY_SELECTED_TAB",e.SET_MOUSE_DOWN="SET_MOUSE_DOWN",e.SET_PROJECT_FETCHED="SET_PROJECT_FETCHED",e.SET_SELECTED_EDITOR_PANE="SET_SELECTED_EDITOR_PANE",e.SET_SHADOW_INFOS="SET_SHADOW_INFOS",e.SET_SHOW_TRANSCRIBE="SET_SHOW_TRANSCRIBE",e.SET_SNAP_TIMELINE_TO_SEEKER="SET_SNAP_TIMELINE_TO_SEEKER",e.SET_STUDIO_DRAG_DROP_ACTIVE="SET_STUDIO_DRAG_DROP_ACTIVE",e.SET_TIMELINE_CONTAINER_HEIGHT="SET_TIMELINE_CONTAINER_HEIGHT",e.SET_TIMELINE_CONTAINER_WIDTH="SET_TIMELINE_CONTAINER_WIDTH",e.SET_TRACK_THUMBNAIL_FALLBACK="SET_TRACK_THUMBNAIL_FALLBACK",e.SET_VOLUME_SLIDER_IS_DRAGGING="SET_VOLUME_SLIDER_IS_DRAGGING",e.SHIFT_IS_BEING_PRESSED="SHIFT_IS_BEING_PRESSED",e.START_EDITING_TEXT_LAYER="START_EDITING_TEXT_LAYER",e.UPDATE_SHADOW_INFOS="UPDATE_SHADOW_INFOS",e.SET_INFO_TOAST_SHOWN_THIS_SESSION="SET_INFO_TOAST_SHOWN_THIS_SESSION",e.SET_PREVIEW_PLAYING="SET_PREVIEW_PLAYING",e.SET_MEDIA_SIDEBAR_SELECTED_TAB="SET_MEDIA_SIDEBAR_SELECTED_TAB",e.SHOW_SIGN_IN="SHOW_SIGN_IN",e.HIDE_SIGN_IN="HIDE_SIGN_IN",e.SET_AWAITING_RECORDINGS="SET_AWAITING_RECORDINGS",e.SET_PREVIEW_TRACK="SET_PREVIEW_TRACK",e.SET_PREVIEW_TIMELINE_STATE="SET_PREVIEW_TIMELINE_STATE",e.SET_ROW_UPLOAD_IN_PROGRESS="SET_ROW_UPLOAD_IN_PROGRESS",e.CLEAR_PROJECT_FETCHED="CLEAR_PROJECT_FETCHED",e.SET_GHOST_SEEKER_OFFSET="SET_GHOST_SEEKER_OFFSET",e.SET_STATIC_UPLOAD_IDS="SET_STATIC_UPLOAD_IDS",e.SET_MOBILE_TRAY_CONTENT="SET_MOBILE_TRAY_CONTENT",e.SET_GROUP_DRAG_OVERRIDES="SET_GROUP_DRAG_OVERRIDES",e.CLEAR_GROUP_DRAG_OVERRIDES="CLEAR_GROUP_DRAG_OVERRIDES",e.SYNC_ATTEMPTED="SYNC_ATTEMPTED",e.SYNC_SUCCEEDED="SYNC_SUCCEEDED",e.SET_IS_ADDING="SET_IS_ADDING",e.PLAYBACK_RATE="PLAYBACK_RATE",e.UPDATE_MAGIC_SUBTITLE_LOCAL="UPDATE_MAGIC_SUBTITLE_LOCAL",e.SET_MAGIC_SUBTITLE_SELECTION="SET_MAGIC_SUBTITLE_SELECTION",e.SET_MAGIC_SUBTITLE_FOCUS="SET_MAGIC_SUBTITLE_FOCUS",e.RESIZE_MEDIABAR="RESIZE_MEDIABAR",e.RESIZING_MEDIABAR="RESIZING_MEDIABAR",e.UPDATE_LAST_GENERATED_THUMBNAIL="UPDATE_LAST_GENERATED_THUMBNAIL",e.SET_SHOW_REPORT_ISSUE_MODAL="SET_SHOW_REPORT_ISSUE_MODAL",e.SET_LOCAL_MAGIC_SUBTITLE_FRAMES="SET_LOCAL_MAGIC_SUBTITLE_FRAMES",e.SET_LAYER_MOUNTED_STATE="SET_LAYER_MOUNTED_STATE",e.SET_ASSET_MONITOR_ID="SET_ASSET_MONITOR_ID",e.UPDATE_DALLE_TEMP_VALUES="UPDATE_DALLE_TEMP_VALUES",e.SET_AI_TOOLS_DATA="SET_AI_TOOLS_DATA",e.SET_CLICKED_TTS_BUTTON_FROM_RIGHT_SIDEBAR="SET_CLICKED_TTS_BUTTON_FROM_RIGHT_SIDEBAR",e))(Yh||{});function qh(e,t){return{type:"SET_LOCAL_LAYER_VALUE",layerId:e,properties:t}}function Xh(e){return{type:"BATCHED_SET_LOCAL_LAYER_VALUES",updates:e}}const Jh=(e,t)=>({type:"SET_IS_INLINE_CROPPING",layerId:e,isInlineCropping:t});function Qh(){return{type:"SET_PROJECT_FETCHED"}}function Zh(){return{type:"CLEAR_PROJECT_FETCHED"}}function eg(e){const{dispatch:t}=tn();return t(Dh(null)),{type:"SET_SELECTED_EDITOR_PANE",selectedEditorPane:e}}function tg(e){return{showTranscribe:e,type:"SET_SHOW_TRANSCRIBE"}}function ag(e){return{type:"SET_SNAP_TIMELINE_TO_SEEKER",snapTimelineToSeeker:e}}function og(e){return{studioDragDropActive:e,type:"SET_STUDIO_DRAG_DROP_ACTIVE"}}function ng(e){return{type:"SET_DRAGGED_TRACKS_OVERRIDES",overrides:e}}function rg(e,t){let a;switch(e){case ph.Command:a="COMMAND_IS_BEING_PRESSED";break;case ph.Shift:a="SHIFT_IS_BEING_PRESSED";break;case ph.Control:a="CONTROL_IS_BEING_PRESSED";break;case ph.Option:default:a="ALT_IS_BEING_PRESSED"}return{type:a,isPressed:t}}function ig(e){return{type:"ADD_IDB_ASSET_IDS",idbAssetIds:e}}function sg(e){return{type:"SET_VOLUME_SLIDER_IS_DRAGGING",isDragging:e}}function lg(e){return{type:"SET_TIMELINE_CONTAINER_HEIGHT",height:e}}function dg(e){return{type:"SET_TIMELINE_CONTAINER_WIDTH",width:e}}function cg(e){return{type:"SET_MEDIA_ITEM_GHOST_TRACK",track:e}}function ug(e){return{type:"SET_MEDIA_ITEM_LOCATION",location:e}}function mg(e){return{type:"SET_TRACK_THUMBNAIL_FALLBACK",mediaCacheId:e}}const pg=_("SET_INITIAL_IDB_ASSET_ID_LOAD_DONE"),hg=_("SET_IS_FIRST_EDIT"),gg=_("START_EDITING_TEXT_LAYER"),yg=_("SET_MEDIA_SIDEBAR_SELECTED_TAB");const fg=_("SET_MOUSE_DOWN"),Eg=_("CLEAR_DRAG_PREVIEW_DISPLACEMENTS"),vg=_("SET_DRAG_PREVIEW_DISPLACEMENTS"),wg=_("SET_INFO_TOAST_SHOWN_THIS_SESSION"),bg=_("SET_PREVIEW_PLAYING");function _g(){return{type:"SHOW_SIGN_IN"}}const Tg=_("SET_AWAITING_RECORDINGS");function Sg(e){return{type:"SET_PREVIEW_TIMELINE_STATE",timelineState:e}}const Ig=_("SET_PREVIEW_TRACK"),xg=_("SET_ROW_UPLOAD_IN_PROGRESS"),kg=_("SET_GHOST_SEEKER_OFFSET"),Cg=_("SET_STATIC_UPLOAD_IDS"),Ag=_("SET_MOBILE_TRAY_CONTENT"),Ng=_("SET_BOX_SELECTED_IDS"),Pg=_("SET_GROUP_DRAG_OVERRIDES"),Rg=_("CLEAR_GROUP_DRAG_OVERRIDES"),Lg=_("SYNC_ATTEMPTED"),Dg=_("SYNC_SUCCEEDED"),Og=_("SET_IS_ADDING"),Fg=_("PLAYBACK_RATE"),Mg=_("UPDATE_MAGIC_SUBTITLE_LOCAL"),Ug=_("SET_MAGIC_SUBTITLE_SELECTION"),Bg=_("SET_MAGIC_SUBTITLE_FOCUS"),Wg=_("RESIZE_MEDIABAR"),Vg=_("RESIZING_MEDIABAR");function jg(){return{type:"UPDATE_LAST_GENERATED_THUMBNAIL"}}const Gg=_("SET_SHOW_REPORT_ISSUE_MODAL"),Hg=_("SET_LOCAL_MAGIC_SUBTITLE_FRAMES"),zg=_("SET_LAYER_MOUNTED_STATE"),$g=_("SET_ASSET_MONITOR_ID"),Kg=e=>({type:"UPDATE_DALLE_TEMP_VALUES",...e}),Yg=e=>({type:"SET_AI_TOOLS_DATA",payload:e}),qg=_("SET_CLICKED_TTS_BUTTON_FROM_RIGHT_SIDEBAR");function Xg(e){var t;const a={};for(const o in e)if(!["scenes"].includes(o))if("allLayers"===o){const t=s.exports.cloneDeep(e.allLayers);(null==t?void 0:t.byId)&&Object.values(t.byId).forEach((e=>{delete e.local_url})),a.allLayers=t}else a[o]=e[o];if("scenes"in e){a.scenes=[];for(const o of e.scenes)if(o){a.scenes.push(o.id),a[`scene_${o.id}`]={},a[`scene_${o.id}_layers`]=[];for(const e in o)"layers"!==e&&(a[`scene_${o.id}`][e]=o[e]);for(const e of o.layers){if(!e)continue;const n=s.exports.cloneDeep(e);delete n.local_url,a[`layer_${e.id}`]=n,null==(t=a[`scene_${o.id}_layers`])||t.push(e.id)}}}return s.exports.cloneDeep(a)}let Jg=0,Qg=0,Zg=0,ey=0,ty=!1,ay=0;const oy=()=>{Qg=0},ny=e=>{ty!==e&&(ty=e,ay=performance.now())},ry=()=>{ey=performance.now()},iy=()=>{const e=performance.now();return{appSession:ls,amplitudeSession:Bc(),sessionDuration:e,timeSinceLastOpSent:e-Zg,timeSinceLastOpReceived:e-ey,globalOpCounter:Jg,projectOpCounter:Qg,wsConnected:ty,timeSinceWsConnectedChanged:e-ay}};let sy;function ly(e,t){const a=function(e,t){const a={cv:"0.7",submittedAt:Date.now(),...iy(),...t};return{...e,__md:a,__localMd:{id:y()}}}(s.exports.cloneDeep(e),t);Jg+=1,Qg+=1;const{sharedDoc:o}=window;(null==o?void 0:o.opsDisabled)||(lr.push(a),null==sy&&(sy=setTimeout((()=>{if(sy=void 0,window.sharedDoc){const e=lr.dequeueAll();dy(e,"live",(()=>{for(const t of e)lr.removePending(t)}))}else sl()||console.info("sharedDoc is unavailable. can't submit ops")}))))}function dy(e,t,a){vy();const{sharedDoc:o}=window;if(!o)return console.info("sharedDoc is unavailable. can't submit ops"),!1;sl()||console.debug("submitting ",e.length,"ops");const n=Array.from(e,(e=>s.exports.omit(e,"__localMd")));return o.submitOp(n,void 0,(e=>{e?function(e,t,a={}){var o;const n=e.message.includes("Version mismatch");n&&(window.sharedDoc.opsDisabled=!0);const r=t.slice(0,10),i=!!(null==(o=null==e?void 0:e.message)?void 0:o.includes("Permission denied"));console.error("Failed to submit op.",e,t),i||p("Failed to submit op",{extra:{error:e,opsCount:t.length,ops:r},tags:{...a,versionMismatch:n}})}(e,n,{isSyncOfflineOps:"offline"===t}):(wy(),Zg=performance.now()),a()})),!0}function cy(e=1e4){var t;if(!window.sharedDoc)return Promise.reject(new Error("Sharedb is not connected"));const a=s.exports.cloneDeep(null!=(t=null==lr?void 0:lr.getAllPendingOps())?t:[]);if(!lr||!a.length)return Promise.resolve([]);sl()||console.info(`Submitting ${a.length} offline ops`);for(const n of a)n.__md.offlineOpSubmittedAt=Date.now();const o=new Promise((e=>dy(a,"offline",(()=>e())))).then((()=>{for(const e of a)lr.removePending(e)}));return Promise.race([o,il(e)])}function uy({path:e,val:t,oldVal:a,srcFn:o,skipLastUpdated:n}){(t||t!==a)&&ly({p:e,od:a,oi:t},{srcFn:o,skipLastUpdated:n})}function my(e,t,a,o,n){JSON.stringify(a)!==JSON.stringify(t)&&ly({p:[e],od:a,oi:t},{srcFn:o,skipLastUpdated:n})}function py(e,t,a,o,n,r){if(o===a)return;ly({p:[e,t],od:o,oi:a},{srcFn:n,skipLastUpdated:r})}function hy(e,t,a,o,n){return py(e,t,a,o,n)}function gy(e,t,a,o){ly({p:[e,t],od:a},{srcFn:o})}function yy(e,t,a,o){ly({p:[`layer_${t.id}`],oi:t},{srcFn:o});ly({p:[`scene_${e.id}_layers`,a],li:t.id},{srcFn:o})}function fy(e,t,a,o){ly({p:["subtitles",t],li:e,ld:a},{srcFn:o})}function Ey(e,t,a,o){0===Object.keys(e.presence||{}).length?uy({path:["presence"],val:{[a]:t},oldVal:e.presence,srcFn:o,skipLastUpdated:!0}):uy({path:["presence",a],val:t,oldVal:e.presence[a]||{},srcFn:o,skipLastUpdated:!0})}const vy=s.exports.throttle((()=>{setTimeout((()=>{tn().dispatch(Lg("websocket"))}))}),5e3),wy=s.exports.throttle((()=>{setTimeout((()=>{tn().dispatch(Dg("websocket"))}))}),5e3);function by(e){return{type:"SET_MOUSE_POSITION_TOOLTIP",mousePosition:e}}function _y(){return{type:"CLEAR_MOUSE_POSITION_TOOLTIP"}}const Ty={user:{},token:""},Sy=e=>{const t=31536e3;(new E).set("ssrSignedInCookie",e,{path:"/",expires:new Date(Date.now()+31536e6),maxAge:t,secure:!0})},Iy=e=>{var t;T(null!=e?{id:e._id,email:e.email,segment:null!=(t=Pc(e))?t:void 0,accountType:""}:null)},xy={currentTemplate:(e={},t)=>"SET_CURRENT_TEMPLATE"===t.type?t.currentTemplate:e,exampleVideos:(e=[],t)=>"SET_TEMPLATE_EXAMPLE_VIDEOS"===t.type?t.exampleVideos:e,infoForSelectedTemplateLetter:(e={letter:"",count:0},t)=>"SET_NUM_TEMPLATES_FOR_LETTER"===t.type?{letter:t.letter,count:t.count}:e,parentId:(e="",t)=>{switch(t.type){case"SET_PARENT_ID":return t.parentId||"";case"RESET_EDITOR":return"";default:return e}},templateSource:(e="",t)=>"SET_TEMPLATE_SOURCE"===t.type?t.source:e,templates:(e=[],t)=>{switch(t.type){case"SET_TEMPLATES":return t.templates;case"APPEND_TEMPLATES":{const a=[],o=new Set;return[...e,...t.templates].forEach((e=>{o.has(e._id)||(o.add(e._id),a.push(e))})),a}case"RESET_EDITOR":return[];default:return e}}},ky={numPostsForCurrentCategory:(e=0,t)=>{switch(t.type){case"SET_NUM_POSTS_FOR_CURRENT_CATEGORY":return t.numPosts;case"RESET_CATEGORIES":case"RESET_EDITOR":return 0;default:return e}}},Cy={currentPost:(e={},t)=>"SET_CURRENT_POST"===t.type?t.currentPost:e,postsForCurrentCategory:(e=[],t)=>{switch(t.type){case"SET_CATEGORY_POSTS":return t.posts;case"RESET_CATEGORIES":case"RESET_EDITOR":return[];default:return e}}},Ay=S("CMLFiles/removeFromMyMedia",(async e=>await pu(`/api/v1/cloudMediaLibrary/myMedia/${e}`)),{condition:(e,{getState:t})=>"pending"!==t().CMLFiles.removeFromMyMediaFetchStatuses[e]}),Ny=S("CMLFiles/removeAllMyMedia",(async()=>await pu("/api/v1/cloudMediaLibrary/myMedia")),{condition:(e,{getState:t})=>"pending"!==t().CMLFiles.removeAllMyMediaFetchStatus}),Py=g({initialState:{byId:{},initializingCMLFromIDB:!1,myMediaIds:[],myMediaInitialized:!1,promptRemoveFiles:null,removeFromMyMediaFetchStatuses:{},removeAllMyMediaFetchStatus:null,toUploadId:{}},name:"CMLFiles",reducers:{addToMyMedia:(e,t)=>{t.payload.forEach((t=>{e.myMediaIds.includes(t)||e.myMediaIds.push(t)})),e.myMediaInitialized=!0},filesFetched:(e,t)=>{t.payload.forEach((t=>{e.byId[t.id]=t}))},linkToUploadId:(e,t)=>{e.toUploadId[t.payload.cmlFileId]=t.payload.uploadId},initializingCMLFromIDBStart:e=>{e.initializingCMLFromIDB=!0},initializingCMLFromIDBComplete:e=>{e.initializingCMLFromIDB=!1},promptRemove:(e,t)=>{e.promptRemoveFiles=t.payload},promptRemoveCompleted:e=>{e.promptRemoveFiles=null},changeCMLFileName:(e,t)=>{void 0!==e.byId[t.payload.id]&&(e.byId[t.payload.id].fileName=t.payload.newFileName)},updateLocalCMLFileModifiedDate:(e,t)=>{void 0!==e.byId[t.payload.id]&&(e.byId[t.payload.id].modified=t.payload.modified.toISOString())}},extraReducers:e=>{(e=>{e.addCase(Ay.pending,((e,t)=>{e.removeFromMyMediaFetchStatuses[t.meta.arg]="pending"})),e.addCase(Ay.rejected,((e,t)=>{e.removeFromMyMediaFetchStatuses[t.meta.arg]="rejected"})),e.addCase(Ay.fulfilled,((e,t)=>{e.removeFromMyMediaFetchStatuses[t.meta.arg]="fulfilled",e.myMediaIds=e.myMediaIds.filter((e=>e!==t.meta.arg))}))})(e),(e=>{e.addCase(Ny.pending,(e=>{e.removeAllMyMediaFetchStatus="pending"})),e.addCase(Ny.rejected,(e=>{e.removeAllMyMediaFetchStatus="rejected"})),e.addCase(Ny.fulfilled,(e=>{e.removeAllMyMediaFetchStatus="fulfilled",e.myMediaIds=[]}))})(e)}}),{addToMyMedia:Ry,filesFetched:Ly,initializingCMLFromIDBComplete:Dy,initializingCMLFromIDBStart:Oy,linkToUploadId:Fy,promptRemove:My,promptRemoveCompleted:Uy,updateLocalCMLFileModifiedDate:By,changeCMLFileName:Wy}=Py.actions;async function Vy(){return await hu("/api/v1/cloudMediaLibrary/myMedia")}async function jy(e){return await hu(`/api/v1/cloudMediaLibrary/file/${e}`)}function Gy(e){setTimeout((()=>{e()}))}async function Hy(e,t){Gy((()=>gu(`/api/v1/cloudMediaLibrary/file/${e}/linkedVideo/${t}`).catch(console.error)))}async function zy(e,t){return await gu("/api/v1/cloudMediaLibrary/filesFromAssets",{body:{assetIds:e,linkToUser:t}})}async function $y(e,t){return await gu(`/api/v1/cloudMediaLibrary/file/${e}/conversionFinished`,{body:{convertedAssetId:t}})}async function Ky(e,t){return await fu("/api/v1/cloudMediaLibrary/updateFileName",{body:{cmlFileID:e,newFileName:t}})}const Yy=e=>oi.includes(e.value)&&void 0===(null==e?void 0:e.default)||!0===(null==e?void 0:e.default),qy=e=>"62d61954f85729d3ec1db3f4"===e,Xy=g({initialState:{loadingSubscription:!0,associatedTeamId:null,subscription:null},name:"subscription",reducers:{setSubscription:(e,t)=>{e.subscription=t.payload},setAssociatedTeamId:(e,t)=>{e.associatedTeamId=t.payload},setLoadingSubscription:(e,t)=>{e.loadingSubscription=t.payload}}}),{setLoadingSubscription:Jy,setSubscription:Qy,setAssociatedTeamId:Zy}=Xy.actions;let ef=null;function tf(e,t,a){return t?ef||(ef=async function(){try{a(Jy(!0));const{subscription:t}=await gu("/api/v1/stripe/getTeamSubscription",{body:{teamId:e}});return m.exports.batch((()=>{a(Zy(e)),a(Qy(t)),a(Jy(!1))})),ef=null,t}catch(YEe){throw a(Jy(!1)),ef=null,YEe}}(),ef):(m.exports.batch((()=>{a(Zy(e)),a(Qy(null)),a(Jy(!1))})),null)}const af=()=>{const e=m.exports.useDispatch(),t=tr((e=>e.teams.selectedTeamId)),a=(o=t,tr((e=>e.teams.allTeams.find((e=>e._id===o))))||Ds);var o;const{loadingSubscription:n,subscription:i,associatedTeamId:s}=tr((e=>e.subscription));r.exports.useEffect((()=>{t!==s&&s&&(e(Jy(!0)),e(Qy(null)))}),[t,s,e]);const l=r.exports.useCallback((async()=>{tf(a._id,a.stripeId,e)}),[a._id,a.stripeId,e]);return r.exports.useEffect((()=>{l()}),[l]),{subscription:i,loadingSubscription:n,refetchSubscription:l}},of=async()=>{const{state:e,dispatch:t}=tn(),{teams:a}=e,{selectedTeamId:o,allTeams:n}=a,r=n.find((e=>e._id===o));if(void 0===r)return gd(void 0);const i=function(){const{state:{teams:{selectedTeamId:e},subscription:{subscription:t,associatedTeamId:a}}}=tn();if(e===a)return t}()||await tf(r._id,r.stripeId,t);return gd(i)},nf=e=>{const t=tr((e=>e.currentUser)),[a,o]=r.exports.useState(!0),[n,i]=r.exports.useState(),s=r.exports.useCallback((async()=>{o(!0);try{const{subscription:a}=await gu("/api/v1/admin/getStripeSubscriptionFromTeamId",{body:{teamId:e,userId:t.user._id}});i(a),o(!1)}catch(YEe){Iu({description:"Failed to retrive subscription",error:YEe}),o(!1)}}),[t.user._id,e]);return r.exports.useEffect((()=>{s()}),[s]),{subscription:n,loadingSubscription:a,refetch:s}},rf={epochs:["yr","month","day","hr","min"],yr:31536e3,month:2592e3,day:86400,hr:3600,min:60},sf=14,lf=new Date;function df(e,t){try{const t=function(e){for(let t=0;t<rf.epochs.length;t+=1){const a=rf.epochs[t];if(!a)continue;const o=Math.floor(e/rf[a]);if(o>=1)return{interval:o,epoch:a}}return null}(Math.floor((new Date-new Date(e))/1e3)),a=t.interval>1||0===t.interval?"s":"";return`${t.interval} ${t.epoch}${a}`}catch(YEe){return t||"a little while"}}function cf(e,t={}){const{excludeMs:a,msPrecision:o=2,dontPadMax:n}=t,r=!n,i=Number(Number.parseFloat(e).toFixed(o));if(Number.isNaN(i))return"0.00";const s=Math.round(1e3*i);let l=Math.floor(s%1e3),d=Math.floor(i%60),c=Math.floor(s/6e4%60),u=Math.floor(s/36e5%60);u<10&&r&&(u=`0${u}`),c<10&&(u>0||r)&&(c=`0${c}`),d<10&&(u>0||c>0||r)&&(d=`0${d}`),l<100&&(l=`0${l}`),l<10&&o>2&&(l=`0${l}`);let m=`${d}`;return a||(m=`${d}.${l.toString().slice(0,o)}`),(c>0||parseFloat(u.toString()))&&(m=`${c}:${m}`),u>0&&(m=`${u}:${m}`),m}function uf(e,t,a){let o=cf(e,a);return t||(o=o.replace(".00","")),o.includes(":")||(o=`0:${o}`),o.startsWith("0")&&!o.startsWith("0:")&&(o=o.slice(1)),o}const mf=(e,t)=>{const a=e.getTime(),o=t.getTime();return Math.floor(Math.abs(a-o)/864e5)},pf=e=>{const t=I(new Date).diff(e,"days"),a=I(e).day(),o=I().day(),n=I().subtract(1,"days").day();return t<7?a===o?I(e).format("[today at] h:mma"):a===n?I(e).format("[yesterday at] h:mma"):I(e).format("[last] dddd [at] h:mma"):I(e).format("MM/DD/YYYY")},hf=e=>{const t=I(e).get("date"),a=I().get("date"),o=I().subtract(1,"days").get("date");return t===a?I(e).format("[today at] h:mma"):t===o?I(e).format("[yesterday at] h:mma"):I(e).format("MM/DD/YYYY")};function gf(e){const t=new Date(1e3*e);return`${t.getMonth()+1}/${t.getDate()}/${t.getFullYear()}`}function yf(e){return new Date(e.getFullYear(),e.getMonth())}function ff(e){const t=Math.floor(e/1e3),a=Math.floor(t/60),o=Math.floor(a/60),n=t%60,r=a%60;return o>0?`${o}h ${r}m`:a>0?`${r}m ${n}s`:`${n}s`}function Ef(e){return`${ff(e)} ago`}async function vf(){const{dispatch:e,state:t}=tn(),{user:a,token:o,impersonatingAdminEmail:n}=t.currentUser||{},{_id:r}=a||{};if(!r||!o){return void(new E).remove("ssrSignedInCookie",{path:"/"})}const i={userId:r,token:o},s=await gu("/api/v1/users/getProfile",{body:i});e(qc(s.user,s.token,n))}function wf(e){return{type:"SET_USER",user:e}}function bf(){return(e,t)=>{const{token:a,user:o}=t().currentUser||{};if(!o)return null;const{_id:n}=o;return a?yu("/api/v1/users/lastOptimizedProjectTime",{body:{token:a,userId:n},parseJSON:!1}).then((()=>{vf()})):Promise.resolve()}}async function _f(e,t,a){const{state:o,dispatch:n}=tn(),{token:r,user:i}=o.currentUser||{},{_id:s}=i||{};try{const o=await uu("api/v1/settingsUpdate",{body:{token:r,userId:s,notifType:e,on:t,location:a}});o.success?n(function(e,t,a){return{type:"UPDATE_USER_NOTIF_SETTING",on:e,notifType:t,location:a}}(t,e,a)):(console.error("Error update user settings:",o.messsage),n(Su({description:"There was an error with updating your notification settings.",type:"error"})))}catch(l){console.error("Error update user settings:",l),n(Su({description:"There was an error with updating your notification settings.",type:"error"}))}}function Tf(e){return(t,a)=>{const{user:o}=a().currentUser||{};return t(wf({...o,onboarding:e})),o._id?gu("/api/v1/users/updateProfile/onboarding",{body:{onboarding:e},parseJSON:!1}).then((()=>{vf()})):(t(Mu(e)),new Promise((()=>{})))}}function Sf(e){const{state:t,dispatch:a}=tn(),{user:o}=t.currentUser||{};a(wf({...o,resizeCanvasShortcuts:e})),o._id&&gu("/api/v1/users/updateProfile/resizeCanvasShortcuts",{body:{resizeCanvasShortcuts:e},parseJSON:!1}).catch((e=>console.error(e)))}function If(e){const{state:t,dispatch:a}=tn(),{user:o}=t.currentUser||{};a(wf({...o,royaltyFreePreference:e})),o._id&&gu("/api/v1/users/updateProfile/royaltyFreePreference",{body:{royaltyFreePreference:e},parseJSON:!1}).catch((e=>console.error(e)))}function xf(e){return gu("/api/v1/users/updateProfile/upsells",{body:{upsells:e},parseJSON:!1})}function kf(e){return(t,a)=>{const{user:o}=a().currentUser||{};return t(wf({...o,tooltipActivity:e})),o._id?gu("/api/v1/users/updateProfile/tooltipActivity",{body:{tooltipActivity:e},parseJSON:!1}).then((()=>{vf()})):new Promise((()=>{}))}}function Cf(e){return{type:"SET_COLLABORATING",isCollaborating:e}}function Af(e,t){return{type:"INIT_PRESENCE",presenceInfo:e,userId:t}}function Nf(e,t){return{type:"UPDATE_PRESENCE",presenceInfo:e,userId:t}}function Pf(e){return{type:"SET_PRESENT_USER",userId:e}}async function Rf(e){const{state:t,dispatch:a}=tn(),{user:o}=t.currentUser||{};a(wf({...o,transcriptionPreferences:e})),await gu("/api/v1/users/updateProfile/transcriptionPreferences",{body:{transcriptionPreferences:e},parseJSON:!1})}var Lf=(e=>(e.UPDATE_ANALYTICS="UPDATE_ANALYTICS",e.ADD_CONTEXT_MENU_ANALYTICS="ADD_CONTEXT_MENU_ANALYTICS",e))(Lf||{});function Df(e){return{type:"UPDATE_ANALYTICS",updates:e}}function Of(e){if(!e)throw Error("currentUser not set.");return!!e.impersonatingAdminEmail}function Ff(){return{type:"MOCK_SIGN_IN"}}function Mf(e){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())}function Uf(){const{state:e}=tn(),{presence:t}=e.studio,a=[];t&&Object.entries(t).forEach((([e,t])=>{e&&a.push(t.color)}));const o=Ki.filter((e=>!a.includes(e))),n=o[Math.floor(Math.random()*o.length)];if(!n)throw Error();return n}const Bf=["Abyssinian","Balinese","Bengal","Bobtail","Calico","Maine Coon","Manx","Mau","Munchkin","Persian","Peterbald","Ragdoll","Russian Blue","Scottish Fold","Shorthair","Siamese","Sphynx","Tabby"],Wf=["https://cdn-useast1.kapwing.com/samples/kat_blue.jpeg","https://cdn-useast1.kapwing.com/samples/kat_blue_gradient.jpeg","https://cdn-useast1.kapwing.com/samples/kat_brown.jpeg","https://cdn-useast1.kapwing.com/samples/kat_purple.jpeg","https://cdn-useast1.kapwing.com/samples/kat_purple_gradient.jpeg","https://cdn-useast1.kapwing.com/samples/kat_yellow.jpeg"];function Vf(e,t){if(!e._id){const e=Bf[Math.floor(Math.random()*Bf.length)];return{color:Uf(),heartbeat:Date.now(),name:`Anonymous ${e}`,profileImg:Wf[Math.floor(Math.random()*Wf.length)],selectedLayerId:t}}const{name:a,picture:o}=e;return{color:Uf(),heartbeat:Date.now(),name:a,profileImg:null!=o?o:void 0,selectedLayerId:t}}function jf(e,t){if(!e||!t)return;const a=Object.entries(e).find((([e,a])=>{if(a&&a.selectedLayerId===t&&Gf(a.heartbeat))return e}));return a?a[0]:void 0}function Gf(e){return function(e,t){const a=new Date(e),o=new Date(t);return(a.getTime()-o.getTime())/1e3}(Date.now(),e)<60}function Hf(e,t,a){if(!e)return;let o=!1;Object.entries(e).forEach((([e,n])=>{const r=Gf(n.heartbeat);e!==t&&r&&(o=!0),r||a({type:"REMOVE_PRESENCE",presenceInfo:n,userId:e})})),o?tn().state.studio.analytics.usedCollaborationWithOtherUser||a(Df({usedCollaborationWithOtherUser:!0})):a(Cf(!1))}const zf=e=>{var t,a;return!(!(null==(t=e.statusText)?void 0:t.toLowerCase().includes("Captcha check error.".toLocaleLowerCase()))&&!(null==(a=e.message)?void 0:a.toLocaleLowerCase().includes("Captcha check error.".toLocaleLowerCase())))};function $f(){var e;const{state:t}=tn(),{user:a}=t.currentUser,{onboarding:o}=t.sessionValues;return null!=(e=null==o?void 0:o.newUser)?e:a.createdAt===a.lastSignIn}function Kf(){const{state:e}=tn(),{user:t}=e.currentUser,{email:a}=t;if(t&&a){return a.split("@").pop()}return""}function Yf(){var e;const{state:t}=tn(),{user:a}=t.currentUser;return null!=(e=null==a?void 0:a.firstName)?e:a.email||"Kapwing Creator"}const qf=async e=>{const t=await aE(e);if(!t)return;const{status:a,interval:o}=await of(),n=dd(e),r={"Team ID":e,"Number of Workspace Members":t.totalTeamMembers,"Brandkit is set up":t.isBrandkitSetup,"Current Plan":n.name,"Monthly/Annual":o,"Subscription Status":a};window.sessionStorage.setItem("TEAM_WORKSPACE_ACCESS_LOGGED","TRUE"),vc("Team Workspace Accessed",r)},Xf=async e=>{const{workspaceId:t}=e,{state:a}=tn(),o=a.workspaces.allWorkspaces.find((e=>e._id===t)),n=await aE((null==o?void 0:o.teamId)||"");if(!n)return;const{team:r}=n,{_id:i}=r||{},s=!!r,l=null==o?void 0:o.type;if(s){const{currentUser:{user:{_id:t}}}=a,o=e.creatorId&&e.creatorId===t;let r;l===Jr.team?r="Team Folder":l===Jr.personal&&(r="My Folder");const{status:s,interval:d}=await of(),c=dd(i);vc("Team Project Accessed",{"Project Location":r,"Is Project Owner":o,"Team ID":i,"Number of Workspace Members":n.totalTeamMembers,"Brandkit is set up":n.isBrandkitSetup,"Current Plan":c.name,"Monthly/Annual":d,"Subscription Status":s})}},Jf=(e,t,a,o)=>{const n=ec(e.email,a),r={"Team ID":t,"Team Owner Email":a,"Team Collaborator Email":e.email||"Anonymous","Owner And Collaborator Domain Match":n,"Entry Point":o};amplitude.getInstance().setUserId(e._id),amplitude.getInstance().setUserProperties({Email:e.email}),amplitude.getInstance().logEvent("Team Invite Visited",r)},Qf=async(e,t,a,o,n)=>{var r;const i=ec(a,t),{status:s,interval:l}=await of(),d=cd(n),c={"Team ID":n._id,"Team Owner Email":t,"Team Collaborator Email":e.email,"Owner And Collaborator Domain Match":i,"Entry Point":o,"Current Plan":d.name,"Subscription Status":s,"Monthly/Annual":l,"Number of Workspace Members":(null==(r=n.users)?void 0:r.length)||1};amplitude.getInstance().setUserId(e._id),amplitude.getInstance().setUserProperties({Email:e.email}),amplitude.getInstance().logEvent("Team Joined",c)},Zf=async(e,t,a,o)=>{const{status:n,interval:r}=await of(),i={"Team ID":e,"Removed Email":t,"Removed Role":a,"Number of Workspace Members":o,"Current Plan":dd(e).name,"Monthly/Annual":r,"Subscription Status":n};amplitude.getInstance().logEvent("Team Member Removed",i)};var eE=(e=>(e.SIDEBAR="Add Members in Sidebar",e.WORKSPACE_HEADER="Workspace Header",e.USER_ONBOARDING="New User Onboarding",e.TEAM_SETTINGS="Team Settings",e.TEAM_CREATION="Team Creation",e.WORKSPACE_SIDEBAR_UPSELL="Workspace Sidebar Upsell",e.PROJECT_SHARE_DIALOG="Project Share Dialog",e))(eE||{});const tE=async({teamId:e,inviterEmail:t,shareType:a,origin:o})=>{const{status:n,interval:r}=await of();vc("Team Members Invited",{"Team ID":e,"Team Inviter Email":t,"Share Type":a,Origin:o,"Current Plan":dd(e).name,"Monthly/Annual":r,"Subscription Status":n,"Quantity Legacy Members":0})},aE=async e=>{var t;try{const{state:a}=tn(),o=rd(e);if(!o)throw new Error("Unable to get team");const n=null==(t=null==a?void 0:a.teams)?void 0:t.activeBrandkit,r=!!n&&await(async e=>{const t=e.colors.some((e=>!Yy(e))),a=e.fonts.some((e=>{return!("custom"===(t=e).type&&"62962eab0af119277ab7c9c3"===t.asset_id);var t}));let o=!0;const n=e.cmlIds[0];if(n||(o=!1),n)try{const e=await jy(n);qy(e.cml_file.asset_id)&&(o=!1)}catch(YEe){console.error(YEe)}return t||a||o})(n);return{totalTeamMembers:o.users.length,isBrandkitSetup:r,team:o}}catch(YEe){console.error(YEe)}},oE=e=>{vc("Added Workspace Name",{Origin:e})},nE=async e=>{const{interval:t,status:a}=await of();vc("Initiated Cancellation",{"Current Plan":Js(e.planTier),"Subscription Status":a,"Monthly/Annual":t,"Team ID":e._id,"Number of Workspace Members":e.users.length})},rE=async()=>{const e=nd();if(e){const{interval:t,status:a}=await of();vc("Continue to Survey",{"Current Plan":Js(e.planTier),"Subscription Status":a,"Monthly/Annual":t,"Team ID":e._id,"Number of Workspace Members":e.users.length})}},iE=async e=>{const{status:t,interval:a}=await of();vc("Downgrade Workspace",{"Current Plan":Js(e.planTier),"Subscription Status":t,"Monthly/Annual":a,"Team ID":e._id,"Number of Workspace Members":e.users.length})},sE=()=>{const{state:e}=tn(),t=nd(e),a=ld();Ec(Bd.INITIATE_DELETE_WORKSPACE,{teamId:null==t?void 0:t._id,numberWorkspaceMembers:null==t?void 0:t.users.length,currentPlan:a.planTier})},lE=async e=>{const{status:t,interval:a}=await of();Ec(Bd.DELETE_TEAM_WORKSPACE,{currentPlan:e.planTier,subscriptionStatus:t,monthlyAnnual:a,teamId:e._id,numberWorkspaceMembers:e.users.length})},dE=async(e,t)=>{const{interval:a,status:o}=await of(),n=nd();if(!n)return;const r=cd(n),i=t.fromVideoId?"Edit Request":"Suggested Workspaces";vc(`Join Request ${e}`,{"Team ID":n._id,"Current Plan":r.name,"Monthly/Annual":a,"Subscription Status":o,"Quantity Legacy Members":0,"Number of Workspace Members":"Accepted"===e?n.users.length+1:n.users.length,"Request Scenario":i})};function cE(){var e,t;const a=nd();if(!a)return{};const o=cd(a);return{"Current Plan":o.planTier,"Team ID":a?a._id:null,"Team Plan":o.name,"Number of Workspace Members":null!=(t=null==(e=a.teamUserDTOs)?void 0:e.length)?t:null==a?void 0:a.users.length}}const uE=e=>{vc("Visit from Join Request Email",{"Email Scenario":(()=>{switch(e){case hi.RequestToEditEmail:return"Edit Request";case hi.RequestToJoinEmail:return"Suggested Workspace Join Request";default:return"Unknown"}})()})};async function mE(e,t){const{interval:a}=await of(),o={numSeatsAdded:e-t,newPaidSeats:t,interval:a};Ec(Bd.OPEN_SEAT_ADDED,o)}async function pE(e,t){const{interval:a}=await of(),o={numSeatsRemoved:e-t,newPaidSeats:t,interval:a};Ec(Bd.OPEN_SEAT_REMOVED,o)}async function hE(){const{interval:e,numPaidSeats:t}=await of(),a=nd(),o={numMembers:((null==a?void 0:a.users.length)||2)-1,interval:e,newPaidSeats:t};Ec(Bd.LEFT_TEAM,o)}async function gE(){const{numPaidSeats:e}=await of(),t={newPaidSeats:e,interval:"Annual"};Ec(Bd.UPGRADE_MONTHLY_TO_ANNUAL,t)}var yE=(e=>(e.DISABLE="Disable",e.ENABLE="Enable",e.RESET="Reset",e))(yE||{});const fE=async(e,t)=>{const{status:a,interval:o}=await of();Ec(Bd.UPDATE_TEAM_JOIN_LINK,{currentPlan:e.planTier,subscriptionStatus:a,monthlyAnnual:o,teamId:e._id,numberWorkspaceMembers:e.users.length,action:t})};function EE(e){let t=function(e){let t=k(e);return t=t.replace(/[^a-z0-9.]/gi,"_"),t=t.replace(/_{2,}/g,"_"),t}(e);const a=t.split(".").pop();t=t.replace(/\..+$/,"");return t=`${t}-${x.generate()}`,t=`${t}.${a}`,t}function vE({files:e,isPrivate:t=!0,useNameDirectly:a}){return Eu("create_resumable_upload",{body:{files:e.map((({file:e})=>({fileName:a?e.name:EE(e.name||""),fileType:e.type,private:t})))},retries:5})}const wE=()=>{},bE=e=>new Promise((t=>setTimeout((()=>t()),e)));class _E{constructor({file:e,layer:t,bucket:o=Or,isPrivate:n=!1,onProgress:r=wE,onFinish:i=wE,onError:s=wE,onCancel:l=wE,onRetry:d=wE,origin:c="unknown",uploadSourceComponent:u,useNameDirectly:m=!1,analyticsUploadSource:p}){a(this,"file"),a(this,"layer"),a(this,"bucket"),a(this,"isPrivate"),a(this,"onProgress"),a(this,"onFinish"),a(this,"onError"),a(this,"onCancel"),a(this,"onRetry"),a(this,"origin"),a(this,"upload_uri",""),a(this,"read_uri",""),a(this,"uploadSourceComponent"),a(this,"xhr",null),a(this,"offlineRetries",0),a(this,"otherRetries",0),a(this,"useNameDirectly"),a(this,"analyticsUploadSource"),a(this,"logError",((e,t,a=!0)=>{w({category:"Upload Fails",message:`Orign: ${this.origin} stage: ${t}, file: ${JSON.stringify(this.file)}`}),a&&b(e),vc("Upload Fails",{Origin:this.origin,Message:"string"==typeof e?e:e.message,FailStage:t,FileType:this.file.type,"File Size (MB)":this.file.size/1e6})})),a(this,"logProgress",(e=>{w({category:"Upload Progress",message:e})})),a(this,"upload",(async()=>{for(let t=0;t<=5;t+=1){try{this.logProgress("Upload Begins");const e=await vE({files:[{file:this.file}],isPrivate:this.isPrivate,useNameDirectly:this.useNameDirectly}),{read_uri:t,upload_uri:a}=e.uris[0];this.upload_uri=a,this.read_uri=t,this.uploadToGCS()}catch(e){if(t<5){await bE(2**t*1e3);continue}const{message:a}=xu(e);this.logError(e instanceof Error?e:a,"upload"),this.onError(a,this.file,this.layer,"upload",!1)}break}})),a(this,"uploadToGCS",(async({retry:e=0,startByte:t=0}={})=>{let a=null,o=null;const n=setInterval((()=>{if(null!==a&&null!==o&&1!==o){0===Math.abs(o-a)&&(vc("Upload Stalled",{"File Type":this.file.type,"Size (MB)":this.file.size/1e6,"Upload Location":this.analyticsUploadSource}),clearInterval(n))}a=o}),6e4);let r=this.file;const i={};if(t){const e=this.file.size-1;i["Content-Range"]=`bytes ${t}-${e}/${this.file.size}`,r=new File([this.file.slice(t,e+1)],this.file.name,{type:this.file.type})}const s=new XMLHttpRequest;s.open("PUT",this.upload_uri,!0),s.onerror=t=>{clearInterval(n),t&&console.error("upload error",t),this.handleUploadRetry(s.status,e)},s.onabort=()=>{clearInterval(n)},s.onload=async()=>{if(clearInterval(n),200!==s.status)return console.error(`xhr returned status ${s.status}, `,s),void this.handleUploadRetry(s.status,e);this.logProgress("Upload Finish Begins"),this.runInRetryLoop((()=>this.onFinish(s,this.read_uri,this.file,this.layer,{retries:e})),7,(()=>this.logProgress("Upload Flow Succeeds")),"onFinish")},s.upload.onprogress=e=>{const a=(t+e.loaded)/this.file.size;this.onProgress(a,this.file,this.layer),o=a},s.setRequestHeader("Content-Type",r.type),Object.entries(i).forEach((([e,t])=>{s.setRequestHeader(e,t)})),s.send(r),this.xhr=s})),a(this,"runInRetryLoop",(async(e,t,a,o)=>{let n="";for(let i=0;i<t;i+=1)try{return await e(),a(),void(n="")}catch(r){console.info(r),n=r instanceof Error?r:xu(r).message;const e=2**Math.max(i,5)*1e3;await bE(e),console.info(`Retrying (${i+1}) UploadManager stage ${o}`)}n&&this.logError(n,o)})),a(this,"waitForUserToBeOnline",(()=>new Promise((e=>{let t;const a=()=>{e(),clearTimeout(t)};window.addEventListener("online",a,{once:!0}),t=window.setTimeout((()=>{e(),window.removeEventListener("online",a)}),12e5)})))),a(this,"waitForNextUploadRetry",(async e=>{await bE(1e3);let t;if(navigator.onLine){const a=2**e,o=1e3*Math.max(15,Math.min(200,a));t=bE(o),this.otherRetries+=1}else this.logProgress("User is offline, waiting for network to reconnect"),t=this.waitForUserToBeOnline(),this.offlineRetries+=1;this.onRetry(this.layer,{retries:e+1,offlineRetries:this.offlineRetries,otherRetries:this.otherRetries}),await t;const a=5e3*Math.random();await bE(a)})),a(this,"handleUploadRetry",(async(e,t=0)=>{if(t<=1e3)return this.logProgress(`Upload Retry ${t}`),await this.waitForNextUploadRetry(t),void(0===e||503===e?this.resumeUploadToGCS(t+1):this.uploadToGCS({retry:t+1}));const a="An error occurred during upload. Please try again later.",o=new Error(a);this.logError(o,"handleUploadRetry"),this.onError(a,this.file,this.layer,"handleUploadRetry",!1)})),a(this,"resumeUploadToGCS",(e=>{const{upload_uri:t,read_uri:a}=this,o=new XMLHttpRequest;o.open("PUT",t,!0),o.onload=async t=>{if(308===t.target.status){this.logProgress("Upload Resumes"),console.debug("gcs returned 308, try resuming upload");const t=o.getResponseHeader("Range");if(!t)return console.debug("no range returned, try again"),void this.uploadToGCS({retry:e});const a=parseInt(t.split("-").pop(),10);if(a<0)return console.debug("Last uploaded byte < 0, try again from beginning"),void this.uploadToGCS({retry:e});const n=a+1;console.debug("Resuming upload, starting at byte ",a),this.uploadToGCS({startByte:n,retry:e})}else this.logProgress("Resumed Upload Finishes"),this.runInRetryLoop((()=>this.onFinish(o,a,this.file,this.layer,{retries:e})),7,(()=>this.logProgress("Upload Flow Resumes and Succeeds")),"onFinish/resumed")},o.onerror=()=>{this.handleUploadRetry(o.status,e)},o.setRequestHeader("Content-Range",`bytes */${this.file.size}`),o.send(),this.xhr=o})),a(this,"cancel",(()=>{const{xhr:e}=this;e&&(e.abort(),this.onCancel())})),this.file=e,this.layer=t,this.bucket=o,this.isPrivate=n,this.onProgress=r,this.onFinish=i,this.onError=s,this.onCancel=l,this.onRetry=d,this.origin=c,this.uploadSourceComponent=u,this.useNameDirectly=m,this.analyticsUploadSource=p}}const TE=(e,t)=>e.filter((e=>{const a=e.teamId===t&&e.type===Jr.personal&&!e.sharedAt,o=!(e.teamId&&"personal"!==e.teamId||"personal"!==t||e.sharedAt);return a||o})),SE=(e,t)=>e.filter((e=>e.teamId===t&&e.type===Jr.team&&!e.sharedAt));function IE(e){const{teams:t}=tn().state,{selectedTeamId:a}=t,o=rd(a);return null==o?void 0:o.users.find((t=>t.userId===e))}const xE=(e,t,a)=>{if(t&&a){const e=C.parse(a);if(!e.error&&e.sld){return`${e.sld.charAt(0).toLocaleUpperCase()+e.sld.toLocaleLowerCase().slice(1)} Team Workspace`}}return e?`${e}'s Team Workspace`:"Untitled Team Workspace"};function kE(e){return!!e&&e===li.admin}function CE(){const{teams:e,currentUser:t}=tn().state,{user:a}=t,o=a._id,{selectedTeamId:n}=e,r=rd(n),i=null==r?void 0:r.users.find((e=>e.userId===o));if(!i)return!1;const{role:s}=i;return!!s&&s===li.admin}const AE=async(e,t)=>{const a=await(e=>new Promise((t=>{new _E({file:e,onFinish:async(e,a)=>{t(a)},onError:()=>t(null),layer:{},useNameDirectly:!0,analyticsUploadSource:"Team creation modal",uploadSourceComponent:"CreateNewTeamModal"}).upload()})))(e);return gu(`/api/v1/teams/${t}/`,{body:{updateDict:{picture:a}}})};async function NE(e,t){const{dispatch:a}=tn();await gu(`/api/v2/teams/${e}/settings/invite-link`,{body:{enabled:t}}),a(GE())}async function PE(e){return gu(`/api/v1/team-invite-links/${e}/reset`)}const RE=async e=>{const{dispatch:t}=tn(),a={teamId:e},o=await hu("/api/v1/invites/teams",{params:a});return t({type:"SET_ACTIVE_TEAM_INVITES",invites:o.invites}),o};function LE(e){return{type:"SET_CURRENT_TEAM",_id:e}}function DE(e){return{type:"SET_TEAMS",teams:e}}function OE(e){return{type:"SET_USER_TEAM_INVITES",invites:e}}function FE(e,t){return{type:"UPDATE_TEAM_NAME",id:e,name:t}}function ME(e){return{type:"SET_SHARED_TEAM_OWNER_EMAIL",sharedTeamOwnerEmail:e}}function UE(e){return{type:"SET_SHARED_TEAM_ID",sharedTeamId:e}}function BE(e){return{type:"SET_ACTIVE_BRANDKIT",update:e}}function WE(e){return{type:"SET_BRANDKIT_TEMPLATES",projects:e}}function VE(){return async(e,t)=>{var a;const{teams:o,currentUser:n}=t(),{selectedTeamId:r}=o;if(!r)return;const i=await zE(r,n,0===((null==(a=o.brandkitTemplates)?void 0:a.length)||0)),{brandkit:s,brandkitTemplates:l}=i;e(BE(s)),l&&e(WE(l))}}function jE(){return async(e,t)=>{var a;const{teams:{selectedTeamId:o},currentUser:n}=t(),{token:r,user:i}=n||{},{_id:s}=i||{},l={token:r,userId:s};try{const t=await hu("/api/v2/teams/user",{params:l});return o||e(LE((null==(a=t[0])?void 0:a._id)||"")),e(DE(t)),t}catch(YEe){return[]}}}function GE(){return async(e,t)=>{const a=t(),{teams:o}=a,{selectedTeamId:n}=o,r=await hu(`/api/v2/teams/${n}`);e({type:"UPDATE_TEAM",id:r._id,updateDict:r})}}function HE(){return async(e,t)=>{const{teams:a,currentUser:o}=t();if(!sc(o))return[];const{allTeams:n}=a,{token:r,user:i,email:s}=o||{},{_id:l}=i||{},d={token:r,userId:l,email:s};try{const t=await hu("/api/v1/users/team-invites",{params:d});return e(OE(t.filter((e=>!n.some((t=>e.team._id===t._id)))))),a}catch(YEe){return[]}}}function zE(e,t,a){const{token:o,user:n}=t||{},{_id:r}=n||{};return hu(`/api/v2/teams/${e}`,{params:{token:o,userId:r,teamId:e,fetchBrandkitTemplates:a}})}function $E(e,t){return(a,o)=>{const{token:n,user:r}=o().currentUser||{},{_id:i}=r||{};return gu(`/api/v1/teams/${e}`,{body:{token:n,userId:i,teamId:e,updateDict:t},parseJSON:!1})}}function KE(e,t,a){const{token:o,user:n}=a||{},{_id:r}=n||{};return gu(`/api/v2/teams/${e}/removeUsers`,{body:{token:o,userId:r,teamId:e,users:t},parseJSON:!1})}function YE(e){return async(t,a)=>{var o;const{token:n,user:r}=a().currentUser||{},{allTeams:i}=a().teams,{_id:s}=r||{};await pu("/api/v1/teams/delete",{body:{token:n,userId:s,teamId:e},parseJSON:!1}),t(DE([...i.filter((t=>t._id!==e))])),t(LE((null==(o=i[0])?void 0:o._id)||""))}}function qE(e,t,a){return async(o,n)=>{const{currentUser:r}=n(),{token:i,user:s}=r,{_id:l}=s||{};await gu(`/api/v1/teams/${e}/updateUser`,{body:{token:i,userId:l,updateUserId:t,teamId:e,updateDict:a},parseJSON:!1})}}var XE=(e=>(e.WorkspaceDropdown="Workspace Dropdown",e))(XE||{});function JE(e,t){return async()=>{const{dispatch:a,state:o}=tn(),{currentUser:n,teams:r}=o,{userTeamInvites:i}=r,{token:s,user:l}=n||{},{_id:d}=l||{},{email:c}=l||{},u={token:s,userId:d,inviteKey:e.inviteKey};try{const o=await gu("/api/v1/invites/teams/accept",{body:u});if(o.teamId){a(LE(o.teamId)),a(Su({description:"Invite accepted.",type:"success"})),a(OE([...i].filter((t=>t._id!==e._id)))),await a(jE());const n=nd();n&&t&&Qf(l,o.inviterEmail,c,t,n)}}catch(m){Iu({description:"There was an issue joining the team, please try again.",error:m})}}}async function QE(e,t){const{dispatch:a,state:o}=tn(),{currentUser:n}=o,{token:r,user:i}=n||{},s={privacy:t,token:r,userId:i&&i._id};await yu(`/api/v2/teams/${e}/privacy`,{body:s}),a(GE())}async function ZE(e,t){const{state:a,dispatch:o}=tn(),{currentUser:n}=a,{token:r,user:i}=n||{},s={discoverability:t,token:r,userId:i&&i._id},l=await yu(`/api/v2/teams/${e}/discoverability`,{body:s});return o(GE()),l}function ev(){return async(e,t)=>{const a=t(),{token:o,user:n}=a.currentUser||{},{_id:r}=n||{},{teams:i}=a;await gu("/api/v2/teams/cumulativeDuration/reset",{body:{token:o,userId:r,teamId:i.selectedTeamId},parseJSON:!1}),e(GE())}}function tv(e){return async(t,a)=>{const o=a(),{token:n,user:r}=a().currentUser||{},{_id:i}=r||{},{teams:s}=o;await gu("/api/v2/teams/cumulativeDuration/update",{body:{token:n,userId:i,duration:e,teamId:s.selectedTeamId},parseJSON:!1}),t(GE())}}function av(){return async(e,t)=>{const a=t(),{token:o,user:n}=a.currentUser||{},{_id:r}=n||{},{teams:i}=a;await gu("/api/v2/teams/transcribeUsage/reset",{body:{token:o,userId:r,teamId:i.selectedTeamId},parseJSON:!1}),e(GE())}}function ov(e){return async(t,a)=>{const o=a(),{token:n,user:r}=o.currentUser||{},{_id:i}=r||{},{teams:s}=o;await gu("/api/v2/teams/transcribeUsage/update",{body:{token:n,userId:i,usage:e,teamId:s.selectedTeamId},parseJSON:!1}),t(GE())}}const nv=async(e,t,a,o)=>{const{state:n}=tn(),r=n.workspaces.allWorkspaces.find((t=>t._id===e)),i=await aE((null==r?void 0:r.teamId)||"");if(!i)return;const{team:s}=i,{_id:l}=s||{},d=!!s,c=null==r?void 0:r.type;let u;u=d?c===Jr.team?"Team Folder":"My Folder":a?"Shared Folder":"Personal Workspace";const{interval:m,status:p}=await of(),h=ld(),g={"Project Location":u,Source:t,"Number of Workspace Members":i.totalTeamMembers,"Brandkit is set up":i.isBrandkitSetup,"Current Plan":h.name,"Monthly/Annual":m,"Subscription Status":p,"Quantity Legacy Members":0};l&&(g["Team ID"]=l),o&&(g["Is Original Project Owner"]=o),vc("New Project In Workspace",g)},rv=(e,t)=>{vc("Multi Select Project Management Action Initiated",{"Project Action":e,"Number of Projects":t})},iv=new Set;const sv=async()=>{const{state:e}=tn(),t=await aE(e.teams.selectedTeamId||"");if(!t)return;vc("Begin Workspace Share",{"Number of Workspace Members":t.totalTeamMembers,"Brandkit is set up":t.isBrandkitSetup,"Team ID":e.teams.selectedTeamId})},lv=e=>{vc("Begin Add Workspace Details",{"Entry Point":e})},dv=()=>{vc("Began Onboarding Survey")},cv=(e,t)=>{amplitude.getInstance().setUserId(e),amplitude.getInstance().setUserProperties({prefersDarkMode:t})},uv=e=>{let t=0,a=0;return e.teams.forEach((e=>{var o;switch(null==(o=e.settings)?void 0:o.discoverability){case wn.AnyoneCanJoin:t+=1;break;case wn.RequestToJoin:default:a+=1}})),{numOpenToJoin:t,numAskToJoin:a}},mv=({numPendingInvites:e,suggestedWorkspaces:t,entryPoint:a,isQualifiedLead:o})=>{var n;const{numAskToJoin:r,numOpenToJoin:i}=uv(t);vc("Begin Suggested Workspaces",{Domain:t.teams.length>0?null==(n=t.teams[0])?void 0:n.emailDomain:"","Number Invite Workspaces":e,"Number Suggested Workspaces - Ask to Join":r,"Number Suggested Workspaces - Open to Join":i,"Entry Point":a}),amplitude.getInstance().setUserProperties({Domain:Kf()}),o&&amplitude.getInstance().setUserProperties({"Is Qualified Lead":o})};var pv=(e=>(e.Onboarding="New User Onboarding",e.Sidebar="Sidebar",e))(pv||{});const hv=async(e,t,a)=>{const o=await zE(t,a,!1),{interval:n,status:r}=await of(),i=ld();vc("Request to Join",{"Team ID":o._id,"Entry Point":e,"Number of Workspace Members":o.numberOfUsers,"Current Plan":i.name,"Monthly/Annual":n,"Subscription Status":r,"Quantity Legacy Members":0})};function gv(e){return{type:"SET_WORKSPACES",workspaces:e}}function yv(e){return{type:"SET_CURRENT_WORKSPACE",workspaceId:e}}function fv(e,t){return async()=>{const{state:a}=tn(),{user:o}=a.currentUser,n=a.projects.byId[e];return t.destinationFolderId&&(async()=>{let e;try{e=(await hu(`/api/v1/workspaces/${t.destinationFolderId}/getUsers`)).keys.length>1}catch(YEe){e=void 0}const a=!!n&&o._id===n.creatorId;nv(t.destinationFolderId||"","Copied",e,a)})(),gu(`/api/v2/project/${e}/copy`,{body:t})}}function Ev(e,t){return()=>{const{token:a,user:o}=t||{},n={token:a,userId:o&&o._id};return pu(`/api/v1/projects/${e}`,{parseJSON:!1,params:n})}}function vv(e,t){return()=>{const{token:a,user:o}=t||{};return pu("/api/v1/projects/",{parseJSON:!1,params:{token:a,userId:o&&o._id},body:{projectIds:e}})}}function wv(e,t,a){return()=>{const{token:o,user:n}=t||{},r={token:o,userId:n&&n._id};return gu(`/api/v1/projects/${e}/move`,{parseJSON:!1,params:r,body:{newWorkspaceId:a}})}}function bv(e,t){return gu("/api/v1/projects/move",{body:{projectIds:e,destinationFolderId:t}})}async function _v(e,t,a){if(!e)return;const{token:o,user:n}=a||{};try{await yu(`/api/v1/projects/${e}`,{body:{token:o,userId:n&&n._id,project:t},parseJSON:!1})}catch(YEe){console.warn(YEe)}}function Tv(e,t,a){return()=>{const{token:o,user:n}=a||{};return yu(`/api/v1/workspaces/${e}`,{body:{token:o,userId:n&&n._id,workspaceFields:t},parseJSON:!1})}}function Sv(){return{type:"SET_WORKSPACE_MENU"}}function Iv(){return{type:"SHOW_UPLOAD_DIALOG"}}function xv(){return{type:"HIDE_UPLOAD_DIALOG"}}function kv(){return{type:"SHOW_DRAG_UPLOAD_DIALOG"}}function Cv(){return{type:"HIDE_DRAG_UPLOAD_DIALOG"}}function Av(e){return{type:"SET_WORKSPACE_UPLOAD_STATUS",text:e}}function Nv(e){return{type:"ADD_WORKSPACE_UPLOAD_FILE",file:e}}function Pv(e,t){return{type:"SET_FILE_UPLOAD_PROGRESS",id:e,uploadProgress:t}}function Rv(e){return{type:"ADD_WORKSPACE_UPLOAD_PROJECT",video:e}}function Lv(){return{type:"CLEAR_WORKSPACE_UPLOAD_FILES"}}function Dv(e){return{type:"REMOVE_WORKSPACE_UPLOAD_FILE",fileId:e}}function Ov(e){return{type:"REMOVE_WORKSPACE_UPLOAD_FILES",fileIds:e}}function Fv(e,t){return{type:"UPDATE_WORKSPACE_UPLOAD_FILE",id:e,fileInfo:t}}function Mv(e){return{type:"MARK_UPLOAD_AS_CREATED",id:e}}function Uv(e){return{type:"MARK_UPLOAD_AS_CANCELLED",id:e}}function Bv(e,t){return{type:"UPDATE_WORKSPACE_RECENT_FONTS",workspaceId:e,recentlyUsedFonts:t}}function Wv(e,t){return{type:"UPDATE_WORKSPACE_CUSTOM_FONTS",workspaceId:e,customFonts:t}}function Vv(e){return{type:"SET_CURRENT_FOLDER_SETTINGS",folderSettings:e}}function jv(e){return{type:"SET_SWM_FOLDER_SETTINGS",folderSettings:e}}function Gv(e){return{type:"SET_SELECTION_MODE",selectionMode:e}}function Hv(e){return{type:"SET_SHOW_ONBOARDING_UPSELL",upsellType:e}}function zv(e){return{type:"SET_SUGGESTED_WORKSPACES",payload:e}}var $v=(e=>(e[e.GRID_VIEW=0]="GRID_VIEW",e[e.LIST_VIEW=1]="LIST_VIEW",e))($v||{}),Kv=(e=>(e[e.PROJECT_NAME=0]="PROJECT_NAME",e[e.DATE_EDITED=1]="DATE_EDITED",e[e.DATE_CREATED=2]="DATE_CREATED",e[e.LAST_EDITOR=3]="LAST_EDITOR",e))(Kv||{}),Yv=(e=>(e[e.ASCENDING=0]="ASCENDING",e[e.DESCENDING=1]="DESCENDING",e))(Yv||{}),qv=(e=>(e[e.PAYWALL=0]="PAYWALL",e[e.MOVE=1]="MOVE",e[e.REMOVE=2]="REMOVE",e[e.DELETE=3]="DELETE",e[e.TWO_WEEK_POST_ONBOARDING_MULTI_ACCOUNT=4]="TWO_WEEK_POST_ONBOARDING_MULTI_ACCOUNT",e[e.TWO_WEEK_POST_ONBOARDING_SINGLE_ACCOUNT=5]="TWO_WEEK_POST_ONBOARDING_SINGLE_ACCOUNT",e[e.TWO_WEEK_RECURRING_MULTI_ACCOUNT=6]="TWO_WEEK_RECURRING_MULTI_ACCOUNT",e[e.TWO_WEEK_RECURRING_SINGLE_ACCOUNT=7]="TWO_WEEK_RECURRING_SINGLE_ACCOUNT",e[e.NONE=8]="NONE",e))(qv||{}),Xv=(e=>(e[e.WORKSPACE=0]="WORKSPACE",e[e.INVITE=1]="INVITE",e[e.ROLE=2]="ROLE",e))(Xv||{}),Jv=(e=>(e.Work="Work",e.School="School",e.PersonalProjects="Personal Projects",e.SuggestedWorkspaces="Suggested Workspaces",e.None="",e))(Jv||{});function Qv(e,t){if(!e)return e;const a=cp(e);if(!a)return null;Object.assign(a,t);const{r:o,g:n,b:r,a:i}=a;return`rgba(${o},${n},${r},${i})`}function Zv(e){var t,a;return null!=(a=null==(t=cp(e))?void 0:t.a)?a:1}function ew(e,t){const a=cp(e);if(!a)return e;const{r:o,g:n,b:r}=a;let i=String(t);return i.length>5&&(i=t.toFixed(3)),`rgba(${o},${n},${r},${i})`}function tw(e){if("none"===e)return!0;if(e&&!e.startsWith("rgb"))return!1;const t=dp(e);return!t||0===t.a}function aw(e,t){if(t&&t.textShadow&&"black"!==t.textShadow&&"white"!==t.textShadow)return"transparent";const a=cp(e);if(!a)return"black";const{r:o,g:n,b:r}=a,i=[o,n,r];return Math.round((299*i[0]+587*i[1]+114*i[2])/1e3)>125?"black":"white"}function ow(e,t,a=!1){return{type:"UPDATE_SCENE",scene:e,properties:t,undoable:a}}function nw(){const{state:e}=tn(),t=e.currentUser.user._id;return"trim"===e.studio.origin||"cut-video"===e.studio.origin?{type:"DISABLE_SNAP_IN_TIMELINE",userId:t}:{type:"ENABLE_SNAP_IN_TIMELINE",userId:t}}function rw(){const{state:e}=tn();return{type:"ENABLE_SNAP_IN_TIMELINE",userId:e.currentUser.user._id}}function iw(){const{state:e}=tn();return{type:"DISABLE_SNAP_IN_TIMELINE",userId:e.currentUser.user._id}}function sw(e){return{type:"SET_VIDEO_TYPE",videoType:e}}function lw(e){return{type:"SET_IMAGE_TYPE",imageType:e}}function dw(e){return{type:"SET_GIF_TYPE",gifType:e}}function cw(e){return{type:"SET_EXPORT_FRAME_TIME",exportFrameTime:e}}function uw(e){return{type:"SET_QUALITY",quality:e}}function mw(e,t){const{state:a}=tn();return{type:"SET_USER_SPECIFIC_SETTING",key:e,value:t,userId:a.currentUser.user._id}}function pw(e){return{type:"REMOVE_SUBTITLE",subtitle:e}}function hw(e){return{type:"DUPLICATE_SUBTITLE",subtitle:e}}function gw(e,t){return{type:"SET_SUBTITLE_TIME",subtitle:e,times:t}}function yw(e,t){return{type:"SET_SUBTITLE_TEXT",subtitle:e,text:t}}function fw(e,t=!1,a,o,n,r){return{type:"SET_SUBTITLES_FONT",hasCustomFont:t,font:e,url:a,fontType:o,source:n,asset_id:r}}function Ew(e){return{type:"SET_SUBTITLES_FONT_SIZE",fontSize:e}}function vw(e){return{type:"SET_SUBTITLES_FONT_SIZE_RATIO",sizeRatio:e}}function ww(e){return{type:"SET_SUBTITLES_FONT_WEIGHT",fontWeight:e}}function bw(e){return{type:"SET_SUBTITLES_FONT_COLOR",color:e}}function _w(e){return{type:"SET_SUBTITLES_FONT_STYLE",fontStyle:e}}function Tw(e){return{type:"SET_SUBTITLES_TEXT_ALIGN",textAlign:e}}function Sw(e){return{type:"SET_SUBTITLE_TEXT_VERTICAL_ALIGN",textVerticalAlign:e}}function Iw(e){return{type:"SET_ACTIVE_SUBTITLE_TEXT_AREA",textAreaId:e}}function xw(){return{type:"SET_UPDATE_SUBTITLE_POSITION"}}function kw(e){return{type:"SET_SUBTITLE_FIXED_POSITION",position:e}}function Cw(e){return{type:"SET_SUBTITLES_BACKGROUND_COLOR",background:e}}function Aw(e){return{type:"SET_SUBTITLES_BACKGROUND_STYLE",style:e}}function Nw(e){return{type:"SET_SUBTITLES_LINE_WIDTH",lineWidth:e}}function Pw(e){return{type:"SET_SUBTITLES_TEXT_SHADOW",textShadow:e}}function Rw(e){return{type:"SET_SUBTITLE_VIDEO",video:e}}function Lw(e){return{type:"SET_SUBTITLES_BACKGROUND_OPACITY",bgOpacity:e}}function Dw(e){return{type:"SET_TRANSLATE_LANGUAGE_CODE",translateLanguageCode:e}}const Ow={commentsLoading:!0},Fw=g({initialState:Ow,name:"comments",reducers:{setComments:(e,t)=>{e.comments=t.payload},setSelectedCommentId:(e,t)=>{e.selectedCommentId=t.payload},setCommentsOpen:(e,t)=>{e.commentsOpen=t.payload},setCommentsLoading:(e,t)=>{e.commentsLoading=t.payload},addComment:(e,t)=>{e.comments=e.comments?[...e.comments,t.payload]:[t.payload]},editComment:(e,t)=>{var a;const{commentId:o,updates:n}=t.payload,r=null==(a=e.comments)?void 0:a.map((e=>e._id===o?{...e,...n}:e));e.comments=r},deleteComment:(e,t)=>{var a;const o=t.payload,n=null==(a=e.comments)?void 0:a.filter((e=>e._id!==o));e.comments=n}},extraReducers:e=>e.addDefaultCase(((e,t)=>{switch(t.type){case"RESET_STUDIO":case"RESET_STATE_PRESERVE_USER":return Ow;case"SET_STUDIO":return t.projectIdChanged?Ow:e;case"SELECT_ITEM":return t.item&&(e.selectedCommentId="",e.commentsOpen=!1),e;default:return e}}))}),{setComments:Mw,setSelectedCommentId:Uw,setCommentsOpen:Bw,setCommentsLoading:Ww,addComment:Vw,editComment:jw,deleteComment:Gw}=Fw.actions;const Hw=["hidden","local_url","removeBgPreviewUrl"],zw=["duration","startTime","endTime","videoDelay"];function $w(e,t,a,o,n,r=!0){const i=`${"scene"===o?"scene":"layer"}_${t}`;let l;const d=e.map((e=>e.id!==t?e:(Object.keys(a).forEach((t=>{if(zw.includes(t)){const e=a[t];null!=e&&(a[t]=Number(e))}Hw.includes(t)||!r||s.exports.isEqual(a[t],e[t])||py(i,t,a[t],e[t],`${n}/editSegment`)})),l={...e,...a},l)));return[d,d.find((e=>e.id===t))]}function Kw(e,t,a){const o=[];return t.layers.forEach(((n,r)=>{n.id!==e.id?o.push(n):function(e,t,a,o){ly({p:[`scene_${a.id}_layers`,e],ld:t.id},{srcFn:o}),ly({p:[`layer_${t.id}`],od:t},{srcFn:o})}(r,n,t,`removeLayerHelper/${a}`)})),o}function Yw(e,t){const{axis:a}=t;let o=t.layer.position;for(const n of e)if(n.id===t.layer.id){"position"in n&&(o=n.position);break}return o.flip||(o.flip={x:!1,y:!1}),$w(e,t.layer.id,{position:{...o,flip:{...o.flip,[a]:!o.flip[a]}}},"layer","setFlip")}function qw(e,t,a,o=!1){var n;let r=e.layers.length-1;for(let m=e.layers.length-1;m>=0;m-=1)if(o||"subtitle"!==(null==(n=e.layers[m])?void 0:n.type)){r=m;break}const i=e.layers.map((e=>e.id)).indexOf(t.id),s=i+a,l=`scene_${e.id}_layers`;if(s<=r){!function(e,t,a,o){ly({p:[e,t],lm:a},{srcFn:o})}(l,i,s,"reorderLayer");return d=e.layers,c=i,u=s,d.reduce(((e,t,a,o)=>{if(c===u&&e.push(t),a===c)return e;if(c<u&&e.push(t),a===u){const t=o[c];t&&e.push(t)}return c>u&&e.push(t),e}),[])}var d,c,u;return e.layers}function Xw(e,t){return Object.values(e).findIndex((e=>e.id===t))}function Jw(e,t){return t.allLayers.byId[e]}function Qw(e,t){const a=t.scenes[0];if(!a)return[];const o=[],{layers:n}=a,{layers:r}=e;for(const i of r){const e=n.find((({id:e})=>e===i.id));e&&void 0!==e.timelineRow&&o.indexOf(e.timelineRow)<0&&o.push(e.timelineRow)}return o.sort()}function Zw(e,t){const a=t.scenes[0];if(!a)return[];let o=[];const{layers:n}=a;if(!e)return[];if("group"===e.type){const a=t.groups[e.id];if(!a)return[];o=Qw(a,t)}else if("gap"===e.type)t.timelineGap&&t.timelineGap.gapId===e.id&&o.push(t.timelineGap.timelineRow);else if("layer"===e.type){const t=n.find((({id:t})=>t===e.id));t&&void 0!==t.timelineRow&&o.push(t.timelineRow)}return o}function eb(e){let t=0;for(const a of e)a.duration&&(t+=Number(a.duration));return t}function tb(e,t,a){if(!((e,t)=>{var a;if("gif"===e.videoType)return!0;if(0===t){for(const t of(null==(a=e.scenes[0])?void 0:a.layers)||[])if("image/gif"===t.mime||"image/gif"===t.content_type)return!1;return!0}return!1})(e,t))for(const o of a)o.background===lp&&(o.background="#FFFFFF")}function ab(e){const t=[],a=[];for(const o of e)Cd(o)?a.push(o):t.push(o);return a.sort(((e,t)=>e.startTime-t.startTime)),t.concat(a)}function ob(e,{asset_id:t,cmlFileId:a}){e.thisProjectCMLFiles||(e.thisProjectCMLFiles={},my("thisProjectCMLFiles",{},void 0,"linkCMLFileToThisProject"));const o=e.thisProjectCMLFiles[a],n={addedTimestamp:Date.now(),asset_id:t,cmlFileId:a};e.thisProjectCMLFiles[a]=n,hy("thisProjectCMLFiles",a,n,o,"linkCMLFileToThisProject")}function nb(e,t){if(!e.thisProjectCMLFiles)return;const a=e.thisProjectCMLFiles[t];delete e.thisProjectCMLFiles[t],function(e,t,a,o){gy(e,t,a,o)}("thisProjectCMLFiles",t,a,"unlinkAssetFromThisProject")}const rb=(e,t,a,o)=>{let n,r=null;const i="FORWARDS"===o?1:-1;for(n="FORWARDS"===o?a+1:a-1;"FORWARDS"===o?n<=t.length-1:n>=0;n+=i){const a=t[n],o=Object.entries(e.groups).find((([e,t])=>t.layers.find((e=>e.id===(null==a?void 0:a.id)))));if(!o)break;{const[e]=o;if(r){if(e!==r)break}else r=e}}return r&&(n-=i),n},ib=(e,t)=>{const a={...e.groups},o=a[t];if(!o)throw Error("Group not found");const n={...o},r={...n};let i;n.layers||(n.layers=[],n.saved=!1);let s=n.layers.filter((e=>e.saved));const l=n.layers.filter((e=>!e.saved&&e.fromMergedGroup)),d=Object.keys(s.reduce(((e,t)=>t.fromMergedGroup?{...e,[t.fromMergedGroup]:!0}:e),{}));d.forEach((e=>{delete a[e]})),s=s.map((e=>({id:e.id,saved:e.saved})));const c=Object.keys(l.reduce(((e,t)=>t.fromMergedGroup?{...e,[t.fromMergedGroup]:!0}:e),{}));c.forEach((e=>{const t=a[e];t&&(a[e]={...t,layers:l.filter((t=>t.fromMergedGroup===e)).map((e=>({id:e.id,saved:!0})))})}));const u={...n,layers:s};0===d.length&&(u.rotation=n.preMergeRotation||n.rotation,delete u.preMergeRotation),a[t]=u,n.saved||(delete a[t],i={type:"UPDATE_GROUP",updates:r,groupId:t,undoable:!1});return(!n.saved||l.length>0||d.length>0||c.length>0||s.length!==n.layers.length)&&(n.saved?py("groups",t,u,e.groups[t],"onDeselectLayerGroup"):gy("groups",t,e.groups[t],"onDeselectLayerGroup")),{groups:a,undo:i}};function sb(e,t){const a=e.scenes[0];if(!a)return;const o=Xw(a.layers,t.layer.id);!function(e,t,a,o,n){ly({p:[`layer_${a.id}`],od:a},{srcFn:n}),ly({p:[`layer_${t.id}`],oi:t},{srcFn:n}),ly({p:[`scene_${e.id}_layers`,o],li:t.id,ld:a.id},{srcFn:n})}(a,{...t.layer,...t.properties},t.layer,o,"replaceLayer")}const lb=(e,t)=>{var a,o;switch(e.type){case"REMOVE_GOOGLE_DRIVE_PENDING_UPLOAD":{let o=-1;for(let r=0;r<t.pendingGoogleDriveUploads.length;r+=1){if((null==(a=t.pendingGoogleDriveUploads[r])?void 0:a.filename)===e.filename){o=r;break}}if(-1===o)return t;const n=[...t.pendingGoogleDriveUploads];return n.splice(o,1),{...t,pendingGoogleDriveUploads:n}}case"UPDATE_GOOGLE_DRIVE_PENDING_UPLOAD":{const a=[...t.pendingGoogleDriveUploads];for(let n=0;n<t.pendingGoogleDriveUploads.length;n+=1){if((null==(o=t.pendingGoogleDriveUploads[n])?void 0:o.filename)===e.filename){a[n]={filename:e.filename,progress:e.progress};break}}return{...t,pendingGoogleDriveUploads:a}}case"ADD_GOOGLE_DRIVE_PENDING_UPLOAD":return{...t,pendingGoogleDriveUploads:[...t.pendingGoogleDriveUploads,{filename:e.filename,progress:e.progress}]};default:return t}},db={style:{...Ju},position:{heightPct:0,widthPct:80,xPct:10,yPct:80,rotation:0}},cb=e=>P(e)?R(e):e;function ub(e,t){e.magicSubtitleFramesByAsset&&0!==Object.keys(e.magicSubtitleFramesByAsset).length||(uy({path:["magicSubtitleFramesByAsset"],val:cb(e.magicSubtitleFramesByAsset),oldVal:void 0,srcFn:"initializeMagicSubtitleFrames"}),e.magicSubtitleFramesByAsset={});const a=e.magicSubtitleFramesByAsset[t];if(!a||0===Object.keys(a).length){const o={byId:{}};uy({path:["magicSubtitleFramesByAsset",t],val:o,oldVal:cb(a),srcFn:"initializeMagicSubtitleFrames"}),e.magicSubtitleFramesByAsset[t]=o}return e.magicSubtitleFramesByAsset[t]}const mb=["enabled","languageKey","translated","translatedLanguageCode","transcriptionSource"],pb=(e,t)=>{var a,o,n;switch(t.type){case"ADD_MAGIC_SUBTITLE":return N(e,(e=>{e.magicSubtitles&&0!==Object.keys(e.magicSubtitles).length||(e.magicSubtitles={},my("magicSubtitles",{},void 0,"ADD_MAGIC_SUBTITLE"));const a=s.exports.omit(t.initialProperties,mb),o=s.exports.pick(t.initialProperties,mb),n=e.magicSubtitles[t.assetId],r=n?{...n,...o,enabled:!0}:{...db,...o,enabled:!0};e.magicSubtitles[t.assetId]=r,hy("magicSubtitles",t.assetId,r,n,"ADD_MAGIC_SUBTITLE");const i=e.magicSubtitlesGlobal;i&&0!==Object.keys(i).length||(e.magicSubtitlesGlobal=a,uy({path:["magicSubtitlesGlobal"],val:e.magicSubtitlesGlobal,oldVal:i,srcFn:"ADD_MAGIC_SUBTITLE"})),t.undoable&&Jl.add({undo:{...t,type:"REMOVE_MAGIC_SUBTITLE",undoable:!1},redo:{...t,undoable:!1}})}));case"REMOVE_MAGIC_SUBTITLE":return N(e,(e=>{if(!e.magicSubtitles)return;const a=e.magicSubtitles[t.assetId];if(!a)return;const o=cb(a);delete e.magicSubtitles[t.assetId],uy({path:["magicSubtitles",t.assetId],val:void 0,oldVal:o,srcFn:"REMOVE_MAGIC_SUBTITLE"}),t.undoable&&Jl.add({undo:{...t,type:"ADD_MAGIC_SUBTITLE",undoable:!1,initialProperties:o},redo:{...t,undoable:!1}})}));case"UPDATE_MAGIC_SUBTITLE":return N(e,(e=>{e.magicSubtitles||(e.magicSubtitles={},uy({path:["magicSubtitles"],val:{},oldVal:void 0,srcFn:"UPDATE_MAGIC_SUBTITLE"}));const a=s.exports.omit(t.updates,mb),o=s.exports.pick(t.updates,mb),n=s.exports.cloneDeep(e.magicSubtitlesGlobal);e.magicSubtitlesGlobal={...e.magicSubtitlesGlobal,...a},uy({path:["magicSubtitlesGlobal"],val:e.magicSubtitlesGlobal,oldVal:n,srcFn:"UPDATE_MAGIC_SUBTITLE"});let r={...n};if(t.assetId&&Object.keys(o).length>0){const a=s.exports.cloneDeep(e.magicSubtitles[t.assetId]);e.magicSubtitles[t.assetId]={...e.magicSubtitles[t.assetId],...o},uy({path:["magicSubtitles",t.assetId],val:e.magicSubtitles[t.assetId],oldVal:a,srcFn:"UPDATE_MAGIC_SUBTITLE"}),r={...r,...a}}t.undoable&&(Object.keys(t.updates).forEach((e=>{e in r||(r[e]=void 0)})),Jl.add({undo:{...t,undoable:!1,updates:r},redo:{...t,undoable:!1}}))}));case"SET_MAGIC_SUBTITLE_FRAMES":return N(e,(e=>{if(null===t.frames){if(!e.magicSubtitleFramesByAsset)return;const a=e.magicSubtitleFramesByAsset[t.assetId];if(!a)return;delete e.magicSubtitleFramesByAsset[t.assetId];const o=cb(a);if(uy({path:["magicSubtitleFramesByAsset",t.assetId],val:void 0,oldVal:o,srcFn:"SET_MAGIC_SUBTITLE_FRAMES"}),t.undoable){const e={...t,frames:o.byId,undoable:!1},a={...t,undoable:!1};Jl.add({undo:e,redo:a})}return}const a=ub(e,t.assetId),o=cb(a.byId);if(a.byId={},uy({path:["magicSubtitleFramesByAsset",t.assetId,"byId"],val:{},oldVal:o,srcFn:"SET_MAGIC_SUBTITLE_FRAMES"}),a.byId=t.frames,uy({path:["magicSubtitleFramesByAsset",t.assetId,"byId"],val:t.frames,oldVal:cb(a.byId),srcFn:"SET_MAGIC_SUBTITLE_FRAMES"}),t.undoable){const e={...t,frames:o,undoable:!1},a={...t,undoable:!1};Jl.add({undo:e,redo:a})}}));case"INSERT_MAGIC_SUBTITLE_FRAME":{const{assetId:n,frame:r,undoable:i}=t,s={type:"REMOVE_MAGIC_SUBTITLE_FRAME",assetId:n,frameId:r.id,undoable:!1},l={...t,undoable:!1};i&&Jl.add({undo:s,redo:l});if(((null==(o=null==(a=e.magicSubtitleFramesByAsset)?void 0:a[n])?void 0:o.byId)||{})[r.id])throw Error(`Frame with id ${r.id} already exists in asset ${n}`);return N(e,(e=>{ub(e,n).byId[r.id]=r,uy({path:["magicSubtitleFramesByAsset",t.assetId,"byId",r.id],val:r,oldVal:void 0,srcFn:t.type})}))}case"REMOVE_MAGIC_SUBTITLE_FRAME":return N(e,(e=>{const{assetId:a,frameId:o,undoable:n}=t,r=ub(e,a),i=cb(r.byId[o]);if(!i)throw Error(`Could not find frame ${o}`);const s={type:"INSERT_MAGIC_SUBTITLE_FRAME",assetId:a,frame:i,undoable:!1},l={...t,undoable:!1};n&&Jl.add({undo:s,redo:l}),delete r.byId[o],function({path:e,oldVal:t,srcFn:a,skipLastUpdated:o}){ly({p:e,od:t},{srcFn:a,skipLastUpdated:o})}({path:["magicSubtitleFramesByAsset",t.assetId,"byId",o],oldVal:i,srcFn:t.type})}));case"UPDATE_MAGIC_SUBTITLE_FRAME":return N(e,(e=>{const{assetId:a,frameId:o,undoable:n,update:r}=t,i=ub(e,a),l=cb(i.byId[o]);if(!l)throw Error(`Missing frame ${o}`);const d={type:"UPDATE_MAGIC_SUBTITLE_FRAME",assetId:a,frameId:o,update:s.exports.pick(l,Object.keys(r)),undoable:!1},c={...t,undoable:!1};n&&Jl.add({undo:d,redo:c}),i.byId[o]={...l,...r},uy({path:["magicSubtitleFramesByAsset",t.assetId,"byId",o],val:cb(i.byId[o]),oldVal:l,srcFn:t.type})}));case"UPDATE_MAGIC_SUBTITLE_FRAMES":return N(e,(e=>{const{undoable:a,updates:o}=t,n=[];for(const{assetId:l,frameId:d,update:c}of o){const a=ub(e,l),o=cb(a.byId[d]);if(!o)throw Error(`Missing frame ndx ${d}`);const r=s.exports.pick(o,Object.keys(c));n.push({assetId:l,frameId:d,update:r}),a.byId[d]={...o,...c},uy({path:["magicSubtitleFramesByAsset",l,"byId",d],val:cb(a.byId[d]),oldVal:o,srcFn:t.type})}const r={type:"UPDATE_MAGIC_SUBTITLE_FRAMES",updates:n,undoable:!1},i={...t,undoable:!1};a&&Jl.add({undo:r,redo:i})}));case"INSERT_MAGIC_SUBTITLE_FRAME_WORD":{const{assetId:a,frameId:o,wordNdx:n,undoable:r,word:i}=t,s={type:"REMOVE_MAGIC_SUBTITLE_FRAME_WORD",assetId:a,frameId:o,wordNdx:n,undoable:!1},l={...t,undoable:!1};return r&&Jl.add({undo:s,redo:l}),N(e,(e=>{const a=ub(e,t.assetId).byId[o];if(!a)throw Error(`Missing frame ${o}`);a.words.splice(n,0,i),function({path:e,val:t,srcFn:a,skipLastUpdated:o}){ly({p:e,li:t},{srcFn:a,skipLastUpdated:o})}({path:["magicSubtitleFramesByAsset",t.assetId,"byId",t.frameId,"words",n],val:i,srcFn:t.type})}))}case"REMOVE_MAGIC_SUBTITLE_FRAME_WORD":return N(e,(e=>{const{assetId:a,frameId:o,wordNdx:n,undoable:r}=t,i=ub(e,a).byId[o];if(!i)throw Error(`Missing frame ${o}`);const s=cb(i.words[n]);if(!s)return;const l={type:"INSERT_MAGIC_SUBTITLE_FRAME_WORD",assetId:a,frameId:o,wordNdx:n,word:s,undoable:!1},d={...t,undoable:!1};r&&Jl.add({undo:l,redo:d}),i.words.splice(n,1),function({path:e,oldVal:t,srcFn:a,skipLastUpdated:o}){ly({p:e,ld:t},{srcFn:a,skipLastUpdated:o})}({path:["magicSubtitleFramesByAsset",t.assetId,"byId",t.frameId,"words",n],oldVal:s,srcFn:t.type})}));case"UPDATE_MAGIC_SUBTITLE_FRAME_WORD":{const a=null==(n=e.magicSubtitleFramesByAsset)?void 0:n[t.assetId];if(!a)throw Error(`Missing frames when trying to update words for asset ${t.assetId}`);const{assetId:o,frameId:r,wordNdx:i,undoable:l,undoBeforeWord:d={},update:c}=t,u=a.byId[r];if(!u)throw Error(`Missing frame ${r}`);const m=u.words[i];if(!m)throw Error(`Missing frame ${r} word ${i}`);const p={...m,...d},h=s.exports.pick(p,Object.keys(c)),g={type:"UPDATE_MAGIC_SUBTITLE_FRAME_WORD",assetId:o,frameId:r,wordNdx:i,update:h,shouldSync:!0,undoable:!1},y={...t,shouldSync:!0,undoable:!1};l&&Jl.add({undo:g,redo:y});const f={...m,...c};return t.shouldSync&&function({path:e,val:t,oldVal:a,srcFn:o,skipLastUpdated:n,extra:r}){ly({p:e,li:t,ld:a},{srcFn:o,skipLastUpdated:n,...r})}({path:["magicSubtitleFramesByAsset",t.assetId,"byId",t.frameId,"words",i],val:f,oldVal:p,srcFn:t.type,extra:{undoable:l,undoBeforeWord:d,update:c}}),{...e,magicSubtitleFramesByAsset:{...e.magicSubtitleFramesByAsset,[t.assetId]:{...a,byId:{...a.byId,[r]:{...u,words:u.words.map(((e,t)=>t===i?f:e))}}}}}}default:return e}},hb=e=>e?Math.floor(1e3*e)/1e3:e,gb=(e,t)=>{if(t<1){const a=1/t;return Math.round(e*a)/a}return Math.round(e/t)*t},yb=e=>{let t=0,a="",o=!1;const{isImageVideo:n}=e,{layers:r}=e;for(const s of r){const e=!(vd(s)||_d(s)||Td(s));if(!s.isTrimmed&&e)continue;if("subtitle"!==s.type&&s.isTrimmed&&(o=!0),e){const e=Number(s.endTime||0);e>t&&(t=e,a=s.id);continue}if(_d(s)&&!s.converted_gif&&(o=!0),_d(s)&&s.converted_gif)continue;const n=Sd(s)?s.startTime:Number(s.videoDelay||0);let r=Ld(s);r+=n,r>t&&(t=r,a=s.id)}const i=e.userSelectedDuration||0;return t||(t=0),0===t&&n&&(t=e.duration||i||5),o||(t=Math.max(t,i)),t=hb(t),{duration:t,maxLayerId:a}},fb=(e,t,a)=>Math.min(Math.max(parseFloat(e),t),a);function Eb(e){if(!function(e){return"text"===e.type}(e))return{padding:0,doublePadding:0};let t=(e.lineHeight||1)*e.fontSize;"wrap"!==e.wrapOrFill&&(t=Math.min(e.position.pixel_height,e.position.pixel_width));const a=(e.textPadding||0)*t/100;return{padding:a,doublePadding:2*a}}const vb=function(e){const{layer:t,ctx:a,frameBezValue:o}=e;let{padding:n}=Eb(t);n*=2;const r=2*n;a.beginPath(),a.rect(-n,-n,(t.position.pixel_width+r)*o,t.position.pixel_height+r),a.clip()},wb=function(e){const{ctx:t,frameBezValue:a,invertedFrameBezValue:o}=e;t.globalAlpha=0,t.globalAlpha=a,t.filter=`blur(${String(12*o)}px)`},bb=function(e){const{ctx:t,frameBezValue:a}=e;t.globalAlpha=a},_b=function(e){const{ctx:t}=e;t.globalAlpha=0},Tb=[.42,0,.58,1],Sb=L(...Tb),Ib=[.25,.46,.45,.94],xb=L(...Ib),kb=[.22,.19,.54,1.62],Cb=L(...kb),Ab={none:{bezArray:[],animationFunction:()=>{},duration:0},drop:{bezArray:[.175,.885,.32,1.275],animationFunction:function(e){const{layer:t,ctx:a,frameBezValue:o,frameBezValueMinusOne:n}=e,{padding:r,doublePadding:i}=Eb(t),s=(t.position.pixel_height+i)*(t.position.float_y-r)/100;a.translate(0,-s*n),a.scale(1,o)},duration:.5},"flicker-in-glow":{bezArray:[],animationFunction:function(e){const{ctx:t,framePercent:a}=e;let o;o=a>0&&a<.1?0:a>=.1&&a<.101||a>=.101&&a<.102?1:a>=.102&&a<.2?0:a>=.2&&a<.201?1:a>=.201&&a<.206?0:a>=.206&&a<.3||a>=.3&&a<.301?1:a>=.301&&a<.305?0:a>=.305&&a<.306||a>=.306&&a<.45?1:a>=.45&&a<.451?0:a>=.451&&a<.5?1:a>=.5&&a<.55?0:a>=.55&&a<.551||a>=.551&&a<.57?1:a>=.57&&a<.571?0:a>=.571&&a<.6||a>=.6&&a<.601?1:a>=.601&&a<.65||a>=.65&&a<.651?0:a>=.651&&a<.75||a>=.75&&a<.751?1:a>=.751&&a<.77?0:a>=.77&&a<.771||a>=.771&&a<.85?1:a>=.85&&a<.851?0:a>=.851&&a<.86?1:a>=.86&&a<.861?0:1,t.globalAlpha=o},duration:2},"focus-in":{bezArray:[.55,.085,.68,.53],animationFunction:function(e){const{layer:t,ctx:a,frameBezValue:o,invertedFrameBezValue:n}=e,r="number"==typeof t.globalAlpha?t.globalAlpha:1;a.globalAlpha=o*r;const i=`blur(${12*n}px)`;"none"===a.filter?a.filter=i:a.filter=`${a.filter}  ${i}`},duration:.5},"hue-rotate":{bezArray:[.25,.25,.75,.75],animationFunction:function(e){const{ctx:t,repeatingFramePercent:a}=e,o=`hue-rotate(${-360-360*a}deg)`;"none"===t.filter?t.filter=o:t.filter=`${t.filter}  ${o}`},duration:1},"pop-in-bounce":{bezArray:[.09,.54,.38,2.47],animationFunction:function(e){const{layer:t,ctx:a,frameBezValue:o,frameBezValueMinusOne:n}=e,r=t.position.pixel_width*(t.position.float_x+t.position.float_width/2)/100||0,i=t.position.pixel_height*(t.position.float_y+t.position.float_height/2)/100||0;a.translate(-r*n,-i*n),a.scale(o,o)},duration:.5},reveal:{bezArray:[.25,.1,.25,1],animationFunction:vb,duration:1},"slide-up":{bezArray:[.55,.085,.68,.53],animationFunction:function(e){const{frameBezValue:t,invertedFrameBezValue:a,ctx:o}=e;o.translate(0,20*a),o.globalAlpha=t},duration:.5},vibrate:{bezArray:[],animationFunction:function(e){const{ctx:t,fontSize:a,repeatingFramePercent:o}=e,n=.03*a,r=.2;let i=0,s=0;o>0&&o<=r?(i=-n*o/r,s=n*o/r):o>.2&&o<=.4?(i=-n,s=n-2*n*(o%r/r)):o>.4&&o<=.6?(s=2*n*(o%r/r)-n,i=2*n*(o%r/r)-n):o>.6&&o<.8?(s=n+n*(o%r/r),i=n):o>=.8&&o<1&&(s=2*n-2*n*(o%r/r),i=n-n*(o%r/r)),t.translate(i,s)},duration:.3},"wipe-rectangle":{bezArray:[.25,.1,.25,1],animationFunction:function(e){vb(e)},duration:1},"blur-in":{bezArray:[.24,.085,.72,.93],animationFunction:wb,duration:.5},"blur-out":{bezArray:[.24,.085,.72,.93],animationFunction:wb,duration:.5},"fade-in":{bezArray:[.24,.9,.72,.93],animationFunction:bb,duration:.5},"fade-out":{bezArray:[.24,.9,.72,.93],animationFunction:bb,duration:.5},"hide-in":{bezArray:[],animationFunction:_b,duration:.5},"hide-out":{bezArray:[],animationFunction:_b,duration:.5},"magic-fade":{bezArray:Tb,animationFunction:function(e){const{frameTime:t,layer:a,ctx:o,animation:n}=e,{transitionDuration:r=0}=n,{startTime:i,endTime:s}=a;if(!i||!s)return;const l=t-i<s-t;let d,c,u;if(l?(d=i,c=d+r):(c=s,d=c-r),u=(t-d)/r,u=fb(u,0,1),l||(u=1-u),1===u)return;const m=Sb(u),p=20-20*m;o.filter=`blur(${p}px)`,o.globalAlpha=m},duration:2},"magic-flip":{bezArray:Ib,animationFunction:function(e){const{frameTime:t,layer:a,ctx:o,animation:n}=e,{transitionDuration:r=0}=n,{startTime:i,endTime:s}=a;if(!i||!s)return;const l=t-i<s-t;let d,c,u;if(l?(d=i,c=d+r):(c=s,d=c-r),u=(t-d)/r,u=fb(u,0,1),l||(u=1-u),1===u)return;const m=a.position.pixel_height*(a.position.float_y+a.position.float_height/2)/100||0,p=xb(u),h=p-1;o.translate(0,-m*h),o.scale(1,p)},duration:2},"magic-pop":{bezArray:kb,animationFunction:function(e){const{frameTime:t,layer:a,ctx:o,animation:n}=e,{transitionDuration:r=0}=n,{startTime:i,endTime:s}=a;if(!i||!s)return;if(!(t-i<s-t))return;let l=(t-i)/r;if(l=fb(l,0,1),1===l)return;const d=a.position.pixel_width*(a.position.float_x+a.position.float_width/2)/100||0,c=a.position.pixel_height*(a.position.float_y+a.position.float_height/2)/100||0,u=.7+(1-.7)*Cb(l),m=u-1;o.translate(-d*m,-c*m),o.scale(u,u)},duration:2}},Nb={"cross-dissolve":{intro:"fade-in",outro:"fade-out"},"cross-blur":{intro:"blur-in",outro:"blur-out"},...Object.assign({},...D.map((({name:e})=>({[e]:{intro:"hide-in",outro:"hide-out"}}))))},Pb={"fade-in":dn.FocusIn,"text-focus-in":dn.FocusIn,"text-flicker-in-glow":dn.FlickerInGlow,"linear-wipe":dn.Reveal,"swing-in-top-fwd":dn.Drop},Rb=async function({animation:e,layer:t,ctx:a,frameTime:o,fontSize:n=50,studioAnimations:r=null}){if(!e||!t||!e.id)return null;let{start:i,end:s}=Rd(t,5);i=parseFloat(i.toFixed(2)),s=parseFloat(s.toFixed(2));const l=Mb(e,r);let d=Math.max(0,Math.min((o-i)/l,1)),c=Math.max(0,(o-i)/l%1);if("outro"===e.type){const e=o-(s-l);e<0?(d=0,c=0):(d=Math.min(e/l,1),c=e/l%1)}const u={animation:e,layer:t,ctx:a,id:e.id,fontSize:n,frameTime:o,framePercent:d,repeatingFramePercent:c,frameBezValue:0,invertedFrameBezValue:1,frameBezValueMinusOne:1},m=Pb[u.id];!e.transitionId&&m&&(u.id=m),Nb[u.id]&&(u.id=Nb[u.id][e.type]);const{bezArray:p=[],animationFunction:h=(()=>{})}=Ab[u.id]||{},g=((e,t,a,o)=>{let n=t;return"outro"===e.type&&(n=o<=a?1-t:1),n})(e,d,l,s-o);if(4===p.length){const e=L(p[0],p[1],p[2],p[3]);u.frameBezValue=e(g),u.frameBezValueMinusOne=u.frameBezValue-1,u.invertedFrameBezValue=Math.max(0,1-u.frameBezValue)}return u.animationFunction=h,u},Lb=(e,t)=>{if(!e.animation)return!1;if(e.animation.id&&"none"!==e.animation.id)return!0;return Ob(e,t).length>0||void 0},Db=(e,t)=>{const a=Ob(e,t).find((({keyframeChannels:e})=>!!e));return(null==a?void 0:a.keyframeChannels)||{}},Ob=(e,t)=>{if(!e.animation)return[];if(e.animation&&e.animation.id)return"none"===e.animation.id?[]:[e.animation];const a=[];for(const o of["intro","outro","constant"]){(e.animation[o]||[]).forEach((e=>{var n;const r="string"==typeof e?null==(n=null==t?void 0:t.byId)?void 0:n[e]:null;r?a.push({...r,type:o,id:r.animationName}):"none"!==e.id&&a.push(e)}))}return a},Fb=async(e,t,a,o,n)=>{if(!t.animation)return;if(t.animation.id)return void(async(e,t,a,o)=>{const{animation:n}=e,r=await Rb({animation:n,layer:e,ctx:t,frameTime:a,fontSize:o});r&&r.animationFunction&&r.animationFunction(r)})(t,a,o,n);const r=Ob(t,e),i=r.find((e=>"intro"===e.type)),s=r.find((e=>"outro"===e.type)),l=r.find((e=>"constant"===e.type)),{start:d,end:c}=Rd(t,5),u=o-d,m={start:0,end:i?Mb(i,e):0},p={start:s?c-Mb(s,e)-d:0,end:s?c-d:0};if(l){const r=l,i=await Rb({animation:r,layer:t,ctx:a,frameTime:o,fontSize:n,studioAnimations:e});if(!i||!i.animationFunction)return;i.animationFunction(i)}if(i&&u>=m.start&&u<m.end){const r=i,s=await Rb({animation:r,layer:t,ctx:a,frameTime:o,fontSize:n,studioAnimations:e});if(!s||!s.animationFunction)return;s.animationFunction(s)}else if(s&&u>=p.start&&u<=p.end){const r=s,i=await Rb({animation:r,layer:t,ctx:a,frameTime:o,fontSize:n,studioAnimations:e});if(!i||!i.animationFunction)return;i.animationFunction(i)}else o>c?i?a.globalAlpha=1:s&&(a.globalAlpha=0):o<d&&(i?a.globalAlpha=0:s&&(a.globalAlpha=1))},Mb=(e,t)=>{var a;let o,n;if("string"==typeof e){const r=null==(a=null==t?void 0:t.byId)?void 0:a[e];if(r){if(void 0!==r.transitionDuration)return r.transitionDuration;const e=Ab[r.animationName];e&&(o=e.duration,n=r.speed)}}else{if(void 0!==e.transitionDuration)return e.transitionDuration;o=e.animationName?(Ab[e.animationName]||{}).duration:e.duration,n=e.speed}switch(null==o&&(o=.5),n){case"slow":o*=2;break;case"fast":o*=.5}return o},Ub=(e,t,a)=>{var o,n;const r={prevFrame:null,nextFrame:null,isAnimating:!1};if(!a.length)return r;const i=null!=(n=null!=(o=e.videoDelay)?o:e.startTime)?n:0,s=a[0],l=a[a.length-1];if(!l||!s)throw Error();if(t>=l.time+i)r.prevFrame=l||null;else if(t<s.time+i)r.nextFrame=s||null,r.isAnimating=!0;else{r.isAnimating=!0;for(let e=0;e<a.length;e++){const o=a[e];if(!o)throw Error();if(!(t>=o.time+i))break;r.prevFrame=o||null,r.nextFrame=a[e+1]||null}}return r},Bb=(e,t,a,o)=>{if(!e)return a.value;const n=a.value,r=o.value,i=L(...e),s=a.time;return n+(r-n)*i((t-s)/(o.time-s))},Wb=(e,t,a,o)=>{if(!e)return a.value;const n=a.value,r=o.value,i=L(...e),s=O([n,r]),l=a.time;return s(i((t-l)/(o.time-l)))},Vb=(e,t,a,o)=>{if(!e)return a.value;const n=L(...e),r=a.value,i=o.value,s=a.time,l=o.time-s,d=t-s,c=Math.max(r,i)-Math.min(r,i),u=360-c,m=Math.min(c,u),p=Math.sign(i-r)*Math.sign(u-c);let h=r+n(d/l)*m*p;return h<0?h+=360:h>360&&(h-=360),h},jb={position:(e,t,a,o)=>{if(!e)return a.value;const n=L(...e),r=a.value,i=o.value,s=o.time-a.time,l=n((t-a.time)/s),d=(parseFloat(i.x)-parseFloat(r.x))*l,c=(parseFloat(i.y)-parseFloat(r.y))*l;return{x:`${parseFloat(r.x)+d}%`,y:`${parseFloat(r.y)+c}%`}},zoom:Bb,opacity:Bb,brightness:Bb,contrast:Bb,saturate:Bb,blurPercent:Bb,background:Wb,rotation:Vb},Gb=(e,t,a,o,n)=>{if(!t)return o.value;return(jb[e]||((e,t,a,o)=>{var n;return null!=(n=a.value)?n:o.value}))(t,a,o,n)},Hb={bezArray:null,keyframes:[]},zb=(e,t,a,o,n)=>{var r,i,s,l,d,c,u,m;let p=(null==(r=e.position)?void 0:r.adjusted_x)||0,h=(null==(i=e.position)?void 0:i.adjusted_y)||0,g=(null==(s=e.position)?void 0:s.pixel_width)||0,y=(null==(l=e.position)?void 0:l.pixel_height)||0;const f=t=>{var a,r;let i=p,s=h;const l=parseFloat((null==(a=e.position)?void 0:a.x)||"0"),d=parseFloat((null==(r=e.position)?void 0:r.y)||"0");return p&&h&&l&&d?(i=p*parseFloat(t.x)/l,s=h*parseFloat(t.y)/d):(i=parseInt(t.x)/100*o,s=parseInt(t.y)/100*n),{x:i,y:s}},E=Db(e,t.animations),v=E.position||Hb,w=E.zoom||Hb,b=!!v.keyframes.length,_=!!w.keyframes.length,T=(b||_)&&!e.preProcessed&&!(e=>e.isCanvasBlurLayer||!!e.originalLayerId)(e);if(T){const t=null!=(c=null!=(d=e.videoDelay)?d:e.startTime)?c:0,{keyframes:o}=v,{prevFrame:n,nextFrame:r}=Ub(e,a,o);let i={x:p,y:h};if(r&&n){const e=n.value,o=r.value,s=f(e),l=f(o);let d=0,c=0;if(v.bezArray){const e=L(...v.bezArray),o=null!=(u=n.time)?u:0,i=e((a-t-o)/((null!=(m=r.time)?m:0)-o)),p=l.x-s.x,h=l.y-s.y;d=p*i,c=h*i}i={x:s.x+d,y:s.y+c}}else n?i=f(n.value):r&&(i=f(r.value));if(_){b||(i.x+=g/2,i.y+=y/2);const{bezArray:o,keyframes:n}=w,{prevFrame:r,nextFrame:s}=Ub(e,a,n),l=e.zoom||100;let d=l;d=r&&s?Bb(o,a-t,r,s):(null==r?void 0:r.value)||(null==s?void 0:s.value)||(null==e?void 0:e.zoom)||100;const c=d/l;g*=c,y*=c}"ellipse"!==e.shapeType&&(i.x-=g/2,i.y-=y/2),p=i.x,h=i.y,e.position&&(e.position.adjusted_x=p,e.position.adjusted_y=h,e.position.pixel_width=g,e.position.pixel_height=y)}return{xPos:p,yPos:h,width:g,height:y}},$b=(e,t,a)=>{var o,n,r,i,s,l;const d=e.background||"#000000";if(!t)return d;const c=(null==(o=t.background)?void 0:o.keyframes)||[],u=(null==(n=t.background)?void 0:n.bezArray)||null;if(!c.length)return d;const m=null!=(i=null!=(r=e.videoDelay)?r:e.startTime)?i:0,{prevFrame:p,nextFrame:h}=Ub(e,a,c);let g=d;return g=p&&h?Wb(u,a-m,p,h):null!=(l=null!=(s=null==p?void 0:p.value)?s:null==h?void 0:h.value)?l:d,g},Kb=(e,t,a)=>{const o={...e.filters};return t?("opacity"in t&&(o.opacity=((e,t,a)=>{var o,n,r,i,s,l,d,c;const u=null!=(n=null==(o=e.filters)?void 0:o.opacity)?n:100;if(!t)return u;const m=(null==(r=t.opacity)?void 0:r.keyframes)||[],p=(null==(i=t.opacity)?void 0:i.bezArray)||null;if(!m.length)return u;const h=null!=(l=null!=(s=e.videoDelay)?s:e.startTime)?l:0,{prevFrame:g,nextFrame:y}=Ub(e,a,m);let f=u;return f=g&&y?Bb(p,a-h,g,y):null!=(c=null!=(d=null==g?void 0:g.value)?d:null==y?void 0:y.value)?c:u,f})(e,t,a)),"brightness"in t&&(o.brightness=((e,t,a)=>{var o,n,r,i,s,l,d,c;const u=null!=(n=null==(o=e.filters)?void 0:o.brightness)?n:100;if(!t)return u;const m=(null==(r=t.brightness)?void 0:r.keyframes)||[],p=(null==(i=t.brightness)?void 0:i.bezArray)||null;if(!m.length)return u;const h=null!=(l=null!=(s=e.videoDelay)?s:e.startTime)?l:0,{prevFrame:g,nextFrame:y}=Ub(e,a,m);let f=u;return f=g&&y?Bb(p,a-h,g,y):null!=(c=null!=(d=null==g?void 0:g.value)?d:null==y?void 0:y.value)?c:u,f})(e,t,a)),"contrast"in t&&(o.contrast=((e,t,a)=>{var o,n,r,i,s,l,d,c;const u=null!=(n=null==(o=e.filters)?void 0:o.contrast)?n:100;if(!t)return u;const m=(null==(r=t.contrast)?void 0:r.keyframes)||[],p=(null==(i=t.contrast)?void 0:i.bezArray)||null;if(!m.length)return u;const h=null!=(l=null!=(s=e.videoDelay)?s:e.startTime)?l:0,{prevFrame:g,nextFrame:y}=Ub(e,a,m);let f=u;return f=g&&y?Bb(p,a-h,g,y):null!=(c=null!=(d=null==g?void 0:g.value)?d:null==y?void 0:y.value)?c:u,f})(e,t,a)),"saturate"in t&&(o.saturate=((e,t,a)=>{var o,n,r,i,s,l,d,c;const u=null!=(n=null==(o=e.filters)?void 0:o.saturate)?n:100;if(!t)return u;const m=(null==(r=t.saturate)?void 0:r.keyframes)||[],p=(null==(i=t.saturate)?void 0:i.bezArray)||null;if(!m.length)return u;const h=null!=(l=null!=(s=e.videoDelay)?s:e.startTime)?l:0,{prevFrame:g,nextFrame:y}=Ub(e,a,m);let f=u;return f=g&&y?Bb(p,a-h,g,y):null!=(c=null!=(d=null==g?void 0:g.value)?d:null==y?void 0:y.value)?c:u,f})(e,t,a)),"blurPercent"in t&&!(null==e?void 0:e.originalLayerId)&&(o.blurPercent=((e,t,a)=>{var o,n,r,i,s,l,d,c;const u=null!=(n=null==(o=e.filters)?void 0:o.blurPercent)?n:100;if(!t)return u;const m=(null==(r=t.blurPercent)?void 0:r.keyframes)||[],p=(null==(i=t.blurPercent)?void 0:i.bezArray)||null;if(!m.length)return u;const h=null!=(l=null!=(s=e.videoDelay)?s:e.startTime)?l:0,{prevFrame:g,nextFrame:y}=Ub(e,a,m);let f=u;return f=g&&y?Bb(p,a-h,g,y):null!=(c=null!=(d=null==g?void 0:g.value)?d:null==y?void 0:y.value)?c:u,f})(e,t,a)),o):o},Yb=new Set(["fade","BowTieVertical","BowTieWithParameter","CircleCrop","TopBottom","LeftRight","LinearBlur","ZoomLeftWipe","ZoomRigthWipe","angular","cannabisleaf","circle","coord-from-in","fadecolor","fadegrayscale","polar_function","squareswire"]),qb=[cn.CrossDissolve,"CrossZoom"],Xb=Object.assign({},...F.map((e=>({[e.name]:e})))),Jb={[cn.CrossDissolve]:{id:cn.CrossDissolve,name:"Cross Dissolve",introAnimId:dn.FadeIn,outroAnimId:dn.FadeOut,isCrossTransition:!0,gltransition:!1},[cn.CrossBlur]:{id:cn.CrossBlur,name:"Cross Blur",introAnimId:dn.BlurIn,outroAnimId:dn.BlurOut,isCrossTransition:!0,gltransition:!1},...Object.assign({},...F.filter((({name:e})=>!Yb.has(e))).map((({name:e,displayName:t})=>({[e]:{id:e,name:t,introAnimId:dn.HideIn,outroAnimId:dn.HideOut,isCrossTransition:!0,gltransition:!0}}))))},Qb=e=>e in Jb,Zb=e=>!!a_(e),e_=[cn.CrossDissolve,...F.filter((({name:e})=>!Yb.has(e))).map((({name:e})=>e))].map((e=>({...Jb[e]}))).sort(((e,t)=>{const a=qb.indexOf(e.id)+1||qb.length+1,o=qb.indexOf(t.id)+1||qb.length+1;return a===o?e.name.toLowerCase().localeCompare(t.name.toLowerCase()):a>o?1:-1}));function t_(e){return{...Jb[e]}}function a_(e){return Xb[e]}const o_=["video","image"],n_=e=>{let t=U(`${e}`).hsl();const a=t.array()[1],o=t.array()[2];return a<25&&(t=t.saturationl(25)),o<25&&(t=t.lightness(25)),o>80&&(t=t.lightness(80)),t.hex()},r_=e=>[e.startTime||0,e.endTime||e.duration||tn().state.studio.duration],i_=M(...Ab["magic-fade"].bezArray),s_=M(...Ab["magic-flip"].bezArray),l_=M(...Ab["magic-pop"].bezArray),d_={[dn.None]:{id:dn.None,name:"None",duration:Ab.none.duration,speed:"default",type:"none",animationFunc:()=>({})},[dn.MagicFade]:{id:dn.MagicFade,name:"Fade",duration:Ab["magic-fade"].duration,speed:"default",type:"constant",animationFunc:(e,t)=>{const a=t,{transitionDuration:o=0,transitionOverlapDuration:n=0}=a.transition||{},[r,i]=r_(t),s=e-r<i-e;let l,d,c;if(s?(l=r-n,d=l+o):(d=i+n,l=d-o),c=(e-l)/o,c=Ci(c,0,1),s||(c=1-c),1===c)return{};const u=i_(c);return{WebkitFilter:`blur(${20-20*u}px)`,opacity:100*u+"%"}}},[dn.MagicFlip]:{id:dn.MagicFlip,name:"Flip",duration:Ab["magic-flip"].duration,speed:"default",type:"none",animationFunc:(e,t)=>{const a=t,{transitionDuration:o=0,transitionOverlapDuration:n=0}=a.transition||{},[r,i]=r_(t),s=e-r,l=i-e;if(Math.min(s,l)>o)return{};const d=s<l;let c,u,m;if(d?(c=r-n,u=c+o):(u=i+n,c=u-o),m=(e-c)/o,m=Ci(m,0,1),d||(m=1-m),1===m)return{};return{transform:`scale(1, ${s_(m)})`,transformOrigin:"center"}}},[dn.MagicPop]:{id:dn.MagicPop,name:"Pop",duration:Ab["magic-pop"].duration,speed:"default",type:"none",animationFunc:(e,t)=>{const a=t,{transitionDuration:o=0,transitionOverlapDuration:n=0}=a.transition||{},[r,i]=r_(t),s=e-r,l=i-e;if(Math.min(s,l)>o)return{};if(!(s<l))return{};let d=(e-(r-n))/o;if(d=Ci(d,0,1),1===d)return{};return{transform:`scale(${.7+(1-.7)*l_(d)})`,transformOrigin:"center"}}}},c_={...d_,[dn.Drop]:{id:dn.Drop,name:"Drop",duration:Ab.drop.duration,speed:"default",layerInvolvesMovement:!0,type:"intro",animationFunc:(e,t,a)=>{const o=M(.175,.885,.32,1.275)(e);return{...M_({layer:t,yPercent:50*-(1-o),transform:`${a} scaleY(${o})`})}}},[dn.FlickerInGlow]:{id:dn.FlickerInGlow,name:"Flicker",duration:Ab["flicker-in-glow"].duration,speed:"default",type:"intro",animationFunc:(e,t)=>{const a=Dd(t)||1;return e>=0&&e<.1?{opacity:0}:e>=.1&&e<.101||e>=.101&&e<.102?{opacity:a}:e>=.102&&e<.2?{opacity:0}:e>=.2&&e<.201?{opacity:a}:e>=.201&&e<.206?{opacity:0}:e>=.206&&e<.3||e>=.3&&e<.301?{opacity:a}:e>=.301&&e<.305?{opacity:0}:e>=.305&&e<.306||e>=.306&&e<.45?{opacity:a}:e>=.45&&e<.451?{opacity:0}:e>=.451&&e<.5?{opacity:a}:e>=.5&&e<.55?{opacity:0}:e>=.55&&e<.551||e>=.551&&e<.57?{opacity:a}:e>=.57&&e<.571?{opacity:0}:e>=.571&&e<.6||e>=.6&&e<.601?{opacity:a}:e>=.601&&e<.65||e>=.601&&e<.65?{opacity:0}:e>=.651&&e<.75||e>=.75&&e<.751?{opacity:a}:e>=.751&&e<.77?{opacity:0}:e>=.77&&e<.771||e>=.771&&e<.85?{opacity:a}:e>=.85&&e<.851?{opacity:0}:e>=.851&&e<.86?{opacity:a}:e>=.86&&e<.861?{opacity:0}:e>=.861&&e<=.1?{opacity:a}:{}}},[dn.FocusIn]:{id:dn.FocusIn,name:"Fade",duration:Ab["focus-in"].duration,speed:"default",type:"intro",animationFunc:(e,t)=>{const a=Dd(t)||1,o=M(.55,.085,.68,.53)(e),n=1*o;return{WebkitFilter:`blur(${12*(1-o)}px)`,opacity:n>a?a:n}}},[dn.HueRotate]:{id:dn.HueRotate,name:"Hue Rotate",duration:Ab["hue-rotate"].duration,speed:"default",animatesForever:!0,type:"constant",animationFunc:e=>({WebkitFilter:`hue-rotate(${-360*M(.25,.25,.75,.75)(e)}deg)`}),selectionFunc:e=>{switch(e.type){case ln.Text:return{color:`${n_(e.color)}`,textShadow:"transparent",originalColor:e.color};case ln.Shape:return{background:`${n_(e.background)}`,originalColor:e.background}}return{}}},[dn.Reveal]:{id:dn.Reveal,name:"Reveal",duration:Ab.reveal.duration,speed:"default",type:"intro",animationFunc:e=>{const t=100*(1-M(.22,1.03,.67,1)(e));return{WebkitClipPath:`inset( 0 ${t}% 0 0)`,clipPath:`inset( 0 ${t}% 0 0)`}}},[dn.PopInBounce]:{id:dn.PopInBounce,name:"Pop",duration:Ab["pop-in-bounce"].duration,speed:"default",type:"intro",animationFunc:e=>({transform:`scale(${M(.09,.54,.38,2.47)(e)})`,transformOrigin:"center"})},[dn.SlideUp]:{id:dn.SlideUp,name:"Slide",duration:Ab["slide-up"].duration,speed:"default",layerInvolvesMovement:!0,type:"intro",animationFunc:(e,t,a)=>{const o=Dd(t)||1,n=M(.55,.085,.68,.53)(e);return{...F_({yPixels:20*(1-n),layer:t,transform:a}),opacity:e*o}}},[dn.Vibrate]:{id:dn.Vibrate,name:"Vibrate",duration:Ab.vibrate.duration,speed:"default",animatesForever:!0,layerInvolvesMovement:!0,type:"constant",animationFunc:(e,t,a)=>{const o=e%1,n=.01*parseInt(String(t.fontSize||"50")),r=.2;let i=0,s=0;return o>0&&o<=r?(i=-n*o/r,s=n*o/r):o>r&&o<=.4?(i=-n,s=n-2*n*(o%r/r)):o>.4&&o<=.6000000000000001?(s=2*n*(o%r/r)-n,i=2*n*(o%r/r)-n):o>.6000000000000001&&o<.8?(s=n+n*(o%r/r),i=n):o>=.8&&o<1&&(s=2*n-2*n*(o%r/r),i=n-n*(o%r/r)),F_({layer:t,xPixels:i,yPixels:s,transform:a})}},[dn.WipeRectangle]:{id:dn.WipeRectangle,name:"Wipe",duration:Ab["wipe-rectangle"].duration,speed:"default",type:"intro",animationFunc:e=>{const t=100*(1-M(.25,.1,.25,1)(e));return{WebkitClipPath:`inset( 0 ${t}% 0 0)`,clipPath:`inset( 0 ${t}% 0 0)`}}},[dn.ProgressBar]:{id:dn.ProgressBar,name:"Progress Bar",duration:1,speed:"default",type:"constant",animationFunc:e=>{const t=100*(1-e);return{WebkitClipPath:`inset( 0 ${t}% 0 0)`,clipPath:`inset( 0 ${t}% 0 0)`}}},[dn.BlurIn]:{id:dn.BlurIn,name:"Blur in",duration:Ab["blur-in"].duration,speed:"default",type:"intro",animationFunc:e=>{const t=M(.24,.085,.72,.93)(e);return{WebkitFilter:`blur(${12*(1-t)}px)`,opacity:t}}},[dn.BlurOut]:{id:dn.BlurOut,name:"Blur Out",duration:Ab["blur-out"].duration,speed:"default",type:"outro",animationFunc:e=>{const t=M(.24,.085,.72,.93)(e);return{WebkitFilter:`blur(${12*t}px)`,opacity:t}}},[dn.FadeIn]:{id:dn.FadeIn,name:"Fade in",duration:Ab["fade-in"].duration,speed:"default",type:"intro",animationFunc:e=>({opacity:M(.24,.9,.72,.93)(e)})},[dn.FadeOut]:{id:dn.FadeOut,name:"Fade Out",duration:Ab["fade-out"].duration,speed:"default",type:"outro",animationFunc:e=>({opacity:M(.24,.9,.72,.93)(e)})},[dn.HideIn]:{id:dn.HideIn,name:"Hide In",duration:Ab["hide-in"].duration,speed:"default",type:"intro",animationFunc:()=>({display:"none"})},[dn.HideOut]:{id:dn.HideOut,name:"Hide Out",duration:Ab["hide-out"].duration,speed:"default",type:"outro",animationFunc:()=>({display:"none"})}};function u_(e){return{...e}}const m_=["id","name","animationFunc","duration","speed"];function p_(e){if(!e)return!1;if(!e.id)return!1;if(e.duration<=0)return!1;for(const t of m_)if(!e[t])return!1;return!e.layerInvolvesMovement||"boolean"==typeof e.layerInvolvesMovement}function h_(e){let t=c_[dn.None],a=e;return e?(!(e in c_)&&e in Pb&&(a=Pb[e]),t=c_[a],p_(t)?u_(t):u_(c_[dn.None])):u_(t)}function g_(e,t=tn().state.studio.animations){if(null==t?void 0:t.byId[e])return null==t?void 0:t.byId[e]}function y_(e,t){const a=e.intro||[],o=e.outro||[],n=e.constant||[],r=[],i=[],s=[];return a.forEach((e=>{const a=g_(e,t);a&&r.push(a)})),o.forEach((e=>{const a=g_(e,t);a&&i.push(a)})),n.forEach((e=>{const a=g_(e,t);a&&s.push(a)})),{intro:r,outro:i,constant:s}}function f_(e,t){let a,o=!0;if(Qb(e.animationName)){const{introAnimId:o,outroAnimId:n}=t_(e.animationName);a="intro"===t?o:n}else e.animationName===dn.None?a=dn.None:(o=!1,a=e.animationName);const n=a in c_?c_[a]:void 0;if(p_(n)){if(e.isCrossTransition){return{...n,transitionDuration:e.transitionDuration,transitionId:o?e.animationName:void 0,animationStateMapId:e.id,type:t,isCrossTransition:!0,introLayerId:e.introLayerId,outroLayerId:e.outroLayerId}}return{...n,transitionDuration:e.transitionDuration,isCrossTransition:e.isCrossTransition,animationStateMapId:e.id,type:t,layerId:e.layerId}}return null}function E_(e){const t=e.intro||[],a=e.outro||[],o=e.constant||[],n=[],r=[],i=[];t.forEach((e=>{const t=f_(e,"intro");t&&n.push(t)})),a.forEach((e=>{const t=f_(e,"outro");t&&r.push(t)})),o.forEach((e=>{const t=f_(e,"constant");t&&i.push(t)}));return{intro:n,outro:r,constant:i}}function v_(e){const t={intro:[],constant:[],outro:[]};if(!e.animation)return t;const a=E_(y_(e.animation));return a||t}function w_(e){var t,a;const o=c_[dn.None];if(!e.animation)return u_(o);if((null==(t=e.animation.constant)?void 0:t[0])===dn.ProgressBar)return u_(c_[dn.ProgressBar]);const n=E_(y_(e.animation));if(!n)return u_(o);let r=null;for(const s of Object.keys(n))if(n[s]&&(null==(a=n[s][0])?void 0:a.id)){const e=n[s][0];e&&(r=e)}if(!r||r.id===dn.None)return u_(c_[dn.None]);const i=h_(r.id);return i.transitionDuration=r.transitionDuration||.5,u_(i)}function b_(e){var t;const a=c_[dn.None];if(!e.animation)return[u_(a)];if((null==(t=e.animation.constant)?void 0:t[0])===dn.ProgressBar)return[u_(c_[dn.ProgressBar])];const o=E_(y_(e.animation));if(!o)return[u_(a)];let n=[];for(const r of Object.keys(o)){if(!r)return[u_(a)];o[r]&&(n=[...n,o[r][0]])}return n.map((e=>{if(!e)return u_(a);const t=h_(e.id);return t.type=e.type,t.transitionDuration=e.transitionDuration,u_(t)}))}function __(e,t,a){var o,n;if(!e.animation)return null;const r=E_(y_(e.animation,a));if(!r)return null;let i=null;if(null==(o=null==r?void 0:r[t])?void 0:o[0]){const e=null==(n=null==r?void 0:r[t])?void 0:n[0];e&&(i=e)}if(!i||i.id===dn.None)return null;return{...h_(i.id),...i}}function T_(e){if(!e.animation)return{introTransition:null,outroTransition:null};const t=E_(y_(e.animation));if(!t)return{introTransition:null,outroTransition:null};let a=null,o=null;for(const i of Object.keys(t)){const e=t[i][0];e&&e.isCrossTransition&&("intro"===i&&(a=e),"outro"===i&&(o=e))}if(!a&&!o)return{introTransition:null,outroTransition:null};let n=null,r=null;return a&&(n=u_({...h_(a.id),...a})),o&&(r=u_({...h_(o.id),...o})),{introTransition:n,outroTransition:r}}function S_(e){const t=D_.find((t=>t.id===e.introAnimId)),a=D_.find((t=>t.id===e.outroAnimId));if(!t||!a)throw Error(`Missing intro or outro animation for transition ${e.id}`);return{introAnimation:u_(t),outroAnimation:u_(a)}}const I_=e=>e.map((e=>({...c_[e]}))),x_=I_([dn.None,dn.Drop,dn.FlickerInGlow,dn.FocusIn,dn.Reveal,dn.PopInBounce,dn.SlideUp,dn.WipeRectangle]),k_=I_([dn.None,dn.Vibrate]),C_=I_([dn.None,dn.Drop,dn.FlickerInGlow,dn.FocusIn,dn.Reveal,dn.PopInBounce,dn.SlideUp]),A_=I_([dn.None,dn.HueRotate,dn.Vibrate]),N_=I_([dn.None,dn.FlickerInGlow,dn.FocusIn,dn.Reveal,dn.SlideUp]),P_=I_([dn.None,dn.HueRotate,dn.Vibrate]),R_=I_([dn.None,dn.HueRotate]),L_=I_([dn.None,dn.Drop,dn.FocusIn,dn.FlickerInGlow,dn.Reveal,dn.PopInBounce,dn.SlideUp]),D_=I_([dn.FadeIn,dn.FadeOut,dn.BlurIn,dn.BlurOut,dn.HideIn,dn.HideOut]),O_=I_([dn.FocusIn,dn.Drop,dn.FlickerInGlow,dn.Reveal,dn.PopInBounce,dn.SlideUp]),F_=({layer:e,xPixels:t=0,yPixels:a=0,transform:o=""})=>{switch(e.type){case ln.Audio:case ln.Video:case ln.Image:case ln.Shape:return{x:t,y:a,transform:o};case ln.Text:return{transform:`${o} translate(${t}px, ${a}px)`};case ln.Subtitle:default:return{}}},M_=({layer:e,xPercent:t=0,yPercent:a=0,transform:o=""})=>{var n,r,i,s,l,d;switch(e.type){case ln.Audio:case ln.Video:case ln.Image:case ln.Shape:return{x:.01*t*(null!=(i=null!=(r=null==(n=null==e?void 0:e.position)?void 0:n.float_width)?r:e.width)?i:0),y:.01*a*(null!=(d=null!=(l=null==(s=null==e?void 0:e.position)?void 0:s.float_height)?l:e.width)?d:0),transform:o};case ln.Text:return{transform:`${o} translate(${t}%, ${a}%)`};case ln.Subtitle:default:return{}}};function U_(e){const t=w_(e);return!e.animation||"none"===t.id}function B_(e,t){return{type:"SET_STUDIO_RATIO",ratio:e,undoable:t}}const W_=_("setuserManualSeek");function V_(e,t,a,o){return{type:"SET_CUSTOM_OUTPUT_SIZE",hasCustomOutput:e,customOutputWidth:t,customOutputHeight:a,undoable:o}}function j_(e){return{type:"SET_DRAGGING",isDragging:e}}function G_(e){return{type:"SET_TRACK_DRAGGING",trackIsDragging:e}}function H_(e){return{type:"SET_RESIZING",isResizing:e}}function z_(e){return{type:"SET_ROTATING",isRotating:e}}function $_(e){return{type:"SET_PLAY_CANVAS_PREVIEW_ON_MOUNT",playCanvasPreviewOnMount:e}}function K_(){return{type:"PAUSE_STUDIO"}}function Y_(){return{type:"PLAY_STUDIO"}}function q_(e){return{type:"SET_ORIGIN",origin:e}}function X_(e){return{type:"SET_OVERLAY_MOUNTED",overlayMounted:e}}function J_(){return{type:"UPDATE_LAST_SAVED"}}function Q_(e){return{type:"SHOW_TOOL_TIP",toolTip:e}}function Z_(e){return{type:"SET_EYEDROPPER_MODE",status:e}}function eT(e){const{state:t}=tn();return{type:"SET_RIPPLE_MODE",rippleMode:e,userId:t.currentUser.user._id}}function tT(e,t,a="preview",o){var n,r,i;let s="";const l=null!=o?o:tn().state;if(!e)return s;if(t&&t.length&&(s=e[t]),"ttsAudio"in e&&e.ttsAudio)return e.ttsAudio.url;const{id:d}=e;if("track_preview"in e){const{track_preview:t}=e,{trackPreviewLocalUrl:o}=(null==(r=null==(n=l.studioLocal)?void 0:n.layerTempValues)?void 0:r[d])||{};if("track_preview"===a){if(t){if(o)return o;if(t.url)return t.url}a="preview"}}const{local_url:c}=e;if(c&&("original"!==a||!("preview"in e)))return c;"preview"===a&&(s=(null==(i=e.preview)?void 0:i.url)||s);const{soundUrl:u,url:m}=e,{uri:p}=e;if(s=s||u||m||p||"",s||"FULFILLED"!==l.ffmpegReducer.ffmpegStatus||void 0===l.ffmpegReducer.outputFile){if(!s)return s}else s=l.ffmpegReducer.outputFileUrl;return"string"!=typeof s||s.includes("X-Goog-Expires=")||(s=s.replace("https://storage.googleapis.com/kapwing/","https://cdn.kapwing.com/"),s=s.replace("https://storage.googleapis.com/kapwing-useast1",Ur)),s}const aT=e=>e.includes("https://cdn.kapwing.com/")||e.includes("https://cdn.kapwing-useast1.com/");function oT(e){const{thumbnail_url:t,image_url:a,fullPath:o}=e;let n=t;return n||(n=a),n||(n=o),n&&"string"==typeof n||(n="https://cdn-useast1.kapwing.com/video_image-cHDmsyz_G.jpg"),n.includes("X-Goog-Expires=")||(n=n.replace("https://storage.googleapis.com/kapwing/","https://cdn.kapwing.com/"),n=n.replace("https://storage.googleapis.com/kapwing-useast1",Ur)),n}const nT=e=>e&&e.replace(/.*\/studio/,"/studio"),rT=e=>{const{state:t}=tn();let a="";t&&t.isStudio&&t.studio&&t.studio._id&&uT()&&(a=t.studio._id);const o=nT(e);return a?`/${a}${o}`:o},iT=(e,t={})=>{const a=rT(e);a!==en.location.pathname&&en.push(a,{properties:t})},sT=()=>{en.goBack()},lT=(e,t="")=>{const a=rT(e);a!==en.location.pathname&&en.replace(`${a}${t}`)},dT=()=>-1!==window.location.pathname.indexOf("/studio/editor/subtitle-overlay"),cT=()=>-1!==window.location.pathname.indexOf("/studio/editor/export-as-image"),uT=()=>-1!==window.location.pathname.indexOf("/studio/editor"),mT=()=>uT()&&!dT()&&!cT(),pT=()=>-1!==window.location.pathname.indexOf("/studio");function hT(){iT("/studio/editor")}function gT(){lT("/studio/editor")}function yT(){const{dispatch:e}=tn();hT(),e(vr(!1))}const fT=i.createContext(0);let ET=0;function vT(e){ET=e,window.studioTime=e}let wT=vT;const bT=({children:e})=>{const[t,a]=r.exports.useState(ET),o=e=>{vT(e),a(e)};wT=o;const n=tr((e=>e.studio.duration>0));return r.exports.useEffect((function(){if(!uT()&&-1===window.location.pathname.indexOf("/signin-redirect"))return;const e=jc.get("VIDEO_TIME_BEFORE_SIGN_IN",{disabled:0});e&&(o(e),jc.remove("VIDEO_TIME_BEFORE_SIGN_IN"))}),[]),r.exports.useEffect((function(){n||o(0)}),[n]),r.exports.useEffect((function(){return()=>{wT=vT}}),[]),i.createElement(fT.Provider,{value:t},e)},_T=()=>{const e=r.exports.useContext(fT);if(void 0===e)throw new Error("useStudioTime must be used within an StudioTimeContextProvider");return e};function TT(e){return t=>i.createElement(fT.Consumer,null,(a=>i.createElement(e,{...t,studioTime:a})))}const ST=()=>ET,IT=e=>{wT(e)};function xT(e,t){const{state:a,dispatch:o}=tn();!!a.studioLocal.isLayerMountedByLayerId[e]!==t&&o(zg({layerId:e,mounted:t}))}class kT{constructor(){a(this,"_cancelled",!1),a(this,"cancelledPromise"),a(this,"resolveCancelled"),this.cancelledPromise=new Promise((e=>{this.resolveCancelled=e}))}cancel(){var e;this._cancelled||(this._cancelled=!0,null==(e=this.resolveCancelled)||e.call(this))}waitForCancelled(){return this.cancelledPromise}get cancelled(){return this._cancelled}createChild(){const e=new kT;return this.waitForCancelled().then((()=>{e.cancel()})),e}}function CT(e){return!(e.requireConversion||"gif-to-webm"===e.conversion_type)}function AT(e){return!(!e.isReversed&&!e.isAudiogram)||!!_d(e)&&!!(e.removeBg||e.blurBg||e.chromaKey||!U_(e)||e.audioEffect)}function NT(e){return!(AT(e)||!CT(e)||vd(e)&&!e.isAudiogram||!e.width||!e.height)}function PT(e){return!!NT(e)||!(!_d(e)&&!vd(e))&&!(AT(e)||!CT(e))}const RT=1/30,LT=33.333333333333336,DT=e=>({mediaCacheId:e,duration:0,usage:new Set,buffered:new Set,seekUnder10:0,seekUnder30:0,seekHitsOver30:0,seekMissesOver30:0,loadMetadataMs:0,seekStallCounts:0,seekStallsMs:0,bytesFetched:0});class OT{constructor(e){this.map=e}getUsage(e){return ic(this.map,e,{insert:()=>DT(e)})}simulatePrebuffer(e,t){const a=this.map.get(e);if(null==a)return;const o=Math.floor(t);let n=Math.floor(Math.max(o-30,0));const r=Math.ceil(Math.min(o+30,a.duration));for(;n<r;)a.buffered.add(n),n+=1}attachEvents(e,t){e.readyState<HTMLMediaElement.HAVE_METADATA?e.addEventListener("loadedmetadata",(e=>{e.target instanceof HTMLVideoElement&&(this.getUsage(t).duration=e.target.duration)}),{once:!0,passive:!0}):this.getUsage(t).duration=e.duration;const a=e=>e.target instanceof HTMLVideoElement?e.target:null;let o;const n=e=>{const n=a(e);if(!n)return;const r=this.getUsage(t),i=n.currentTime,s=Math.floor(i);if(null!=o&&Math.abs(o-i)>=1){if(i-o<=30){r.seekUnder30+=1;i-o<=10&&(r.seekUnder10+=1)}else{r.buffered.has(s)?r.seekHitsOver30+=1:r.seekMissesOver30+=1}}o=i,r.usage.add(s),this.simulatePrebuffer(t,s)};let r;const i=performance.now();e.addEventListener("seeking",n,{passive:!0}),e.addEventListener("timeupdate",n,{passive:!0}),e.addEventListener("playing",n,{passive:!0}),e.addEventListener("seeking",(()=>{r=performance.now()}),{passive:!0}),e.addEventListener("seeked",(e=>{if(null==r)return;const o=a(e);if(!o)return;if(o.dataset.mse||!o.src.startsWith("blob:")){const e=this.getUsage(t);e.seekStallCounts+=1,e.seekStallsMs+=performance.now()-r}}),{passive:!0}),e.addEventListener("loadedmetadata",(()=>{this.getUsage(t).loadMetadataMs+=performance.now()-i}),{passive:!0,once:!0})}getMetrics(){let e=0,t=0,a=0,o=0,n=0,r=0,i=0,s=0,l=0,d=0,c=0,u=0;for(const p of this.map.values())e+=p.duration,t+=p.buffered.size,a+=p.usage.size,o+=p.seekUnder10,n+=p.seekUnder30,r+=p.seekHitsOver30+p.seekMissesOver30,i+=p.seekUnder30+p.seekHitsOver30,s+=p.seekMissesOver30,l+=p.loadMetadataMs,d+=p.seekStallCounts,c+=p.seekStallsMs,u+=p.bytesFetched;const m={"Total seeks under 10s":o,"Total seeks under 30s":n,"Total seeks over 30s":r,"Total seek hits":i,"Total seek misses":s,"Total buffered (s)":t,"Total usage (s)":a,"Total duration (s)":e,"Average Seek stalls (ms)":c/d,"Average metadata loading (ms)":l,"Bytes fetched":u};return m["Total duration (s)"]?m:null}}const FT=new OT(new Map),MT=new OT(new Map),UT=e=>{if(FT.map.clear(),MT.map.clear(),null==e)return;const{records:t}=e;for(const[a,o]of Object.entries(t)){const e={...DT(a),...o,usage:new Set,buffered:new Set};FT.map.set(a,e);for(const[t,a]of o.usage)for(let o=t;o<=a;o++)e.usage.add(o);for(const[t,a]of o.buffered)for(let o=t;o<=a;o++)e.buffered.add(o)}};function BT(e,t){FT.getUsage(e).bytesFetched+=t,MT.getUsage(e).bytesFetched+=t}class WT{constructor(e){a(this,"elementPool"),a(this,"setVolumeByDomId",new Map),a(this,"playOrSeekCancellationSource",null),a(this,"isPlayOrSeekingStatus","Idle"),a(this,"currentReferenceLayerId"),a(this,"setEPLayerAsMounted",((e,t)=>{xT(e,!0);const a=this.elementPool.layerIdsByElementId.get(t);null==a||a.forEach((t=>{t!==e&&xT(t,!1)}))})),a(this,"setAllElementLayersAsUnmounted",(e=>{var t;null==(t=this.elementPool.layerIdsByElementId.get(e))||t.forEach((e=>{xT(e,!1)}))})),a(this,"retryableMountVideo",((e,t,a)=>{const o=t=>{if(a.cancelled)return!1;if(!t.contains(e)){for(const e of t.children)"VIDEO"===e.tagName&&t.removeChild(e);return t.appendChild(e),!0}return!1};return new Promise((e=>{const n=document.getElementById(`EPContainer_${t.layerId}`);if(n){const t=o(n);return void e(t)}if(document.getElementById("stop-prop"))new MutationObserver(((n,r)=>{a.cancelled&&(e(!1),r.disconnect());for(const a of n)if("childList"===a.type)for(const n of a.addedNodes)if(n instanceof HTMLElement&&n.id===`EPContainer_${t.layerId}`){const t=o(n);r.disconnect(),e(t)}}));else{const n=setInterval((()=>{const r=document.getElementById(`EPContainer_${t.layerId}`);if(r){const t=o(r);clearInterval(n),e(t)}a.cancelled&&(clearInterval(n),e(!1))}),25)}}))})),this.elementPool=e}pause(){this.cancelPreviousPlayOrSeek();for(const[e,t]of this.elementPool.domElementByLayerId)t.pause()}async seek(e,t=!1){this.cancelPreviousPlayOrSeek();const a=new kT;this.playOrSeekCancellationSource=a,this.isPlayOrSeekingStatus="Seeking";try{if(t){const{state:t}=tn(),o=t.studioLocal.playbackRate;this.currentReferenceLayerId="seeked",await this.seekElementsIfStudioIsPlaying(e,a,o)}else this.currentReferenceLayerId=void 0,await this.seekElementsIfStudioIsPaused(e,a)}finally{this.isPlayOrSeekingStatus="Idle"}}async seekElementsIfStudioIsPaused(e,t){const a=[],o=[];for(const[r,i]of this.elementPool.layerIdsByElementId){const t=this.elementPool.domElementByDomId.get(r),n=this.findLayerThatShouldBePlaying(i,e);n?a.push([n,t]):o.push(t)}const n=[];await Promise.race([Promise.all(a.map((([a,o])=>new Promise((async r=>{const i=HT(e,a.startEndTimes[0],a.relativeStartEndTimes[0],a.playbackRate);if(jT(o.currentTime,i,1/30)){await this.retryableMountVideo(o,a,t)&&n.push([a.layerId,o.id]),r()}else o.addEventListener("seeked",(async()=>{if(!t.cancelled){await this.retryableMountVideo(o,a,t)&&n.push([a.layerId,o.id]),r()}}),{once:!0}),$T(o,i)}))))),t.waitForCancelled()]),t.cancelled||(n.forEach((([e,t])=>{this.setEPLayerAsMounted(e,t)})),setTimeout((()=>{o.forEach((e=>{e.remove(),this.setAllElementLayersAsUnmounted(e.id)}))}),0))}async seekElementsIfStudioIsPlaying(e,t,a){const o=[],n=[];for(const[i,s]of this.elementPool.layerIdsByElementId){const t=this.findLayerThatShouldBePlaying(s,e);t?o.push(t):n.push(i)}for(const i of n){const e=this.elementPool.domElementByDomId.get(i);e.paused||e.pause()}try{await Promise.race([Promise.all(o.map((async o=>{const n=this.elementPool.domElementByLayerId.get(o.layerId),r=HT(e,o.startEndTimes[0],o.relativeStartEndTimes[0],o.playbackRate),i=WT.trackSeekAsPromise(n);$T(n,r),await i,t.cancelled||await this.playElementAtStudioTime(n,o,e,a,t)}))),t.waitForCancelled()])}catch(r){console.error("playOrSeekElementsWhileStudioIsPlaying - playing elements failed to resolve",r)}if(!t.cancelled)for(const i of n){const e=this.elementPool.domElementByDomId.get(i);document.body.contains(e)&&(e.remove(),this.setAllElementLayersAsUnmounted(i));const t=this.elementPool.layerIdsByElementId.get(i);this.seekAhead(e,t,ST())}}cancelPreviousPlayOrSeek(){var e;null==(e=this.playOrSeekCancellationSource)||e.cancel(),this.playOrSeekCancellationSource=null}async _playOrPreseekElementsWhileStudioIsPlaying(e,t){var a,o,n,r;let i=ST();this.cancelPreviousPlayOrSeek();const s=new kT;if(this.playOrSeekCancellationSource=s,this.currentReferenceLayerId&&"seeked"!==this.currentReferenceLayerId){const t=this.elementPool.layerByLayerId.get(this.currentReferenceLayerId);if(t&&this.elementPool.domElementByLayerId.get(t.layerId)){const r=null!=(o=null==(a=this.elementPool.domElementByLayerId.get(t.layerId))?void 0:a.currentTime)?o:0,[s,l]=t.startEndTimes,[d,c]=t.relativeStartEndTimes;if(GT(s,i,l)&&r>=c){const t=(null==(n=function(e,t){let a=null;for(const o of t){if("ep"!==o.whichElementPool)continue;GT(e,o.startEndTimes[0],e+.03333333333333333)&&(!a||o.startEndTimes[0]<a.startEndTimes[0])&&(a=o)}return a}(l,e))?void 0:n.startEndTimes[0])||l;i=t,IT(t)}}}const l=[],d=[];for(const[p,h]of this.elementPool.layerIdsByElementId){const e=this.findLayerThatShouldBePlaying(h,i);e?l.push(e):d.push(p)}for(const p of d){const e=this.elementPool.domElementByDomId.get(p);e.paused||e.pause()}const c=(null==(r=l.find((t=>VT(t.startEndTimes,i,e))))?void 0:r.layerId)||void 0,u=c&&"seeked"!==this.currentReferenceLayerId&&this.currentReferenceLayerId!==c;this.currentReferenceLayerId=c;try{await Promise.race([Promise.all(l.map((async e=>{let a=i;const o=this.elementPool.domElementByLayerId.get(e.layerId);if(this.currentReferenceLayerId===e.layerId&&o){let t=o.currentTime;const n=i===e.startEndTimes[0]&&t===e.relativeStartEndTimes[0];if(!GT(e.relativeStartEndTimes[0],o.currentTime,e.relativeStartEndTimes[1])||u&&!n){t=HT(i,e.startEndTimes[0],e.relativeStartEndTimes[0],e.playbackRate);const a=WT.trackSeekAsPromise(o);$T(o,t),await a}a=gb(zT(t,e.startEndTimes[0],e.relativeStartEndTimes[0],e.playbackRate),.001),IT(a)}return this.playElementAtStudioTime(o,e,a,t,s)}))),s.waitForCancelled()])}catch(m){console.error("playOrSeekElementsWhileStudioIsPlaying - playing elements failed to resolve",m)}if(!s.cancelled)for(const p of d){const e=this.elementPool.domElementByDomId.get(p);document.body.contains(e)&&(e.remove(),this.setAllElementLayersAsUnmounted(p));const t=this.elementPool.layerIdsByElementId.get(p);this.seekAhead(e,t,i)}}async playOrPreseekElementsWhileStudioIsPlaying(e,t){if("Idle"===this.isPlayOrSeekingStatus){this.isPlayOrSeekingStatus="Playing";try{await this._playOrPreseekElementsWhileStudioIsPlaying(e,t)}finally{this.isPlayOrSeekingStatus="Idle"}}}seekAhead(e,t,a){const o=this.findLayerClosestToStudioTime(t,a);var n,r;jT(e.currentTime,o.relativeStartEndTimes[0],.15)||(n=o.mediaId,r=o.relativeStartEndTimes[0],FT.simulatePrebuffer(n,r),MT.simulatePrebuffer(n,r),this.elementPool.streamsByElementId.has(e.id)&&this.elementPool.streamsByElementId.get(e.id).prebuffer(o.relativeStartEndTimes[0]),setTimeout((()=>{$T(e,o.relativeStartEndTimes[0])}),0))}shouldBindNonReferenceLayer(e,t,a){const o=e.getAttribute("data-lastBindTimestamp");o||e.setAttribute("data-lastBindTimestamp",String(Date.now()));const n=Date.now()-Number(o);return!jT(e.currentTime,t,.5*a)&&n>5e3}static trackSeekAsPromise(e){return new Promise((t=>{e.addEventListener("seeked",(function a(){t(),e.removeEventListener("seeked",a)}))}))}async playElementAtStudioTime(e,t,a,o,n){const r=o*t.playbackRate;e.playbackRate!==r&&(e.playbackRate=r),this.setElementVolume(e,t.volume);const i=HT(a,t.startEndTimes[0],t.relativeStartEndTimes[0],t.playbackRate);if(this.shouldBindNonReferenceLayer(e,i,t.playbackRate)){e.setAttribute("data-lastBindTimestamp",String(Date.now()));const t=WT.trackSeekAsPromise(e);$T(e,i),await t}const s=await this.retryableMountVideo(e,t,n);n.cancelled||(e.paused&&e.currentTime!==e.duration&&await e.play(),s&&this.setEPLayerAsMounted(t.layerId,e.id))}findLayerClosestToStudioTime(e,t){for(const a of e){const e=this.elementPool.layerByLayerId.get(a);if(e.startEndTimes[0]-t>0)return e}return this.elementPool.layerByLayerId.get(e[0])}findLayerThatShouldBePlaying(e,t){for(const a of e){const e=this.elementPool.layerByLayerId.get(a);if(GT(e.startEndTimes[0],t,e.startEndTimes[1],e.isAtEnd)||e.shouldBePlayingOverride)return e}}setElementVolume(e,t){let a;if(this.setVolumeByDomId.has(e.id))a=this.setVolumeByDomId.get(e.id),this.setVolumeByDomId.set(e.id,a);else{if(Rl())return a=t=>{e.volume=Math.min(Math.max(t,0),1)},void this.setVolumeByDomId.set(e.id,a);const t=new window.AudioContext,o=t.createMediaElementSource(e),n=t.createGain();o.connect(n),n.connect(t.destination),a=t=>{jT(n.gain.value,t,.01)||(console.info("Setting volume: ",e.id,t),n.gain.value=t)},this.setVolumeByDomId.set(e.id,a)}a(t)}}function VT(e,t,a){const o=e[1]-e[0];for(const n of a)if(GT(n.startEndTimes[0],t,n.startEndTimes[1])){const t=n.startEndTimes[1]-n.startEndTimes[0];if(t>o)return!1;if(t===o&&n.startEndTimes[0]<e[0])return!1}return!0}function jT(e,t,a){return Math.abs(t-e)<a}function GT(e,t,a,o=!1){return o?e<=t&&t<=a:e<=t&&t<a}function HT(e,t,a,o){return a+(e-t)*o}function zT(e,t,a,o){return(e-a)/o+t}function $T(e,t){e.currentTime=t,Nl()&&(e.readyState>2||e.load())}function KT(e,t){const{dispatch:a,state:o}=tn(),n=o.studioLocal.layerTempValues[e];if(n){for(const[r,i]of Object.entries(t))if(i!==n[r]){a(qh(e,t));break}}else a(qh(e,t))}function YT(e){if(0===Object.keys(e).length)return;const{dispatch:t}=tn();t(Xh(e))}function qT(e,t=8){return+`${Math.round(`${parseFloat(e).toFixed(t)}e+${t}`)}e-${t}`}function XT(){const{state:e}=tn();return{height:e.studio.height,width:e.studio.width,x:e.studio.canvasX,y:e.studio.canvasY}}function JT(e,t,a){return{x:parseFloat(e)/100*a.width+a.x,y:parseFloat(t)/100*a.height+a.y}}function QT(e,t,a=XT()){return JT(e,t,{x:a.x,y:a.y,width:a.width||0,height:a.height||0})}function ZT(e,t,a){return{width:parseFloat(e)/100*a.width,height:parseFloat(t)/100*a.height}}function eS(e,t,a=XT()){return ZT(e,t,{width:a.width,height:a.height})}function tS(e,t,a){let o=50,n=50;return a.width&&a.height?(o=e/a.width*100,n=t/a.height*100,{widthPercent:o,heightPercent:n}):{widthPercent:o,heightPercent:n}}function aS(e,t,a){const{heightPercent:o,widthPercent:n}=tS(e,t,a);return{heightPercent:`${o}%`,widthPercent:`${n}%`}}function oS(e,t){const{state:a}=tn();return tS(e,t,{width:a.studio.width,height:a.studio.height})}function nS(e,t){const{state:a}=tn();return aS(e,t,{width:a.studio.width,height:a.studio.height})}function rS(e,t,a){let o=0,n=0;return void 0!==a.x&&void 0!==a.y&&a.width&&a.height?(o=(e-a.x)/a.width*100,n=(t-a.y)/a.height*100,{xPercent:o,yPercent:n}):{xPercent:o,yPercent:n}}function iS(e,t,a){const{xPercent:o,yPercent:n}=rS(e,t,a);return{xPercent:`${o}%`,yPercent:`${n}%`}}function sS(e,t){const{state:a}=tn(),{canvasX:o,canvasY:n}=a.studio;return rS(e,t,{x:o,y:n,width:a.studio.width,height:a.studio.height})}function lS(e,t){const{state:a}=tn(),{canvasX:o,canvasY:n}=a.studio;return iS(e,t,{x:o,y:n,width:a.studio.width,height:a.studio.height})}const dS=(e,t,a,o)=>{const{dispatch:n}=tn(),r=lS(t.x,t.y),i=nS(t.width,t.height);a?KT(e.id,{positionTemp:{x:r.xPercent,y:r.yPercent,width:i.widthPercent,height:i.heightPercent,rotation:t.rotation}}):(KT(e.id,{positionTemp:null}),n(Th(e,r.xPercent,r.yPercent,i.widthPercent,i.heightPercent,o)),n(xh(e,t.rotation,o)))},cS=e=>{const{state:t}=tn();let{canvasX:a,canvasY:o}=t.studio;const n=t.studio.width,r=t.studio.height;if(void 0===a||void 0===o||void 0===n||void 0===r)return null;(dT()||cT())&&(a=0,o=0);const i=mS(e,{x:a,y:o,width:n,height:r});return e.position||dS(e,i),i},uS=e=>{var t,a;const{state:o}=tn(),{canvasX:n,canvasY:r}=o.studio,i=o.studio.width,s=o.studio.height;if(void 0===n||void 0===r||void 0===i||void 0===s)return null;const l=mS(e,{x:n,y:r,width:i,height:s}),d=lS(l.x,l.y),c=nS(l.width,l.height);return{x:d.xPercent,y:d.yPercent,rotation:null==(t=null==e?void 0:e.position)?void 0:t.rotation,width:c.widthPercent,height:c.heightPercent,flip:null==(a=null==e?void 0:e.position)?void 0:a.flip}},mS=(e,t)=>{var a;const{state:{studioLocal:{layerTempValues:o}}}=tn();let{x:n,y:r,width:i,height:s}=t;const l=s,{lineWidth:d}=e,c=(null==(a=o[e.id])?void 0:a.positionTemp)||e.position,u=parseFloat(String(d))/100*l;if(c){const e=JT(c.x,c.y,t);n=e.x,r=e.y;const a=ZT(c.width,c.height,t);i=a.width,s=a.height}else if(e.width&&e.height){const a=t.width/t.height,o=e.width/e.height;let l=t.width,d=t.height;o>=a?(d=e.height*t.width/e.width,r=(t.height-d)/2+t.y):(l=e.width*t.height/e.height,n=(t.width-l)/2+t.x),i=l,s=d}let m=0;if(e.position&&e.position.rotation&&(m=e.position.rotation),l)switch(e.lineRightAngle){case"horizontal":s=u;break;case"vertical":i=u}return{x:n,y:r,width:i,height:s,rotation:m}};function pS(e){const{state:t}=tn(),a=t.studio.width||0,o=t.studio.height||0;if(a>o){const t=nS(eS(e.width,e.height).height,0);e.width=t.widthPercent}else if(a<o){const t=nS(0,eS(e.width,e.height).width);e.height=t.heightPercent}return e}function hS(e,t,a){const{width:o,height:n,prevWidth:r,prevHeight:i}=a;let s,l;const d=ZT(e.width,e.height,a),c=o/n,u=r/i,m=Math.max(parseFloat(e.height)/100,parseFloat(e.width)/100);return t<=1?(l=d.height,s=l*t,s>o?(s=m*o,l=s/t):c>u&&(l=m*n,s=l*t)):(s=d.width,l=s/t,l>n?(l=m*n,s=l*t):c<u&&(s=m*o,l=s/t)),{layerWidth:s,layerHeight:l}}function gS(e,t,a,o){const{x:n,y:r,width:i,height:s}=o,l=JT(e.x,e.y,o);let d=l.x,c=l.y;if(function({x:e,y:t,width:a,height:o}){return 50===Math.round(parseFloat(e)+parseFloat(a)/2)||50===Math.round(parseFloat(t)+parseFloat(o)/2)}(e)){const{x:o,y:l,width:u,height:m}=e,p=d+t/2,h=c+a/2,g=n+i/2,y=r+s/2;50===Math.round(parseFloat(o)+parseFloat(u)/2)&&p!==g&&(d+=g-p),50===Math.round(parseFloat(l)+parseFloat(m)/2)&&h!==y&&(c+=y-h)}return{layerX:d,layerY:c}}function yS(e,t,a,o,n,r){const i=hS({x:"0%",y:"0%",width:"100%",height:"100%",rotation:0},t/a,{x:0,y:0,width:o,height:n,prevWidth:t,prevHeight:a}),s=i.layerWidth/o,l=i.layerHeight/n,d=(1-s)/2,c=(1-l)/2;if(e.position){let t=d*o+parseFloat(e.position.x)/100*s*o;let a=c*n+parseFloat(e.position.y)/100*l*n;const u=parseFloat(e.position.width)/100*i.layerWidth,m=parseFloat(e.position.height)/100*i.layerHeight;return r&&"shape"===e.type&&"ellipse"===e.shapeType&&(t-=u/2,a-=m/2),{x:t,y:a,width:u,height:m}}return{x:0,y:0,width:100,height:100}}function fS(e,t,a,o,n){const r=hS({x:"0%",y:"0%",width:"100%",height:"100%",rotation:0},o/n,{x:0,y:0,width:t,height:a,prevWidth:o,prevHeight:n}),i=r.layerWidth/t,s=r.layerHeight/a,l=(1-i)/2,d=(1-s)/2;return!!e.every((e=>{if(e.position&&"subtitle"!==e.type){const{x:t,y:a,width:o,height:n}=e.position;if(parseFloat(t)<100*l)return!1;if(parseFloat(a)<100*d)return!1;if(parseFloat(t)+parseFloat(o)>100*(l+i))return!1;if(parseFloat(a)+parseFloat(n)>100*(d+s))return!1}return!0}))}function ES(e,t,a,o,n){let r=0;if(e.position&&e.position.rotation&&(r=e.position.rotation),t&&a&&o&&n){const i=hS({x:"0%",y:"0%",width:"100%",height:"100%",rotation:0},o/n,{x:0,y:0,width:t,height:a,prevWidth:o,prevHeight:n}),s=i.layerWidth/t,l=i.layerHeight/a,d=(1-s)/2,c=(1-l)/2;if(e.position){const{x:i,y:u,width:m,height:p}=e.position,h=(parseFloat(i)/100-d)*o;let g=(parseFloat(u)/100-c)*n;const y=(1-(s-parseFloat(m)/100))*o;let f=(1-(l-parseFloat(p)/100))*n;const E=t*parseFloat(m)/100,v=y*(a*parseFloat(p)/100)/E,w=g-(v-f)/2;return f=v,g=w,{x:h,y:g,width:y,height:f,rotation:r}}}return{x:0,y:0,width:100,height:100,rotation:r}}function vS(e,t,a,o,n){const r=parseFloat(e.width)/100*o,i=parseFloat(e.height)/100*n,s=r/i;return r<i?{x:parseFloat(e.x)/100*t,y:parseFloat(e.y)/100*a,width:r,height:r/s,rotation:e.rotation}:{x:parseFloat(e.x)/100*t,y:parseFloat(e.y)/100*a,width:i*s,height:i,rotation:e.rotation}}function wS(e){const{state:{studio:{width:t=100,height:a=100}}}=tn(),{crop:o,position:n,lockAspectRatio:r,width:i=100,height:s=100}=e,l=i/s/(t/a);if(r)return!1;const{width:d,height:c}=n||{x:"0%",y:"0%",height:"100%",width:"100%",rotation:0},u=parseFloat(d),m=parseFloat(c);if(!o){if(!jT(u/m,l,.01))return!0}const{width:p,height:h}=o||{height:100,width:100,x:0,y:0,presetIndex:0};return!jT(u/(p/100)/(m/(h/100)),l,.01)}const bS=e=>{var t;const{xPercent:a,yPercent:o}=lS(e.x,e.y),{widthPercent:n,heightPercent:r}=nS(e.width,e.height);return{x:a,y:o,width:n,height:r,rotation:null!=(t=e.rotation)?t:0}},_S=(e,t,a)=>{if(!e.position)return{x:"0%",y:"0%"};if("ellipse"===e.shapeType)return s.exports.pick(e.position,["x","y"]);const o=parseFloat(e.position.x)/100*t,n=parseFloat(e.position.y)/100*a;return{x:`${(o+parseFloat(e.position.width)/100*t/2)/t*100}%`,y:`${(n+parseFloat(e.position.height)/100*a/2)/a*100}%`}},TS=(e,t,a)=>{if(!e.position)return{x:"0%",y:"0%"};const o=_S(e,t,a),n=2*(parseFloat(o.x)-50),r=2*-(parseFloat(o.y)-50);return{x:`${+n.toFixed(2)}%`,y:`${+r.toFixed(2)}%`}};function SS(e){return null!=tn().state.studio.allLayers.byId[e]}function IS(e){return`${e}%`}function xS(e){return parseInt(e,10)}function kS(e="30%",t="30%"){const a=xS(e),o=xS(t),n=10*Math.random()-5,r=(100-o)/2;return{x:IS((100-a)/2+n),y:IS(r+n),width:e,height:t,rotation:0}}function CS(e,t,a){return(e.x-t.x)*Math.sin(a)+(e.y-t.y)*Math.cos(a)+t.y}function AS(e,t,a){return(e.x-t.x)*Math.cos(a)-(e.y-t.y)*Math.sin(a)+t.x}function NS(e,t,a){return{x:AS(e,t,a),y:CS(e,t,a)}}const PS=e=>e*Math.PI/180;function RS(e){let t,a,o,n;if("percent"===e.positionType){const{position:r}=e,i=r.x,s=r.y,l=r.width,d=r.height;({width:t,height:a}=eS(l,d)),({x:o,y:n}=QT(i,s))}else{const{position:r}=e;({width:t,height:a,x:o,y:n}=r)}const r=e.position.rotation||0;"ellipse"===e.shapeType&&(o-=t/2,n-=a/2);const i={x:o+t/2,y:n+a/2},s=NS({x:o,y:n},i,PS(r)),l=NS({x:o+t,y:n},i,PS(r)),d=NS({x:o,y:n+a},i,PS(r));return{tl:s,tr:l,br:NS({x:o+t,y:n+a},i,PS(r)),bl:d}}function LS(e){let t={top:window.screen.height,right:0,bottom:0,left:window.screen.width};for(const n of e){if("subtitle"===n.type||"audio"===n.type)continue;if(!n.position)continue;const{tl:e,tr:a,bl:o,br:r}=RS({position:n.position,shapeType:n.shapeType,positionType:"percent"}),i=[e,a,o,r];t={top:Math.min(t.top,...i.map((e=>e.y))),right:Math.max(t.right,...i.map((e=>e.x))),bottom:Math.max(t.bottom,...i.map((e=>e.y))),left:Math.min(t.left,...i.map((e=>e.x)))}}const a=t.right-t.left,o=t.bottom-t.top;return{x:t.left+a/2,y:t.top+o/2}}const DS=e=>{let t=!1;for(const a of e)if("video"===a.type||a.mime&&"gif"===a.mime.split("/")[1]){t=!0;break}return t};function OS(e){return!(e.filters&&0!==Object.keys(e.filters).length||e.presetFilter&&0!==Object.keys(e.presetFilter).length)}function FS(e){return!e.chromaKey&&!e.removeBg&&!e.blurBg}function MS(e,t){if(!e.height||!e.width||!e.position)return!1;const{position:a}=e,o=.01,n=e.width/e.height,r=Math.abs(t-n)<=o,i=Math.abs(100-parseFloat(a.width))<=o,s=Math.abs(100-parseFloat(a.height))<=o,l=Math.abs(0-parseFloat(a.x))<=o,d=Math.abs(0-parseFloat(a.y))<=o,c=a.flip&&(a.flip.x||a.flip.y);return i&&s&&l&&d&&!c&&0===a.rotation&&r}function US(e,t){const a=[];for(const o of e)for(const e of o.layers)t.includes(e.id)&&a.push(e);return a}function BS(e){return"image/webp"===e.mime?"static"===e.webpType:"audio"!==e.type&&"video"!==e.type}const WS={startTime:0,endTime:Number.MAX_VALUE};function VS(e,t){if(!t)return e;const{diff:a,type:o,leftMost:n}=t,{startTime:r=0,endTime:i=0,videoDelay:s=0}=e,l=BS(e);let d;return d="drag"===o?l?n?WS:{startTime:r+a,endTime:i+a}:{videoDelay:s+a}:"trim-start"===o?l?WS:{videoDelay:s+a,startTime:r+a}:l?WS:{endTime:i+a},{...e,...d}}function jS(e,t){const a=tn().state.studio.scenes[0];if(!a)throw new Error("Scene not found");const o=a.duration,n={...e,isTrimmed:!0},r=!BS(e),i=!BS(t),{endTime:s=0,startTime:l=0,videoDelay:d=0}=t;if(i){const{duration:a=0}=t;if(r){const a=Math.min(t.duration||0,e.duration||0);n.videoDelay=d,n.startTime=0,n.endTime=a}else{const{videoDelay:e=0}=t;n.startTime=e,n.endTime=e+(s||a)-l}}else r?0===l&&0===s?(n.videoDelay=0,n.startTime=0,n.endTime=Math.max(o,e.duration||0)):(n.videoDelay=l,n.startTime=0,n.endTime=Math.min(s-l,e.duration||0)):(n.startTime=t.startTime,n.endTime=t.endTime);return t.position&&(n.position=t.position),t.filters&&(n.filters=t.filters),t.presetFilter&&(n.presetFilter=t.presetFilter),n.converted_type=void 0,n}const GS=[],HS=c((e=>{var t;return null==(t=e.studio.scenes[0])?void 0:t.layers}),(e=>{var t;return null==(t=e.studio.scenes[0])?void 0:t.duration}),(e=>e.studioLocal.layerTempValues),(e=>e.studioLocal.draggedTracksOverrides),(e=>e.mediaCache),((e=[],t=0,a,o,n)=>{var r,i,s,l;const d=[];for(const c of e){if("subtitle"===c.type)break;if((_d(c)||vd(c)||Td(c))&&!NT(c)){const e=null==o?void 0:o[c.id],u=VS(c,e),m=rr(u),p=Lr(c,n);let h,g,y=!1;_d(c)&&c.preview&&c.preview.url&&c.preview.asset_id?(h=c.preview.url,g=c.preview.asset_id,y=!!c.preview.fragmented):h=tT(c);const f={layerId:c.id,playbackRate:Number(c.playbackRate)||1,mediaId:p||c.asset_id||c.uploadId||c.id,url:h,type:c.type,volume:null!=(s=null!=(i=null==(r=a[c.id])?void 0:r.volumeTemp)?i:c.volume)?s:1,relativeStartEndTimes:[hb(u.startTime||0),hb(null!=(l=u.endTime)?l:(u.startTime||0)+c.duration)],startEndTimes:[hb((Td(u)?u.startTime:u.videoDelay)||0),hb(((Td(u)?u.startTime:u.videoDelay)||0)+m)],mediapipe:(null==c?void 0:c.removeBg)||(null==c?void 0:c.blurBg),fragmented:y,previewAssetId:g};e&&("trim-start"===e.type||"trim-end"===e.type||e.leftMost)&&(f.shouldBePlayingOverride=!0),f.startEndTimes[1]===hb(t)&&(f.isAtEnd=!0),d.push(f)}}return 0===d.length?GS:d.sort(((e,t)=>e.startEndTimes[0]-t.startEndTimes[0]))}));c((e=>{var t;return null==(t=e.studio.scenes[0])?void 0:t.layers}),((e=[])=>{const t=[];for(const a of e){if("subtitle"===a.type)break;const[e,o]=zS(a);t.push({...a,absoluteStartTime:e,absoluteEndTime:o})}return t}));const zS=(e,t=0)=>{if(_d(e)||vd(e)){const a=t+(e.videoDelay||0),o=a+rr(e);return[hb(a),hb(o)]}return[t+(e.startTime||0),t+(e.endTime||e.duration||tn().state.studio.duration)]},$S=c((e=>{var t;return null==(t=e.studio.scenes[0])?void 0:t.layers}),(e=>{var t;return null==(t=e.studio.scenes[0])?void 0:t.duration}),(e=>e.studioLocal.layerTempValues),(e=>e.studioLocal.draggedTracksOverrides),(e=>e.mediaCache),(e=>e.studio.canvasBlur),((e=[],t=0,a,o,n,r)=>{var i,s,l,d;const c=[];for(const m of e){if("subtitle"===m.type)break;if(_d(m)&&NT(m)){const e=null==o?void 0:o[m.id],r=VS(m,e),u=rr(r),{assetSource:p}=m,h=Lr(m,n);let g,y,f=!1;m.preview&&m.preview.url&&m.preview.asset_id?(g=m.preview.url,y=m.preview.asset_id,f=!!m.preview.fragmented):g=tT(m);const E={layerId:m.id,playbackRate:Number(m.playbackRate)||1,mediaId:h||m.asset_id||m.uploadId||m.id,url:g,fragmented:f,previewAssetId:y,disableCORS:p&&["Google Photos","Youtube"].includes(p)&&!aT(g),type:m.type,volume:null!=(l=null!=(s=null==(i=a[m.id])?void 0:i.volumeTemp)?s:m.volume)?l:1,relativeStartEndTimes:[hb(r.startTime||0),hb(null!=(d=r.endTime)?d:(r.startTime||0)+m.duration)],startEndTimes:[hb(r.videoDelay||0),hb((r.videoDelay||0)+u)],mediapipe:m.removeBg||m.blurBg};e&&("trim-start"===e.type||"trim-end"===e.type||e.leftMost)&&(E.shouldBePlayingOverride=!0),E.startEndTimes[1]===hb(t)&&(E.isAtEnd=!0),c.push(E)}}if(r)return c.sort(((e,t)=>e.startEndTimes[0]-t.startEndTimes[0]));const u={};for(const m of c){const e=u[m.mediaId];e?e.push(m):u[m.mediaId]=[m]}return Object.values(u).forEach((e=>{e.sort(((e,t)=>e.relativeStartEndTimes[0]-t.relativeStartEndTimes[0]))})),c.sort(((e,t)=>e.startEndTimes[0]-t.startEndTimes[0]))})),KS=e=>({layerId:e.layerId,startEndTimes:[e.startEndTimes[0],e.startEndTimes[1]]}),YS=c($S,HS,((e,t)=>{const a=[],{studio:o}=tn().state;return e.forEach((e=>a.push({...KS(e),whichElementPool:"ep"}))),t.forEach((e=>{const t=Jw(e.layerId,o);t&&PT(t)&&a.push({...KS(e),whichElementPool:"canvas"})})),a}));function qS(){const e=ST(),{state:t}=tn(),a=$S(tn().state),o=YS(t);for(const n of a){const[t,a]=n.startEndTimes;if(t<=e&&e<a&&VT([t,a],e,o))return!0}return!1}function XS(){const e=ST(),{state:t}=tn(),a=e-.03333333333333333,o=e+.03333333333333333,n=YS(t),r=n.filter((({layerId:e})=>{const a=Jw(e,t.studio);return!!a&&!NT(a)}));for(const i of r){const[t,r]=i.startEndTimes;if(t<a&&o<r&&VT([t,r],e,n))return!0}return!1}const JS=(e,t,a)=>!a&&!!GT(e,t,e+QS),QS=.16666666666666666,ZS=()=>c($S,HS,(e=>e.studioLocal.isLayerMountedByLayerId),((e,t)=>t),((e,t,a,o)=>{const n=e.find((e=>jT(o,e.startEndTimes[0],.03333333333333333)))||t.find((e=>e.type===ln.Video&&jT(o,e.startEndTimes[0],.03333333333333333)));return!!n&&!a[n.layerId]}));var eI=(e=>(e[e.Track=1]="Track",e[e.Trimmer=4]="Trimmer",e[e.DraggedTrack=5]="DraggedTrack",e[e.TimelineRowColumn=6]="TimelineRowColumn",e[e.TimeLabel=10]="TimeLabel",e[e.Comment=10]="Comment",e[e.SelectedComment=11]="SelectedComment",e[e.Seeker=12]="Seeker",e[e.DraggedSeeker=13]="DraggedSeeker",e[e.DraggedTrackTrimmer=13]="DraggedTrackTrimmer",e[e.InvisibleTrimmerHandle=14]="InvisibleTrimmerHandle",e[e.RowHighlight=22]="RowHighlight",e))(eI||{});const tI=30,aI=60,oI=30,nI=25,rI=10,iI=20,sI=30,lI=30,dI=5,cI=.001,uI=25,mI=20;var pI=(e=>(e.TrimEnd="TrimEnd",e.TrimStart="TrimStart",e.Drag="Drag",e.None="None",e))(pI||{});const hI=(e,t)=>t/e,gI=(e,t)=>t*e,yI=(e,t)=>{let a=(t-25)/e;return a<0&&(a=0),a},fI=(e,t)=>{let a=t*e+25;return a<0&&(a=25),a};function EI(e,t){if(!t)return[];if("subtitle"===t.type){let t=0;return e.every(((e,a)=>"subtitle"!==e.type||(t=a,!1))),e.slice(t)}const a=[];return e.every((e=>"subtitle"!==e.type&&(e.timelineRow===t.timelineRow&&a.push(e),!0))),a}const vI=e=>{const t=new Map;return e.forEach((e=>{const{timelineRow:a}=e;if(void 0!==a){const o=t.get(a);o?(o.push(e),t.set(a,o)):t.set(a,[e])}})),t},wI=e=>{const t=vI(e);for(const[a,o]of t){const e=o.sort(((e,t)=>zS(e,0)[0]-zS(t,0)[0]));for(let t=0;t<e.length-1;t+=1){const a=e[t],o=e[t+1];if(!a||!o)continue;if(!_d(a)&&!wd(a)||!_d(o)&&!wd(o))continue;if(zS(a,0)[1]+.01>=zS(o,0)[0])return!0}}return!1},bI=e=>e.some((e=>_d(e)||wd(e))),_I=(e,t,a)=>{var o,n;const{timelineContainerWidth:r}=e.studioLocal,i=null!=(n=null==(o=e.projectSessionSettings.timelinePosition)?void 0:o.timelineScrollLeft)?n:0,s=Wl(e);return s?t.filter((e=>{const[t,o]=zS(e,0),n=fI(s,t);return!(fI(s,o)<=(a?i:i-.25*r)||(a?i+r:i+r+.25*r)<=n)})):[]},TI=c((e=>e.studio.allLayers.byId),(e=>e.studioLocal.timelineContainerWidth),(e=>{var t,a;return null!=(a=null==(t=e.projectSessionSettings.timelinePosition)?void 0:t.timelineScrollLeft)?a:0}),(e=>Wl(e)),((e,t,a,o)=>{if(!o)return[];return Object.values(e).filter((e=>{const[n,r]=zS(e,0),i=fI(o,n),s=fI(o,r),l=a+t;return a<=i&&i<=l||a<=s&&s<=l}))})),SI=new Map([["linear",{displayName:"Linear",x1:0,y1:0,x2:1,y2:1}],["ease-in",{displayName:"Ease In",x1:.42,y1:0,x2:1,y2:1}],["ease-out",{displayName:"Ease Out",x1:0,y1:0,x2:.58,y2:1}],["ease-in-out",{displayName:"Ease In & Out",x1:.25,y1:.1,x2:.25,y2:1}]]),II=(e,t)=>{if(!e)return null;const{startValues:a,endValues:o}=e,{topLeft:{x:n,y:r},bottomRight:{x:i}}=a,{topLeft:{x:s,y:l},bottomRight:{x:d}}=o,c=((e,t)=>{const{startTime:a,duration:o}=e,n=t-a,r=Math.min(n/o,1),i=SI.get(e.easingFuncID),{x1:s,y1:l,x2:d,y2:c}=i;return L(s,l,d,c)(r)})(e,t),u=[s-n,l-r].map((e=>e*c)),[m,p]=u;if(void 0===m||void 0===p)throw Error();const h={x:m+n,y:p+r},g=Math.abs(i-n),y=(Math.abs(d-s)-g)*c+g;return{topLeft:h,bottomRight:{x:h.x+y,y:h.y+y}}},xI=(e,t)=>{let a=e?{...e}:void 0;if(t){const{topLeft:{x:e,y:o},bottomRight:{x:n,y:r}}=t,i=100*(n-e),s=100*(r-o),l=100*e,d=100*o;if(a){const{x:e,y:t,width:o,height:n}=a;a={x:e+l/100*o,y:t+d/100*n,width:o*(i/100),height:n*(s/100)}}else a={x:l,y:d,width:i,height:s}}return a},kI=e=>!(!e||!e.keyframeAnimation)&&"moving-zoom"===e.keyframeAnimation.id,CI=e=>{var t;if(!kI(e))return null;const a=null==(t=e.keyframeAnimation)?void 0:t.transitions[0];return a?{...a}:null},AI=(e,t,a,o,n=!0)=>({type:"UPSERT_KEYFRAME",undoable:n,layerId:e,channel:t,time:a,value:o}),NI=(e,t,a,o=!0)=>({type:"REMOVE_KEYFRAME",undoable:o,layerId:e,channel:t,time:a}),PI=(e,t=!1,a=!0)=>({type:"TRIM_START_KEYFRAMES",maintainInterpolation:t,undoable:a,layerIdsToTimeChanges:e}),RI=(e,t=!1,a=!0)=>({type:"TRIM_END_KEYFRAMES",undoable:a,maintainInterpolation:t,layerIdsToMaxTimes:e}),LI=(e,t,a=!0)=>({type:"SET_KEYFRAMES",undoable:a,keyframesForChannels:t,layerId:e}),DI=(e,t,a,o=!0)=>({type:"SPLIT_KEYFRAMES",undoable:o,leftLayerId:e,rightLayerId:t,studioTime:a}),OI=(e,t,a,o)=>({type:"UNDO_SPLIT_KEYFRAMES",leftLayerId:e,rightLayerId:t,timeCorrection:a,insertedFrames:o}),FI=(e,t=!0)=>({type:"DELETE_LAYER_KEYFRAMES",undoable:t,layerId:e}),MI=(e,t,a=!0)=>({type:"SET_LAYER_CHANNELS",undoable:a,layerId:e,layerChannels:t}),UI=(e,t,a,o=!0)=>({type:"SHIFT_KEYFRAME_PLAYBACK_SPEED",undoable:o,layerId:e,oldPlaybackRate:t,newPlaybackRate:a}),BI=(e,t,a=!0)=>({type:"COPY_LAYER_KEYFRAMES",undoable:a,fromLayerId:e,toLayerId:t}),WI={name:"Moving Zoom",id:"moving-zoom",transitions:[{id:"moving-zoom-transition",easingFuncID:"linear",startValues:{topLeft:{x:0,y:0},bottomRight:{x:1,y:1}},endValues:{topLeft:{x:.15,y:.15},bottomRight:{x:.85,y:.85}}}]},VI=[WI],jI=(e,t,a)=>{const o=CI(e),n=II(o,t);if(a)return e.crop;return xI(e.crop,n)},GI=(e,t)=>{const{keyframeAnimation:a}=e,o=null==a?void 0:a.transitions[0];if(!a||!o)return null;const n={...o,...t};return{keyframeAnimation:{...e.keyframeAnimation,transitions:[n]}}},HI=Sn,zI=[HI.OPACITY,HI.BRIGHTNESS,HI.CONTRAST,HI.SATURATION,HI.BLUR],$I={[ln.Audio]:[],[ln.Image]:[HI.POSITION,HI.ZOOM,HI.ROTATION,...zI],[ln.Shape]:[HI.POSITION,HI.BACKGROUND,HI.OPACITY],[ln.Subtitle]:[],[ln.Text]:[HI.POSITION,HI.OPACITY],[ln.Video]:[HI.POSITION,HI.ZOOM,HI.ROTATION,...zI],[ln.Placeholder]:[]},KI=(e,t)=>{if(!($I[e.type]||[]).includes(t))return!1;const[a,o]=zS(e);return!!(o-a)&&!e.keyframeAnimation},YI=e=>{var t;const{state:a}=tn(),o=Object.values((null==(t=a.studio.keyframing)?void 0:t[e])||{});for(const n of o)if(n.keyframes.length>0)return!0;return!1},qI=(e,t,a=tn().state.studio.keyframing)=>{var o,n;return!!((null==(n=null==(o=null==a?void 0:a[e])?void 0:o[t])?void 0:n.keyframes)||[]).length},XI=e=>qI(e,Sn.POSITION)||qI(e,Sn.ZOOM)||qI(e,Sn.ROTATION),JI=e=>{if(!KI(e,Sn.POSITION))return;if(!e.position)return;const{dispatch:t,state:a}=tn(),{x:o,y:n}=_S(e,a.studio.width||0,a.studio.height||0),[r]=zS(e),i=ST()-r;cx(e.id,i,Sn.POSITION),t(AI(e.id,Sn.POSITION,i,{x:o,y:n}))},QI=e=>{if(!KI(e,Sn.ZOOM))return;const t=e.zoom||100,{dispatch:a}=tn(),[o]=zS(e),n=ST()-o;cx(e.id,n,Sn.ZOOM),a(AI(e.id,Sn.ZOOM,n,t))},ZI=e=>{var t,a,o;if(!KI(e,Sn.OPACITY))return;let n=null!=(a=null==(t=e.filters)?void 0:t.opacity)?a:100;"shape"!==e.type&&"text"!==e.type||(n=100*(null!=(o=e.globalAlpha)?o:1));const{dispatch:r}=tn(),[i]=zS(e),s=ST()-i;cx(e.id,s,Sn.OPACITY),r(AI(e.id,Sn.OPACITY,s,n))},ex=e=>{var t,a;if(!KI(e,Sn.BRIGHTNESS))return;const o=null!=(a=null==(t=e.filters)?void 0:t.brightness)?a:100,{dispatch:n}=tn(),[r]=zS(e),i=ST()-r;cx(e.id,i,Sn.BRIGHTNESS),n(AI(e.id,Sn.BRIGHTNESS,i,o))},tx=e=>{var t,a;if(!KI(e,Sn.CONTRAST))return;const o=null!=(a=null==(t=e.filters)?void 0:t.contrast)?a:100,{dispatch:n}=tn(),[r]=zS(e),i=ST()-r;cx(e.id,i,Sn.CONTRAST),n(AI(e.id,Sn.CONTRAST,i,o))},ax=e=>{var t,a;if(!KI(e,Sn.SATURATION))return;const o=null!=(a=null==(t=e.filters)?void 0:t.saturate)?a:100,{dispatch:n}=tn(),[r]=zS(e),i=ST()-r;cx(e.id,i,Sn.SATURATION),n(AI(e.id,Sn.SATURATION,i,o))},ox=e=>{var t,a;if(!KI(e,Sn.BLUR))return;const o=null!=(a=null==(t=e.filters)?void 0:t.blurPercent)?a:0,{dispatch:n}=tn(),[r]=zS(e),i=ST()-r;cx(e.id,i,Sn.BLUR),n(AI(e.id,Sn.BLUR,i,o))},nx=e=>{var t;if(!KI(e,Sn.BACKGROUND))return;const a=null!=(t=e.background)?t:"#000000",{dispatch:o}=tn(),[n]=zS(e),r=ST()-n;cx(e.id,r,Sn.BACKGROUND),o(AI(e.id,Sn.BACKGROUND,r,a))},rx=(e,t,a,o,n)=>{var r,i,s,l;if(!e.position)return{x:"0%",y:"0%",height:"0%",width:"0%",rotation:0};if(!t)return e.position;const d=(null==(r=t[Sn.POSITION])?void 0:r.keyframes)||[],c=(null==(i=t[Sn.ZOOM])?void 0:i.keyframes)||[],u=(null==(s=t[Sn.ROTATION])?void 0:s.keyframes)||[],m=!!d.length,p=!!c.length,h=!!u.length;if(!m&&!p&&!h)return e.position;const[g]=zS(e);let y,f=!1;if(m){f=!0;const o=(null==(l=t[Sn.POSITION])?void 0:l.bezArray)||null,{prevFrame:n,nextFrame:r}=Ub(e,a,d);if(r&&n){const t={...e.position,...n.value},i={...e.position,...r.value};let s=0,l=0;if(o){const e=M(...o),d=n.time,c=e((a-g-d)/(r.time-d)),u=parseFloat(i.x)-parseFloat(t.x),m=parseFloat(i.y)-parseFloat(t.y);s=u*c,l=m*c}y={...t,x:`${parseFloat(t.x)+s}%`,y:`${parseFloat(t.y)+l}%`}}else{const t=(null==r?void 0:r.value)||{},a=(null==n?void 0:n.value)||{};y={...e.position,...t,...a}}}return f||(y=_S(e,o,n)),y={...e.position,...y,...sx(e,t,a),...lx(e,t,a)},((e,t,a)=>{if(!e.position)return{x:"0%",y:"0%",height:"0%",width:"0%",rotation:0};if("ellipse"===e.shapeType)return e.position;const o=parseFloat(e.position.x)/100*t,n=parseFloat(e.position.y)/100*a,r=(o-parseFloat(e.position.width)/100*t/2)/t*100,i=(n-parseFloat(e.position.height)/100*a/2)/a*100;return{...e.position,x:`${r}%`,y:`${i}%`}})({...e,position:y},o,n)},ix=(e,t,a)=>{var o,n;const r=e.zoom||100;if(!t)return r;const i=(null==(o=t[Sn.ZOOM])?void 0:o.keyframes)||[],s=(null==(n=t[Sn.ZOOM])?void 0:n.bezArray)||null;if(!i.length)return r;const[l]=zS(e),{prevFrame:d,nextFrame:c}=Ub(e,a,i);let u=r;return u=d&&c?Bb(s,a-l,d,c):(null==d?void 0:d.value)||(null==c?void 0:c.value)||(null==e?void 0:e.zoom)||100,u},sx=(e,t,a)=>{var o;const n=s.exports.pick(e.position,["width","height"]);if(!t)return n;if(!((null==(o=t[Sn.ZOOM])?void 0:o.keyframes)||[]).length||!e.position)return n;const r=e.zoom||100,i=ix(e,t,a)/r;return{width:`${parseFloat(e.position.width)*i}%`,height:`${parseFloat(e.position.height)*i}%`}},lx=(e,t,a)=>{var o,n,r,i,s,l;const d={rotation:null!=(n=null==(o=e.position)?void 0:o.rotation)?n:0};if(!t)return d;const c=(null==(r=t[Sn.ROTATION])?void 0:r.keyframes)||[];if(!c.length||!e.position)return d;const u=(null==(i=t[Sn.ROTATION])?void 0:i.bezArray)||null,[m]=zS(e),{prevFrame:p,nextFrame:h}=Ub(e,a,c);return d.rotation=p&&h?Vb(u,a-m,p,h):null!=(l=null!=(s=null==p?void 0:p.value)?s:null==h?void 0:h.value)?l:d.rotation,d},dx=e=>{var t;return Object.values((null==(t=tn().state.studio.keyframing)?void 0:t[e])||{}).reduce(((e,t)=>e.concat(t.keyframes)),[]).sort(((e,t)=>e.time-t.time))},cx=(e,t,a)=>{var o,n,r;const{state:i}=tn();((null==(r=null==(n=null==(o=i.studio.keyframing)?void 0:o[e])?void 0:n[a])?void 0:r.keyframes)||[]).find((({time:e})=>t===e))||vc("Added Keyframe",{channel:a})},ux={[Sn.OPACITY]:ZI,[Sn.BRIGHTNESS]:ex,[Sn.CONTRAST]:tx,[Sn.SATURATION]:ax,[Sn.BLUR]:ox,[Sn.POSITION]:JI,[Sn.ZOOM]:QI,[Sn.BACKGROUND]:nx,[Sn.ROTATION]:e=>{var t,a;if(!KI(e,Sn.ROTATION))return;const o=null!=(a=null==(t=e.position)?void 0:t.rotation)?a:0,{dispatch:n}=tn(),[r]=zS(e),i=ST()-r;cx(e.id,i,Sn.ROTATION),n(AI(e.id,Sn.ROTATION,i,o))}};function mx(e,t,a=[0,0]){const[o,n]=e,[r,i]=a,s=t*Math.PI/180,l=Math.cos(s),d=Math.sin(s);return[r+(o-r)*l-(n-i)*d,i+(o-r)*d+(n-i)*l]}const px=(e,t=!1)=>{if(0===Object.keys(e).length)return;const{dispatch:a}=tn();t?Jl.execInUndoBatch((()=>{a(Lh(e,t))})):a(Lh(e,t))},hx=e=>{if(0===Object.keys(e).length)return;const{dispatch:t}=tn();Jl.execInUndoBatch((()=>{t({type:"UPDATE_LAYERS_CUSTOM_UNDO",updates:e})}))};function gx(e){var t,a;const{state:o}=tn(),n=(null==(t=o.studioLocal.layerTempValues[e.id])?void 0:t.positionTemp)||rx(e,null==(a=o.studio.keyframing)?void 0:a[e.id],ST(),o.studio.width||0,o.studio.height||0);if(!n)return null;const{canvasX:r,canvasY:i}=o.studio,s=o.studio.width,l=o.studio.height;if(void 0===r||void 0===i||void 0===s||void 0===l)return null;const{x:d,y:c,width:u,height:m,rotation:p=0}=n;let h=parseFloat(d),g=parseFloat(c),y=parseFloat(u),f=parseFloat(m);if(e.crop){const t=Math.sin(p*Math.PI/180),a=Math.cos(p*Math.PI/180),{width:o,height:n,x:r,y:i}=e.crop,d=100-r-o,c=100-i-n;y/=o/100,f/=n/100;const u=y*s/100,m=f*l/100,E=r*u/100,v=d*u/100,w=i*m/100,b=c*m/100,_={topLeft:{x:h*s/100,y:g*l/100},topRight:{x:h*s/100+u*o/100,y:g*l/100},bottomLeft:{x:h*s/100,y:g*l/100+m*n/100},bottomRight:{x:h*s/100+u*o/100,y:g*l/100+m*n/100},center:{x:h*s/100+u*o/200,y:g*l/100+m*n/200}};if(Object.keys(_).forEach((e=>{const t=e;if("center"===t)return;const[a,o]=mx(Object.values(_[t]),p,[_.center.x,_.center.y]);_[t].x=a,_[t].y=o})),0===p)h-=u*r/s,g-=m*i/l;else if(p<90){_.topLeft.y-=E*t+w*a,_.topLeft.x+=w*t-E*a,_.topRight.y+=v*t-w*a,_.topRight.x+=w*t+v*a,_.bottomLeft.y-=E*t-b*a,_.bottomLeft.x-=b*t+E*a,_.bottomRight.y+=v*t+b*a,_.bottomRight.x-=b*t-v*a,_.center.x=(_.topLeft.x+_.bottomLeft.x+_.bottomRight.x+_.topRight.x)/4,_.center.y=(_.topLeft.y+_.bottomLeft.y+_.bottomRight.y+_.topRight.y)/4;const e=[_.center.x,_.center.y],o=mx([_.topLeft.x,_.topLeft.y],-p,e);h=100*o[0]/s,g=100*o[1]/l}else if(90===p){_.topLeft.y-=r*u/100,_.topLeft.x+=i*m/100,_.topRight.y+=d*u/100,_.topRight.x+=i*m/100,_.bottomLeft.y-=r*u/100,_.bottomLeft.x-=c*m/100,_.bottomRight.y+=d*u/100,_.bottomRight.x-=c*m/100,_.center.x=(_.topLeft.x+_.bottomLeft.x+_.bottomRight.x+_.topRight.x)/4,_.center.y=(_.topLeft.y+_.bottomLeft.y+_.bottomRight.y+_.topRight.y)/4;const e=[_.center.x,_.center.y],t=mx([_.topLeft.x,_.topLeft.y],-p,e);h=100*t[0]/s,g=100*t[1]/l}else if(p<180){_.topLeft.y+=-E*t-w*a,_.topLeft.x+=w*t-E*a,_.topRight.y+=v*t-w*a,_.topRight.x+=w*t+v*a,_.bottomLeft.y+=-E*t+b*a,_.bottomLeft.x+=-b*t-E*a,_.bottomRight.y+=v*t+b*a,_.bottomRight.x+=-b*t+v*a,_.center.x=(_.topLeft.x+_.bottomLeft.x+_.bottomRight.x+_.topRight.x)/4,_.center.y=(_.topLeft.y+_.bottomLeft.y+_.bottomRight.y+_.topRight.y)/4;const e=[_.center.x,_.center.y],o=mx([_.topLeft.x,_.topLeft.y],-p,e);h=100*o[0]/s,g=100*o[1]/l}else if(180===p)h-=u*d/s,g-=m*c/l;else if(p<270){_.topLeft.y-=E*t+w*a,_.topLeft.x+=w*t-E*a,_.topRight.y+=v*t-w*a,_.topRight.x+=w*t+v*a,_.bottomLeft.y-=E*t-b*a,_.bottomLeft.x-=b*t+E*a,_.bottomRight.y+=v*t+b*a,_.bottomRight.x-=b*t-v*a,_.center.x=(_.topLeft.x+_.bottomLeft.x+_.bottomRight.x+_.topRight.x)/4,_.center.y=(_.topLeft.y+_.bottomLeft.y+_.bottomRight.y+_.topRight.y)/4;const e=[_.center.x,_.center.y],o=mx([_.topLeft.x,_.topLeft.y],-p,e);h=100*o[0]/s,g=100*o[1]/l}else if(270===p){_.topLeft.y+=r*u/100,_.topLeft.x-=i*m/100,_.topRight.y-=d*u/100,_.topRight.x-=i*m/100,_.bottomLeft.y+=r*u/100,_.bottomLeft.x+=c*m/100,_.bottomRight.y-=d*u/100,_.bottomRight.x+=c*m/100,_.center.x=(_.topLeft.x+_.bottomLeft.x+_.bottomRight.x+_.topRight.x)/4,_.center.y=(_.topLeft.y+_.bottomLeft.y+_.bottomRight.y+_.topRight.y)/4;const e=[_.center.x,_.center.y],t=mx([_.topLeft.x,_.topLeft.y],-p,e);h=100*t[0]/s,g=100*t[1]/l}else{_.topLeft.y+=-E*t-w*a,_.topLeft.x+=w*t-E*a,_.topRight.y+=v*t-w*a,_.topRight.x+=w*t+v*a,_.bottomLeft.y+=-E*t+b*a,_.bottomLeft.x+=-b*t-E*a,_.bottomRight.y+=v*t+b*a,_.bottomRight.x+=-b*t+v*a,_.center.x=(_.topLeft.x+_.bottomLeft.x+_.bottomRight.x+_.topRight.x)/4,_.center.y=(_.topLeft.y+_.bottomLeft.y+_.bottomRight.y+_.topRight.y)/4;const e=[_.center.x,_.center.y],o=mx([_.topLeft.x,_.topLeft.y],-p,e);h=100*o[0]/s,g=100*o[1]/l}}const{x:E,y:v}=JT(h,g,{height:l,width:s,x:r,y:i}),{width:w,height:b}=ZT(y.toString(),f.toString(),{height:l,width:s,x:r,y:i});return{x:E,y:v,width:w,height:b}}function yx(e){let t={width:100,height:100,x:0,y:0};const{crop:a,position:o,width:n=100,height:r=100}=e;a&&(t=a);const i={...t};if(!o)return;const s=cS(e),l=gx(e);if(!s)return;if(!l)return;const{width:d,height:c}=s,{width:u,height:m}=l,p=n/r;if(d/c<n*t.width/(r*t.height)){const e=m*p,t=i.width;i.width*=u/e;const a=t-i.width;i.x+=a/2}else{const e=u/p,t=i.height;i.height*=m/e;const a=t-i.height;i.y+=a/2}px({[e.id]:{crop:i}},!0)}function fx(e,t=!0){return{type:"SET_CANVAS_BLUR",value:e,undoable:t}}function Ex(e){return{type:"SET_SNAP_TO_GRID",value:e}}function vx(e){return{type:"SELECT_SAFEZONE",value:e}}function wx(e,t){return{color:e,type:"SET_STUDIO_BACKGROUND",undoable:t}}function bx(e){return{type:"SET_STUDIO_DIMENSIONS",dimensions:e}}function _x(){return{type:"SHOW_STUDIO_CANVAS"}}function Tx(e=!1){return{type:"SET_IMAGE_VIDEO",isImageVideo:e}}function Sx(e=0,t=!1){return{type:"SET_STUDIO_DURATION",duration:e,undoable:t}}function Ix(e){return{canvasDimensions:e,type:"SET_CANVAS_DIMENSIONS"}}const xx=e=>{const{canvasWidth:t,canvasHeight:a,maxHeight:o=350}=e;let n=320,r=n*a/t;const i=Al()?Math.min(o,300):o;return i&&i<=r&&(r=i,n=t*i/a),{canvasWidth:n,canvasHeight:r}},kx=(e,t)=>({type:"ADD_MAGIC_SUBTITLE",assetId:e,initialProperties:t,undoable:!0}),Cx=e=>({type:"REMOVE_MAGIC_SUBTITLE",assetId:e,undoable:!0}),Ax=({updates:e,assetId:t,undoable:a=!0})=>({type:"UPDATE_MAGIC_SUBTITLE",assetId:t,updates:e,undoable:a}),Nx=e=>{if("text"===e.type){const{fontFamily:t,asset_id:a,url:o}=e;if(t)return o&&a?{type:"custom",fontFamily:t,url:o,asset_id:a}:{type:"default",fontFamily:t}}if("subtitle"===e.type){const{fontFamily:t,url:a,asset_id:o}=e;if(t)return a&&o?{type:"custom",fontFamily:t,url:a,asset_id:o}:{type:"default",fontFamily:t}}return null};function Px(e){return`"${e}", Noto Sans, Apple Color Emoji, Noto Color Emoji`}function Rx(e,t){let a=Px(e.fontFamily);return(null==t?void 0:t.length)&&(a+=`, ${t.join(", ")}`),a}function Lx(e,t,a){const o=[];e.italic&&o.push("italic"),e.fontWeight&&o.push(e.fontWeight);const n=`${t}px/${null!=e.lineHeight?e.lineHeight:1}`;o.push(n),o.push(Rx(e,a));return o.join(" ")}const Dx=e=>[...new Set(e.getBlocksAsArray().flatMap((e=>e.getCharacterList().toArray().flatMap((e=>e.getStyle().toArray())))))],Ox=e=>{if(""===e.getPlainText())return[];const t=e.getBlocksAsArray();if(0===t.length)return[];const a=t.flatMap((e=>e.getCharacterList().toArray().flatMap((e=>e.getStyle())))),o=a[0];return o?o.intersect(...a).toArray():[]},Fx=(e,t)=>{const a=e=>{var t;return e.hasChildNodes()?Array.from(e.childNodes,a).flat(1):e instanceof Element?"BR"===e.tagName?[{text:"",css:{},position:W(e.getBoundingClientRect(),"top","left","right","bottom","width","height")}]:[]:e.nodeType===Node.TEXT_NODE&&null!=(t=(e=>{const t=e.textContent||"";if(e.nodeType!==Node.TEXT_NODE||null==e.parentElement||["\r\n","\n"].includes(t))return[];let a=e.parentElement;for(;!a.getAttribute("data-offset-key");){if(null==a.parentElement){a=e.parentElement;break}a=a.parentElement}const o=getComputedStyle(a),n={fontWeight:o.fontWeight,fontStyle:o.fontStyle,textDecoration:o.textDecoration,color:o.color},r=[],i=document.createRange();i.setStart(e,0),i.setEnd(e,1);let s,l=i.getBoundingClientRect();for(let c=2;c<=t.length;c+=1){i.setEnd(e,c);const t=i.getBoundingClientRect();if(l.bottom!==t.bottom){i.setEnd(e,c-1);const t={...W(i.getBoundingClientRect(),"top","left","right","bottom","width","height")};s=s||t.height,t.top=t.bottom-s,t.height=s,r.push({text:i.toString(),css:n,position:t}),i.setStart(e,c-1),i.setEnd(e,c),l=i.getBoundingClientRect()}}i.setEnd(e,t.length);const d={...W(i.getBoundingClientRect(),"top","left","right","bottom","width","height")};return s=s||d.height,d.top=d.bottom-s,d.height=s,r.push({text:i.toString(),css:n,position:d}),r})(e))?t:[]},o=a(t),n=e.getBoundingClientRect();return o.map((({position:e,...t})=>{const a={top:(e.top-n.top)/n.height,bottom:(e.bottom-n.top)/n.height,height:e.height/n.height,left:(e.left-n.left)/n.width,right:(e.right-n.left)/n.width,width:e.width/n.width};return{...t,text:t.text.replace(/\r\n/g,"").replace(/\n/g,""),position:B(a,(e=>gb(e,1e-4)))}}))},Mx=e=>e.startsWith("COLOR");function Ux(e){if(e.startsWith("COLOR"))return{color:e.slice("COLOR".length+1)}}const Bx=(e,t,a)=>{var o,n,r,i,s;const l=(e=>{const t=document.createElement("div"),a=e.getCurrentContent().getBlocksAsArray(),o={...V.DefaultDraftInlineStyle},n=Dx(e.getCurrentContent());for(const r of n)Mx(r)&&(o[r]=Ux(r));for(const r of a){const a=document.createElement("div");a.style.whiteSpace="pre-wrap";const n=r.getKey(),i=r.getText(),s=e.getBlockTree(n);for(const e of s.toArray()){const t=e.get("leaves");for(const e of t){const t=e.get("start"),n=e.get("end"),s=document.createElement("span");s.setAttribute("data-offset-key",String(t));for(const e of r.getInlineStyleAt(t).toArray())Object.assign(s.style,o[e]);s.textContent=i.slice(t,n).replace(/\r\n/g,""),a.appendChild(s)}}t.appendChild(a)}return t})(V.EditorState.createWithContent(V.convertFromRaw(t)));Object.assign(l.style,{font:Lx(e,a,e.fallbackFonts),fontSize:a,width:`${null==(o=e.position)?void 0:o.pixel_width}px`,height:`${null==(n=e.position)?void 0:n.pixel_height}px`,textAlign:null!=(r=e.textAlign)?r:"initial",textTransform:null!=(i=e.textTransform)?i:"none",color:e.color,textDecoration:e.underline?"underline":"none",alignItems:"center"});const d=null==(s=e.textAlign)?void 0:s.toLowerCase();"left"===d?l.style.justifyContent="flex-start":"right"===d&&(l.style.justifyContent="flex-end");const c=document.createElement("div");c.style.display="flex",c.style.position="absolute",c.style.left="10000px",c.appendChild(l),document.body.appendChild(c);try{return Fx(l,l)}finally{c.remove()}};const Wx=(e,t,a,o)=>{const n=t.borderRadius?parseFloat(t.borderRadius.relative):0;if(Gx(t.position.pixel_width,t.position.pixel_height,n))jx(e,t.position.pixel_width/2,t.position.pixel_height/2,t.position.pixel_width/2,a,o);else{const r=n/100*(t.position.pixel_width<t.position.pixel_height?t.position.pixel_width:t.position.pixel_height);Vx(e,t,t.position.pixel_width,t.position.pixel_height,r,a,o)}e.clip()},Vx=(e,t,a,o,n,r,i)=>{e.beginPath(),r&&(e.lineWidth=r,e.strokeStyle=i),e.moveTo(n,0),e.lineTo(a-n,0),e.arcTo(a,0,a,n,n),e.lineTo(a,o-n),e.arcTo(a,o,a-n,o,n),e.lineTo(n,o),e.arcTo(0,o,0,o-n,n),e.lineTo(0,n),e.arcTo(0,0,n,0,n),"dropShadow"===t.imageEffect&&(!function(e,t){const a=t.imageShadowDist||0,o=(t.imageShadowRot||0)*Math.PI/180,n=100*a*Math.cos(o),r=100*a*Math.sin(o);e.shadowOffsetX=n,e.shadowOffsetY=r,e.shadowColor=t.imageEffectColor,e.shadowBlur=50*t.imageShadowBlur}(e,t),e.fill()),e.closePath(),r&&e.stroke()},jx=(e,t,a,o,n,r)=>{e.beginPath(),n&&(e.lineWidth=n,e.strokeStyle=r),e.arc(t,a,o,0,2*Math.PI),e.closePath(),n&&e.stroke()},Gx=(e,t,a)=>e/t>=.98&&e/t<=1.02&&a>=49;function Hx(e,t,a,o,n,r){const i=t+o,s=a+n;e.moveTo(t+r,a),e.lineTo(i-r,a),e.arcTo(i,a,i,a+r,r),e.lineTo(i,s-r),e.arcTo(i,s,i-r,s,r),e.lineTo(t+r,s),e.arcTo(t,s,t,s-r,r),e.lineTo(t,a+r),e.arcTo(t,a,t+r,a,r)}function zx(e,t,a,o,n){o&&(e.moveTo(t,a+o),e.arcTo(t,a,t-o,a,o),e.lineTo(t,a),e.lineTo(t,a+o)),n&&(e.moveTo(t,a+n),e.arcTo(t,a,t+n,a,n),e.lineTo(t,a),e.lineTo(t,a+n))}function $x(e,t,a,o,n){o&&(e.moveTo(t,a-o),e.arcTo(t,a,t-o,a,o),e.lineTo(t,a),e.lineTo(t,a-o)),n&&(e.moveTo(t,a-n),e.arcTo(t,a,t+n,a,n),e.lineTo(t,a),e.lineTo(t,a-n))}function Kx(e,t){if(!e.textOutline)return 0;return.3*t*(.01*e.textOutline.width)}function Yx(e,t,a){const o=document.createElement("span"),n=document.createElement("div"),r=document.createElement("div");n.style.display="inline-block",n.style.width="1px",n.style.height="0",n.style.verticalAlign="baseline",r.style.visibility="hidden",r.style.position="absolute",r.style.top="0",r.style.left="0",r.style.whiteSpace="nowrap",o.style.whiteSpace="nowrap",o.style.font=Lx(e,t,e.fallbackFonts),a&&(o.style.lineHeight=`${a}px`),o.textContent=e.text.replace(/\s/g,String.fromCharCode(160)),r.appendChild(o),r.appendChild(n),document.body.appendChild(r);const{offsetTop:i}=n,{height:s}=o.getBoundingClientRect();return r.remove(),{baseline:i,height:s}}function qx({ctx:e,lines:t,pxCap:a}){let o=[];const n=" ",r=e.measureText(n).width;let i,s;return t.filter((e=>e&&e.length)).forEach((t=>{i="",s=0;t.split(n).forEach((t=>{let{width:l}=e.measureText(t);if(l>a){s&&o.push([i,s]);const n=((e,t,a)=>{const o=t.split(""),n=[];let r="",i=0;return o.forEach((t=>{const{width:o}=e.measureText(t);i+o>a?(i&&n.push([r,i]),r=t,i=o):(r+=t,i+=o)})),i&&n.push([r,i]),n})(e,t,a),r=n.pop();return[i,s]=r,void(o=[...o,...n])}s+r+l>a?(s&&o.push([i,s]),i="",s=0):s&&""!==t&&(i+=n,s+=r),""===t&&(t=n,l=r),i+=t,s+=l})),s&&o.push([i,s])})),o}function Xx(e,t,a,o,n,r){let i;switch(r.textEffect){case"dropShadow":{e.save();const s=r.textShadowDist*n,l=r.textShadowRot*(Math.PI/180),d=s*Math.cos(l),c=s*Math.sin(l);i=`blur(${r.textShadowBlur*n/2}px)`,e.filter="none"===e.filter?i:i+e.filter,e.fillStyle=r.textEffectColor,e.fillText(t,a+d,o+c),r.underline&&Jx(e,t,a+d,o+c,n,r),e.restore();break}case"textBlur":{const{textBlurTemp:t,textBlur:a}=r;i=`blur(${.2*+n*+(t||a||.2)}px)`,e.filter=e.filter&&"none"!==e.filter?i+e.filter:i;break}}}function Jx(e,t,a,o,n,r,i=0){e.save();const s=e.measureText(t).width+i,l=.004*(e.canvas.clientHeight||e.canvas.height);switch(e.textAlign){case"center":a-=s/2;break;case"right":a-=s}e.beginPath(),e.strokeStyle=r.textShadow,e.lineWidth=Math.max(2,l),e.lineJoin="round";const d=.05*n;e.strokeRect(a,o+d,s,n/10),e.rect(a,o+d,s,n/10),e.fill(),e.restore()}function Qx(e,t,a,o,n,r,i){var s;if(null==i?void 0:i.backgroundColor){const l=t.strokeStyle;t.fillStyle=i.backgroundColor,t.strokeStyle="transparent";const{width:d}=t.measureText(a.text),c=t.measureText(e.wordSeparator).width/2,u=r*e.lineHeight,m=u/5,p=30,h=Math.min(1,Math.floor(e.fontSize/p));!function(e,t,a,o,n,r){const i=Math.min(o,n)/2*.95,s=Math.min(r,i);e.beginPath(),Hx(e,t,a,o,n,s),e.stroke(),e.fill()}(t,Math.floor(o-c)-h,n-u+m-parseFloat((i.bottom||0).toString())*r,Math.ceil(d+2*c)+h,u,parseFloat((null==(s=i.borderRadius)?void 0:s.toString())||"0")*r),t.strokeStyle=l}const l=o;let d=n;return(null==i?void 0:i.bottom)&&(d-=parseFloat(i.bottom.toString())*r),t.fillStyle=(null==i?void 0:i.color)||e.color,"none"===i.textShadow?t.strokeStyle="transparent":t.strokeStyle=i.textShadow||e.textShadow,{...i,x:l,y:d}}const Zx=Intl&&Intl.Segmenter,ek=j.exports.memoize((e=>{if(Zx)try{return[...(new Intl.Segmenter).segment(e)].map((e=>e.segment))}catch(YEe){console.error("safeSplitText error",YEe)}return[...e]}));const tk=(e,t,a)=>{const o=ek(e.text),n=[];let r,i,s=t||0;return o.forEach(((o,l)=>{var d;const c=null==(d=e.styles)?void 0:d[l],u=!!(a&&void 0!==t&&a.cleanSelectionStart<=s&&a.cleanSelectionEnd>s);if(u||0===l||!function(e,t){if(!e||!t)return e===t;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const a of Object.keys(e)){if("index"===a)continue;const o=a;if(e[o]!==t[o])return!1}return!0}(c,r)||i!==u)n.push({isSelected:u,text:o,styles:c});else{const e=n[n.length-1];e&&(e.text+=o)}r=c,i=u,s+=o.length})),n},ak=(e,t,a)=>{let o={index:-1};return!!t&&!!a&&(Object.keys(a).forEach((e=>{const n=e;n in a&&a[n]===t[n]&&(o={...o,[n]:a[n]})})),!e.underline||"none"!==a.textDecoration&&"none"!==t.textDecoration||(o.textDecoration="none")),e.underline&&"none"!==o.textDecoration&&(o.textDecoration="underline"),o};function ok(e,t){const a={...e};return"italic"===(null==t?void 0:t.fontStyle)?a.italic=!0:"normal"===(null==t?void 0:t.fontStyle)&&(a.italic=!1),"bold"===(null==t?void 0:t.fontWeight)?a.fontWeight="bold":"normal"===(null==t?void 0:t.fontWeight)&&(a.fontWeight="normal"),a}function nk(e,t,a,o,n,r,i){const{textOutline:s}=n;if(s&&"rgba(-255,-255,-255,0)"!==s.color&&"none"!==(null==i?void 0:i.textShadow)){const i=Kx(n,r);if(i){const n=e.strokeStyle,r=e.lineWidth,l=e.lineJoin;e.strokeStyle=s.color,e.lineWidth=i,e.lineJoin="miter",e.strokeText(t,a,o),e.strokeStyle=n,e.lineWidth=r,e.lineJoin=l}}e.strokeText(t,a,o),e.fillText(t,a,o)}function rk(e,t,a,o){var n;const r=a.position.pixel_width,i=a.position.pixel_height;t.textBaseline="alphabetic",t.textAlign="left";for(const{text:s,css:l,position:d}of e){const e=null==(n=l.textDecoration)?void 0:n.toString().includes("underline"),c={...a,text:s,textWithLineBreaks:s,fontSize:o,lineHeight:1,underline:e,italic:"italic"===l.fontStyle,fontWeight:l.fontWeight},u=Lx(c,o,a.fallbackFonts);t.font=u,t.fillStyle=l.color;const m=d.left*r,p=d.height*i,{baseline:h}=Yx({...c,lineHeight:"normal"},o,p),g=d.bottom*i-(p-h);a.textEffect&&Xx(t,s,m,g,o,c),e&&Jx(t,s,m,g,o,c),nk(t,s,m,g,c,o)}}const ik=e=>{let t=[];t=e.replace(/\r?\n|\r/g,"\n").split(/(\n)/);return t.filter((function(e){return""!==e})).filter((function(e,t,a){return 0===t||!("\n"===e&&"\n"!==a[t-1])}))};function sk(e,t,a=null,o=null,n=null,r=null){const i=a||t.position.pixel_width,s=o||t.position.pixel_height;if(i<=0||s<=0)return;let l="0%";n?l=n:t.borderRadius&&t.borderRadius.relative&&(l=t.borderRadius.relative);const d=parseFloat(l)/100*Math.min(i,s),c=(r||t.textPadding||0)*Math.min(i,s)/100,u=2*c,m=document.createElement("canvas");m.width=i+u,m.height=s+u;const p=m.getContext("2d");p.beginPath(),p.rect(0,0,m.width,m.height),p.clip(),p.beginPath(),Hx(p,0,0,m.width,m.height,d),p.lineWidth=1,p.strokeStyle=t.backgroundColor,p.stroke(),p.fillStyle=t.backgroundColor,p.fill(),m.width>0&&m.height>0&&e.drawImage(m,-c,-c,m.width,m.height)}function lk(e,t,a){return Math.max(e,Math.min(a,t))}function dk(e,t,a,o,n=null,r=null,i=null,s=null,l=null,d=null){var c,u;const m=n||o.position.pixel_width,p=r||o.position.pixel_height;if(m<=0||p<=0)return;const h=o.textAlign,g="left"===h,y="right"===h,f=null!=(c=o.lineHeight)?c:1,E=i||f*a,v=null!=(u=null!=d?d:o.textPadding)?u:0,w=v*E/100,b=2*w;let _=s||Math.max(0,(p-E*t.length)/2);const T=document.createElement("canvas");T.width=m+b,T.height=p+b;const S=T.getContext("2d");S.beginPath(),S.rect(0,0,T.width,T.height),S.clip();let I=0;null!==l?I=parseFloat(l)/100:void 0!==o.borderRadius&&o.borderRadius.relative&&(I=parseFloat(o.borderRadius.relative)/100);const x=I*E,k=x+x;let C=t;const A=(e,t)=>{var a;const o=null!=(a=C[t-1])?a:0;let n=e;if(t>0){Math.abs(o-e)<k&&(n=Math.max(o,e))}return n};function N(e){var t;const a=null!=(t=C[e])?t:m-2,o=Math.min(m-2,a);let n=0;switch(h){case"right":n=m-o-1;break;case"center":n=(m-o)/2}return{x:n,w:o}}let P;C=t.map(A).reverse(),C=C.map(A).reverse();let R=1;const L=cp(o.backgroundColor);function D(){S.lineWidth=1,S.strokeStyle=P,S.stroke(),S.fillStyle=P,S.fill(),S.beginPath()}L?(R=L.a,P=`rgb(${L.r}, ${L.g}, ${L.b})`):P=o.backgroundColor,S.beginPath();const O=I+v/100;let F=x;O>.5&&(F=x-E*(O-.5));for(let M=0;M<t.length;M++){const{x:e,w:a}=N(M);if(Hx(S,e,_,a+b,E+b,x),D(),M>0){const{x:t,w:o}=N(M-1);let n=o>a+x+x;(y||g)&&(n=o>a+x),zx(S,e,_+b-(g||o===a?w:0),g?0:lk(0,e-(t+x),F),g||n||o===a?x:0),D(),zx(S,e+a+b,_+b-("right"===h||o===a?w:0),y||n||o===a?x:0,y?0:lk(0,t+o-x-(e+a),F)),D()}if(M<t.length-1){const{x:t,w:o}=N(M+1);let n=o>a+x+x;(y||g)&&(n=o>a+x),$x(S,e,_+E+("left"===h||o===a?w:0),g?0:lk(0,e-(t+x),F),g||n||o===a?x:0),D(),$x(S,e+a+b,_+E+("right"===h||o===a?w:0),y||n||o===a?x:0,y?0:lk(0,t+o-x-(e+a),F)),D()}D(),_+=E}if(T.width>0&&T.height>0){const t=e.globalAlpha;e.globalAlpha=R*e.globalAlpha,e.drawImage(T,-w,-w,T.width,T.height),e.globalAlpha=t}}async function ck(e,t,a,o,n){var r,i,s;if(!t.text)return;e.save();const l=Number(t.fontSize||0)*o;e.font=Lx(t,l),document.fonts.check(e.font)||console.error(`Font '${e.font}' not loaded, output may not have correct fidelity`),e.textAlign="left",e.textBaseline="alphabetic";const d=t.position.pixel_width,c=.004*(e.canvas.clientHeight||e.canvas.height);e.strokeStyle=t.textShadow||"transparent",e.lineWidth=Math.max(2,c),e.lineJoin="round";const{xPos:u,yPos:m}=zb(t,{animations:n},a,e.canvas.clientWidth||e.canvas.width,e.canvas.clientHeight||e.canvas.height),p=u+t.position.pixel_width/2,h=m+t.position.pixel_height/2;e.translate(p,h),(null==(r=t.position)?void 0:r.rotation)&&e.rotate(t.position.rotation*Math.PI/180),e.translate(-p,-h),e.translate(u,m),e.globalAlpha=t.globalAlpha;const g=Db(t,n);g&&g.opacity&&(e.globalAlpha=Kb(t,g,a).opacity/100);let y=null;Lb(t,n)&&(y=((e,t)=>Ob(e,t).find((({animationName:e,wordByWordStyles:t})=>!!t&&e!==dn.None))||null)(t,n),await Fb(n,t,e,a,l)),e.fillStyle=t.color;const f="uppercase"===t.textTransform?e=>e.toLocaleUpperCase():"lowercase"===t.textTransform?e=>e.toLocaleLowerCase():e=>e;t.text=f(t.text),t.textBlocks=null==(i=t.textBlocks)?void 0:i.map((e=>({...e,text:f(e.text)}))),"frame"in t&&t.frame&&(t.frame.lines=null==(s=t.frame.lines)?void 0:s.map((e=>({...e,words:e.words.map((e=>({...e,text:f(e.text)})))}))));const E=t.text||"",v=t.textWithLineBreaks||"",w=!!v&&function(e,t){return e.replace(/[\s\n]/g,"")===t.replace(/[\s\n]/g,"")}(E,v),b=qx({ctx:e,lines:ik(w?v:E)||[],pxCap:w?Number.MAX_SAFE_INTEGER:d});if(t.backgroundColor&&"rgba(-255,-255,-255,0)"!==t.backgroundColor)if("wrap"===t.wrapOrFill){dk(e,b.map((([e,t])=>t)),l,t)}else sk(e,t);if("isRTL"in t&&t.isRTL&&(e.direction="rtl"),t.textBlocks)rk(t.textBlocks,e,t,l);else if(t.draftJSTextTree){t.draftJSTextTree.blocks.forEach((e=>{e.text=f(e.text)}));rk(Bx(t,t.draftJSTextTree,l),e,t,l)}else"frame"in t&&t.frame?function(e,t,a,o,n,r){const{frame:i}=a;if(!i)return;let s=i;a.isRTL&&(s={...i,lines:i.lines.map((e=>({...e,words:[...e.words].reverse()})))}),t.font=Lx(a,o);const l=a.position.pixel_width,d=a.position.pixel_height,c=(a.lineHeight||1)*o,u=d/2-c*e.length/2;if(l<=0||d<=0)return;const{wordByWordStyles:m,animationName:p}=r||{},{active:h,spoken:g,unspoken:y,inactive:f}=m||{};s.lines.forEach(((r,i)=>{const s=e[i];if(!s)return;const[,d]=s,m=[];let E=0,v=0;switch(a.textAlign){case"center":E=(l-d)/2;break;case"right":E=l-d;break;default:E=0}const w=E;v=u+c*i+Yx(a,o,c).baseline,r.words.forEach(((e,i)=>{var s,l,d,c;const u=n<e.start,b=n>=e.start,_=p&&n>=e.start&&n<e.end;let T={};!_&&(T={...T,...f}),u&&(T={...T,...y}),b&&(T={...T,...g}),_&&(T={...T,...h});const{x:S,y:I}=Qx(a,t,e,E,v,o,T),x=i+1===r.words.length;let k=S,C="";const A=tk(e);if(a.isRTL&&A.reverse(),A.forEach((e=>{t.save();const n=e.styles,r=ok(a,n);if((null==n?void 0:n.color)&&((!_||_&&!(null==h?void 0:h.color))&&(t.fillStyle=n.color),u&&"transparent"===(null==y?void 0:y.color)&&(t.fillStyle="transparent")),t.font=Lx(r,o),a.textEffect&&Xx(t,e.text,S,I,o,r),a.underline&&"none"!==(null==n?void 0:n.textDecoration)||"underline"===(null==n?void 0:n.textDecoration)){const n=.5;Jx(t,e.text,k,I,o,a,n)}nk(t,e.text,k,I,a,o,T),C+=e.text,k+=t.measureText(e.text).width,t.restore()})),!x&&a.wordSeparator){t.save();const n=i+1,m=r.words[n],p=a.isRTL?(null!=(l=null==(s=null==m?void 0:m.text)?void 0:s.length)?l:1)-1:0,h=null==(d=null==m?void 0:m.styles)?void 0:d[p],g=a.isRTL?0:e.text.length-1,f=null==(c=e.styles)?void 0:c[g],E=ak(a,f,h),w=ok(a,E);if(t.font=Lx(w,o),_&&(t.fillStyle=E.color||a.color),(null==E?void 0:E.color)&&(t.fillStyle=E.color),u&&"transparent"===(null==y?void 0:y.color)&&(t.fillStyle="transparent"),"underline"===(null==E?void 0:E.textDecoration)){const e=.5;Jx(t,a.wordSeparator,k,v,o,a,e)}t.strokeText(a.wordSeparator,k,I),t.fillText(a.wordSeparator,k,I),C+=a.wordSeparator,k+=t.measureText(a.wordSeparator).width,t.restore()}m.push(C);const N=m.join("");E=w+t.measureText(N).width}))}))}(b,e,t,l,a,y):function(e,t,a,o,n=null,r=null){var i,s,l,d;const c=n||a.position.pixel_width,u=r||a.position.pixel_height;if(c<=0||u<=0)return;const m=(a.lineHeight||1)*o,p=u/2-m*e.length/2;for(let h=0;h<e.length;h++){const n=null!=(s=null==(i=e[h])?void 0:i[0])?s:"",r=null!=(d=null==(l=e[h])?void 0:l[1])?d:0;let u;switch(a.textAlign){case"center":u=(c-r)/2;break;case"right":u=c-r;break;default:u=0}const g=p+m*h+Yx(a,o,m).baseline;a.textEffect&&Xx(t,n,u,g,o,a),a.underline&&Jx(t,n,u,g,o,a),nk(t,n,u,g,a,o)}}(b,e,t,l);e.restore()}const uk=/[\uFFE5\u3000-\u303F!.,:?;\x3F@\x5B-\x5D_\x7B}\u00A1\u00A7\u00AB\u00B6\u00B7\u00BB\u00BF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u0AF0\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166D\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E3B\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]$/,mk=e=>uk.test(e),pk=[".","!","?"];const hk=(e,t)=>!!t&&(!!function(e){return!!e.startsWith("en")||"es"===e||"fr"===e}(t)&&pk.some((t=>e.endsWith(t)))),gk=!(!Intl||!Intl.Segmenter);function yk(e){let t=0,a=0;for(const o of e)Ek(o)||(o.includes(" ")?t+=1:a+=1);return t/(t+a)>.1?" ":""}function fk(e){const t=Qi.get(e);if(!t)return" ";const{noSpaces:a}=t;return a?"":" "}const Ek=e=>/^[^\S\n]*$/.test(e);function vk({cursorIndex:e=0,locale:t,text:a}){var o;if(!t||!gk)return function({text:e,cursorIndex:t}){const a=e.split(/(\s)/g).filter((e=>""!==e)),o=[];for(const s of a){const e=o[o.length-1];"\n"===s&&(e?o[o.length-1]+="\n":o.push("\n")),wk(s)||(e&&Array.from(e).every((e=>"\n"===e))?o[o.length-1]+=s:o.push(s))}let n=0===t?-1:0;const r=o[0];if(void 0===r)return{segments:[],cursorSegmentIndex:n};let i=r.length+1;for(;i<t&&!(n>=o.length-1);){n+=1;const e=o[n];if(void 0===e||wk(e))break;i+=e.length+1}return{segments:o,cursorSegmentIndex:n}}({cursorIndex:e,text:a});const n=function({locale:e,text:t}){const a=new Intl.Segmenter(e,{granularity:"word"}).segment(t),o=[];let n="",r=!1;function i(){for(let e=o.length-1;e>=0;e--){const t=o[e];if(t&&!Ek(t))return e}return-1}function s(){if(n.length>0){if(Array.from(n).every((e=>"\n"===e))){const e=i(),t=o[e];if(!t)return;o[e]=t+n}else o.push(n);n=""}}for(const{segment:l,isWordLike:d}of a){if(!d&&Ek(l)){s(),o.push(l);continue}const e=d&&!r||n.endsWith("\n")&&"\n"!==l,t=!Array.from(n).every((e=>"\n"===e));e&&t&&s(),n+=l,r=!d&&"\n"!==l}return s(),o}({locale:t,text:a}),r=[],i=[];for(const c of n)if(Ek(c)){void 0!==i[i.length-1]&&(i[i.length-1]+=c)}else r.push(c),i.push(c);let s=0===e?-1:0;const l=i[0];let d=null!=(o=null==l?void 0:l.length)?o:0;for(;d<e&&!(s>=i.length-1);){s+=1;const e=i[s];if(void 0===e)break;d+=e.length}return{segments:r,cursorSegmentIndex:s}}const wk=e=>null!==e.match(/\s/);const bk=16,_k=e=>e?mk(e.word)?.5:1:.5;function Tk({languageCode:e,maxCharsPerSubtitle:t,separator:a,words:o}){const n=[];function r(o){const r=o[0];if(!r)return;let i=[o];const s=n[n.length-1],l=s?s.flat():[],d=l[l.length-1];if(s&&d){const c=mk(d.word),u=l.length>1,m=r.start_time-d.end_time>_k(d);if(u&&!c&&!m){const r=s.flat(),l=o.flat();for(let e=r.length-1;e>=0;e-=1){const t=r[e];if(!t)throw Error("Missing left word");if(mk(t.word))break;r.splice(e,1);if(r.map((e=>e.word)).join(a).length<=[t,...l].map((e=>e.word)).join(a).length){r.push(t);break}l.unshift(t)}const[d]=Tk({languageCode:e,words:r,maxCharsPerSubtitle:t,separator:a});d&&(n[n.length-1]=d);i=Tk({languageCode:e,words:l,maxCharsPerSubtitle:t,separator:a})}}n.push(...i)}let i=[];const l=[...o],d=l.length;for(;l.length>0;){if(l.length>d)throw Error();const o=l.shift();if(!o)throw Error();const n=i.flat(),c=n[n.length-1],u=c?c.end_time:0;let m=!1;const p=o.start_time-u>_k(c),h=n.length>4&&c&&hk(c.word,e);(p||h)&&(m=!0);[...i,o].map((e=>e.word)).join(a).length>t&&(m=!0);let g=!0;if(m&&i.length){let d=i;if(!(!!c&&mk(c.word))){if(n.some((e=>mk(e.word)))){const r=s.exports.findLastIndex(n,(e=>mk(e.word))),i=n.slice(0,r+1),c=[...n.slice(r+1),o],[u]=Tk({languageCode:e,words:i,maxCharsPerSubtitle:t,separator:a});u&&(d=u),l.unshift(...c),g=!1}}r(d),i=[]}g&&i.push(o)}return i.length>0&&r(i),n}const Sk={backgroundColor:"rgba(0, 0, 0, 0.6)",backgroundOpacity:.6,backgroundStyle:"wrap",fixedPosition:.95,font:"Arial",fontColor:"#ffffff",fontSize:18,fontSizeRatio:.05625,fontStyle:"normal",fontWeight:"bold",lineHeight:1.2,lineWidth:0,textAlign:"center",textTransform:"none",textShadow:"#000000",textVerticalAlign:"bottom",updateSubtitlePosition:"8b2d8a0b-5a7c-43bc-82c2-17aab67d96c1"};function Ik(e,t){const{id:a,duration:o}=t;if(void 0===o)throw Error("Cannot transcribe asset with no duration");const n={id:a,asset_id:t.asset_id,type:"video",videoDelay:0,startTime:0,endTime:o,duration:o,url:t.url};return{_id:e,isStudio:!0,scenes:[{background:"#ffffff",duration:o,id:y(),layers:[n],subtitle:Sk,userSelectedDuration:0,userSetDuration:!1}],duration:o}}function xk(e,t,a){const{fontSize:o,lineHeight:n}=e,r=t.reduce(((e,t)=>Math.max(e,t.width)),0),i=t.length,s=o*i+(n-1)*o*i,{y:l}=a,d=Math.max(r-a.width,0);let c=a.x-d/2,u=Math.max(r,a.width);return u+=.5,c+=.25,{x:c,y:l,xDiff:d,width:u,height:s,rotation:a.rotation}}function kk(e,t){return e.reduce(((e,a)=>{const o=a[0],n=a[a.length-1];if(!o||!n)throw Error("Empty frame");const r=y();return{...e,[r]:{id:r,words:a.flat(1).map((e=>"simple"===t?{text:e.word,styles:e.styles}:{end:e.end_time,start:e.start_time,text:e.word,styles:e.styles})),start:o.start_time,end:n.end_time}}}),{})}function Ck(e){const t=yk(e.map((e=>e.text)));return e.reduce(((e,a)=>{const o=a.text.split(t).map((e=>({text:e}))),n=y();return e[n]={id:n,start:a.start,end:a.end,words:o},e}),{})}const Ak=.1,Nk=.08,Pk=45,Rk={};function Lk(e,t,a,o){const n=`${e}_${a}_${o}_${(e=>JSON.stringify(e))(t)}`;if(!Rk[n]){if(Object.keys(Rk).length>=5){const e=Object.entries(Rk).sort(((e,t)=>e[1].lastUpdated-t[1].lastUpdated))[0];if(e){const[t]=e;delete Rk[t]}}Rk[n]={lastUpdated:Date.now(),wordSizer:new Dk(t,a)}}const r=Rk[n];if(!r)throw Error("Missing cached");return r.lastUpdated=Date.now(),r.wordSizer}class Dk{constructor(e,t){a(this,"widths",new Map),a(this,"contexts",new Map),a(this,"textHeight"),this.style=e,this.scaledFontSize=t,this.textHeight=this.scaledFontSize*this.style.lineHeight}initalizeCtx(e){const t=document.createElement("canvas");t.width=800,t.height=500;const a=t.getContext("2d");if(!a)throw Error("Missing ctx");const o=[e,`${this.scaledFontSize}px`,Px(this.style.fontFamily.fontFamily)].filter((e=>!!e)).join(" ");return a.font=o,a}getCtx(e){const t=this.getWordStyleKey(e);if(!this.contexts.has(t)){const e="bold"===t?"bold":"normal";this.contexts.set(t,this.initalizeCtx(e))}const a=this.contexts.get(t);if(!a)throw Error("Missing ctx");return a}measureWord(e){return this.getCtx(e).measureText(this.getWordText(e)).width}getWordStyleKey({text:e,styles:t}){var a;if(Object.values(t||{}).some((e=>"bold"===e.fontWeight)))return"bold";if(t){let o=!0;for(let n=0;n<e.length;n++)"\n"!==e[n]&&(o=o&&"normal"===(null==(a=t[n])?void 0:a.fontWeight));if(o)return"normal"}return this.style.fontWeight}getWordText(e){return" "===e.text?" ":e.text.trim()}getWidth(e){var t;const a=`${this.getWordText(e)} ${this.getWordStyleKey(e)}`;let o=e;return"uppercase"===this.style.textTransform?o={...e,text:e.text.toUpperCase()}:"lowercase"===this.style.textTransform&&(o={...e,text:e.text.toLowerCase()}),this.widths.has(a)||this.widths.set(a,this.measureWord(o)),null!=(t=this.widths.get(a))?t:0}}const Ok="/assets/waveform.86d6820a.png";function Fk({asset:e,fallback:t,timelineLayer:a,uploadingLayer:o,cmlFile:n}){return n&&n.fileName?n.fileName:e&&e.name?e.name:o&&o.name?o.name:(null==a?void 0:a.name)?a.name:e&&e.blob_name?e.blob_name:t}function Mk({asset:e,uploadingLayer:t}){var a;return e&&e.metadata_stage&&"number"==typeof e.duration?e.duration:t&&"image"!==t.type&&null!=(a=t.duration)?a:null}function Uk({asset:e,framePercentage:t=0,idbAsset:a,timelineLayer:o}){var n,r;if(e&&(null==(n=e.content_type)?void 0:n.startsWith("audio")))return"/assets/waveform.86d6820a.png";const i=null==o?void 0:o.type;if(e&&e.url&&((null==(r=e.content_type)?void 0:r.startsWith("image"))||"image"===i)&&!e.conversion_id)return e.url;if(e&&e.metadata_stage&&e.thumbnails){const a=Math.round(t*(e.thumbnails.length-1)),o=e.thumbnails[a];if(o)return function(e,t={}){const{bucket:a=Or}=t;return a===Or?`${Ur}/${e}`:`https://cdn.kapwing.com/${e}`}(o,{bucket:e.bucket_name})}return a&&"thumbnail"in a&&a.thumbnail?URL.createObjectURL(a.thumbnail):e&&e.pasted_link_thumbnail?e.pasted_link_thumbnail:null}function Bk(e){var t;return(null==(t=e.original_asset)?void 0:t.asset_id)||e.asset_id}const Wk=(e,t)=>{const{hasMagicSubtitle:a,shortRowCount:o,subtitleRowCount:n,tallRowCount:r}=e;return 30*o+60*r+30*(n+(a?1:0))+(t?25:0)+10},Vk=(e,t,a)=>{var o;if(-1===e)return{hasMagicSubtitle:a,shortRowCount:0,subtitleRowCount:0,tallRowCount:0};const n=new Set;let r=!1;for(const s of t){const t=null!=(o=s.timelineRow)?o:0;if(e>t&&Hk(s)&&n.add(t),"subtitle"===s.type){r=!0;break}}const i=n.size;return{hasMagicSubtitle:a,shortRowCount:e-i,subtitleRowCount:r?1:0,tallRowCount:i}},jk=({yPos:e,tracks:t,hasComments:a,hasMagicSubtitle:o,gutter:n=!1})=>{var r,i;const s=[];for(const{isTall:u,timelineRow:m}of t){const e=$k(u);s[m]=Math.max(e,null!=(r=s[m])?r:0)}let l=Wk({hasMagicSubtitle:o,subtitleRowCount:t.some((e=>e.type===ln.Subtitle))?1:0,shortRowCount:0,tallRowCount:0},a);const d=Math.max(l,e);for(let u=0;u<s.length;u+=1){const e=l+(null!=(i=s[u])?i:30);if(l<=d&&d<e){if(n){return(d-l)/(e-l)<.5?u:u+1}return u}l=e}const c=Math.ceil((d-l)/30);return s.length-1+c},Gk=(e,t,a)=>{let{previewIsTall:o}=t,{previewTop:n}=t;const r=[];let i=!1;return Object.values(a).forEach((t=>{const{shrunkTimelineRow:a,expandedTimelineRow:s,newTimelineRow:l,newIsTall:d}=t;r.includes(l)||(d&&l===e&&(o=!0,i=!0),null!==a&&(a!==e||i||(o=!1),a<e&&(n-=30)),null!==s&&(s!==e||i||(o=!0),s<e&&(n+=30)),r.push(l))})),{previewIsTall:o,previewTop:n}};function Hk(e){return e.type===ln.Video||(e.type===ln.Audio||!!Td(e))}const zk=(e,t,a)=>!!t.some((t=>{const o=Hk(t);let n=!0;return a&&(n=!a.includes(t.id)),o&&n&&t.timelineRow===e})),$k=e=>e?60:30,Kk=e=>60===e,Yk=e=>$k(Hk(e)),qk=[],Xk=c((e=>{var t;return null==(t=e.studio.scenes[0])?void 0:t.layers}),(e=>e||qk)),Jk=(...e)=>e.join("|"),Qk=e=>{return(e=>_d(e)||vd(e))(e)&&!((t=e).detachedAudioId&&"video"===t.type);var t},Zk=c((e=>e.studio.allLayers.byId),(e=>s.exports.uniq(Object.values(e).filter(Qk).map(Bk).filter(rl)))),eC=c((e=>e.uploadStatuses),((e={})=>Object.values(e).filter((e=>e.stage!==lh.errored&&e.stage!==lh.done)).map((e=>{var t;const a=null==(t=e.uploadManager)?void 0:t.layer;return a&&Qk(a)?a:null})).filter(rl))),tC=s.exports.memoize((e=>c(Xk,(t=>t.filter(Qk).filter((t=>{var a;return e.includes(null!=(a=Bk(t))?a:"")})))))),aC=s.exports.memoize(((e,t)=>c((a=>{var o;return(null==(o=a.assetTranscriptions.byId[e])?void 0:o[t])||null}),tC(e),((e,t)=>"completed"!==(null==e?void 0:e.state)||t.some((t=>{var a,o,n;const r=null!=(a=t.startTime)?a:0,i=null!=(n=null!=(o=t.endTime)?o:t.duration)?n:0;return e.words.some((e=>ol(e.start_time,e.end_time,r,i)))}))))),Jk),oC=s.exports.memoize((e=>c(Zk,(e=>e.studio.allLayers.byId),(e=>e.assetTranscriptions.byId),(e=>sr((t=>Zk(t).map((a=>[a,aC(a,e)(t)]))),(e=>{const t={};for(const[a,o]of e)t[a]=o;return t})))(e),((t,a,o,n)=>{const r=new Map;for(const e of Object.values(a)){const t=Bk(e);if(!t)continue;const[a]=zS(e),o=r.get(t);(void 0===o||a<o)&&r.set(t,a)}return t.map((t=>{var r;const i=Object.values(a).filter((e=>Bk(e)===t));if(!i.some((e=>e.hasAudio)))return{assetId:t,canBeEnabled:!1,defaultEnabled:!1,reason:"Asset has no audio"};const s=null==(r=o[t])?void 0:r[e];if("completed"===(null==s?void 0:s.state)&&0===s.words.length)return{assetId:t,canBeEnabled:!1,defaultEnabled:!1,reason:"No speech detected"};if(!n[t])return{assetId:t,canBeEnabled:!0,defaultEnabled:!1,reason:"No speech detected"};return i.some((e=>0!==e.volume))?{assetId:t,canBeEnabled:!0,defaultEnabled:!0,reason:""}:{assetId:t,canBeEnabled:!0,defaultEnabled:!1,reason:"Asset is muted"}})).sort(((e,t)=>{var a,o;if(e.canBeEnabled&&!t.canBeEnabled)return-1;if(!e.canBeEnabled&&t.canBeEnabled)return 1;return(null!=(a=r.get(e.assetId))?a:Number.MAX_SAFE_INTEGER)-(null!=(o=r.get(t.assetId))?o:Number.MAX_SAFE_INTEGER)}))})))),nC=s.exports.memoize(((e,t)=>c((t=>t.assetTranscriptions.byId[e]),(e=>t&&e?e[t]:null))),Jk);function rC({assetId:e,filterEmpty:t,filterInvalid:a,frameId:o}){return`${e}|${o}|${t}|${a}`}window.orderedMagicSubtitleFrames=()=>{const{state:e}=tn();return Object.keys(e.studio.magicSubtitleFramesByAsset||{}).reduce(((t,a)=>{const o=wC(a)(e);return t[a]=o,t}),{})};const iC=(...e)=>e.join("|"),sC=u(h,ar),lC=c((e=>e.studio.magicSubtitles),Xk,(e=>!!(wC("background-asset")(e)||[]).length),((e,t,a)=>{const o=new Set(t.map(Bk)),n=Object.entries(e||{}).filter((([e,t])=>"background-asset"===e||!!t&&(!!t.enabled&&("background-asset"===e||o.has(e))))).map((e=>e[0]));return a&&!n.includes("background-asset")&&n.push("background-asset"),n})),dC=s.exports.memoize((e=>c((t=>{var a;return null==(a=t.studio.magicSubtitleFramesByAsset)?void 0:a[e]}),(t=>{var a;return null==(a=t.studioLocal.magicSubtitleFramesByAsset)?void 0:a[e]}),((e,t)=>t||e)))),cC=(e,t,a)=>{var o,n,r,i,s,l,d,c,u;return null!=(u=null!=(c=null!=(s=null==(n=null==(o=e.studioLocal.magicSubtitlesGlobal||{})?void 0:o.position)?void 0:n[a])?s:null==(i=null==(r=e.studio.magicSubtitlesGlobal||{})?void 0:r.position)?void 0:i[a])?c:null==(d=null==(l=(e.studio.magicSubtitles||{})[t])?void 0:l.position)?void 0:d[a])?u:0},uC=s.exports.memoize((e=>c((t=>cC(t,e,"widthPct")),(t=>cC(t,e,"heightPct")),(e=>e.studio.height),(e=>e.studio.width),((e,t,a,o)=>{const n={height:a,width:o},{width:r,height:i}=eS(e,t,n);return{width:r,height:i}})))),mC=s.exports.memoize((e=>c((t=>{var a;const o=Object.keys(t.studio.magicSubtitles||{})[0];if(!o)return null;const n=e||o,r=null==(a=t.studio.magicSubtitles)?void 0:a[n];return r||"background-asset"!==e?r:db}),(e=>e.studio.magicSubtitlesGlobal),(e=>e.studioLocal.magicSubtitlesGlobal),((e,t,a)=>s.exports.merge({},db,e,t,a))))),pC=e=>c((e=>e.studio.height),(e=>e.studio.width),(e=>e.studio.canvasX),(e=>e.studio.canvasY),mC(e),((e,t,a,o,n)=>{const r={height:e,width:t,x:a,y:o},i=(null==n?void 0:n.position)||db.position,{x:s,y:l}=QT(i.xPct,i.yPct,r),{width:d,height:c}=eS(i.widthPct,i.heightPct,r);return{x:s,y:l,width:d,height:c,rotation:i.rotation}})),hC=s.exports.memoize((e=>c(mC(e),(e=>e.style||db.style)))),gC=s.exports.memoize((e=>c((t=>{var a;const o=null==(a=mC(e)(t))?void 0:a.languageKey;return o?nC(e,o)(t):null}),(e=>e)))),yC=s.exports.memoize((e=>c(Xk,(t=>{const a=t.filter(Qk).filter((t=>{var a;return e.includes(null!=(a=Bk(t))?a:"")}));return e.includes("background-asset")&&a.push({type:ln.Video,id:"123",asset_id:"background-asset",startTime:0,duration:1e5,name:"bg"}),a}))),(e=>e.join("_"))),fC=sC((e=>Zk(e).map((t=>[t,gC(t)(e)]))),(e=>{const t={};for(const[a,o]of e)t[a]=o||null;return t})),EC=s.exports.memoize((e=>{const t=hC(e);return c(t,(e=>e.studio.width||1),(e=>{var a;const o=null==(a=t(e))?void 0:a.fontFamily;if(o)return e.loadedFonts[o.fontFamily]}),(function(t,a,o){return function(e,t,a,o){const n=a/700;return Lk(e,t,t.fontSize*n,o)}(e,t,a,o)}))})),vC=e=>{if(vn(e))return e;if(0===e.words.length)return{...e,words:[]};const t=(e.end-e.start)/e.words.length;return{...e,words:e.words.map(((a,o)=>({text:a.text,start:e.start+o*t,end:e.start+(o+1)*t,styles:a.styles})))}},wC=s.exports.memoize((e=>sC((t=>{var a;const o=null==(a=dC(e)(t))?void 0:a.byId;if(!o)return null;return Object.keys(o).map((a=>bC(e,a)(t)))}),(e=>e?e.sort(((e,t)=>e.start-t.start)):null)))),bC=s.exports.memoize(((e,t)=>c((a=>{var o;return null==(o=dC(e)(a))?void 0:o.byId[t]}),(e=>{if(!e)throw Error(`No frame with id ${t}`);return e}))),iC),_C=s.exports.memoize(((e,t)=>c(bC(e,t),(e=>vC(e)))),iC),TC=s.exports.memoize((e=>sC((t=>{var a;const o=null==(a=dC(e)(t))?void 0:a.byId;if(!o)return null;return Object.keys(o).map((a=>_C(e,a)(t)))}),(e=>e?e.sort(((e,t)=>e.start-t.start)):null))));function SC(e){return()=>{const t=new WeakMap;return a=>{const o=t.get(a.frame);if(o&&ar(o.params,a))return o.result;const n=e(a);return t.set(a.frame,{params:a,result:n}),n}}}const IC=e=>({text:e.text,styles:e.styles});function xC(e,t,a){const o=vn(e);let n=[];if(o)n=e.words;else{const o=(a-t)/e.words.length;for(let a=0;a<e.words.length;a++){const r=e.words[a];if(!r)continue;const i=t+a*o,s=t+(a+1)*o;n.push({text:r.text,start:i,end:s})}}const r=[],i=[],s=[];for(const l of n){const t=l.end-e.start,a=e.end-l.start,o=Math.min(t,a),n=l.end-l.start,d=0===n?100:o/n,c=t<a;c&&d>.5||!c&&d>=.5?r.push(l):t<a?i.push(l):s.push(l)}return o?{keptWords:r,clippedLeft:i,clippedRight:s}:{keptWords:r.map(IC),clippedLeft:i.map(IC),clippedRight:s.map(IC)}}const kC=SC((({assetId:e,filterEmpty:t,filterInvalid:a,frame:o,subtitleableLayers:n})=>{const r=vC(o);if(!n.length||!r)return[];const i=[];for(const l of n){const{startTime:o,endTime:n,playbackRate:s,videoDelay:d}=Pd(l),c=1/s,u=d-o*c,m=d,p=d+(n-o)*c;if(!ol(r.start,r.end,o,n))continue;const h=r.start*c+u,g=r.end*c+u,y=Math.max(h,m),f=Math.min(g,p);if(a){if(r.start===r.end)continue;if(r.start>r.end)continue;if(f-y<=.01)continue}if(t){if(0===r.words.length)continue;if(!r.words.filter((({text:e})=>!!e)).length)continue}const E={assetId:e,id:r.id,start:y,end:f,containingLayerIds:new Set([l.id]),containingLayerStartTime:m,containingLayerEndTime:p,containingLayerPlaybackRate:s,startTimeOffset:u,endTimeOffset:u,words:r.words.map((e=>({...e,start:e.start*c+u,end:e.end*c+u})))},{clippedLeft:v,clippedRight:w,keptWords:b}=xC(E,r.start,r.end),_={...E,wordIsClippedList:[...v.map((()=>!0)),...b.map((()=>!1)),...w.map((()=>!0))],words:E.words};i.push(_)}i.sort(((e,t)=>e.start-t.start));const s=function(e){const t=[];for(let n=0;n<e.length;n++){const r=e[n];if(!r)continue;const i=t[t.length-1];if(!i){t.push(r);continue}if(i.id!==r.id){t.push(r);continue}const s=(a=i.end,o=r.start,Math.abs(a-o)<.001);if(i.endTimeOffset<r.startTimeOffset-.001||!s){t.push(r);continue}let l=i.wordIsClippedList.lastIndexOf(!1);-1===l&&(l=i.words.length-1);let d=r.wordIsClippedList.indexOf(!1);if(-1===d&&(d=r.words.length-1),l>d&&!i.wordIsClippedList.every((e=>!e))&&!r.wordIsClippedList.every((e=>!e))){t.push(r);continue}const c=i.wordIsClippedList.map(((e,t)=>{const a=r.wordIsClippedList[t];return e&&!!a})),u=[];for(let e=0;e<c.length;e++){const t=i.wordIsClippedList[e],a=r.wordIsClippedList[e],o=i.words[e],n=r.words[e];o&&n&&(t?a?u.push(o):u.push(n):u.push(o))}t[t.length-1]={...i,end:r.end,endTimeOffset:r.endTimeOffset,containingLayerEndTime:r.containingLayerEndTime,containingLayerIds:new Set([...i.containingLayerIds,...r.containingLayerIds]),wordIsClippedList:c,words:u}}var a,o;return t.map((e=>({...e,words:e.words.filter(((t,a)=>!e.wordIsClippedList[a]))})))}(i);return s.filter((e=>!(e.wordIsClippedList.length>0&&0===e.words.length)))})),CC=s.exports.memoize((({assetId:e,filterEmpty:t,filterInvalid:a})=>{const o=kC();return c(wC(e),yC([e]),(function(n,r){return(n||[]).map((n=>o({assetId:e,filterEmpty:t,filterInvalid:a,frame:n,subtitleableLayers:r}))).flat().sort(((e,t)=>e.start-t.start))}))}),rC),AC=({assetId:e,ignoreCorrections:t,languageCode:a,maxCharsPerSubtitle:o})=>c(gC(e),DC(e),TC(e),(function(e,n,r){let i;if(r&&r.length&&!t)i=r.flatMap((e=>e.words)).map((e=>({start_time:e.start,end_time:e.end,word:e.text,styles:e.styles})));else{if(!e||"completed"!==e.state)return[];i=e.words}return Tk({languageCode:a,words:i,maxCharsPerSubtitle:o,separator:n})})),NC=c(lC,(e=>e.length>0)),PC=e=>{const[t,a]=e.split("_");return{languageCode:t||e,translateCode:a}},RC=s.exports.memoize((e=>{const t=mC(e);return c((e=>{var a;return null==(a=t(e))?void 0:a.languageKey}),(e=>{var a;return null==(a=t(e))?void 0:a.translatedLanguageCode}),((e,t)=>{var a;if(t)return t;if(!e)return null;const{languageCode:o,translateCode:n}=PC(e);return null!=(a=null!=n?n:o)?a:null}))})),LC=s.exports.memoize((e=>{const t=mC(e);return c((e=>{var a;return null==(a=t(e))?void 0:a.languageKey}),(e=>{var a;return null==(a=t(e))?void 0:a.translatedLanguageCode}),((e,t)=>{if(!e)return null;const{languageCode:a,translateCode:o}=PC(e);return{languageCode:a,translateCode:t||o}}))})),DC=s.exports.memoize((e=>{const t=mC(e);return c(RC(e),gC(e),(t=>{var a,o;return null==(o=null==(a=t.studio.assetUploadedSubtitles)?void 0:a[e])?void 0:o.subtitles}),(e=>{var a;return null==(a=t(e))?void 0:a.transcriptionSource}),((e,t,a,o)=>"upload"===o||"manual"===o?a?yk(a.map((e=>e.text))):" ":e&&"completed"===(null==t?void 0:t.state)?fk(e):" "))})),OC=s.exports.memoize((({assetId:e,filterEmpty:t,filterInvalid:a})=>{const o=MC();return c(wC(e),yC([e]),UC,hC(e),DC(e),EC(e),((n,r,i,s,l,d)=>(n||[]).map((n=>o({assetId:e,canvasRatio:i,filterEmpty:t,filterInvalid:a,frame:n,style:s,subtitleableLayers:r,wordSeparator:l,wordSizer:d}))).flat()))}),rC);function FC(e){const t={backgroundColor:e.backgroundColor,borderRadius:{relative:`${e.borderRadius}%`},color:e.fontColor,fontFamily:e.fontFamily.fontFamily,fontWeight:e.fontWeight,globalAlpha:1,isTrimmed:!0,italic:e.italic,lineHeight:e.lineHeight,textAlign:e.textAlign,textTransform:e.textTransform,textShadow:"none"!==e.textShadow?e.textShadow:"transparent",textOutline:e.textOutline,textPadding:e.backgroundPadding,type:ln.Text,wrapOrFill:e.backgroundStyle,underline:e.underline,isMagicSubtitle:!0};return"custom"===e.fontFamily.type&&(t.asset_id=e.fontFamily.asset_id,t.url=e.fontFamily.url,t.fontType=e.fontFamily.fontType,t.hasCustomFont=!0),e.dropShadow&&(t.textEffect="dropShadow",t.textEffectColor=e.dropShadow.color,t.textShadowBlur=e.dropShadow.blur,t.textShadowDist=e.dropShadow.distance,t.textShadowRot=e.dropShadow.rotation),t}const MC=SC((function({assetId:e,canvasRatio:t,filterEmpty:a,filterInvalid:o,frame:n,style:r,subtitleableLayers:i,wordSeparator:s}){const l=kC()({assetId:e,filterEmpty:a,filterInvalid:o,frame:n,subtitleableLayers:i}),d=r.fontSize*t,c=FC(r);return l.map((function(t){const a=t.words.map((e=>e.text)).join(s),o=[...t.containingLayerIds.keys(),t.id].join("-");return{...c,id:o,assetId:e,wordSeparator:s,fontSize:d,text:a,textWithLineBreaks:a,startTime:t.start,endTime:t.end,frame:t}}))})),UC=c((e=>e.studio.width),(e=>(e||1)/700));function BC({assetId:e,canvasHeight:t,canvasWidth:a,canvasX:o,canvasY:n,canvasRatio:r,filterEmpty:i,filterInvalid:s,frame:l,isRTL:d,selection:c,style:u,subtitleableLayers:m,transformerPosition:p,transformerSize:h,transition:g,wordByWordAnimations:y,wordSeparator:f,wordSizer:E}){return MC()({assetId:e,canvasRatio:r,filterEmpty:i,filterInvalid:s,frame:l,style:u,subtitleableLayers:m,wordSeparator:f,wordSizer:E}).map((r=>{const i=HC({assetId:e,frame:r.frame,maxWidth:h.width,selection:c,separator:f,wordSizer:E}),{x:s,y:l,width:u,height:m,rotation:v}=xk(r,i,p),{xPercent:w,yPercent:b}=iS(s,l,{x:o,y:n,width:a,height:t}),{widthPercent:_,heightPercent:T}=aS(u,m,{width:a,height:t});return{...r,brokenLines:i,frame:{...r.frame,lines:i},isRTL:d,position:{height:T,width:_,x:w,y:b,rotation:v||0},textWithLineBreaks:i.map((e=>e.words.map((e=>e.text)).join(f))).join("\n"),transition:g,wordByWordAnimations:y}}))}const WC=SC(BC),VC=s.exports.memoize((({assetId:e,filterEmpty:t,filterInvalid:a})=>c(wC(e),pC(e),(e=>e.studio.width),(e=>e.studio.height),(e=>e.studio.canvasX),(e=>e.studio.canvasY),UC,KC(e),(e=>e.studioLocal.magicSubtitleSelection),hC(e),yC([e]),uC(e),XC(e),qC(e),DC(e),EC(e),((o,n,r,i,s,l,d,c,u,m,p,h,g,y,f,E)=>{const v=WC();return(o||[]).map((o=>v({assetId:e,canvasHeight:i,canvasWidth:r,canvasRatio:d,canvasX:s,canvasY:l,filterEmpty:t,filterInvalid:a,frame:o,isRTL:c,selection:u,style:m,subtitleableLayers:p,transformerPosition:n,transformerSize:h,transition:g,wordByWordAnimations:y,wordSeparator:f,wordSizer:E}))).flat()}))),rC),jC=e=>{const t=MC();return a=>c(wC(e),pC(e),(e=>e.studio.width),(e=>e.studio.height),(e=>e.studio.canvasX),(e=>e.studio.canvasY),UC,KC(e),(e=>e.studioLocal.magicSubtitleSelection),hC(e),yC([e]),uC(e),XC(e),qC(e),DC(e),EC(e),(function(o,n,r,i,s,l,d,c,u,m,p,h,g,y,f,E){if(!o)return null;const v=o.map((a=>t({assetId:e,canvasRatio:d,filterEmpty:!0,filterInvalid:!0,frame:a,style:m,subtitleableLayers:p,wordSeparator:f,wordSizer:E}))).flat().find((function(e){return e.startTime<=a&&e.endTime>a}));if(!v)return null;const w=o.find((e=>e.id===v.frame.id));if(!w)return null;return BC({assetId:e,canvasHeight:i,canvasWidth:r,canvasRatio:d,canvasX:s,canvasY:l,filterEmpty:!0,filterInvalid:!0,frame:w,isRTL:c,selection:u,style:m,subtitleableLayers:p,transformerPosition:n,transformerSize:h,transition:g,wordByWordAnimations:y,wordSeparator:f,wordSizer:E}).find((function(e){return e.startTime<=a&&e.endTime>a}))||null}))},GC=sC((e=>lC(e).map((e=>CC({assetId:e,filterEmpty:!1,filterInvalid:!1}))).map((t=>t(e)))),(e=>e.flat().sort(((e,t)=>{const a=e.start-t.start;return 0!==a?a:e.end-t.end}))));function HC({assetId:e,frame:t,maxWidth:a,selection:o,separator:n,wordSizer:r}){var i,s,l,d;const c=" "===n?r.getWidth({text:" "}):0,u=" "===n?1:0,m=[];function p(e,t){m.push({words:[e],width:t}),g=t}function h(){m.push({words:[],width:0}),g=0}let g=0,y=0;for(const f of t.words){const n=null!=(s=null==(i=f.text.match(/^\n+/))?void 0:i[0].length)?s:0,E=null!=(d=null==(l=f.text.match(/\n+$/))?void 0:l[0].length)?d:0,v=f.text.slice(n,f.text.length-E),w=a=>({...f,text:v,splitTextByStyle:tk({...f,text:v},a,(null==o?void 0:o.assetId)===e&&o.frameId===t.id?o:null),charOffset:a});for(let e=0;e<n;e++)y+=1,h();const b=r.getWidth(f),_=m[m.length-1];if(_){const e=g>0,t=(g?g+c:0)+b;g>0&&t>a?(y+=1,p(w(y),b)):(e&&(y+=u),_.words.push(w(y)),_.width=t,g=t)}else p(w(y),b);for(let e=0;e<E;e++)y+=1,h();y+=v.length}return m}s.exports.memoize(((e,t)=>c(_C(e,t),uC(e),EC(e),DC(e),(e=>e.studioLocal.magicSubtitleSelection),((t,a,o,n,r)=>HC({assetId:e,frame:t,maxWidth:a.width,selection:r,separator:n,wordSizer:o})))),iC);const zC=e=>{const t=lC(e),a={},o={allIds:[],byId:{}};if(t.length>0)for(const n of t){const t=s.exports.cloneDeep(VC({assetId:n,filterEmpty:!0,filterInvalid:!0})(e));t.sort(((e,t)=>e.startTime-t.startTime));const r=t[0];if(!t.length||!r)continue;const i=mC(n)(e)||{},{transitionId:l,transitionDuration:d,transitionOverlapDuration:c=0,wordByWordAnimations:u}=i;let m="";if(l&&l!==dn.None){const e=r.id;m=y(),o.allIds.push(m),o.byId[m]={animationName:l,id:m,isCrossTransition:!1,layerId:e,speed:"default",transitionDuration:d||.5}}let p="";if(u&&u.animationId&&u.animationId!==dn.None){const e=r.id,{animationId:t,animationName:a="",wordByWordStyles:n={}}=u;p=y();const i={animationName:t,id:p,isCrossTransition:!1,layerId:e,transitionDuration:.5,wordByWordStyles:n[a]};o.allIds.push(p),o.byId[p]=i}a[n]=t.map((e=>{const t=[];m&&t.push(m),p&&t.push(p);const a=m?-c:0,o=m?c:0;return{...e,fallbackFonts:H(e.text),startTime:e.startTime+a,endTime:e.endTime+o,animation:{constant:t}}}))}return{animations:o,magicSubtitlesOnExport:a}},$C=/[\u0591-\u07FF]/,KC=s.exports.memoize((e=>c(RC(e),wC(e),DC(e),((e,t,a)=>{if(e)return G.isRtlLang(e);const o=(t||[]).slice(0,4).map((e=>e.words.map((e=>e.text)).join(a))).join(a);return $C.test(o)})))),YC=s.exports.memoize((({filterEmpty:e,filterInvalid:t})=>sC((a=>lC(a).map((a=>OC({assetId:a,filterEmpty:e,filterInvalid:t}))).map((e=>e(a)))),(e=>e.flat()))),rC),qC=s.exports.memoize((e=>c(mC(e),(e=>e.wordByWordAnimations)))),XC=s.exports.memoize((e=>c(mC(e),(e=>{const{transitionId:t,transitionDuration:a,transitionOverlapDuration:o,transitionSpeed:n}=e;return{transitionId:t,transitionDuration:a,transitionOverlapDuration:o,transitionSpeed:n}})))),JC=c(YC({filterEmpty:!1,filterInvalid:!0}),(e=>{const t=Wl(e);return null!=t?t:1}),(e=>{var t;return!!(null==(t=e.comments.comments)?void 0:t.length)}),(e=>{var t,a;const{timelineContainerWidth:o}=e.studioLocal;return(null!=(a=null==(t=e.projectSessionSettings.timelinePosition)?void 0:t.timelineScrollLeft)?a:0)-.25*o}),(e=>{var t,a;const{timelineContainerWidth:o}=e.studioLocal;return(null!=(a=null==(t=e.projectSessionSettings.timelinePosition)?void 0:t.timelineScrollLeft)?a:0)+o+.25*o}),((e,t,a,o,n)=>{const r=$k(!1),i=Wk({hasMagicSubtitle:!1,shortRowCount:0,subtitleRowCount:0,tallRowCount:0},a),s=[];let l=null,d=0;const c=5/t,u=25/t,m=200/t;e.sort(((e,t)=>e.startTime-t.startTime));for(const g of e){if(!l){l={...g,containedFrames:[{assetId:g.assetId,containingLayerPlaybackRate:g.frame.containingLayerPlaybackRate,id:g.frame.id,wordIsClippedList:g.frame.wordIsClippedList}],containedFramesStartOffset:g.frame.startTimeOffset,containedFramesEndOffset:g.frame.endTimeOffset},d=1;continue}const e=g.endTime-g.startTime;if(g.startTime-l.endTime<c&&e<u)l.endTime=g.endTime,l.text+=` ${g.text}`,l.containedFrames.push({assetId:g.assetId,containingLayerPlaybackRate:g.frame.containingLayerPlaybackRate,id:g.frame.id,wordIsClippedList:g.frame.wordIsClippedList}),l.containedFramesEndOffset=g.frame.endTimeOffset,d+=1;else{d>1&&(l.text=`${d} subtitles (${l.text})`),s.push(l);e<m?(l={...g,containedFrames:[{assetId:g.assetId,containingLayerPlaybackRate:g.frame.containingLayerPlaybackRate,id:g.frame.id,wordIsClippedList:g.frame.wordIsClippedList}],containedFramesStartOffset:g.frame.startTimeOffset,containedFramesEndOffset:g.frame.endTimeOffset},d=1):(s.push({...g,containedFrames:[{assetId:g.assetId,containingLayerPlaybackRate:g.frame.containingLayerPlaybackRate,id:g.frame.id,wordIsClippedList:g.frame.wordIsClippedList}],containedFramesStartOffset:g.frame.startTimeOffset,containedFramesEndOffset:g.frame.endTimeOffset}),l=null,d=0)}}l&&(d>1&&(l.text=`${d} subtitles (${l.text})`),s.push(l));const p=s.map((e=>{const a=fI(t,e.endTime)-fI(t,e.startTime);return{...e,asset_id:e.assetId,isTall:!1,timelinePosition:{left:fI(t,e.startTime),width:a,height:r,top:i},text:e.text,timelineRow:-1,type:ln.Text,containedFrames:e.containedFrames,containedFramesStartOffset:e.containedFramesStartOffset,containedFramesEndOffset:e.containedFramesEndOffset}})),h=[];for(const g of p){const[e,a]=zS(g,0),r=fI(t,e);!(fI(t,a)<=o||n<=r)&&h.push(g)}return h})),QC=c((e=>e.studio.magicSubtitles),((e={})=>{var t,a;return Object.values(e).some((e=>"transcription"===(null==e?void 0:e.transcriptionSource)||!(null==e?void 0:e.transcriptionSource)))?"transcription":"upload"===(null==(t=e["background-asset"])?void 0:t.transcriptionSource)?"upload":"manual"===(null==(a=e["background-asset"])?void 0:a.transcriptionSource)?"manual":null})),ZC=c((e=>{var t;return null==(t=e.studio.magicSubtitlesGlobal)?void 0:t.languageKey}),(e=>e.studio.magicSubtitles),((e,t)=>{let a="en-US";if(e)a=e;else for(const o of Object.values(t||{}))if(null==o?void 0:o.languageKey){a=o.languageKey;break}return a})),eA=(e,t)=>{const a=e[0]/e[1],o=t.width/t.height;let n=t.width,r=t.height;return a>=o?r=e[1]*t.width/e[0]:n=e[0]*t.height/e[1],{width:n,height:r}},tA=(e,t,a,o,n,r)=>({x:(e-n)/2+a,y:(t-r)/2+o}),aA=(e,t)=>{if(!e||!t||0===t.width||0===t.height)return;const a=oA(e,t),o=nA(e,t);return{x:a.x,y:a.y,width:o.width,height:o.height}},oA=(e,t)=>({x:e.x/100*t.width+t.x,y:e.y/100*t.height+t.y}),nA=(e,t)=>({width:e.width/100*t.width,height:e.height/100*t.height}),rA={x:0,y:0,width:100,height:100,presetIndex:-1},iA=e=>{let t=e.split(":");2!==t.length&&(t=["1","1"]);const a=t.map((e=>{const t=parseFloat(e);return t?t<0?1:t:1}));return{ratioWidth:a[0],ratioHeight:a[1]}},sA=(e,t,a)=>{const o=(e=>e||dT()||cT()?0:30)(a||!1),n=t.width-2*o,r=t.height-2*o,{ratioWidth:i,ratioHeight:s}=iA(e),l=eA([i,s],{width:n,height:r}),d=tA(t.width,t.height,0,0,l.width,l.height);return{width:l.width,height:l.height,canvasX:d.x,canvasY:d.y,containerX:t.x,containerY:t.y,containerWidth:t.width,containerHeight:t.height}},lA=(e,t=0,a,o={})=>{var n;let r={top:window.screen.height,right:0,bottom:0,left:window.screen.width,rotation:t};const i=a?QT(a.xPercent,a.yPercent):LS(e);for(const s of e){if("subtitle"===s.type||"audio"===s.type&&!s.isAudiogram||!s.position)continue;const e=rx(s,null==(n=o.keyframing)?void 0:n[s.id],o.studioTime||0,o.canvasWidth||0,o.canvasHeight||0);let{x:a,y:l}=QT(e.x,e.y);const{width:d,height:c}=eS(e.width,e.height);"ellipse"===s.shapeType&&(a-=d/2,l-=c/2);const u=[{x:a,y:l},{x:a+d,y:l},{x:a,y:l+c},{x:a+d,y:l+c}],m=LS([s]),p=u.map((t=>NS(t,m,PS(e.rotation||0)))).map((e=>NS(e,i,PS(-1*t))));r={top:Math.min(r.top,...p.map((e=>e.y))),right:Math.max(r.right,...p.map((e=>e.x))),bottom:Math.max(r.bottom,...p.map((e=>e.y))),left:Math.min(r.left,...p.map((e=>e.x))),rotation:r.rotation}}return r},dA=(e,t,a,o={})=>{const n=lA(e,t,a,o);return{x:n.left,y:n.top,width:n.right-n.left,height:n.bottom-n.top,rotation:n.rotation}},cA=e=>{const t=lA(e),a=lS(t.left,t.top),o=lS(t.right,t.bottom);return{top:Ci(parseFloat(a.yPercent),0,100),right:Ci(parseFloat(o.xPercent),0,100),bottom:Ci(parseFloat(o.yPercent),0,100),left:Ci(parseFloat(a.xPercent),0,100)}},uA=()=>{const{state:e}=tn(),{overlayWithHeader:t}=e.studio;return t&&""!==t?t:void 0},mA=e=>{const{dispatch:t}=tn();t(Tr({key:ch.trim,params:e}))},pA=e=>{const{dispatch:t,state:a}=tn(),o=a.exports.runningExports.length||a.exports.pendingExport;vc("Studio Export Panel Opened"),t(Tr({key:"exportPanel",params:{panel:e||o?uh.HISTORY:uh.SETTINGS}}))},hA=()=>{const{dispatch:e}=tn();e(mr())},gA=e=>{vc("Smart Cut Opened",{layerType:e.previewLayer.type});const{dispatch:t}=tn();t(Tr({key:ch.smartCut,params:e}))},yA=e=>{vc("Scene Split Opened");const{dispatch:t}=tn();t(Tr({key:ch.sceneSplit,params:e}))},fA=()=>{const{dispatch:e}=tn();e({type:"HIDE_SIGN_IN"})},EA=()=>{const{dispatch:e}=tn();e(X_(!0))},vA=()=>{const{dispatch:e}=tn();e(X_(!1))},wA=()=>{const{dispatch:e}=tn();e(V_(!1,void 0,void 0))};function bA(e,t,a,o){const n=(a.width-t.width)/t.width,r=(a.height-t.height)/t.height;let i=e.xPct*t.width/a.width,s=e.yPct*t.height/a.height;const l=e.widthPct/(1+n),d=e.heightPct/(1+r);if(o.left){const o=t.width-e.xPct/100*t.width;i=100*(a.width-o)/a.width}if(o.top){const o=t.height-e.yPct/100*t.height;s=100*(a.height-o)/a.height}return{xPct:i,yPct:s,widthPct:l,heightPct:d}}const _A=Jl.withUndoBatch(((e,t,a)=>{const{dispatch:o,state:n}=tn(),{scenes:r,hasCustomOutput:i}=n.studio,s=n.studio.width,l=n.studio.height,d=(e-s)/s,c=(t-l)/l,u={};for(const w of r)for(const o of w.layers){const n=o.position,r=parseFloat(n.x),i=parseFloat(n.y),d=parseFloat(n.width),c=bA({heightPct:parseFloat(n.height),widthPct:d,xPct:r,yPct:i},{height:l,width:s},{height:t,width:e},a);u[o.id]={position:{...o.position,x:`${c.xPct}%`,y:`${c.yPct}%`,width:`${c.widthPct}%`,height:`${c.heightPct}%`}}}px(u);for(const w of Object.keys(n.studio.magicSubtitles||{})){const r=mC(w)(n);if(!r.position)continue;const i=bA(r.position,{height:l,width:s},{height:t,width:e},a);o(Ax({assetId:w,updates:{position:{...r.position,...i}}}))}const m=n.studio.customOutputWidth,p=n.studio.customOutputHeight,h=(e,t)=>0===t?e:h(t,e<t?e%t:t%e),g=h(e,t),y=t/g,f=e=>{const t=e.toString().substring(0,4);return["1.76","1.77","1.78"].includes(t)?"1.7":qT(e,2)},E=`${f(e/g)}:${f(y)}`,v={"1:1":"1:1","1:1.7":"9:16","1.7:1":"16:9","1.25:1":"5:4","1:1.25":"4:5"}[E]||E;if(i){let a=Math.min(d*m+m,1920),n=Math.min(c*p+p,1920);if(1920===a&&1920===n)wA(),o(B_(v,!0));else{if(1920===a&&n<1920){n-=e/t/100*n}if(1920===n&&a<1920){a-=t/e/100*a}TA(a,n),o(B_(`${a}:${n}`,!0))}}else o(B_(v,!0))})),TA=(e,t)=>{const{dispatch:a}=tn();a(V_(!0,Number(e),Number(t),!0))},SA=()=>{const{state:e}=tn(),{customOutputWidth:t}=e.studio,{customOutputHeight:a}=e.studio;(t>1920||a>1920)&&wA()},IA=Jl.withUndoBatch((()=>{const{dispatch:e,state:t}=tn(),{ratio:a}=t.studio,o=t.studio.scenes[0];if(!o)return[];const{layers:n}=o,{hasCustomOutput:r}=t.studio,i=t.studio.customOutputWidth,s=t.studio.customOutputHeight,{ratioWidth:l,ratioHeight:d}=iA(a),c=cA(n),u=c.right-c.left,m=c.bottom-c.top,p=u*i/100,h=m*s/100;e(B_(`${u*l}:${m*d}`,!0)),r&&TA(p,h);const g=[];for(const y of n){const e=y.position;let t={};t="subtitle"!==y.type?{position:{...e,x:100*(parseFloat(e.x)-c.left)/u+"%",y:100*(parseFloat(e.y)-c.top)/m+"%",width:100*parseFloat(e.width)/u+"%",height:100*parseFloat(e.height)/m+"%"}}:{position:{x:"0%",y:"80%",width:"100%",height:"10%"}};const a={...y,...t};g.push(a)}return e(Rh(g,0,!0)),g})),xA=Jl.withUndoBatch((()=>{const{dispatch:e,state:t}=tn(),{ratio:a}=t.studio,o=t.studio.scenes[0];if(!o)return;const{layers:n}=o,{hasCustomOutput:r}=t.studio,i=t.studio.customOutputWidth,s=t.studio.customOutputHeight,{ratioWidth:l,ratioHeight:d}=iA(a),c=1.1*d;if(c/l>=100)return;if(e(B_(`${l}:${c}`,!0)),r){const e=Math.min(1.1*s,1920);if(1920===e){const t=(e-s)/s;TA(0===t?.9*i:i-i*t,e)}else TA(i,e)}const u=[];for(const m of n){const e=m.position,t={position:{...e,y:`${Ci(parseFloat(e.y)/1.1,0,100)}%`,height:`${Ci(parseFloat(e.height)/1.1,0,100)}%`}},a={...m,...t};u.push(a)}e(Rh(u,0,!0))})),kA=Jl.withUndoBatch((()=>{const{dispatch:e,state:t}=tn(),{ratio:a}=t.studio,o=t.studio.scenes[0];if(!o)return;const{layers:n}=o,{hasCustomOutput:r}=t.studio,i=t.studio.customOutputWidth,s=t.studio.customOutputHeight,l=t.studio.height,{ratioWidth:d,ratioHeight:c}=iA(a);if(1.1*c/d>=100)return;if(e(B_(`${d}:${1.1*c}`,!0)),r){const e=Math.min(1.1*s,1920);if(1920===e){const t=(e-s)/s;TA(0===t?.9*i:i-i*t,e)}else TA(i,e)}const u=[];for(const m of n){const e=m.position,t=1.1*l,a=100*(t-(l-parseFloat(e.y)/100*l))/t,o=parseFloat(e.height)/1.1,n={position:{...e,y:`${Ci(a,0,100)}%`,height:`${Ci(o,0,100)}%`}},r={...m,...n};u.push(r)}e(Rh(u,0,!0))})),CA=Jl.withUndoBatch((()=>{const{dispatch:e,state:t}=tn(),{ratio:a}=t.studio,o=t.studio.scenes[0];if(!o)return;const{layers:n}=o,{hasCustomOutput:r}=t.studio,i=t.studio.customOutputWidth,s=t.studio.customOutputHeight,l=t.studio.width,{ratioWidth:d,ratioHeight:c}=iA(a),u=1.1*d;if(u/c>=100)return;e(B_(`${u}:${c}`,!0));let m=!1;if(r){const e=Math.min(1.1*i,1920);if(1920===e){m=!0;const t=(e-i)/i;TA(e,0===t?.9*s:s-s*t)}else TA(e,s)}const p=[];for(const h of n){const e=h.position,t=parseFloat(e.x),a=parseFloat(e.width),o=1.1*l,n=100*(o-(l-t/100*l))/o,r=m?a:a/1.1,i={position:{...e,x:`${Ci(n,0,100)}%`,width:`${Ci(r,0,100)}%`}},s={...h,...i};p.push(s)}e(Rh(p,0,!0))})),AA=Jl.withUndoBatch((()=>{const{dispatch:e,state:t}=tn(),{ratio:a}=t.studio,o=t.studio.scenes[0];if(!o)return;const{layers:n}=o,{hasCustomOutput:r}=t.studio,i=t.studio.customOutputWidth,s=t.studio.customOutputHeight,{ratioWidth:l,ratioHeight:d}=iA(a),c=1.1*l;if(c/d>=100)return;let u=!1;if(r){const e=Math.min(1.1*i,1920);if(1920===e){u=!0;const t=(e-i)/i;TA(e,0===t?.9*s:s-s*t)}else TA(e,s)}const m=[];for(const p of n){const e=p.position,t=parseFloat(e.width),a=u?t:t/1.1,o={position:{...e,x:`${Ci(parseFloat(e.x)/1.1,0,100)}%`,width:`${Ci(a,0,100)}%`}},n={...p,...o};m.push(n)}e(B_(`${c}:${d}`,!0)),e(Rh(m,0,!0))})),NA=(e,t,a,o,n,r)=>{const{state:i,dispatch:s}=tn(),{scenes:l,containerWidth:d,containerHeight:c,width:u,height:m}=i.studio,p=l[0];if(!p)return;const h=u,g=m;if(!h||!g)return;TA(e,t),RA(e,t,!0,!0,r||void 0,a?"Fill and Crop":"Fit to Center",o,n);const{width:y,height:f}=sA(`${e}:${t}`,{width:u,height:m},!1),{width:E,height:v}=sA(`${e}:${t}`,{width:d,height:c},!1),w=fS(p.layers,h,g,a?E:y,a?v:f);p.layers.filter((e=>"subtitle"!==e.type)).forEach((e=>{let t;if(a?"shape"===e.type&&e.position&&h&&g&&E&&v?t=vS(e.position,E,v,h,g):w&&(t=ES(e,h,g,E,v)):t=w?ES(e,h,g,y,f):yS(e,h,g,y,f),t){const o=a?E:y,n=a?v:f;s(Th(e,t.x/o*100+"%",t.y/n*100+"%",t.width/o*100+"%",t.height/n*100+"%",!0))}}));for(const b of Object.keys(i.studio.magicSubtitles||{})){const e=mC(b)(i);if(!e.position)continue;const{height:t}=eS(e.position.widthPct,e.position.heightPct,{width:h,height:g}),a=t/v*100,o=e.position.heightPct-a,n=e.position.yPct+o,r=E/h,l={position:{...e.position,heightPct:a,yPct:n}};e.style&&(l.style={...e.style,fontSize:Math.max(1,Math.round(e.style.fontSize/r))}),s(Ax({assetId:b,updates:l}))}a&&wA()},PA=(e,t,a,o)=>e/t==a/o,RA=(e,t,a=!1,o=!1,n,r,i,s)=>{const{dispatch:l,state:d}=tn(),c=d.studio.ratio,u=`${e}:${t}`;l(B_(u,a));const m=d.studio.scenes[0];if(m){if(o){const e=new Set;for(const n of m.layers){const t=Lr(n,d.mediaCache);n.type===ln.Video&&t&&e.add(t)}const t={};for(const n of m.layers)if("number"==typeof n.timelineRow){const e=`${m.id}_${n.timelineRow}`;t[e]=(t[e]||0)+1}const a=ST();let o=m.layers;m.duration>0&&(o=o.filter((e=>{const t=zS(e,0);return a>=t[0]&&a<t[1]}))),l(Df({usedCanvasResize:!0})),vc("Canvas Resize",n&&r&&void 0!==i&&void 0!==s?{"Previous Aspect Ratio":c,"New Aspect Ratio":u,"New Size Selected":n,"Fit or Fill":r,"Canvas Blur Applied":i,"Background Color Changed":s,"Number of Video Splits":Dr(d.studio),"Number of Layers":m.layers.length,"Number of Layers Shown in Preview":o.length,"Number of Tracks Used":Object.keys(t).length,"Number of Video Input Files":e.size}:{"Previous Aspect Ratio":c,"New Aspect Ratio":u,"Number of Video Splits":Dr(d.studio),"Number of Layers":m.layers.length,"Number of Layers Shown in Preview":o.length,"Number of Tracks Used":Object.keys(t).length,"Number of Video Input Files":e.size})}"Scenes"===uA()&&LA(u,{x:0,y:0,width:d.studio.containerWidth||1500,height:d.studio.containerHeight||1500},!1)}},LA=(e,t,a)=>{const{dispatch:o}=tn(),n=sA(e,t,a);o(bx(n)),o(Ix(xx({canvasWidth:n.width,canvasHeight:n.height})))},DA=e=>{const{dispatch:t}=tn();t(Oh(e))},OA=()=>{const{state:e}=tn();return e.studio.snapToGrid&&!e.studioLocal.commandIsBeingPressed&&!e.studioLocal.controlIsBeingPressed},FA=e=>{const t=["/studio/editor/scenes","/studio/editor/scenes/duration","/studio/editor/scenes/drag-upload","/studio/edtior/scenes/output-resize",/\/studio\/editor\/export-as-image.*/,"/studio/editor/audio",/\/studio\/editor\/subtitle-overlay(.*)/,"/studio/editor/trimmer","/studio/editor/animate","/studio/editor/adjust","/studio/editor/volume-adjust","/studio/editor/animate/colors","/studio/editor/animate/animation-background-color","/studio/editor/remove-background"];let a=!1;for(let o=0;o<t.length;o+=1){const n=t[o];if("string"==typeof n){if(nT(e)===n){a=!0;break}}else if(n instanceof RegExp&&n.test(e)){a=!0;break}}return!a},MA=()=>{const e=tn().state.studio.scenes[0];if(!e)throw Error();return e};function UA(e){const{state:t}=tn(),{scenes:a}=t.studio;for(const o of a){const{duration:t}=VA(o);BA(o,t,e)}}function BA(e,t,a){const o=t>0,n={};for(const r of e.layers)BS(r)&&"subtitle"!==r.type&&(null==r.endTime&&o||null==r.startTime&&o||r.isTrimmed!==o)&&(r.pluginSource?n[r.id]={startTime:t,endTime:t+3,isTrimmed:o}:n[r.id]={startTime:0,endTime:t,isTrimmed:o});px(n,a)}const WA=c((e=>e.studio.scenes[0]),(e=>VA(e).duration)),VA=(e=MA())=>yb(e),jA=Jl.withUndoBatch((({scene:e,newDuration:t,userSetDuration:a,hasCustomOutput:o,isImageVideo:n})=>{var r;const{state:i,dispatch:s}=tn(),{videoTypeSetting:l}=i.studio;t&&BA(e,t,!0),(null==(r=e.layers)?void 0:r.length)&&t||(s(Sx(t,!0)),s(Tx(n))),s(ow(e,{userSelectedDuration:t,userSetDuration:a,duration:t},!0)),(!l||l&&"gif"!==l)&&s(sw(Ei.MP4)),o&&SA()})),GA=(e=!0)=>{const{state:t}=tn(),{hasCustomOutput:a}=t.studio,o=((e=!1)=>{var t,a;const{state:o}=tn();let{duration:n}=o.studio;n=n||0;const r=n.toString();if(r.match(/^(\d*\.*\d+|\.\d)$/))return parseFloat(r);if(r.match(/^(\d+):(\d+)$/)){const e=r.match(/^(\d+):(\d+)$/);if(e&&parseInt(null!=(t=e[2])?t:"",10)<60)return 60*Number(e[1])+parseInt(null!=(a=e[2])?a:"",10)}return-1})(),n=t.studio.scenes[0];n&&jA({scene:n,newDuration:o,userSetDuration:e,hasCustomOutput:a,isImageVideo:!1})};function HA(){const{state:e}=tn(),t=e.studio.scenes[0];if(!t)return;const a=t.duration;ST()>a&&YA(a)}function zA(){const{dispatch:e}=tn();e({type:"TOGGLE_STUDIO_PAUSED"})}function $A(){const{state:e}=tn();e.studio.studioPaused||zA()}function KA(){const{state:e}=tn();e.studio.studioPaused&&zA()}function YA(e){const{state:t}=tn();t.studio.studioPaused?QA(e):IT(e)}const qA=e=>{const{state:t,dispatch:a}=tn(),o=t.studio.scenes[0];if(!o)return;const{start:n}=Rd(e,o.duration),r=n;YA(r),setTimeout((()=>{a({type:"PLAY_STUDIO"})}),20),a(W_(r))},XA=e=>{const{state:t}=tn(),{scenes:a}=t.studio,o=a[0],n=VA(o).duration,r=ST(),[i,s]=zS(e),l=i<=r&&r<=s,d=hb(n)<=r&&jT(s,n,.03333333333333333);return l||d},JA=()=>{const{state:e,dispatch:t}=tn();t(bg(!e.studioLocal.previewPlaying))},QA=e=>{const{dispatch:t}=tn();m.exports.batch((()=>{void 0===e?t(W_(ST())):(t(W_(e)),IT(e))}))},ZA=e=>{const{state:t,dispatch:a}=tn();t.studioLocal.userManualSeek===e&&a(W_(null))},eN=e=>{var t;const a=Xk(e),{selectedItem:o}=e.studio;return a.length<=1||(null==(t=a[0])?void 0:t.id)===(null==o?void 0:o.id)},tN=e=>{var t;const a=Xk(e),{selectedItem:o}=e.studio;let n=a[a.length-1];for(const r of a){if("subtitle"===r.type)break;n=r}return a.length<=1||(null==(t=a[a.length-1])?void 0:t.id)===(null==o?void 0:o.id)||(null==n?void 0:n.id)===(null==o?void 0:o.id)};let aN=Number.MAX_SAFE_INTEGER,oN=Number.MIN_SAFE_INTEGER,nN=0;const rN=c(Xk,(e=>e.studioLocal.draggedTracksOverrides),(e=>WA(e)>0),(e=>e.studio.groups),((e,t)=>aN<=t&&t<oN?nN:(nN=t,t)),((e,t,a,o,n)=>{const r=new Map,i=new Map;for(const[u,m]of Object.entries(o)){i.set(u,!1);for(const{id:e}of m.layers)r.has(e)?r.get(e).push(u):r.set(e,[u])}const s=e.map((e=>VS(e,null==t?void 0:t[e.id]))),l=[],d=[];for(const u of s){const[e,t]=zS(u);e<=n&&l.push(e),e>=n&&d.push(e),t<=n&&l.push(t),t>=n&&d.push(t)}aN=Math.max(...l),oN=Math.min(...d);const c=[];for(const u of s){if(r.has(u.id))for(const e of r.get(u.id))i.get(e)||(i.set(e,!0),c.push(`group_${e}`));a?(vd(u)||wd(u)||bd(u)||_d(u)||Td(u)||XA(u)||(null==t?void 0:t[u.id]))&&c.push(u.id):c.push(u.id)}return c})),iN=c((e=>e.studio.allLayers.byId),(e=>{var t,a;return null!=(a=null==(t=e.studio.selectedItem)?void 0:t.id)?a:""}),((e,t)=>e[t])),sN=c((e=>e.studio.selectedItem),(e=>e.studio.groups),(e=>{var t;return null==(t=e.studio.allLayers)?void 0:t.byId}),((e,t,a)=>{if(!e)return[];if("group"===e.type){const o=t[e.id];return o?o.layers.map((e=>a[e.id])).filter(rl):[]}if("layer"===e.type){const t=a[e.id];return t?[t]:[]}return[]})),lN=(e,t,a,o)=>{var n;const{state:r}=tn(),i=r.studio.allLayers.byId[e];if(!i)return;const s=(null==(n=r.studioLocal.layerTempValues[i.id])?void 0:n.inlineCropAspectRatio)||null;Jl.withUndoBatch((()=>{Jl.add({undo:qh(i.id,{inlineCropAspectRatio:o}),redo:qh(i.id,{inlineCropAspectRatio:s})}),Jl.add({undo:Lh({[i.id]:{crop:t,position:a}}),redo:Lh({[i.id]:{crop:i.crop,position:i.position}})})}))()},dN=(e=null)=>{var t,a,o,n,r,i,s;const{state:l}=tn(),d=sN(l)[0],c=e||d,u=null==(t=l.studioLocal.layerTempValues[c.id])?void 0:t.crop,m=c.width,p=c.height;return+((null!=(n=null!=(o=null==u?void 0:u.width)?o:null==(a=c.crop)?void 0:a.width)?n:100)*m/100/((null!=(s=null!=(i=null==u?void 0:u.height)?i:null==(r=c.crop)?void 0:r.height)?s:100)*p/100)).toFixed(2)},cN=e=>{const{state:t}=tn(),a=sN(t)[0];if(!e||!a)return;const o=gx(a);if(!o)return;const{width:n,height:r}=o,i=a.width||n,s=a.height||r;if(dN(a)===e)return;let l,d;const c=e>1||1===e&&i<=s;c?(l=i,d=l/e):(d=s,l=d*e),l>i&&!c&&(l=i,d=l/e),d>s&&c&&(d=s,l=d*e);const u=d/s*100,m=l/i*100;let p=0,h=0;if(u<100){h=(s-d)/2}if(m<100){p=(i-l)/2}const g={x:p/i*100,y:h/s*100,height:u,width:m};KT(a.id,{crop:g}),uN()},uN=(e=!1)=>{var t,a,o;const{state:n}=tn(),r=sN(n)[0];if(!r)return;const i=null==(t=n.studioLocal.layerTempValues[r.id])?void 0:t.crop,s=null==(a=n.studioLocal.layerTempValues[r.id])?void 0:a.positionTemp,l=n.studio.width||100,d=n.studio.height||100,c=s||r.position,u=i;if(!u||!c)return;const{crop:m}=r,{height:p,width:h,x:g,y:y}=m||{height:100,width:100,x:0,y:0},f=gx(r);if(!f)return;const{height:E,width:v}=f,w=u.height/p,b=p-u.height,_=u.width/h,T=u.width-h,S=v/l,I=E/d,x=v*h/200+g*v/100-l/2,k=E*p/200+y/100*E-d/2,C={x:v*u.width/200+v*u.x/100-l/2-x,y:E*u.height/200+E*u.y/100-d/2-k},{x:A,y:N}=C,[P,R]=((e,t)=>{const{state:a}=tn(),o=sN(a)[0];if(!o)return[e,t];const n=cS(o);if(!n)return[e,t];const{rotation:r=0}=n,i=(r+90)*Math.PI/180,s=e*Math.cos(i)-t*Math.sin(i);return[-(e*Math.sin(i)+t*Math.cos(i)),s]})(A,N),L=parseFloat(c.x),D=parseFloat(c.y),O={crop:u},F={...c};F.height=parseFloat(c.height)*w+"%",F.width=parseFloat(c.width)*_+"%",F.x=L-100*P/l-T*S/2+"%",F.y=D-100*R/d+b*I/2+"%",O.position=F,(null==(o=r.keyframeAnimation)?void 0:o.id)===WI.id&&(r.keyframeAnimation=null),px({[r.id]:O},e),KT(r.id,{crop:void 0,positionTemp:null})},mN=Jl.withUndoBatch(((e,t)=>{var a,o;const{dispatch:n,state:r}=tn(),i=t.type;if("none"===i)return;const s=Jw(e,r.studio);if(!s)return;const l=y(),d={...s.animation,[i]:[l]},c=bN([s]);if(!c)return;const u=Math.min(t.transitionDuration||(null==(a=Ab[t.id])?void 0:a.duration)||.5,c),m={animationName:t.id,id:l,layerId:s.id,isCrossTransition:!1,transitionDuration:u};((null==(o=s.animation)?void 0:o[i])||[]).forEach((e=>n(wh(e)))),n(Eh(m,!0));const p={animation:d};"constant"===i&&(p.keyframeAnimation=null),px({[s.id]:p},!0)})),pN=Jl.withUndoBatch(((e,t)=>{var a;const{dispatch:o,state:n}=tn(),r=Jw(e,n.studio);if(!r)return;const i={...r.animation,[t]:[]};px({[r.id]:{animation:i}},!0);((null==(a=r.animation)?void 0:a[t])||[]).forEach((e=>o(wh(e))))}));function hN(e){return c((e=>{var t;return null==(t=e.studio.scenes[0])?void 0:t.layers}),((t=[])=>{var a;const o={};for(const n of t){const t=null==(a=n.animation)?void 0:a[e];if(t)for(const e of t)o[e]=n}return o}))}const gN=hN("intro"),yN=hN("outro"),fN=Jl.withUndoBatch(((e,t,a)=>{const{dispatch:o,state:n}=tn();let r,i;if(a||t?(r=t,i=a):(r=yN(n)[e],i=gN(n)[e]),r){const{animation:t}=r;if(!t)return;const a={...t};a.outro=(a.outro||[]).filter((t=>t!==e)),px({[r.id]:{animation:a}},!0)}if(i){const{animation:t}=i;if(!t)return;const a={...t};a.intro=(a.intro||[]).filter((t=>t!==e)),px({[i.id]:{animation:a}},!0)}if(r&&i){const e=__(i,"intro");EN({introLayer:i,newAnimation:null,oldAnimation:e})}o(wh(e,!0))})),EN=({introLayer:e,oldAnimation:t,newAnimation:a})=>{const o=vN({introLayer:e,oldAnimation:t,newAnimation:a});o&&px(o,!0)},vN=({introLayer:e,oldAnimation:t,newAnimation:a,studioState:o=tn().state.studio})=>{const n=o.scenes[0];if(!n)return;const{layers:r}=n,i=EI(r,e),s=(t&&0!==t.duration?Mb(t,o.animations):0)-(a?Mb(a,o.animations):0);if(!s)return;const{start:l}=Rd(e),d={};return i.forEach((e=>{const{start:t}=Rd(e);if(!(t>=l))return;const a=BS(e)?{startTime:(e.startTime||0)+s,endTime:(e.endTime||0)+s}:{videoDelay:(e.videoDelay||0)+s};d[e.id]=a})),d},wN=Jl.withUndoBatch(((e,t,a)=>{const{state:o}=tn(),n=Jw(e,o.studio);if(!n)return void console.error("Could not find layer to add cross transition to");const r=T_(n),i="intro"===t?r.introTransition:r.outroTransition;if((null==i?void 0:i.transitionId)===a.id)return;const{introAnimation:s,outroAnimation:l}=S_(a),d="intro"===t?s:l;let c,u;if(i){let e;e=n.id===i.introLayerId?Jw(i.outroLayerId,o.studio):Jw(i.introLayerId,o.studio),e&&([c,u]="intro"===t?[n,e]:[e,n])}if(!c||!u){const e=o.studio.scenes[0];if(!e)return;const{layers:a}=e,r=e.duration,{nextLayer:i,prevLayer:s}=CN(n,a,r);[c,u]="intro"===t?[n,s]:[i,n]}if(!c||!u)return;const m=Nb[a.id],p=bN([c,u]);if(!p)return;const h=Math.min(Ab[null==m?void 0:m.intro].duration||.5,p),g=Math.min(Ab[null==m?void 0:m.outro].duration||.5,p);s.transitionDuration=h,l.transitionDuration=g,EN({introLayer:c,newAnimation:d,oldAnimation:i}),(({introLayer:e,outroLayer:t,newAnimation:a,newTransitionId:o,undoable:n=!0})=>{var r,i;const{dispatch:s}=tn(),l=y(),d=[...(null==(r=e.animation)?void 0:r.intro)||[],...(null==(i=t.animation)?void 0:i.outro)||[]];px({[e.id]:{animation:{...e.animation,intro:[l]}},[t.id]:{animation:{...t.animation,outro:[l]}}},n),s(Eh({id:l,animationName:o,isCrossTransition:!0,introLayerId:e.id,outroLayerId:t.id,transitionDuration:a.transitionDuration||.5},n));for(const c of d)s(wh(c))})({introLayer:c,outroLayer:u,newAnimation:d,newTransitionId:a.id})})),bN=e=>{const t=(a=e.reduce(((e,t)=>{if(!t)return e;const{start:a,end:o}=Rd(t),n=o-a;return Math.min(e,n)}),8)/2,Math.round(10*a)/10);var a;return t<.1?null:t},_N=Jl.withUndoBatch(((e,t)=>{const{dispatch:a}=tn();a(vh(e,{transitionDuration:t}))})),TN=Jl.withUndoBatch(((e,t)=>{const{dispatch:a,state:o}=tn(),n=g_(e);if(!n)return void console.error("Could not find animation to change transition duration on");if(!n.isCrossTransition)return void console.error("Cannot change transition duration on non transition");const r=Jw(n.introLayerId,o.studio);if(!r)return void console.error("Could not find intro layer for transition");const i=t_(n.animationName),{introAnimation:s}=S_(i),l={...s,transitionDuration:n.transitionDuration},d={...s,transitionDuration:t};EN({introLayer:r,newAnimation:d,oldAnimation:l}),a(vh(e,{transitionDuration:t}))})),SN=Jl.withUndoBatch(((e,t,a)=>{const{dispatch:o}=tn(),n=e.animation,r=null==n?void 0:n[t];if(!r)return;const i=r[0];i&&o(vh(i,{animationName:a}))})),IN=Jl.withUndoBatch(((e,t)=>{const{dispatch:a,state:o}=tn(),n=o.studio.scenes[0];if(!n)return;const r=Jw(e,o.studio);if(!r)return void console.error("Could not find layer to add cross transition to");const{duration:i}=n,s=__(r,"constant",o.studio.animations);s&&(s.transitionId?s.animationStateMapId&&fN(s.animationStateMapId):pN(r.id,"constant"));const l={},d={...t.transitions[0]};if(BS(r)&&!i)l.isTrimmed=!0,l.startTime=0,l.endTime=5,d.startTime=0,d.duration=5;else{const{start:e,end:t}=Rd(r),a=t-e;d.startTime=e,d.duration=a}l.keyframeAnimation={...t,transitions:[d]},WI.id===t.id&&(KT(r.id,{crop:{x:0,y:0,width:100,height:100},positionTemp:null}),uN()),px({[r.id]:l});const c=MA(),{duration:u}=VA(c);BA(c,u,!0),qA(r),a($_(!0))})),xN=e=>{const{dispatch:t,state:a}=tn(),o=a.studio.scenes[0];if(!o)return;const n=o.duration,r=[];if(e.forEach((e=>{const t=Jw(e,a.studio);if(!t)return;const o=b_(t),{start:i,end:s}=Rd(t,n);o.forEach((e=>{if(e.id!==dn.None)if("intro"===e.type||"constant"===e.type)r.push(i);else if("outro"===e.type){const t=Mb(e,a.studio.animations);r.push(s-t)}})),t.keyframeAnimation&&r.push(i)})),0===r.length)return;r.sort(((e,t)=>e-t));const i=r[0];QA(i),t({type:"PLAY_STUDIO"})},kN=(e,t)=>{const{dispatch:a,state:o}=tn(),n=o.studio.scenes[0];if(!n)return;const r=n.duration,i=Jw(e,o.studio);if(!i)return;let s;const{start:l,end:d}=Rd(i,r);if("intro"===t||"constant"===t)s=l;else{const e=__(i,t);s=d-(e?Mb(e,o.studio.animations):.5)}YA(s),a({type:"PLAY_STUDIO"})},CN=(e,t,a)=>{if(!e)return{};let{start:o,end:n}=Rd(e,a);const{introTransition:r,outroTransition:i}=T_(e),s=null==r?void 0:r.introLayerId,l=null==i?void 0:i.outroLayerId;let d,c;const u=EI(t,e);for(const m of u){let{start:e,end:t}=Rd(m,a);o=parseFloat(o.toFixed(2)),n=parseFloat(n.toFixed(2)),e=parseFloat(e.toFixed(2)),t=parseFloat(t.toFixed(2));const r=o_.includes(m.type);if((r&&e===n||l===m.id)&&(c=m,d))break;if((r&&t===o||s===m.id)&&(d=m,c))break}return{prevLayer:d,nextLayer:c}};function AN(e,t,a){if(!t||!a)return!0;const o=e.studio.scenes[0];if(!o)return!0;const n=o.duration,{start:r,end:i}=Rd(t,n),{start:s,end:l}=Rd(a,n);return null==t.timelineRow||t.timelineRow!==a.timelineRow||(r>=l||s>=i)}const NN=Jl.withUndoBatch((e=>{const{state:t}=tn(),a=t.studio.scenes[0];if(!a)return;const o=e?[e]:a.layers;for(const n of o){const{animation:e}=n;if(e){if(e.intro)for(const a of e.intro){const e=g_(a,t.studio.animations);if(!e||!e.isCrossTransition)continue;const o=yN(t)[a];AN(t,o,n)&&fN(a,o,n)}if(e.outro)for(const a of e.outro){const e=g_(a,t.studio.animations);if(!e||!e.isCrossTransition)continue;const o=gN(t)[a];AN(t,n,o)&&fN(a,n,o)}}}})),PN=(e,t,a)=>{let o;o="subtitle"===a.type?((e,t,a)=>{let o=-1;if(e.layers.push(a),"layerIndex"in t&&"number"==typeof t.layerIndex&&t.layerIndex!==e.layers.length-1){const n=t.layerIndex-(e.layers.length-1);o=t.layerIndex,e.layers=qw(e,a,n,!0)}else o=e.layers.length-1;return o})(e,t,a):((e,t,a)=>{const{layerIndex:o}=t;let n=o;if(void 0===n){const t=(e=>{var t;for(let a=e.length-1;a>=0;a-=1)if("subtitle"!==(null==(t=e[a])?void 0:t.type))return a;return null})(e.layers);n=null===t?0:t+1}return((e,t,a)=>{e.layers.splice(a,0,t)})(e,a,n),n})(e,t,a);const n={...a};delete n.local_url,yy(e,n,o,"insertLayer")};function RN(e,t){var a;e.undoable&&Jl.add({undo:{type:"REMOVE_LAYER",layer:e.layer,isUndo:!0,undoable:!1},redo:{...e,isRedo:!0,undoable:!1}});let{layer:o}=e;const{deletedLayerDict:n}=t;let r=!1;const i=n[e.layer.id];(e.isRedo||e.isUndo)&&i&&(o=i,delete n[e.layer.id],r=!0);const{scenes:s}=t;w({category:"Studio Add Layer",message:`Layer: ${JSON.stringify(o)}`});const l=e.sceneId||(null==(a=t.scenes[0])?void 0:a.id)||"",d=s[0];d&&PN(d,e,o);const c=!r||e.isRedo||e.isUndo,{duration:u}=VA(d),[m,p]=$w(s,l,{duration:u},"scene","handleAddLayerAction");t.scenes=m;const h=eb(m);my("duration",h,t.duration,"handleAddLayerAction"),t.duration=h,tb(t,h,m),my("showCanvas",!0,t.showCanvas,"handleAddLayerAction"),t.showCanvas=c||t.showCanvas,t.updateKey=z.v4();const g=t._id;o.asset_id&&o.cmlFileId&&ob(t,{asset_id:o.asset_id,cmlFileId:o.cmlFileId}),t.allLayers.byId[o.id]=o;const y=t.scenes.some((e=>e.layers.some((e=>e.cmlFileId===o.cmlFileId&&e.id!==o.id))));g&&o.cmlFileId&&!y&&Hy(o.cmlFileId,g)}function LN(e,t){var a;if(e.undoable){const o=t.allLayers.byId[e.layer.id],n=Xw((null==(a=t.scenes[0])?void 0:a.layers)||[],(null==o?void 0:o.id)||"");o&&Jl.add({undo:{type:"ADD_LAYER",layer:o,layerIndex:n,isUndo:!0},redo:{type:"REMOVE_LAYER",layer:e.layer}})}const o=t.allLayers.byId[e.layer.id];o&&(o&&t.allLayers.byId[o.id]&&delete t.allLayers.byId[o.id],function(e,t,a){const o=`removeLayer/${a}`,{scenes:n}=e,r=n[0];if(!r)throw Error("Missing scene");const i={...r};if(i.layers=Kw(t,i,a),0===i.layers.length){i.isImageVideo=!1,i.duration=0,i.userSelectedDuration=0;const e=`scene_${i.id}`;py(e,"isImageVideo",!1,i.isImageVideo,o),py(e,"duration",0,i.duration,o)}t.local_url&&(e.deletedLayerLocalBlobDict[t.id]=t.local_url),e.deletedLayerDict={...e.deletedLayerDict,[t.id]:{...t}};const s=eb([i]);i.layers.length<=0&&(my("showCanvas",!1,e.showCanvas,o),e.showCanvas=!1,e.width=void 0,e.height=void 0);const l=z.v4();e.duration=s,e.scenes=[i],e.updateKey=l}(t,o,e.source))}function DN(e,t){const{deletedLayerDict:a,deletedLayerLocalBlobDict:o}=t;return A(t,(t=>{if(o[e.layer.id]){const n=a[e.layer.id],r=o[e.layer.id];n&&(n.source="upload",n.url=e.layer.url),r&&e.layer.url&&ON(t,e.layer,r)}const n=function(e,t){const a={};FN.forEach((t=>{t in e&&(a[t]=e[t])}));const o=[];return t.forEach((t=>{t.layers.every(((n,r)=>{if("subtitle"===n.type)return!1;if(n.local_url&&n.local_url===e.local_url||n.uploadId&&n.uploadId===e.uploadId){const e={...n,...a};my(`layer_${n.id}`,e,n,"modifyUploadedLayer"),t.layers[r]=e,o.push(e)}return!0}))})),o}(e.layer,t.scenes);if(n)for(const a of n){const o={...a,...e.properties};t.allLayers.byId[o.id]=o}const r=t.scenes[0];if(r){const[a,o]=$w(r.layers,e.layer.id,e.properties,"layer","updateUploadedLayer",!e.properties.id);r.layers=a,t.allLayers.byId[e.layer.id]&&(t.allLayers.byId[e.layer.id]={...t.allLayers.byId[e.layer.id],...e.properties})}}))}const ON=(e,t,a)=>{for(const o of e.scenes)for(const n of o.layers)if(n.local_url===a){const a=`layer_${n.id}`;py(a,"source","upload",n.source,"updateLayersWithLocalBlob"),n.source="upload",py(a,"url",t.url,n.url,"updateLayersWithLocalBlob"),n.url=t.url,e.allLayers.byId[n.id]&&(e.allLayers.byId[n.id].source="upload",e.allLayers.byId[n.id].url=t.url)}},FN=["url","local_url","asset_id","source","ffprobeData","duration","conversion_type","conversion_id","conversion_failed","uploadConfirmed","uploadPending","pastedUrl","cmlFileId","videoConvertedState","doRetryExtraction"];function MN(e,t){var a;if(e.undoable){const{layer:t}=e,a=Object.keys(e.properties);let o;if(e.initialProperties)o=s.exports.pick(e.initialProperties,...a);else{const e={};a.forEach((a=>{e[a]=t[a]})),o=e}Jl.add({undo:{type:"UPDATE_LAYER",layer:t,properties:o},redo:{type:"UPDATE_LAYER",layer:t,properties:{...e.properties}}})}const o=t.deletedLayerDict[e.layer.id];if(o)return void(t.deletedLayerDict={...t.deletedLayerDict,[e.layer.id]:{...o,...e.properties}});(function(e){var t;return!!(null==(t=e.properties)?void 0:t.id)})(e)&&sb(t,e);const n=[...t.scenes];let r=null;const i=n[0];if(i){r={...i};const[a,o]=$w(r.layers,e.layer.id,e.properties,"layer","UPDATE_LAYER",!e.properties.id);r.layers=a,t.allLayers.byId[o.id]=o}t.duration=eb(n),t.scenes=r?[r]:n;let{selectedTimelineRows:l}=t;(null==(a=t.selectedItem)?void 0:a.id)===e.layer.id&&!e.layer.timelineRow&&e.properties.timelineRow&&(l=[],l.push(e.properties.timelineRow)),t.selectedTimelineRows=l,t.updateKey=y()}const UN=(e,t,a)=>{var o,n;const r=(null==(o=t.animations)?void 0:o.allIds)||[];r.push(e.animationInstance.id),t.animations.allIds=r;const i=(null==(n=t.animations)?void 0:n.byId)||{};if(i[e.animationInstance.id]=e.animationInstance,t.animations.byId=i,e.undoable){const t={type:"DELETE_ANIMATION",animationId:e.animationInstance.id},a={type:"ADD_ANIMATION",animationInstance:e.animationInstance};Jl.add({undo:t,redo:a})}py("animations","byId",i,a.animations.byId,"ADD_ANIMATION_BY_ID"),py("animations","allIds",r,a.animations.allIds,"ADD_ANIMATION_ALL_IDS")},BN=(e,t)=>{var a,o;const n=t.animations.byId[e.animationId];if(!n)return;if(e.undoable){const t={type:"ADD_ANIMATION",animationInstance:n},a={type:"DELETE_ANIMATION",animationId:e.animationId};Jl.add({undo:t,redo:a})}const r=(null==(a=t.animations)?void 0:a.allIds)||[],i=r.filter((t=>t!==e.animationId));t.animations.allIds=i;const s=(null==(o=t.animations)?void 0:o.byId)||{};delete s[e.animationId],t.animations.byId=s,py("animations","byId",s,t.animations.byId,"DELETE_ANIMATION_BY_ID"),py("animations","allIds",r,t.animations.allIds,"DELETE_ANIMATION_ALL_IDS")};function WN(e,t){const a=t.groups[e.groupId],o={saved:!1,rotation:0,layers:[],...a,...e.updates};if(o.layers&&0!==o.layers.length){if(py("groups",e.groupId,o,a,"UPDATE_GROUP"),e.undoable){const t={...a},o=Object.keys(e.updates).reduce(((e,a)=>(e[a]=t[a],e)),{});Jl.add({undo:{type:"UPDATE_GROUP",groupId:e.groupId,updates:o},redo:{type:"UPDATE_GROUP",groupId:e.groupId,updates:e.updates}})}t.selectedTimelineRows=Qw(o,t),t.groups={...t.groups,[e.groupId]:o},t.selectedItem={type:"group",id:e.groupId},t.updateKey=y()}}const VN=(e,t)=>{var a,o,n,r,i,s,l,d,c,u,m,h,g,f,E,v,b,_,T;const S=[...e.scenes];let I=0;switch(t.type){case"ADD_ANIMATION":return A(e,(a=>{UN(t,a,e)}));case"ADD_GROUP_TO_GROUP":{t.undoable&&Jl.add({undo:{type:"REMOVE_GROUP_FROM_GROUP",srcGroupId:t.srcGroupId,destGroupId:t.destGroupId},redo:{type:"ADD_GROUP_TO_GROUP",srcGroupId:t.srcGroupId,destGroupId:t.destGroupId}});const a=e.groups[t.srcGroupId],o=e.groups[t.destGroupId];if(!a)throw Error("Missing source group");let n;if(o){const e=[...o.layers,...a.layers.map((e=>({...e,fromMergedGroup:t.srcGroupId,saved:!1})))];n={...o,layers:e,rotation:0,preMergeRotation:o.preMergeRotation||o.rotation}}else{n={layers:[...a.layers.map((e=>({...e,fromMergedGroup:t.srcGroupId,saved:!1})))],saved:!1,rotation:0}}const r=Qw(n,e),i={...e.groups,[t.destGroupId]:n,[t.srcGroupId]:{...a,layers:[]}};return my("groups",i,e.groups,"ADD_GROUP_TO_GROUP"),{...e,groups:i,selectedTimelineRows:r,updateKey:y()}}case"ADD_LAYER":return e.allLayers.byId[t.layer.id]?(console.error("Refusing to add a layer that exists. Updating the layer instead","\nOld layer: ",e.allLayers.byId[t.layer.id],"\nNew layer: ",t.layer),p("Creating a layer with a duplicate ID",{extra:{oldLayer:e.allLayers.byId[t.layer.id],action:t}}),A(e,(a=>{const o=e.allLayers.byId[t.layer.id];return o?MN({type:"UPDATE_LAYER",layer:o,properties:t.layer,undoable:!1},a):a}))):A(e,(e=>RN(t,e)));case"ADD_LAYERS":{const a=!!t.isUndoable,o=t.fromUndo;return A(e,(e=>{t.layers.forEach(((n,r)=>{const i=void 0!==t.layerIndex?t.layerIndex+r:void 0;RN({type:"ADD_LAYER",layer:n,undoable:a,isUndo:o,layerIndex:i},e)}))}))}case"ADD_LAYERS_AT_INDEXES":return A(e,(e=>{t.layerIndexPairs.forEach((({layer:a,layerIndex:o})=>{RN({type:"ADD_LAYER",layer:a,undoable:!1,layerIndex:o,isUndo:t.isUndo},e)}))}));case"ADD_LAYERS_TO_GROUP":{if(!(null==(a=t.layerIds)?void 0:a.length))return e;t.undoable&&Jl.add({undo:{type:"REMOVE_LAYERS_FROM_GROUP",layerIds:t.layerIds,groupId:t.groupId,undoable:!1},redo:{type:"ADD_LAYERS_TO_GROUP",layerIds:t.layerIds,groupId:t.groupId,isTimelineGroup:t.isTimelineGroup,undoable:!1}});const o=e.groups[t.groupId];if(!o){const a={layers:t.layerIds.map((e=>({id:e,saved:t.isUndoFromRemoveLayerFromGroup||!1}))),saved:t.isUndoFromRemoveLayerFromGroup||!1,rotation:0,isTimelineGroup:t.isTimelineGroup};py("groups",t.groupId,a,o,"ADD_LAYERS_TO_GROUP");const n=Qw(a,e);return{...e,groups:{...e.groups,[t.groupId]:a},selectedTimelineRows:n,selectedItem:{id:t.groupId,type:"group"},updateKey:y()}}const n=o.layers.map((e=>e.id)),r=[...o.layers,...t.layerIds.filter((e=>!n.includes(e))).map((e=>({id:e,saved:t.isUndoFromRemoveLayerFromGroup||!1})))],i={...o,layers:r,rotation:0,preMergeRotation:o.preMergeRotation||o.rotation},s=Qw(i,e);if(py("groups",t.groupId,i,o,"ADD_LAYERS_TO_GROUP"),e.presence&&e.presentUserId){const a=e.presentUserId,o=e.presence[a];if(o){const n={...o,selectedLayerId:t.groupId};Ey(e,n,a,"ADD_LAYER_TO_GROUP")}}return{...e,groups:{...e.groups,[t.groupId]:i},selectedTimelineRows:s,selectedItem:{id:t.groupId,type:"group"},updateKey:y()}}case"REMOVE_ALL_UNSAVED_GROUPS":return A(e,(a=>{const o=[];for(const[t,n]of Object.entries(e.groups))n.saved||o.push(t);if(t.undoable){const t={};for(const a of o)t[a]=e.groups[a];Jl.add({undo:{type:"UPDATE_GROUPS",updates:t,undoable:!1},redo:{type:"REMOVE_ALL_UNSAVED_GROUPS",undoable:!1}})}o.forEach((e=>{delete a.groups[e]}))}));case"ADD_SELECTED_TIMELINE_ROWS":{const a=[...e.selectedTimelineRows];for(const e of t.timelineRows)a.indexOf(e)<0&&a.push(e);return{...e,selectedTimelineRows:a}}case"ADD_SUBTITLE_LAYERS":{w({category:"Studio Add Subtitle Layers",message:`Layer: ${JSON.stringify(t.subtitles)}`});const a=S[0];if(!a)throw Error("No scene");const o=a.layers.slice();t.subtitles.forEach((e=>{e.timelineRow=-1,yy(a,e,o.length,"ADD_SUBTITLE_LAYERS"),o.push(e)})),a.layers=o;const{duration:n}=yb(a);a.duration=n;const{...r}=e.allLayers.byId;for(const e of t.subtitles)r[e.id]=e;return{...e,duration:n,scenes:[a],updateKey:y(),allLayers:{byId:r}}}case"BRING_LAYER_FORWARD":{const a=S[0];if(!a)throw Error("No scene");const{layers:o}=a,n=o.findIndex((e=>e.id===t.layer.id));if(n===o.length-1)return e;const r=rb(e,o,n,"FORWARDS")-n;if(a.layers=qw(a,t.layer,r),t.undoable){const a=e.allLayers.byId[t.layer.id];a&&Jl.add({undo:{type:"SEND_LAYER_BACK",layer:a},redo:{type:"BRING_LAYER_FORWARD",layer:t.layer}})}return{...e,scenes:[a],updateKey:y()}}case"DELETE_ANIMATION":return A(e,(a=>{e.animations.byId[t.animationId]&&BN(t,a)}));case"BULK_DELETE_ANIMATIONS":return A(e,(a=>{const o={},n={};if(t.animationIds.forEach((t=>{const r=e.animations.byId[t];if(r){if(o[t]=r,r.isCrossTransition){const o=e.allLayers.byId[r.introLayerId],i=e.allLayers.byId[r.outroLayerId];if(null==o?void 0:o.animation){const e={...o.animation};e.intro=(e.intro||[]).filter((e=>e!==t)),n[o.id]={...n[o.id],animation:o.animation},MN({type:"UPDATE_LAYER",layer:o,properties:{animation:e},undoable:!1},a)}if(null==i?void 0:i.animation){const e={...i.animation};e.outro=(e.outro||[]).filter((e=>e!==t)),n[i.id]={...n[i.id],animation:i.animation},MN({type:"UPDATE_LAYER",layer:i,properties:{animation:e},undoable:!1},a)}if(o&&i){const t=__(o,"intro",a.animations),r=vN({introLayer:o,newAnimation:null,oldAnimation:t,studioState:a});if(!r)return;Object.entries(r).forEach((([t,o])=>{const r=e.allLayers.byId[t];r&&(n[t]={...n[t],startTime:r.startTime,endTime:r.endTime,videoDelay:r.videoDelay},MN({type:"UPDATE_LAYER",layer:r,properties:o,undoable:!1},a))}))}}BN({animationId:t,undoable:!1,type:"DELETE_ANIMATION"},a)}})),t.undoable){for(const a of t.animationIds)e.animations.byId[a];Jl.add({undo:{type:"ADD_BACK_ANIMATIONS",layerUpdates:n,animations:o,undoable:!1},redo:{type:"BULK_DELETE_ANIMATIONS",animationIds:t.animationIds,undoable:!1}})}}));case"ADD_BACK_ANIMATIONS":return A(e,(a=>{Object.entries(t.layerUpdates).forEach((([e,t])=>{const o=a.allLayers.byId[e];o&&MN({type:"UPDATE_LAYER",layer:o,properties:t,undoable:!1},a)})),Object.entries(t.animations).forEach((([t,o])=>{UN({type:"ADD_ANIMATION",animationInstance:{...o,id:t},undoable:!1},a,e)}))}));case"ENHANCE_LAYER":{const{assetId:a,enhanceJobId:o}=t;if(!a)return e;const n={...e.enhanceJobIds||{}};return o?(n[a]=o,py("enhanceJobIds",a,o,e.enhanceJobIds[a],"update enhanceJobIds")):(delete n[a],gy("enhanceJobIds",a,e.enhanceJobIds[a],"update enhanceJobIds")),{...e,enhanceJobIds:n}}case"MOVE_LAYER_TO_INDEX":{const a=S[0];if(!a)throw Error("No scene");const o=a.layers.findIndex((e=>e.id===t.layer.id));t.undoable&&Jl.add({undo:{type:"MOVE_LAYER_TO_INDEX",layer:t.layer,targetIndex:o},redo:{type:"MOVE_LAYER_TO_INDEX",layer:t.layer,targetIndex:t.targetIndex}});const n=t.targetIndex-o;return a.layers=qw(a,t.layer,n),{...e,scenes:[a],updateKey:y()}}case"REMOVE_GROUP":{const a=e.groups[t.groupId],o={...e.groups};return delete o[t.groupId],t.undoable&&Jl.add({undo:{type:"UPDATE_GROUP",groupId:t.groupId,updates:{...a}},redo:{type:"REMOVE_GROUP",groupId:t.groupId}}),{...e,groups:o}}case"REMOVE_GROUP_FROM_GROUP":{t.undoable&&Jl.add({undo:{type:"ADD_GROUP_TO_GROUP",srcGroupId:t.srcGroupId,destGroupId:t.destGroupId},redo:{type:"REMOVE_GROUP_FROM_GROUP",srcGroupId:t.srcGroupId,destGroupId:t.destGroupId}});const a=e.groups[t.destGroupId];if(!a)throw Error("No dest group");const o=e.groups[t.srcGroupId];if(!o)throw Error("No src group");const n=a.layers.filter((e=>e.fromMergedGroup!==t.srcGroupId)),r=a.layers.filter((e=>e.fromMergedGroup===t.srcGroupId)).map((e=>({id:e.id,saved:!0}))),i={...a,layers:n};n.every((e=>e.saved))&&void 0!==i.preMergeRotation&&(i.rotation=i.preMergeRotation,i.preMergeRotation=void 0);const s={...o,layers:r},l={...e.groups,[t.destGroupId]:i,[t.srcGroupId]:s};return my("groups",l,e.groups,"REMOVE_GROUP_FROM_GROUP"),{...e,groups:l,updateKey:y()}}case"REMOVE_LAYER":return A(e,(e=>{LN(t,e)}));case"REMOVE_LAYERS":return A(e,(a=>{if(t.undoable){const e=t.layers.map((e=>{const t=a.scenes[0];if(!t)throw Error("No scene");const o=t.layers.findIndex((t=>t.id===e.id));if(-1===o)throw Error("Layer not found");return{layer:e,layerIndex:o}}));Jl.add({undo:{type:"ADD_LAYERS_AT_INDEXES",layerIndexPairs:e,isUndo:!0},redo:{type:"REMOVE_LAYERS",layers:t.layers,source:t.source,undoable:!1}})}t.layers.forEach((o=>{const n=e.allLayers.byId[o.id];if(!n)throw Error("Layer to delete is missing from state");LN({type:"REMOVE_LAYER",undoable:!1,isUndo:!1,source:t.source,layer:n},a)}))}));case"REMOVE_LAYERS_FROM_GROUP":{const a=e.groups[t.groupId];if(!a)return e;if(t.undoable){const e=a.layers.map((e=>e.id));Jl.add({undo:{type:"ADD_LAYERS_TO_GROUP",layerIds:e,groupId:t.groupId,isUndoFromRemoveLayerFromGroup:!0,isTimelineGroup:!!a.isTimelineGroup,undoable:!1},redo:{type:"REMOVE_LAYERS_FROM_GROUP",layerIds:t.layerIds,groupId:t.groupId,undoable:!1}})}const o=new Set(t.layerIds),n=a?a.layers.filter((e=>!o.has(e.id))):[];if(n.length<=1){const a={...e.groups};delete a[t.groupId];const o=n[0]?n[0].id:null;return py("groups",t.groupId,void 0,e.groups[t.groupId],"REMOVE_LAYERS_FROM_GROUP"),{...e,groups:a,selectedItem:o?{id:o,type:"layer"}:null,updateKey:y()}}const r={...a,layers:n};return n.every((e=>e.saved))&&void 0!==r.preMergeRotation&&(r.rotation=r.preMergeRotation,r.preMergeRotation=void 0),py("groups",t.groupId,r,e.groups[t.groupId],"REMOVE_LAYERS_FROM_GROUP"),{...e,groups:{...e.groups,[t.groupId]:r},updateKey:y()}}case"REPOSITION_LAYER":{const a=S[0];if(!a)throw Error("No scene");if(t.undoable){const a=e.allLayers.byId[t.layer.id];a&&Jl.add({undo:{type:"REPOSITION_LAYER",layer:a,x:null==(o=a.position)?void 0:o.x,y:null==(n=a.position)?void 0:n.y},redo:{type:"REPOSITION_LAYER",layer:t.layer,x:t.x,y:t.y}})}w({category:"Studio Reposition Layer",message:`Layer: ${t.layer.id}, New X: ${t.x}, New Y: ${t.y}`});const{...r}=e.allLayers.byId,[i,s]=function(e,t){const{x:a,y:o}=t,n=a,r=o;let i=t.layer.position;for(const s of e)if(s.id===t.layer.id){"position"in s&&(i=s.position);break}return $w(e,t.layer.id,{position:{...i,x:n,y:r}},"layer","repositionLayer")}(a.layers,t);return a.layers=i,r[s.id]=s,{...e,scenes:[a],updateKey:y(),allLayers:{byId:r}}}case"RESIZE_LAYER":{if(!e.allLayers.byId[t.layer.id])return e;const a=S[0];if(!a)throw Error("No scene");if(t.undoable){const a=e.allLayers.byId[t.layer.id];a&&Jl.add({undo:{type:"RESIZE_LAYER",layer:a,x:null==(r=a.position)?void 0:r.x,y:null==(i=a.position)?void 0:i.y,width:null==(s=a.position)?void 0:s.width,height:null==(l=a.position)?void 0:l.height},redo:{type:"RESIZE_LAYER",layer:t.layer,x:t.x,y:t.y,width:t.width,height:t.height}})}w({category:"Studio Resize Layer",message:`Layer: ${t.layer.id}, New X Percent: ${t.x}, New Y Percent: ${t.y}, New Width Percent: ${t.width}, New Height Percent: ${t.height}`});const{...o}=e.allLayers.byId;if(a){const[e,n]=function(e,t){const{x:a,y:o,width:n,height:r}=t,i=a,s=o,l=n,d=r;let c=t.layer.position;for(const u of e)if(u.id===t.layer.id){"position"in u&&(c=u.position);break}return $w(e,t.layer.id,{position:{...c,x:i,y:s,width:l,height:d}},"layer","resizeLayer")}(a.layers,t);a.layers=e,o[t.layer.id]=n}return{...e,scenes:[a],updateKey:y(),allLayers:{byId:o}}}case"RESIZE_LINE_LAYER":{const a=S[0];if(!a)throw Error("No scene");if(t.undoable){const a=e.allLayers.byId[t.layer.id];a&&Jl.add({undo:{type:"RESIZE_LINE_LAYER",layer:a,x:null==(d=a.position)?void 0:d.x,y:null==(c=a.position)?void 0:c.y,width:null==(u=a.position)?void 0:u.width,height:null==(m=a.position)?void 0:m.height,linePointStartCorner:a.linePointStartCorner,lineRightAngle:a.lineRightAngle},redo:{type:"RESIZE_LINE_LAYER",layer:t.layer,x:t.x,y:t.y,width:t.width,height:t.height,linePointStartCorner:t.linePointStartCorner,lineRightAngle:t.lineRightAngle}})}w({category:"Studio Resize Layer",message:`Line Layer: ${t.layer.id}, New X Percent: ${t.x}, New Y Percent: ${t.y}, New Width Percent: ${t.width}, New Height Percent: ${t.height}`});const{...o}=e.allLayers.byId;if(a){const[e,n]=function(e,t){const{x:a,y:o,width:n,height:r,linePointStartCorner:i,lineRightAngle:s}=t,l=a,d=o,c=n,u=r;let m=t.layer.position,p=null;i&&(p={linePointStartCorner:i,lineRightAngle:s});for(const h of e)if(h.id===t.layer.id){"position"in h&&(m=h.position);break}return $w(e,t.layer.id,{position:{...m,x:l,y:d,width:c,height:u},...p},"layer","resizeLineLayer")}(a.layers,t);a.layers=e,o[t.layer.id]=n}return{...e,scenes:[a],updateKey:y(),allLayers:{byId:o}}}case"SAVE_LAYER_GROUP":{let a=1;const o=Object.values(e.groups).map((e=>e.name?Number(e.name.split(" ")[1]):0)).sort(((e,t)=>t-e))[0];o&&(a=o+1);const n=`Group ${a}`,r=e.groups[t.groupId];if(!r)throw Error("No group found to save");const i={...r},s=t.saved?i.layers.filter((e=>!e.deselected)).map((e=>({...e,saved:!0}))):i.layers.map((e=>({...e,saved:!1}))),l={...i,layers:s,saved:t.saved,name:i.name?i.name:n},d=S[0];if(!d)throw Error("No scene");let c=d.layers.reduce(((e,t,a)=>l.layers.map((e=>e.id)).includes(t.id)?a:e),0);const u=[...d.layers].reverse(),m=[];for(const e of u){if(!l.layers.map((e=>e.id)).includes(e.id))continue;const t=d.layers.map((e=>e.id)).indexOf(e.id);0!==c-t&&m.push([t,c]),c-=1}const p=[...d.layers];for(const[e,t]of m){const a=t-e,o=p[e];o&&(d.layers=qw(d,o,a))}return t.undoable&&Jl.add({undo:{func(){const{dispatch:e,state:a}=tn();e({type:"UPDATE_GROUP",groupId:t.groupId,updates:{...i}});const o=a.studio.scenes[0];if(!o)throw Error("No scene");const n=[...m].reverse();for(const[t,r]of n)e({type:"MOVE_LAYER_TO_INDEX",layer:o.layers[r],targetIndex:t})}},redo:{type:"SAVE_LAYER_GROUP",groupId:t.groupId,saved:t.saved}}),py("groups",t.groupId,l,e.groups[t.groupId],"SAVE_LAYER_GROUP"),{...e,groups:{...e.groups,[t.groupId]:l},selectedItem:{type:"group",id:t.groupId},scenes:[d],updateKey:y()}}case"SELECT_ITEM":{if(t.undoable&&Jl.add({undo:{type:"SELECT_ITEM",item:e.selectedItem},redo:{type:"SELECT_ITEM",item:t.item}}),e.presence&&e.presentUserId){const a=e.presentUserId,o=t.item&&"layer"===t.item.type?t.item.id:"",n=e.presence[a];if(n){const t={...n,selectedLayerId:o};Ey(e,t,a,"SELECT_LAYER")}}let a=e;const o=t.item?Zw(t.item,e):[];if(("group"===(null==(h=e.selectedItem)?void 0:h.type)?e.groups[e.selectedItem.id]:null)&&(null==(g=t.item)?void 0:g.id)!==(null==(f=e.selectedItem)?void 0:f.id)){const{groups:o,undo:n}=ib(e,(null==(E=e.selectedItem)?void 0:E.id)||"");a={...a,groups:o,updateKey:y()};const r=Jl.getState(),i=r.actions[r.index];n&&i&&"STUDIO_DELETE_GROUP"!==i.type&&!1!==t.undoable&&Jl.add({undo:n,redo:{type:"SELECT_ITEM",item:t.item}})}return"gap"===(null==(v=e.selectedItem)?void 0:v.type)&&e.timelineGap&&e.timelineGap.gapId===e.selectedItem.id&&(null==(b=t.item)?void 0:b.id)!==e.selectedItem.id&&(a={...a,timelineGap:null,updateKey:y()}),{...a,selectedItem:t.item,selectedTimelineRows:o}}case"SELECT_TRANSITION":if(t.undoable){const a={type:"SELECT_TRANSITION",payload:(null==(_=e.selectedTransition)?void 0:_.id)||null},o={type:"SELECT_TRANSITION",payload:t.payload};Jl.add({undo:a,redo:o})}return{...e,selectedTransition:t.payload?{id:t.payload}:null};case"SEND_LAYER_BACK":{const a=e.scenes[0];if(!a)throw Error("No scene");const{layers:o}=a,n=o.findIndex((e=>e.id===t.layer.id));if(0===n)return e;const r=rb(e,o,n,"BACKWARDS")-n;if(a.layers=qw(a,t.layer,r),t.undoable){const a=e.allLayers.byId[t.layer.id];a&&Jl.add({undo:{type:"BRING_LAYER_FORWARD",layer:a},redo:{type:"SEND_LAYER_BACK",layer:t.layer}})}return{...e,scenes:[a],updateKey:y()}}case"SET_LAYER_DUPLICATED":return{...e,layerDuplicated:t.layerDuplicated};case"SET_LAYER_DESELECTION_IN_GROUP":{const{groupId:a,layerId:o,deselect:n,undoable:r}=t;if(r){e.groups[a]&&Jl.add({undo:{type:"SET_LAYER_DESELECTION_IN_GROUP",groupId:a,layerId:o,deselect:!n,undoable:!1},redo:{type:"SET_LAYER_DESELECTION_IN_GROUP",groupId:a,layerId:o,deselect:n,undoable:!1}})}const i=e.groups[a];if(!i)throw Error("No group");const s=i.layers.findIndex((e=>e.id===o));if(-1===s)return i.layers.push({id:o,saved:!1}),{...e,groups:{...e.groups,[a]:i}};const l=i.layers[s];if(!l)throw Error("No group layer");return l.saved?l.deselected=n:i.layers.splice(s,1),{...e,groups:{...e.groups,[a]:i}}}case"SET_SCALE":{const a=e.scenes[0];if(!a)throw Error("No scene");const{...o}=e.allLayers.byId,[n,r]=function(e,t){const{scaleX:a,scaleY:o}=t;let n=t.layer.position;for(const r of e)if(r.id===t.layer.id){"position"in r&&(n=r.position);break}return $w(e,t.layer.id,{position:{...n,scaleX:a,scaleY:o}},"layer","setScale")}(a.layers,t);return a.layers=n,o[r.id]=r,{...e,scenes:[a],allLayers:{byId:o},updateKey:y()}}case"SET_SELECTED_TIMELINE_ROWS":return{...e,selectedTimelineRows:t.timelineRows};case"SET_STUDIO_FLIP_HORIZONTAL":{const a=e.scenes[0];if(!a)throw Error("No scene");if(t.undoable){const a=e.allLayers.byId[t.layer.id];a&&Jl.add({undo:{type:"SET_STUDIO_FLIP_HORIZONTAL",layer:a,axis:t.axis},redo:{type:"SET_STUDIO_FLIP_HORIZONTAL",layer:t.layer,axis:t.axis}})}w({category:"Studio Set Layer Flipped",message:`Layer: ${t.layer.id}, Flipped Axis: ${t.axis}`});const{...o}=e.allLayers.byId,[n,r]=Yw(a.layers,t);return a.layers=n,o[r.id]=r,{...e,scenes:[a],updateKey:y(),allLayers:{byId:o}}}case"SET_STUDIO_FLIP_VERTICAL":{const a=e.scenes[0];if(!a)throw Error("No scene");if(t.undoable){const a=e.allLayers.byId[t.layer.id];a&&Jl.add({undo:{type:"SET_STUDIO_FLIP_VERTICAL",layer:a,axis:t.axis},redo:{type:"SET_STUDIO_FLIP_VERTICAL",layer:t.layer,axis:t.axis}})}w({category:"Studio Set Layer Flipped",message:`Layer: ${t.layer.id}, Flipped Axis: ${t.axis}`});const{...o}=e.allLayers.byId,[n,r]=Yw(a.layers,t);return a.layers=n,o[r.id]=r,{...e,scenes:[a],updateKey:y(),allLayers:{byId:o}}}case"SET_STUDIO_ROTATION":{const a=e.scenes[0];if(!a)throw Error("No scene");if(t.undoable){const a=e.allLayers.byId[t.layer.id];a&&Jl.add({undo:{type:"SET_STUDIO_ROTATION",layer:a,rotation:null==(T=a.position)?void 0:T.rotation},redo:{type:"SET_STUDIO_ROTATION",layer:t.layer,rotation:t.rotation}})}w({category:"Studio Set Layer Rotation",message:`Layer: ${t.layer.id}, New Rotation: ${t.rotation}`});const{...o}=e.allLayers.byId,[n,r]=function(e,t){let{rotation:a}=t;a=a<0?360+a:a;let o=t.layer.position;for(const n of e)if(n.id===t.layer.id){"position"in n&&(o=n.position);break}return $w(e,t.layer.id,{position:{...o,rotation:a}},"layer","setRotation")}(a.layers,t);return a.layers=n,r&&(o[r.id]=r),{...e,scenes:[a],updateKey:y(),allLayers:{byId:o}}}case"SET_TIMELINE_GAP":{const{gapId:a,startTime:o,duration:n,timelineRow:r}=t,i={gapId:a,startTime:o,duration:n,timelineRow:r};return{...e,timelineGap:i}}case"SHOW_SNAP_LINES":return{...e,snapLines:t.lines};case"SORT_SUBTITLE_LAYERS":return{...e,scenes:[{...e.scenes[0],layers:ab(e.scenes[0].layers)}]};case"UPDATE_ANIMATION":return A(e,(a=>{var o;const n=(null==(o=a.animations)?void 0:o.byId)||{};if(n[t.animationId]={...n[t.animationId],...t.layerAnim},a.animations.byId=n,t.undoable){const a={type:"UPDATE_ANIMATION",animationId:t.animationId,layerAnim:e.animations.byId[t.animationId],undoable:!1},o={type:"UPDATE_ANIMATION",animationId:t.animationId,layerAnim:t.layerAnim,undoable:!1};Jl.add({undo:a,redo:o})}py("animations","byId",n,e.animations.byId,"UPDATE_ANIMATION_BY_ID")}));case"UPDATE_GROUP":return A(e,(e=>WN(t,e)));case"UPDATE_GROUPS":return A(e,(a=>{if(t.undoable){const a=Object.entries(t.updates).reduce(((t,[a,o])=>{const n=e.groups[a];if(n){const e=Object.keys(o),r={};e.forEach((e=>{r[e]=n[e]})),t[a]=r}return t}),{});Jl.add({undo:{type:"UPDATE_GROUPS",updates:a},redo:{type:"UPDATE_GROUPS",updates:t.updates}})}Object.entries(t.updates).forEach((([e,t])=>{WN({undoable:!1,groupId:e,updates:t,type:"UPDATE_GROUP"},a)}))}));case"UPDATE_LAYER":return A(e,(e=>MN(t,e)));case"UPDATE_LAYERS":return A(e,(a=>{const{...o}=e.allLayers.byId;if(t.undoable){const a=Object.entries(t.updates).reduce(((t,[a,o])=>{const n=e.allLayers.byId[a];if(n){const e=Object.keys(o),r={};e.forEach((e=>{r[e]=n[e]})),t[a]=r}return t}),{});Jl.add({undo:{type:"UPDATE_LAYERS",updates:a},redo:{...t,undoable:void 0}})}Object.entries(t.updates).forEach((([t,n])=>{const r=o[t]||e.deletedLayerDict[t];r&&MN({type:"UPDATE_LAYER",layer:r,properties:n},a)}))}));case"UPDATE_LAYERS_CUSTOM_UNDO":return A(e,(a=>{const{...o}=e.allLayers.byId,n=Object.entries(t.updates).reduce(((e,[t,{initialProperties:a,layerUpdates:o}])=>(e[t]={initialProperties:o,layerUpdates:a},e)),{});Jl.add({undo:{type:"UPDATE_LAYERS_CUSTOM_UNDO",updates:n},redo:{...t,undoable:void 0}}),Object.entries(t.updates).forEach((([e,t])=>{const n=o[e];n&&MN({type:"UPDATE_LAYER",layer:n,properties:t.layerUpdates,initialProperties:t.initialProperties},a)}))}));case"UPDATE_ALL_LAYERS":{const a=e.scenes[0];if(!a)throw Error("No scene");return A(e,(o=>{t.undoable&&Jl.add({undo:{type:"UPDATE_ALL_LAYERS",layers:a.layers,sceneIndex:t.sceneIndex},redo:{type:"UPDATE_ALL_LAYERS",layers:t.layers,sceneIndex:t.sceneIndex}}),t.layers.forEach(((e,t)=>{e&&(my(`layer_${e.id}`,e,a.layers[t],"UPDATE_ALL_LAYERS"),o.scenes[0].layers[t]=e,o.allLayers.byId[e.id]=e)})),o.duration=eb(null==o?void 0:o.scenes),my("duration",o.duration,e.duration,"UPDATE_ALL_LAYERS"),tb(e,o.duration,o.scenes)}))}case"UPDATE_LAYERS_NO_SYNC":{const a=S[0];if(!a)throw Error("No scene");const{...o}=e.allLayers.byId,{updates:n}=t;return Object.keys(n).forEach((e=>{const t=o[e];t&&(o[e]={...t,...n[e]})})),a.layers.forEach(((e,t)=>{n[e.id]&&(a.layers[t]={...e,...n[e.id]})})),I=eb(S),{...e,duration:I,scenes:[a],updateKey:y(),allLayers:{byId:o}}}case"UPDATE_SELECTED_TIMELINE_ROWS":{const t=e.selectedItem?Zw(e.selectedItem,e):e.selectedTimelineRows;return{...e,selectedTimelineRows:t}}case"UPDATE_UPLOADED_LAYER":return DN(t,e);default:return e}},jN=(e,t)=>{e.keyframing||(e.keyframing={},uy({path:["keyframing"],val:e.keyframing,oldVal:void 0,srcFn:"safelyGetChannels"}));let a=e.keyframing[t];return a||(a={},e.keyframing[t]=a,uy({path:["keyframing",t],val:a,oldVal:{},srcFn:"safelyGetChannels"})),a},GN=(e,t,a)=>{const o=jN(e,t);let n=o[a];return n||(o[a]={bezArray:[0,0,1,1],keyframes:[]},n=o[a],uy({path:["keyframing",t,a],val:n,oldVal:void 0,srcFn:"safelyGetChannelMeta"})),n},HN=(e,t,a)=>{const{layerId:o,undoable:n}=e,r=jN(t,o);delete t.keyframing[o],n&&Jl.add({undo:MI(o,r,!1),redo:FI(o)}),uy({path:["keyframing"],val:s.exports.get(t,["keyframing"]),oldVal:s.exports.get(a,["keyframing"]),srcFn:"DELETE_LAYER_KEYFRAMES"})},zN=(e,t,a)=>{var o;const{layerId:n,layerChannels:r,undoable:i}=e;if(!r)return;const l=null==(o=t.keyframing)?void 0:o[n];jN(t,n),t.keyframing[n]=r,i&&Jl.add({undo:MI(n,l,!1),redo:MI(n,r,!1)}),uy({path:["keyframing",n],val:s.exports.get(t,["keyframing",n]),oldVal:s.exports.get(a,["keyframing",n]),srcFn:"SET_LAYER_CHANNELS"})},$N=(e,t)=>{switch(t.type){case"UPSERT_KEYFRAME":{const{layerId:a,time:o,channel:n,value:r,undoable:i}=t;return N(e,(l=>{const d=GN(l,a,n),c=d.keyframes.find((e=>e.time===o));if(c){const e=c.value;c.value=r,i&&Jl.add({undo:AI(a,n,o,e,!1),redo:AI(a,n,o,r,!1)})}else d.keyframes.push({channel:n,time:o,value:r}),d.keyframes=d.keyframes.sort(((e,t)=>e.time-t.time)),i&&Jl.add({undo:NI(a,n,o,!1),redo:{...t,undoable:!1}});return uy({path:["keyframing",a,n,"keyframes"],val:s.exports.get(l,["keyframing",a,n,"keyframes"]),oldVal:s.exports.get(e,["keyframing",a,n,"keyframes"]),srcFn:"UPSERT_KEYFRAME"}),l}))}case"REMOVE_KEYFRAME":{const{layerId:a,time:o,channel:n,undoable:r}=t;return N(e,(t=>{const i=GN(t,a,n),l=i.keyframes.find((e=>e.time===o))||null;if(i.keyframes=i.keyframes.filter((e=>e.time!==o)),!i.keyframes.length&&l){const e=t.allLayers.byId[a];if(!e)throw Error("Layer not found");const o=((e,t,a,o)=>{var n;const r=e.allLayers.byId[t];if(!r)return{};const i=s.exports.cloneDeep((null==(n=e.keyframing)?void 0:n[r.id])||{});if(!i[a])return{};i[a].keyframes=[o];const l=ST(),d=e.width||0,c=e.height||0,u=Kb(r,i,l),m=ix(r,i,l),p=rx(r,i,l,d,c);return{zoom:m,position:{...r.position,...p},filters:u}})(t,a,n,l);MN({type:"UPDATE_LAYER",layer:e,properties:o},t)}return r&&(null==l?void 0:l.value)&&Jl.add({undo:AI(a,n,o,l.value,!1),redo:NI(a,n,o,!1)}),uy({path:["keyframing",a,n,"keyframes"],val:s.exports.get(t,["keyframing",a,n,"keyframes"]),oldVal:s.exports.get(e,["keyframing",a,n,"keyframes"]),srcFn:"REMOVE_KEYFRAME"}),t}))}case"TRIM_START_KEYFRAMES":{const{layerIdsToTimeChanges:a,undoable:o,maintainInterpolation:n}=t;return N(e,(t=>{Jl.execInUndoBatch((()=>{Object.entries(a).forEach((([a,r])=>{(({layerId:e,timeChange:t,undoable:a,maintainInterpolation:o,state:n,draft:r})=>{const i=Object.entries(jN(r,e));if(!i.length)return;const l={};i.forEach((([e,a])=>{const{keyframes:n,bezArray:r}=a,i=s.exports.cloneDeep(n),d=i.length;n.forEach((e=>{e.time+=t})),l[e]=i,a.keyframes=n.filter((e=>e.time>=0));const c=a.keyframes.length;if(o&&d!==c){const o=d-c,n=i[o-1],s=i[o];if(!n||!s)return;const l=Gb(e,r,n.time-(n.time+t),n,s);a.keyframes.unshift({channel:e,time:0,value:l})}})),a&&Jl.add({undo:LI(e,l,!1),redo:PI({[e]:t},o,!1)}),uy({path:["keyframing",e],val:s.exports.get(r,["keyframing",e]),oldVal:s.exports.get(n,["keyframing",e]),srcFn:"TRIM_START_KEYFRAMES"})})({layerId:a,timeChange:r,undoable:o,maintainInterpolation:n,state:e,draft:t})}))}))}))}case"TRIM_END_KEYFRAMES":{const{layerIdsToMaxTimes:a,maintainInterpolation:o,undoable:n}=t;return N(e,(t=>{Jl.execInUndoBatch((()=>{Object.entries(a).forEach((([a,r])=>{(({layerId:e,maxTime:t,undoable:a,maintainInterpolation:o,state:n,draft:r})=>{const i=Object.entries(jN(r,e));if(!i.length)return;const l={};i.forEach((([e,a])=>{var n,r;const{bezArray:i,keyframes:d}=a;l[e]=s.exports.cloneDeep(d);const c=a.keyframes.length;a.keyframes=d.filter((e=>e.time<=t));const u=a.keyframes.length;if(o&&c!==u){const o=null==(n=l[e])?void 0:n[u-1],s=null==(r=l[e])?void 0:r[u];if(o&&s){const n=Gb(e,i,t,o,s);a.keyframes.push({channel:e,time:t,value:n})}}})),a&&Jl.add({undo:LI(e,l,!1),redo:RI({[e]:t},o,!1)}),uy({path:["keyframing",e],val:s.exports.get(r,["keyframing",e]),oldVal:s.exports.get(n,["keyframing",e]),srcFn:"TRIM_END_KEYFRAMES"})})({layerId:a,maxTime:r,undoable:n,maintainInterpolation:o,state:e,draft:t})}))}))}))}case"SET_KEYFRAMES":{const{layerId:a,keyframesForChannels:o,undoable:n}=t;return N(e,(t=>{const r={};return Object.entries(o).forEach((([e,o])=>{const n=GN(t,a,e),i=s.exports.cloneDeep(n.keyframes);r[e]=i,n.keyframes=o})),n&&Jl.add({undo:LI(a,r,!1),redo:LI(a,o,!1)}),uy({path:["keyframing",a],val:s.exports.get(t,["keyframing",a]),oldVal:s.exports.get(e,["keyframing",a]),srcFn:"SET_KEYFRAMES"}),t}))}case"SPLIT_KEYFRAMES":return N(e,(a=>{const{leftLayerId:o,rightLayerId:n,studioTime:r,undoable:i}=t,l=a.allLayers.byId[o],d=a.allLayers.byId[n];if(!l||!d)return a;const[c]=zS(l),[u]=zS(d),m=jN(a,o),p={};return Object.entries(m).forEach((([e,t])=>{const o=GN(a,n,e),{keyframes:i,bezArray:s}=t,l=[],d=[];i.forEach((e=>{e.time<=r-c?l.push(e):(e.time-=u-c,d.push(e))}));const m=i.find((({time:e})=>e===r-c));if(p[e]=[],m){const t={channel:e,time:0,value:m.value};p[e].push(t),d.unshift(t)}else{const t=l[l.length-1],a=d[0];if(t&&a){const o=Gb(e,s,r-c,t,{...a,time:a.time+u-c}),n={channel:e,time:r-c,value:o},i={channel:e,time:0,value:o};p[e].push(n),p[e].push(i),l.push(n),d.unshift(i)}}t.keyframes=l,o.keyframes=d})),uy({path:["keyframing"],val:s.exports.get(a,["keyframing"]),oldVal:s.exports.get(e,["keyframing"]),srcFn:"SPLIT_KEYFRAMES"}),i&&Jl.add({undo:OI(o,n,u-c,p),redo:DI(o,n,r,!1)}),a}));case"UNDO_SPLIT_KEYFRAMES":return N(e,(a=>{const{leftLayerId:o,rightLayerId:n,timeCorrection:r,insertedFrames:i}=t,l=jN(a,n);return Object.entries(l).forEach((([e,t])=>{const n=i[e]||[],s=GN(a,o,e),l=t.keyframes;n.length>0&&l.shift(),2===n.length&&s.keyframes.pop(),l.forEach((e=>{e.time+=r,s.keyframes.push(e)})),s.keyframes=s.keyframes.sort(((e,t)=>e.time-t.time))})),delete a.keyframing[n],uy({path:["keyframing"],val:s.exports.get(a,["keyframing"]),oldVal:s.exports.get(e,["keyframing"]),srcFn:"UNDO_SPLIT_KEYFRAMES"}),a}));case"DELETE_LAYER_KEYFRAMES":return N(e,(a=>{HN(t,a,e)}));case"DELETE_MULTIPLE_LAYERS_KEYFRAMES":return N(e,(a=>{if(t.undoable){const e={};t.layerIds.forEach((t=>{const o=jN(a,t);e[t]=o})),Jl.add({undo:{type:"SET_MULTIPLE_LAYERS_CHANNELS",channelUpdates:e,undoable:!1},redo:{type:"DELETE_MULTIPLE_LAYERS_KEYFRAMES",layerIds:t.layerIds,undoable:!1}})}t.layerIds.forEach((t=>{HN({type:"DELETE_LAYER_KEYFRAMES",layerId:t,undoable:!1},a,e)}))}));case"SET_LAYER_CHANNELS":return N(e,(a=>{zN(t,a,e)}));case"SET_MULTIPLE_LAYERS_CHANNELS":return N(e,(a=>{Object.entries(t.channelUpdates).forEach((([t,o])=>{zN({type:"SET_LAYER_CHANNELS",layerId:t,layerChannels:o,undoable:!1},a,e)}))}));case"SHIFT_KEYFRAME_PLAYBACK_SPEED":return N(e,(a=>{const{layerId:o,oldPlaybackRate:n,newPlaybackRate:r,undoable:i}=t,l=+(n/r).toFixed(3);return Object.values(jN(a,o)).forEach((({keyframes:e})=>{e.forEach((e=>{e.time*=l}))})),i&&Jl.add({undo:UI(o,r,n),redo:UI(o,n,r)}),uy({path:["keyframing",o],val:s.exports.get(a,["keyframing",o]),oldVal:s.exports.get(e,["keyframing",o]),srcFn:"SHIFT_KEYFRAME_PLAYBACK_SPEED"}),a}));case"COPY_LAYER_KEYFRAMES":return N(e,(a=>{const{fromLayerId:o,toLayerId:n,undoable:r}=t,i=jN(a,o);return a.keyframing[n]=s.exports.cloneDeep(i),r&&Jl.add({undo:FI(n,!1),redo:BI(o,n,!1)}),uy({path:["keyframing"],val:s.exports.get(a,["keyframing"]),oldVal:s.exports.get(e,["keyframing"]),srcFn:"COPY_LAYER_KEYFRAMES"}),a}));default:return e}},KN=new Set(["fullPath","image_url"]),YN=new Set(["analytics","projectName","projectVersion","ratio","hasCustomOutput","customOutputWidth","customOutputHeight","topFontsLoaded","studioPaused","overlayMounted","isDragging","trackIsDragging","scenes","animations","allLayers","localId","deletedLayerLocalBlobDict","deletedLayerDict","selectedTimelineRows","groups","pendingGoogleDriveUploads","timelineGap","safeZoneChosen","snapToGrid","privacy","showCanvas","background","canvasBlur","duration","toolTip","videoType","imageType","gifType","exportFrameTime","quality","addedOptimizedLayer","draft","done","createdAt","fullPath","image_url","updateKey","refreshKey","lastSaved","dimensions","canvasDimensions","name","canvasX","canvasY","containerX","containerY","containerWidth","containerHeight","workspaceId","projectId","creatorId","creatorEmail","copiedProjectId","teamId","canvasPreviewSeekerTimestampId","contextMenuUsed","customFontsFetched","playCanvasPreviewOnMount","usedEyedropper","watermark","layerDuplicated","thisProjectCMLFiles","enhanceJobIds","userSpecificSettings","userSpecificSettingsAnonymous","selectedTransition","magicSubtitles","magicSubtitlesGlobal","magicSubtitleFramesByAsset","assetUploadedSubtitles","isCollaborating","presence","presentUserId","readonly","exportQuality","exportResolution","isBrandKitTemplate","fromBrandKitTemplate","keyframing"]),qN=z.v4(),XN=()=>({analytics:{},projectName:"",projectVersion:"0.7",ratio:"1:1",hasCustomOutput:!1,customOutputWidth:void 0,customOutputHeight:void 0,topFontsLoaded:!1,origin:"",studioPaused:!0,overlayMounted:!1,isDragging:!1,trackIsDragging:!1,scenes:[{id:qN,layers:[],background:"#ffffff",duration:0,userSelectedDuration:0,userSetDuration:!1,subtitle:{...Yi}}],animations:{byId:{},allIds:[]},allLayers:{byId:{}},localId:z.v4(),deletedLayerLocalBlobDict:{},deletedLayerDict:{},selectedTimelineRows:[0],groups:{},pendingGoogleDriveUploads:[],timelineGap:null,safeZoneChosen:"none",snapToGrid:!0,privacy:ii.unlisted,showCanvas:!1,background:"#ffffff",canvasBlur:!1,duration:0,toolTip:"",videoType:"mp4",imageType:"png",gifType:"gif",exportFrameTime:-1,quality:"standard",addedOptimizedLayer:!1,draft:!1,done:!1,createdAt:"",fullPath:"",image_url:"",updateKey:0,refreshKey:0,lastSaved:"",dimensions:{screenWidth:0,screenHeight:0},canvasDimensions:{canvasWidth:0,canvasHeight:0},name:"",canvasX:0,canvasY:0,containerX:0,containerY:0,containerWidth:0,containerHeight:0,workspaceId:null,projectId:null,creatorId:void 0,creatorEmail:void 0,copiedProjectId:void 0,teamId:void 0,canvasPreviewSeekerTimestampId:z.v4(),contextMenuUsed:0,customFontsFetched:!1,playCanvasPreviewOnMount:!1,usedEyedropper:!1,watermark:!1,layerDuplicated:!1,thisProjectCMLFiles:void 0,enhanceJobIds:{},userSpecificSettings:{},userSpecificSettingsAnonymous:{},selectedTransition:null,magicSubtitles:{},magicSubtitlesGlobal:{},magicSubtitleFramesByAsset:{},assetUploadedSubtitles:{},isCollaborating:!1,presence:{},presentUserId:"",readonly:!1,exportQuality:"Standard",exportResolution:"AUTO",isBrandKitTemplate:null,fromBrandKitTemplate:null,keyframing:void 0});const JN=e=>{const{groups:t}=(e=>{let t={...e.groups||{}};if(!e.selectedItem)for(const a of Object.keys(t)){const{groups:o}=ib({...e,groups:t},a);t=o}return{groups:t}})(e),{scenes:a}=(e=>{const t=new Set,a=e.scenes[0];if(!a)throw Error("No scene");return a.layers.forEach(((e,o)=>{t.has(e.id)&&a.layers.splice(o,1),t.add(e.id)})),{scenes:[a]}})(e);return{groups:t,scenes:a}},QN=(e,t)=>{var a;const o=s.exports.cloneDeep(XN()),{source:n}=t;((e,t)=>{if(Object.entries(t.studio).forEach((([a,o])=>{YN.has(a)&&(KN.has(a)?t.preserveId&&(e[a]=o):e[a]=o)})),!t.studio.scenes)for(const a of["layers","background","duration","isImageVideo"])e.scenes[0][a]=t.studio[a]})(o,t),t.studio.scenes&&t.studio.scenes.length&&!(null==(a=t.studio.scenes[0])?void 0:a.subtitle)&&(e=>{const t={backgroundColor:"rgba(0, 0, 0, 0.6)",backgroundOpacity:.6,backgroundStyle:"wrap",fixedPosition:.95,font:"Arial",fontColor:"#ffffff",fontSize:18,fontStyle:"normal",fontWeight:"bold",lineHeight:1.2,lineWidth:0,textAlign:"center",textShadow:"#000000",textVerticalAlign:"bottom"};t.updateSubtitlePosition=z.v4();const a=e.scenes[0];a&&(a.subtitle={...t})})(o),((e,t,a)=>{e.origin=t.origin,e.overlayWithHeader=t.overlayWithHeader,e.snapToGrid=t.snapToGrid,e.overlayMounted=t.overlayMounted,e.canvasDimensions=t.canvasDimensions||{canvasWidth:0,canvasHeight:0},t.width&&t.height&&(e.width=t.width,e.height=t.height,e.canvasX=t.canvasX,e.canvasY=t.canvasY,e.containerX=t.containerX,e.containerY=t.containerY,e.containerWidth=t.containerWidth,e.containerHeight=t.containerHeight);for(const o of e.scenes)o.layers.every((e=>{if("subtitle"===e.type)return!1;const a=Jw(e.id,t);return["video","image","audio"].includes(e.type)&&(e.local_url=(null==a?void 0:a.local_url)||""),!0}));e.duration=eb(e.scenes),e.studioPaused=t.studioPaused,a.preserveId&&(e._id=a.studio._id,e.projectId=a.studio.projectId);for(const o of e.scenes)o.layers.every((e=>{if("subtitle"===e.type)return!1;if("local"!==e.source)return!0;const a=Jw(e.id,t);return"local"!==(null==a?void 0:a.source)&&Object.assign(e,a),!0}));e.presentUserId=t.presentUserId,e.selectedItem=t.selectedItem})(o,e,t);const r=t.isFirstVideoLoad||"onGetSharedDoc"===t.source?JN(o):{},i=(e=>{const t={};for(const a of e.scenes)for(const e of a.layers)t[e.id]=e;return t})(o);return o.refreshKey=z.v4(),"onOp"!==n&&(o.pendingGoogleDriveUploads=[]),{...o,...r,allLayers:{byId:i}}},ZN=(e,t,a)=>{const o=e[0];if(!o)throw Error("No scene found");const n={subtitle:{...null==o?void 0:o.subtitle,...a}};if(a.backgroundColor){const e=a.backgroundColor===lp?0:null==o?void 0:o.subtitle.backgroundOpacity,t=Qv(a.backgroundColor,{a:e});n.subtitle.backgroundColor=t}if(a.backgroundOpacity){const e=Qv(null==o?void 0:o.subtitle.backgroundColor,{a:a.backgroundOpacity});n.subtitle.backgroundColor=e}const[r,i]=$w(e,o.id,n,"scene","updateSubtitle"),s=eb(r);return my("duration",s,t.duration,"updateSubtitle"),tb(t,s,r),{...t,duration:s,scenes:r,updateKey:z.v4()}},eP=(e=XN(),t)=>{let a=e,o=[...a.scenes],n=0;switch(a.allLayers||(a.allLayers={byId:{}}),a=pb(a,t),a=$N(a,t),a=VN(a,t),a=((e,t)=>"SET_ASSET_PARSED_SUBTITLE"===t.type?N(e,(a=>{var o,n;a.assetUploadedSubtitles&&0!==Object.keys(a.assetUploadedSubtitles).length||(a.assetUploadedSubtitles={},uy({path:["assetUploadedSubtitles"],oldVal:void 0,val:{},srcFn:"SET_ASSET_PARSED_SUBTITLE"}));const r=a.assetUploadedSubtitles[t.assetId];a.assetUploadedSubtitles[t.assetId]=t.subtitles?{subtitles:t.subtitles}:void 0,uy({path:["assetUploadedSubtitles",t.assetId],oldVal:r,val:a.assetUploadedSubtitles[t.assetId],srcFn:"SET_ASSET_PARSED_SUBTITLE"}),t.undoable&&Jl.add({undo:{...t,undoable:!1,subtitles:null==(n=null==(o=e.assetUploadedSubtitles)?void 0:o[t.assetId])?void 0:n.subtitles},redo:{...t,undoable:!1}})})):e)(a,t),t.type){case"RESET_STUDIO":case"RESET_STATE_PRESERVE_USER":oy();return s.exports.cloneDeep(XN());case"SET_VIDEO_ID":return A(a,(e=>{const o=t._id;e._id=o;for(const t of a.scenes)for(const a of t.layers){const{asset_id:t,cmlFileId:n}=a;o&&a.cmlFileId&&Hy(a.cmlFileId,o),t&&n&&ob(e,{asset_id:t,cmlFileId:n})}e.readonly=!1}));case"SET_IMAGE_URL":return{...a,image_url:t.image_url};case"SET_FULL_PATH":return uy({path:["fullPath"],oldVal:a.fullPath,val:t.fullPath,srcFn:"client-side"}),{...a,fullPath:t.fullPath};case"SET_VIDEO_DRAFT_INFO":return my("draft",t.draft,a.draft,"SET_VIDEO_DRAFT_INFO"),{...a,draft:t.draft,done:t.done,createdAt:t.createdAt,lastSaved:t.lastSaved};case"SET_STUDIO":return t.undoable&&Jl.add({undo:{...t,studio:a,undoable:!1},redo:{...t,undoable:!1}}),a.projectId!==t.studio.projectId&&oy(),t.sync&&window.sharedDoc&&function(e,t){const a=Xg(t);Object.entries(a).forEach((([a,o])=>{a&&o&&e.submitOp({p:[a],oi:o,od:e.data[a],__md:{srcFn:"client/syncVideoToSharedDoc",submittedAt:Date.now(),cv:t.projectVersion}})})),Object.entries(e.data).forEach((([o,n])=>{o&&n&&(a[o]||e.submitOp({p:[o],od:n,_md:{srcFn:"removeKeyFromSharedDoc",submittedAt:Date.now(),cv:t.projectVersion}}))}))}(window.sharedDoc,t.studio),QN(a,t);case"KAPWING_INIT":{if("scenes"in a){const e=JN(a);return n=eb(a.scenes),my("duration",n,a.duration,"KAPWING_INIT"),function(e){for(const t of Object.values(e.allLayers.byId))delete t.local_url,delete t.base64_img;e.scenes.forEach((e=>{e.layers.every((e=>!e||"subtitle"!==e.type&&(delete e.local_url,delete e.base64_img,!0)))}))}(a),{...a,...e,duration:n}}!function(e){e.scenes=[{id:qN,layers:e.layers,duration:e.duration,isImageVideo:!1,background:e.background}],e.selectedItem=null,e.duration=eb(e.scenes)}(a);const e=JN(a);return{...a,...e,deletedLayerLocalBlobDict:{},deletedLayerDict:{}}}case"SET_STUDIO_DIMENSIONS":return w({category:"Studio Update Dimensions",message:`Dimensions: ${JSON.stringify(t.dimensions)}`}),{...a,...t.dimensions,updateKey:window.sharedDoc&&null!==window.sharedDoc.type?z.v4():a.updateKey};case"SET_STUDIO_RATIO":return t.undoable&&Jl.add({undo:{type:"SET_STUDIO_RATIO",ratio:a.ratio},redo:{type:"SET_STUDIO_RATIO",ratio:t.ratio}}),my("ratio",t.ratio,a.ratio,"SET_STUDIO_RATIO"),{...a,ratio:t.ratio,updateKey:window.sharedDoc&&null!==window.sharedDoc.type?z.v4():a.updateKey};case"SET_CUSTOM_OUTPUT_SIZE":return t.undoable&&Jl.add({undo:{type:"SET_CUSTOM_OUTPUT_SIZE",hasCustomOutput:a.hasCustomOutput,customOutputWidth:a.customOutputWidth,customOutputHeight:a.customOutputHeight},redo:{type:"SET_CUSTOM_OUTPUT_SIZE",hasCustomOutput:t.hasCustomOutput,customOutputWidth:t.customOutputWidth,customOutputHeight:t.customOutputHeight}}),my("hasCustomOutput",t.hasCustomOutput,a.hasCustomOutput,"SET_CUSTOM_OUTPUT_SIZE"),my("customOutputWidth",t.customOutputWidth,a.customOutputWidth,"SET_CUSTOM_OUTPUT_SIZE"),my("customOutputHeight",t.customOutputHeight,a.customOutputHeight,"SET_CUSTOM_OUTPUT_SIZE"),{...a,hasCustomOutput:t.hasCustomOutput,customOutputWidth:t.customOutputWidth,customOutputHeight:t.customOutputHeight};case"SET_VIDEO_TYPE":return my("videoType",t.videoType,a.videoType,"SET_VIDEO_TYPE"),tb({...a,videoType:t.videoType},n,o),{...a,videoType:t.videoType,updateKey:window.sharedDoc&&null!==window.sharedDoc.type?z.v4():a.updateKey};case"SET_IMAGE_TYPE":return my("imageType",t.imageType,a.imageType,"SET_IMAGE_TYPE"),{...a,imageType:t.imageType,updateKey:window.sharedDoc&&null!==window.sharedDoc.type?z.v4():a.updateKey};case"SET_GIF_TYPE":return my("gifType",t.gifType,a.gifType,"SET_GIF_TYPE"),{...a,gifType:t.gifType,updateKey:window.sharedDoc&&null!==window.sharedDoc.type?z.v4():a.updateKey};case"SET_EXPORT_FRAME_TIME":return my("exportFrameTime",t.exportFrameTime,a.exportFrameTime,"SET_EXPORT_FRAME_TIME"),{...a,exportFrameTime:t.exportFrameTime,updateKey:window.sharedDoc&&null!==window.sharedDoc.type?z.v4():a.updateKey};case"SET_QUALITY":return my("quality",t.quality,a.quality,"SET_QUALITY"),{...a,quality:t.quality,updateKey:window.sharedDoc&&null!==window.sharedDoc.type?z.v4():a.updateKey};case"SET_EXPORT_QUALITY":return my("exportQuality",t.exportQuality,a.exportQuality,"SET_EXPORT_QUALITY"),{...a,exportQuality:t.exportQuality,updateKey:window.sharedDoc&&null!==window.sharedDoc.type?z.v4():a.updateKey};case"SET_EXPORT_RESOLUTION":return my("exportResolution",t.exportResolution,a.exportResolution,"SET_EXPORT_RESOLUTION"),{...a,exportResolution:t.exportResolution,updateKey:window.sharedDoc&&null!==window.sharedDoc.type?z.v4():a.updateKey};case"SET_ADDED_OPTIMIZED_LAYER":return my("addedOptimizedLayer",!0,a.addedOptimizedLayer,"SET_ADDED_OPTIMIZED_LAYER"),{...a,addedOptimizedLayer:!0,updateKey:window.sharedDoc&&null!==window.sharedDoc.type?z.v4():a.updateKey};case"SET_DRAGGING":return{...a,isDragging:t.isDragging};case"SET_TRACK_DRAGGING":return{...a,trackIsDragging:t.trackIsDragging};case"SET_RESIZING":return{...a,isResizing:t.isResizing};case"SET_ROTATING":return{...a,isRotating:t.isRotating};case"SET_ORIGIN":return{...a,origin:t.origin};case"SET_PLAY_CANVAS_PREVIEW_ON_MOUNT":return{...a,playCanvasPreviewOnMount:!0};case"PAUSE_STUDIO":return{...a,studioPaused:!0};case"PLAY_STUDIO":return{...a,studioPaused:!1};case"TOGGLE_STUDIO_PAUSED":return{...a,studioPaused:!a.studioPaused};case"SET_OVERLAY_MOUNTED":return{...a,overlayMounted:t.overlayMounted};case"UPDATE_SCENE":{if(t.undoable){const{scene:e}=t,a={};Object.keys(t.properties).forEach((t=>{const o=t;a[o]=e[o]}));const o=t.initialProperties||a;Jl.add({undo:{type:"UPDATE_SCENE",scene:e,properties:{...o}},redo:{type:"UPDATE_SCENE",scene:e,properties:{...t.properties}}})}const[e]=$w(o,t.scene.id,t.properties,"scene","UPDATE_SCENE");return o=[e[0]],n=eb(o),my("duration",n,a.duration,"UPDATE_SCENE"),tb(a,n,o),{...a,duration:n,scenes:o,updateKey:z.v4()}}case"SELECT_SAFEZONE":return{...a,safeZoneChosen:t.value,updateKey:z.v4()};case"SET_SNAP_TO_GRID":return{...a,snapToGrid:t.value,updateKey:z.v4()};case"ENABLE_SNAP_IN_TIMELINE":return tP("snapInTimeline",!0,t.userId,a);case"DISABLE_SNAP_IN_TIMELINE":return tP("snapInTimeline",!1,t.userId,a);case"SET_CANVAS_BLUR":return t.undoable&&Jl.add({undo:{type:"SET_CANVAS_BLUR",value:!t.value},redo:{type:"SET_CANVAS_BLUR",value:t.value}}),my("canvasBlur",t.value,a.canvasBlur,"SET_CANVAS_BLUR"),{...a,canvasBlur:t.value,updateKey:z.v4()};case"SET_USER_SPECIFIC_SETTING":return tP(t.key,t.value,t.userId,a);case"SHOW_STUDIO_CANVAS":return my("showCanvas",!0,a.showCanvas,"SHOW_STUDIO_CANVAS"),{...a,showCanvas:!0,updateKey:window.sharedDoc&&null!==window.sharedDoc.type?z.v4():a.updateKey};case"SET_STUDIO_BACKGROUND":{const e=o[0];if(!e)throw Error("No scene found");return t.undoable&&Jl.add({undo:{type:"SET_STUDIO_BACKGROUND",color:e.background},redo:{type:"SET_STUDIO_BACKGROUND",color:t.color}}),py(`scene_${e.id}`,"background",t.color,e.background,"SET_STUDIO_BACKGROUND"),e.background=t.color,my("background",t.color,a.background,"SET_STUDIO_BACKGROUND"),{...a,scenes:o,background:t.color,updateKey:window.sharedDoc&&null!==window.sharedDoc.type?z.v4():a.updateKey}}case"SET_IMAGE_VIDEO":{const e=a.scenes[0];if(!e)throw Error("No scene found");return py(`scene_${e.id}`,"isImageVideo",t.isImageVideo,e.isImageVideo,"SET_IMAGE_VIDEO"),e.isImageVideo=t.isImageVideo,n=eb(o),my("duration",n,a.duration,"SET_IMAGE_VIDEO"),tb(a,n,o),{...a,duration:n,scenes:o,updateKey:z.v4()}}case"SET_STUDIO_DURATION":{const e=a.scenes[0];return t.undoable&&Jl.add({undo:{type:"SET_STUDIO_DURATION",duration:a.duration},redo:{type:"SET_STUDIO_DURATION",duration:t.duration}}),e?(py(`scene_${e.id}`,"duration",t.duration,e.duration,"SET_STUDIO_DURATION"),e.duration=t.duration,n=function(e,t){const a=eb(t);return my("duration",a,e.duration,"updateStudioDurationFromScenes"),tb(e,a,t),a}(a,o),{...a,scenes:o,duration:n,updateKey:z.v4()}):{...a,duration:t.duration,updateKey:z.v4()}}case"UPDATE_LAST_SAVED":{const e=new Date;return my("lastSaved",e,a.lastSaved,"UPDATE_LAST_SAVED"),{...a,lastSaved:e}}case"SET_CANVAS_DIMENSIONS":return{...a,canvasDimensions:t.canvasDimensions};case"FORCE_UPDATE_CANVAS_PREVIEW_SEEKER_TIMESTAMP":return{...a,canvasPreviewSeekerTimestampId:z.v4()};case"UPDATE_SUBTITLE":{const e=a.scenes[0];return t.undoable&&e&&Jl.add({undo:{...t,properties:e.subtitle,undoable:!1},redo:{...t,undoable:!1}}),ZN(o,a,t.properties)}case"SET_SUBTITLES_FONT":return ZN(o,a,{font:t.font,hasCustomFont:t.hasCustomFont,url:t.url,fontType:t.fontType,source:t.source,asset_id:t.asset_id});case"SET_SUBTITLES_FONT_SIZE":return ZN(o,a,{fontSizeRaw:t.fontSize});case"SET_SUBTITLES_FONT_STYLE":return ZN(o,a,{fontStyle:t.fontStyle});case"SET_SUBTITLES_FONT_COLOR":return t.color?ZN(o,a,{fontColor:t.color}):{...a};case"SET_SUBTITLES_FONT_WEIGHT":return ZN(o,a,{fontWeight:t.fontWeight});case"SET_SUBTITLES_BACKGROUND_COLOR":return ZN(o,a,{backgroundColor:t.background});case"SET_SUBTITLES_BACKGROUND_STYLE":return ZN(o,a,{backgroundStyle:t.style});case"SET_SUBTITLES_LINE_WIDTH":return ZN(o,a,{lineWidth:t.lineWidth});case"SET_SUBTITLES_TEXT_ALIGN":return ZN(o,a,{textAlign:t.textAlign});case"SET_SUBTITLE_FIXED_POSITION":return ZN(o,a,{fixedPosition:t.position});case"SET_SUBTITLE_TEXT_VERTICAL_ALIGN":return ZN(o,a,{textVerticalAlign:t.textVerticalAlign});case"SET_ACTIVE_SUBTITLE_TEXT_AREA":return ZN(o,a,{textAreaId:t.textAreaId});case"SET_UPDATE_SUBTITLE_POSITION":return ZN(o,a,{updateSubtitlePosition:z.v4()});case"SET_SUBTITLES_TEXT_SHADOW":return ZN(o,a,{textShadow:t.textShadow});case"SET_SUBTITLES_FONT_SIZE_RATIO":return ZN(o,a,{fontSizeRatio:t.sizeRatio});case"SET_SUBTITLES_BACKGROUND_OPACITY":return ZN(o,a,{backgroundOpacity:t.bgOpacity});case"REMOVE_SUBTITLE":case"DUPLICATE_SUBTITLE":case"SET_SUBTITLE_TEXT":case"SET_HIGHLIGHT_SUBTITLES":case"SET_SUBTITLE_TIME":case"RESET_HIGHLIGHT_SUBTITLES":return{...a,updateKey:z.v4()};case"SET_EDIT_HISTORY_INDEX":return{...a,historyIndex:t.historyIndex,usedUndo:t.usedUndo,lastUndoTimestamp:t.usedUndo?Date.now():a.lastUndoTimestamp};case"SET_EDIT_HISTORY_INDEX_MINIMUM":return{...a,historyIndexMinimum:t.historyIndexMinimum};case"DISABLE_STUDIO_UNDO":return{...a,disableUndo:t.disableUndo};case"SET_EYEDROPPER_MODE":return{...a,eyedropperMode:t.status,usedEyedropper:!0};case Lf.UPDATE_ANALYTICS:{const e={...t.updates};return my("analytics",{...a.analytics,...e},a.analytics,"UPDATE_ANALYTICS"),{...a,analytics:{...a.analytics,...e}}}case"ADD_CONTEXT_MENU_ANALYTICS":return{...a,contextMenuUsed:a.contextMenuUsed?a.contextMenuUsed+1:1};case"SET_RIPPLE_MODE":return tP("rippleMode",t.rippleMode,t.userId,a);case"SET_COLLABORATING":return a.readonly?a:(my("isCollaborating",t.isCollaborating,a.isCollaborating,"SET_COLLABORATING",!0),{...a,isCollaborating:t.isCollaborating});case"INIT_PRESENCE":{const{presenceInfo:e,userId:o}=t;return Ey(a,e,o,"INIT_PRESENCE"),{...a,presence:{...a.presence,[o]:e}}}case"REMOVE_PRESENCE":{const{presenceInfo:e,userId:o}=t;!function(e,t,a){ly({p:["presence",t],od:e},{srcFn:a,skipLastUpdated:!0})}(e,o,"REMOVE_PRESENCE");const n={...a.presence};return delete n[o],{...a,presence:n}}case"UPDATE_PRESENCE":{const{presenceInfo:e,userId:o}=t;return Ey(a,e,o,"UPDATE_PRESENCE"),{...a,presence:{...a.presence,[o]:{...e}}}}case"SET_PRESENT_USER":return{...a,presentUserId:t.userId};case"ADD_GOOGLE_DRIVE_PENDING_UPLOAD":case"REMOVE_GOOGLE_DRIVE_PENDING_UPLOAD":case"UPDATE_GOOGLE_DRIVE_PENDING_UPLOAD":return lb(t,a);case"LINK_CML_FILE_TO_PROJECT":{const{assetId:e,cmlFileId:o,videoId:n}=t;return n&&Hy(o,n),A(a,(t=>{ob(t,{asset_id:e,cmlFileId:o})}))}case"UNLINK_CML_FILE_FROM_PROJECT":{const{cmlFileId:e,videoId:o}=t;return o&&async function(e,t){Gy((()=>pu(`/api/v1/cloudMediaLibrary/file/${e}/linkedVideo/${t}`).catch(console.error)))}(e,o),A(a,(t=>{nb(t,e)}))}case"SET_PROJECT_ID":return a.projectId!==t.projectId&&oy(),{...a,projectId:t.projectId};case Vw.type:case jw.type:case Gw.type:{const e=Date.now();return my("commentsLastUpdated",e,a.commentsLastUpdated,t.type),{...a,commentsLastUpdated:e}}case"SET_STUDIO_ID":return{...a,_id:t.id};case"SET_IS_BRANDKIT_TEMPLATE":return my("isBrandKitTemplate",t.isBrandKitTemplate,a.isBrandKitTemplate,t.type),{...a,isBrandKitTemplate:t.isBrandKitTemplate};default:return a}};function tP(e,t,a,o){var n;if(a){const r={...o.userSpecificSettings,[a]:{...null==(n=o.userSpecificSettings)?void 0:n[a],[e]:t}};return my("userSpecificSettings",r,o.userSpecificSettings,"updateUserSpecificSettings"),{...o,userSpecificSettings:r}}const r={...o.userSpecificSettingsAnonymous,[e]:t};return{...o,userSpecificSettingsAnonymous:r}}const aP=()=>tr((e=>e.workspaces.allWorkspaces.find((t=>t._id===e.workspaces.selectedWorkspace))));function oP(e){const{state:t}=tn(),{allWorkspaces:a}=t.workspaces;for(const o of a)if(e===o._id)return o;return null}function nP(e){const{state:t}=tn(),{allWorkspaces:a}=t.workspaces;for(const o of a)if(o._id===e)return!0;return!1}async function rP(e){var t;const{dispatch:a,state:o}=tn(),{currentUser:n}=o,{token:r,user:i}=n||{},{_id:s}=i||{};if(!e)return a(Su({description:"Could not grab user role. No workspace id found",type:"error"})),{};if(e===mi)return{role:ui.owner};const l=oP(e),d={token:r,userId:s,teamId:"",type:null!=(t=null==l?void 0:l.type)?t:Jr.personal,folderId:e};(null==l?void 0:l.teamId)&&"personal"!==l.teamId&&(d.teamId=l.teamId);try{return await hu(`/api/v1/workspaces/${e}/getUser`,{params:d})}catch(YEe){return console.error(YEe),YEe}}function iP(e){const{dispatch:t}=tn();t({type:"REMOVE_WORKSPACE",workspaceId:e})}function sP(e,t){const{dispatch:a}=tn();a(function(e,t){return{type:"CHANGE_WORKSPACE_NAME",workspaceId:e,newName:t}}(e,t))}function lP(e){if(e===mi)return"Shared with Me";const t=oP(e);return null==t?"":t.name||""}function dP(){const{dispatch:e}=tn();e(Su({description:"Your folder has been successfully deleted.",type:"success"}))}function cP(e){const{dispatch:t}=tn();t(Su({description:e,type:"warning"}))}function uP(){var e,t;const{state:a}=tn(),{allWorkspaces:o}=a.workspaces,{allTeams:n}=a.teams,r=(null==(e=n[0])?void 0:e._id)||null;return(null==(t=SE(o,r)[0])?void 0:t._id)||""}function mP(e){var t;const{allWorkspaces:a}=tn().state.workspaces;return(null==(t=SE(a,e)[0])?void 0:t._id)||""}function pP(e){return e.teamId&&"personal"!==e.teamId&&e.type===Jr.team}async function hP(e,t,a=""){const{dispatch:o,state:n}=tn(),{currentUser:r,teams:i,workspaces:l}=n,{allWorkspaces:d}=l,{selectedTeamId:c}=i,{token:u,user:m}=r||{},{_id:p}=m||{},h={token:u,userId:p,name:e||"Untitled Folder",type:t,teamId:a||c},{workspace:g}=await gu("/api/v1/createWorkspace",{body:h});return o(gv([g,...d])),o(yv(g._id)),vc("Create Folder",{Email:pc(r),"Folder ID":g._id,"Team ID":a||c,"Folder Type":s.exports.capitalize(Jr[t])}),g}async function gP(e){return(await hu(`/api/v1/workspaces/type/${e}`)).folderType}const yP={"/studio/editor":"Studio Project","/editor/subtitles":"Subtitles Project","/editor/resize":"Resized Project","/editor/add-audio-to-video":"Add Audio Project","/editor/image-to-video":"Image to Video Project","/editor/loop-video":"Looped Video Project","/editor/filters":"Filtered Video Project","/editor/convert":"Converted Video Project","/":"Studio Project","/editor/mute-video":"Muted Video Project","/editor/reverse":"Reversed Video Project","/editor/rotate":"Rotated Video Project","/editor/stop-motion":"Stop Motion Project","/editor/trimmer":"Trimmed Audio Project","/editor/video-speed":"Changed Speed Project"},fP={"3gp":!0,avi:!0,flv:!0,gif:!0,hls:!0,jpeg:!0,jpg:!0,mov:!0,mp3:!0,mp4:!0,png:!0,wmv:!0,webp:!0,webm:!0},EP={},vP=function(e,t,a){if(!t||0===t.length)return e();const o=document.getElementsByTagName("link");return Promise.all(t.map((e=>{if((e=function(e){return"/"+e}(e))in EP)return;EP[e]=!0;const t=e.endsWith(".css"),n=t?'[rel="stylesheet"]':"";if(!!a)for(let a=o.length-1;a>=0;a--){const n=o[a];if(n.href===e&&(!t||"stylesheet"===n.rel))return}else if(document.querySelector(`link[href="${e}"]${n}`))return;const r=document.createElement("link");return r.rel=t?"stylesheet":"modulepreload",t||(r.as="script",r.crossOrigin=""),r.href=e,document.head.appendChild(r),t?new Promise(((t,a)=>{r.addEventListener("load",t),r.addEventListener("error",(()=>a(new Error(`Unable to preload CSS for ${e}`))))})):void 0}))).then((()=>e()))};let wP=null,bP=!1;function _P(e,t){wP&&wP.issue(e,t)}const TP=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const e=ld().isPaid,{shouldTrack:t,userID:a,videoId:o}=tr((t=>{const{_id:a}=t.currentUser.user||{},o=t.studio._id;return{shouldTrack:"undefined"!=typeof window&&!window.Cypress&&!sl()&&!kn&&e,userID:a,videoId:o}}),ar);return r.exports.useEffect((function(){t&&!bP&&async function(e){const{default:t}=await vP((()=>import("./index.175d4a28.js").then((e=>e.i))),["assets/index.175d4a28.js","assets/vendor.96643be6.js"]),{default:a}=await vP((()=>import("./index.60500d7c.js").then((e=>e.i))),["assets/index.60500d7c.js","assets/vendor.96643be6.js","assets/index.175d4a28.js"]);wP=new t({projectKey:"XWKtmaC5j8aO78qMVX4v"});const o=wP.use(a({}));window.openReplayFetch=o;try{await wP.start({userID:e,forceNew:!1,metadata:{version:"v2023.06.13.1",amplitudeSession:Bc()}}),bP=!0,console.info("Started openreplay")}catch(n){if(console.info("openreplay failed to start: ",n),"string"==typeof n&&n.includes("capture limit has been reached"))return;b(n)}}(a)}),[t,a]),r.exports.useEffect((function(){t&&bP&&o&&wP&&wP.event("opened_video",o)}),[o,t]),null},reportOpenReplayIssue:_P},Symbol.toStringTag,{value:"Module"})),SP={versionNumber:"0.1",migrate:e=>{if(!e.scenes)return[];for(const t of e.scenes){for(const o of t.layers)for(const e of["duration","startTime","endTime","videoDelay"]){const t=o[e];t&&"number"==typeof t&&(o[e]=hb(t))}const{duration:e,maxLayerId:a}=yb(t);t.duration=e,t.maxLayerId=a}return e.duration&&(e.duration=e.scenes.reduce(((e,t)=>t.duration+e),0)),["scenes","duration"]}},IP=["intro","outro","constant"],xP=["id",...IP],kP=e=>{let t=e.duration;return"slow"===e.speed&&(t*=2),"fast"===e.speed&&(t/=2),t},CP={versionNumber:"0.6",migrate:e=>{if(!e.scenes)return[];const t=e.scenes.map((e=>e.layers.map((e=>e.id)))).flat(),a=new Set(t);if(t.length!==a.size){const t=new Set;return e.scenes=e.scenes.map((e=>({...e,layers:e.layers.filter((e=>!t.has(e.id)&&(t.add(e.id),!0)))}))),e.allLayers={byId:Object.fromEntries(e.scenes.map((e=>e.layers)).flat().map((e=>[e.id,e])))},["scenes","allLayers"]}return[]}},AP=(NP=[SP,{versionNumber:"0.2",migrate:e=>{e.animations={allIds:[],byId:{}};const t=["animations"];return e.scenes?(t.push("scenes"),e.scenes.forEach((t=>{t.layers.forEach((t=>{if(!t.animation)return;if("progress-bar"===t.animation.id)return void(t.animation={constant:["progress-bar"]});if(xP.every((e=>!(e in t.animation))))return void delete t.animation;if("id"in t.animation){const e=t.animation,a=e.animatesForever?"constant":"intro";t.animation={[a]:[e]}}IP.forEach((a=>{const o=t.animation[a];if(!o)return;const n=o.map((o=>{const n=$();if(o.transitionId){const[r,i]="intro"===a?[t.id,o.transitionLayerId]:[o.transitionLayerId,t.id],s=Object.values(e.animations.byId).find((e=>{if(!e.isCrossTransition)return!1;return("intro"===a?e.introLayerId:e.outroLayerId)===t.id}));if(s)return s.id;e.animations.allIds.push(n),e.animations.byId[n]={animationName:o.transitionId,id:n,isCrossTransition:!0,transitionDuration:kP(o),introLayerId:r,outroLayerId:i}}else e.animations.allIds.push(n),e.animations.byId[n]={animationName:o.id,id:n,isCrossTransition:!1,layerId:t.id,transitionDuration:kP(o)};return n}));t.animation[a]=n}))}))})),t):t}},{versionNumber:"0.3",migrate:e=>{var t,a,o,n;const r=[];if(!e.scenes||1===e.scenes.length&&0===Object.keys(null!=(t=e.audio)?t:{}).length)return r;r.push("scenes","duration");const i=[],s={background:(null==(a=e.scenes[0])?void 0:a.background)||"",duration:0,id:(null==(o=e.scenes[0])?void 0:o.id)||"",isImageVideo:!1,layers:[],subtitle:(null==(n=e.scenes[0])?void 0:n.subtitle)||{},userSelectedDuration:0,userSetDuration:!1};let l=0,d=-1;if(e.scenes.forEach((e=>{!s.isImageVideo&&e.isImageVideo&&(s.isImageVideo=!0),!s.background&&e.background&&(s.background=e.background),!s.id&&e.id&&(s.id=e.id),!s.subtitle&&e.subtitle&&(s.subtitle=e.subtitle),s.duration+=e.duration;let t=0;e.layers.forEach(((a,o)=>{d=Math.max(d,a.timelineRow||-1);let n=0;const{start:r,end:s}=Rd(a);"video"===a.type||"audio"===a.type?(a.videoDelay||(a.videoDelay=0),n=a.videoDelay+((s||0)-(r||0)),a.videoDelay=l+(a.videoDelay||0)):(a.isTrimmed||(a.isTrimmed=!0),n=s||0,a.startTime=l+(r||0),a.endTime=l+(s||0)),t=Math.max(t,n),o===e.layers.length-1&&(l+=t),i.push(a)}))})),e.audio&&0!==Object.keys(e.audio).length){const t=e.audio,a={asset_id:t.asset_id,cmlFileId:t.cmlFileId,duration:t.duration,hasAudio:t.hasAudio,height:t.height,id:t.id,mime:t.mime,name:t.name,objectFit:t.objectFit,timelineRow:d+1,videoDelay:t.videoDelay,url:t.url,source:t.source,type:"audio",position:{height:"100%",rotation:0,width:"100%",x:"0%",y:"0%"},startTime:0,endTime:t.duration>s.duration?s.duration:t.duration,volume:1};e.audio={},r.push("audio"),i.push(a)}return s.layers=i,s.duration=hb(s.duration),e.duration=s.duration,e.scenes=[s],r}},{versionNumber:"0.4",migrate:e=>{if(!e.scenes)return[];return e.scenes[0]&&e.scenes[0].layers.forEach((e=>{if("string"==typeof e.fontSize){const t=e.fontSize;e.fontSize=t.includes("px")?parseFloat(t.slice(0,t.length-2)):parseFloat(t)}})),["scenes"]}},{versionNumber:"0.5",migrate:e=>{if(!e.scenes)return[];let t=!1;for(const a of e.scenes)for(const e of a.layers)"text"===e.type&&""===e.textShadow&&(e.textShadow="transparent",t=!0);return t?["scenes"]:[]}},CP,{versionNumber:"0.7",migrate:e=>{if(e.magicSubtitleFrames){const t={};for(const[a,o]of Object.entries(e.magicSubtitleFrames||{})){if(null===o)continue;const e={byId:{},orderedFrames:[]},n=o.filter(Boolean);for(const t of n)e.byId[t.id]=t,e.orderedFrames.push(t.id);t[a]=e}return e.magicSubtitleFramesByAsset=t,delete e.magicSubtitleFrames,["magicSubtitleFramesByAsset","magicSubtitleFrames"]}return[]}}],function(e,t){const a=[];for(const o of NP){const n=PP(o.versionNumber),r="Older"===DP(e,n),i="Newer"!==DP(n,t);r&&i&&a.push(o)}return a});var NP;function PP(e){return e?e.split(".").map((e=>parseInt(e))):[0,0]}var RP=(e=>(e.Equal="Equal",e.Newer="Newer",e.Older="Older",e))(RP||{});function LP(e,t){return e[0]<t[0]||e[0]===t[0]&&e[1]<t[1]}function DP(e,t){return LP(e,t)?"Older":LP(t,e)?"Newer":"Equal"}function OP(e){return jc.get(`session_${e}`,{disabled:null})}const FP=g({initialState:{byId:{}},name:"assets",reducers:{assetTranscriptionFailed:(e,t)=>{const{assetId:a,languageKey:o}=t.payload,n=e.byId[a]||{};delete n[o],e.byId[a]=n},assetTranscriptionFetched:(e,t)=>{t.payload.forEach((({assetId:t,languageKey:a,status:o})=>{const n=e.byId[t]||{};n[a]=o,e.byId[t]=n}))}}}),{assetTranscriptionFailed:MP,assetTranscriptionFetched:UP}=FP.actions,BP=(e,t,a)=>{Object.keys(t).forEach((o=>{if("asset_id"===o){const o=e.assetIdByLayerId[a],n=t.asset_id;if(e.assetIdByLayerId[a]=n,o&&e.layerIdsByAssetId[o]){const t=e.layerIdsByAssetId[o]||[];e.layerIdsByAssetId[o]=t.filter((e=>e!==a))}const r=e.layerIdsByAssetId[n];r?r.push(a):e.layerIdsByAssetId[n]=[a]}}))},WP=(e,t,a)=>{if(a&&(e.assetIdByLayerId[t]&&delete e.assetIdByLayerId[t],e.layerIdsByAssetId[a])){const o=e.layerIdsByAssetId[a]||[];e.layerIdsByAssetId[a]=o.filter((e=>e!==t))}},VP=g({initialState:{byId:{},layerIdsByAssetId:{},assetIdByLayerId:{}},name:"assets",reducers:{assetsFetched:(e,t)=>{t.payload.forEach((t=>{e.byId[t._id]=t}))},changeAssetFileName:(e,t)=>{void 0!==e.byId[t.payload.id]&&(e.byId[t.payload.id].name=t.payload.newFileName)}},extraReducers:e=>{e.addCase(UP,((e,t)=>{t.payload.forEach((t=>{const a=e.byId[t.assetId];if(a){a.transcriptionIds||(a.transcriptionIds={});const e=a.transcriptionIds[t.languageKey];e?"pending"===t.status.state?e.job=t.status.transcriptionId:e.result=t.status.assetTranscriptionId:"pending"===t.status.state&&(a.transcriptionIds[t.languageKey]={job:t.status.transcriptionId})}}))})),e.addCase("SET_STUDIO",((e,t)=>{if(!t.studio.scenes||!t.studio.scenes[0])return;const{layers:a}=t.studio.scenes[0];for(const o of a){if(!o.asset_id)continue;e.assetIdByLayerId[o.id]=o.asset_id;const t=e.layerIdsByAssetId[o.asset_id];t?t.includes(o.id)||t.push(o.id):e.layerIdsByAssetId[o.asset_id]=[o.id]}})),e.addCase("ADD_LAYERS",((e,t)=>{t.layers.forEach((t=>{if(!t.asset_id)return;e.assetIdByLayerId[t.id]=t.asset_id;const a=e.layerIdsByAssetId[t.asset_id];a?a.includes(t.id)||a.push(t.id):e.layerIdsByAssetId[t.asset_id]=[t.id]}))})),e.addCase("REMOVE_LAYER",((e,t)=>{WP(e,t.layer.id,t.layer.asset_id)})),e.addCase("REMOVE_LAYERS",((e,t)=>{t.layers.forEach((t=>{WP(e,t.id,t.asset_id)}))})),e.addCase("UPDATE_LAYER",((e,t)=>{BP(e,t,t.layer.id)})),e.addCase("UPDATE_LAYERS",((e,t)=>{Object.entries(t.updates).forEach((([t,a])=>{BP(e,a,t)}))})),e.addCase("UPDATE_LAYERS_CUSTOM_UNDO",((e,t)=>{Object.entries(t.updates).forEach((([t,a])=>{BP(e,a.layerUpdates,t)}))}))}}),{assetsFetched:jP,changeAssetFileName:GP}=VP.actions;function HP(e,t={}){if(e.layers)return e;const a={...t,scenes:[]};for(const o in e)if(!o.startsWith("scene_")&&!o.startsWith("layer_")&&!["scenes","layers"].includes(o)&&"lastUpdatedByPOST"!==o)if("allLayers"===o){const t=s.exports.cloneDeep(e.allLayers);(null==t?void 0:t.byId)&&Object.values(t.byId).forEach((e=>{delete e.local_url})),a.allLayers=t}else a[o]=e[o];return"scenes"in e&&(a.scenes=e.scenes.map((t=>{const a=[...new Set(e[`scene_${t}_layers`]||[])];return{...e[`scene_${t}`],layers:a.filter((t=>null!=e[`layer_${t}`])).map((t=>e[`layer_${t}`])).map((e=>(delete e.local_url,e)))}}))),s.exports.cloneDeep(a)}function zP(){const{teams:e}=tn().state,{allTeams:t,selectedTeamId:a}=e;return!(0===t.length||!a)&&t.some((e=>e._id===a))}async function $P(e,t){const a={teamId:e,fromVideoId:t};try{await gu("/api/v1/requests/teams",{body:a})}catch(YEe){Iu({description:"Failed to request to join team",error:YEe})}}async function KP(e){try{const{name:t,_id:a}=await hu(`/api/v2/teams/teamIdAndName/${e}`);return{name:t,teamId:a}}catch(YEe){console.error(YEe)}return{}}async function YP(){const{state:e}=tn();if(!sc(e.currentUser))return[];let t;try{t=(await hu(`/api/v1/requests/userId/pending/${e.currentUser.user._id}`)).requests}catch(YEe){console.error(YEe)}return t}const qP=e=>{const{state:t}=tn(),{workspaces:{allWorkspaces:a}}=t;return a.find((t=>t._id===e))};async function XP(){const{dispatch:e}=tn();let t;try{t=await gu("/api/v2/teams/suggested"),t&&e(zv(t))}catch(YEe){console.error(YEe,"There was an error while fetching suggested workspaces.")}return t}function JP(e){return{type:"SET_PROJECT_NAME",projectName:e}}function QP(e){return{type:"SET_EXPORT_RESOLUTION",exportResolution:e}}function ZP(e){return{type:"SET_EXPORT_QUALITY",exportQuality:e}}function eR(){return{type:"SET_ADDED_OPTIMIZED_LAYER"}}function tR(e){return{type:"SET_IS_BRANDKIT_TEMPLATE",isBrandKitTemplate:e}}function aR({video:e,source:t,preserveId:a=!1,preserveStudioTime:o=!1,origin:n=!1,undoable:r=!1,sync:i=!1,isFirstVideoLoad:s}){const{state:{studio:{_id:l}}}=tn();return{type:"SET_STUDIO",source:t,studio:e,preserveId:a,preserveStudioTime:o,projectIdChanged:!!l&&l!==e._id,origin:n,undoable:r,sync:i,isFirstVideoLoad:s}}function oR(){return{type:"RESET_STUDIO"}}const nR=(e,t)=>({type:"LINK_CML_FILE_TO_PROJECT",assetId:e.asset_id,cmlFileId:e.id,videoId:t}),rR=(e,t)=>({type:"UNLINK_CML_FILE_FROM_PROJECT",cmlFileId:e,videoId:t});class iR{constructor(){a(this,"first",!0),a(this,"amIFirst",(()=>!!this.first&&(this.first=!1,!0)))}}function sR(){return{type:"KAPWING_INIT"}}function lR(e){return{type:"SET_CURRENT_VIDEO",video:e}}function dR(e){return{type:"UPDATE_CURRENT_VIDEO",videoUpdates:e}}function cR(e){return{type:"SET_VIDEO_JUST_SAVED",justSaved:e}}function uR(e){return{type:e?"SET_VIDEO_SAVING":"CLEAR_VIDEO_SAVING"}}function mR(){return{type:"RESET_CURRENT_VIDEO"}}async function pR(e){return await hu("/api/v1/teamWorkspaces",{params:e})}async function hR(e){return await hu("/api/v1/workspaces",{params:e})}function gR(e="",t=!1){return async(a,o)=>{var n,r,i,s,l;const{currentUser:d,teams:c,workspaces:u}=o(),{allTeams:m,selectedTeamId:p}=c,{allWorkspaces:h}=u,{token:g,user:y}=d||{};let f,E=e;if(t)f=t;else if(e===mi)a(yv(mi));else if(e&&function(e,t,a){if(!a.length||!t.length)return!1;const o=a.find((t=>t._id===e));if(!o)return!1;const n=o.teamId;return!!n&&!!t.find((e=>e._id===n))}(e,m,h)){f=p;const t=qP(e);(null==t?void 0:t.type)===Jr.personal&&(null==t?void 0:t.creatorId)!==y._id&&(E="")}else f=null!=(r=null==(n=m[0])?void 0:n._id)?r:"",E="";"personal"===f&&(f="");const v={token:g,teamId:f},[w,b]=await Promise.all([pR(v),hR(v)]);if(E!==mi&&w.length>0){if(a(gv([...w,...b])),!E){const e=mP(f||(null==(i=w[0])?void 0:i.teamId));return a(LE(f||(null==(s=w[0])?void 0:s.teamId))),a(yv(e)),e}return a(LE(f||(null==(l=w[0])?void 0:l.teamId))),a(yv(E)),E}if(a(gv([...w||[],...b])),!E){const e=uP();return a(yv(e)),e}return E}}function yR(e){const{token:t,user:a}=tn().state.currentUser||{};return gu(`/api/v1/admin/${e}/operations`,{params:{token:t,userId:a&&a._id}})}function fR(e){return{id:e.id,type:e.type}}function ER(e,t,a,o){var n,r,i,s;try{if(!(e._id&&t._id&&String(e._id)===String(t._id)))return;const l=(null==(r=null==(n=e.scenes)?void 0:n[0])?void 0:r.layers)||[],d=(null==(s=null==(i=t.scenes)?void 0:i[0])?void 0:s.layers)||[],c=l.length,u=d.length,m=u-c;0!==c&&c!==u&&Math.abs(m)>=o&&(p("Potential mongodb/sharedb conflict",{extra:{currentLayerLen:c,newLayerLen:u,currentLayers:JSON.stringify(l.map(fR)),newLayers:JSON.stringify(d.map(fR)),currentVideo:e,newVideo:t,source:a,__FORCE_SAMPLE:!0},tags:{overwriteSource:a}}),_P("Potential lost work",{currentLayerLen:c,newLayerLen:u}),vc("Potential lost work",{currentLayerLen:c,newLayerLen:u,diff:m,overwriteSource:a}))}catch(l){console.error(l),b(l)}}function vR({video:e,source:t,dispatch:a,preserveId:o,preserveStudioTime:n=!1,sync:r=!1,isFirstVideoLoad:i,undoable:s=!1}){if(e.isCreator||e.isStudio){const{state:l}=tn();a(aR({video:e,source:t,preserveId:o,preserveStudioTime:n,sync:r,origin:l.studio.origin,undoable:s,isFirstVideoLoad:i}))}if(o||(delete e._id,e.studio&&delete e.studio._id),a(lR(e)),e.scenes){const t=e.scenes[0];t&&t.layers.find((({type:e})=>"subtitle"===e))&&a({type:"SORT_SUBTITLE_LAYERS"})}return i&&e.scenes&&(async function(e){const t=new Set;if(e.scenes.forEach((e=>{e.layers.every((e=>"subtitle"!==e.type&&("text"===e.type||"text-to-speech"===e.usedProFeature||e.asset_id&&!e.cmlFileId&&t.add(e.asset_id),!0)))})),!t.size)return;const a=Array.from(t.values()),{assets:o,cml_files:n}=await zy(a,!1),{dispatch:r,state:i}=tn();m.exports.batch((()=>{r(jP(o)),r(Ly(n));const t=Xk(i);n.forEach((a=>{r(nR(a,e._id));const o={};for(const e of t)e.asset_id===a.asset_id&&(o[e.id]={cmlFileId:a.id});px(o,!1)}))}))}(e),function(e){const{dispatch:t,state:{mediaCache:a}}=tn();m.exports.batch((()=>{e.scenes.forEach((e=>{e.layers.every((e=>{if("subtitle"===e.type)return!1;if(!e.asset_id)return!0;if(a.assetIdToMediaCacheId[e.asset_id])return!0;const o=y();return t(Nr({assetId:e.asset_id,mediaCacheId:o})),e.uploadId&&t(Pr({uploadId:e.uploadId,mediaCacheId:o})),!0}))}))}))}(e)),e}function wR({id:e,preserveId:t=!1,preservePreviousId:a=!1,forEditing:o=!1,fetchDraft:n=!1,forDebugPage:r=!1,forTemplate:i=!1,undoable:s=!1,sync:l=!1,fromBrandTemplate:d="",projectIsBrandTemplate:c=!1}){return async u=>{const m=await bR({dispatch:u,id:e,forDebugPage:r,restoreAndReturnAssets:o,forTemplate:i,fetchDraft:n,forEditing:o});if(!m)throw new Error("Video object undefined while fetching video");d&&(m.isBrandKitTemplate=null,m.fromBrandKitTemplate=d),c&&(m.isBrandKitTemplate="published");const p=new iR;return TR({dispatch:u,video:m,fetchDraft:n,forTemplate:i,preserveId:t,preservePreviousId:a,sync:l,firstTracker:p,undoable:s})}}async function bR({dispatch:e,id:t,forDebugPage:a,restoreAndReturnAssets:o,forEditing:n,forTemplate:r,fetchDraft:i,cancellationSource:s}){const{state:l}=tn(),{token:d,user:c}=l.currentUser||{},u={restoreAndReturnAssets:o,editing:n,fetchCMLFiles:!0,fetchDraft:i,id:t,supportedVersion:"0.7",token:d,userId:c&&c._id};r&&(u.forTemplate=!0),a&&(u.forDebugPage=!0);const{assets:m,assetTranscriptions:p,cmlFiles:h,video:g}=await hu("/api/v1/videos/getVideo_v2",{params:u,retries:3,timeout:1e4}),y=r?g.name:await async function(e,t,a){return(await hu(`/api/v1/projectname/${e}`)).projectName||yP[a]}(g.projectId,0,g.editorPath);if(s&&s.cancelled)return null;if(null!=y&&e(JP(y)),r&&_v(l.studio.projectId||"",{name:y},l.currentUser),g.creatorId&&!g.creatorEmail&&d){const e={id:g.creatorId};try{const{user:t}=await hu("/api/v1/users/getUserById",{params:e});g.creatorEmail=t.email}catch(f){console.error("Could not get user by id",f)}}if(g.localId){const t=OP(g.localId);t&&e(_r(t));const a=jc.get(`video_usage_${g.localId}`,{disabled:null});UT(a)}if(e(jP(m)),e(Ly(h)),p){const t=[];for(const e of p)"asset_transcription"===e.type?t.push({assetId:e.assetId,languageKey:e.languageKey,status:{assetTranscriptionId:e.assetTranscription._id,state:"completed",languageKey:e.languageKey,words:e.assetTranscription.words}}):t.push({assetId:e.assetId,languageKey:e.languageKey,status:{assetDuration:e.assetDuration,assetId:e.assetId,transcriptionId:e.transcriptionJob._id,progress:e.transcriptionJob.progress,languageKey:e.languageKey,state:"pending"}});e(UP(t))}return g}async function _R(e,t){if(e)try{const a=await hu(`/api/v1/videos/${e}/comments`);a&&(a.sort(((e,t)=>e._id<t._id?-1:1)),t(Mw(a)))}catch(YEe){Iu({description:"Failed to load comments",error:YEe})}t(Ww(!1))}function TR({dispatch:e,video:t,fetchDraft:a,forTemplate:o,preserveId:n,preservePreviousId:r,sync:i=!1,firstTracker:s,undoable:l}){var d,c,u,m;const{state:p}=tn();if(r&&(t._id=p.studio._id,t.projectId=p.studio.projectId),a){const a=HP(t,{_id:t._id});return o||ER(p.studio,a,"Get Video Sync",1),vR({video:a,source:"getVideoSharedDoc",dispatch:e,preserveId:n||r,sync:i,isFirstVideoLoad:s.amIFirst(),undoable:l})}return o?(t.workspaceId=p.workspaces.selectedWorkspace,t.creatorId=null==(c=null==(d=p.currentUser)?void 0:d.user)?void 0:c._id,t.creatorEmail=null==(m=null==(u=p.currentUser)?void 0:u.user)?void 0:m.email,t.projectName=t.name,t.teamId=p.teams.selectedTeamId):ER(p.studio,t,"Get Video No Sync",1),vR({video:t,source:"getVideo",dispatch:e,preserveId:n||r,sync:i,isFirstVideoLoad:s.amIFirst(),undoable:l})}class SR{constructor(e){a(this,"frame"),a(this,"fps"),a(this,"q"),a(this,"size"),a(this,"time"),a(this,"bitrate"),a(this,"speed");const t=e.match(/frame=\s*([0-9]*)\s*fps=\s*([0-9.]*)\s*q=([0-9.]*)\s*size=\s*([0-9]*).*time=([0-9:.]*).*bitrate=\s*([0-9.]*)kbits\/s\s*(.*)speed=([0-9.]*)/);if(!t)return;const[o,n,r,i,s,l,d,c]=t;this.frame=parseInt(null!=n?n:""),this.fps=parseInt(null!=r?r:""),this.q=parseInt(null!=i?i:""),this.size=parseInt(null!=s?s:"");const[u=0,m=0,p=0]=(null!=l?l:"").split(":").map((e=>parseInt(e)));this.time={hours:u,minutes:m,seconds:p},this.bitrate=parseFloat(null!=d?d:""),this.speed=parseFloat(null!=c?c:"")}}function IR(e,t){const a=e._malloc(t.length*Uint32Array.BYTES_PER_ELEMENT);return t.forEach(((t,o)=>{const n=function(e,t){const a=e._malloc((t.length+1)*Uint8Array.BYTES_PER_ELEMENT);for(let o=0;o<t.length;o+=1)e.setValue(a+o,t.charCodeAt(o),"i8");return e.setValue(a+t.length,0,"i8"),a}(e,t);e.setValue(a+4*o,n,"i32")})),a}function xR(e){const t=[];let a=0,o=0;for(;(a=e.indexOf(" ",o))>=0;){let n=e.substring(o,a),r=n.indexOf("'"),i=n.indexOf('"');if(0===r||0===i){const r=n[0];if(!r)throw Error("Missing delimiter");const i=e.indexOf(r,o+1);if(i<0)throw new Error(`Bad command escape sequence ${r} near ${a}`);n=e.substring(o+1,i),o=i+2,t.push(n)}else if(r>0||i>0){-1===r&&(r=1/0),-1===i&&(i=1/0);const s=r<i?"'":'"',l=Math.min(r,i),d=e.indexOf(s,o+l+1);if(d<0)throw new Error(`Bad command escape sequence ${s} near ${a}`);n=e.substring(o,d+1),o=d+2,t.push(n)}else""!==n?(t.push(n),o=a+1):o=a+1}return o!==e.length&&t.push(e.substring(o)),t}class kR{constructor(){if(a(this,"moduleFactory"),a(this,"instance"),a(this,"ffmpegMain"),a(this,"FS"),a(this,"duration"),a(this,"defaultArgs",["./ffmpeg","-nostdin","-hide_banner"]),a(this,"currLog"),a(this,"currLogProxy"),a(this,"logs",[]),a(this,"logsProxy",[]),a(this,"allMessages",[]),a(this,"lastFFmpegStdout"),!window||!window.createModule)throw new Error("createModule does not exist on window. Ensure that ffmpeg-core.js      is included via a script tag, and that it exports a createModule function.");this.moduleFactory=window.createModule()}logInDev(e){(window.location.href.includes("kapwing-dev")||window.location.href.includes("localhost"))&&console.info(e)}abort(){}isSupportedByClient(){const e=(new f.exports.UAParser).getBrowser();return!!(navigator.hardwareConcurrency>=4&&e.name.startsWith("Chrome")&&parseFloat(e.version)>=74)}modulePromise(){return new Promise((e=>this.moduleFactory.then((t=>{delete t.then,e(t)}))))}async initialize(e){try{this.instance||(this.instance=await this.modulePromise())}catch(YEe){if(YEe instanceof Error)throw YEe;const{message:t}=xu(YEe);throw new Error(t)}this.ffmpegMain=this.instance.cwrap("proxy_main","number",["number","number"]),this.FS=this.instance.FS,this.instance.setLogger((t=>{let a;if(!this.duration){const e=/Duration:\s*([0-9][0-9]:[0-9][0-9]:[0-9][0-9]\.[0-9][0-9])/,a=t.message.match(e);a&&a[1]&&(this.duration=a[1])}if(new SR(t.message).frame){if(this.allMessages.length>0){const e=t.message.replace(this.lastFFmpegStdout,"");this.allMessages.push(e),a=e}else this.allMessages.push(t.message),a=t.message;this.lastFFmpegStdout=t.message}const o=()=>{const{dispatch:e}=tn();e(dR({progressText:this.allMessages.join("\n")}))};function n(e){const[t,a,o]=e.split(":");return 60*parseFloat(null!=t?t:"0")*60+60*parseFloat(null!=a?a:"0")+parseFloat(null!=o?o:"0")}if(this.allMessages.length>0&&this.allMessages.length%5==0&&o(),this.logsProxy.push(t),this.currLog=t,this.currLogProxy&&(this.currLogProxy.currLog=t),a&&a.startsWith("frame")){const t=a.split("time=")[1].split(" ")[0],o=n(null!=t?t:""),r=n(this.duration);this.logInDev({progress:o/r}),e&&e(o/r)}else a&&a.startsWith("video:")&&(this.logInDev({progress:1}),e&&e(1))}))}async runCommandOnFile(e,t,a,o="output.mp4"){this.logInDev(e),a=a.replaceAll(" ","");try{void 0===this.instance&&await this.initialize(),await this.writeFile(a,t);const e=this.readVideoFile(o);return this.logInDev(URL.createObjectURL(e)),this.FS.unlink(a),this.FS.unlink(o),e}catch(YEe){if(YEe instanceof Error)throw YEe;const{message:t}=xu(YEe);throw new Error(t)}}async run(e){const t=Date.now(),a=[...this.defaultArgs,...xR(e)].filter((e=>0!==e.length)),o=IR(this.instance,a);return new Promise(((e,n)=>{const r={set(a,o,r){if(a[o]=r,"ffmpeg-stdout"===r.type&&"FFMPEG_END"===r.message){if("Conversion failed!"===a[a.length-2].message){const e=()=>{let e="";return e+=`1)${a[a.length-5].message}\n2)${a[a.length-4].message}\n3)${a[a.length-3].message}`,e},o={timeToError:(Date.now()-t)/1e3,message:a.length>=5?e():"Unable to get error messages."};n(o)}else e((Date.now()-t)/1e3)}return!0}};this.logsProxy=new Proxy(this.logs,r),this.ffmpegMain(a.length,o)}))}readVideoFile(e){const t=this.FS.readFile(e);return new File([t.buffer],e,{type:"video/mp4"})}async writeFile(e,t){if(t instanceof File||t instanceof Blob){const a=await t.arrayBuffer(),o=new Uint8Array(a);this.FS.writeFile(e,o)}else if(t.startsWith("blob:")){const a=await fetch(t).then((e=>e.blob())),o=await a.arrayBuffer(),n=new Uint8Array(o);this.FS.writeFile(e,n)}else{const a=await fetch(t),o=await a.arrayBuffer(),n=new Uint8Array(o);this.FS.writeFile(e,n)}}}const CR=S("ffmpegTranscode",(async(e,t)=>{const a=new kR;try{const o=e=>{t.dispatch(NR(e))};await a.initialize(o);return await a.runCommandOnFile("-vcodec libx264 -crf 27 -preset ultrafast -threads 4",e.file,e.file.name,"output.mp4")}catch(YEe){return t.rejectWithValue(YEe)}})),AR={ffmpegStatus:void 0,outputFile:void 0,outputFileUrl:void 0,progress:void 0},NR=_("updateProgress"),PR=_("resetState"),RR=g({name:"ffmpegProcessor",initialState:AR,reducers:{},extraReducers:e=>{e.addCase(NR,((e,t)=>{e.progress=t.payload})),e.addCase(CR.pending,(e=>{e.ffmpegStatus="PENDING"})),e.addCase(CR.fulfilled,((e,t)=>{e.ffmpegStatus="FULFILLED",e.outputFile=t.payload,e.outputFileUrl=URL.createObjectURL(t.payload)})),e.addCase(CR.rejected,(e=>{e.ffmpegStatus="REJECTED"})),e.addCase(PR,(()=>AR))}}),{reducer:LR}=RR;var DR=(e=>(e.SHOW_CONTEXT_MENU="SHOW_CONTEXT_MENU",e.HIDE_CONTEXT_MENU="HIDE_CONTEXT_MENU",e))(DR||{});function OR(){return{type:"HIDE_CONTEXT_MENU"}}const FR={collections:(e=[],t)=>{switch(t.type){case"SET_COLLECTIONS":return t.collections;case"RESET_EDITOR":return[];default:return e}},currentCollection:(e={},t)=>"SET_CURRENT_COLLECTION"===t.type?t.currentCollection:e,infoForSelectedCollectionLetter:(e={letter:"",count:0},t)=>"SET_NUM_COLLECTIONS_FOR_LETTER"===t.type?{letter:t.letter,count:t.count}:e},MR="controls",UR="mobile-options-container";var BR=(e=>(e.Canvas="canvas",e.Timing="timing",e.Versions="versions",e))(BR||{});const WR=g({initialState:{},name:"selectedTabs",reducers:{selectTab:(e,t)=>{t.payload.tabId?e[t.payload.tabContainerId]=t.payload.tabId:delete e[t.payload.tabContainerId]}},extraReducers:e=>e.addCase("SELECT_ITEM",((e,t)=>{t.item&&(e.controls=BR.Canvas)}))}),{selectTab:VR}=WR.actions,jR={attempted:{http:null,websocket:null},firstAttemptSinceLastSuccess:{http:null,websocket:null},succeeded:{http:null,websocket:null}},GR=()=>({altIsBeingPressed:!1,assetMonitorId:"",boxSelectedIds:{},commandIsBeingPressed:!1,controlIsBeingPressed:!1,userManualSeek:null,dragPreviewDisplacements:{},ghostTimeOffsets:null,idbAssetIds:null,initialIDBAssetIdLoadDone:!1,isNewProject:!1,isProjectFetched:!1,layerTempValues:{},localProjectId:z.v4(),mediaItemDropLocation:null,mediaItemGhostTrack:null,mediaSidebarSelectedTab:"thisProject",mouseState:null,selectedEditorPane:"timeline",shiftIsBeingPressed:!1,showSignIn:!1,showTranscribe:!1,studioDragDropActive:!1,textLayerIDsAddedInSession:[],thumbnailTrackFallbacks:{},timelineContainerHeight:0,timelineContainerWidth:0,volumeSliderIsDragging:!1,infoToastShownThisSession:!1,trimPreviewPlaying:!1,rowUploadInProgress:!1,awaitingRecordings:null,staticUploadIds:[],groupDragOverrides:{},lastSyncedWithServer:jR,lastSyncedUserFacing:null,isLayerMountedByLayerId:{},isAdding:{},playbackRate:1,magicSubtitlesGlobal:{},magicSubtitleSelection:null,magicSubtitleFocusedNdx:void 0,mediaBarWidth:325,isResizingMediaBar:!1,lastThumbnailGenerated:new Date,showReportIssueModal:!1,magicSubtitleFramesByAsset:{},ai:{}});function HR(e){for(const t in e)delete e[t];Object.assign(e,GR())}function zR(e,t,a){e.layerTempValues[t]||(e.layerTempValues[t]={hasBeenPlayable:!1});const o=e.layerTempValues[t];if(o)for(const[n,r]of Object.entries(a))if(r!==o[n])return void Object.assign(o,a)}const $R=K(GR(),{SET_STUDIO:(e,t)=>{t.isFirstVideoLoad&&(e.initialProjectLoadAt=Date.now()),e.lastSyncedWithServer=jR},RESET_STUDIO:e=>{HR(e)},RESET_STATE_PRESERVE_USER:e=>{HR(e)},[Yh.SET_LOCAL_LAYER_VALUES]:(e,t)=>{zR(e,t.layerId,t.properties)},[Yh.BATCHED_SET_LOCAL_LAYER_VALUES]:(e,t)=>{Object.entries(t.updates).forEach((([t,a])=>{zR(e,t,a)}))},[Yh.SET_IS_INLINE_CROPPING]:(e,t)=>{const{layerTempValues:a}=e;Object.keys(a).forEach((e=>{a[e]||(a[e]={});const o=a[e];o&&(o.isBeingInlineCropped=null,e===t.layerId&&(o.isBeingInlineCropped=t.isInlineCropping))}))},[Yh.SET_PROJECT_FETCHED]:e=>{e.isProjectFetched=!0},[Yh.CLEAR_PROJECT_FETCHED]:e=>{e.isProjectFetched=!1},[Yh.SET_SHOW_TRANSCRIBE]:(e,t)=>{e.showTranscribe=t.showTranscribe},[Yh.SET_SNAP_TIMELINE_TO_SEEKER]:(e,t)=>{e.snapTimelineToSeeker=t.snapTimelineToSeeker},[Yh.SET_STUDIO_DRAG_DROP_ACTIVE]:(e,t)=>{e.studioDragDropActive=t.studioDragDropActive},[Yh.SET_SELECTED_EDITOR_PANE]:(e,t)=>{e.selectedEditorPane=t.selectedEditorPane},[Yh.SET_VOLUME_SLIDER_IS_DRAGGING]:(e,t)=>{e.volumeSliderIsDragging=t.isDragging},[Yh.SET_MEDIA_ITEM_GHOST_TRACK]:(e,t)=>{e.mediaItemGhostTrack=t.track},[Yh.SET_MEDIA_ITEM_LOCATION]:(e,t)=>{e.mediaItemDropLocation=t.location},[Yh.ADD_IDB_ASSET_IDS]:(e,t)=>{const a=new Set(t.idbAssetIds),o=new Set(e.idbAssetIds),n=new Set([...a,...o]);e.idbAssetIds=Array.from(n)},[Yh.REMOVE_IDB_ASSET_ID]:(e,t)=>{const a=(e.idbAssetIds||[]).filter((e=>e!==t.idbAssetId));e.idbAssetIds=a},[Yh.CLEAR_IDB_ASSET_IDS]:e=>{e.idbAssetIds=[]},[Yh.SET_DRAGGED_TRACKS_OVERRIDES]:(e,t)=>{s.exports.isEmpty(t.overrides)&&s.exports.isEmpty(e.draggedTracksOverrides)||(e.draggedTracksOverrides=t.overrides)},[Yh.ALT_IS_BEING_PRESSED]:(e,t)=>{e.altIsBeingPressed=t.isPressed},[Yh.COMMAND_IS_BEING_PRESSED]:(e,t)=>{e.commandIsBeingPressed=t.isPressed},[Yh.CONTROL_IS_BEING_PRESSED]:(e,t)=>{e.controlIsBeingPressed=t.isPressed},[Yh.SHIFT_IS_BEING_PRESSED]:(e,t)=>{e.shiftIsBeingPressed=t.isPressed},[Yh.SET_TIMELINE_CONTAINER_HEIGHT]:(e,t)=>{e.timelineContainerHeight=t.height},[Yh.SET_TIMELINE_CONTAINER_WIDTH]:(e,t)=>{e.timelineContainerWidth=t.width},[Yh.SET_TRACK_THUMBNAIL_FALLBACK]:(e,t)=>{e.thumbnailTrackFallbacks[t.mediaCacheId]=!0},[Yh.SET_INITIAL_IDB_ASSET_ID_LOAD_DONE]:e=>{e.initialIDBAssetIdLoadDone=!0},[Yh.SET_IS_NEW_PROJECT]:e=>{e.isNewProject=!0},[Yh.START_EDITING_TEXT_LAYER]:(e,t)=>{zR(e,t.payload.id,{isEditing:!0,textTemp:t.payload.text})},[Yh.SET_MEDIA_SIDEBAR_SELECTED_TAB]:(e,t)=>{e.mediaSidebarSelectedTab=t.payload},[Yh.ADD_TEXT_LAYER_ID_ADDED_IN_SESSION]:(e,t)=>{const a=new Set([...e.textLayerIDsAddedInSession,t.id]);e.textLayerIDsAddedInSession=Array.from(a)},[W_.toString()]:(e,t)=>{e.userManualSeek=t.payload},[Yh.SET_MOUSE_DOWN]:(e,t)=>{e.mouseState=t.payload},[Yh.CLEAR_DRAG_PREVIEW_DISPLACEMENTS]:e=>{e.dragPreviewDisplacements={}},[Yh.SET_DRAG_PREVIEW_DISPLACEMENTS]:(e,t)=>{e.dragPreviewDisplacements={...e.dragPreviewDisplacements,...t.payload}},[Yh.SET_INFO_TOAST_SHOWN_THIS_SESSION]:(e,t)=>{e.infoToastShownThisSession=t.payload},[Yh.SET_PREVIEW_PLAYING]:(e,t)=>{e.previewPlaying=t.payload},[Yh.SHOW_SIGN_IN]:e=>{e.showSignIn=!0},[Yh.HIDE_SIGN_IN]:e=>{e.showSignIn=!1},[Yh.SET_ROW_UPLOAD_IN_PROGRESS]:(e,t)=>{e.rowUploadInProgress=t.payload},[Yh.SET_AWAITING_RECORDINGS]:(e,t)=>{e.awaitingRecordings={...e.awaitingRecordings,...t.payload},"string"==typeof e.awaitingRecordings.screen&&"string"==typeof e.awaitingRecordings.video&&(e.awaitingRecordings=null)},[Yh.SET_PREVIEW_TRACK]:(e,t)=>{e.previewTrack=t.payload},[Yh.SET_PREVIEW_TIMELINE_STATE]:(e,t)=>{t.timelineState?e.previewTimelineState?e.previewTimelineState={...e.previewTimelineState,...t.timelineState}:e.previewTimelineState={pxInSecond:0,timelineWidth:0,scrollLeft:0,...t.timelineState}:e.previewTimelineState=void 0},[Yh.SET_GHOST_SEEKER_OFFSET]:(e,t)=>{e.ghostTimeOffsets=t.payload},[Yh.SET_STATIC_UPLOAD_IDS]:(e,t)=>{e.staticUploadIds=t.payload},[Yh.SET_MOBILE_TRAY_CONTENT]:(e,t)=>{e.mobileTrayContent=t.payload},[Yh.SET_BOX_SELECTED_IDS]:(e,t)=>{e.boxSelectedIds=t.payload},[Yh.SET_GROUP_DRAG_OVERRIDES]:(e,t)=>{e.groupDragOverrides[t.payload.groupId]=t.payload.overrides},[Yh.CLEAR_GROUP_DRAG_OVERRIDES]:(e,t)=>{delete e.groupDragOverrides[t.payload]},[Yh.SYNC_ATTEMPTED]:(e,t)=>{const a=Date.now();e.lastSyncedWithServer.attempted[t.payload]=a;const o=e.lastSyncedWithServer.firstAttemptSinceLastSuccess[t.payload],n=e.lastSyncedWithServer.succeeded[t.payload];(!o||n&&n>o)&&(e.lastSyncedWithServer.firstAttemptSinceLastSuccess[t.payload]=a)},[Yh.SYNC_SUCCEEDED]:(e,t)=>{const a=Date.now();e.lastSyncedWithServer.succeeded[t.payload]=a,e.lastSyncedWithServer.firstAttemptSinceLastSuccess[t.payload]=null,e.lastSyncedUserFacing=a},[Yh.SET_IS_ADDING]:(e,t)=>{Object.prototype.hasOwnProperty.call(e.isAdding,t.payload)?e.isAdding[t.payload]=!e.isAdding[t.payload]:e.isAdding[t.payload]=!0},[Yh.PLAYBACK_RATE]:(e,t)=>{e.playbackRate=t.payload},[Yh.UPDATE_MAGIC_SUBTITLE_LOCAL]:(e,t)=>{const{updates:a}=t.payload,o=e.magicSubtitlesGlobal;a.position&&(o.position={...o.position,...a.position}),a.style&&(o.style={...o.style,...a.style}),a.preset&&(""===a.preset.presetId?o.preset=void 0:o.preset=a.preset),a.wordByWordAnimations&&(o.wordByWordAnimations={...o.wordByWordAnimations,...a.wordByWordAnimations}),a.transitionDuration&&(o.transitionDuration=a.transitionDuration),a.transitionOverlapDuration&&(o.transitionOverlapDuration=a.transitionOverlapDuration),a.transitionSpeed&&(o.transitionSpeed=a.transitionSpeed)},[Yh.SET_MAGIC_SUBTITLE_SELECTION]:(e,t)=>{e.magicSubtitleSelection=t.payload},[Yh.SET_MAGIC_SUBTITLE_FOCUS]:(e,t)=>{e.magicSubtitleFocusedNdx=t.payload},UPDATE_MAGIC_SUBTITLE:(e,{updates:t})=>{const a=e.magicSubtitlesGlobal;a&&(t.position&&delete a.position,t.style&&delete a.style,t.preset&&delete a.preset,t.wordByWordAnimations&&delete a.wordByWordAnimations,t.transitionDuration&&delete a.transitionDuration,t.transitionOverlapDuration&&delete a.transitionOverlapDuration,t.transitionSpeed&&delete a.transitionSpeed)},[Yh.SET_LOCAL_MAGIC_SUBTITLE_FRAMES]:(e,t)=>{null!==t.payload.frames?e.magicSubtitleFramesByAsset[t.payload.assetId]={byId:t.payload.frames}:e.magicSubtitleFramesByAsset[t.payload.assetId]=void 0},[Yh.RESIZE_MEDIABAR]:(e,t)=>{e.mediaBarWidth=t.payload},[Yh.RESIZING_MEDIABAR]:(e,t)=>{e.isResizingMediaBar=t.payload},[Yh.UPDATE_LAST_GENERATED_THUMBNAIL]:e=>{const t=new Date;e.lastThumbnailGenerated=t},[Yh.SET_SHOW_REPORT_ISSUE_MODAL]:(e,t)=>{e.showReportIssueModal=t.payload},[Yh.SET_LAYER_MOUNTED_STATE]:(e,t)=>{e.isLayerMountedByLayerId[t.payload.layerId]=t.payload.mounted},[Yh.SET_ASSET_MONITOR_ID]:(e,t)=>{e.assetMonitorId=t.payload},[Yh.UPDATE_DALLE_TEMP_VALUES]:(e,t)=>{e.dallePrompt=t.dallePrompt||e.dallePrompt,e.dalleLastGeneratedPrompt=t.dalleLastGeneratedPrompt||e.dalleLastGeneratedPrompt,e.dalleResults=t.dalleResults||e.dalleResults},[Yh.SET_AI_TOOLS_DATA]:(e,t)=>{e.ai={...e.ai,...t.payload}},[Yh.SET_CLICKED_TTS_BUTTON_FROM_RIGHT_SIDEBAR]:(e,t)=>{e.clickedTTSButtonFromRightSidebar=t.payload}}),KR=_("SET_IDB_IS_DISABLED"),YR=K({idb:!0},(e=>e.addCase(KR,(e=>{e.idb=!1})))),qR=g({initialState:z.v4(),name:"sessionId",reducers:{}}),XR=g({initialState:{},name:"notifications",reducers:{setNotifications:(e,t)=>{e.notifications=t.payload},addNotifications:(e,t)=>{e.notifications=[...t.payload,...e.notifications||[]]},setNotificationsRead:(e,t)=>{e.notifications=e.notifications?e.notifications.map((e=>t.payload.includes(e._id.toString())?{...e,state:rn.read}:e)):void 0}}}),{setNotifications:JR,addNotifications:QR,setNotificationsRead:ZR}=XR.actions,eL={byId:{},projectIdsByFolderId:{}},tL=g({initialState:eL,name:"projects",reducers:{moveProjectsSuccess:(e,{payload:{movedProjects:t,destinationFolder:a}})=>{Object.keys(e.projectIdsByFolderId).forEach((o=>{if(o!==a._id){const a=(e.projectIdsByFolderId[o]||[]).filter((e=>!t.map((e=>e._id)).includes(e)));e.projectIdsByFolderId[o]=a}}))},projectsFetched:(e,{payload:{projects:t,folderId:a}})=>{t.forEach((t=>{e.byId[t._id]=t}));const o=e.projectIdsByFolderId[a],n=t.map((e=>e._id)),r=o?[...new Set([...n,...o])]:n;e.projectIdsByFolderId[a]=r.sort()},removeProject:(e,{payload:{projectId:t,folderId:a}})=>{delete e.byId[t];const o=e.projectIdsByFolderId[a];o&&(e.projectIdsByFolderId[a]=o.filter((e=>e!==t)))},clearAllProjects:e=>eL,updateProjectVideo:(e,{payload:{projectId:t,updateDict:a}})=>{const o=e.byId[t];o&&(o.content={...o.content,...a})}}}),{projectsFetched:aL,removeProject:oL,clearAllProjects:nL,moveProjectsSuccess:rL,updateProjectVideo:iL}=tL.actions,sL=g({initialState:{recordSet:!1},name:"assets",reducers:{setRecord:e=>{e.recordSet=!0},unsetRecord:e=>{e.recordSet=!1}}}),{setRecord:lL,unsetRecord:dL}=sL.actions;function cL(e,t){let a=t.getStartKey();const o=t.getEndKey();let n=t.getStartOffset(),r=e.getBlockForKey(a).getCharacterList().slice(n);const i=[];for(;a!==o;){for(const e of r.toArray())i.push(e);const t=e.getBlockAfter(a);a=t.getKey(),r=t.getCharacterList(),n=0}r=r.slice(0,t.getEndOffset()-n);for(const s of r.toArray())i.push(s);return i}const uL=e=>{const t=e.getFirstBlock().getKey();return Y.SelectionState.createEmpty(t).merge({anchorKey:t,anchorOffset:0,focusKey:e.getLastBlock().getKey(),focusOffset:e.getLastBlock().getLength()})},mL=e=>{const t=e.getCurrentContent(),a=t.getFirstBlock().getKey(),o=t.getLastBlock().getKey(),n=t.getLastBlock().getLength(),r=e.getSelection();return r.getStartKey()===a&&0===r.getStartOffset()&&r.getEndKey()===o&&r.getEndOffset()===n},pL=e=>{const t=e.getCurrentContent().getBlocksAsArray(),a=e.getSelection(),o=a.getStartKey(),n=a.getStartOffset(),r=a.getEndKey(),i=a.getEndOffset(),s=t.map((e=>[e.getKey(),e.getLength()]));let l=0;for(const[c,u]of s){if(c===o){l+=n;break}l+=u+1}let d=0;for(const[c,u]of s){if(c===r){d+=i;break}d+=u+1}return[l,d]},hL=(e,t)=>{let a=0,o=null,n=0;const r=e.getCurrentContent().getBlocksAsArray().map((e=>[e.getKey(),e.getLength()]));if(t>-1)for(const[i,s]of r){const e=a;if(a+=s+1,a>t){o=i,n=t-e;break}}else{const t=e.getCurrentContent().getBlockMap().toList();o=t.last().get("key"),n=t.last().getLength()}if(o){const t=Y.SelectionState.createEmpty(o).merge({anchorKey:o,anchorOffset:n,focusKey:o,focusOffset:n});return Y.EditorState.forceSelection(e,t)}return e},gL=(e,t,a)=>{const o=e.getBlocksAsArray().map((e=>[e.getKey(),e.getLength()]));let n=0,r=null,i=0;for(const[d,c]of o){const e=n;if(n+=c+1,n>t){r=d,i=t-e;break}}n=0;let s=null,l=0;for(const[d,c]of o){const e=n;if(n+=c+1,n>a){s=d,l=a-e;break}}if(r&&s){return Y.SelectionState.createEmpty(r).merge({anchorKey:r,anchorOffset:i,focusKey:s,focusOffset:l})}return null},yL=e=>e.getCurrentContent().getPlainText(),fL=(e,t,a)=>{const o=gL(e,t,t+1);return o?Y.Modifier.applyInlineStyle(e,o,a):e};var EL=(e=>(e.MOUNT_ACTIVE_EDITOR="MOUNT_ACTIVE_EDITOR",e.UNMOUNT_ACTIVE_EDITOR="UNMOUNT_ACTIVE_EDITOR",e.UPDATE_ACTIVE_EDITOR="UPDATE_ACTIVE_EDITOR",e.SET_TEXT_BOLD="SET_EDITOR_TEXT_BOLD",e.SET_TEXT_ITALICS="SET_EDITOR_TEXT_ITALICS",e.SET_TEXT_UNDERLINE="SET_EDITOR_TEXT_UNDERLINE",e.SET_TEXT_COLOR="SET_EDITOR_TEXT_COLOR",e))(EL||{});const vL=_("MOUNT_ACTIVE_EDITOR"),wL=_("UNMOUNT_ACTIVE_EDITOR"),bL=_("UPDATE_ACTIVE_EDITOR"),_L=_("SET_EDITOR_TEXT_BOLD"),TL=_("SET_EDITOR_TEXT_ITALICS"),SL=_("SET_EDITOR_TEXT_UNDERLINE"),IL=_("SET_EDITOR_TEXT_COLOR"),xL=(e,t,a)=>{const o=e.getSelection(),n=e.getCurrentContent(),r=o.isCollapsed()?uL(n):o,i=a?Y.Modifier.applyInlineStyle(n,r,t):Y.Modifier.removeInlineStyle(n,r,t),s=Y.EditorState.push(e,i,"change-inline-style");return Y.EditorState.acceptSelection(s,o)},kL=(e,t,a)=>{const o=e.getSelection(),n=e.getCurrentContent(),r=o.isCollapsed()?uL(n):o;let i=Dx(n).filter((e=>e.startsWith(t))).reduce(((e,t)=>Y.Modifier.removeInlineStyle(e,r,t)),n);i=Y.Modifier.applyInlineStyle(i,r,`${t}_${a}`);const s=Y.EditorState.push(e,i,"change-inline-style");return Y.EditorState.acceptSelection(s,o)},CL=K({},{[EL.MOUNT_ACTIVE_EDITOR]:(e,{payload:t})=>{e[t.id]?e[t.id].mountCounter+=1:e[t.id]={editor:t.editor,syncCounter:0,mountCounter:1}},[EL.UPDATE_ACTIVE_EDITOR]:(e,{payload:t})=>{e[t.id]?e[t.id].editor=t.editor:e[t.id]={editor:t.editor,syncCounter:0,mountCounter:1}},[EL.UNMOUNT_ACTIVE_EDITOR]:(e,{payload:t})=>{e[t]&&(e[t].mountCounter-=1,e[t].mountCounter<=0&&(e[t]=void 0))},[EL.SET_TEXT_BOLD]:(e,{payload:t})=>{for(const a of t.ids)e[a]&&(e[a].editor=xL(e[a].editor,"BOLD",t.value),e[a].syncCounter=e[a].syncCounter+1)},[EL.SET_TEXT_ITALICS]:(e,{payload:t})=>{for(const a of t.ids)e[a]&&(e[a].editor=xL(e[a].editor,"ITALIC",t.value),e[a].syncCounter=e[a].syncCounter+1)},[EL.SET_TEXT_UNDERLINE]:(e,{payload:t})=>{for(const a of t.ids)e[a]&&(e[a].editor=xL(e[a].editor,"UNDERLINE",t.value),e[a].syncCounter=e[a].syncCounter+1)},[EL.SET_TEXT_COLOR]:(e,{payload:t})=>{for(const a of t.ids)e[a]&&(e[a].editor=kL(e[a].editor,"COLOR",t.value),e[a].syncCounter=e[a].syncCounter+1)}}),AL={};async function NL(e){const{dispatch:t}=tn(),a=await async function(e){if(!e)return{canWrite:!0,canRead:!0};{const{state:t}=tn();if(!sc(t.currentUser))return{canWrite:!1};try{return await hu("/api/v1/videos/userPermissions",{params:{videoId:e}})}catch(YEe){const t=YEe&&"object"==typeof YEe&&"error"in YEe?YEe.error:YEe;return console.error(`Error getting video permissions: ${t}`),{canWrite:!1,canRead:!1}}}}(e);return t(RL(a)),a}const PL=g({initialState:AL,name:"userPermissions",reducers:{setUserPermissions:(e,t)=>{e.canWrite=t.payload.canWrite,e.canRead=t.payload.canRead},clearUserPermissions:()=>AL}}),{setUserPermissions:RL,clearUserPermissions:LL}=PL.actions,DL=g({name:"clipboard",initialState:{copyId:null,contents:null,originalProject:null},reducers:{setClipboardContents:(e,t)=>{Object.assign(e,t.payload),e.copyId=z.v4()}}}),{setClipboardContents:OL}=DL.actions,FL=g({initialState:()=>{const e=window.matchMedia("(max-width: 768px)");return e.addEventListener("change",(e=>{tn().dispatch(FL.actions.setIsMobile(e.matches))})),e.matches},name:"isMobile",reducers:{setIsMobile:(e,t)=>t.payload}}),ML=g({name:"trimWithTranscript",initialState:{scrollId:1,selection:null},reducers:{scrollTranscriptToCurrentTime:e=>{e.scrollId+=1},setTrimWithTranscriptSelection:(e,t)=>{e.selection=t.payload}}}),{scrollTranscriptToCurrentTime:UL,setTrimWithTranscriptSelection:BL}=ML.actions,WL=async()=>{const{dispatch:e,state:t}=tn(),a=t.studio.workspaceId||t.workspaces.selectedWorkspace;if(!a)return;const o=await hu(`/api/v1/folders/limitedDTO/${a}`);e(jL({_id:o._id,name:o.name,teamId:o.teamId})),e(yv(a)),o.teamId&&e(LE(o.teamId))},VL=g({initialState:{_id:mi,name:"Shared with Me",teamId:void 0},name:"videoFolder",reducers:{setVideoFolder:(e,t)=>{e._id=t.payload._id,e.name=t.payload.name,e.teamId=t.payload.teamId}}}),{setVideoFolder:jL}=VL.actions,GL=g({initialState:{},name:"eyedropper",reducers:{clearOnColorSelected:e=>{delete e.onColorSelected},setOnColorSelected:(e,t)=>{e.onColorSelected=t.payload}}}),{setOnColorSelected:HL,clearOnColorSelected:zL}=GL.actions,$L=q({ffmpegReducer:LR,config:(e=ih,t)=>"SET_CONFIG"===t.type?{...e,...t.config||{}}:e,sourceVideo:(e={},t)=>{switch(t.type){case"KAPWING_INIT":return"local"===e.source?{}:{...e,local_url:null};case"SET_SOURCE_VIDEO":return t.updateSharedDoc&&my("sourceVideo",t.video,e,"SET_SOURCE_VIDEO"),t.video;case"SET_UPLOAD_PROGRESS_TEXT":return"sourceVideo"!==t.id?e:{...e,uploadProgressText:t.text};default:return e}},uploadStatuses:(e={},t)=>{switch(t.type){case"RESET_EDITOR":return{};case"ADD_UPLOAD_STATUS":{if(e[t.id])return e;const a={id:t.id,beganAt:performance.now(),beganAtTimestamp:Date.now(),fileName:t.fileName,stage:lh.unstarted,stageStarted:performance.now(),retryInfo:{offlineRetries:0,otherRetries:0,retries:0}};return{...e,[t.id]:a}}case"DELETE_UPLOAD_STATUS":{const a={...e};return delete a[t.id],a}case"UPDATE_UPLOAD_STATUS":{const a=e[t.id];if(!a)return e;const o="stage"in t.updates&&t.updates.stage!==a.stage?{stageStarted:performance.now()}:{};return{...e,[t.id]:{...a,...t.updates,...o}}}default:return e}},toolTip:(e="",t)=>{switch(t.type){case"SHOW_TOOL_TIP":return t.toolTip;case"RESET_EDITOR":return"";default:return e}},mousePositionToolTip:(e=null,t)=>{switch(t.type){case"SET_MOUSE_POSITION_TOOLTIP":return t.mousePosition;case"CLEAR_MOUSE_POSITION_TOOLTIP":return null;default:return e}},privacy:(e=null,t)=>{let a;switch(t.type){case"SET_CURRENT_VIDEO":a=(t.video||{}).privacy,a=null==a?null:a;break;case"SET_PRIVACY":a=t.privacy;break;case"RESET_EDITOR":case"RESET_PRIVACY":case"RESET_STUDIO":a=null;break;default:a=e}return a},startTime:(e=0,t)=>{switch(t.type){case"SET_START_TIME":return t.startTime;case"RESET_EDITOR":return 0;default:return e}},endTime:(e=0,t)=>{switch(t.type){case"SET_END_TIME":return t.endTime;case"RESET_EDITOR":return 0;default:return e}},editorPath:(e="/",t)=>{switch(t.type){case"SET_EDITOR_PATH":return t.path;case"RESET_EDITOR":return"/";default:return e}},currentVideo:(e={},t)=>{switch(t.type){case"SET_CURRENT_VIDEO":return t.video;case"UPDATE_CURRENT_VIDEO":return{...e,...t.videoUpdates};case"RESET_STUDIO":case"RESET_CURRENT_VIDEO":return{};default:return e}},recentVideos:(e=[],t)=>"SET_RECENT_VIDEOS"===t.type?t.videos:e,videoJustSaved:(e=!1,t)=>"SET_VIDEO_JUST_SAVED"===t.type?t.justSaved:e,videoSaving:(e=!1,t)=>{switch(t.type){case"SET_VIDEO_SAVING":return!0;case"CLEAR_VIDEO_SAVING":return!1;default:return e}},currentUser:(e=(()=>"object"==typeof Cypress&&"env"in Cypress?"team"===Cypress.env("isSignedIn")?(Sy(Cypress.env("teamsUserToken")),{user:Cypress.env("teamsUserDict"),token:Cypress.env("teamsUserToken")}):"individual"===Cypress.env("isSignedIn")?(Sy(Cypress.env("userToken")),{user:Cypress.env("userDict"),token:Cypress.env("userToken")}):Ty:Ty)(),t)=>{var a;switch(t.type){case"REQUEST_USER":return{...e,user:{},token:e.token};case"RECEIVE_USER_AND_SET_TOKEN":const{user:o,token:n,impersonatingAdminEmail:r}=t;return Iy(o),{...e,user:o,token:n,impersonatingAdminEmail:r};case"SET_TOKEN":return{...e,token:t.token};case"MOCK_SIGN_IN":return{...e,token:Cypress.env("teamsSignIn")?Cypress.env("teamsUserToken"):Cypress.env("userToken"),user:Cypress.env("teamsSignIn")?Cypress.env("teamsUserDict"):Cypress.env("userDict")};case"SIGN_OUT":return Iy(null),Ty;case"SET_USER":return Iy(t.user),{...e,user:t.user};case"UPDATE_USER_NOTIF_SETTING":{if(!(null==(a=e.user)?void 0:a._id))return e;const{notifType:o,on:n,location:r}=t,i=r===on.Email?"optOutEmails":"optOutNotifs",s=e.user[i];if(!n&&!(null==s?void 0:s.includes(o))){const t=s?[...s,o]:[o];return{...e,user:{...e.user,[i]:t}}}if(n&&(null==s?void 0:s.includes(o))){const t=s.filter((e=>e!==o));return{...e,user:{...e.user,[i]:t}}}return e}default:return e}},isStopMotionVideo:(e=!1,t)=>{switch(t.type){case"MARK_AS_STOP_MOTION":return!0;case"RESET_EDITOR":case"RESET_EDITOR_FLAGS":return!1;default:return e}},stopMotionClipRate:(e=.6,t)=>{switch(t.type){case"SET_STOP_MOTION_CLIP_RATE":return t.clipRate;case"RESET_EDITOR":return.6;default:return e}},stopMotionSpeed:(e=.2,t)=>{switch(t.type){case"SET_STOP_MOTION_SPEED":return t.speed;case"RESET_EDITOR":return.2;default:return e}},reverseStopMotion:(e=!1,t)=>{switch(t.type){case"TOGGLE_REVERSE_STOP_MOTION":return!e;case"RESET_EDITOR":return!1;default:return e}},languageCode:(e="auto-detect",t)=>{let a;if("RESET_EDITOR"===t.type)a="auto-detect";else a=e;return a||"auto-detect"},isTranscribed:(e=!1,t)=>{let a;switch(t.type){case"STARTED_TRANSCRIBING":my("isTranscribed",e||t.success,e,"STARTED_TRANSCRIBING"),a=e||t.success;break;case"RESET_EDITOR":a=!1;break;default:a=e}return a||!1},transcriptionId:(e=null,t)=>{let a;switch(t.type){case"STARTED_TRANSCRIBING":my("transcriptionId",t.success?t.transcriptionId:null,e,"STARTED_TRANSCRIBING"),a=t.success?t.transcriptionId:null;break;case"RESET_EDITOR":a=null;break;default:a=e}return a||null},translationProgress:(e=!1,t)=>{switch(t.type){case"SET_TRANSLATE":case"RESET_EDITOR":case"RESET_EDITOR_FLAGS":return 0;case"UPDATE_TRANSLATION_PROGRESS":return t.progress;default:return e}},finishedTranscribingAt:(e=null,t)=>{let a;switch(t.type){case"FINISHED_TRANSCRIBING":return a=t.success?new Date:null,my("finishedTranscribingAt",a,e,"FINISHED_TRANSCRIBING"),a;case"STARTED_TRANSCRIBING":return my("finishedTranscribingAt",null,e,"STARTED_TRANSCRIBING"),null;case"RESET_EDITOR":return null;default:return e}},translate:(e=!1,t)=>{switch(t.type){case"SET_TRANSLATE":return my("translate",t.translate,e,"SET_TRANSLATE"),t.translate;case"RESET_EDITOR":case"RESET_EDITOR_FLAGS":return!1;default:return e}},translateLanguageCode:(e="",t)=>{switch(t.type){case"SET_TRANSLATE_LANGUAGE_CODE":return my("translateLanguageCode",t.translateLanguageCode,e,"SET_TRANSLATE_LANGUAGE_CODE"),t.translateLanguageCode;case"RESET_EDITOR":case"RESET_EDITOR_FLAGS":return"";default:return e}},subtitles:(e=[],t)=>{let a,o,n=[];const r=e.length>1||1===e.length&&e[0].text;switch(t.type){case"REMOVE_SUBTITLE":return i=t.subtitle,ly({p:["subtitles",e.indexOf(t.subtitle)],ld:i},{srcFn:"REMOVE_SUBTITLE"}),e.filter((({id:e})=>e!==t.subtitle.id));case"DUPLICATE_SUBTITLE":return a=e.indexOf(t.subtitle),o={...t.subtitle,id:y()},function(e,t,a){ly({p:["subtitles",t],li:e},{srcFn:a})}(o,a+1,"DUPLICATE_SUBTITLE"),n=[...e],n.splice(a+1,0,o),n;case"SET_SUBTITLE_TIME":return n=e.map(((e,a)=>{if(e.id!==t.subtitle.id)return e;const o={...e,startTime:parseFloat(t.times.startTime),endTime:parseFloat(t.times.endTime)};return fy(o,a,e,"SET_SUBTITLE_TIME"),o})),n;case"SET_SUBTITLE_TEXT":n=[];for(let a=0;a<e.length;a+=1)e[a].id===t.subtitle.id?(o={id:t.subtitle.id,text:t.text,startTime:parseFloat(t.subtitle.startTime),endTime:parseFloat(t.subtitle.endTime)},fy(o,a,e[a],"SET_SUBTITLE_TEXT"),n.push(o)):n.push(e[a]);return n;case"ADD_SUBTITLES":return n=r?[...e,...t.subtitles]:[...t.subtitles],n;case"RESET_EDITOR":return[{id:y(),startTime:0,endTime:3,text:""}];default:return e}var i},subtitleVideo:(e=null,t)=>{switch(t.type){case"SET_SUBTITLE_VIDEO":return t.video;case"RESET_EDITOR":return null;default:return e}},highlightSubtitles:(e=!1,t)=>{switch(t.type){case"SET_HIGHLIGHT_SUBTITLES":return my("highlightSubtitles",!0,e,"SET_HIGHLIGHT_SUBTITLES"),!0;case"RESET_HIGHLIGHT_SUBTITLES":return my("highlightSubtitles",!1,e,"RESET_HIGHLIGHT_SUBTITLES"),!1;case"RESET_EDITOR":return!1;default:return e}},isLooped:(e=!1,t)=>{switch(t.type){case"MARK_AS_LOOPED":return!0;case"RESET_EDITOR":case"RESET_EDITOR_FLAGS":return!1;default:return e}},numLoops:(e=2,t)=>{switch(t.type){case"SET_NUM_LOOPS":return t.numLoops;case"RESET_EDITOR":return 2;default:return e}},isStudio:(e=!1,t)=>{switch(t.type){case"MARK_AS_STUDIO":return!0;case"RESET_EDITOR":case"RESET_EDITOR_FLAGS":return!1;default:return e}},seekInProgress:(e=!1,t)=>{switch(t.type){case"SET_SEEK_IN_PROGRESS":return!0;case"CLEAR_SEEK_IN_PROGRESS":return!1;default:return e}},...xy,...ky,...Cy,...Yc,...FR,studio:(e=XN(),t)=>{var a,o,n;const r=eP(e,t);if(e.allLayers&&e.allLayers.byId===r.allLayers.byId&&(null==(a=e.scenes[0])?void 0:a.layers)!==(null==(o=r.scenes[0])?void 0:o.layers)&&"BRING_LAYER_FORWARD"!==t.type&&"MOVE_LAYER_TO_INDEX"!==t.type&&"SEND_LAYER_BACK"!==t.type&&"SORT_SUBTITLE_LAYERS"!==t.type){const e={};for(const t of(null==(n=r.scenes[0])?void 0:n.layers)||[])e[t.id]=t;return p("Layer updates not propagating correctly.",{extra:{action:t}}),console.error("Layer updated without updating studio.layers.byId!",t.type),{...r,allLayers:{byId:e}}}return r},workspaces:(e={allWorkspaces:[],workspaceMenuVisible:!1,showUploadDialog:!1,showDragUploadDialog:!1,selectedWorkspace:"",workspaceUploadFiles:{},workspaceUploadStatus:void 0,workspaceUploadProjects:[],setSharedWorkspaceOwnerEmail:"",workspaceOwnerEmail:"",sharedWorkspaceId:"",selectionMode:!1,currentFolderSettings:{view:$v.GRID_VIEW,sortField:Kv.DATE_CREATED,sortOrder:Yv.ASCENDING},SWMFolderSettings:{view:$v.LIST_VIEW,sortField:Kv.DATE_EDITED,sortOrder:Yv.ASCENDING},showOnboardingUpsell:Jv.None,suggestedWorkspaces:{isQualifiedLead:!1,teams:[]}},t)=>{switch(t.type){case"SET_WORKSPACES":return{...e,allWorkspaces:t.workspaces};case"SET_CURRENT_WORKSPACE":return{...e,selectedWorkspace:t.workspaceId};case"UNSET_WORKSPACE_MENU":return{...e,workspaceMenuVisible:!1};case"SET_WORKSPACE_MENU":return{...e,workspaceMenuVisible:!0};case"REMOVE_WORKSPACE":{const a=s.exports.cloneDeep(e);return a.allWorkspaces=a.allWorkspaces.filter((e=>e._id!==t.workspaceId)),a.selectedWorkspace===t.workspaceId&&(a.selectedWorkspace=""),a}case"CHANGE_WORKSPACE_NAME":{const a=s.exports.cloneDeep(e);for(const e of a.allWorkspaces)e._id===t.workspaceId&&(e.name=t.newName);return a}case"SET_CURRENT_FOLDER_SETTINGS":return{...e,currentFolderSettings:t.folderSettings};case"SET_SWM_FOLDER_SETTINGS":return{...e,SWMFolderSettings:t.folderSettings};case"UPDATE_WORKSPACE_RECENT_FONTS":{const a=s.exports.cloneDeep(e);for(const e of a.allWorkspaces)e._id===t.workspaceId&&(e.recentlyUsedFonts=[...t.recentlyUsedFonts]);return a}case"UPDATE_WORKSPACE_CUSTOM_FONTS":{const a=s.exports.cloneDeep(e);for(const e of a.allWorkspaces)e._id===t.workspaceId&&(Array.isArray(t.customFonts)?e.customFonts=t.customFonts:e.customFonts=[t.customFonts,...e.customFonts||[]]);return a}case"SIGN_OUT":return{allWorkspaces:[],workspaceMenuVisible:!1,showUploadDialog:!1,showDragUploadDialog:!1,workspaceUploadFiles:{},workspaceUploadStatus:void 0,workspaceUploadProjects:[],selectedWorkspace:void 0,selectionMode:!1};case"SHOW_UPLOAD_DIALOG":return{...e,showUploadDialog:!0};case"HIDE_UPLOAD_DIALOG":return{...e,showUploadDialog:!1};case"SHOW_DRAG_UPLOAD_DIALOG":return{...e,showDragUploadDialog:!0};case"HIDE_DRAG_UPLOAD_DIALOG":return{...e,showDragUploadDialog:!1};case"ADD_WORKSPACE_UPLOAD_FILE":return{...e,workspaceUploadFiles:{...e.workspaceUploadFiles,[t.file.id]:t.file}};case"UPDATE_WORKSPACE_UPLOAD_FILE":return{...e,workspaceUploadFiles:{...e.workspaceUploadFiles,[t.id]:{...e.workspaceUploadFiles[t.id],...t.fileInfo}}};case"ADD_WORKSPACE_UPLOAD_PROJECT":return{...e,workspaceUploadProjects:[...e.workspaceUploadProjects,t.video]};case"SET_WORKSPACE_UPLOAD_STATUS":return{...e,workspaceUploadStatus:t.text};case"SET_FILE_UPLOAD_PROGRESS":return{...e,workspaceUploadFiles:{...e.workspaceUploadFiles,[t.id]:{...e.workspaceUploadFiles[t.id],uploadProgress:t.uploadProgress}}};case"MARK_UPLOAD_AS_CANCELLED":return{...e,workspaceUploadFiles:{...e.workspaceUploadFiles,[t.id]:{...e.workspaceUploadFiles[t.id],uploadCancelled:!0}}};case"MARK_UPLOAD_AS_CREATED":return{...e,workspaceUploadFiles:{...e.workspaceUploadFiles,[t.id]:{...e.workspaceUploadFiles[t.id],startedVideoCreation:!0}}};case"CLEAR_WORKSPACE_UPLOAD_FILES":return{...e,workspaceUploadFiles:{},workspaceUploadStatus:void 0,workspaceUploadProjects:[]};case"REMOVE_WORKSPACE_UPLOAD_FILE":{const a={...e};return delete a.workspaceUploadFiles[t.fileId],a}case"REMOVE_WORKSPACE_UPLOAD_FILES":{const a={...e};return t.fileIds.forEach((e=>delete a.workspaceUploadFiles[e])),a}case"SET_SHARED_WORKSPACE_OWNER_EMAIL":return{...e,workspaceOwnerEmail:t.workspaceOwnerEmail};case"SET_SHARED_WORKSPACE_ID":return{...e,sharedWorkspaceId:t.sharedWorkspaceId};case"SET_SELECTION_MODE":return{...e,selectionMode:t.selectionMode};case"UPDATE_WORKSPACE_EA_BANNER":{const{workspaceId:a}=t,{allWorkspaces:o}=e,n=o.map((e=>e._id===a?{...e}:e));return{...e,allWorkspaces:n}}case"SET_SHOW_ONBOARDING_UPSELL":return{...e,showOnboardingUpsell:t.upsellType};case"SET_SUGGESTED_WORKSPACES":return{...e,suggestedWorkspaces:t.payload};default:return e}},previewVideo:(e=null,t)=>{switch(t.type){case"SET_PREVIEW_VIDEO":return t.video;case"RESET_EDITOR":return null;default:return e}},projectName:(e="",t)=>"SET_PROJECT_NAME"===t.type?t.projectName:e,teams:(e={activeTeamInvites:[],allTeams:[],userTeamInvites:[],selectedTeamId:"",sharedTeamId:"",sharedTeamOwnerEmail:"",activeBrandkit:{fonts:[],colors:[],cmlIds:[]},brandkitTemplates:[]},t)=>{switch(t.type){case"SET_CURRENT_TEAM":{const{_id:a}=t;return{...e,selectedTeamId:a}}case"SET_TEAMS":return{...e,allTeams:t.teams};case"SET_ACTIVE_TEAM_INVITES":return{...e,activeTeamInvites:t.invites};case"SET_USER_TEAM_INVITES":return{...e,userTeamInvites:t.invites};case"UPDATE_TEAM":return A(e,(a=>{const{id:o,updateDict:n}=t,r=(i=e.allTeams,s=o,i.findIndex((e=>e._id===s)));var i,s;const l=e.allTeams[r];if(!l)return;const d={...l,...n};a.allTeams[r]=d}));case"UPDATE_TEAM_NAME":return A(e,(e=>{for(const a of e.allTeams)a._id===t.id&&(a.name=t.name)}));case"UPDATE_TEAM_LOGO":return A(e,(e=>{for(const a of e.allTeams)a._id===t.id&&(a.picture=t.picture)}));case"SET_SHARED_TEAM_OWNER_EMAIL":return{...e,sharedTeamOwnerEmail:t.sharedTeamOwnerEmail};case"SET_SHARED_TEAM_ID":return{...e,teamOwnerEmail:t.sharedTeamId};case"SIGN_OUT":return{allTeams:[],selectedTeamId:""};case"SET_ACTIVE_BRANDKIT":{const{activeBrandkit:a}=e,{update:o}=t;return"function"==typeof o&&a?{...e,activeBrandkit:o(a)}:{...e,activeBrandkit:{...a,...o}}}case"SET_BRANDKIT_TEMPLATES":{const{projects:a}=t;return{...e,brandkitTemplates:a}}case"INCREMENT_AI_USAGE":{const{feature:a}=t,o=e.allTeams.find((t=>t._id===e.selectedTeamId));if(!o)return e;const n=o.limits,r=n[a]||0;if("number"!=typeof r)return e;const i={...n,[a]:r+1};return{...e,allTeams:e.allTeams.map((t=>t._id===e.selectedTeamId?{...t,limits:i}:t))}}default:return e}},groupSidebarOpen:(e={},t)=>"TOGGLE_SIDEBAR"===t.type?{...e,[t.groupId]:!e[t.groupId]}:e,selectedTabs:WR.reducer,mediaLibrary:(e={})=>e,contextMenu:(e=null,t)=>{switch(t.type){case DR.SHOW_CONTEXT_MENU:return t.contextMenu;case DR.HIDE_CONTEXT_MENU:return null;default:return e}},studioLocal:$R,featureSupport:YR,projectSessionSettings:cr.reducer,sessionId:qR.reducer,sessionValues:Fu.reducer,CMLFiles:Py.reducer,assets:VP.reducer,mediaCache:Ar.reducer,comments:Fw.reducer,onboarding:(e={showOnboarding:!1},t)=>{switch(t.type){case"SET_SHOW_ONBOARDING":return{...e,showOnboarding:!0};case"SET_HIDE_ONBOARDING":return{...e,showOnboarding:!1};default:return e}},recordAudio:sL.reducer,assetTranscriptions:FP.reducer,loadedFonts:Ku.reducer,activeEditors:CL,notifications:XR.reducer,projects:tL.reducer,modal:Cu.reducer,exports:qm.reducer,explorer:Ru.reducer,theme:qu.reducer,subscription:Xy.reducer,magicSubtitlePresets:Om.reducer,textPresets:Lp.reducer,textTemplates:qp.reducer,toasts:wu.reducer,userPermissions:PL.reducer,clipboard:DL.reducer,isMobile:FL.reducer,trimWithTranscript:ML.reducer,videoFolder:VL.reducer,eyedropper:GL.reducer}),KL="undefined"!=typeof window,YL=(e,t)=>{const a=((e,t)=>{if(!zo)return()=>{};const a=performance.now();return()=>{const o=performance.now();qo.push({category:e,labels:t,time:o-a,hits:1})}})("reducer",[t.type]);let o={...e};switch(t.type){case"RESET_STATE_PRESERVE_USER":case"RESET_STUDIO":o={config:o.config,currentUser:o.currentUser,toasts:o.toasts,workspaces:o.workspaces,teams:o.teams,templates:o.templates,featureSupport:o.featureSupport,mediaCache:o.mediaCache,sessionId:o.sessionId,sessionValues:o.sessionValues,CMLFiles:o.CMLFiles,assets:o.assets,comments:o.comments,onboarding:o.onboarding,notifications:o.notifications,projects:o.projects,loadedFonts:o.loadedFonts,magicSubtitlePresets:o.magicSubtitlePresets,textPresets:o.textPresets,textTemplates:o.textTemplates,explorer:o.explorer,subscription:o.subscription,clipboard:o.clipboard,videoFolder:o.videoFolder};break;case"UPDATE_ENTIRE_STATE":Object.assign(o,t.newStateProperties);break;case"JEST_CLEAR_STORE":o=$L(void 0,t),o.isStudio=!0}const n=$L(o,t);if(KL){window.state=n;const e=n.studio.scenes[0];e&&(window.scene=e)}return a(),n};class qL extends Error{constructor(e){super(),this.name="BulkActionsError",this.message=e}}X(!1);const XL=function(){var e,t,a,o;if("undefined"!=typeof window)try{const n=jc.get("state",{disabled:null});if(null===n)return;const r=n;if(!r)return r;const i=window.location.href,s=r.studio._id;s&&!i.includes(s)&&(r.studio=XN());let l=!1;if(null==(e=r.studio)?void 0:e.localId){const e=OP(r.studio.localId);if(e){e.pendingOps=lr;for(const a of null!=(t=e.offlineOps)?t:[])lr.push(a);r.projectSessionSettings=e,l=!0}}if(null==(a=r.studio)?void 0:a.localId){const e=jc.get(`video_usage_${r.studio.localId}`,{disabled:null});UT(e)}r.projectSessionSettings&&l||(r.projectSessionSettings={...dr});const d=PP(r.studio.projectVersion),c=PP("0.7"),u=AP(d,c);!function(e,t){if(!t.length)return e;for(const o of t)try{o.migrate(e),e.projectVersion=o.versionNumber}catch(a){return console.error(a),b(a,{extra:{__FORCE_SAMPLE:!0},tags:{migrationFailure:!0}}),e}}(r.studio,u),function(e){var t;(null==(t=null==e?void 0:e.allLayers)?void 0:t.byId)&&Object.values(e.allLayers.byId).forEach((e=>{delete e.local_url}));(null==e?void 0:e.scenes)&&e.scenes.forEach((e=>{e.layers.forEach((e=>{delete e.local_url}))}))}(r.studio);const m=(r.studio,null);return m&&b(m,{tags:{migrationDryRunFailure:!0,videoId:String(null==(o=r.studio)?void 0:o._id)}}),r}catch(n){return void console.error(n)}}(),JL="object"==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({actionsDenylist:["SET_STUDIO_TIME"]}):J,QL=[te,e=>e=>t=>{return zo?(a="redux",o=[t.type],Xo(a,o,(()=>e(t)))()):e(t);var a,o},e=>e=>{let t=0,a={};return o=>{if(t+=1,a[o.type]=(a[o.type]||0)+1,e(o),1===t){const e=new qL("Large group of actions dispatched");setTimeout((()=>{if(t>50){const o={actionCount:t,actionCountMap:a};sl()||console.warn("Large group of actions dispatched",o,e.stack),b(e,{extra:{...o}})}a={},t=0}))}}}],ZL=Q({actionTransformer:e=>"MOUNT_ACTIVE_EDITOR"===e.type||"UNMOUNT_ACTIVE_EDITOR"===e.type?null:e,stateTransformer:e=>({...e,activeEditors:"Removed to reduce size",assets:"Removed to reduce size",CMLFiles:"Removed to reduce size",ffmpegReducer:"Removed to reduce size",mediaCache:"Removed to reduce size",magicSubtitlePresets:"Removed to reduce size",textPresets:"Removed to reduce size",textTemplates:"Removed to reduce size",studioLocal:"Removed to reduce size"})});globalThis.globalStore=globalThis.globalStore||Z(YL,XL,JL(ee(...QL),ZL));const eD=globalThis.globalStore,tD={loading:"loading",apiLoading:{}},aD=(e,t)=>{switch(t.type){case"UPDATE_GAPI_LOADING":return{...e,loading:t.loadingState};case"UPDATE_GAPI_API_LOADING":return{...e,apiLoading:{...e.apiLoading,[t.api]:t.loadingState}};default:return e}},oD=r.exports.createContext({state:tD,requestAPI:()=>{}}),nD=({children:e})=>{const[t,a]=r.exports.useState([]),[o,n]=r.exports.useReducer(aD,tD),s="loaded"===o.loading;r.exports.useEffect((function(){ae(rD,(e=>{n(e?{type:"UPDATE_GAPI_LOADING",loadingState:"error"}:{type:"UPDATE_GAPI_LOADING",loadingState:"loaded"})}))}),[]),r.exports.useEffect((function(){if(s)for(const e of t){o.apiLoading[e]||(n({type:"UPDATE_GAPI_API_LOADING",api:e,loadingState:"loading"}),gapi.load(e,(()=>{"client"===e&&gapi.client.load("photoslibrary","v1"),n({type:"UPDATE_GAPI_API_LOADING",api:e,loadingState:"loaded"})})))}}),[s,o.apiLoading,t]);const l=r.exports.useCallback((e=>{a((t=>t.includes(e)?t:[...t,e]))}),[]),d=r.exports.useMemo((()=>({state:o,requestAPI:l})),[o,l]);return i.createElement(oD.Provider,{value:d},e)},rD="https://apis.google.com/js/api.js";function iD(e){const{requestAPI:t,state:a}=r.exports.useContext(oD),o="error"===a.loading,n=!o&&("loaded"!==a.loading||"loaded"!==a.apiLoading[e]);return r.exports.useEffect((()=>{t(e)}),[e,t]),{loading:n,error:o}}const sD=r.exports.createContext({signIn:async(e,t)=>({}),signOut:()=>{},wrapGAPICall:(e,t)=>e(),getUserinfo:async()=>null,email:"",requestAdditionalAccessForScope:()=>{}}),lD=({children:e})=>{const t=iD("client"),{client_id:a}=tr((e=>({client_id:e.config.GOOGLE_PLUGINS_CLIENT_ID})),ar),[o,n]=r.exports.useState(jc.get("gisEmailHint",{disabled:""})||""),[l,d]=r.exports.useState(jc.get("gapiAccessToken",{disabled:""})||"");r.exports.useEffect((function(){ae("https://accounts.google.com/gsi/client",(e=>{e&&console.error(e)}))}),[]);const c=r.exports.useCallback((async(e,o)=>{if(t.error||t.loading)return{};const r=await new Promise(((t,n)=>{window.google.accounts.oauth2.initTokenClient({client_id:a,scope:`email ${e}`,hint:o,prompt:"",callback:e=>{void 0!==e.error&&n(e),t(e)}}).requestAccessToken()})),i=gapi.client.getToken().access_token;jc.set("gapiAccessToken",i),d(i);try{const{result:{email:e}}=await gapi.client.request({path:"https://www.googleapis.com/oauth2/v3/userinfo",method:"GET"});jc.set("gisEmailHint",e),n(e)}catch(YEe){console.error("Attempt to set email hint failed unexpectedly:",YEe)}return r}),[a,t.error,t.loading]),u=r.exports.useCallback((()=>{jc.remove("gisEmailHint"),jc.remove("gapiAccessToken"),n("")}),[]),m=r.exports.useCallback((async function(e,a){var n;if(t.error||t.loading)return e();if(null==(n=gapi.client.getToken())?void 0:n.access_token)try{return await e()}catch(YEe){if(s.exports.isObject(YEe)&&"status"in YEe&&401!==YEe.status)throw Error("Unexpected error from GAPI encountered:",{cause:YEe})}if(l)try{return gapi.client.setToken({access_token:l}),await e()}catch(YEe){if(s.exports.isObject(YEe)&&"status"in YEe&&401!==YEe.status)throw Error("Unexpected error from GAPI encountered:",{cause:YEe})}return await c(a,o),e()}),[c,o,t.error,t.loading,l]),p=r.exports.useCallback((()=>m((async()=>await new Promise((e=>gapi.client.oauth2.userinfo.get().execute((({result:t})=>e(t)))))),"https://www.googleapis.com/auth/userinfo.profile")),[m]),h=r.exports.useCallback(((e,t)=>{google.accounts.oauth2.initTokenClient({callback:t,client_id:a,scope:e}).requestAccessToken({prompt:""})}),[a]),g=r.exports.useMemo((()=>({email:o,getUserinfo:p,requestAdditionalAccessForScope:h,signIn:c,signOut:u,wrapGAPICall:m})),[c,u,m,p,o,h]);return i.createElement(sD.Provider,{value:g},e)};function dD(){const{email:e,getUserinfo:t,requestAdditionalAccessForScope:a,signIn:o,signOut:n,wrapGAPICall:i}=r.exports.useContext(sD);return{email:e,getUserinfo:t,requestAdditionalAccessForScope:a,signIn:o,signOut:n,wrapGAPICall:i}}window.clearEmailHint=()=>{localStorage.removeItem("gisEmailHint")},window.clearAccessToken=()=>{localStorage.removeItem("gapiAccessToken")};const cD="Switch-module_switch_GQQ33",uD="Switch-module_vertical_0vB47",mD="Switch-module_slider_lr-uK",pD="Switch-module_sliderVertical_--vRf",hD="Switch-module_icon_-cd-T",gD="Switch-module_disabledOption_bpP2R",yD=({toggled:e=!1,onChange:t=(()=>null),disabled:a=!1,vertical:o=!1,IconComponent:n=null,iconColor:s="black",backgroundColor:l,sliderColor:d="#101010",...c})=>{const[u,m]=r.exports.useState(e);r.exports.useEffect((()=>{m(e)}),[e]);const p={marginLeft:3,marginTop:4};return u||(o?p.marginTop=24:p.marginLeft=24),i.createElement("label",{...c,className:`\n        ${cD} \n        ${a?gD:""}\n        ${o?uD:""}    \n      `},i.createElement("input",{type:"checkbox",checked:u,onChange:e=>{m(e.target.checked),t&&t(!!e.target.checked)},disabled:a}),i.createElement("span",{className:o?pD:mD,style:{backgroundColor:l,"--sliderColor":d}}),!!n&&i.createElement(n,{className:hD,style:p,color:s,size:12}))},fD=["/","/about","/ai-video-generator","/animated-text-video-maker","/careers","/cartoonify","/contact-us","/creators-fund","/demo","/explore","/explore/directory/A","/explore/directory/B","/explore/directory/C","/explore/directory/D","/explore/directory/E","/explore/directory/F","/explore/directory/G","/explore/directory/H","/explore/directory/I","/explore/directory/J","/explore/directory/K","/explore/directory/L","/explore/directory/more","/explore/directory/M","/explore/directory/N","/explore/directory/O","/explore/directory/P","/explore/directory/Q","/explore/directory/R","/explore/directory/S","/explore/directory/T","/explore/directory/U","/explore/directory/V","/explore/directory/W","/explore/directory/X","/explore/directory/Y","/explore/directory/Z","/how-much-twitch-streamers-make","/logo-redesigns","/meme-maker","/meme-templates","/mobile-mockup","/motion","/museum-of-websites","/netflix-wrapped","/new-tab-stretches","/partnerships","/plugins","/policies/privacy","/policies/refund","/policies/terms-of-service","/pricing","/rick-roller","/sidedoor","/sonoma-county-fire-map","/sound-effects","/startup-demo-videos","/templates","/templates/ad","/templates/collage","/templates/edu","/templates/popular","/templates/tiktok","/templates/youtube","/templates/discord","/templates/facebook","/templates/holiday","/templates/instagram","/templates/twitch","/templates/animation","/templates/zoom","/tools","/404-illustrations"],ED=i.createContext({darkMode:!1,toggleDarkMode:()=>null}),vD=({children:e})=>{const t=oe(),a=m.exports.useDispatch(),{_darkMode:o,user:n}=tr((e=>{var t;return{_darkMode:!!(null==(t=e.theme)?void 0:t.darkMode),user:e.currentUser.user}}),ar),[s,l]=i.useState(!!o);r.exports.useEffect((()=>{const e=window.matchMedia("(prefers-color-scheme: dark)");if(!(null==e?void 0:e.addEventListener))return()=>{};cv(n._id,e.matches);const t=e=>{cv(n._id,e.matches)};return e.addEventListener("change",t),()=>{e.removeEventListener("change",t)}}),[n]),r.exports.useEffect((()=>{var e;const a=s&&!(e=>{const t=[...fD.filter((e=>!["/"].includes(e))),"/explore","/studio","/templates","/admin","/videos"];for(const a of t)if(e.includes(a))return!0;return!1})(t.pathname);null==(e=document.querySelector("body"))||e.setAttribute("data-theme",a?"dark":"light")}),[s,t.pathname]),r.exports.useEffect((()=>{o!==s&&a(Xu(s))}),[o,s,a]);const d=r.exports.useCallback((()=>{l(!s),((e,t)=>{amplitude.getInstance().setUserId(e),amplitude.getInstance().setUserProperties({toggledDarkMode:t})})(n._id,!s)}),[n,s]),c=r.exports.useMemo((()=>({darkMode:s,toggleDarkMode:d})),[s,d]);return i.createElement(ED.Provider,{value:c},e)},wD=({vertical:e,darkColorsOnly:t})=>{const{darkMode:a,toggleDarkMode:o}=i.useContext(ED);return i.createElement(yD,{"data-cy":"theme-switch",toggled:a,onChange:o,vertical:e,IconComponent:a?ne:re,iconColor:a?"#ebf6ff":"#ffe899",backgroundColor:a||t?"#606060":"#e0e0e0",sliderColor:a||t?"#101010":"white"})},bD=100,_D="Tooltip-module_TooltipContent_vYu0u",TD="Tooltip-module_TooltipArrow_2X2gO",SD=({children:e,delayDuration:t=500,message:a,wrapWithDiv:o})=>i.createElement(ie,null,i.createElement(se,{delayDuration:t},i.createElement(le,{asChild:!0},o?i.createElement("div",null,e):e),i.createElement(de,null,i.createElement(ce,{className:_D,sideOffset:5},a,i.createElement(ue,{className:TD})))));function ID(e,t){const a={Action:"","Brand Asset Changed":""};switch(e){case"remove":a.Action="Removed";break;case"add":a.Action="Added";break;case"update":a.Action="Updated"}switch(t){case"color":a["Brand Asset Changed"]="Color";break;case"font":a["Brand Asset Changed"]="Font";break;case"media":a["Brand Asset Changed"]="Media";break;case"template":a["Brand Asset Changed"]="Brand Template";break;case"subtitles":a["Brand Asset Changed"]="Subtitle Styles";break;case"textPreset":a["Brand Asset Changed"]="Text Styles";break;case"textTemplate":a["Brand Asset Changed"]="Text Templates"}vc("Team Brandkit Update",a)}function xD(){const e=r.exports.useRef(!1);return r.exports.useEffect((()=>(e.current=!0,()=>{e.current=!1})),[]),e}const kD="/api/v2/presets/magicSubtitlePresets",CD=async e=>{await yu(kD,{body:{preset:e}})},AD=async e=>{const t=await gu("/api/v2/presets/getSignedAssetUrls",{body:{assetIds:e}}),{signedAssetUrls:a}=t;return a||{}},ND=async e=>{const{dispatch:t}=tn(),a=await(async e=>{const t=`${kD}/${e}`,{presets:a}=await hu(t);return a})(e);a&&t(Um({brandkitPresets:a}))},PD=async(e,t)=>{const{dispatch:a,state:o}=tn();try{const n={...e,teamId:o.teams.selectedTeamId,timestampCreated:Date.now()};if("custom"===e.presetId){n.presetId=`preset-${y()}`;let e=1;o.magicSubtitlePresets.brandkitPresets.forEach((({title:t})=>{if(t.includes("Brand Style")){const a=Number(t.split(" ")[2]);a>=e&&(e=a+1)}})),n.title=`Brand Style ${e}`,MD(n),WD()}a(Gm({preset:n,index:t})),await(async e=>{await gu(kD,{body:{preset:e}})})(n),"custom"===e.presetId&&a(jm({presetId:"custom"}));a(Su({description:"Your subtitle style is now accessible to everyone on your team!",type:"success"})),ID("add","subtitles")}catch(YEe){Iu({description:"Failed to save subtitle style.",error:YEe})}},RD=async e=>{if("custom"!==e.presetId)try{await CD(e)}catch(YEe){Iu({description:"Failed to update subtitle style.",error:YEe})}},LD=async e=>{const{dispatch:t,state:a}=tn(),o=a.teams.selectedTeamId;if(!o)return;const{preset:n}=FD(a);if((null==n?void 0:n.presetId)===e){const{presets:o}=a.magicSubtitlePresets;o.some((t=>t.presetId===e))||t(Ax({updates:{preset:null},undoable:!1}))}try{t(zm({presetId:e})),await(async(e,t)=>{const a=`${kD}/${e}/${t}`;await pu(a)})(o,e),ID("remove","subtitles")}catch(YEe){Iu({description:"Failed to remove subtitle style.",error:YEe})}},DD=()=>{const{state:e}=tn(),t=e.teams.selectedTeamId,{lastExportedPresets:a}=e.magicSubtitlePresets;for(const o of a)if([t,void 0].includes(o.teamId))return o;return im},OD=e=>{var t,a,o,n;return{style:e.style,wordByWordAnimations:e.wordByWordAnimations,transitionId:null==(t=e.transition)?void 0:t.transitionId,transitionDuration:null==(a=e.transition)?void 0:a.transitionDuration,transitionOverlapDuration:null==(o=e.transition)?void 0:o.transitionOverlapDuration,transitionSpeed:null==(n=e.transition)?void 0:n.transitionSpeed,preset:e}},FD=c(mC(),(e=>({preset:null==e?void 0:e.preset,style:null==e?void 0:e.style,wordByWordAnimations:null==e?void 0:e.wordByWordAnimations,transition:(null==e?void 0:e.transitionId)?{transitionId:null==e?void 0:e.transitionId,transitionDuration:null==e?void 0:e.transitionDuration,transitionOverlapDuration:null==e?void 0:e.transitionOverlapDuration,transitionSpeed:null==e?void 0:e.transitionSpeed}:void 0}))),MD=(e,t,a=!0)=>{var o;const{dispatch:n}=tn();a&&function(){const{dispatch:e,state:t}=tn(),{preset:a,style:o,wordByWordAnimations:n,transition:r}=FD(t),i=UD(o,n,r);a||e(Fm(i))}();const r=null!=(o=e.transition)?o:{};n(Ax({updates:{style:null==e?void 0:e.style,wordByWordAnimations:null==e?void 0:e.wordByWordAnimations,preset:e,...r},undoable:t}))};function UD(e,t,a,o="custom",n="Custom"){return{presetId:o,title:n,style:e||Ju,wordByWordAnimations:t,transition:a}}function BD(){const{preset:e,style:t,wordByWordAnimations:a,transition:o}=tr(FD,m.exports.shallowEqual);return e||UD(t,a,o)}function WD(){const{dispatch:e}=tn();e(Fm({...im,presetId:""}))}function VD(){return tr((e=>e.magicSubtitlePresets.customPreset))}function jD(){const e=xD(),t=tr((e=>e.teams.selectedTeamId)),{brandkitPresets:a,presets:o}=tr((e=>e.magicSubtitlePresets)),[n,i]=r.exports.useState(!1);if(r.exports.useEffect((()=>{ND(t)}),[t]),r.exports.useEffect((()=>{!async function(){await(async()=>{const{dispatch:e,state:t}=tn(),{presets:a,lastAssetUrlSignedAt:o}=t.magicSubtitlePresets;if(!(Date.now()-(o||0)<144e5))try{const t=(e=>{const t=[];return e.forEach((({style:{fontFamily:e}})=>{"custom"===e.type&&t.push(e.asset_id)})),t})(a);if(!t.length)return;const o=await AD(t),n=a.map((e=>((e,t)=>{const{style:{fontFamily:a}}=e;return"custom"===a.type?{...e,style:{...e.style,fontFamily:{...a,url:t[a.asset_id]}}}:e})(e,o)));e(Mm({presets:n})),e(Km(Date.now()))}catch(n){console.error("refreshSubtitlePresetAssetUrls err",n)}})(),e.current&&i(!0)}()}),[e]),!n)return{presets:[],brandkitPresets:[]};const s=new Set(a.map((e=>e.presetId)));return{presets:o.filter((e=>e&&e.presetId&&!s.has(e.presetId))),brandkitPresets:a}}function GD(){const{state:e}=tn(),{preset:t,style:a,wordByWordAnimations:o,transition:n}=FD(e);return t||UD(a,o,n)}const HD="PresetPreview-module_container_034hO",zD="PresetPreview-module_preview_YpGeo",$D="PresetPreview-module_selectedPreview_aHLgI",KD="PresetPreview-module_brandkit_nBjDi",YD="PresetPreview-module_more_s2xSx",qD="PresetPreview-module_brandkitIcon_NBr2f",XD=e=>sd().hasPermission(e),JD=e=>ld().hasPermission(e),QD="ModalConfirmButtons-module_disabled_fcnTC",ZD="ModalConfirmButtons-module_loading_8AeVe",eO="ModalConfirmButtons-module_primaryButton_61ELD",tO="ModalConfirmButtons-module_secondaryAction_7nwCf",aO="ModalConfirmButtons-module_secondaryActionNoTransparency_dTMhw",oO="ModalConfirmButtons-module_loader_mLe25",nO="ModalConfirmButtons-module_innerWrapper_4HFB8",rO="ModalConfirmButtons-module_leftOnMobile_DeJ03",iO=({cancelFn:e,confirmFn:t,loadingMsg:a,disabled:o,confirmText:n,cancelText:r,cancelStyle:s,cancelButtonNoTransparency:l,stayRightOnMobile:d,stopClickPropogation:c=!1,confirmButtonClassName:u})=>{if(a)return i.createElement("div",{className:ZD},i.createElement("span",null,a||"Loading..."),i.createElement("div",{className:oO}));const m=e=>{c&&e.stopPropagation(),o||null==t||t()},p=t=>{c&&t.stopPropagation(),null==e||e()};return Al()&&!d?i.createElement("div",{className:nO}," ",i.createElement("div",{className:`${eO} ${o?QD:""} ${u}`,onClick:m,"data-cy":"workspace-next-button","data-testid":"workspace-modal-confirm-button"},n||"Confirm"),e&&i.createElement("div",{onClick:p,className:tO,"data-testid":"workspace-modal-cancel-button"},r||"Never mind")):i.createElement("div",{className:nO},e&&i.createElement("div",{onClick:p,className:`${tO} ${l?aO:""} ${d?"":rO}`,"data-testid":"workspace-modal-cancel-button",style:s},r||"Never mind"),i.createElement("div",{className:`${eO} ${o?QD:""} ${d?"":rO} ${u} ${a?ZD:""}`,onClick:m,"data-cy":"workspace-next-button","data-testid":"workspace-modal-confirm-button"},a||n||"Confirm"))},sO="OverlayWrapper-module_noScrollBar_X1p-e",lO="OverlayWrapper-module_overlayBackground_yJQ-2",dO="OverlayWrapper-module_overlayContainer_-eKQr",cO="OverlayWrapper-module_noWidth_q1ep7",uO="OverlayWrapper-module_overlayContainerPadding_YKOn9",mO="OverlayWrapper-module_overlayContainerSmall_F4IKo",pO="OverlayWrapper-module_overlayContainerSmaller_-TigE",hO="OverlayWrapper-module_exit_huBkG",gO="OverlayWrapper-module_overlayContent_o-zKg",yO="OverlayWrapper-module_header_Eoz17",fO="OverlayWrapper-module_buttonsContainer_9lDny",EO="OverlayWrapper-module_dark_Buyxp",vO="OverlayWrapper-module_noPadding_kYio9",wO=m.exports.connect((e=>({overlay:e.projectSessionSettings.overlay})),(e=>me({hideOverlay:mr},e)));class bO extends r.exports.Component{constructor(){super(...arguments),a(this,"escFunction",(e=>{const{unsetCancelModal:t}=this.props;"Escape"===e.key&&t&&t()})),a(this,"hide",(()=>{const{unsetCancelModal:e,overlay:t,hideOverlay:a}=this.props;e?e():t&&t.key&&a()}))}componentDidMount(){document.addEventListener("keydown",this.escFunction,!1)}componentWillUnmount(){document.removeEventListener("keydown",this.escFunction,!1)}getContainerStyle(){return this.props.biggerPadding?uO:this.props.overlayContainerSmall?mO:this.props.overlayContainerSmaller?pO:dO}get showCloseButton(){const{noCloseButton:e,unsetCancelModal:t,overlay:a}=this.props;return!e&&(t||(null==a?void 0:a.key))}renderContent(){const{afterElement:e,children:t,confirmButtonOptions:a,className:o,dark:n,id:i,onClick:s,style:l,onDrop:d,onDragOver:c,onDragEnter:u,cypressName:m,noScrollBar:p,noPadding:h,noWidth:g,backgroundStyle:y}=this.props;return r.exports.createElement("div",{id:i,onClick:e=>null==s?void 0:s(e)},r.exports.createElement("div",{className:lO,onClick:this.hide,"data-cy":`${m||"overlay"}-background`,onDrop:d,onDragOver:c,onDragEnter:u,style:y}),r.exports.createElement("div",{className:`${this.getContainerStyle()} ${n?EO:""} ${o||""} ${p?sO:""} ${g?cO:""}`,style:l,onDrop:d,onDragOver:c,onDragEnter:u},r.exports.createElement("div",{className:`${gO} \n            ${h?vO:""}`},t,a&&r.exports.createElement("div",{className:fO},r.exports.createElement(iO,{cancelFn:this.hide,...a}))),this.showCloseButton&&r.exports.createElement("div",{className:hO,onClick:this.hide,"data-cy":`${m||"overlay"}-close`},r.exports.createElement(pe,null))),r.exports.createElement("span",null,e))}render(){const{usePortal:e}=this.props;if(!e)return this.renderContent();const t=".app-container",a=document.querySelector(t);return a?he.createPortal(this.renderContent(),a):(console.error(`Expected ${t} to exist in the DOM`),this.renderContent())}}a(bO,"Header",(({children:e})=>r.exports.createElement("div",{className:yO},e)));const _O=wO(bO);const TO=()=>{var e,t;if("undefined"!=typeof window)try{const a=(()=>{const e=eD.getState(),t={...e.studio,topFontsLoaded:!1},a={...e.workspaces,showUploadDialog:!1,showDragUploadDialog:!1},{activeBrandkit:o,...n}=e.teams;return{teams:n,workspaces:a,sourceVideo:e.sourceVideo,currentUser:{user:e.currentUser.user,token:e.currentUser.token,impersonatingAdminEmail:e.currentUser.impersonatingAdminEmail},currentVideo:e.currentVideo,duration:e.duration,resizeTemplate:e.resizeTemplate,resizeBackground:e.resizeBackground,startTime:e.startTime,endTime:e.endTime,editorPath:e.editorPath,isTranscribed:e.isTranscribed,transcriptionId:e.transcriptionId,finishedTranscribingAt:e.finishedTranscribingAt,subtitles:e.subtitles,subtitlesBackgroundColor:e.subtitlesBackgroundColor,subtitlesBackgroundStyle:e.subtitlesBackgroundStyle,subtitlesColor:e.subtitlesColor,translate:e.translate,translateLanguageCode:e.translateLanguageCode,magicSubtitlePresets:e.magicSubtitlePresets,textPresets:e.textPresets,textTemplates:e.textTemplates,isLooped:e.isLooped,numLoops:e.numLoops,watermarkText:e.watermarkText,watermarkPos:e.watermarkPos,watermarkFont:e.watermarkFont,watermarkColor:e.watermarkColor,withCustomWatermark:e.withCustomWatermark,watermarkImg:e.watermarkImg,filter:e.filter,contrast:e.contrast,saturation:e.saturation,brightness:e.brightness,vignette:e.vignette,opacity:e.opacity,isStudio:e.isStudio,studio:t,projectSessionSettings:e.projectSessionSettings,sessionId:e.sessionId,sessionValues:e.sessionValues,mediaCache:e.mediaCache,theme:e.theme}})();if(jc.set("state",function(e){var t;delete e.studio.sharedDoc;const{scenes:a}=e.studio,o=s.exports.cloneDeep(a[0].layers);for(const i of o)delete i.base64_img,delete i.file,delete i.framesAndTimes,delete i.waveformData,delete i.optimizedPreviewFile,delete i.local_url;const n={...a[0],layers:o};let r={};return(null==(t=e.studio.allLayers)?void 0:t.byId)&&(r=s.exports.cloneDeep(e.studio.allLayers.byId),Object.values(r).forEach((e=>{delete e.local_url}))),{...e,studio:{...e.studio,allLayers:{byId:r},scenes:[n]}}}(a)),(null==(e=a.studio)?void 0:e.localId)&&a.projectSessionSettings){const e=`session_${a.studio.localId}`,t={...a.projectSessionSettings};null==a.projectSessionSettings.pendingOps?(console.error("Missing pending ops"),p("Missing pending ops")):t.offlineOps=a.projectSessionSettings.pendingOps.getAllPendingOps(),jc.set(e,t)}if(null==(t=a.studio)?void 0:t.localId){const e=`video_usage_${a.studio.localId}`;jc.set(e,(()=>{function e(e){const t=[],a=[...e].sort(((e,t)=>e-t));let o=a[0],n=o;for(let r=1;r<a.length;r++){const e=a[r];e-n>1?(t.push([o,n]),o=e,n=e):n=e}return t.push([o,a[a.length-1]]),t}const t={};for(const[a,o]of FT.map)t[a]={...o,usage:[],buffered:[]},o.usage.size&&(t[a].usage=e(o.usage)),o.buffered.size&&(t[a].buffered=e(o.buffered));return{records:t,lastUpdated:Date.now()}})())}}catch(a){console.error(a)}};const SO="Loading-module_loader_-f6I0",IO="Loading-module_loading-wrapper_-mT3i",xO="Loading-module_loading-description_Oh1HH",kO="Loading-module_loading-secondary_5AM-p",CO=({loaderStyles:e,secondaryText:t,text:a,textOnly:o=!1,textStyles:n,wrapperStyles:r})=>{let s="Loading ...";return null!=a&&(s=a),i.createElement("div",{className:IO,"data-cy":"loading-container","data-testid":"loading-container",style:r},!o&&i.createElement("div",{className:SO,style:e}),i.createElement("div",null,i.createElement("div",{className:xO,style:n},s),t&&i.createElement("div",{className:kO,style:n},t)))},AO="SignInButtons-module_resetContainer_-J8T0",NO="SignInButtons-module_resetButtonContainer_k7B-5",PO="SignInButtons-module_resetButton_Ga7Z0",RO="SignInButtons-module_googleIcon_KLAsx",LO="SignInButtons-module_orText_fLjgk",DO="SignInButtons-module_wrapper_is7L9";class OO extends Error{constructor(e){super(e),this.name="ExtractValidationError"}}const FO="ErrorBoundary-module_errorText_G7zgY";let MO=!1;class UO extends i.Component{static getDerivedStateFromError(){return{hasError:!0}}constructor(e){super(e),this.state={hasError:!1}}componentDidCatch(e,t){console.error(e,t);const a=BO(e);if(MO||(vc("Error Boundary",{Error:a,"Full Refresh":this.props.refreshOnError}),function(e,t){const a={__FORCE_SAMPLE:!0,errorInfo:t};try{let o="Unknown";try{o=e.constructor.name}catch{o="Unknown "+typeof e}a.errorClassName=o;const{componentStack:n}=t||{};!WO(e.stack)&&WO(n)&&(a.originalStack=e.stack,e.stack=n)}catch(o){console.error(o)}b(e,{extra:a,tags:{errorBoundary:!0}})}(e,t),MO=!0),!this.props.refreshOnError)return;const o=new URLSearchParams(window.location.search);o.get("refresh")||(o.set("refresh","true"),window.location.search=o.toString())}render(){return this.state.hasError?this.props.refreshOnError?null:i.createElement("div",{className:FO},"An unexpected error occurred loading this section. Please try refreshing the page."):this.props.children}}function BO(e){var t;const a="object"==typeof e;let o=e.toString();if(null==(t=o.startsWith)?void 0:t.call(o,"[")){a&&"message"in e&&(o=e.message);const t=a&&e.constructor?e.constructor.name:"";t&&(o=`${t}: ${o}`)}return o}function WO(e){if("string"!=typeof e)return!1;return e.split("\n").filter((e=>e.includes("at ")&&e.includes("/assets/"))).some((e=>{const t=e.match(/\/assets\/(?!vendor).*\..*\.js/);return t&&t.length>0}))}class VO extends Error{constructor(e){super(),this.name="GetMediaInfoError",this.message=e}}const jO=vP((()=>import("./index.1a5cea16.js").then((e=>e.i))),["assets/index.1a5cea16.js","assets/vendor.96643be6.js"]),GO=Math.random()<.01,HO=()=>{};function zO(e){let t="";const a=e.byteLength;for(let o=0;o<a;o+=1)t+=String.fromCharCode(e.getUint8(o));return`data:image/jpeg;base64,${window.btoa(t)}`}function $O(e,t){let a=e;return e.indexOf(t)>-1&&(a=e.substring(0,e.indexOf(t)+t.length)),a}function KO(e=""){return e?e.includes("youtube")||e.includes("youtu.be")?"youtube":e.includes("kapwing")||e.includes("kapwi.ng")?"kapwing":e.includes("tiktok")?"tiktok":e.includes("instagram")?"instagram":e.includes("twitter")?"twitter":e.includes("twitch")?"twitch":e.includes("vimeo")?"vimeo":e.includes("pinterest")?"pinterest":e.includes("dropbox")?"dropbox":e.includes("drive.google.com")?"google-drive":null:null}async function YO(e){const t=await(async e=>await gu("/api/v1/tiktokextract/tiktokurl",{body:{url:e}}))(e);return t.url}async function qO({url:e,excludedMimes:t=[],analyticsCallback:a=HO,doDuplicateHandling:o=!1}){let n=function(e){if(!e)return"";let t=e.trim();if(e.length>2e3)return;const a=[".jpeg",".jpg",".png",".gif",".mp4"];for(const o of a)t=$O(t,o);return t}(e);const r=KO(n);r&&a({platform:r}),Math.random()<.1&&vc("Extract Video Begins",{url:n,platform:r});try{let e="";try{e=await Eu("extract",{body:{url:n,doDuplicateHandling:o},timeout:6e4})}catch(i){if((null==n?void 0:n.includes("tiktok"))&&!(null==n?void 0:n.includes("tiktokcdn"))){n=await YO(n),e=await Eu("extract",{body:{url:n,doDuplicateHandling:o},timeout:6e4})}}if(""!==e)return a({isDirectLink:e.isDirectLink,mimeType:e.mime,fileType:e.ext,stage:dh.ExtractionValidation}),function(e,t){let a="";if(e.hasUploadedAssetDuplicate)return e;if(e.url?e.duration&&e.duration>10800?a="Videos from a link must be shorter than 3 hours.":e.mime&&(t||[]).length&&t.includes(e.mime)?a=`Format ${e.mime} currently unsupported.`:e.url&&e.url.includes("accounts.google.com/Captcha")&&(a="Content is not supported"):a="No content found for this URL.",a)throw new OO(a)}(e,t),e;throw new OO("extraction failed")}catch(i){if(i instanceof Error){const e=i.name||"ExtractError",{message:t}=xu(i);vc("Extract Video Fails",{url:n,name:e,platform:r,message:t})}throw i}}function XO(e){const t=new Promise(((t,a)=>{const o=new FileReader;o.readAsText(e),o.onload=()=>{o.result?t(-1!==o.result.indexOf("ANMF")?"animated":"static"):a(new Error("Reader result was empty"))},o.onerror=e=>a(e)})),a=new Promise((e=>{setTimeout((()=>{console.error("Failed to load webp within timeout, defaulting to static"),e("static")}),1e4)}));return Promise.race([t,a])}function JO(e,t){const a=function(e){var t;const[a="",o=""]=e.split(","),n=a.indexOf("base64")>-1?atob(o):unescape(o),r=null==(t=a.split(":")[1])?void 0:t.split(";")[0],i=new Uint8Array(n.length);for(let s=0;s<n.length;s+=1)i[s]=n.charCodeAt(s);return new Blob([i],{type:r})}(t);return new File([a],e.name||"",{type:a.type})}async function QO(e){var t;let a,o,n;"undefined"!=typeof window&&(a=await vP((()=>import("./index.a6617242.js")),["assets/index.a6617242.js","assets/vendor.96643be6.js"]));const r=Lr(e);if(a&&r&&(n=await a.getAsset(r)),n&&"video"!==n.type&&!n.isOptimizedPreview)o=n.file;else if(n&&"video"===n.type&&(n.file_v2||n.file))o=n.file_v2.file||n.file;else{const a=tT(e,"url","original"),n=await fetch(a),r=await n.blob();o=new File([r],e.name||"",{type:null!=(t=e.mime)?t:void 0})}o.id=y(),o.local_url=URL.createObjectURL(o);return{file:o,fileData:{id:e.id,local_url:o.local_url}}}const ZO=async(e,t,a)=>{try{const{orientation:o,stripped:n}=await function(e){return new Promise(((t,a)=>{const o=new FileReader;o.onload=e=>{var a;const o=new DataView(null==(a=e.target)?void 0:a.result);if(65496!==o.getUint16(0,!1))return t({orientation:null});const n=o.byteLength;let r=2;for(;r<n;){if(o.getUint16(r+2,!1)<=8)return t({orientation:null});const e=o.getUint16(r,!1);if(r+=2,65505===e){if(1165519206!==o.getUint32(r+=2,!1))return t({orientation:null});const e=18761===o.getUint16(r+=6,!1);r+=o.getUint32(r+4,e);const a=o.getUint16(r,e);r+=2;for(let n=0;n<a;n+=1)if(274===o.getUint16(r+12*n,e)){const a=o.getUint16(r+12*n+8,e);return o.setUint16(r+12*n+8,0,e),t({orientation:a,stripped:zO(o)})}}else{if(65280!=(65280&e))break;r+=o.getUint16(r,!1)}}return t({orientation:null})},o.addEventListener("error",(e=>{a(e)})),o.readAsArrayBuffer(e)}))}(e);return o?(t&&t("Processing content ..."),function(e,t,a,o){return new Promise((n=>{const r=new Image;r.onerror=()=>{o("Something went wrong. Please make sure your media is a compatible format.",e,"cleanUpImage")},r.onload=()=>{const{width:t}=r,{height:i}=r,s=document.createElement("canvas"),l=s.getContext("2d");if(l){switch(a>4&&a<9?(s.width=i,s.height=t):(s.width=t,s.height=i),a){case 2:l.transform(-1,0,0,1,t,0);break;case 3:l.transform(-1,0,0,-1,t,i);break;case 4:l.transform(1,0,0,-1,0,i);break;case 5:l.transform(0,1,1,0,0,0);break;case 6:l.transform(0,1,-1,0,i,0);break;case 7:l.transform(0,-1,-1,0,i,t);break;case 8:l.transform(0,-1,1,0,0,t)}l.drawImage(r,0,0),n(JO(e,s.toDataURL("image/jpeg")))}else o("No ctx",e,"cleanUpImage")},r.src=t||""}))}(e,n,o,a)):e}catch(YEe){return e}};function eF(e=""){const t=e.split(".").pop();return t?t.split("?").shift():e}function tF(e,t){const a=e&&eF(e);return"m3u8"===a?"hls-to-mp4":"3gp"===a||"video/3gpp"===t?"3gp-to-mp4":"mov"===a||"video/quicktime"===t?"mov-to-mp4":"mp4"===a||"video/mp4"===t?"mp4-to-mp4":"avi"===a||["video/avi","video/x-msvideo"].includes(t)?"avi-to-mp4":"flv"===a||"video/x-flv"===t?"flv-to-mp4":"wmv"===a||"video/x-ms-wmv"===t?"wmv-to-mp4":"m4a"===a||"audio/x-m4a"===t?"m4a-to-mp3":"mp3"===a||"audio/mpeg"===t?"mp3-to-mp3":"heic"===a||"image/heic"===t?"heic-to-jpeg":"heif"===a||"image/heif"===t?"heif-to-jpeg":"none"}function aF(e){var t;const{name:a,type:o}=e;if(o)return o;switch(a?(null==(t=a.split(".").pop())?void 0:t.toLowerCase())||"":void 0){case"mkv":return"video/x-matroska";case"ttf":return"font/ttf";case"otf":return"font/otf";default:return null}}function oF(e){return"mpd"===e.split(".").pop()}function nF(e){return["image/gif","image/jpg","image/jpeg","image/png","image/heic","image/heif","image/svg+xml","image/webp"].includes(e)}function rF(e,t=null){const a=["video/mp4","video/quicktime","video/webm","video/mpeg","video/ogg","video/3gpp","video/avi","video/x-ms-wmv","video/x-flv","video/x-matroska","video/x-msvideo","video"];return t&&a.push(...t),a.includes(e)}const iF=e=>new Promise((t=>setTimeout((()=>t()),e))),sF=async(e,t)=>(await(Nl()||Rl()?iF(10):iF(0)),new Promise((a=>{const o=document.createElement("video");o.preload="auto",o.src=e,(Nl()||Rl())&&(o.volume=0,o.muted=!0,o.autoplay=!0,o.pause());let n=null,r=null;const i=()=>{n&&r&&a({success:!0,properties:{...n,...r}})};o.onerror=n=>{a({success:!1,properties:{type:ln.Video},errorInfo:{fileType:t,mediaType:"video",url:e,htmlVideoFailureEvent:"string"==typeof n?n:n.type,htmlVideoError:o.error&&BO(o.error),htmlVideoErrorCode:o.error instanceof MediaError?o.error.code:0},errorEvent:n})},o.addEventListener("durationchange",(()=>{o.duration!==1/0?(r=dF(o,t),i()):(console.error("getVideoInfo returned Infinity duration"),a({success:!1,properties:{type:ln.Video},errorEvent:"Infinite duration",errorInfo:{fileType:t,mediaType:"video",url:e,htmlVideoFailureEvent:"Infinite duration",htmlVideoError:o.error&&BO(o.error),htmlVideoErrorCode:o.error instanceof MediaError?o.error.code:0}}))})),lF(o).then((e=>{n={hasAudio:e},i()}))}))),lF=e=>new Promise((t=>{const a=()=>t(!0),o=Nl()||Rl()?"canplay":"loadeddata",n=()=>e.mozHasAudio||(e.audioTracks||[]).length>0||e.webkitAudioDecodedByteCount>0;e.readyState>1?t(n()):e.error?a():(e.addEventListener("error",(()=>{a()}),{once:!0}),e.addEventListener(o,(()=>t(n())),{once:!0}))})),dF=(e,t)=>{const a=cF(t,e.videoHeight,e.videoWidth);return{duration:e.duration,height:e.videoHeight,type:a,width:e.videoWidth}},cF=(e,t,a)=>!e.includes("/webm")&&!e.includes("/mpeg")||t||a?e.includes("audio")?ln.Audio:ln.Video:ln.Audio;function uF(e,t,a){return new Promise((o=>{const n=new Image;n.onload=()=>{o({success:!0,properties:{height:n.height,type:ln.Image,width:n.width,...a&&{webpType:a}}})},n.onerror=a=>{o({success:!1,properties:{type:ln.Image},errorInfo:{fileType:t,mediaType:"image",url:e,htmlImageFailureEvent:"string"==typeof a?a:a.type}})},n.src=e}))}const mF=e=>e.split("?")[0],pF=[{mime:"audio/x-m4a",type:ln.Audio}];async function hF(e,t){GO&&vc("getMediaInfo Started");const a=aF(t||{name:mF(e)})||"",o=rF(a),n=nF(a),r=ge(e),i=!o&&(n||r);if(!i&&!o){const[o,n]=await Promise.all([uF(e,a),sF(e,a)]);if(n.success)return n.properties;if(o.success)return o.properties;let r,i;if("size"in t){if([r,i]=await Promise.all([yF(t),gF(t)]),r.success)return r.properties;if(i.success)return i.properties}console.info("Failed to load unclear media type",n.errorInfo,o.errorInfo),EF({imageResErrorInfo:o.errorInfo,videoResErrorInfo:n.errorInfo,imageWasmRes:r,videoWasmRes:i,fileType:a,src:e});const s=pF.find((e=>e.mime===a));return s?{type:s.type}:null}if(i){let o;try{o=await XO(t)}catch(YEe){}const n=await uF(e,a,o);let r;if(!n.success){if("size"in t&&o&&(r=await yF(t,o),r.success))return r.properties;sl()||console.info("Failed to image video info",n.errorInfo),EF({imageResErrorInfo:n.errorInfo,imageWasmRes:r,fileType:a,src:e,layerType:ln.Image})}return n.properties}const s=await sF(e,a);if("duration"in s.properties){const{duration:e}=s.properties;if(Number.isNaN(e)||e>43200)throw Error("Asset has invalid duration")}if(!s.success){let o;if("size"in t&&(o=await gF(t),o.success))return o.properties;const n=(null==o?void 0:o.properties.type)||ln.Video;sl()||console.info("Failed to load video info",s.errorInfo),EF({videoResErrorInfo:s.errorInfo,videoWasmRes:o,fileType:a,src:e,layerType:n})}return s.properties}async function gF(e){const t=await fF(e),a={hasAudio:!1};for(const o of t.media.track)"General"===o["@type"]?a.duration=parseFloat(o.Duration):"Video"===o["@type"]?(a.type=ln.Video,a.width=parseFloat(o.Width),a.height=parseFloat(o.Height)):"Audio"===o["@type"]&&(a.hasAudio=!0);return!a.type&&a.hasAudio&&(a.type=ln.Audio,a.height=0,a.width=0),a.duration&&a.type===ln.Audio&&a.hasAudio||a.duration&&a.type&&a.height&&a.width&&a.type===ln.Video?(a.didFailHtmlMediaCheck=!0,{success:!0,properties:a}):{success:!1,properties:{type:a.type}}}async function yF(e,t){const a=await fF(e),o={};o.webpType=t||await XO(e);for(const n of a.media.track)"Image"===n["@type"]&&(o.type=ln.Image,o.width=parseFloat(n.Width),o.height=parseFloat(n.Height));return o.type&&o.height&&o.width&&o.webpType?(o.didFailHtmlMediaCheck=!0,{success:!0,properties:o}):{success:!1,properties:{type:o.type}}}async function fF(e){const t=await ye({format:"JSON",locateFile:()=>"/MediaInfoModule.wasm"});return JSON.parse(await t.analyzeData((()=>e.size),((t,a)=>new Promise(((o,n)=>{const r=new FileReader;r.onload=e=>{var t;(null==(t=e.target)?void 0:t.error)&&n(e.target.error),e.target&&e.target.result&&o(new Uint8Array(e.target.result)),n()},r.readAsArrayBuffer(e.slice(a,a+t))})))))}function EF({imageResErrorInfo:e,videoResErrorInfo:t,imageWasmRes:a,videoWasmRes:o,fileType:n,src:r,layerType:i}){const s=i||(null==a?void 0:a.properties.type)||(null==o?void 0:o.properties.type)||"unclear",l=!!a||!!o;GO&&(b(new VO("getMediaInfo failure"),{extra:{__FORCE_SAMPLE:!0,src:r},tags:{isFile:l,mediaType:s}}),vc("getMediaInfo failure",{fileType:n,mediaType:s,url:r,htmlImageFailureEvent:null==e?void 0:e.htmlImageFailureEvent,htmlVideoFailureEvent:null==t?void 0:t.htmlVideoFailureEvent,htmlVideoError:null==t?void 0:t.htmlVideoError,htmlVideoErrorCode:null==t?void 0:t.htmlVideoErrorCode,isFile:l}))}const vF=["video/3gpp","video/avi","video/x-flv","video/x-ms-wmv","video/x-msvideo","audio/x-m4a","image/heif","image/heic"],wF=["m3u8","3gp","3gpp","mov","avi","flv","wmv","heic","heif"];async function bF(e,t){if(t.conversion_id)return!0;const a=e.type;if(vF.includes(a))return!0;if(!["audio/mpeg","video/quicktime","video/mp4"].includes(a))return!1;try{if((t.width||t.height)&&!t.didFailHtmlMediaCheck)return!1;if("video/quicktime"===a)return!0;if("audio/mpeg"===a){const t=await async function(e){var t;const a=await fF(e),o=null==(t=null==a?void 0:a.media)?void 0:t.track;for(const n of o)if("OverallBitRate_Mode"in n)return n.OverallBitRate_Mode;return"Unknown"}(e);return"VBR"===t}const o=await e.arrayBuffer(),n=new Uint8Array(o),r=await(await jO).mp4.probe.tracks(n);if(!r.length)return!0;for(let e=0;e<r.length;e+=1)if("video"===r[e].type)return!0;return!1}catch(o){return console.error(o),!0}}function _F(e){return qO({url:e,excludedMimes:["x-mpegurl"]})}function TF(e,t=null){const a=["audio/aac","audio/m4a","audio/mp3","audio/mp4","audio/mpeg","audio/ogg","audio/wav","audio/webm","audio/x-m4a","audio/x-wav","audio/flac"];return t&&a.push(...t),a.includes(e)}const SF=new Set([ln.Text,ln.Shape,ln.Subtitle]);function IF(e){if(SF.has(e.type))return!1;const{type:t,source:a,url:o,asset_id:n,uploadPending:r}=e;return r?"uploadPending":!n&&("local"===a?"localSource":!(!["image","video"].includes(t)||a||o)&&"noSourceOrURL")}function xF(e){return e.requireConversion||e.videoConvertedState&&"complete"!==e.videoConvertedState}function kF(e){const t=[];for(const a of e)if(a.layers)for(const e of a.layers)(IF(e)||xF(e))&&t.push(e);return t}function CF(e){const t="trim"===e.studio.origin;if(e.sourceVideo&&!e.isStudio&&"local"===e.sourceVideo.source)return{reason:"SOURCE_VIDEO"};if((e.isStudio||t)&&e.studio.scenes){const t=function(e){const t=[];for(const a of e)if(a.layers)for(const e of a.layers)IF(e)&&t.push(e);return t}(e.studio.scenes);if(t.length>0)return{reason:"LAYERS",layerNames:s.exports.uniq(t.map((e=>e.userSetName||e.name||e.fontFamily||`Unnamed ${e.type} layer`)))}}return null}function AF(e){return!!CF(e)}function NF(e){let t=e;const a=e.split(".");return(a.pop()||"")in fP&&(t=a.join(".")),t}const PF=(e={})=>{const t="image/*,image/heic,image/heif",a="audio/mpeg,audio/wav,audio/aac,audio/ogg,audio/x-wav,audio/aac,audio/mp4,audio/x-m4a,audio/*",o="video/mp4,video/webm,video/*,video/3gpp,video/avi,video/x-flv,.mkv,video/x-ms-wmv";return e.audiogramUpload?a:e.audioUpload?[a,o].join(","):e.disallowVideo?t:e.fontUpload?".ttf,.otf":e.logoUpload?"image/jpg,image/jpeg,image/png,image/heic,image/heif,image/svg+xml,image/webp":[t,a,o].join(",")},RF="EmailSiginIn-module_emailSignInContainer_WB8HJ",LF="EmailSiginIn-module_input_NtVRB",DF="EmailSiginIn-module_submit_4HPJx",OF="EmailSiginIn-module_codeContainer_-q-Zo",FF="EmailSiginIn-module_codeSentNote_AhxL7",MF="EmailSiginIn-module_receivedNoCode_LdDMS",UF="EmailSiginIn-module_agreement_CX3m4",BF="EmailSiginIn-module_underlineLink_SnNj5",WF=({email:e,handleSuccess:t})=>{const a=m.exports.useDispatch(),[o,n]=r.exports.useState(!1),[s,l]=r.exports.useState(!1),[d,c]=r.exports.useState(!1),[u,p]=r.exports.useState(""),[h,g]=r.exports.useState(""),{executeRecaptcha:y}=fe(),f=Ee(),E=r.exports.useRef(null),v=tr((e=>e.sessionValues.onboarding)),w=tr((e=>e.config.RECAPTCHA_V3_SITEKEY)),b=tr((e=>e.config.RECAPTCHA_V2_SITEKEY));return r.exports.useEffect((()=>{p(e||"")}),[e]),i.createElement("form",{className:RF,onSubmit:e=>{e.preventDefault(),(async()=>{var e;if(s){try{n(!0);const e=await gu("/api/v1/users/email/findUser",{body:{email:u,code:h}});e.newUser&&(a(Mu({...v,newUser:!0})),a(DE([e.team])),a(gv([e.workspace]))),e.emailInvitedUser&&a(Mu({...v,newUser:!0})),a(qc(e.user,e.token)),a(jE()),Sc(e.user,e.newUser,"Email"),Oc(e.user,e.newUser,"Email",f.path),null==t||t()}catch(o){Iu({description:"Failed to sign in",error:o})}n(!1)}else if(Mf(u)){try{if(!y)throw new Error("Recaptcha loading ... please try again in a few seconds.");const t=await y("emailSignIn"),a=null==(e=E.current)?void 0:e.getValue();n(!0),await gu("/api/v1/users/email/signin",{body:{email:u,v3CaptchaToken:t,v2CaptchaToken:a,recaptchaKeyV3:w,recaptchaKeyV2:b}}),l(!0)}catch(o){Iu({description:"Failed to sign in",error:o}),zf(o)&&c(!0)}n(!1)}else a(Su({description:"Please input a valid email address.",type:"error"}))})()}},i.createElement("input",{className:LF,disabled:s,placeholder:"Enter your email",readOnly:s,type:"email",value:u,"data-testid":"email-input",onChange:e=>p(e.target.value)}),!s&&d&&i.createElement("div",{style:{marginBottom:"10px"}},i.createElement(ve,{sitekey:b,ref:E})),!s&&i.createElement(i.Fragment,null,i.createElement("button",{className:DF,disabled:o,type:"submit","data-testid":"submit-email-button"},o?"Loading...":"Continue with email"),i.createElement("div",{className:UF},"By using Kapwing, you agree to our"," ",i.createElement("a",{href:"/policies/terms-of-service",target:"_blank",className:BF},"Terms of Service")," ","and"," ",i.createElement("a",{href:"/policies/privacy",target:"_blank",className:BF},"Privacy Policy"),".")),s&&i.createElement("div",{className:OF},i.createElement("div",{className:FF},i.createElement("span",null,"Code sent!")," Check your email for a login code from Kapwing."),i.createElement("input",{className:LF,placeholder:"Paste Sign In Code",type:"text",value:h,onChange:e=>{return t=e.target.value,void g(t.toUpperCase());var t}}),i.createElement("button",{className:DF,disabled:o,type:"submit","data-testid":"submit-code-button"},o?"Loading...":"Continue with login code"),i.createElement("div",{className:MF},"If you didn't receive an email, please check your spam folder or try a different sign in option.")))};class VF extends r.exports.Component{constructor(e){super(e),a(this,"loadFB",(()=>{const{facebookAppId:e}=this.props;"undefined"!=typeof FB?(FB.init({appId:e,cookie:!0,xfbml:!0,version:"v5.0"}),this.setState({fbInitialized:!0})):setTimeout(this.loadFB,200)})),a(this,"handleError",((e,t="signIn",a="Sign In")=>{const{showToast:o}=this.props;let n=e;e||(n="An error occurred during sign in. Please try again later."),vc("Sign In Error Occurred",{"Error Type":t,Details:a}),o({description:n,type:"error"}),this.setState({loading:!1})})),a(this,"handleSignInWithFacebook",(async()=>{const{fbInitialized:e}=this.state;e?(this.setState({loading:!0}),FB.getLoginStatus((e=>{"connected"===e.status?this.handleFacebookResponse(e.authResponse):FB.login((e=>{if("connected"===e.status)this.handleFacebookResponse(e.authResponse);else{const t="Couldn't log in with Facebook right now. Please try again later.";console.error("Fb error:",e),this.handleError(t,"facebookResponse",e.error)}}),{scope:"public_profile,email"})}))):vc("Sign In Error Occurred",{"Error Type":"signIn",Details:"Facebook Not Initialized"})})),a(this,"handleFacebookResponse",(e=>{const{match:t,onSuccess:a,setOnboarding:o,onboarding:n}=this.props;(async function(e){const{dispatch:t}=tn();t({type:"REQUEST_USER"});const a=await gu("/api/v1/users/facebook/findUser",{body:{user:e}}),{user:o,token:n,newUser:r}=a;if(t(qc(o,n)),Sc(o,r,"Facebook"),r){const{team:e,workspace:o}=a;t(gv([o])),t(DE([e]))}return a})(e).then((e=>{Oc(e.user,e.newUser,"Facebook",t.path),a&&a(),e.newUser&&o({...n,newUser:!0})})).catch((e=>{this.handleError(e.message,"fetchFacebookUser",e.message)}))})),a(this,"signInWithGoogle",(async()=>{const{location:e,uploadPending:t,showToast:a,redirectToPathname:o,immediateRedirectPathname:n,mockSignIn:r,forceNavigationTo:i,onSuccess:s}=this.props;if(window.Cypress)return setTimeout((()=>{r(),TO(),null==s||s()}),1e3),void this.setState({loading:!0});if(t)return void a({description:"There is an in-progress upload in your project. Please wait until it completes to sign in.",type:"warning"});this.setState({loading:!0});let l={pathname:n||e.pathname,goToNext:o||""};i&&(l={pathname:i,goToNext:""});const d=await hu("/api/v1/users/google/getOAuthURL",{params:l});TO();const{url:c}=d;window.location.assign(c)})),a(this,"renderResponseLoading",(()=>i.createElement("div",{className:DO},i.createElement(CO,{text:""}),i.createElement("div",{className:AO},i.createElement("span",null,"Use the OAuth dialog window to finish signing in."),i.createElement("div",null,"Having trouble signing in?"),i.createElement("div",{className:NO},i.createElement("div",{className:PO,onClick:()=>{this.setState({loading:!1})}},"Click here to try again")))))),this.state={fbInitialized:!1,loading:!1}}componentDidMount(){this.loadFB()}renderButtons(){const{email:e,smallTheme:t}=this.props;return i.createElement("div",{className:t?"small-theme":DO},i.createElement("button",{type:"button",className:"sign-in-dialog-google-button",onClick:this.signInWithGoogle,"data-cy":"signin-google-button"},i.createElement("div",{className:RO},i.createElement(be,null)),i.createElement("span",null,"Continue with Google")),i.createElement("div",{className:"sign-in-dialog-facebook-button",onClick:this.handleSignInWithFacebook,"data-cy":"signin-facebook-button"},i.createElement("div",{className:"sign-in-dialog-button-icon"},i.createElement(_e,null)),i.createElement("span",null,"Continue with Facebook")),i.createElement("div",{className:LO},"or"),i.createElement(WF,{email:e,handleSuccess:this.props.onSuccess}))}render(){const{loading:e}=this.state;return e?this.renderResponseLoading():this.renderButtons()}}const jF=we(m.exports.connect((e=>({currentUser:e.currentUser,facebookAppId:e.config.FACEBOOK_APP_ID,uploadPending:AF(e),onboarding:e.sessionValues.onboarding})),(e=>me({requestUser:Xc,mockSignIn:Ff,setOnboarding:Mu,showToast:Su},e)))(VF)),GF="SignInDialog-module_dialogBackground_cjx59",HF="SignInDialog-module_dialogContainer_oIPd3",zF="SignInDialog-module_dialogHeader_3ttx-",$F="SignInDialog-module_description_LESgO",KF="SignInDialog-module_closeContainer_W-zyQ",YF="SignInDialog-module_left_R2euZ",qF="SignInDialog-module_right_YD0O5",XF="SignInDialog-module_rightImage_2Fe65";var JF=(e=>(e.INPUT_CLICK="Initiate Signed Out Comment",e.EMPTY_COMMENT_PANE="Sign In to Comment",e))(JF||{});function QF(e){vc("Initiate Signed Out Comment"===e?"Initiate Signed Out Comment":"Sign In to Comment")}class ZF extends r.exports.Component{constructor(e){super(e),a(this,"handleSuccess",(async()=>{const{hideSignIn:e,onSuccess:t}=this.props;t&&t(),e&&e()})),this.handleSuccess=this.handleSuccess.bind(this)}componentDidMount(){vc("Initiate Sign In")}render(){const{description:e,email:t,customTitle:a,hideSignIn:o,immediateRedirectPathname:n,redirectToPathname:r,customImage:s}=this.props;let l="Kapwing works better when you're signed in. Sign in to save content to a workspace, comment, and more.";e&&(l=e);const d=document.querySelector(".app-container");if(!d){const e="Couldn't find .app-container to mount SignInDialog to.";return sl()?console.error(`${e} ${ll}`):console.error(e),null}return he.createPortal(i.createElement(i.Fragment,null,i.createElement("div",{className:GF,onClick:o}),i.createElement("div",{className:HF,"data-cy":"signin-dialog"},(()=>i.createElement(i.Fragment,null,i.createElement("div",{className:YF},i.createElement("div",{className:zF},a||"Sign in to continue"),i.createElement("div",{className:KF,onClick:o},i.createElement(pe,{style:{fontSize:24}})),i.createElement("div",{className:$F,"data-cy":"signin-dialog-description"},l),i.createElement(jF,{email:t,immediateRedirectPathname:n,onSuccess:this.handleSuccess,redirectToPathname:r})),i.createElement("div",{className:qF},i.createElement("img",{src:s||"https://cdn-useast1.kapwing.com/static/fQJ-signin-dialog=right-default.webp",alt:"Sign in to Kapwing",className:XF}))))())),d)}}const eM=()=>[Gs(vs.Pro)],tM="OverlayWrapper-module_overlayHeader_14EqT",aM="OverlayWrapper-module_noOverlayBackground_FHvwb",oM="OverlayWrapper-module_overlayBackground_tYQaR",nM="OverlayWrapper-module_overlayInput_pNrjg",rM="OverlayWrapper-module_overlayContainer_LErTM",iM="OverlayWrapper-module_videoPreviewOverlayContainer_DzSZ1",sM="OverlayWrapper-module_overlayContainerNoPadding_pO7Nr",lM="OverlayWrapper-module_overlayContainerNoScrollbar_KZ1yE",dM="OverlayWrapper-module_smallOverlayContainer_N3-vX",cM="OverlayWrapper-module_miniOverlayContainer_y8m-s",uM="OverlayWrapper-module_miniLightOverlayContainer_Vjyth",mM="OverlayWrapper-module_versionHistoryOverlayContainer_Wjnrx",pM="OverlayWrapper-module_lightThemeOverlayContainer_u9XTJ",hM="OverlayWrapper-module_smallLightThemeOverlayContainer_eCk5q",gM="OverlayWrapper-module_replaceOverlayContainer_g1EYo",yM="OverlayWrapper-module_uploadOverlayContainer_49dxN",fM="OverlayWrapper-module_fontOverlayContainer_o0-nD",EM="OverlayWrapper-module_uploadOverlayResultsContainer_9PTJo",vM="OverlayWrapper-module_signInOverlayContainer_ZMa78",wM="OverlayWrapper-module_exit_IbZ9z",bM="OverlayWrapper-module_darkExit_eBe8W",_M="OverlayWrapper-module_exportPanelOverlayContainer_GhIQF",TM="OverlayWrapper-module_overlayContent_IyJac",SM="OverlayWrapper-module_overlayContentNoFlex_yhAX8",IM="OverlayWrapper-module_description_tB4Y9",xM="OverlayWrapper-module_buttonRow_02CMd",kM="OverlayWrapper-module_primaryButton_cMla-";class CM extends r.exports.Component{constructor(e){super(e),a(this,"uploaderMounted",(()=>{const{location:e}=this.props;return e.pathname.includes("drag-upload")})),a(this,"setFiles",(e=>{var t,a;this.setState({uploadInProgress:!0}),null==(a=(t=this.props).onFilesChanged)||a.call(t,e)})),a(this,"handleDragUpload",(e=>{var t,a;this.setState({uploadInProgress:!0}),null==(a=(t=this.props).onFilesChanged)||a.call(t,e.target.files)})),a(this,"handleClick",(()=>{const{history:e,goBackToSelectedLayer:t,goBackToEditor:a=!0,editorPath:o,selectedLayerId:n,overlay:r,hideOverlay:i,onClose:s}=this.props;s?s():r&&r.key?i():t&&n?e.goBack():a?iT(o):e.goBack()})),a(this,"handleFileDrop",(e=>{this.setFiles(e.dataTransfer.files),e.preventDefault(),e.stopPropagation()})),a(this,"handleDragOver",(e=>{e.preventDefault(),e.stopPropagation()})),a(this,"handleDragEnter",(e=>{e.preventDefault(),e.stopPropagation()})),a(this,"renderDragInput",(()=>this.uploaderMounted()&&!this.state.uploadInProgress&&i.createElement("input",{"data-cy":"upload-input",className:nM,accept:this.props.accept||"image/*,video/mp4,video/*",onChange:this.handleDragUpload,type:"file",multiple:!0,onDragLeave:sT}))),this.state={videoPlayingOnMount:!1}}componentDidMount(){const{subtitleVideo:e,previewVideo:t}=this.props;this.setState({videoPlayingOnMount:!this.props.studioPaused}),this.props.pauseStudio(),e&&e.pause(),t&&t.pause(),EA()}componentDidUpdate(){this.props.studioPaused||this.props.pauseStudio()}componentWillUnmount(){this.state.videoPlayingOnMount&&KA(),vA()}render(){const{children:e,keepScrollbar:t,noBackground:a}=this.props;let o=rM,n=wM;this.props.small?o=dM:this.props.lightTheme?(o=pM,n+=` ${bM}`):this.props.smallLightTheme?(o=hM,n+=` ${bM}`):this.props.uploadOverlayResultsTheme?o=EM:this.props.replace?o=gM:this.props.uploadOverlayTheme?o=yM:this.props.fontOverlayTheme?o=fM:this.props.signInDialog?(o=vM,n+=` ${bM}`):this.props.mini?o=cM:this.props.miniLight?o=uM:this.props.versionHistory?o=mM:this.props.useExportPanelStyle?o=_M:this.props.noPadding?o=sM:this.props.videoPreview&&(o=iM),t||(o=`${o} ${lM}`);const r=document.querySelector(".app-container");if(!r){const e="Couldn't find .app-container to mount OverlayWrapper to.";return sl()?console.error(`${e} ${ll}`):console.error(e),null}return he.createPortal(i.createElement("div",{onDrop:this.handleFileDrop,onDragOver:this.handleDragOver,onDragEnter:this.handleDragEnter},i.createElement("div",{className:a?aM:oM,onClick:this.handleClick,"data-cy":"overlay-background"}),this.renderDragInput(),i.createElement("div",{className:o,"data-cy":"overlay-container",style:(()=>{const{width:e,backgroundColor:t,noMaxWidth:a,maxWidth:o}=this.props;let n={};return e&&(n={...n,width:e}),t&&(n={...n,backgroundColor:t}),o?n={...n,maxWidth:o}:a||o||(n={...n,maxWidth:800}),n})()},!this.props.hideClose&&i.createElement("div",{"data-cy":"overlay-close",className:n,onClick:this.handleClick},i.createElement(pe,null)),i.createElement("div",{className:(()=>this.props.overlayContentNoFlex?SM:TM)()},e))),r)}}const AM=m.exports.connect((e=>{var t;return{editorPath:e.editorPath,overlay:e.projectSessionSettings.overlay,previewVideo:e.previewVideo,selectedLayerId:(null==(t=e.studio.selectedItem)?void 0:t.id)||"",studioPaused:e.studio.studioPaused,subtitleVideo:e.subtitleVideo}}),(e=>me({hideOverlay:mr,pauseStudio:K_},e))),NM=we(AM(CM)),PM="Disclaimer-module_disclaimer_5eE9b",RM="Disclaimer-module_underlineLink_v-1C8",LM=({planTier:e})=>i.createElement("div",{className:PM},"By upgrading, you understand the subscription will auto renew until cancelled. You agree to Kapwing's"," ",i.createElement("a",{href:"/policies/terms-of-service",target:"_blank",rel:"noopener",className:RM},"Terms of Service")," ","and"," ",i.createElement("a",{href:"/policies/refund",target:"_blank",rel:"noopener",className:RM},"Refund Policy"),". Learn more about Kapwing ",e.name," ",i.createElement("a",{href:"/pricing",target:"_blank",rel:"noopener",className:RM},"pricing here"),"."),DM="UpgradeModal-module_modalBackground_Ow9-8",OM="UpgradeModal-module_paywallTitle_zsuH0",FM="UpgradeModal-module_paywallContainer_66aIt",MM="UpgradeModal-module_paywallColumns_zVAmJ",UM="UpgradeModal-module_flexRight_WXjFi",BM="UpgradeModal-module_flexLeft_mqEHL",WM="UpgradeModal-module_returnLink_jTS-W",VM="UpgradeModal-module_tierWrapper_sEQBj",jM="UpgradeModal-module_tierColumn_wkBJm",GM="UpgradeModal-module_checkoutButton_1iCcj",HM="UpgradeModal-module_checkoutChevron_rnvuZ",zM="UpgradeModal-module_planImageContainer_bQrRF",$M="UpgradeModal-module_planImage_r1Ixx",KM="UpgradeModal-module_rightSideColumn_6Y18K",YM="UpgradeModal-module_loader_S2BJU",qM="PaymentTotal-module_infoBody_w7ZDc",XM="PaymentTotal-module_totalCalc_2d2Yn",JM="PaymentTotal-module_infoSubheader_-8QdA",QM="PaymentTotal-module_select_u6pDB",ZM="PaymentTotal-module_selectContainer_ZYd14",eU="PaymentTotal-module_totalInfo_J6kRR",tU="PaymentTotal-module_totalFinal_nMFzO",aU="PaymentTotal-module_infoContainer_17-VO",oU="PaymentTotal-module_learnMore_C48VL",nU=e=>{var t,a;const{planTier:o,interval:n}=e,r=o.getPriceForInterval(n),s=r/(n===Es.Year?12:1);let l=`$${s} USD / month`;n===Es.Year&&(l=`$${r} USD / year ($${s} per month)`);const d=Math.max(null==(a=null==(t=e.team)?void 0:t.users)?void 0:a.length,1);d>e.numSeats&&e.setNumSeats(d);const c=((e,t)=>{const a=t-e+2,o=new Array(a);for(let n=1;n<a;n++)o[n]=e+n;return o})(d,200);let u=null;return d>1&&(u=i.createElement(i.Fragment,null,i.createElement("span",null,`Because your team currently has ${d} members, a minimum of ${d} seats is required to purchase this plan.`)," ",i.createElement("a",{href:"https://www.kapwing.com/help/subscription-faq/",target:"_blank",rel:"noopener noreferrer",className:oU},"Learn more"),".")),i.createElement("div",{className:aU},i.createElement("div",{className:qM},i.createElement("strong",null,o.name," Plan")," paid"," ",Ed({interval:n,capitalize:!1})," at"," ",l," per seat. ",u),i.createElement("div",{className:JM},"Number of seats:"),i.createElement("div",{className:ZM},i.createElement("select",{className:QM,value:e.numSeats,onChange:t=>{e.setNumSeats(parseInt(t.target.value))}},i.createElement("option",{value:d},Jd(d,"seat")),c.map((e=>i.createElement("option",{value:e,key:e},e," seats"))))),i.createElement("div",{className:JM},"Total Due Today:"),i.createElement("div",{className:eU},i.createElement("div",{className:XM},i.createElement("span",{translate:"no"},"$",r," × "),1===e.numSeats?`${e.numSeats} seat`:`${e.numSeats} seats`," ","="),i.createElement("div",{className:tU},(r*e.numSeats).toLocaleString("en-US",{style:"currency",currency:"USD"}))))},rU={termWrapper:"ChoosePaymentTerm-module_termWrapper_25JAG",termChooser:"ChoosePaymentTerm-module_termChooser_IbJky",paymentTerm:"ChoosePaymentTerm-module_paymentTerm_-YTs-",selected:"ChoosePaymentTerm-module_selected_gdyd8"},iU=e=>{const t=[Es.Month,Es.Year];return i.createElement("div",{className:rU.termWrapper},i.createElement("div",{className:rU.termChooser},t.map((t=>i.createElement("div",{key:t,className:[rU.paymentTerm,e.interval===t?rU.selected:null].join(" "),onClick:()=>e.setInterval(t)},"Pay ",Ed({interval:t}))))))},sU="ProPlanInfo-module_container_rvYA7",lU="ProPlanInfo-module_header_iZB8s",dU="ProPlanInfo-module_price_vhkqf",cU="ProPlanInfo-module_row_WGSeP",uU="ProPlanInfo-module_dollarSign_Q8ziD",mU="ProPlanInfo-module_priceNumber_OvEAK",pU="ProPlanInfo-module_priceContext_n82ly",hU="ProPlanInfo-module_priceSelected_hD9QM",gU="ProPlanInfo-module_cadence_d5H-F",yU="ProPlanInfo-module_infoContainer_YL-dN",fU="ProPlanInfo-module_imageContainer_W5sC5",EU="ProPlanInfo-module_image_8Z58S",vU="ProPlanInfo-module_info_TqcGT",wU="ProPlanInfo-module_infoHeader_uOsLB",bU="ProPlanInfo-module_infoDescription_W6R-U",_U="ProPlanInfo-module_infoReasons_vXMUl",TU="ProPlanInfo-module_reason_XAZLV",SU="ProPlanInfo-module_reasonIcon_QbenU",IU=({interval:e,setInterval:t})=>{const a=Gs(vs.Pro),{planData:o}=a,{modalReasons:n}=o;return i.createElement("div",{className:sU},i.createElement("div",{className:lU},i.createElement("div",{className:`${dU} ${e===Es.Year?hU:null}`,onClick:()=>t(Es.Year)},i.createElement("div",{className:gU},"Pay annually (and save 33%)"),i.createElement("div",{className:cU},i.createElement("div",{className:mU,translate:"no"},i.createElement("span",{className:uU},"$"),a.getBasePrice()[Es.Year]/12),i.createElement("div",{className:pU},"per member per month billed annually ($",a.getBasePrice()[Es.Year]," / year)"))),i.createElement("div",{className:`${dU} ${e===Es.Month?hU:null}`,onClick:()=>t(Es.Month)},i.createElement("div",{className:gU},"Pay monthly"),i.createElement("div",{className:cU},i.createElement("div",{className:mU,translate:"no"},i.createElement("span",{className:uU},"$"),a.getBasePrice()[Es.Month]),i.createElement("div",{className:pU},"per member per month billed monthly")))),i.createElement("div",{className:yU},i.createElement("div",{className:fU},i.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/PRd-kapwing-pro.webp",alt:"Pro Plan Preview",className:EU})),i.createElement("div",{className:vU},i.createElement("div",{className:wU},"Kapwing ",a.name),i.createElement("div",{className:bU},"Unlock the full power of Kapwing for your entire team"),i.createElement("div",{className:_U},n.map((e=>i.createElement("div",{className:TU,key:e},i.createElement("div",{className:SU},i.createElement(Te,null)),e))),i.createElement("div",{className:TU},"... and much more!")))))},xU={kapwingButton:"KapwingButton-module_kapwingButton_OIGXh",disabled:"KapwingButton-module_disabled_tv63Q",blueColor:"KapwingButton-module_blueColor_SAh6B",blackColor:"KapwingButton-module_blackColor_hR2Ff",fullWidth:"KapwingButton-module_fullWidth_6EJfa",noPadding:"KapwingButton-module_noPadding_5M3iq",smallButton:"KapwingButton-module_smallButton_vgohY",largeButton:"KapwingButton-module_largeButton_I1pYU",cyanColor:"KapwingButton-module_cyanColor_V5h4O",lightBlueColor:"KapwingButton-module_lightBlueColor_WIEgE",grayColor:"KapwingButton-module_grayColor_RxMpU",redColor:"KapwingButton-module_redColor_VKTCX",studioColor:"KapwingButton-module_studioColor_kwAFJ",darkStudioColor:"KapwingButton-module_darkStudioColor_Py5Rb",inverseColor:"KapwingButton-module_inverseColor_QxahF",loading:"KapwingButton-module_loading_nSP6k",spin:"KapwingButton-module_spin_EnC9K",buttonsContainer:"KapwingButton-module_buttonsContainer_08lgq",header:"KapwingButton-module_header_S9MxU",progressContainer:"KapwingButton-module_progressContainer_avoR3",progressBar:"KapwingButton-module_progressBar_ZlG2h",buttonContents:"KapwingButton-module_buttonContents_PRG0-"},kU=e=>{const t=[xU.kapwingButton,e.noPadding?xU.noPadding:e.small?xU.smallButton:xU.largeButton];return e.fullWidth&&t.push(xU.fullWidth),e.disabled&&t.push(xU.disabled),t.push(e.overrideColor?xU[`${e.overrideColor}Color`]:xU.blueColor),e.progress&&!isNaN(e.progress)&&e.progress>0?i.createElement("div",null,i.createElement("div",{className:xU.progressContainer},i.createElement("button",{type:"button",className:t.join(" "),onClick:e.onClick,"data-cy":e.testId},i.createElement("div",{className:xU.buttonContents},e.children),i.createElement("div",{className:xU.progressBar,style:{height:`${e.progress}%`}})))):i.createElement("button",{type:"button",disabled:e.disabled,onClick:e.onClick,className:t.join(" "),"data-cy":e.testId},e.children,e.loading&&i.createElement("div",{className:xU.loading}))},CU="ReasonsList-module_details_Vqg11",AU="ReasonsList-module_reasonsWrapper_-6BCA",NU="ReasonsList-module_detailCheck_YyPx6",PU="ReasonsList-module_everythingIn_penCH",RU="ReasonsList-module_reasonBox_QLW9g",LU=({planTier:e,andMuchMore:t})=>{const a=eM(),o=DU(e,a),n=o&&e.planData.chooseModalReasons||e.planData.modalReasons;return i.createElement("div",{className:CU},o&&i.createElement("div",{className:PU},"Everything in ",i.createElement("b",null,o.name),", plus:"),i.createElement("div",{className:1===(null==a?void 0:a.length)?AU:void 0},n.slice(0,a&&(null==a?void 0:a.length)>2?5:7).map(((a,o,n)=>i.createElement("div",{className:RU,key:o},i.createElement("div",null,i.createElement(Te,{className:NU})),i.createElement("div",null,a,e.planData.andMuchMore&&o===n.length-1&&(t?i.createElement("a",{target:"_blank",href:"/pricing"},", and much more"):", and much more")))))))},DU=(e,t)=>{if(!t||!t.length)return;const a=e.planData,o=[];for(const r of t)o.push(r.planTier);const n=o.concat([vs.Free]).filter((t=>t!==e.planTier)).map((e=>Ls[e])).filter((e=>a.everythingIn&&a.everythingIn.includes(e.planTier))).sort(((e,t)=>t.basePrice.month-e.basePrice.month))[0];return n?Gs(n.planTier):void 0},OU={planTier:"UpgradeModalColumn-module_planTier_6-Dj7",planHeaderWrapper:"UpgradeModalColumn-module_planHeaderWrapper_rKVUV",planHeader:"UpgradeModalColumn-module_planHeader_bWH-n",planName:"UpgradeModalColumn-module_planName_Kv5gr",planDescription:"UpgradeModalColumn-module_planDescription_2NnFx",planDivider:"UpgradeModalColumn-module_planDivider_8uMsr",subHeader:"UpgradeModalColumn-module_subHeader_fvIiT",priceSection:"UpgradeModalColumn-module_priceSection_dpszT",price:"UpgradeModalColumn-module_price_HPn8g",priceSchedule:"UpgradeModalColumn-module_priceSchedule_-HqME",buttonWrapper:"UpgradeModalColumn-module_buttonWrapper_F3FrZ",detailCheck:"UpgradeModalColumn-module_detailCheck_2bIrX",selected:"UpgradeModalColumn-module_selected_8rR--",recommendedPill:"UpgradeModalColumn-module_recommendedPill_enONM",recommendedPillUnselected:"UpgradeModalColumn-module_recommendedPillUnselected_uU6vB"},FU=e=>{const{tier:t,selectedTier:a,interval:o}=e;return i.createElement("div",{className:[OU.planTier,a.planTier===t.planTier?OU.selected:null].join(" "),onClick:()=>e.setSelectedTier(t)},e.recommended?(()=>{let e=OU.recommendedPill;return a!==t&&(e=OU.recommendedPillUnselected),i.createElement("div",{className:e},"Most Popular!")})():null,i.createElement("div",{className:OU.planHeaderWrapper},i.createElement("div",{className:OU.planHeader},i.createElement("div",null,i.createElement("div",{className:OU.planName},t.name),i.createElement("div",{className:OU.planDescription},t.planDescription)),i.createElement("div",{className:OU.priceSection},i.createElement("div",{className:OU.price},"$",t.getBasePrice()[o]/(o===Es.Year?12:1)),i.createElement("div",{className:OU.priceSchedule},"per member per month billed"," ",Ed({interval:o})))),i.createElement("div",null,i.createElement(LU,{planTier:t}))),i.createElement("div",{className:OU.buttonWrapper},i.createElement("div",null,i.createElement(kU,{overrideColor:a.planTier!==t.planTier?"black":void 0,onClick:()=>e.setSelectedTier(t)},a.planTier===t.planTier&&i.createElement(Te,{className:OU.detailCheck}),a.planTier===t.planTier?`Selected  ${t.name}`:`Choose ${t.name}`))))},MU=e=>{const t=new URLSearchParams(e).get("upgrade");if(!t)return;const a=JSON.parse(decodeURIComponent(t)),{t:o,a:n,e:r,c:i,n:s,ii:l}=a;return{teamId:o,action:n,extraAmplitudeEventProperties:r,closeable:i,numSeatsInit:s,intervalInit:l}},UU=(e,t)=>{const{teamId:a,action:o,extraAmplitudeEventProperties:n,if:r,closeable:i,numSeatsInit:s,intervalInit:l}=e,d={t:a,a:o,e:n,i:r,c:i,n:s,ii:l},c=new URLSearchParams(t),u=encodeURIComponent(JSON.stringify(d));return c.set("upgrade",u),c.toString()},BU=e=>{const t=new URLSearchParams(e);return t.delete("upgrade"),t.toString()},WU=e=>{var t,a;const o=".app-container",n=document.querySelector(o),s=sc(tr((e=>e.currentUser))),l=oe(),d=sd(),c=m.exports.useDispatch(),[u,p]=r.exports.useState(!1);if(d.hasPermission(Ws(e.action||Rs.DEFAULT)))return null==(t=e.onClose)||t.call(e),c(Su({description:"Thanks for signing in. Kapwing Pro features are already available in your current team workspace.",type:"success"})),null;const h={action:e.action,onClose:e.onClose,onSuccess:e.onSuccess,closeable:e.closeable,extraAmplitudeEventProperties:e.extraAmplitudeEventProperties,numSeatsInit:e.numSeatsInit,intervalInit:e.intervalInit};return s?n?he.createPortal(i.createElement(VU,{...h}),n):(console.error(`Expected ${o} to exist in the DOM`),i.createElement(VU,{...h})):(u&&(null==(a=h.onClose)||a.call(h)),i.createElement(ZF,{customTitle:"Sign in to upgrade to Pro",hideSignIn:()=>p(!0),immediateRedirectPathname:`${l.pathname}${l.search}`}))},VU=({onClose:e=(()=>sT()),closeable:t=!0,action:a=Rs.UNKNOWN,extraAmplitudeEventProperties:o={},numSeatsInit:n=1,intervalInit:s=Es.Year})=>{var l;const d=m.exports.useDispatch(),c=id(),[u,p]=r.exports.useState(Math.max(n,(null==(l=null==c?void 0:c.users)?void 0:l.length)||1)),[h,g]=r.exports.useState(s),{currentUser:y}=tr((e=>({currentUser:e.currentUser})),m.exports.shallowEqual),f=oe(),[E,v]=r.exports.useState(!1),w=eM(),b=Gs(vs.Pro),[_,T]=r.exports.useState(b),S=(f.pathname.includes("/studio/editor")||f.pathname.includes("/videos/"))&&!(()=>{const{state:e}=tn();return!e.studio.teamId||e.teams.allTeams.some((t=>t._id===e.studio.teamId))})(),I=sc(y);r.exports.useEffect((function(){I&&d(jE())}),[d,I]);const x=(e=>{let t="to access all Pro features on Kapwing";if(e){const{permission:a,metadata:o}=Bs[e];if(null==o?void 0:o.upgradeReason)t=o.upgradeReason;else if(a){const e=Us[a].upgradeReason;e&&(t=e)}}return t})(a);r.exports.useEffect((()=>{!function(e,t={}){const{chosenPlan:a,dripDiscount:o,extraProperties:n={}}=t,{state:r}=tn(),{currentUser:i}=r,s=kc(e),l=nd(),d=ld(),c=sc(i),u={"Upgrade Source":s,"Signed In":c,"Current Plan":c?d.name:void 0,"Team ID":l?l._id:"","Number of Workspace Members":l?l.users.length:1};a&&(a===vs.Pro&&(u["Chosen Plan"]="Pro"),a===vs.Basic&&(u["Chosen Plan"]="Basic")),o&&(u["Discount Value"]=o),vc("Visit Checkout",{...u,...n})}(a||Rs.UNKNOWN)}),[a]);const k=async()=>{v(!0);const e=f.pathname,t=new URL(window.location.href),n=MU(f.search);n&&(n.numSeatsInit=u,n.intervalInit=h,t.search=UU(n,f.search));const r={originUrl:t.href,onSuccessPath:e,planTier:_.planTier,interval:h,numSeats:u,metadata:{name:c.name,teamId:c._id,seats:u,paywallModalAction:a,extraAmplitudeEventProperties:JSON.stringify(o)}};try{const e=await gu("/api/v1/stripe/createCheckoutSession",{body:r}),{checkoutUrl:t}=e;window.location.href=t}catch(i){v(!1),Iu({description:"An error occurred while redirecting to checkout. Please try again later.",error:i})}};return S?i.createElement(NM,{keepScrollbar:!0,onClose:e},i.createElement("div",{className:tM},"You don't have access to manage this workspace subscription"),i.createElement("div",{className:IM},"Contact the project owner to add you to this workspace."),i.createElement("div",{className:xM},i.createElement("div",{onClick:e,className:kM},"Got It"))):i.createElement(_O,{afterElement:!t&&i.createElement("div",{className:WM},i.createElement("a",{href:"/"},"No thanks, return to Kapwing home")),className:DM,backgroundStyle:{zIndex:1e3},style:{zIndex:1001},id:"paywall-id",onClick:e=>e.stopPropagation(),noCloseButton:!1===t,unsetCancelModal:()=>{t&&!E&&e()},cypressName:"paywall-modal",noPadding:!0},i.createElement("div",{"data-testid":"studio-paywall-modal","data-cy":"studio-paywall-modal",className:FM},i.createElement("h3",{className:OM,"data-cy":"paywall-title"},"Upgrade ",(null==c?void 0:c.name)?i.createElement("strong",null,c.name):i.createElement("span",null," ")," ",x),i.createElement("div",{className:MM},i.createElement("div",{className:BM},w.length<=1?i.createElement(IU,{interval:h,setInterval:g}):i.createElement(i.Fragment,null,i.createElement(iU,{interval:h,setInterval:g}),i.createElement("div",{className:VM},w.map((e=>{let t=!1;return e.planTier===vs.Pro&&(t=!0),i.createElement("div",{key:e.planTier,className:jM},i.createElement(FU,{tier:e,selectedTier:_,setSelectedTier:T,interval:h,recommended:t}))}))))),i.createElement("div",{className:UM},i.createElement("div",null,i.createElement("div",{className:KM},i.createElement(nU,{interval:h,planTier:_,numSeats:u,setNumSeats:p,team:c}),E?i.createElement("div",{className:GM},i.createElement("span",null,"Loading checkout... "),i.createElement("div",{className:YM})):i.createElement("div",{className:GM,onClick:k},i.createElement("span",null,"Continue to checkout"),i.createElement(Se,{className:HM})),i.createElement(LM,{email:"",planTier:_}))))),i.createElement("div",{className:zM},i.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/BM--hcm094oK-image.webp",className:$M,alt:"Upgrade Plan Preview"}))))},jU=()=>{const e=Ie(),t=MU(e.location.search),{if:a,...o}={...t};if(!t)return null;const n={...o,onClose:()=>{e.replace({search:BU(e.location.search)})}};return i.createElement(WU,{...n})},GU=(e,t,a,o)=>(...n)=>{const{if:r=!0,...i}=e,{teamId:s,action:l=Rs.DEFAULT}=i,d=s&&rd(s)||o;if(!d)throw Error("No team found");const c=Gs(d.planTier),u=Ws(l),m=c.hasPermission(u);if(!r||m)a(...n);else{const a=UU(e,t.location.search);t.replace({search:a})}},HU=()=>{const e=Ie(),t=id();return(a,o)=>GU(o,e,a,t)},zU=(e,t)=>{const{history:a}=tn(),o=nd();if(!o)throw new Error("Paywall used without a team");return GU(t,a,e,o)},$U="MoreDropdown-module_DropdownMenuContent_MdLQW",KU="MoreDropdown-module_DropdownMenuItem_53tXR",YU="MoreDropdown-module_DropdownMenuArrow_lbY2e",qU="MoreDropdown-module_IconButton_cws-h",XU="MoreDropdown-module_DropdownMenuSeparator_cyNtN",JU=({content:e,options:t})=>i.createElement(xe,null,i.createElement(ke,{asChild:!0},i.createElement("button",{className:qU,"aria-label":"options",type:"button"},e)),i.createElement(Ce,null,i.createElement(Ae,{className:$U,sideOffset:5},t.map(((e,a)=>i.createElement(i.Fragment,{key:a},i.createElement(Ne,{className:KU},e),a!==t.length-1&&i.createElement(Pe,{className:XU})))),i.createElement(Re,{className:YU})))),QU="MoreOptions-module_optionTextStyle_LwmMb",ZU=({preset:e,isBrandkit:t,isSelected:a})=>{const o=m.exports.useDispatch(),n=XD(Ps.SUBTITLE_PRESETS),r=HU();let s=!t||n;"custom"===e.presetId&&(s=!a);const l=[];return l.push(i.createElement("div",{className:QU,onClick:()=>{const a=()=>{t?LD(e.presetId):PD(e)};if(n)a();else{r(a,{action:Rs.SUBTITLE_PRESETS})()}}},i.createElement("span",{style:{marginRight:4}},t?"Remove from Brand Kit":"Add to Brand Kit"),!n&&i.createElement(Pn,null))),s&&l.push(i.createElement("div",{className:QU,onClick:async()=>{if("custom"===e.presetId)return void WD();const i=async()=>{o(jm({presetId:e.presetId,undoable:!t})),a&&(e=>{const{dispatch:t}=tn();t(Ax({updates:{preset:null},undoable:e}))})(!t),t&&await LD(e.presetId)};if(n||!t)await i();else{r(i,{action:Rs.SUBTITLE_PRESETS})()}}},"Remove style")),i.createElement(JU,{content:i.createElement(Le,{color:"white",size:14}),options:l})},eB=i.forwardRef(((e,t)=>{const{children:a,column:o,controlButtonRowStyle:n,customDataCy:r,fullWidthButtons:s,growButtons:l,iconAndControl:d,noWrap:c,noPadding:u,scrollable:m,style:p,timelineButtons:h,title:g,titleInvisible:y,twoButtonsPerRow:f,desktopNoWrap:E,mobileNoWrap:v,helpSlug:w,showHelpOverlay:b,description:_,hasSparkle:T,className:S}=e;let I,x=Rn.controlSectionRows;return o&&m?x=Rn.controlSectionScrollableColumn:o&&(x=Rn.controlSectionWrapColumns),s?x=Rn.controlSectionRowsFullWidth:f?x=Rn.controlSectionRowsTwoPerRow:h?x=Rn.controlSectionRowsTimeline:d?x=Rn.controlSectionRowsIconAndControl:c?x=Rn.controlSectionRowsNoWrap:u?x=Rn.controlSectionRowsNoPadding:l&&(x=Rn.controlSectionRowsExpandChildren),E&&(x+=` ${Rn.desktopNoWrap}`),v&&(x+=` ${Rn.mobileNoWrap}`),S&&(x+=` ${S}`),I=r||(g?`${g.replace(/ /g,"-").replace(/:/g,"")}-control`:"control"),i.createElement("div",{id:`${I}-section`,"data-cy":`${I}-section`,className:Rn.controlSectionContainer,ref:t},g&&!y&&i.createElement(Fn,{noPadding:u,style:p},i.createElement("div",null,g," ",T&&i.createElement(Pn,null)," "),w&&i.createElement(De,{style:{width:17,height:17,cursor:"pointer"},onClick:()=>{iT(`/studio/editor/${w}`)}}),b&&i.createElement(De,{style:{width:17,height:17,cursor:"pointer",marginLeft:10,marginBottom:2},onClick:b})),_&&i.createElement("div",{className:Rn.controlSectionDescription},_),i.createElement("div",{"data-cy":`${I}-buttons`,className:x,style:n},a))})),tB=.2,aB=e=>{var t,a;const{selectedLayers:o}=e,n=tr((e=>e.studioLocal.layerTempValues)),r=o[0];if(!r)return null;const s=0===o.length?.2:r.textBlur;let l=null==(t=n[r.id])?void 0:t.textBlurTemp;for(let i=1;i<o.length;i+=1){const e=o[i];if(!e)continue;const t=null==(a=n[e.id])?void 0:a.textBlurTemp;if(!t||l!==t){l=void 0;break}}const d=l||s||.2,c=Jl.withUndoBatch(((e,t)=>{const a={},n={};o.forEach((o=>{t?(n[o.id]={textBlurTemp:null},a[o.id]={textBlur:e}):n[o.id]={textBlurTemp:e}})),YT(n),px(a,!0)}));return i.createElement("div",null,i.createElement(eB,{title:"Blur"},i.createElement(Kn,{min:0,max:1,defaultValue:d,step:.01,onSliderChange:c})))},oB=(e,t)=>tn().dispatch(Yu({font:e,status:t})),nB=e=>tn().state.loadedFonts[e],rB=new Map;function iB({name:e,onError:t,onSuccess:a,url:o}){const n=`${e}_${o}`;let r=rB.get(n);r||(r=new Promise(((t,a)=>{const n=new window.FontFace(e,`url(${o})`);document.fonts.add(n),n.load().then((()=>{oB(e,"success"),t()})).catch((t=>{oB(e,"failed"),console.error(t),a(t)}))})),rB.set(n,r)),r.then((()=>a({firstLoad:!0}))).catch((e=>t(String(e))))}const sB=[300,400,700,800].map((e=>`${e},${e}i`)).join(",");const lB=(e,t=!0,a=(()=>{}),o=(()=>{}))=>{"undefined"!=typeof document?"default"===e.type?dB(e,t,a,o):(cB(hB(e)),cB(e,a,o)):a({firstLoad:!1})},dB=(e,t,a=(()=>{}),o=(()=>{}))=>{const{fontFamily:n}=e,r=nB(n);if(r)"success"===r?a({firstLoad:!1}):o("Font load already failed");else if(ju.has(n))a({firstLoad:!1});else{if(zu.has(n)||Oe.has(n))return window.WebFont?void function({name:e,onError:t,onSuccess:a,withWeights:o}){if(!window.WebFont)return void t("WebFont API not supported");const n=o?`${e}:${sB}`:e,r=n;let i=rB.get(r);i||(i=new Promise(((t,a)=>{let o=!1;window.WebFont.load({google:{families:[n]},fontactive:()=>{o||(oB(e,"success"),o=!0),t()},fontinactive:()=>{o||(oB(e,"failed"),o=!0),a(new Error("WebFont loader failed"))}})})),rB.set(r,i)),i.then((()=>a({firstLoad:!0}))).catch((e=>t(String(e))))}({name:n,onError:o,onSuccess:a,withWeights:t}):void o("WebFont API not supported");if(n in Gu){iB({name:n,onError:o,onSuccess:a,url:`https://cdn-useast1.kapwing.com/defaultFonts/${Gu[n]}`})}else oB(n,"failed"),o(`Don't know where to load default font ${n} from`)}},cB=(e,t=(()=>{}),a=(()=>{}))=>{const{fontFamily:o}=e,n=nB(o);n?"success"===n?t({firstLoad:!1}):a("Font load already failed"):iB({name:o,onError:a,onSuccess:t,url:e.url})},uB=(e=[])=>{for(const t of e)lB(t,!0)},mB=e=>new Promise(((t,a)=>lB(e,!0,t,a))),pB=async e=>{try{return await bi(8e3,new Promise(((t,a)=>{iB({name:e.fontFamily,onError:a,onSuccess:t,url:e.url})}))),!0}catch(t){console.error(t)}return!1},hB=e=>({...e,fontFamily:`asset_${e.asset_id}`});function gB(e){if(e.hasCustomFont&&(!e.asset_id||!e.url)){const t=function(e){const{fontFamily:t}=e,{state:a}=tn(),{selectedWorkspace:o,allWorkspaces:n}=a.workspaces,{activeBrandkit:r}=a.teams,i=[];for(const d of n)o!==d._id&&i.splice(0,0,d),i.push(d);let s;function l(e){if(s)return;const a=null==e?void 0:e.find((e=>e.fontFamily===t?e:null));a&&(s={type:"custom",fontFamily:a.fontFamily,url:a.url,asset_id:a.asset_id})}if(r){const e=[];r.fonts.forEach((t=>{"custom"===t.type&&e.push(t)})),l(e)}for(const d of i){if(s)break;l(d.customFonts)}return s&&px({[e.id]:{asset_id:s.asset_id,url:s.url,preemptiveDownloadError:!1}},!1),s}(e);if(t)return t}return Nx(e)}const yB=()=>{const{dispatch:e,state:{studio:{analytics:t}}}=tn();t.usedTimeline||e(Df({usedTimeline:!0}))},fB=(e,t)=>{const{start:a,end:o}=t;EB(e,{duration:o-a,startTime:a})},EB=(e,t)=>{const a=GI(e,t);a&&px({[e.id]:a},!0)},vB=(e,t)=>{const{start:a,end:o}=t;return wB(e,{duration:o-a,startTime:a})},wB=(e,t)=>{const a=GI(e,t);if(a)return a},bB=200,_B=244,TB=(e,t)=>{if(!e&&!t)return{scaledWidth:244,scaledHeight:200};let a,o;return t>=e?(o=200,a=o/t*e):(a=244,o=a/e*t),{scaledWidth:a,scaledHeight:o}},SB=(e,t=!1)=>{const{state:a}=tn(),{scenes:o,allLayers:n}=a.studio,r=o[0];if(!r)return;const i=ST();if(Fl(a))return;if(n.byId[e.id]&&!t)return;const{duration:s}=r;if(i>s||!s)return;const{type:l,isTrimmed:d,startTime:c=0,endTime:u=0}=e;switch(l){case"video":case"audio":e.videoDelay=i;break;case"image":case"shape":case"text":case"placeholder":{const o=Wl(a),n=Math.max(o?128/o:3,2);e.isTrimmed=!0,e.startTime=i,e.endTime=i+n,t&&(d?e.endTime=i+u-c:i===s&&(e.endTime=2*s));break}}},IB=e=>{const{state:{studio:t}}=tn(),a=Jw(e,t);return(null==a?void 0:a.type)?a:null},xB=()=>{const{state:{studio:e}}=tn(),{byId:t}=e.allLayers;return Object.values(t)},kB=(e,t)=>{const a=zS(e,0);return t>=a[0]&&t<=a[1]},CB=e=>{const{state:{studio:t}}=tn(),a=t.scenes[0];if(!a)return[];let o=a.layers;return a.duration>0&&(o=o.filter((t=>kB(t,e)))),o},AB=e=>{const t=e.findIndex((e=>"subtitle"===e.type));return t>=0?e.slice(t):[]},NB=(e,t)=>{const a=vd(e)||_d(e),o=vd(t)||_d(t),n=a&&o,r=e.type===t.type;return n||r};function PB(e){if(e.type===ln.Subtitle)return-1;const{start:t}=Rd(e),a=new Set;for(const o of function*(e){const{state:t}=tn(),{selectedTimelineRows:a,scenes:o}=t.studio,n=o[0];if(!n)return;const{layers:r}=n;for(const d of a)yield d;const i=new Set,s=new Set;for(const d of r){if(d.type===ln.Subtitle)break;null!=d.timelineRow&&d.timelineRow>=0&&!isNaN(d.timelineRow)&&(NB(d,e)&&i.add(d.timelineRow),s.add(d.timelineRow))}for(const d of[...i].sort())yield d;const l=[...s].sort();if(s.size>0){l.length===l[l.length-1]+1&&(yield l.length);for(let e=0;e<l.length;e+=1)l[e]!==e&&(yield e>0?l[e-1]+1:0)}yield l.length}(e))if(!a.has(o)){if(UB(e,t,o))return o;a.add(o)}console.error("couldn't determine timeline row, this should never happen")}function RB(e,{undoable:t=!1,layerIndex:a,isReplacing:o=!1,isUndo:n=!1,knownTimelineRow:r=!1,newTimeline:i=!1}={}){var s;t&&Jl.beginBatch();try{const{dispatch:l,state:d}=tn(),{projectId:c,duration:u,hasCustomOutput:p,showCanvas:h}=d.studio,g=d.studio.scenes[0];if(!g)return;const{isAdding:y}=d.studioLocal,{projectName:f}=d,E=vd(e)||_d(e);(E?void 0===e.videoDelay:!e.startTime&&0!==e.startTime)&&SB(e);if(["video","audio","image"].includes(e.type)&&(["pastedLink","local"].includes(null!=(s=e.source)?s:"")||!e.local_url||!e.metadataGathered||HB(e))){if(!h&&"width"in e&&e.width&&!o){let t=`${e.width}:${e.height}`;"resize"===e.uploadLocation&&(t="400:400"),e.isMediaLibraryUpload||m.exports.batch((()=>{l(B_(t)),l({type:"SHOW_STUDIO_CANVAS"})}))}i&&BB(e),"resize"===e.uploadLocation&&(e.lockAspectRatio=!0),(o&&!e.position||!o)&&(e.position=uS(e)),e.position&&!e.position.rotation&&(e.position.rotation=0),e.metadataGathered=!0,p&&jB(e);const{currentUser:t}=d;c&&e.name&&0===g.layers.length&&(""===f||"Studio Draft"===f)&&(l(JP(NF(e.name))),_v(c,{name:e.name},t))}0===u&&!vd(e)&&!_d(e)||r&&null!=e.timelineRow||(e.timelineRow=PB(e)),l(bh({layers:[e],isUndoable:t,layerIndex:a,fromUndo:n})),e.asset_id&&y[e.asset_id]&&l(Og(e.asset_id));const{scenes:v,videoType:w,videoTypeSetting:b}=tn().state.studio,_=v[0];if(!_)return;const{duration:T}=VA(_);_.layers.some((e=>!BS(e)&&!DB(e)))||!(e.mime&&(e.mime.includes("gif")||e.mime.includes("webp"))||e.url&&("gif"===Hd(e.url)||"webp"===Hd(e.url)))||b||l(sw(Ei.GIF)),"gif"!==w||BS(e)||b||e.conversion_type&&e.conversion_type.includes("gif")||l(sw(Ei.MP4)),BA(_,T,t)}catch(YEe){console.error(YEe)}finally{t&&Jl.endBatch()}}const LB=(e,t,{knownTimelineRow:a,newTimeline:o,sceneId:n,undoable:r})=>{((e=!1)=>{vc("Replace Layer",{"Replaced Placeholder":e})})(t.type===ln.Placeholder);try{r&&Jl.beginBatch();const{state:{studio:i},dispatch:s}=tn(),l=i.scenes[0];if(!l)return;const{layers:d}=l,c=d.findIndex((e=>e.id===t.id)),{groups:u}=i,m=Object.entries(u).filter((e=>e[1].layers.some((e=>e.id===t.id))))[0];if(m){const a=m[0];s(Fh(e.id,a,!0,r)),s(Uh(t.id,a,r)),s(Vh(a,!0,r))}zB({layerIds:[t.id]}),RB(e,{sceneId:n,undoable:r,knownTimelineRow:a,layerIndex:c>=0?c:void 0,isReplacing:!0,newTimeline:o})}catch(YEe){console.error(YEe)}finally{r&&Jl.endBatch()}},DB=e=>e.conversion_type&&e.conversion_type.includes("gif-to"),OB=c((e=>{var t,a;return null==(a=null==(t=e.studio.scenes)?void 0:t[0])?void 0:a.layers}),((e=[])=>e.filter((e=>!(e.requireConversion&&!e.preview&&null==e.duration))))),MB=c(OB,((e,t)=>t),((e,t)=>{const a=[];for(const o of e)o.timelineRow===t&&a.push(o);return a}));function UB(e,t,a){const{state:o}=tn();if(-1===a&&e.type!==ln.Subtitle||a>-1&&e.type===ln.Subtitle)return!1;const n=MB(o,a),[r,i]=zS(e,0),s=t+(i-r);for(const l of n){const[e,a]=zS(l,0);if(!(a<=t)&&!(e>=s))return!1}return!0}const BB=e=>{const{state:t}=tn(),{width:a,height:o}=WB(e.width,e.height),{x:n,y:r}=tA(t.studio.width,t.studio.height,t.studio.canvasX,t.studio.canvasY,a,o);VB(e,{x:n,y:r,width:a,height:o,rotation:0,flip:{x:!1,y:!1}})},WB=(e,t)=>{const{state:a}=tn(),o=[e,t],{width:n,height:r}=eA(o,{width:a.studio.width,height:a.studio.height});return{width:n,height:r}},VB=(e,t,a=!1)=>{const{dispatch:o}=tn(),n=lS(t.x,t.y),r=nS(t.width,t.height);KT(e.id,{positionTemp:null}),o(Th(e,n.xPercent,n.yPercent,r.widthPercent,r.heightPercent,a)),o(xh(e,t.rotation,a))},jB=e=>{const{state:t}=tn(),{customOutputWidth:a}=t.studio,{customOutputHeight:o}=t.studio;(a>1920||o>1920)&&("video"===e.type||e.mime&&"gif"===e.mime.split("/")[1])&&wA()},GB=Jl.withUndoBatch(((e,t,a)=>{const{dispatch:o,state:n}=tn(),{ratio:r}=n.studio,{ratioWidth:i,ratioHeight:s}=iA(r),{scenes:l,width:d,height:c}=n.studio,u=l[0];if(!u)return;const m={w:qT(100*i/s),h:qT(100*s/i)},p={x:qT((d-c)/2/c*-100),y:qT((c-d)/2/d*-100)},h=1===u.layers.length;a.forEach((a=>{var n,r,l,d;const c={x:qT(null==(n=a.position)?void 0:n.x),y:qT(null==(r=a.position)?void 0:r.y),width:qT(null==(l=a.position)?void 0:l.width),height:qT(null==(d=a.position)?void 0:d.height),x90:qT(p.x),y90:qT(p.y),width90:qT(m.w),height90:qT(m.h)};h&&a.position.rotation%90==0&&(100===Math.round(c.width)&&100===Math.round(c.height)&&0===Math.round(c.x)&&0===Math.round(c.y)||c.width===c.height90&&c.height===c.width90&&c.x===c.y90&&c.y===c.x90)&&e%90==0&&(RA(s,i),wA(),90!==e&&270!==e||(KT(a.id,{positionTemp:null}),o(Th(a,`${c.x90}%`,`${c.y90}%`,`${c.width90}%`,`${c.height90}%`))),0!==e&&180!==e||(KT(a.id,{positionTemp:null}),o(Th(a,"0%","0%","100%","100%")))),o(xh(a,e,t))}))})),HB=e=>{const{state:t}=tn(),a=Jw(e.id,t.studio);return null==a||!a.position||Object.keys(a.position).some((e=>{const t=e,o=a.position[t];return"string"==typeof o&&o.includes("NaN")}))},zB=Jl.withUndoBatch((({layerIds:e,groupId:t,undoable:a=!0,logEvent:o=!1})=>{const{dispatch:n,state:r}=tn(),{byId:i}=r.studio.allLayers,s=[],l=[],d=[];let c=!1;e.forEach((e=>{const t=i[e];t&&(s.push(...(e=>{var t,a,o;return[...(null==(t=e.animation)?void 0:t.intro)||[],...(null==(a=e.animation)?void 0:a.outro)||[],...(null==(o=e.animation)?void 0:o.constant)||[]]})(t)),l.push(t),YI(e)&&d.push(e),!c&&(e=>{var t;return(null==(t=e.mime)?void 0:t.includes("gif"))||e.url&&"gif"===Hd(e.url)})(t)&&(c=!0))})),m.exports.batch((()=>{c||n(sw(Ei.MP4)),s.length&&n(function(e,t){return{type:"BULK_DELETE_ANIMATIONS",animationIds:e,undoable:t}}(s,a)),d.length&&n(((e,t=!0)=>({type:"DELETE_MULTIPLE_LAYERS_KEYFRAMES",undoable:t,layerIds:e}))(d,a)),n(function(e,t,a){return{type:"REMOVE_LAYERS",layers:e,source:t,undoable:a}}(l,"studioDeleteLayersById",a)),t&&n(Wh(t,a)),n(Kh(null,a))}))})),$B=e=>{const{dispatch:t}=tn();t(Og(e))},KB=Jl.withUndoBatch((e=>{const{dispatch:t}=tn();e.forEach((e=>t(kh(e,"x",!0))))})),YB=Jl.withUndoBatch((e=>{const{dispatch:t}=tn();e.forEach((e=>t(kh(e,"y",!0))))})),qB=Jl.withUndoBatch(((e,t,a)=>{const o={},n={};e.forEach((e=>{const r={relative:`${t}%`};a?(n[e.id]={borderRadiusTemp:null},o[e.id]={borderRadius:r}):n[e.id]={borderRadiusTemp:r}})),m.exports.batch((()=>{px(o,!0),YT(n)}))})),XB=Jl.withUndoBatch(((e,t,a)=>{const o={},n={};e.forEach((e=>{a?(n[e.id]={textPaddingTemp:null},o[e.id]={textPadding:t}):n[e.id]={textPaddingTemp:t}})),m.exports.batch((()=>{px(o,!0),YT(n)}))})),JB=(e,t,a=0,o=0)=>{const{relative:n=0}=e||t.borderRadius||{};return a<o?parseFloat(n)/100*a:parseFloat(n)/100*o},QB=e=>{const{dispatch:t}=tn(),a=IB(e);px({[a.id]:{locked:!a.locked}},!0),a.locked||t(Kh(null))},ZB=(e,t)=>{var a;const{dispatch:o,state:n}=tn(),r=[];Object.keys(null==(a=n.studio.allLayers)?void 0:a.byId).forEach((t=>{var a;const o=null==(a=n.studio.allLayers)?void 0:a.byId[t];o&&o.type!==ln.Subtitle&&Lr(o)===e&&r.push(o.id)}));const{localUrl:i,trackPreviewLocalUrl:s}=t;if(s){const e={};r.forEach((t=>{e[t]={trackPreviewLocalUrl:s}})),YT(e)}const l={};r.forEach((e=>{l[e]={local_url:i}})),o({type:"UPDATE_LAYERS_NO_SYNC",updates:l})},{Video:eW,Audio:tW,Text:aW,Image:oW,Shape:nW,Placeholder:rW,Subtitle:iW}=ln,{Drag:sW,TrimStart:lW,TrimEnd:dW}=pI,cW=(e,t)=>e.startTime===t.startTime&&e.duration===t.duration&&e.timelineRow===t.timelineRow,uW=(e,t)=>e.newTimelineRow-t.newTimelineRow?e.newTimelineRow-t.newTimelineRow:e.position.left-t.position.left,mW=(e,t)=>{const{state:a}=tn(),o=a.studio.scenes[0].duration,n=EI(e,t);return n.sort(((e,t)=>{const{start:a}=Rd(e,o),{start:n}=Rd(t,o);return a<n?-1:a>n?1:0})),n},pW=(e,t,a)=>{if(!t)return!1;const{start:o,end:n}=Rd(e,a),{start:r,end:i}=Rd(t,a);return n-o>=.5&&i-r>=.5},hW=()=>{m.exports.batch(Jl.withUndoBatch((()=>{const{dispatch:e,state:t}=tn(),{studio:a}=t,{selectedItem:o,groups:n,studioPaused:r}=a,{duration:i}=a.scenes[0],s=ST();if(!o)return;let l=[];if("group"===o.type){const e=n[o.id];e&&(l=e.layers.map((({id:e})=>e)))}else"layer"===o.type&&(l=[o.id]);const d=OB(t),c=l.map((e=>d.find((({id:t})=>t===e)))).sort(((e,t)=>{const{start:a}=Rd(e,i),{start:o}=Rd(t,i);return a-o})),u=c.reduce(((e,t)=>{var a;return t&&void 0!==(null==t?void 0:t.timelineRow)?(e[t.timelineRow]||(e[t.timelineRow]=[]),null==(a=e[t.timelineRow])||a.push(t),e):e}),{});if(Object.values(u).forEach((e=>{let t=0;const a={};e.forEach((e=>{if(e&&void 0!==e.timelineRow){const{start:o,end:n}=Rd(e,i),r=n-o,s=EW(o-t,1/0,e.timelineRow,-r-t);Object.assign(a,s),t+=r}})),px(a,!0),zB({layerIds:e.map((({id:e})=>e)),undoable:!0,logEvent:!0}),NN(),Object.keys(a).length>0&&yB()})),r&&c.find((e=>e))){const e=c.find((e=>e)),{start:t}=Rd(e);s>t&&YA(t)}e(Df({usedRippleDelete:!0}))})))},gW=e=>{const{state:t}=tn(),{studio:a}=t,{duration:o}=a.scenes[0],n=OB(t);if(!e||void 0===e.timelineRow)return 1/0;const{end:r}=Rd(e,o),i=mW(n,e);for(const s of i){const{start:e}=Rd(s,o);if(e+1e-4>=r)return e}return 1/0},yW=Jl.withUndoBatch((()=>{const{dispatch:e,state:t}=tn(),{studio:a}=t,{selectedItem:o,timelineGap:n,studioPaused:r}=a;if(!n||n.gapId!==(null==o?void 0:o.id))return;const i=EW(n.startTime,1/0,n.timelineRow,-n.duration);px(i,!0),e(Kh(null)),r&&YA(n.startTime)})),fW=Jl.withUndoBatch((function(e,t){const a=s.exports.cloneDeep(e);a.sort(((e,t)=>Rd(e,0).start-Rd(t,0).start));const o=new Set(t.keys());let n=0;const r={};a.forEach((e=>{const{start:a,end:i}=Rd(e),s=t.get(e.id),l=(null==s?void 0:s.shift)||0;r[e.id]=SW(e,{start:a+n,end:i+n+l}),o.has(e.id)&&(n+=l)})),px(r,!0),NN()})),EW=Jl.withUndoBatch((function(e,t,a,o){const{state:n}=tn(),{duration:r}=n.studio.scenes[0],{byId:i}=n.studio.allLayers,s=OB(n),l={};for(const d of s){if(d.timelineRow!==a||!i[d.id])continue;const{start:n,end:c}=Rd(d,r);let u=n;const{introTransition:m}=T_(d);if(m){const e=s.find((({id:e})=>e===m.outroLayerId));e&&(u=Rd(e,r).end)}if(e-u>1e-4||u>t)continue;const p=n+o,h=c+o;l[d.id]=SW(d,{start:p,end:h})}return l})),vW=(e,t)=>{var a;const{state:o}=tn(),{byId:n}=o.studio.allLayers,r=OB(o),i=vI(r),s=new Map,{groups:l}=o.studio;if(Object.entries(l).forEach((([e,t])=>{t.layers.forEach((t=>{s.set(t.id,e)}))})),0===e.size)return;const d=[...e.values()].reduce(((e,t)=>e<t?e:t)),c=[...e.keys()];let u=0;for(;u<c.length;){const o=c[u],m=i.get(o),p=null!=(a=e.get(o))?a:d;null==m||m.forEach((e=>{var a;if(t.includes(e.id))return;const{start:o}=Rd(e);let i=o;const{introTransition:d}=T_(e);if(d){const e=r.find((({id:e})=>e===d.outroLayerId));e&&(i=Rd(e).end)}if(p-i>1e-4)return;const u=s.get(e.id);if(u){((null==(a=l[u])?void 0:a.layers)||[]).forEach((e=>{const t=n[e.id],a=null==t?void 0:t.timelineRow;void 0===a||c.includes(a)||c.push(a)}))}})),u+=1}return{rowsToShift:c,smallestMinLeftTime:d}},wW=Jl.withUndoBatch(((e,t)=>{const{state:a}=tn(),{selectedItem:o,groups:n}=a.studio,r=[];if("layer"===(null==o?void 0:o.type))r.push(null==o?void 0:o.id);else if("group"===(null==o?void 0:o.type)){const e=n[o.id];null==e||e.layers.forEach((e=>r.push(e.id)))}const i=vW(e,r);if(void 0===i)return;const{rowsToShift:s,smallestMinLeftTime:l}=i,d={};s.forEach((a=>{var o;const n=null!=(o=e.get(a))?o:l,r=EW(n,1/0,a,t);Object.assign(d,r)})),m.exports.batch((()=>{px(d,!0),NN(),Object.keys(d).length>0&&yB()}))})),bW=e=>e.some((e=>e.type===ln.Subtitle)),_W=({track:e,newTime:t})=>{const{state:a}=tn(),{start:o,end:n}=t,r=a.studio.allLayers.byId[e.id];if(!r)return{};let i={};return kI(r)&&(i={...vB(r,t)}),i=e.type===eW||e.type===tW?{...i,videoDelay:o}:{...i,isTrimmed:!0,startTime:o,endTime:n},i},TW=Jl.withUndoBatch((function({updatingMultipleTracks:e,track:t,newTime:a,updateType:o,videoStartEndTimes:n}){const{dispatch:r,state:i}=tn(),{start:s,end:l}=a,d=i.studio.allLayers.byId[t.id];if(!d)return;const c=YI(d.id),u=s,m=d.startTime||0,p=d.videoDelay||0,h=d.playbackRate||1;let g,y=u;kI(d)&&fB(d,a);let f=!0;switch(t.type){case eW:case tW:switch(o){case sW:px({[d.id]:{videoDelay:s}},!0);break;case lW:y=(d.startTime||0)+h*(u-p),px({[d.id]:{startTime:y,videoDelay:u,endTime:d.endTime||d.duration,isTrimmed:!0}},!0),c&&r(PI({[d.id]:p-u}));break;case dW:g=h*(l-p)+m,px({[d.id]:{isTrimmed:!0,startTime:m,endTime:g}},!0),c&&r(RI({[d.id]:l-s}));break;case"TrimPreview":y=n?n.start:(d.startTime||0)+h*(u-p),g=n?n.end:h*(l-p)+m,px({[d.id]:{isTrimmed:!0,startTime:y,endTime:g}},!0);break;default:f=!1}break;case aW:case nW:case oW:case iW:case rW:px({[d.id]:{isTrimmed:!0,startTime:s,endTime:l}},!0),c&&o===lW?r(PI({[d.id]:m-u})):c&&o===dW&&r(RI({[d.id]:l-s}));break;default:f=!1}f&&(yB(),e||NN(d))})),SW=(e,t)=>{const{state:a}=tn(),{start:o,end:n}=t,r=a.studio.allLayers.byId[e.id];if(!r)return;let i={};if(kI(r)){const e=GI(r,{startTime:o,duration:r.duration});e&&(i={...i,...e})}switch(e.type){case eW:case tW:return{videoDelay:o,...i};case aW:case nW:case oW:case iW:case rW:return{isTrimmed:!0,startTime:o,endTime:n,...i};default:return}},IW=()=>{const{state:e}=tn(),{studio:t}=e,{scenes:a,selectedTimelineRows:o}=t,{layers:n}=a[0];return n.some((e=>e.type===ln.Subtitle))&&o.includes(-1)},xW=(e,t,a)=>{let o=!1;const n={};for(const r of t)if(r.id!==e.id){if(o){const{start:e,end:t}=Rd(r),o=_W({track:r,newTime:{start:e+a,end:t+a}});o&&(n[r.id]=o)}}else o=!0;px(n,!0),NN()},kW=(e,t)=>{const{state:a}=tn(),o=Bl(a),{layers:n}=a.studio.scenes[0],r=IB(e);if(!r||void 0===r.timelineRow||void 0===r.duration)return;const i=n.filter((e=>e.timelineRow===r.timelineRow)).sort(((e,t)=>Rd(e).start-Rd(t).start)),s=r.startTime||0,l=r.endTime||r.duration||0,d=r.videoDelay||0,{playbackRate:c=1}=r,u=r.isReversed?{start:r.duration-t.end,end:r.duration-t.start}:t,m=(l-s)/c,p=(u.end-u.start)/c;Jl.beginBatch();const h=d+p;if(TW({track:r,newTime:{start:d,end:h},updateType:"TrimPreview",videoStartEndTimes:u}),o)xW(r,i,p-m);else{let t;const a=i.findIndex((t=>t.id===e));if(a>=0&&a+1<i.length){const e=i[a+1];e&&(t=Rd(e).start)}t&&h>t&&xW(r,i,h-t)}r.isReversed&&(QA(),Jl.add({undo:{func:()=>{QA()}},redo:{func:()=>{QA()}}})),Jl.endBatch()},CW=(e,t,a)=>{const o=e.timelineRow||0;let n=o+1;const r=t.map((e=>({...e})));let i;r.sort(((e,t)=>(e.timelineRow||0)-(t.timelineRow||0)));const{start:s,end:l}=Rd(e,a);for(const c of r){const{timelineRow:e=0}=c;if(e<n)continue;if(n<e)break;const{start:t,end:o}=Rd(c,a);if(s<=t&&t<l||t<=s&&s<o){i=!0;break}}if(!i)return;const d={};r.forEach((e=>{void 0!==e.timelineRow&&o<e.timelineRow&&e.timelineRow<=n&&(d[e.id]={timelineRow:e.timelineRow+1},n+=1)})),px(d,!0)},AW=["topLeft","topRight","bottomLeft","bottomRight"],NW=["middleLeft","middleRight"],PW=[...AW,...NW],RW=["top","left","bottom","right"],LW=(e,t)=>Math.sqrt(e*e+t*t),DW=({x:e,y:t},{x:a,y:o})=>180*Math.atan2(o-t,a-e)/Math.PI,OW=e=>e*Math.PI/180,FW=e=>Math.cos(OW(e)),MW=e=>Math.sin(OW(e)),UW=(e,t,a)=>{let o=t,n=e+t;return n<=a&&(o=a-e,n=a),{deltaW:o,width:n}},BW=(e,t,a)=>{let o=t,n=e+t;return n<=a&&(o=a-e,n=a),{deltaH:o,height:n}},WW=(e,t,a,o,n,r,i)=>{const{rotateAngle:s}=t;let l,d,{width:c,height:u,centerX:m,centerY:p}=t,h=o,g=a;switch(e){case"topRight":if(n){const e=c+a,t=u-o,r=1/n+n;g=(e*n+t)/r-c,h=u-(e+t/n)/r}h=-h,d=UW(c,g,r),l=BW(u,h,i),c=d.width,g=d.deltaW,u=l.height,h=l.deltaH,m+=g/2*FW(s)+h/2*MW(s),p+=g/2*MW(s)-h/2*FW(s);break;case"topLeft":if(n){const e=c-a,t=u-o,r=1/n+n;g=c-(e*n+t)/r,h=u-(e+t/n)/r}g=-g,h=-h,d=UW(c,g,r),l=BW(u,h,i),c=d.width,g=d.deltaW,u=l.height,h=l.deltaH,m-=g/2*FW(s)-h/2*MW(s),p-=g/2*MW(s)+h/2*FW(s);break;case"bottomRight":if(n){const e=c+a,t=u+o,r=1/n+n;g=(e*n+t)/r-c,h=(e+t/n)/r-u}d=UW(c,g,r),l=BW(u,h,i),c=d.width,g=d.deltaW,u=l.height,h=l.deltaH,m+=g/2*FW(s)-h/2*MW(s),p+=g/2*MW(s)+h/2*FW(s);break;case"bottomLeft":if(n){const e=c-a,t=u+o,r=1/n+n;g=c-(e*n+t)/r,h=(e+t/n)/r-u}g=-g,d=UW(c,g,r),l=BW(u,h,i),c=d.width,g=d.deltaW,u=l.height,h=l.deltaH,n&&(u=c/n,h=g/n),m-=g/2*FW(s)+h/2*MW(s),p-=g/2*MW(s)-h/2*FW(s);break;case"middleRight":h=0,d=UW(c,g,r),l=BW(u,h,i),c=d.width,g=d.deltaW,u=l.height,h=l.deltaH,m+=g/2*FW(s)-h/2*MW(s),p+=g/2*MW(s)+h/2*FW(s);break;case"middleLeft":g=-g,h=0,d=UW(c,g,r),l=BW(u,h,i),c=d.width,g=d.deltaW,u=l.height,h=l.deltaH,m-=g/2*FW(s)+h/2*MW(s),p-=g/2*MW(s)-h/2*FW(s)}return{position:{centerX:m,centerY:p},size:{width:c,height:u}}},VW=(e,t,a,o)=>{const{x:n,y:r,width:i,height:s}=e,{x:l,y:d}=t,{x:c,y:u,width:m,height:p}=a,h=t.width/a.width,g=t.height/a.height;let y,f;switch(o){case"topLeft":y=l-c,f=d-u;break;case"topRight":y=l+m-(c+m),f=d+p-(u+p);break;case"bottomLeft":y=-(c-l),f=-(u-d);break;case"bottomRight":y=0,f=0;break;default:return null}return{x:(n-l+y)*h+l,y:(r-d+f)*g+d,width:i*g,height:s*g}},jW=(e,t,a)=>{const o=e.x+e.width/2,n=e.y+e.height/2,r=t.x+t.width/2,i=t.y+t.height/2,s=t.rotation-a.rotation,l=s*Math.PI/180;let d;d=a.rotation!==e.rotation?s+e.rotation:t.rotation;const c=Math.cos(l)*(e.x-o)-Math.sin(l)*(e.y-n)+o,u=Math.cos(l)*(e.y-n)+Math.sin(l)*(e.x-o)+n,m=Math.cos(l)*(e.x-r)-Math.sin(l)*(e.y-i)+r,p=Math.cos(l)*(e.y-i)+Math.sin(l)*(e.x-r)+i;return{newX:e.x+m-c,newY:e.y+p-u,layerRotation:d}},GW=(e,t,a,o)=>{const n=t-o,r=a-o;return{topLeft:[0,0,n,r],topRight:[n,0,0,r],bottomLeft:[0,r,n,0],bottomRight:[n,r,0,0],middleLeft:[0,r/2,n,0],middleRight:[n,r/2,0,0]}[e]},HW=e=>{if(vi(e))return!0;return 0===e.button};var zW={alignVert:!1,alignHoriz:!1,multiLine:!1,detectMultiLine:!0,minFontSize:6,maxFontSize:80,reProcess:!0,widthOnly:!1,alignVertWithFlexbox:!1};function $W(e,t){if(a=e,!("object"==typeof HTMLElement?a instanceof HTMLElement:a&&"object"==typeof a&&null!==a&&1===a.nodeType&&"string"==typeof a.nodeName)||!t.reProcess&&e.getAttribute("textFitted"))return!1;var a,o,n,r,i,s,l,d;if(t.reProcess||e.setAttribute("textFitted",1),r=e.innerHTML,i=function(e){var t=window.getComputedStyle(e,null);return e.getBoundingClientRect().width-parseInt(t.getPropertyValue("padding-left"),10)-parseInt(t.getPropertyValue("padding-right"),10)}(e),n=function(e){var t=window.getComputedStyle(e,null);return e.getBoundingClientRect().height-parseInt(t.getPropertyValue("padding-top"),10)-parseInt(t.getPropertyValue("padding-bottom"),10)}(e),!i||!t.widthOnly&&!n)throw t.widthOnly?new Error("Set a static width on the target element "+e.outerHTML+" before using textFit!"):new Error("Set a static height and width on the target element "+e.outerHTML+" before using textFit!");-1===r.indexOf("textFitted")?((o=document.createElement("span")).className="textFitted",o.style.display="inline-block",o.innerHTML=r,e.innerHTML="",e.appendChild(o)):KW(o=e.querySelector("span.textFitted"),"textFitAlignVert")&&(o.className=o.className.replace("textFitAlignVert",""),o.style.height="",e.className.replace("textFitAlignVertFlex","")),t.alignHoriz&&(e.style["text-align"]="center",o.style["text-align"]="center");var c=t.multiLine;t.detectMultiLine&&!c&&o.scrollHeight>=2*parseInt(window.getComputedStyle(o)["font-size"],10)&&(c=!0),c||(e.style["white-space"]="nowrap"),s=t.minFontSize,d=t.maxFontSize;for(var u=s;s<=d;)l=d+s>>1,o.style.fontSize=l+"px",o.getBoundingClientRect().width<=i&&(t.widthOnly||o.getBoundingClientRect().height<=n)?(u=l,s=l+1):d=l-1;if(o.style.fontSize!=u+"px"&&(o.style.fontSize=u+"px"),t.alignVert){!function(){if(document.getElementById("textFitStyleSheet"))return;var e=[".textFitAlignVert{","position: absolute;","top: 0; right: 0; bottom: 0; left: 0;","margin: auto;","display: flex;","justify-content: center;","flex-direction: column;","}",".textFitAlignVertFlex{","display: flex;","}",".textFitAlignVertFlex .textFitAlignVert{","position: static;","}"].join(""),t=document.createElement("style");t.type="text/css",t.id="textFitStyleSheet",t.innerHTML=e,document.body.appendChild(t)}();var m=o.scrollHeight;"static"===window.getComputedStyle(e).position&&(e.style.position="relative"),KW(o,"textFitAlignVert")||(o.className=o.className+" textFitAlignVert"),o.style.height=m+"px",t.alignVertWithFlexbox&&!KW(e,"textFitAlignVertFlex")&&(e.className=e.className+" textFitAlignVertFlex")}}function KW(e,t){return(" "+e.className+" ").indexOf(" "+t+" ")>-1}const YW=(e,t,a,o)=>{const n=document.createElement("div");return n.style.overflow="hidden",n.style.position="relative",n.style.width="0px",n.style.height="0px",e&&(n.style.position="fixed",n.style.bottom="0",n.style.right="0",n.style.width=t,n.style.height=a,n.style.zIndex="100",n.style.background=o),document.body.appendChild(n),n},qW=e=>{const{div:t,layer:a}=e;t.style.display="inline-block",t.style.verticalAlign="middle",t.style.outline="none";const{fontWeight:o,italic:n,fontFamily:r,text:i,textShadow:s,textAlign:l,textTransform:d,lineHeight:c}=a;let u="normal";o&&o.includes("bold")&&(u="bold"),t.style.fontWeight=u,t.style.fontStyle=n?"italic":"",t.style.fontFamily=r,t.style.textAlign=l||"left",t.style.textTransform=d||"none",t.style.whiteSpace="pre-line",t.style.lineHeight=String(c),t.textContent=i,t.style.textShadow=`-1px -1px 0 ${s}, 1px -1px 0 ${s}, -1px 1px 0 ${s}, 1px 1px 0 ${s}`};function XW(e,t,a,o=!1){var n,r,i,s,l;if(""===e.text.trim())return null!=(n=e.fontSize)?n:16;if(t<=0||a<=0)return null;const d=document.createElement("div"),c=Math.abs(t),u=Math.abs(a),m={div:d,layer:e},p=YW(o,`${c}px`,`${u}px`,"white");if(c&&u&&c>0&&u>0){d.style.width=`${c<1?1:c}px`,d.style.height=`${u<1?1:u}px`,qW(m),p.appendChild(d),function(e,t){t||(t={});var a={};for(var o in zW)t.hasOwnProperty(o)?a[o]=t[o]:a[o]=zW[o];"function"==typeof e.toArray&&(e=e.toArray());var n=Object.prototype.toString.call(e);"[object Array]"!==n&&"[object NodeList]"!==n&&"[object HTMLCollection]"!==n&&(e=[e]);for(var r=0;r<e.length;r++)$W(e[r],a)}(d,{multiLine:!0,minFontSize:1,maxFontSize:500});const e=parseInt(null!=(l=null==(s=null==(i=null==(r=d.getElementsByTagName("span"))?void 0:r[0])?void 0:i.style)?void 0:s.fontSize)?l:"",10);return o||p.remove(),Math.max(e,1)}return 16}function JW(e){const t=e.position?e.position.width:"0",a=e.position?e.position.height:"0",{width:o,height:n}=function(e,t){const{state:a}=tn(),o=a.studio.width||0,n=a.studio.height||0;return{width:parseFloat(e)/100*o,height:parseFloat(t)/100*n}}(t,a);return XW(e,o,n)}const QW=(e,t,a)=>t<a?{height:e,width:a/t*e}:{height:t/a*e,width:e},ZW=["8","9","10","11","12","14","18","24","30","36","48","64","72","96","100","125","150"],eV=()=>{const e=[];return ZW.forEach((t=>{e.push({iconUrl:"",value:t,label:`${t}`})})),e},tV=()=>{const e=[];return Vu.forEach((t=>{e.push(t)})),e},aV=()=>{const{state:e}=tn(),{teams:{activeBrandkit:t}}=e,a=null==t?void 0:t.fonts;null==a||a.forEach((e=>{if("custom"===e.type){const{fontFamily:t,url:a,asset_id:o}=e;lB({type:"custom",fontFamily:t,url:a,asset_id:o})}}))},oV=({nameType:e,name:t},a,o,n)=>{let r="";if("blob"===e){const e=t.split("-");if(e.length>=2){const[t]=e;t&&(r=t)}else e.pop(),r=e.join("-")}else{const[e]=t.split(".");e&&(r=e)}return{fontFamily:r,url:a,fontType:o.includes("ttf")?"truetype":"opentype",asset_id:n}};function nV(e,t){const a=e/t;return!a||Number.isNaN(a)?1:a}function rV(e,t){return t?Math.round(e/t*700):e}function iV(e,t){return t?e/700*t:e}function sV(e,t,a,o){const n=[];let r=0;const i=document.createElement("canvas").getContext("2d");if(i&&e&&t){const s=e.fontWeight||"normal",l=Rx(e,e.fallbackFonts||[]),d=e.italic?"italic":"normal";i.font=`${d} normal ${s} ${o}px ${l}`,r=i.measureText("W").width;a.replaceAll("\r\n","").split("\n").forEach((a=>{const o=function(e,t,a,o){const n=[];if(t.length<1)return n;let r="";const i=[" ","-"];let s=-1;for(let d=0;d<t.length;d+=1){const c=t.charAt(d);let u=r+c;"uppercase"===o.textTransform?u=u.toLocaleUpperCase():"lowercase"===o.textTransform&&(u=u.toLocaleLowerCase()),e.measureText(u).width>=a&&(-1!==s?(n.push(r.substring(0,s+1)),r=r.substring(s+1)):(n.push(r),r=""),s=-1),l=c,i.includes(l)&&(s=r.length),r+=c}var l;return r.length>0&&n.push(r),n}(i,a,t,e),r=o.join("\r\n");n.push(r)}))}return{textWithLineBreaks:n.join("\n"),minWidth:r}}const lV=async e=>{var t;const{dispatch:a,state:o}=tn(),n=o.studio.scenes[0];if(!n)throw Error("No scene found");a({type:"SHOW_STUDIO_CANVAS"});const r=function(e="30%",t="30%"){let a=100-parseInt(e,10)-20;a<5&&(a=5);const o=Math.random()*(a-3)+3,n=15*Math.random()+5;return{x:IS(o),y:IS(n),width:e,height:t,rotation:0}}((null==e?void 0:e.width)||"45%",(null==e?void 0:e.height)||"8%"),i={id:y(),type:ln.Text,backgroundColor:(null==e?void 0:e.backgroundColor)||lp,borderRadius:(null==e?void 0:e.borderRadius)||{relative:"25%"},color:(null==e?void 0:e.color)||"#000000",fontFamily:(null==e?void 0:e.fontFamily)||"Arial",fontSize:null==e?void 0:e.fontSize,baseWidth:null==e?void 0:e.baseWidth,baseHeight:null==e?void 0:e.baseHeight,italic:null==e?void 0:e.italic,fontWeight:(null==e?void 0:e.fontWeight)||"normal",globalAlpha:(null==e?void 0:e.globalAlpha)||1,lineHeight:(null==e?void 0:e.lineHeight)||1,lockAspectRatio:!0,position:r,text:"Sample text",textAlign:(null==e?void 0:e.textAlign)||"center",textTransform:(null==e?void 0:e.textTransform)||"none",textShadow:(null==e?void 0:e.textShadow)||"transparent",underline:null==e?void 0:e.underline,wrapOrFill:(null==e?void 0:e.wrapOrFill)||"wrap",textPadding:(null==e?void 0:e.textPadding)||12.5};if("custom"===(null==(t=null==e?void 0:e.font)?void 0:t.type)){const{fontType:t,fontFamily:a,url:o,asset_id:n}=e.font,r=await AD([n]);i.hasCustomFont=!0,i.asset_id=n,i.fontType=t,i.url=r[n]||o,i.fontFamily=a}const s=cS(i);if(s){const{width:e,height:t}=s,a=XW(i,e,t);a&&!i.fontSize&&(i.baseWidth=e,i.baseHeight=t,i.fontSize=a);const o=nV(e,i.baseWidth),n=(i.fontSize||0)*o,r=(i.lineHeight||1)*n,{textWithLineBreaks:l}=sV(i,e,i.text,i.fontSize||0);i.text="Sample text",i.textWithLineBreaks="",setTimeout((()=>{KT(i.id,{textTemp:l})}),0);const d=nS(e,l.split("\n").length*r);i.position&&(i.position.height=d.heightPercent)}if(!i.fontSize){const e=JW(i);i.fontSize=e||void 0}return RB(i,{sceneId:n.id,undoable:!0}),a({type:"ADD_TEXT_LAYER_ID_ADDED_IN_SESSION",id:i.id}),i},dV=(e,t,a,o=!1,n=!1)=>{const{state:r}=tn(),i=ul(r,e.id).fontSizingTemp,s=n&&null!=i?i:e;if(s&&(s.baseWidth!==t||s.baseHeight!==a)){if(n)return void KT(e.id,{fontSizingTemp:{fontSize:s.fontSize,baseWidth:t,baseHeight:a}});px({[e.id]:{baseWidth:t,baseHeight:a}},o)}},cV=(e,t="")=>{const{state:a}=tn();if(!ml(a,e.id)||"text"!==e.type)return;const{textTemp:o=""}=ul(a,e.id);""!==o||""!==t?KT(e.id,{isEditing:!1}):zB({layerIds:[e.id],undoable:!0})},uV=e=>{const{dispatch:t}=tn();t(gg(e))},mV=(e,t,a=!1)=>{var o;const{width:n,x:r,y:i}=t||cS(e),{containerWidth:s,containerHeight:l}=((e,t,a=!1)=>{const{fontSize:o,lockAspectRatio:n}=e,r=document.createElement("div");if(qW({div:r,layer:e}),r.style.fontSize=`${o}px`||"",n){const{baseHeight:t=0,baseWidth:a=0}=e;r.style.height="1px",r.style.width="1px",document.body.appendChild(r);const o={containerHeight:0,containerWidth:0};let n=1;const{containerHeight:i,containerWidth:s}=tn().state.studio;for(;r.scrollHeight>r.clientHeight||r.scrollWidth>r.clientWidth;){if(n>i&&n>s)return r.remove(),o;const{height:e,width:l}=QW(n,t,a);o.containerHeight=e,o.containerWidth=l,r.style.height=`${e}px`,r.style.width=`${l}px`,n+=1}return r.remove(),o}const i=YW(a,`${t}px`,"auto","blue");i.style.width=`${t}px`,i.appendChild(r);const{width:s}=r.getBoundingClientRect(),{height:l}=r.getBoundingClientRect();return a||i.remove(),{containerWidth:s,containerHeight:l}})(e,n),d=a?n:s,c=l,u={x:r,y:i,width:d,height:c,rotation:null==(o=e.position)?void 0:o.rotation};VB(e,u,!0),dV(e,d,c,!0)};function pV(e,t,a,o=!0){const n=XW(e,t,a);if(!n)return e.fontSize;const r=nV(t,e.baseWidth);return n===e.fontSize&&1===r&&null!=e.baseWidth||(o?Jl.execInUndoBatch((()=>{px({[e.id]:{fontSize:n}},!0),dV(e,t,a,!0)})):(px({[e.id]:{fontSize:n}},!1),dV(e,t,a,!1))),n}const hV=(e,t,a,o)=>{const{dispatch:n}=tn();n(Fh(e,t,a,o))},gV=(e,t,a,o)=>{const{dispatch:n}=tn();n(Mh(e,t,a,o))},yV=(e,t,a)=>{const{dispatch:o}=tn();o(Uh(e,t,a))},fV=(e,t,a)=>{const{dispatch:o}=tn();o(function(e,t,a){return{type:"ADD_GROUP_TO_GROUP",srcGroupId:e,destGroupId:t,undoable:a}}(e,t,a))},EV=(e,t,a)=>{const{dispatch:o}=tn();o(function(e,t,a){return{type:"REMOVE_GROUP_FROM_GROUP",srcGroupId:e,destGroupId:t,undoable:a}}(e,t,a))},vV=c((e=>{var t,a;return e.studio.groups[null!=(a=null==(t=e.studio.selectedItem)?void 0:t.id)?a:""]}),(e=>e.studio.allLayers.byId),((e,t)=>{if(e)return((e,t)=>{var a;const o=e.layers[0];if(!o)return;const n=null==(a=t[o.id])?void 0:a.type;return!n||e.layers.every((e=>{var a;return(null==(a=t[e.id])?void 0:a.type)===n}))?n:void 0})(e,t)})),wV=e=>e.some((e=>!("audio"===e.type&&!e.isAudiogram))),bV=(e,{isUndoable:t,isTimelineGroup:a=!0})=>{const{state:o,dispatch:n}=tn(),{selectedItem:r,groups:i}=o.studio,s=null==r?void 0:r.id,l=s?i[s]:void 0;if(e&&s!==e)if(s&&l){const o=s,n=l.layers.find((t=>t.id===e));n?n.fromMergedGroup?EV(n.fromMergedGroup,o,t):yV(e,o,t):hV(e,o,a,t)}else{const o=y();n(Kh({id:o,type:"group"})),s&&i[s]?fV(s,o,t):s&&hV(s,o,a,t),hV(e,o,a,t)}},_V=(e,t,a,o=!0)=>{const{state:n,dispatch:r}=tn(),{groups:i}=n.studio;if(e===t)return;const s=i[e],l=i[t];if(s){const o=e;s.layers.map((e=>e.id)).some((e=>null==l?void 0:l.layers.map((e=>e.id)).includes(e)))?EV(t,o,a):fV(t,o,a)}else{hV(e,t,o,a),r(Kh({id:t,type:"group"}))}},TV=(e,t=!0)=>{var a;const{dispatch:o,state:n}=tn(),{groups:r}=n.studio,i=null==(a=Object.entries(r).find((([t,a])=>s.exports.isEqual(a.layers.map((e=>e.id)),e))))?void 0:a[0],l=Object.keys(r),d=[],c=[];e.forEach((e=>{l.includes(e)?d.push(e):c.push(e)}));const u=d.shift()||y();if(e.length>0){if(i)return o(Kh({id:i,type:"group"})),i;const a=e[0];if(1===e.length&&a){const e=Object.keys(r).find((e=>e===a));return o(Kh({id:a,type:e?"group":"layer"})),a}return m.exports.batch((()=>{d.forEach((e=>{fV(e,u,!1)})),c.length>0&&gV(c,u,t,!1),o(Kh({id:u,type:"group"}))})),u}return o(Kh(null)),null},SV=(e,t)=>{const a=(null==t?void 0:t.state)||tn().state,{groups:o,selectedItem:n}=a.studio;if(!n||"group"!==n.type)return!1;const r=(null==t?void 0:t.currentGroup)||o[n.id];if(!r)return!1;const i=r.layers.find((({id:t})=>e===t));return!!i&&!0!==i.deselected},IV=(e,t=!0)=>{const{state:a}=tn(),{selectedItem:o}=a.studio;o&&"group"===o.type&&xV(o.id,e,t)},xV=Jl.withUndoBatch(((e,t,a=!0)=>{const{state:o,dispatch:n}=tn(),{groups:r}=o.studio;n(Vh(e,t,a)),m.exports.batch((()=>{if(t){const t=r[e];if(!t)return;t.layers.forEach((t=>{Object.entries(r).filter((([a,n])=>a!==e&&n.saved&&SV(t.id,{currentGroup:n,state:o}))).map((([e])=>e)).forEach((e=>{n(Wh(e,a))}))}))}}))})),kV=(e=!0)=>{const{state:t}=tn(),{selectedItem:a}=t.studio;a&&"group"===a.type&&AV(a.id,e)},CV=()=>{var e,t;const{state:a}=tn(),{selectedItem:o,groups:n}=a.studio;if(!o||"group"!==o.type)return!1;const r=n[o.id];if(!r)return!1;const i=[ln.Text,ln.Image,ln.Shape];let s=!1;for(const l of r.layers){let a=null==(e=r.hydratedLayers)?void 0:e.find((({id:e})=>e===l.id));if(a||(a=null!=(t=IB(l.id))?t:void 0),a&&!i.includes(a.type))return!1;a&&a.type===ln.Text&&(s=!0)}return!!s},AV=(e,t=!0)=>{var a,o;const{state:n,dispatch:r}=tn(),{groups:i,ratio:s,projectId:l}=n.studio,d=s.split(":").map(Number),c=i[e];if(!c)return;const u=[];for(const h of c.layers){let e=null==(a=c.hydratedLayers)?void 0:a.find((({id:e})=>e===h.id));e||(e=null!=(o=IB(h.id))?o:void 0),e&&u.push(e)}const m=`template-${y()}`,p={templateId:m,layers:u.map((e=>((e,t)=>{const{state:a}=tn(),{animations:o}=a.studio;let n={animationName:dn.None,transitionDuration:.5};Object.values(o.byId).forEach((t=>{if(t.isCrossTransition)return;const{animationName:a,transitionDuration:o,layerId:r}=t;r===e.id&&(n={animationName:a,transitionDuration:o||.5})}));const{textBlocks:r,draftJSTextTree:i,local_url:s,uploadConfirmed:l,uploadProgress:d,uploadPending:c,uploadId:u,asset_id:m,animation:p,pastedUrl:h,url:g,...y}=e,f={...y,url:h||g,fromTextDefaults:t};return n.animationName!==dn.None&&(f.animation=n),f})(e,m))),timestampCreated:Date.now(),ratio:d,projectId:null!=l?l:void 0};r(Qp({template:p,undoable:t,index:0})),r(VR({tabContainerId:"media-sidebar",tabId:"Text"}))};function NV(e,t,a){var o,n;const{state:r,dispatch:i}=tn(),{scenes:s,projectId:l,canvasX:d=0,canvasY:c=0,width:u=0,height:m=0}=r.studio,p=s[0];if(!p)return;const{layers:h,duration:g}=p,f=[];let E=Number.MAX_SAFE_INTEGER;for(const y of e.layers){let t=null==(o=e.hydratedLayers)?void 0:o.find((({id:e})=>e===y.id));if(t||(t=null!=(n=IB(y.id))?n:void 0),t){const{start:e}=Rd(t,g);if(e<E&&(E=e),a&&a.originalProject&&l!==a.originalProject.id){const{originalProject:e}=a,o=(fS([t],e.width,e.height,u,m)?ES:yS)(t,e.width,e.height,u,m);o.x+=d,o.y+=c,t={...t,position:bS(o)}}f.push(t)}}const v=y(),{minTimelineRow:w}=function(e){let t=-1,a=Number.MAX_SAFE_INTEGER;for(const o of e)null!=o.timelineRow&&(o.timelineRow<a&&(a=o.timelineRow),o.timelineRow>t&&(t=o.timelineRow));return t=Math.max(t,1),a=Math.min(t,a),t+=1,{minTimelineRow:a,maxTimelineRow:t}}(h),b=ST()-E,_={},T=f.map((e=>{var t,a,o;const n={timelineRow:0,...e,id:y()};if(_d(n)||vd(n)?n.videoDelay=(null!=(t=n.videoDelay)?t:0)+b:(n.startTime=(null!=(a=n.startTime)?a:0)+b,n.endTime=(null!=(o=n.endTime)?o:0)+b),kd(n)){const t=v_(e);n.animation={intro:[],constant:[],outro:[]};["intro","constant","outro"].forEach((a=>{var o,r;const s=t[a][0];if(s&&s.id!==dn.None)if(s.isCrossTransition){const t=s.animationStateMapId,a=s.introLayerId===e.id;_[t]||(_[t]={animationName:s.transitionId,transitionDuration:s.transitionDuration||.5}),_[t][a?"newIntroLayer":"newOutroLayer"]=n}else{const e={id:y(),animationName:s.id,isCrossTransition:!1,layerId:n.id,transitionDuration:s.transitionDuration||.5};null==(r=null==(o=n.animation)?void 0:o[a])||r.push(e.id),i(Eh(e))}}))}return n.timelineRow<w&&(n.timelineRow=w+n.timelineRow),n}));Object.values(_).filter((e=>!!e.newIntroLayer&&!!e.newOutroLayer)).forEach((({newIntroLayer:e,newOutroLayer:t,animationName:a,transitionDuration:o})=>{var n,r,s,l;const d={id:y(),animationName:a,isCrossTransition:!0,introLayerId:e.id,outroLayerId:t.id,transitionDuration:o};null==(r=null==(n=e.animation)?void 0:n.intro)||r.push(d.id),null==(l=null==(s=t.animation)?void 0:s.outro)||l.push(d.id),i(Eh(d))}));const{isTimelineGroup:S=!1}=e;T.forEach((e=>{RB(e,{undoable:t})}));const I=e.saved;T.forEach((e=>{hV(e.id,v,S,t)})),I&&xV(v,!0,t),i(Kh({id:v,type:"group"}))}const PV=(e,t=!0,a)=>{try{t&&Jl.beginBatch(),NV(e,t,a)}finally{t&&Jl.endBatch()}},RV=()=>{const e=LV(!0);e&&PV(e,!0)},LV=e=>{const{state:t}=tn(),{selectedItem:a}=t.studio;return a&&"group"===a.type?DV(a.id,e):null},DV=(e,t)=>{var a;const{state:o}=tn();let n=null==(a=o.studio.groups)?void 0:a[e];if(n){if(t){const e=[];n.layers.forEach((t=>{const a=IB(t.id);a&&e.push({...a})})),n={...n,hydratedLayers:e}}return n}return null};const OV=Jl.withUndoBatch((e=>{const{dispatch:t}=tn(),a=y();m.exports.batch((()=>{t(function(e=!0){return{type:"REMOVE_ALL_UNSAVED_GROUPS",undoable:e}}()),gV(e,a,!0,!0),t(Kh({id:a,type:"group"}))}))})),FV=()=>{const{studio:e}=tn().state,{scenes:t,groups:a}=e,o=t[0];if(!o)return;const n=o.layers;let r=n.filter((e=>e.type!==ln.Subtitle)).map((e=>e.id));if(0===r.length){if(!(n.length>0))return;r=n.map((e=>e.id))}TV(((e,t)=>{var a;const o=new Set,n=[];for(const r of e)if(!o.has(r)){const e=null==(a=Object.entries(t).find((([e,t])=>t.saved&&t.layers.find((e=>e.id===r)))))?void 0:a[0];if(e){n.push(e);const a=t[e];a&&a.layers.forEach((e=>o.add(e.id)))}else n.push(r)}return n})(r,a))},MV=Jl.withUndoBatch(((e,t,a=!0)=>{const{rotation:o,origin:n,xDiff:r,yDiff:i,transformerNode:s}=t;void 0!==o&&((e,t,a)=>{const{dispatch:o,state:{studio:n}}=tn(),r=n.groups[e];if(!r)return;const{rotation:i,currentPosition:s,initialPosition:l}=t;void 0!==i&&s&&l&&m.exports.batch((()=>{BV(e,{rotation:i},a);for(const{id:e,deselected:t}of r.layers){if(t)continue;const r=Jw(e,n);if(!r)continue;const{position:i}=r;let d=cS(r);"shape"===r.type&&"ellipse"===r.shapeType&&(d={...d,x:d.x-d.width/2,y:d.y-d.height/2});const c=jW(d,s,l),{layerRotation:u}=c;let{newX:m,newY:p}=c;"shape"===r.type&&"ellipse"===r.shapeType&&(m+=d.width/2,p+=d.height/2);const{xPercent:h,yPercent:g}=lS(m,p);o(xh(r,u,a)),KT(r.id,{positionTemp:null}),o(Th(r,h,g,i.width,i.height,a))}}))})(e,t,a),(r||i)&&((e,t,a)=>{var o,n;const r=ST(),{xDiff:i,yDiff:s}=t,{dispatch:l,state:{studio:d}}=tn(),{height:c=0,width:u=0,canvasX:m=0,canvasY:p=0}=d,h=d.groups[e];if(!h)return;const g={};for(const{id:y,deselected:f}of h.layers){if(f)continue;const e=Jw(y,d);if(!e||!e.position)continue;const t=rx(e,null==(o=d.keyframing)?void 0:o[e.id],r,d.width||0,d.height||0),{x:h,y:E}=QT(t.x,t.y),{xPercent:v,yPercent:w}=lS(h+i,E+s);if(qI(e.id,Sn.POSITION)){let t=v,a=w;if(qI(e.id,Sn.ZOOM)){const o=cS(e),l=cS({...e,position:rx(e,null==(n=d.keyframing)?void 0:n[e.id],r,d.width||0,d.height||0)});if(l&&o){const e=l.x+i+l.width/2-m,n=l.y+s+l.height/2-p,r=e-o.width/2,d=n-o.height/2;t=r/u*100+"%",a=d/c*100+"%"}}JI({...e,position:{...e.position,x:t,y:a}})}if(KT(e.id,{positionTemp:null}),qI(e.id,Sn.ZOOM)){const a=cS(e),o=cS({...e,position:t});if(!a||!o)continue;const n=o.x+i+o.width/2-m,r=o.y+s+o.height/2-p,l=n-a.width/2,d=r-a.height/2,h={...e.position,x:l/u*100+"%",y:d/c*100+"%"};g[e.id]={position:h}}else l(Th(e,v,w,t.width,t.height,a))}px(g)})(e,t,a),s&&((e,t,a)=>{var o;const{currentPosition:n,initialPosition:r,transformerNode:i}=t;if(!i||!n||!r)return;const s=ST(),{dispatch:l,state:{studio:d}}=tn(),c=d.groups[e];if(!c)return;const{width:u=0,height:m=0,canvasX:p=0,canvasY:h=0}=d,g={};for(const{id:y,deselected:f}of c.layers){if(f)continue;const e=Jw(y,d);if(!e)continue;const t=VW(cS(e),n,r,i),{xPercent:c,yPercent:E}=lS(t.x,t.y),{widthPercent:v,heightPercent:w}=nS(t.width,t.height);KT(e.id,{positionTemp:null});let b=null;if(XI(e.id)&&e.position){const t=rx(e,null==(o=d.keyframing)?void 0:o[e.id],s,d.width||0,d.height||0);if(b=cS({...e,position:t}),b){const e=n.width/r.width,t=b.x-r.x,a=b.y-r.y;b.x=n.x+t*e,b.y=n.y+a*e,b.width*=e,b.height*=e}}if(qI(e.id,Sn.POSITION)&&e.position&&b){const t=(b.x-p)/u*100+"%",a=(b.y-h)/m*100+"%";JI({...e,position:{...e.position,x:t,y:a,width:v,height:w}})}if(qI(e.id,Sn.ZOOM)&&e.position&&b){const t=e.zoom||100,{width:a,height:o}=eS(e.position.width,e.position.height),n=b.width*t/a;QI({...e,zoom:n});const r=b.x-p+b.width/2-a/2,i=b.y-h+b.height/2-o/2,s={...e.position,x:r/u*100+"%",y:i/m*100+"%"};g[e.id]={position:s}}else l(Th(e,c,E,v,w,a));px(g),Sd(e)&&pV(e,t.width,t.height,a)}})(e,t,a),n&&BV(e,{origin:n},a)})),UV=Jl.withUndoBatch(((e,t=!0)=>{const{state:a}=tn(),{groups:o,scenes:n}=a.studio,r=n[0],i=o[e];if(!r||!i)return;const s=i.layers.map((e=>e.id));zB({layerIds:s,groupId:e,undoable:t,logEvent:!0})})),BV=(e,t,a=!0)=>{const{dispatch:o}=tn();o(function(e,t,a){return{type:"UPDATE_GROUP",groupId:e,updates:t,undoable:a}}(e,t,a))},WV=(e,t=!0)=>{const{dispatch:a,state:o}=tn(),n=o.studio.scenes[0];if(!n)return;const r=o.studio.groups[e];if(!r)return;const{layers:i}=r,s=n.layers.filter((e=>i.map((e=>e.id)).includes(e.id))),l=s.every((e=>e.locked)),d={};for(const c of s)d[c.id]={locked:!l};px(d,!1),a(Kh(null)),t&&Jl.add({undo:{func(){const e={};for(const t of s)e[t.id]={locked:t.locked};px(e,!1)}},redo:{func(){WV(e,!1)}}})},VV=e=>{var t;const{layerId:a,groupId:o,deselected:n,undoable:r}=e,{state:i,dispatch:s}=tn(),l=i.studio.groups[o];if(!l)return;const d=l.layers.filter((e=>!e.deselected));1===d.length&&(null==(t=d[0])?void 0:t.id)===a&&n?Jl.execInUndoBatch((()=>{l.layers.forEach((e=>{e.id!==a&&s(Bh(e.id,o,!n,r))})),s(Kh(null,r))})):s(Bh(a,o,n,r))},jV=(e,t,a)=>({type:"SET_ASSET_PARSED_SUBTITLE",assetId:e,subtitles:t,undoable:a});function GV({assetId:e,endTime:t,startTime:a}){return yC([e])(tn().state).find((e=>{const[o,n]=zS(e);return ol(o,n,a,t)}))}function HV({beforeFrame:e,newTime:t,timeType:a,wordIsClippedList:o}){const{startNdx:n,endNdx:r}="start"===a?function(e){let t=!1,a=0,o=0;for(let n=0;n<e.length;n++)if(e[n]){if(t)return o=n-1,{startNdx:a,endNdx:o}}else t||(a=n),t=!0;return{startNdx:a,endNdx:e.length-1}}(o):function(e){let t=!1,a=0,o=0;for(let n=0;n<e.length;n++)e[n]?(t&&(o=n-1),t=!1):(t||(a=n),t=!0);return t&&(o=e.length-1),{startNdx:a,endNdx:o}}(o),i=function({beforeFrame:e,newTime:t,startNdx:a,endNdx:o,timeType:n}){const r=[{type:"frame_update",frameId:e.id,update:{[n]:t}}];if(!vn(e))return r;const i="start"===n?"end":"start",s="start"===n,l=e.words[a],d=e.words[o-1];if(s&&l&&t<l.start)return r.push({type:"word_update",ndx:a,frameId:e.id,update:{start:t}}),r;if(!s&&d&&t>d.end)return r.push({type:"word_update",ndx:o,frameId:e.id,update:{end:t}}),r;const c=[];for(let p=a;p<=o;p++){const a=e.words[p];void 0!==a&&((s?a.start<t:a.end>t)&&c.push({word:a,ndx:p}))}if(0===c.length)return r;s||c.reverse();const u=c[s?c.length-1:0],m=Math.abs(t-u.word[i])/c.length;for(let p=0;p<c.length;p++){const a=c[p];if(!a)continue;const{ndx:o}=a,l=m*(s?1:-1),d=t+l*p,u={[n]:d};c.length>1&&(u[i]=d+l),r.push({type:"word_update",ndx:o,frameId:e.id,update:u})}return r}({beforeFrame:e,newTime:t,startNdx:n,endNdx:r,timeType:a}),s=vC(e);if("start"===a){const a=[];for(let s=0;s<n;s++){i.push({frameId:e.id,type:"word_remove",ndx:0});const o=e.words[s];if(o){s===n-1&&fn(o)?a.push({...o,end:Math.min(o.end,t)}):a.push(o)}}const o=s.words[0],r=s.words[a.length-1];o&&r&&i.push({type:"frame_insert",frame:{id:y(),start:o.start,end:Math.min(r.end,t),words:a}})}if("end"===a){const a=e.words.length-r-1,o=[];for(let r=0;r<a;r++){i.push({frameId:e.id,type:"word_remove",ndx:e.words.length-a});const n=e.words[e.words.length-r-1];if(n){r===a-1&&fn(n)?o.push({...n,start:Math.max(n.start,t)}):o.push(n)}}o.reverse();const n=s.words[e.words.length-a],l=s.words[e.words.length-1];n&&l&&i.push({type:"frame_insert",frame:{id:y(),start:Math.max(n.start,t),end:l.end,words:o}})}return i}var zV=(e=>(e.LAYER_CONTROLS="LAYER_CONTROLS",e.MEDIA_CONTROLS="MEDIA_CONTROLS",e.COMMENTS="COMMENTS",e))(zV||{});let $V=null;const KV=()=>{if(!$V)return;const{assetId:e,words:t}=$V;$V=null;const a=t[0];if(!a)return;const o=t.reduce(((e,t)=>({...e,...t,before:e.before})),a);ZV({assetId:e,shouldSync:!0,undoable:!0,updates:[o]})},YV=(e,t,a)=>{if(0===e.length)return null;((e,t,a)=>{var o;if(a&&t!==a.assetId)return!1;const n=e[0];if(!n)return!1;if("word_update"!==n.type)return!1;const r=(null==(o=null==a?void 0:a.words)?void 0:o[0])||n;return e.every((e=>"word_update"===e.type&&e.frameId===r.frameId&&e.ndx===r.ndx))})(e,t,$V)?(ZV({updates:e,assetId:t,shouldSync:!1,undoable:!1}),$V||($V={assetId:t,words:[]}),$V.words.push(...e)):(KV(),ZV({updates:e,assetId:t,shouldSync:!0,undoable:!0}));let o=null,n=null,r=null,i=0,s=0,l=null;for(const h of e)"frame_insert"===h.type&&(i+=1),"frame_remove"===h.type&&(s+=1),"word_insert"===h.type&&(null===n&&(n=h.ndx),r=h.ndx),"frame_update"===h.type&&(void 0!==h.update.start&&(l="delete"),void 0!==h.update.end&&(l="backspace"));let d=!1,c=null;(i||s)&&(i&&s?o=a+1:s?"backspace"===l?(o=a-1,d=!0,c=n):(o=a,d=!0,null!==r&&(c=r+1)):o=a);let u=0;if(d&&null!==o&&null!==c){const e=(m=o,(null!=(p=GC(tn().state))?p:[])[m]);if(e){const a=(e=>DC(e)(tn().state))(t);for(let t=0;t<c;t++){const o=e.words[t];o&&(u+=o.text.length+a.length)}}}var m,p;return{targetNdx:o,charNdx:u}};function qV(e){const t={...e};void 0===t.undoable&&(t.undoable=!0),KV(),tn().dispatch(t)}function XV(e){return e.type.startsWith("frame")}function JV(e,t){switch(e.type){case"frame_insert":return{type:"INSERT_MAGIC_SUBTITLE_FRAME",frame:e.frame,...t};case"frame_update":return{type:"UPDATE_MAGIC_SUBTITLE_FRAME",frameId:e.frameId,update:e.update,...t};case"frame_remove":return{type:"REMOVE_MAGIC_SUBTITLE_FRAME",frameId:e.frameId,...t};default:throw Error(`Unknown change ${e}`)}}function QV(e,t){switch(e.type){case"word_insert":return{type:"INSERT_MAGIC_SUBTITLE_FRAME_WORD",wordNdx:e.ndx,word:e.word,frameId:e.frameId,...t};case"word_update":return{type:"UPDATE_MAGIC_SUBTITLE_FRAME_WORD",wordNdx:e.ndx,update:e.update,frameId:e.frameId,undoBeforeWord:e.before,...t};case"word_remove":return{type:"REMOVE_MAGIC_SUBTITLE_FRAME_WORD",wordNdx:e.ndx,frameId:e.frameId,...t};default:throw Error(`Unknown change ${e}`)}}const ZV=Jl.withUndoBatch((({assetId:e,shouldSync:t,undoable:a,updates:o})=>{const{dispatch:n}=tn();KV();for(const l of o)XV(l)?n(JV(l,{assetId:e,undoable:a})):n(QV(l,{assetId:e,shouldSync:t,undoable:a}));const r=GC(tn().state),i=lC(tn().state),s=new Set(i);for(const l of r)s.delete(l.assetId);for(const l of s.keys())n(Cx(l)),qV({type:"SET_MAGIC_SUBTITLE_FRAMES",assetId:l,frames:null})})),ej=Jl.withUndoBatch((()=>{const{state:e}=tn();m.exports.batch((()=>{const t=[...Object.keys(e.studio.magicSubtitles||{}),"background-asset"];for(const e of t)tj(e)}))})),tj=Jl.withUndoBatch((e=>{const{dispatch:t}=tn();t(Cx(e)),qV({type:"SET_MAGIC_SUBTITLE_FRAMES",assetId:e,frames:null}),t(jV(e,null,!0))})),aj=()=>{const{dispatch:e,state:t}=tn();e(Kh({type:"magicSubtitle",frames:YC({filterEmpty:!1,filterInvalid:!0})(t).map((e=>({assetId:e.assetId,id:e.frame.id,containingLayerPlaybackRate:e.frame.containingLayerPlaybackRate,wordIsClippedList:e.frame.wordIsClippedList})))}))};const oj=Jl.withUndoBatch((({assetId:e,frameId:t,startTime:a,endTime:o,wordIsClippedList:n})=>{const{state:r}=tn(),i=bC(e,t)(r);w({category:"Magic Subtitles/studioEjectMagicSubtitle",data:{assetId:e,frameId:t,startTime:a,endTime:o,beforeFrame:i}}),qV({type:"REMOVE_MAGIC_SUBTITLE_FRAME",assetId:e,frameId:t});for(const{start:l,end:d,words:c}of function(e,t){const a=[];let o=null;const n=vC(t);for(let r=0;r<e.length;r++){const i=t.words[r],s=n.words[r],l=e[r];s&&i&&(l?o?(o.end=s.end,o.words.push(i)):(o={start:s.start,end:s.end,words:[i]},a.push(o)):o=null)}return a}(n,i))qV({type:"INSERT_MAGIC_SUBTITLE_FRAME",assetId:e,frame:{id:y(),start:l,end:d,words:c}});const s=[];for(let l=0;l<i.words.length;l++){const e=i.words[l],t=n[l];if(!e)continue;if(t)continue;const a={text:e.text};e.styles&&(a.styles=e.styles),s.push(a)}qV({type:"INSERT_MAGIC_SUBTITLE_FRAME",assetId:"background-asset",frame:{id:i.id,start:a,end:o,words:s}})})),nj=Jl.withUndoBatch((e=>{m.exports.batch((()=>{s.exports.uniqBy(e,(e=>`${e.id}-${e.assetId}`)).forEach((({assetId:e,id:t})=>{qV({type:"REMOVE_MAGIC_SUBTITLE_FRAME",assetId:e,frameId:t})}))}))}));function rj({assetId:e,beforeFrame:t,newTimeFrameRelative:a,newTimeTimelineRelative:o,timeType:n,timelineRelativeEndClipped:r,timelineRelativeStartClipped:i,wordIsClippedList:s}){const l="start"===n?o-i:o-r;if(GV("start"===n?{assetId:e,startTime:o,endTime:o+.001}:{assetId:e,startTime:o-.001,endTime:o})){const o=HV({beforeFrame:t,newTime:Math.max(a,0),timeType:n,wordIsClippedList:s});ZV({updates:o,assetId:e,shouldSync:!0,undoable:!0})}else{const a=Math.max("start"===n?i+l:i,0);oj({assetId:e,startTime:a,endTime:"end"===n?r+l:r,frameId:t.id,wordIsClippedList:s})}}function ij(){const{dispatch:e,state:t}=tn(),{isMobile:a}=t;e(vr(!0)),e(VR({tabContainerId:"media-sidebar",tabId:"Subtitles"})),a&&e(Ag(zV.MEDIA_CONTROLS))}const sj=()=>{var e;const{state:t}=tn(),{selectedItem:a,allLayers:{byId:o}}=t.studio;return o[null!=(e=null==a?void 0:a.id)?e:""]},lj=e=>{const t=sj();if(!t)return;e&&e.preventDefault();const{dispatch:a}=tn();a(Ah(t,!0))},dj=e=>{const t=sj();if(!t)return;e&&e.preventDefault();const{dispatch:a}=tn();a(Ch(t,!0))},cj=e=>{const t=sj();if(!t)return;e&&e.preventDefault();const{dispatch:a}=tn();a(Nh(t,0,!0))},uj=e=>{var t;const a=sj();if(!a)return;e&&e.preventDefault();const{dispatch:o,state:n}=tn(),r=n.studio.scenes[0];let i=r.layers.length-1;"subtitle"===(null==(t=r.layers[i])?void 0:t.type)&&(i=r.layers.findIndex((e=>"subtitle"===e.type))-1),i<0&&(i=0),o(Nh(a,i,!0))},mj=(e,t,a)=>{const{dispatch:o}=tn(),n=z.v4();o(function(e,t,a,o,n){return{type:"SET_TIMELINE_GAP",gapId:e,startTime:t,duration:a,timelineRow:o,undoable:n}}(n,e,t,a,!1)),o(Kh({id:n,type:"gap"}))};function pj(e,t){const{state:a}=tn(),{duration:o}=a.studio.scenes[0],n=o>0,r=[...e];return n&&(null==t||t.length<=1)&&r.push("timing"),{showTiming:n,tabTitles:r}}const hj=(e,t,a)=>{const{dispatch:o}=tn(),n=a||sj();if(n&&n.position){const a=((e,t,a,o)=>{const{x:n,y:r}=QT(e,t),i="120%",s="-50%",l=QT(i,i),d=QT(s,s);return lS(Math.max(Math.min(n+a,l.x),d.x),Math.max(Math.min(r+o,l.y),d.y))})(n.position.x,n.position.y,e,t);o(function(e,t,a,o){return{type:"REPOSITION_LAYER",layer:e,x:t,y:a,undoable:o}}(n,a.xPercent,a.yPercent,!0))}},gj=e=>{hj(0,-1,e)},yj=e=>{hj(0,-10,e)},fj=e=>{hj(0,1,e)},Ej=e=>{hj(0,10,e)},vj=e=>{hj(1,0,e)},wj=e=>{hj(10,0,e)},bj=e=>{hj(-1,0,e)},_j=e=>{hj(-10,0,e)},Tj=e=>{const{dispatch:t}=tn();t(Ng(e))},Sj=Jl.withUndoBatch(((e=!0)=>{const{dispatch:t,state:a,history:{location:o}}=tn(),{studio:n}=a,{selectedItem:r,overlayMounted:i}=n;if(!r)return;if(i)return;if(o.pathname.includes("remove-background"))return;if("layer"===r.type&&YI(r.id)){let o=!1;const n=a.studio.allLayers.byId[r.id],i=ST(),[s]=zS(n);if(dx(n.id).forEach((a=>{a.time===i-s&&(t(NI(n.id,a.channel,a.time,e)),o=!0)})),o)return void t(Kh(null))}const s=Bl(a);switch(r.type){case"group":if(s)return void hW();UV(r.id,e);break;case"layer":{if(s)return void hW();zB({layerIds:[r.id],undoable:e,logEvent:!0});const t=Object.entries(n.groups).filter((e=>e[1].layers.some((e=>e.id===(null==r?void 0:r.id)))));if(t.length>0){const a=t[0][0];yV(r.id,a,e)}break}case"magicSubtitle":Jl.execInUndoBatch((()=>{nj(r.frames),t(Kh(null,!0))}))}})),Ij="WarningEditTextToSpeechOverlay-module_header_knkTq",xj="WarningEditTextToSpeechOverlay-module_details_QLHW4",kj="WarningEditTextToSpeechOverlay-module_buttonsContainer_iqKQ4",Cj="WarningEditTextToSpeechOverlay-module_primaryButton_lEQZ1",Aj="WarningEditTextToSpeechOverlay-module_secondaryButton_sqAp9",Nj=({onClose:e})=>i.createElement(NM,{onClose:e},i.createElement("div",{className:Ij},"Revert to Text Layer"),i.createElement("div",{className:xj},"Editing the text layer will change it back to text, and you can generate Text to Speech after editing."),i.createElement("div",{className:xj},"If you were just trying to drag the text layer, try holding down and not releasing."),i.createElement("footer",{className:kj},i.createElement("div",{className:Aj,onClick:e},"Cancel"),i.createElement("div",{className:Cj,onClick:()=>{const t=sj();t&&px({[t.id]:{ttsAudio:void 0,usedProFeature:""}}),e()},"data-testid":"warning-edit-tts-overlay-submit-button"},"Revert"))),Pj=c((e=>e.activeEditors),(e=>sN(e)),((e,t)=>t.map((e=>e.id)).some((t=>{var a;const o=null==(a=e[t])?void 0:a.editor;return null!=o&&(!o.getSelection().isCollapsed()&&!mL(o))})))),Rj=c((e=>e.activeEditors),(e=>sN(e)),((e,t)=>{var a,o;const n=t.map((e=>e.id)),r=Object.values(s.exports.pick(e,n)).filter((e=>e)).map((e=>{const t=e.editor,a=t.getSelection(),o={uniqueStyles:t.getCurrentInlineStyle(),allStyles:t.getCurrentInlineStyle()};if(a.isCollapsed())return o;const n=[...cL(t.getCurrentContent(),a)].map((e=>e.getStyle()));return o.uniqueStyles=o.uniqueStyles.intersect(...n),o.allStyles=o.uniqueStyles.union(...n),o})),i=r.map((e=>e.allStyles)),l=r.map((e=>e.uniqueStyles));return r.length>0?{allStyles:(null==(a=i[0])?void 0:a.union(...i).toArray())||[],uniqueStyles:(null==(o=l[0])?void 0:o.intersect(...l).toArray())||[]}:{allStyles:[],uniqueStyles:[]}})),Lj=c(Rj,(e=>{const t=e.uniqueStyles.find((e=>e.startsWith("COLOR")));if(t)return t.split("_")[1]})),Dj=e=>c((t=>{var a;return null==(a=t.studio.keyframing)?void 0:a[e]}),(e=>{const t=[];return e?(Object.values(e).forEach((({keyframes:e})=>{t.push(...e)})),t.sort(((e,t)=>e.time-t.time))):t})),Oj=e=>c((t=>{var a;return null==(a=t.studio.keyframing)?void 0:a[e||""]}),(t=>{var a;return null==(a=t.studioLocal.layerTempValues[e||""])?void 0:a.keyframe}),((e,t)=>{if(!e&&!t)return e;const a={...e};return t&&(a[t.channel]={bezArray:null,keyframes:[t]}),a})),Fj=(e,t,a,o)=>{let n=t/a;return"outro"===e.type&&(n=o<=a?o/a:1),n},Mj=e=>({[dn.MagicFade]:{maxAnimationThreshold:.15,minAnimationThreshold:.35,overlapPercent:.6},[dn.MagicFlip]:{maxAnimationThreshold:.01,minAnimationThreshold:.19,overlapPercent:0},[dn.MagicPop]:{maxAnimationThreshold:.01,minAnimationThreshold:.19,overlapPercent:0}}[e]||{maxAnimationThreshold:void 0,minAnimationThreshold:void 0,overlapPercent:0}),Uj=(e,t)=>{const{overlapPercent:a}=Mj(e),o=((e,t)=>{let a=t;if(!a){const{state:e}=tn(),t=mC()(e);a=(null==t?void 0:t.transitionSpeed)||50}const{maxAnimationThreshold:o,minAnimationThreshold:n}=Mj(e);return o&&n?o+(100-a)/100*(n-o):0})(e,t);return{transitionOverlapDuration:a*o,transitionDuration:o}};function Bj(e,t=""){const{state:a}=tn(),{scenes:o,animations:n}=a.studio,r=ST();let i={};const s=b_(e),l=s.find((e=>"intro"===e.type)),d=s.find((e=>"outro"===e.type)),c=s.find((e=>"constant"===e.type)),{start:u,end:m}=e.isTrimmed?Rd(e):Rd(e,o[0].duration),p=r-u,h=l?{start:0,end:Mb(l,n)}:void 0,g=d?{start:m-Mb(d,n)-u,end:m-u}:void 0;if(c){const a=c,o=a.id===dn.ProgressBar&&void 0!==e.endTime&&void 0!==e.startTime?e.endTime-e.startTime:Mb(a,n),r=Fj(a,p,o,m-p);i={...i,...a.animationFunc(r,e,t)}}if(l&&h&&p>=h.start&&p<=h.end){const a=l,o=Mb(a,n),r=Fj(a,p,o,h.end-p);i={...i,...a.animationFunc(r,e,t)}}if(d&&g&&p>=g.start&&p<=g.end){const a=d,o=Mb(a,n),r=Fj(a,p,o,g.end-p);i={...i,...a.animationFunc(r,e,t)}}return i}function Wj(e,t=!0,a="",o){const{state:n}=tn(),{animations:r}=n.studio,i=ST();if(!o||"none"===o.type)return{};const{start:s,end:l}=Rd(e);if(((e,t)=>e&&t<e)(s,i))return{};const d=i-l>=0;if("outro"===o.type&&l&&d)return{};const c=Mb(o,r);let u=i;s&&(u-=s);let m=l-i;if("video"===e.type&&(m=l-i),"outro"===o.type&&m<=c&&(u=m),"intro"===o.type&&u>c||"outro"===o.type&&i<l-c)return{};const p=Fj(o,u,c,m);return o.animationFunc(p,e,a)}function Vj(e,t){const a=t.position||{};a&&delete t.position;const o={...e,...t,...a};return e.WebkitFilter&&t.WebkitFilter&&(o.WebkitFilter=`${t.WebkitFilter} ${e.WebkitFilter}`),e.filter&&(o.WebkitFilter?o.WebkitFilter+=` ${e.filter}`:o.WebkitFilter=e.filter),o}const jj={home:"Layers-module_home_eIN3r",homeHowBackgroundWhite:"Layers-module_homeHowBackgroundWhite_rb29a",largeButton:"Layers-module_largeButton_3zzBV",sectionContent:"Layers-module_sectionContent_dmXy-",sectionHeader:"Layers-module_sectionHeader_uxUJJ",spacer:"Layers-module_spacer_dIOWH",chevron:"Layers-module_chevron_iKP4Q",splashText:"Layers-module_splashText_SYRhV",splashSubtext:"Layers-module_splashSubtext_t05-J",aboutSection:"Layers-module_aboutSection_YUNOE",mobile:"Layers-module_mobile_-DSoC",desktop:"Layers-module_desktop_SEDkV",screenReaderOnlyLabel:"Layers-module_screenReaderOnlyLabel_k-yab",disabled:"Layers-module_disabled_1IFRh",noScrollBar:"Layers-module_noScrollBar_IoLzq",textOverflowEllipsis:"Layers-module_textOverflowEllipsis_dvJ1n",genericButtonBlue:"Layers-module_genericButtonBlue_h0jOj",button:"Layers-module_button_UGm-3",buttonDisabled:"Layers-module_buttonDisabled_6clj6",buttonSelected:"Layers-module_buttonSelected_5uykv",buttonOk:"Layers-module_buttonOk_VnebN",buttonStacked:"Layers-module_buttonStacked_KbIbL",doneButton:"Layers-module_doneButton_SZkk8",desktopNoWrap:"Layers-module_desktopNoWrap_jXks7",mobileNoWrap:"Layers-module_mobileNoWrap_PSBLH",controlSectionContainer:"Layers-module_controlSectionContainer_iJnhC",section:"Layers-module_section_73NJu",input:"Layers-module_input_8a5sX",cyanDoneButton:"Layers-module_cyanDoneButton_g7SAY",cyanDoneButton__disabled:"Layers-module_cyanDoneButton__disabled_U-sXV",cyanDoneButtonContainer:"Layers-module_cyanDoneButtonContainer_oPPdA",genericButton:"Layers-module_genericButton_N-77G",genericButtonSelected:"Layers-module_genericButtonSelected_89ylV",groupControlContainer:"Layers-module_groupControlContainer_khEqy",controlSectionRows:"Layers-module_controlSectionRows_OgJiT",controlSectionRowsTimeline:"Layers-module_controlSectionRowsTimeline_FGf-l",controlSectionRowsTwoPerRow:"Layers-module_controlSectionRowsTwoPerRow_bOVvt",controlSectionRowsExpandChildren:"Layers-module_controlSectionRowsExpandChildren_KnIwL",controlSectionRowsFullWidth:"Layers-module_controlSectionRowsFullWidth_D95Mb",controlSectionRowsNoWrap:"Layers-module_controlSectionRowsNoWrap_hRBLQ",controlSectionRowsNoPadding:"Layers-module_controlSectionRowsNoPadding_Cd84c",controlSectionRowsIconAndControl:"Layers-module_controlSectionRowsIconAndControl_UHK7p",controlSectionWrapColumns:"Layers-module_controlSectionWrapColumns_DwVNt",controlSectionScrollableColumn:"Layers-module_controlSectionScrollableColumn_DCxia",controlSectionTitle:"Layers-module_controlSectionTitle_1MSgo",controlSectionTitleNoPadding:"Layers-module_controlSectionTitleNoPadding_etFGZ",controlSectionDescription:"Layers-module_controlSectionDescription_vvbCv",smallControlButton:"Layers-module_smallControlButton_mGAE9",smallControlButtonDisabled:"Layers-module_smallControlButtonDisabled_MvAbH",smallControlButtonSelected:"Layers-module_smallControlButtonSelected_HeOvT",smallControlButtonLabel:"Layers-module_smallControlButtonLabel_u3hA1",controlSectionRow:"Layers-module_controlSectionRow_So3m0",controlButtonIcon:"Layers-module_controlButtonIcon_R2q6T",controlButtonOnlyIcon:"Layers-module_controlButtonOnlyIcon_EjuTV",controlButtonOnlyIconRoundedSmallTheme:"Layers-module_controlButtonOnlyIconRoundedSmallTheme_v8T75",bigOverlayButton:"Layers-module_bigOverlayButton_RKdLd",bigOverlayButtonSelected:"Layers-module_bigOverlayButtonSelected_Ay5XD",bigOverlayButtonDisabled:"Layers-module_bigOverlayButtonDisabled_cZYv2",bigOverlayButtonIcon:"Layers-module_bigOverlayButtonIcon_82U6a",incrementDecrementControl:"Layers-module_incrementDecrementControl_iv74b",incrementDecrementControlLightTheme:"Layers-module_incrementDecrementControlLightTheme_lG9xA",incrementDecrementControlSmallTheme:"Layers-module_incrementDecrementControlSmallTheme_6St8L",incrementDecrementControlExtraSmallTheme:"Layers-module_incrementDecrementControlExtraSmallTheme_XJ3hW",incrementDecrementButton:"Layers-module_incrementDecrementButton_JdGi4",incrementDecrementButtonLightTheme:"Layers-module_incrementDecrementButtonLightTheme_92-O7",incrementDecrementButtonSmallTheme:"Layers-module_incrementDecrementButtonSmallTheme_Ojws-",incrementDecrementControlValue:"Layers-module_incrementDecrementControlValue_ZBawM",incrementDecrementControlValueSmallTheme:"Layers-module_incrementDecrementControlValueSmallTheme_nRXeL",incrementControl:"Layers-module_incrementControl_F2k0o",decrementControl:"Layers-module_decrementControl_3BAXX",disabledIncrementDecrementButton:"Layers-module_disabledIncrementDecrementButton_HY2MJ",tooltip:"Layers-module_tooltip_wHlTl",selectDropDownContainer:"Layers-module_selectDropDownContainer_HY2IM",selectDropDownDisplay:"Layers-module_selectDropDownDisplay_fghtC",selectDropDownLabel:"Layers-module_selectDropDownLabel_74Z7M",selectDropDownLink:"Layers-module_selectDropDownLink_Xf9fy",selectDropDownList:"Layers-module_selectDropDownList_ftwm6",selectDropDownItem:"Layers-module_selectDropDownItem_spfT6",bottomDivider:"Layers-module_bottomDivider_UBaV8",selectDropDownItemSelected:"Layers-module_selectDropDownItemSelected_Ww2JN",selectDropDownShowing:"Layers-module_selectDropDownShowing_niCYf",dropDownButtonIcon:"Layers-module_dropDownButtonIcon_ascFz",selectOptionIcon:"Layers-module_selectOptionIcon_-JNSK",transparentSelectInput:"Layers-module_transparentSelectInput_oAixw",selectOptionContainer:"Layers-module_selectOptionContainer_BotTo",dropDownHeader:"Layers-module_dropDownHeader_4kW21",noMargin:"Layers-module_noMargin_k-KXh",halfWidth:"Layers-module_halfWidth_OM7Wh",fullWidth:"Layers-module_fullWidth_gj82w",selectDropDownIcon:"Layers-module_selectDropDownIcon_A-RSe",controlButtonsContainer:"Layers-module_controlButtonsContainer_fbWKw",loadingIcon:"Layers-module_loadingIcon_CFsaY",spin:"Layers-module_spin_HVCp8",iconAndLabelRow:"Layers-module_iconAndLabelRow_VnALb",dropdownDirectInput:"Layers-module_dropdownDirectInput_CmtsB",backgroundTransparencyGrid:"Layers-module_backgroundTransparencyGrid_5rUUz",background:"Layers-module_background_8DMmp",disableselect:"Layers-module_disableselect_E-qba",text:"Layers-module_text_um0Ln",imageContainer:"Layers-module_imageContainer_eCzlm",image:"Layers-module_image_Ef6KM",videoContainer:"Layers-module_videoContainer_z7Msk",video:"Layers-module_video_Tqu1w",videoConversion:"Layers-module_videoConversion_hiekj",outline:"Layers-module_outline_OSXmE",editorWrapperEditing:"Layers-module_editorWrapperEditing_W3B0C",svgContainer:"Layers-module_svgContainer_fPoIR",svgLine:"Layers-module_svgLine_IVz1N"},Gj=({width:e,height:t,editorWidth:a,editorHeight:o,textWithLineBreaks:n,fontSize:s,textScale:l,layer:d,animStyles:c,viewOnly:u})=>{var m;const p=r.exports.useRef(),{borderRadiusTemp:h,globalAlphaTemp:g,textPaddingTemp:y}=tr((e=>e.studioLocal.layerTempValues[d.id]))||{},{relative:f=0}=h||d.borderRadius||{},E=d.textTransform||"none";let v=n||"";"uppercase"===E?v=v.toLocaleUpperCase():"lowercase"===E&&(v=v.toLocaleLowerCase());const w=d.backgroundColor,b="wrap"===d.wrapOrFill,_=f||"0%",T=d.textAlign||"center",S=Rx(d,d.fallbackFonts||[]),I=d.italic?"italic":"normal",{fontWeight:x}=d,k=null!=g?g:d.globalAlpha,C=null!=(m=null!=y?y:d.textPadding)?m:0,A=b?o/v.split("\n").length:Math.min(e,t),N=C*A/100,P=N;return r.exports.useEffect((function(){if(!p.current)return;const a=p.current;a.width=e+N+N+P+P,a.height=t+N+N+P+P;const o=a.getContext("2d");if(!o)return;if(e<=0&&t<=0)return;const n=window.devicePixelRatio;a.width*=n,a.height*=n,o.scale(n,n),o.save(),o.clearRect(0,0,a.width,a.height),o.globalAlpha=c.opacity?+c.opacity:k,o.translate(N+P,N+P),o.font=`${I} normal ${x} ${s}px ${S}`;let r=[];if(d.isMagicSubtitle){const e=d;r=e.frame.lines.map((t=>[t.words.map((e=>e.text)).join(e.wordSeparator),t.width]))}else{r=v.replaceAll("\r","").split("\n").map((e=>[e,o.measureText(e).width*l]))}const i=r.map((([e,t])=>t)),u=t/r.length;b?dk(o,i,s,d,e,t,u,0,_,C):sk(o,d,e,t,_,C),o.restore()}),[v,w,b,e,t,a,o,T,E,_,s,S,x,I,l,k,d,N,C,P,null==c?void 0:c.opacity]),i.createElement("canvas",{"data-cy":u?"text-background-view-only":"text-background",style:{width:e+N+N+P+P,height:t+N+N+P+P,position:"absolute",top:0,left:0,marginTop:-N-P,marginLeft:-N-P,transformOrigin:"0px 0px",...c},ref:e=>{e&&(p.current=e)}})};let Hj;const zj=({style:e,layer:t,studioTime:a})=>{var o;const n=r.exports.useRef(null),{animationName:s="",wordByWordStyles:l={}}=t.wordByWordAnimations||{},{active:d,unspoken:c}=l[s]||{},u=tr((e=>e.studioLocal.magicSubtitleSelection)),m=u&&u.cleanSelectionStart!==u.cleanSelectionEnd,p=r.exports.useMemo((()=>{if(""===t.wordSeparator)return 0;const e=Lx(t,t.fontSize),a=function(e,t){Hj||(Hj=document.createElement("canvas"));const a=Hj.getContext("2d");return a.font=t,a.measureText(e).width}(t.wordSeparator,e);return Math.floor(a)}),[t]),h=((null==(o=n.current)?void 0:o.getBoundingClientRect().width)||p)/2,{lines:g}=t.frame;return i.createElement("span",null,g.map(((o,r)=>i.createElement("span",{key:`line-${r}`,style:{...e,display:"block",whiteSpace:"nowrap"},className:"magic-text__line",dir:t.isRTL?"rtl":"ltr"},0===o.words.length&&i.createElement("span",{style:{paddingLeft:h,paddingRight:h,zIndex:r}}),o.words.map(((e,p)=>{var g,y;const{styles:f,className:E,isActive:v,isUnspoken:w}=((e,t,a,o)=>{const{active:n,spoken:r,unspoken:i,inactive:s}=t||{},l=a<e.start,d=a>=e.start,c=!!o&&a>=e.start&&a<e.end,u=[];let m={position:"relative"};return!c&&(u.push("magic-text__inactive"),m={...m,...s}),l&&(u.push("magic-text__unspoken"),m={...m,...i}),d&&(u.push("magic-text__spoken"),m={...m,...r}),c&&(u.push("magic-text__active"),m={...m,...n}),{styles:m,className:u.join(" "),isActive:c,isUnspoken:l}})(e,l[s]||{},a,s),b=0===p,_=p===o.words.length-1,T=t.isRTL?b:_;let S={};const I=t.isRTL?p-1:p+1,x=o.words[I];if(!T&&t.wordSeparator&&x){const a=t.isRTL?x.text.length-1:0,o=null==(g=null==x?void 0:x.styles)?void 0:g[a],n=t.isRTL?0:e.text.length-1,r=null==(y=e.styles)?void 0:y[n];S=ak(t,r,o),v&&(S.bottom=(null==c?void 0:c.bottom)||0,S.color=(null==S?void 0:S.color)||t.color),!m&&w&&"transparent"===(null==c?void 0:c.color)&&(S.color="transparent")}const k=a=>{const o="start"===a?e.charOffset-1:e.charOffset+e.text.length+1,s=u&&u.cleanSelectionStart<o&&u.cleanSelectionEnd>=o;return i.createElement("span",{key:`line-${p}-separator`,className:"magic-text__word-separator",ref:n,style:{...f,...S,display:"initial",borderRadius:0,backgroundColor:"transparent",zIndex:r+1,...s?{backgroundColor:"rgba(80, 108, 147, 0.9)"}:{}}},i.createElement("span",null,t.wordSeparator))};return i.createElement(i.Fragment,{key:`line-${p}`},t.isRTL&&!b&&t.wordSeparator&&k("start"),i.createElement("span",{key:`line-${p}`,style:{...f,marginLeft:-h,marginRight:-h,paddingLeft:h,paddingRight:h,zIndex:r},className:`magic-text__word ${E}`},e.splitTextByStyle.map(((e,a)=>{const o=e.styles||{index:-1},n={...f,...o,color:v&&!e.isSelected&&(null==d?void 0:d.color)?f.color:o.color||f.color,borderRadius:0,backgroundColor:void 0};t.underline&&"none"!==o.textDecoration&&(n.textDecoration="underline"),!m&&w&&"transparent"===(null==c?void 0:c.color)&&(n.color="transparent"),m&&"transparent"===n.color&&(n.color=o.color||t.color);const r=[];return e.isSelected&&(n.backgroundColor="rgba(80, 108, 147, 0.9)"),i.createElement(i.Fragment,{key:`line-${p}-${a}`},t.textOutline&&i.createElement("span",{style:{...n,WebkitTextStroke:"none"===f.textShadow?void 0:`${Kx(t,t.fontSize)}px ${t.textOutline.color}`,position:"absolute"},className:`magic-text__char ${r.join(" ")}`},e.text),i.createElement("span",{style:n,className:`magic-text__char ${r.join(" ")}`},e.text))}))),!t.isRTL&&!_&&t.wordSeparator&&k("end"))}))))))},$j=()=>{},Kj=s.exports.memoize(zS),Yj=e=>e&&["middleLeft","middleRight"].includes(e);class qj extends r.exports.Component{constructor(e){super(e),a(this,"editor",i.createRef()),a(this,"hiddenEditorContainer",i.createRef()),a(this,"hiddenEditor",i.createRef()),a(this,"container",i.createRef()),a(this,"_mounted",!1),a(this,"selectionIndices",null),a(this,"tmpInput",null),a(this,"backspacePressed",!1),a(this,"backspaceLinebreakPressed",!1),a(this,"clickCount",0),a(this,"clickTimeout",null),a(this,"previousSelectionIndices"),a(this,"checkedForOutsideCanvas",!1),a(this,"cursorHistory",{current:-1,undoStack:[],redoStack:[]}),a(this,"customStyleMap",{}),a(this,"shouldUpdateTextBlocks",!1),a(this,"undoFocusLock",!1),a(this,"moveCursorToEnd",!1),a(this,"recomputeTextWithLineBreaks",(e=>{const{layer:t,width:a,height:o}=this.props;if(t.isMagicSubtitle)return;const n=e||t.fontSize||1,{baseWidth:r}=t,i=nV(a,r)*n,{textWithLineBreaks:s}=sV(t,a,t.text,i),l=(t.lineHeight||1)*i,d=s.split("\n").length*l,c=t.text!==s,u=d>1&&o!==d;if(c&&(px({[t.id]:{text:s,textWithLineBreaks:s}}),KT(t.id,{textTemp:s})),c||u){const e=cS(t);if(e){const a=e.height-d,o=e.y+a/2,n={...e,y:o,height:d};dS(t,n)}}})),a(this,"parseEditorSize",(()=>{if(!(this.hiddenEditorContainer.current&&this.hiddenEditor.current&&this.container.current&&this._mounted))return null;const e=this.container.current.style.transform;this.container.current.style.transform="none";const t=this.hiddenEditorContainer.current.style.display;this.hiddenEditorContainer.current.style.display="flex";const{width:a,height:o}=this.hiddenEditor.current.editor.getBoundingClientRect();if(this.container.current.style.transform=e,this.hiddenEditorContainer.current.style.display=t,!a||!o)return null;return{editorWidth:a,editorHeight:o}})),a(this,"handleSelectionState",(e=>{if(this.previousSelectionIndices&&!mL(e)){const[t,a]=this.previousSelectionIndices;if(t<a){const o=e.getCurrentContent(),n=gL(o,t,a);if(n){const{isEditing:t,layer:a}=this.props;return t||KT(a.id,{isEditing:!0}),Y.EditorState.forceSelection(e,n)}}}return e})),a(this,"updateLayerHeightForText",((e,t,a)=>{const{fontSizingTemp:o,layer:n,width:r,y:i}=this.props,s=cS(n),l=s?nV(n.baseWidth,s.width):1,d=((null==o?void 0:o.fontSize)||n.fontSize||1)/l,c=(n.lineHeight||1)*d,u=e.split("\n").length*c;if(s){const e={...s,width:r,height:u,y:i};dS(n,e,t,a)}return u})),a(this,"updateEditorTextWithLineBreaks",((e,t,a,o)=>{var n;const{isEditing:r,isSelected:i}=this.props,s=yL(e);let l=((e,t)=>{const a=e.getCurrentContent(),o=uL(a);return Y.Modifier.replaceText(a,o,t)})(e,t);const d=l.getPlainText(),c=e.getCurrentContent(),u=cL(c,uL(c)),m=e=>["\n","\r"].includes(e),p="\n"===this.tmpInput;let h=0;for(let y=0;y<s.length;y+=1){const e=s.charAt(y);let t=0;p&&this.selectionIndices&&this.selectionIndices[0]<=y&&(t=-1);let a=Math.max(y+t,0);if(a>=u.length&&(a=u.length-1),h>=d.length)break;let o=d.charAt(h);for(;m(o)&&h<d.length-1;){if(a-1>=0){u[a-1].getStyle().toArray().forEach((e=>{l=fL(l,h,e)}))}h+=1,o=d.charAt(h)}const n=u[a];if(n&&o===e){n.getStyle().toArray().forEach((e=>{l=fL(l,h,e)})),h+=1}}let g=Y.EditorState.push(e,l,"insert-characters");if((a||o||this.backspacePressed)&&(g=Y.EditorState.set(g,{undoStack:e.getUndoStack(),redoStack:e.getRedoStack()})),Yj(this.props.nodePosition)||!r&&!i||this.moveCursorToEnd)g=Y.EditorState.moveSelectionToEnd(g),this.moveCursorToEnd=!1;else if(this.selectionIndices&&!a&&!o&&r){let e=(null==(n=this.tmpInput)?void 0:n.length)||0,a=this.selectionIndices[0];if(a>0&&!p){const e=(e=>e.replaceAll("\r\n","").replaceAll("\n",""))(s.substring(0,a));let o=0;for(let n=0;n<t.length&&o<e.length;n+=1){m(t.charAt(n))||(a=n+1,o+=1)}}if(this.backspacePressed)for(;a<this.selectionIndices[0];){if(!m(t.charAt(a)))break;a+=1}else if(p)a+=1;else for(;e>0;){m(t.charAt(a))||(e-=1),a+=1}a=Math.min(a,t.length),g=hL(g,a),this.cursorHistory.undoStack.push(this.cursorHistory.current),this.cursorHistory.redoStack=[],this.cursorHistory.current=a}else if(r){let e=-1;a&&this.cursorHistory.undoStack?(this.cursorHistory.redoStack.push(this.cursorHistory.current),e=this.cursorHistory.undoStack.pop()):o&&this.cursorHistory.redoStack&&(this.cursorHistory.undoStack.push(this.cursorHistory.current),e=this.cursorHistory.redoStack.pop()),e<0&&(e=t.length);const n=Math.min(e,t.length);g=hL(g,n),this.cursorHistory.current=n}return this.selectionIndices=null,this.tmpInput=null,this.backspacePressed=!1,this.backspaceLinebreakPressed=!1,g})),a(this,"getCurrentPosition",(()=>{const{x:e,y:t,width:a,height:o,rotation:n}=this.props,{xPercent:r,yPercent:i}=lS(e,t),{widthPercent:s,heightPercent:l}=nS(a,o);return{x:r,y:i,width:s,height:l,rotation:n||0}})),a(this,"updateTextBlocks",(()=>{if(this.props.viewOnly)return void(this.shouldUpdateTextBlocks=!1);if(!(this.container.current&&this.hiddenEditorContainer.current&&this.props.editorState&&this._mounted))return;const e=this.container.current.style.transform;this.container.current.style.transform="none";const t=this.hiddenEditorContainer.current.style.display;this.hiddenEditorContainer.current.style.display="flex";const a=Fx(this.container.current,this.hiddenEditorContainer.current);this.container.current.style.transform=e,this.hiddenEditorContainer.current.style.display=t;if(a.some((e=>Object.values(e.position).some((e=>null==e||Number.isNaN(e))))))return;const o=JSON.stringify(this.props.layer.textBlocks),n=JSON.stringify(a);this.shouldUpdateTextBlocks=!1,o!==n&&px({[this.props.layer.id]:{textBlocks:a}},!1)})),a(this,"refreshEditorState",(e=>{const{layer:t,editorState:a}=this.props;if(null!=a&&"refresh"!==e){const o=this.convertLayerToContentState(t);return Y.EditorState.push(a,o,e)}return this.getEditorStateFromLayer(t)})),a(this,"getEditorStateFromLayer",(e=>{const t=Y.EditorState.createWithContent(this.convertLayerToContentState(e));return Y.EditorState.set(t,{allowUndo:!0})})),a(this,"convertLayerToContentState",(e=>{const{isCanvasPreview:t,viewOnly:a}=this.props;if(e.draftJSTextTree)return Y.convertFromRaw(e.draftJSTextTree);let o=Y.ContentState.createFromText(e.text);if(t)return o;const n=uL(o);return"bold"===e.fontWeight&&(o=Y.Modifier.applyInlineStyle(o,n,"BOLD")),e.italic&&(o=Y.Modifier.applyInlineStyle(o,n,"ITALIC")),e.underline&&(o=Y.Modifier.applyInlineStyle(o,n,"UNDERLINE")),e.color&&(o=Y.Modifier.applyInlineStyle(o,n,`COLOR_${e.color}`)),t||e.isMagicSubtitle||a||px({[e.id]:{draftJSTextTree:Y.convertToRaw(o)}}),o})),a(this,"getRotateWrapperStyles",(()=>{const{width:e,height:t,x:a,y:o,rotation:n}=this.props;return{position:"absolute",left:a,top:o,transform:`rotate(${n}deg)`,width:e,height:t}})),a(this,"getTextStyles",(()=>{var e,t,a,o,n;const{layer:r,staticPreview:i,duration:s,globalAlphaTemp:l,viewOnly:d,width:c,height:u,studioTime:m,textBlurTemp:p,textShadowBlurTemp:h,textShadowDistTemp:g,textShadowRotTemp:y,fontSizingTemp:f,magicAssetId:E,keyframeChannels:v}=this.props,[w,b]=this.props.absoluteTimes,{textAlign:_,textBlur:T,textEffect:S,textEffectColor:I,textShadowBlur:x,textShadowDist:k,textShadowRot:C,isMagicSubtitle:A}=r,N=!i&&!(w<=m&&m<=b)&&!A,P=nV(c,(null==f?void 0:f.baseWidth)||r.baseWidth);let R=.005,{fontSize:L}=f||r;L&&(L*=P,R*=L),R=Math.max(1,R);const D=!!(null==v?void 0:v[Sn.OPACITY]);let O=r.globalAlpha;D&&(O=Kb(r,v,m).opacity/100),null!=l&&(O=l);let F={position:"absolute",marginLeft:"auto",marginRight:"auto",marginTop:"auto",marginBottom:"auto",pointerEvents:d?"none":"unset",fontSize:L,font:Lx(r,L,r.fallbackFonts),textAlign:r.textAlign,textTransform:r.textTransform,color:r.color,opacity:O,textDecoration:!r.isMagicSubtitle&&r.underline?"underline":void 0,transform:""};if(r.textShadow?F.textShadow=`-${R}px -${R}px 0 ${r.textShadow}, ${R}px -${R}px 0 ${r.textShadow}, -${R}px ${R}px 0 ${r.textShadow}, ${R}px ${R}px 0 ${r.textShadow}`:F.textShadow="",F.fontDisplay="swap",S){if("dropShadow"===S){const a=null!=h?h:x,o=null!=(e=null!=g?g:k)?e:0,n=(null!=(t=null!=y?y:C)?t:0)*Math.PI/180,r=o*Math.cos(n),i=o*Math.sin(n),s=F.textShadow?", ":"";F.textShadow+=`${s}${r}em ${i}em ${a}em ${I}`}if("textBlur"===S){const{fontSize:e}=r;if(e){const t=.2*e*+(p||T||.2);F.filter=`blur(${t}px)`}}}let M="center";"left"===(null==(a=r.textAlign)?void 0:a.toLowerCase())?M="flex-start":"right"===(null==(o=r.textAlign)?void 0:o.toLowerCase())&&(M="flex-end"),F={...F,display:N?"none":"flex",transformOrigin:"0px 0px",width:c,height:u,alignItems:"center",justifyContent:M};const U=w_(r);let B={},W=F;if(A||!i&&s&&"none"!==(null==U?void 0:U.id)){B=A?function(e,t,a){const o=null!=a?a:ST(),{transition:n}=t;if(!n||!n.transitionId)return{};const r=c_[n.transitionId];return r&&r.animationFunc?r.animationFunc(o,t,e):{}}(E,r,this.props.studioTime):Bj(r);let{transform:e}=F;B&&"transform"in B&&(e=`${F.transform} ${B.transform}`),W=Vj(F,B),W.transform=e}const V={};A&&(V.flexDirection="column",V.justifyContent="center","left"===(null==_?void 0:_.toLowerCase())?V.alignItems="flex-start":"right"===(null==_?void 0:_.toLocaleLowerCase())&&(V.alignItems="flex-end")),D&&(B.opacity=F.opacity);const j={WebkitTextStroke:`${Kx(r,null!=L?L:0)}px ${null==(n=r.textOutline)?void 0:n.color}`};return r.textOutline&&!r.isMagicSubtitle&&(j.textShadow=W.textShadow,W.textShadow=""),{animTextStyles:W,animStyles:B,rawTextStyles:F,textOutlineStyles:j,magicTextStyles:V}})),a(this,"handleBeforeInput",((e,t)=>{const{isCanvasPreview:a}=this.props;if(a)return"not-handled";const[o,n]=this.selectionIndices||pL(t);return this.selectionIndices||(this.selectionIndices=[o,n]),this.tmpInput=e,"not-handled"})),a(this,"handleClick",(()=>{if(this.clickCount+=1,this.clickTimeout&&clearTimeout(this.clickTimeout),this.clickTimeout=setTimeout((()=>{this.clickCount=0}),250),3===this.clickCount&&this.props.editorState){const e=(e=>{const t=e.getCurrentContent(),a=uL(t);return Y.EditorState.forceSelection(e,a)})(this.props.editorState);this.props.updateActiveEditor({id:this.props.layer.id,editor:e})}const{layer:e,selectItem:t}=this.props;e.locked&&t(null)})),a(this,"handlePastedText",((e,t,a)=>(this.selectionIndices=pL(a),this.tmpInput=e,"not-handled"))),a(this,"handleEditorChange",(e=>{var t;const{layer:a,textTemp:o,updateActiveEditor:n,fontSizingTemp:r,width:i,editorState:s}=this.props;if(Td(a))return;let l=yL(e);if(s&&!this.tmpInput){const e=yL(s);if(e.length<l.length&&l.includes("  "))return this.selectionIndices=pL(s),void n({id:a.id,editor:this.updateEditorTextWithLineBreaks(s,e)})}n({id:a.id,editor:e});const d=this.selectionIndices&&this.tmpInput,[c,u]=d?this.selectionIndices:pL(e);if(this.selectionIndices=[c,u],s&&(null==(t=this.tmpInput)?void 0:t.includes("\n"))){const e=s.getCurrentContent().getPlainText(),t=e.substring(0,c),a=e.substring(u);l=t+this.tmpInput+a}if(this.backspaceLinebreakPressed){"\r"===l.charAt(c-1)&&c>2&&(l=l.substring(0,c-2)+l.substring(c),this.selectionIndices=[c-2,c-2]),this.backspaceLinebreakPressed=!1}const m=nV(i,(null==r?void 0:r.baseWidth)||a.baseWidth)*((null==r?void 0:r.fontSize)||a.fontSize||0),{textWithLineBreaks:p}=sV(a,i,l,m);o!==p&&KT(a.id,{textTemp:p}),this.shouldUpdateTextBlocks=!0})),a(this,"handleKeyBindingFn",(e=>"Escape"===e.key?"escape-editor":("Enter"===e.key&&(this.tmpInput="\n"),Y.getDefaultKeyBinding(e)))),a(this,"handleKeyCommand",((e,t)=>{var a;const[o,n]=pL(t);if(this.selectionIndices=[o,n],"delete"===e){const e=yL(t);if(e.length>o+2){const t=e.charAt(o+1),a=e.charAt(o+2);"\r"===t&&"\n"===a&&(this.backspaceLinebreakPressed=!0)}}if("backspace"===e){const e=yL(t);if(e.length>0&&o>0&&(this.backspacePressed=!0),n-o<=1&&o>0){this.selectionIndices=[o-1,o-1];const t=e.charAt(o-1),a=e.charAt(o-2);"\n"===t&&"\r"===a&&(this.backspaceLinebreakPressed=!0)}}if("escape-editor"===e){null==(a=this.editor.current)||a.blur();const e=yL(t);return cV(this.props.layer,e),"handled"}const r=Y.RichUtils.handleKeyCommand(t,e);return r?(this.handleEditorChange(r),"handled"):"not-handled"})),a(this,"customEditorBlockStyle",(e=>"")),a(this,"getEditorWrapperClassName",(()=>{const{isSelected:e,isCanvasPreview:t,isEditing:a}=this.props;return a&&e&&!t?jj.editorWrapperEditing:""})),a(this,"onEditorFocus",(()=>{var e;if(this.undoFocusLock)return void(null==(e=document.activeElement)||e.blur());const{layer:t,isSelected:a,isEditing:o,selectItem:n}=this.props;a||n({id:t.id,type:"layer"}),o||(Td(t)?this.setState({showWarningOverlay:!0}):uV(t))})),a(this,"onEditorBlur",(()=>{var e;const{layer:t,editorState:a}=this.props;null==(e=document.activeElement)||e.blur();const o=null==a?void 0:a.getCurrentContent().getPlainText();cV(t,o)})),this.state={showWarningOverlay:!1}}componentDidMount(){const{isCanvasPreview:e,layer:t,width:a,height:o,textLayerIDsAddedInSession:n,mountActiveEditor:r,magicAssetId:i}=this.props,s=[];let l=t.fontSize||1;const d=gB(this.props.layer);if(e){if(i){d&&s.push(d),s.push({type:"default",fontFamily:"Noto Sans"});const e=H(t.text);s.push(...e.map((e=>({type:"default",fontFamily:e}))))}}else t.fontSize&&t.baseWidth&&t.baseHeight||(l=pV(t,a,o,!1)||l),"string"==typeof t.fontSize&&(l=parseFloat(t.fontSize),px({[t.id]:{fontSize:l}})),d&&s.push(d),s.push({type:"default",fontFamily:"Noto Sans"}),s.push(...(t.fallbackFonts||[]).map((e=>({type:"default",fontFamily:e}))));if(s.length>0){Promise.all(s.map((e=>mB(e)))).then((r=>{r.some((e=>e.firstLoad))&&(e||null!=t.baseWidth&&t.fontSize||!n.includes(t.id)||(l=pV(t,a,o,!1)||l),this.recomputeTextWithLineBreaks(l))})).catch((e=>{console.error("error loading fonts",t.fontFamily,...t.fallbackFonts||[]),console.error(e)}))}if(r({id:t.id,editor:this.getEditorStateFromLayer(t)}),this._mounted=!0,this.editor.current){const e=this.editor.current,t=e._onInput;e._onInput=function(a){const o="historyRedo"===a.nativeEvent.inputType||"historyUndo"===a.nativeEvent.inputType,{anchorNode:n,focusNode:r}=global.getSelection()||{};o&&(null!=n&&!e.editor.contains(n)||null!=r&&!e.editor.contains(r))||t.call(this,a)}}}componentDidUpdate(e,t){var a,o,n,r;const{historyIndex:i,lastUndoTimestamp:l,isCanvasPreview:d,isEditing:c,isSelected:u,layer:m,refreshKey:p,beingTransformed:h,mountActiveEditor:g,x:y,y:f,width:E,height:v,rotation:w,textTemp:b,fontSizingTemp:_,updateActiveEditor:T,editorState:S,editorStateSync:I,unmountActiveEditor:x,usedUndo:k,nodePosition:C,selectedLayersLength:A,absoluteTimes:[N,P],studioTime:R,staticPreview:L}=this.props;if(this.shouldUpdateTextBlocks&&setTimeout((()=>{this.updateTextBlocks()}),100),!this.checkedForOutsideCanvas&&S&&(null==(a=this.container.current)?void 0:a.clientWidth)){this.checkedForOutsideCanvas=!0;(null==(o=m.textBlocks)?void 0:o.some((e=>e.position.bottom<0)))&&this.syncToLayer(S)}m.id!==e.layer.id&&(x(e.layer.id),g({id:m.id,editor:this.getEditorStateFromLayer(m)}));if(!(!L&&!(N<=R&&R<=P))){const e=this.parseEditorSize();!e||(null==e?void 0:e.editorHeight)===t.editorHeight&&(null==e?void 0:e.editorWidth)===t.editorWidth||this.setState(e)}if(d)return;const D=e.historyIndex!==i,O=e.lastUndoTimestamp!==l;if(D||O){this.shouldUpdateTextBlocks=!0,this.undoFocusLock=!0,KT(m.id,{positionTemp:void 0,fontSizingTemp:void 0,textTemp:void 0});const e=this.refreshEditorState(k?"undo":"redo");return T({id:m.id,editor:e}),void setTimeout((()=>{this.undoFocusLock=!1}),100)}if(e.refreshKey!==p&&!h&&!c){KT(m.id,{positionTemp:void 0,fontSizingTemp:void 0,textTemp:void 0});const e=this.refreshEditorState("refresh");return void T({id:m.id,editor:e})}let F=S;if(!F)return;const M=m.textBlocks!==e.layer.textBlocks,U=c!==e.isEditing;u&&!c&&!h&&e.editorState&&(M||U)&&(this.previousSelectionIndices=pL(e.editorState),F=this.handleSelectionState(F));const B=u!==e.isSelected;!u&&B&&(this.onEditorBlur(),this.previousSelectionIndices=void 0);const W=c&&!e.isEditing,V=h&&!e.beingTransformed;if(W||V)return this.cursorHistory={current:-1,undoStack:[],redoStack:[]},F=Y.EditorState.set(F,{undoStack:F.getUndoStack().clear(),redoStack:F.getRedoStack().clear()}),W?F=this.previousSelectionIndices?this.handleSelectionState(F):Y.EditorState.moveFocusToEnd(F):V&&(F=Y.EditorState.moveSelectionToEnd(F)),T({id:m.id,editor:F}),void(this.previousSelectionIndices=void 0);const j=E!==e.width,G=v!==e.height;if(h&&(j||G)&&!Yj(C)){const e=F.getCurrentContent().getPlainText();!function(e,t,a,o,n){const r=XW(void 0!==o?{...e,text:o}:e,t,a);if(!r)return;const i={fontSize:r,baseWidth:t,baseHeight:a};s.exports.isEqual(n,i)||KT(e.id,{fontSizingTemp:i})}(m,E,v,e,_)}m.fontSize||pV(m,E,v,!1);if(e.layer.fontFamily!==m.fontFamily||!s.exports.isEqual(e.layer.fallbackFonts,m.fallbackFonts)){this.moveCursorToEnd=!0;const e=Nx(this.props.layer);return void Promise.all([...e?[e]:[],...(m.fallbackFonts||[]).map((e=>({type:"default",fontFamily:e})))].map((e=>mB(e)))).then((()=>{setTimeout((()=>{this.recomputeTextWithLineBreaks()}),0)}),(e=>{console.error("error loading fonts",m.fontFamily,...m.fallbackFonts||[]),console.error(e)}))}if(m.lineHeight!==e.layer.lineHeight){const e=b||m.text,t=cS(m),a=t?nV(m.baseWidth,t.width):1,o=((null==_?void 0:_.fontSize)||m.fontSize||1)/a,n=this.updateLayerHeightForText(e,!0);return KT(m.id,{fontSizingTemp:{fontSize:o,baseWidth:E,baseHeight:n}}),void setTimeout((()=>{const{editorState:e}=this.props;this._mounted&&e&&this.syncToLayer(e)}),100)}const H=e.textTemp!==b;if(b&&H){const t=b,a=F.getUndoStack().size,o=null==(n=e.editorState)?void 0:n.getUndoStack().size,i=!!o&&a===o-1,s=!h&&c&&i,l=F.getRedoStack().size,d=null==(r=e.editorState)?void 0:r.getRedoStack().size,u=!!d&&l===d-1,p=!!this.tmpInput||!!this.backspacePressed,g=!h&&c&&u&&!p,y=b.replaceAll("\r","").replaceAll("\n","");"Sample text"===m.text&&""===m.textWithLineBreaks&&"Sample text"===y&&(this.moveCursorToEnd=!0),F=this.updateEditorTextWithLineBreaks(F,t,s,g),!h&&c&&this.updateLayerHeightForText(t,!0)}e.layer.textTransform!==this.props.layer.textTransform&&(this.moveCursorToEnd=!0,this.recomputeTextWithLineBreaks()),F!==S&&T({id:m.id,editor:F}),this.selectionIndices=null,this.tmpInput=null,this.backspacePressed=!1,this.backspaceLinebreakPressed=!1;const z=cS(m);let $=!1;const K=1!==A;if(z&&!K){const e=y!==z.x,t=f!==z.y,a=e||t,o=E!==z.width,n=v!==z.height,r=o||n,i=w!==z.rotation;$=a||r||i}const q=yL(F)!==m.text,X=!h&&e.beingTransformed&&$,J=!c&&e.isEditing&&q,Q=e.editorStateSync!==I,Z=e.layer.textAlign!==m.textAlign;if(X||J||Q||Z){const e=!Z;this.syncToLayer(F,e)}else null==m.textBlocks&&setTimeout((()=>{const{editorState:e}=this.props;this._mounted&&(K?this.updateTextBlocks():e&&this.syncToLayer(e,!1))}),100);J&&(this.cursorHistory={current:-1,undoStack:[],redoStack:[]})}componentWillUnmount(){const{layer:e,unmountActiveEditor:t,editorState:a,isCanvasPreview:o,isEditing:n}=this.props;!o&&a&&n&&this.syncToLayer(a);const r=null==a?void 0:a.getCurrentContent().getPlainText();cV(e,r),t(e.id),this._mounted=!1}syncToLayer(e,t=!0){var a;const{layer:o,fontSizingTemp:n,inlineStyles:r,isCanvasPreview:i,viewOnly:s}=this.props;if(!e||!this._mounted||o.isMagicSubtitle||i||s)return;const{position:l}=o;if("object"!=typeof l)return;let d=e.getCurrentContent();d=Y.Modifier.removeInlineStyle(d,uL(d),"persistent_selection");const c=d.getPlainText(),u=Y.convertToRaw(d),m=H(c),p={draftJSTextTree:u,text:c,textWithLineBreaks:c,fallbackFonts:m.length?m:void 0,fontSize:(null==n?void 0:n.fontSize)||o.fontSize,baseWidth:(null==n?void 0:n.baseWidth)||o.baseWidth,baseHeight:(null==n?void 0:n.baseHeight)||o.baseHeight,position:this.getCurrentPosition(),italic:r.unique.includes("ITALIC"),fontWeight:r.unique.includes("BOLD")?"bold":"normal",underline:r.unique.includes("UNDERLINE"),color:(null==(a=r.unique.find((e=>e.startsWith("COLOR"))))?void 0:a.slice("COLOR".length+1))||o.color};px({[o.id]:p},t),KT(o.id,{positionTemp:void 0,fontSizingTemp:void 0,textTemp:void 0}),this.shouldUpdateTextBlocks=!0}createInlineStyles(){const{editorState:e,inlineStyles:t}=this.props,{customStyleMap:a}=this;if(null==e)return a;const o=t.all.filter(Mx).filter((e=>!a[e]));if(0===o.length)return a;const n={...a};for(const r of o)n[r]=Ux(r);return this.customStyleMap=n,n}render(){const{viewOnly:e,layer:t,editorState:a=Y.EditorState.createEmpty(),isEditing:o,width:n,height:r,fontSizingTemp:s,magicAssetId:l}=this.props,{editorWidth:d,editorHeight:c}=this.state,u=this.createInlineStyles(),{animTextStyles:m,animStyles:p,rawTextStyles:h,magicTextStyles:g,textOutlineStyles:y}=this.getTextStyles(),f=nV(n,(null==s?void 0:s.baseWidth)||t.baseWidth),E=(null==s?void 0:s.fontSize)||t.fontSize||1;if(this.state.showWarningOverlay)return i.createElement(Nj,{onClose:()=>this.setState({showWarningOverlay:!1})});const v=Y.EditorState.set(a,{forceSelection:!1});let w=a.getCurrentContent().getPlainText();!w&&t.isMagicSubtitle&&(w=t.text);const b=t.isMagicSubtitle&&l;return i.createElement("div",{style:this.getRotateWrapperStyles(),className:this.getEditorWrapperClassName(),"data-cy":e?"canvasTextViewOnly":"canvasText","data-test":m.display,onClick:this.handleClick,ref:this.container,translate:"no"},i.createElement("div",{style:{display:m.display}},i.createElement(Gj,{textWithLineBreaks:w,fontSize:E,width:n,height:r,editorWidth:d||n,editorHeight:c||r,textScale:f,layer:t,animStyles:p,isEditing:o,viewOnly:e})),i.createElement("div",{style:{...h,visibility:"hidden",opacity:"0",pointerEvents:"none"},"data-cy":e?"text-hidden-view-only":"text-hidden",ref:this.hiddenEditorContainer},i.createElement(Y.Editor,{customStyleMap:u,blockStyleFn:this.customEditorBlockStyle,editorState:v,onChange:$j,readOnly:!0,ref:this.hiddenEditor})),t.textOutline&&!b&&i.createElement("div",{style:{...m,...g,...y},"data-cy":"text-outline"},i.createElement(Y.Editor,{customStyleMap:u,blockStyleFn:this.customEditorBlockStyle,editorState:a,onChange:$j,readOnly:!0})),i.createElement("div",{style:{...m,...g},"data-cy":e?"text-view-only":"text"},b?i.createElement(zj,{layer:t,studioTime:this.props.studioTime}):i.createElement(Y.Editor,{customStyleMap:u,blockStyleFn:this.customEditorBlockStyle,editorState:a,handleBeforeInput:this.handleBeforeInput,handlePastedText:this.handlePastedText,handleKeyCommand:this.handleKeyCommand,keyBindingFn:this.handleKeyBindingFn,onBlur:this.onEditorBlur,onChange:this.handleEditorChange,onFocus:this.onEditorFocus,readOnly:e,ref:this.editor})))}}const Xj=m.exports.connect((()=>{const e=c(((e,t)=>{var a;return null==(a=e.activeEditors[t])?void 0:a.editor.getCurrentContent()}),(e=>e?{all:Dx(e),unique:Ox(e)}:{all:[],unique:[]}));return(t,a)=>{var o,n,r,i;const{beingTransformed:s,fontSizingTemp:l,globalAlphaTemp:d,positionTemp:c,textBlurTemp:u,textShadowBlurTemp:m,textShadowDistTemp:p,textShadowRotTemp:h,textTemp:g}=ul(t,a.layer.id),y=Oj(a.layer.id),f=t.studio.scenes[0];return{absoluteTimes:Kj(a.layer),duration:f.duration,isSelected:(null==(o=t.studio.selectedItem)?void 0:o.id)===a.layer.id,selectedScene:f,canvasWidth:t.studio.width,canvasX:t.studio.canvasX,currentFolderId:t.workspaces.selectedWorkspace,currentUser:t.currentUser,customFontsFetched:t.studio.customFontsFetched,historyIndex:t.studio.historyIndex,lastUndoTimestamp:t.studio.lastUndoTimestamp,usedUndo:t.studio.usedUndo,beingTransformed:s,fontSizingTemp:l,globalAlphaTemp:d,isEditing:ml(t,a.layer.id),textBlurTemp:u,textShadowBlurTemp:m,textShadowDistTemp:p,textShadowRotTemp:h,textTemp:g,positionTemp:c,layerTempValues:t.studioLocal.layerTempValues,textLayerIDsAddedInSession:t.studioLocal.textLayerIDsAddedInSession,editorState:null==(n=t.activeEditors[a.layer.id])?void 0:n.editor,editorStateSync:null!=(i=null==(r=t.activeEditors[a.layer.id])?void 0:r.syncCounter)?i:0,inlineStyles:e(t,a.layer.id),selectedLayersLength:sN(t).length,keyframeChannels:y(t)}}}),(e=>me({updateWorkspaceCustomFonts:Wv,selectItem:Kh,mountActiveEditor:vL,unmountActiveEditor:wL,updateActiveEditor:bL},e)))(qj);function Jj(e,t,a){const o=document.createElement("canvas").getContext("2d");if(!o)return 0;const n=t.style.italic?"italic":"normal",{fontWeight:r}=t.style,{fontFamily:i}=t.style.fontFamily;let s=e;return"uppercase"===t.style.textTransform?s=s.toLocaleUpperCase():"lowercase"===t.style.textTransform&&(s=s.toLocaleLowerCase()),o.font=`${n} normal ${r} ${a}px ${i}`,o.measureText(s).width}const Qj=["Your","subtitles","here"],Zj=.5*Qj.length,eG=.1+Zj;function tG({preset:e,width:t=100,height:a=100,animate:o=!1}){const n=.8*t,s=.54*a,l=(t-n)/2,d=(a-s)/2,c=s/3,[u,m]=i.useState(1),[p,h]=i.useState(o),[g,y]=i.useState(Qj.map((t=>Jj(t,e,c)))),f=xD();r.exports.useEffect((()=>{!async function(){await mB(e.style.fontFamily),f.current&&y(Qj.map((t=>Jj(t,e,c))))}()}),[e,c,f]),r.exports.useEffect((function(){const e=setInterval((()=>{p&&f.current&&m((e=>e>eG+.1?.1:e+.01))}),10);return()=>clearInterval(e)}),[p,f]);const E={...FC(e.style),id:e.presetId,lineHeight:1,fontSize:c,globalAlpha:1,baseWidth:t,baseHeight:a,text:Qj.join("\n"),textWithLineBreaks:Qj.join("\n"),position:{x:"0%",y:"0%",width:"100%",height:"100%",rotation:0},isMagicSubtitle:!0,startTime:.1,endTime:eG,type:ln.Text,frame:{assetId:"123",id:"123",endTimeOffset:0,containingLayerPlaybackRate:1,startTimeOffset:0,words:[],wordIsClippedList:[],start:.1,end:eG,lines:Qj.map(((e,t)=>({width:g[t],words:[{start:.1+.5*t,end:.1+.5*t+.5,text:e,charOffset:0,splitTextByStyle:tk({text:e}),styles:[]}]}))),containingLayerEndTime:eG,containingLayerStartTime:.1,containingLayerIds:new Set(["123"])},assetId:e.presetId,wordSeparator:" ",isRTL:!1,wordByWordAnimations:(()=>{const{wordByWordAnimations:t}=e,a=(null==t?void 0:t.animationName)||"";if(p||!["Reveal","Bounce"].includes(a))return t})(),transition:e.transition};return i.createElement("div",{onMouseEnter:()=>{h(!0),m(1.1)},onMouseLeave:()=>h(!1)},i.createElement(Xj,{viewOnly:!0,layer:E,x:l,y:d,width:n,height:s,refreshKey:JSON.stringify(e),magicAssetId:e.presetId,studioTime:p?u:.1+Math.round(Zj/2)}))}const aG="PresetTitleInput-module_title_xclOc";function oG(e){const t=r.exports.useRef(null),[a,o]=i.useState(e.value);return i.createElement("input",{ref:t,type:"text",value:a,className:e.className||aG,disabled:!e.onChange,onChange:e=>{o(e.target.value)},onKeyPress:e=>{var a;"Enter"===e.key&&(null==(a=t.current)||a.blur())},onBlur:()=>{var t;a!==e.value&&(null==(t=e.onChange)||t.call(e,a))}})}function nG({preset:e,isSelected:t,viewOnly:a,animate:o}){const n=m.exports.useDispatch(),r=!!e.teamId,s=()=>{MD(e);km(e)&&vc("Clicked Default Subtitle Preset",{presetId:e.presetId})};return i.createElement("div",{className:HD},i.createElement("div",{className:t?$D:zD,onClick:s},i.createElement(tG,{preset:e,animate:o})),!a&&i.createElement("div",{className:YD},i.createElement(ZU,{preset:e,isBrandkit:r,isSelected:t})),r&&i.createElement("div",{className:KD,onClick:s},i.createElement(SD,{message:"Added to your team’s Brand Kit",wrapWithDiv:!0},i.createElement(Fe,{className:qD}))),i.createElement(oG,{value:e.title,onChange:a=>{if("custom"===e.presetId){const o={...e,presetId:`preset-${y()}`,title:a};Jl.execInUndoBatch((()=>{n(Wm({index:0,preset:o,undoable:!0})),t&&MD(o,!0,!1),WD()}))}else n(Bm({presetId:e.presetId,title:a,undoable:!r}));r&&RD({...e,title:a})}}))}const rG="MoreOptions-module_optionTextStyle_tSqgQ",iG="/api/v2/presets/textPresets";let sG=0;const lG=async e=>{const{dispatch:t}=tn(),a=Date.now();if(a-sG<1e4)return;sG=a;const o=await(async e=>{const t=`${iG}/${e}`,{presets:a}=await hu(t);return a})(e);o&&t(Op({brandkitPresets:o}))},dG=async(e,t)=>{const{dispatch:a,state:o}=tn();try{const n={...e,teamId:o.teams.selectedTeamId,timestampCreated:Date.now()};a(Bp({preset:n,index:t})),await(async e=>{await gu(iG,{body:{preset:e}})})(n);a(Su({description:"Your text style is now accessible to everyone on your team!",type:"success"})),ID("add","textPreset")}catch(YEe){Iu({description:"Failed to save text style.",error:YEe})}},cG=async e=>{try{await(async e=>{await yu(iG,{body:{preset:e}})})(e)}catch(YEe){Iu({description:"Failed to update text style.",error:YEe})}},uG=async e=>{const{dispatch:t,state:a}=tn(),o=a.teams.selectedTeamId;if(o)try{t(Vp({presetId:e})),await(async(e,t)=>{const a=`${iG}/${e}/${t}`;await pu(a)})(o,e),ID("remove","textPreset")}catch(YEe){Iu({description:"Failed to remove text style.",error:YEe})}},mG=()=>{const{state:e,dispatch:t}=tn(),{showCanvas:a}=e.studio;a||(RA(16,9),t({type:"SHOW_STUDIO_CANVAS"}))},pG=3,hG={},gG=(e,t,a)=>{const o=`${e.presetId}_${t}_${a}`,n=hG[o];if(n)return n;const r=wG(e),{width:i,height:s}=r.position,l={width:t*xS(i)/100,height:a*xS(s)/100};return hG[o]=l,l},yG=e=>["white","#ffffff","#fff","rgb(255,255,255)"].includes(null==e?void 0:e.toLowerCase().replaceAll(" ","")),fG=e=>["black","#000000","#000","rgb(0,0,0)"].includes(null==e?void 0:e.toLowerCase().replaceAll(" ","")),EG=e=>["transparent","rgba(0,0,0,0)",lp].includes(null==e?void 0:e.toLowerCase().replaceAll(" ","")),vG=e=>!(!yG(e.style.color)||!EG(e.style.backgroundColor)||e.style.textShadow&&"none"!==e.style.textShadow&&!EG(e.style.textShadow)&&!yG(e.style.textShadow)),wG=(e,t={})=>{var a,o;const{state:n}=tn(),r=ST(),{duration:i}=VA(),{canvasDimensions:s,scenes:l}=n.studio,{canvasWidth:d,canvasHeight:c}=s||{},u=d||320,m=c||180,p=(null==(a=l[0])?void 0:a.background.toLowerCase())||"";yG(p)&&vG(e)&&(t.textShadow="#000000");const h={id:y(),presetId:e.presetId,backgroundColor:e.style.backgroundColor,fontFamily:e.style.fontFamily,hasCustomFont:e.style.hasCustomFont,url:e.style.url,asset_id:e.style.asset_id,fontType:e.style.fontType,fontWeight:e.style.fontWeight,textAlign:e.style.textAlign,textTransform:e.style.textTransform,textOutline:e.style.textOutline,textShadow:"none"===e.style.textShadow?"transparent":e.style.textShadow,color:e.style.color,textBlur:e.style.textBlur,textEffect:e.style.textEffect,textEffectColor:e.style.textEffectColor,textPadding:e.style.textPadding,wrapOrFill:e.style.wrapOrFill,textShadowBlur:e.style.textShadowBlur,textShadowDist:e.style.textShadowDist,textShadowRot:e.style.textShadowRot,borderRadius:e.style.borderRadius,underline:e.style.underline,italic:e.style.italic,globalAlpha:e.style.globalAlpha,lineHeight:e.style.lineHeight,type:ln.Text,fontSize:15,baseWidth:u,baseHeight:m,text:"Sample text",position:{x:"32.5%",y:"32.5%",width:"25%",height:"25%",rotation:0},startTime:r,endTime:r+3,isTrimmed:i>0,...t},g=(e=>{const t=e.italic?"italic":"normal",a=document.createElement("canvas").getContext("2d");if(!a)return 0;const o=e.fontWeight||"normal",n=Rx(e,e.fallbackFonts||[]);a.font=`${t} normal ${o} ${e.fontSize}px ${n}`;let r=e.text;return"uppercase"===e.textTransform?r=e.text.toLocaleUpperCase():"lowercase"===e.textTransform&&(r=e.text.toLocaleLowerCase()),a.measureText(r).width})(h)+10,f=h.fontSize*h.lineHeight;return h.baseWidth=g,h.baseHeight=f,t.position||(h.position={x:IS((u-g)/2*100/u),y:IS((m-f)/2*100/m),width:IS(100*g/u),height:IS(100*f/m),rotation:(null==(o=h.position)?void 0:o.rotation)||0}),h},bG=async(e,t=!0,a={})=>{mG();const{dispatch:o}=tn(),n=wG(e,a);RB(n,{undoable:t,knownTimelineRow:void 0!==n.timelineRow}),o(Kh({id:n.id,type:"layer"})),vc("Added Text Preset",{presetId:e.presetId,isDefaultPreset:Ap(e),dndTimeline:void 0!==a.timelineRow,dndCanvas:void 0!==a.position})},_G=e=>{const{backgroundColor:t,fontFamily:a,hasCustomFont:o,url:n,asset_id:r,fontType:i,fontWeight:s,textAlign:l,textTransform:d,textShadow:c,textOutline:u,color:m,textBlur:p,textEffect:h,textEffectColor:g,textPadding:f,wrapOrFill:E,textShadowBlur:v,textShadowDist:w,textShadowRot:b,borderRadius:_,underline:T,italic:S,globalAlpha:I,lineHeight:x}=e;return{presetId:e.presetId||`preset-${y()}`,style:{backgroundColor:t,fontFamily:a,hasCustomFont:o,url:n,asset_id:r,fontType:i,fontWeight:s,textAlign:l,textTransform:d,textShadow:c,textOutline:u,color:m,textBlur:p,textEffect:h,textEffectColor:g,textPadding:f,wrapOrFill:E,textShadowBlur:v,textShadowDist:w,textShadowRot:b,borderRadius:_,underline:T,italic:S,globalAlpha:I,lineHeight:x}}};function TG(e,t){let a=!0;return Object.keys(e.style).forEach((o=>{const n=o,r=e.style[n],i=t.style[n],s=JSON.stringify(r),l=JSON.stringify(i);if("url"===n)return;if(!r&&!i)return;if("textShadow"===n){if(vG(e)&&yG(t.style.color)&&fG(t.style.textShadow))return;if(vG(t)&&yG(e.style.color)&&fG(e.style.textShadow))return}[s,l].every((e=>["none","transparent"].includes(e)))||s!==l&&(a=!1)})),a}function SG(){const e=xD(),t=tr((e=>e.teams.selectedTeamId)),{brandkitPresets:a,presets:o}=tr((e=>e.textPresets)),[n,i]=r.exports.useState(!1);if(r.exports.useEffect((()=>{lG(t)}),[t]),r.exports.useEffect((()=>{!async function(){await(async()=>{const{dispatch:e,state:t}=tn(),{presets:a,lastAssetUrlSignedAt:o}=t.textPresets;if(Date.now()-(o||0)<144e5)return;const n=(e=>{const t=[];return e.forEach((({style:{hasCustomFont:e,asset_id:a}})=>{e&&a&&t.push(a)})),t})(a);if(n.length)try{const t=await AD(n),o=a.map((e=>((e,t)=>{const{style:{hasCustomFont:a,asset_id:o}}=e;return a&&o?{...e,style:{...e.style,url:t[o]}}:e})(e,t)));e(Dp({presets:o})),e(Gp(Date.now()))}catch(r){console.error("refreshSubtitlePresetFontAssetUrls err",r)}})(),e.current&&i(!0)}()}),[e]),!n)return{presets:[],brandkitPresets:[]};const s=new Set(a.map((e=>e.presetId))),l=o.filter((e=>e&&e.presetId&&!s.has(e.presetId)));return{presets:Pp(l),brandkitPresets:a}}const IG=({preset:e,isBrandkit:t})=>{const a=m.exports.useDispatch(),o=XD(Ps.TEXT_PRESETS),n=HU(),r=!t||o,s=[];return s.push(i.createElement("div",{className:rG,onClick:()=>{const a=()=>{t?uG(e.presetId):dG(e)};if(o)a();else{n(a,{action:Rs.TEXT_PRESETS})()}}},i.createElement("span",{style:{marginRight:4}},t?"Remove from Brand Kit":"Add to Brand Kit"),!o&&i.createElement(Pn,null))),r&&s.push(i.createElement("div",{className:rG,onClick:async()=>{const r=async()=>{a(Up({presetId:e.presetId,undoable:!t})),t&&await uG(e.presetId)};if(o||!t)await r();else{n(r,{action:Rs.TEXT_PRESETS})()}}},"Remove style")),i.createElement(JU,{content:i.createElement(Le,{color:"gray",size:14}),options:s})};const xG=i.memo((function({disabled:e,children:t,onLoad:a,...o}){const{ref:n,wasVisible:s}=function(){const[e,t]=r.exports.useState(),[a,o]=r.exports.useState(!1),n=r.exports.useRef(!1);a&&(n.current=!0);const i=r.exports.useMemo((()=>new IntersectionObserver((([e])=>{e&&o(e.isIntersecting)}))),[]);return r.exports.useEffect((()=>e?(i.observe(e),()=>i.disconnect()):()=>{}),[i,e]),{ref:function(e){t(e)},isVisible:a,wasVisible:n.current}}(),l=s||e;return i.createElement("div",{ref:n,...o},l&&t)})),kG="PresetText-module_container_R79l5",CG=i.memo((function({preset:e,width:t=100,height:a=100,onClick:o}){r.exports.useEffect((()=>{mB({type:"default",fontFamily:e.style.fontFamily})}),[e]);const n={id:e.presetId,presetId:e.presetId,backgroundColor:e.style.backgroundColor,fontFamily:e.style.fontFamily,hasCustomFont:e.style.hasCustomFont,url:e.style.url,asset_id:e.style.asset_id,fontType:e.style.fontType,fontWeight:e.style.fontWeight,textAlign:e.style.textAlign,textTransform:e.style.textTransform,textShadow:"none"===e.style.textShadow?"transparent":e.style.textShadow,textOutline:e.style.textOutline,color:e.style.color,textBlur:(e.style.textBlur||0)/2,textEffect:e.style.textEffect,textEffectColor:e.style.textEffectColor,textPadding:e.style.textPadding,wrapOrFill:e.style.wrapOrFill,textShadowBlur:e.style.textShadowBlur,textShadowDist:e.style.textShadowDist,textShadowRot:e.style.textShadowRot,borderRadius:e.style.borderRadius,underline:e.style.underline,italic:e.style.italic,globalAlpha:e.style.globalAlpha,lineHeight:1,fontSize:t/4.2,baseWidth:t,baseHeight:a,text:"Sample\nText",position:{x:"0%",y:"0%",width:"100%",height:"100%",rotation:0},isMagicSubtitle:!1,startTime:0,endTime:Number.MAX_VALUE,type:ln.Text};return i.createElement(xG,{"data-cy":`preset-text-${e.presetId}`,className:kG,style:{width:t,height:a},onClick:o},i.createElement(Xj,{layer:n,viewOnly:!0,height:.5*a,width:.8*t,x:.09999999999999998*t,y:.25*a,refreshKey:JSON.stringify(e),studioTime:0}))})),AG="PresetPreview-module_container_MGmcA",NG="PresetPreview-module_brandkit_CZcev",PG="PresetPreview-module_more_gkQfH",RG="PresetPreview-module_brandkitIcon_ZWuKK",LG=i.memo((function({preset:e,width:t=100,height:a=100,viewOnly:o,onClick:n}){const r=!!e.teamId;return i.createElement("div",{className:AG},i.createElement(CG,{preset:e,width:t,height:a,onClick:n}),!o&&i.createElement("div",{className:PG},i.createElement(IG,{preset:e,isBrandkit:r})),r&&i.createElement("div",{className:NG,onClick:n},i.createElement(SD,{message:"Added to your team’s Brand Kit",wrapWithDiv:!0},i.createElement(Fe,{className:RG}))))})),DG="MoreOptions-module_optionTextStyle_ji9Sl",OG="/api/v2/presets/textTemplates",FG="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAUAAAAFACAMAAAD6TlWYAAAB8lBMVEUFoIH////9/v7x+fjl9fLY8OvN7OW65NyX18pyybhOu6YqrpMHoYLz+vm55Nt8zb0/tp4LooT2+/qt4NVXv6oNo4Wl3dJGuKLQ7edfwq4JoYPj9PF0yrnd8u5WvqrC5+A1spn8/f2D0MAIoYLL6+QrrpT1+/poxbKT1si45NsSpYfV7+ogqo7b8e0fqo7a8eweqY3Z8OwdqY2p3tR+zr4TpYgwsJZTvah5zLuh29De8u7+/v5PvKYjq5BnxbK95t3o9vMYp4rq9/QOo4Xn9vNdwa2S1cju+PaV1skXp4rA59/6/fyZ2Muw4ddsx7X7/f08tZ2u4NaAzr8kq5Cr39WQ1MfO7OYQpIYhqo/p9vSy4di/5t74/PsRpIc2spnE6OEmrJH3/PvK6uQ4s5sKooMxsJdRvae149mb2cxvyLaO1MZ4y7uBz7+J0sOI0cOG0cJ2y7rJ6uPv+fdHuaIprZNawKv5/Pw7tJyE0MFIuaMPpIbt+PbD6OA6tJzc8e11yrlMu6UsrpTw+fdbwKwVpokWpokur5V3y7rS7uiz4thEuKF9zb17zbzs9/Wg28/y+vhmxLGb2c2H0cKK0sSW18qi29Bhw69Bt59gwq5uyLbr9/VDt6DP7edJuqPf8++249pLuqR/zr4nrZKe2s5pxrMzsZgQPDzOAAADa0lEQVR4Ae3cg7ptNxuA0XzHtm3btm1bP2vbtu32Pvugnll756zUHeMS3ukZJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOD3QvwqunTt1r1Hz169+/TtJ2Cd/gMGDhosYJ0hQ4cNF7BO/xEjBaw0avQYAeuMHTdYwDrjJwhYaeIkAetMnjJVwDrTpgtYZ8ZMASvN6idgndlzBKwzd56AdeYvELDOwkUC1lm8RMA6PYYLWGepgJWW/TMCppvWb/m8FStXrV4TnVi7TsAOrd+wsUt0ZNNmATsxb9mW6MBQATu1tfe2aG27gJ2bs2NytLJzs4AFJo2PVnYJWGL3nmhhb18BS0zdFy3sF7DMgYORd0jAMsPWRtZhAQsdiazJRwUsdCyyjgtYaOuJyOl6UsBCp05HzmgBS22PnDMCFjsbGefOC1hqxdrI2C5gscORcUzAYhciY5uA5S5GxiUBi82se5ERcPnlaNonYLme0XRFwHKrommLgOWuRsZJAYtdmxxN1wUsNz+abghY7l/RtEHAcv+Opv8IWO6/0fQ/Acv9P5qOCFhuYDTdImC5W6PpNgHL7Yqm2wUsN8JrTJ07ommYgOXujKa7BCy2JDLuFrDYPdF0bz8Bq77k5iYBi62pmq0v4H2Rcb+AxXpFxgMClnrwoWi6d6uApcZFxsNJwEKDu0XGFAFL3R45jwhYaF7/yHg0CVjocORMEbDQY5HVV8Ayj3eJnCtJwCJPPBlZTwlY5On5kTW+n4AlnrkYeQdSAQGffTTyTg8XsECfrlFxAgr4XJdo4fl+AnZq/QvR0otJwE5sfWlG+xvHCDjn5S3R2itLBOzQi6++Fh1ZmVoRsF/f10dsi469kb4n4KQ3f/TW2++cmXtvdKr7VgF/8G7ctIfuThUEvPe9VEPA91MNAVelGgI+lioIuPaDVEHAgxtSBQE//ChVEPDj9amCgO9sTe0TcNuNVEHAEc+k9gn48SepfQJ+Ojq1T8CFH1xL7RJw7Wefp7YJeOKLL1ObBJxxtvf61B4BT3/19Tf9UtsEfCcVEFBAAQUUUEABBRRQQAEFFFBAAQUUUEABBRRQwAoCFhJQQAEFFFBAAQUUUEABBRRQQAEFFFBAAQUUUEABAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAL4FwSegPJGNcQIAAAAASUVORK5CYII=";function MG(e){return Tr({key:"pastedLinkError",params:{layerIds:e.map((e=>e.id))}})}function UG(e,t={}){return gu("/api/v1/assets/create_v2",{body:e,params:t,retries:5})}function BG(e){return gu("/api/v1/assets/createFromVideo_v2",{params:{id:e},retries:5})}const WG=s.exports.memoize(VG,(e=>e));function VG(e,t={},a={}){return gu("/api/v1/assets/createFromLink_v2",{body:a,params:{url:e,...t},retries:5})}const jG=new Map;function GG(e,t){const a=`/api/v1/assets/${e}`,o=jG.get(a);if(o)return o;const n=hu(`${a}/${t||""}`,{retries:5}).then((e=>(jG.delete(a),e)));return jG.set(a,n),n}function HG(e,t){return fu(`/api/v1/assets/${e}`,{body:t})}function zG(e){return hu(`/api/v1/assets/${e}/split-scenes`,{timeout:75e3})}function $G(e){return gu(`/api/v1/assets/${e}/split-scenes`)}function KG(e){if(!e)return void console.error("No Pasted URL provided.");const{scenes:t}=tn().state.studio,a=[];for(const o of t)for(const t of o.layers)t.pastedUrl===e&&a.push(t);YG(a,!0)}function YG(e,t){if(0===e.length)return;const{dispatch:a}=tn();let o=null;const[n]=e;if(n&&n.url){const e=new URL(n.url).hostname.split(".");o=e.slice(Math.max(0,e.length-2)).join(".")}const r=KO(null==n?void 0:n.pastedUrl);vc("Failed Preemptive Download Modal Shown",{url:null==n?void 0:n.pastedUrl,pathname:window.location.pathname,extractedHost:o,platform:r,fromPreemptiveDownload:t}),m.exports.batch((()=>{const t={};for(const a of e)t[a.id]={preemptiveDownloadError:!0};px(t),a(MG(e))}))}async function qG(e){if("complete"===(await gu(`/api/v1/assets/${e}/initialize_metadata`)).status)return null;return await new Promise(((t,a)=>{const o=setInterval((async()=>{try{const a=await hu(`/api/v1/assets/${e}`);"metadata_init_in_progess"in a&&!a.metadata_init_in_progess&&(t(a),clearInterval(o))}catch(n){a(n),clearInterval(o)}}),5e3)}))}function XG(e){return e.content_type?e.content_type.startsWith("image")?ln.Image:e.content_type.startsWith("video")?ln.Video:e.content_type.startsWith("audio")?ln.Audio:null:null}function JG(){const{state:e}=tn(),t=(e.isStudio?e.studio.duration:e.duration)>7200,a=JD(Ps.UNLIMITED_EXPORT_DURATION_LIMIT);return t&&a}function QG(){var e;const{state:t}=tn(),a=nd(t),o=t.isStudio?t.studio.duration:t.duration,n=(null==(e=null==a?void 0:a.limits)?void 0:e.cumulativeExportDuration)||0;let r;r=t.isStudio?ZG(t.studio.scenes)||o>420||n+o>10800:t.sourceVideo.size>262144e3||o>420||n+o>10800;const i=JD(Ps.UNLIMITED_EXPORT_DURATION_LIMIT);return r&&!i}function ZG(e){for(const t of e)for(const e of t.layers)if(tH(e))return!0;return!1}function eH(e){const t=[];for(const a of e)for(const e of a.layers)tH(e)&&t.push(e);return t}function tH(e){const{state:t}=tn(),{assets:a}=t,o=a.byId[e.asset_id||""];return(e.size||(null==o?void 0:o.size)||(null==o?void 0:o.file_size)||0)>262144e3&&!("recordType"in e&&null!=e.recordType)}async function aH(e){const t=document.createElement("video"),a=new Promise((e=>{t.addEventListener("loadedmetadata",(()=>{t.duration===1/0?(t.currentTime=Number.MAX_SAFE_INTEGER,t.ontimeupdate=()=>{t.ontimeupdate=null,e(t.duration),t.currentTime=0}):e(t.duration)})),t.addEventListener("error",(()=>{console.error("Failed to get blob duration"),e(void 0)}))}));return t.src="string"==typeof e||e instanceof String?e:window.URL.createObjectURL(e),a}const oH=null!=(e=jc.get("devModeDebugFlags",{disabled:{}}))?e:{},nH=new EventTarget,rH=e=>{Object.assign(oH,e),jc.set("devModeDebugFlags",oH),nH.dispatchEvent(new Event("update"))},iH=e=>{var t;const[a,o]=r.exports.useState(zo),[n,i]=r.exports.useState(null!=(t=oH[e])?t:null);return r.exports.useEffect((()=>Ko((()=>o(!0)))),[]),r.exports.useEffect((()=>{const t=()=>{var t;return i(null!=(t=oH[e])?t:null)};return nH.addEventListener("update",t),()=>{nH.removeEventListener("update",t)}}),[e]),a?n:null};let sH={};let lH={};let dH={};function cH(){const e={...lH};for(const[t,a]of Object.entries(dH))e[t]?e[t]+=a:e[t]=a;return{lastUsed:sH,realSizes:e,assetSizes:lH,segmentSizes:dH}}async function uH(e){const t=jc.get("asset_last_used",{disabled:null});t&&"object"==typeof t&&(sH=t);const a=jc.get("asset_sizes",{disabled:null});a&&"object"==typeof a&&(lH=a);const o=jc.get("asset_segment_sizes",{disabled:null});o&&"object"==typeof o&&(dH=o),Object.keys(lH).forEach((t=>{e.has(t)||delete lH[t]})),Object.keys(sH).forEach((t=>{e.has(t)||delete sH[t]})),Object.keys(dH).forEach((t=>{e.has(t)||delete dH[t]})),e.forEach((e=>{lH[e]=lH[e]||0})),jc.set("asset_sizes",lH)}function mH(e){const t=Date.now();for(const a of e)sH[a]=t;jc.set("asset_last_used",sH)}function pH(e,t){const a=t?function(e){try{return sh(e)?function(e){var t,a,o,n;return((null==(t=e.file_v2)?void 0:t.file.size)||0)+((null==(a=e.optimizedPreviewFile_v2)?void 0:a.file.size)||0)+((null==(o=e.waveformData_v5)?void 0:o.file.size)||0)+((null==(n=e.thumbnail)?void 0:n.size)||0)}(e):function(e){return e.type===ln.Audio}(e)?function(e){var t;return e.file.size+((null==(t=e.waveformData_v5)?void 0:t.file.size)||0)}(e):function(e){return e.type===ln.Image}(e)?function(e){return e.file.size+e.thumbnail.size}(e):0}catch(t){return console.error(t),b(t),0}}(t):0;a?lH[e]=a:delete lH[e],jc.set("asset_sizes",lH)}"undefined"!=typeof window&&(window.getMediaCache=()=>({assetSizes:lH,lastUsed:sH}));const hH=s.exports.throttle(jc.set.bind(jc),100,{leading:!1,trailing:!0});async function gH(e,t,a){return new Promise((o=>{const n=async()=>{e.removeEventListener("seeked",n),t.getContext("2d").drawImage(e,0,0,e.videoWidth,e.videoHeight,0,0,t.width,t.height);const a=await async function(e){return new Promise((t=>{e.toBlob((e=>t(e)),"image/jpeg",.6)}))}(t);return o(a)};e.addEventListener("seeked",n),e.currentTime=a}))}async function yH(e,t,a){const[o,n,r]=await Promise.all([e,t,a].map((e=>e?async function(e){return new Promise((t=>{const a=document.createElement("video");a.crossOrigin="anonymous",a.preload="auto",a.addEventListener("loadeddata",(async()=>{const{duration:e}=a,o=document.createElement("canvas"),n=a.videoHeight,r=a.videoWidth,i=n/r;o.width=200,o.height=200*i;const[s,l]=await Promise.all([await lF(a),await gH(a,o,0)]);t({duration:e,height:n,width:r,thumbnail:l,hasAudio:s})})),a.src=e,a.load()}))}(URL.createObjectURL(e)):Promise.resolve(void 0))));return{...o&&{file_v2:{file:e,duration:o.duration,width:o.width,height:o.height,hasAudio:o.hasAudio}},...n&&{optimizedPreviewFile_v2:{file:t,duration:n.duration,width:n.width,height:n.height,hasAudio:n.hasAudio}},...r&&{trackOptimizedPreviewFile_v2:{file:a,duration:r.duration,width:r.width,height:r.height,hasAudio:r.hasAudio}},thumbnail:(null==o?void 0:o.thumbnail)||(null==n?void 0:n.thumbnail)||(null==r?void 0:r.thumbnail),thumbnailSource:(!(null==o?void 0:o.thumbnail)?!!(null==n?void 0:n.thumbnail)&&"preview":"original")||!!(null==r?void 0:r.thumbnail)&&"thumbnail"}}"undefined"!=typeof window&&(window.idbCache||(window.idbCache={}));const fH=new Map;let EH=1e3;const vH={};function wH(e,t){Object.values(vH[e]||{}).forEach((e=>e(t)))}function bH(e,t){vH[e]||(vH[e]={});const a=vH[e];if(!a)throw Error();const o=(EH+=1,EH);a[o]=t;const n=window.idbCache[e];return n?"complete"===n.status?t(n.asset):n.subscribers.push(t):NH(e).then((e=>{e&&t(e)})),()=>{var t;null==(t=vH[e])||delete t[o]}}function _H(e,t){let a=fH.get(e);return a||(a=new We,fH.set(e,a)),a.runExclusive(t)}async function TH(e){try{await(await GH).delete("pendingConversions",e)}catch{}}async function SH(){let e=[];try{e=await(await GH).getAll("pendingConversions")}catch{}return e}async function IH(e,t,a,o,n){try{await(await GH).add("pendingConversions",{name:a,mediaLibraryID:y(),conversion_id:e,id:t,uploadId:o,cmlFileId:n})}catch{}}async function xH(e,t,a){return _H(e,(async()=>{try{const{idbCache:o}=window,n=await(await GH).get("assets",e);if(!n)return void console.error(`Could not find asset ${e}`);const r={...n,...t};if("video"===n.type&&a){const e=e=>{switch(e){case"original":return 3;case"preview":return 2;case"track":return 1;default:return 0}},t=await yH(a.original,a.preview,a.track),o={file_v2:n.file_v2,optimizedPreviewFile_v2:n.optimizedPreviewFile_v2,trackOptimizedPreviewFile_v2:n.trackOptimizedPreviewFile_v2,thumbnail:n.thumbnail,thumbnailSource:n.thumbnailSource},i=e(t.thumbnailSource)>e(o.thumbnailSource)?t:o,s={...o,...t,thumbnail:i.thumbnail,thumbnailSource:i.thumbnailSource};Object.assign(r,s)}await(await GH).put("assets",r);const i=o[e];i&&(i.asset=r),wH(e,r),pH(r.mediaLibraryID,r)}catch{}}))}async function kH({mediaCacheId:e,type:t,file:a,optimizedPreviewFile:o,trackOptimizedPreviewFile:n}){return _H(e,(async()=>{var r;const{state:i,dispatch:s}=tn(),l=null!=(r=i.currentUser.user._id)?r:"anonymous";window.idbCache[e]||(window.idbCache[e]={subscribers:[],status:"pending"});try{if(await(await GH).get("assets",e))return!1;if(t===ln.Video){if(!(a||o||n))throw Error("Did not receive a valid file during idbAddAsset");const t={...await yH(a,o,n),mediaLibraryID:e,timestamp:new Date,user_id:l,type:ln.Video};await(await GH).add("assets",t);const r=window.idbCache[e];r&&(r.asset=t,r.status="complete"),wH(e,t),pH(t.mediaLibraryID,t)}else if(t===ln.Image){const t=()=>new Promise((e=>{const t=new Image;t.onload=()=>{e({width:t.width,height:t.height})},t.src=URL.createObjectURL(a)})),{width:o,height:n}=await t(),r={file:a,mediaLibraryID:e,timestamp:new Date,user_id:l,height:n,width:o,type:ln.Image,thumbnail:a};await(await GH).add("assets",r);const i=window.idbCache[e];i&&(i.asset=r,i.status="complete"),wH(e,r),pH(r.mediaLibraryID,r)}else{if(t!==ln.Audio){const o=window.idbCache[e];throw o&&(o.status="failed"),wH(e,null),new Error(`IDB.addAsset. File type not supported: ${a.type} (layer type was ${t})`)}{const t=await aH(a);if(void 0===t)throw new Error("Unable to get audio duration");const o={file:a,mediaLibraryID:e,timestamp:new Date,user_id:l,duration:t,type:ln.Audio};await(await GH).add("assets",o);const n=window.idbCache[e];n&&(n.asset=o,n.status="complete"),wH(e,o),pH(o.mediaLibraryID,o)}}s(ig([e]))}catch(YEe){console.error(YEe);const a=window.idbCache[e];return a&&(a.status="failed"),wH(e,null),Math.random()<.2&&b(YEe),!1}return!0}))}async function CH(e){return _H(e,(async()=>{try{const{idbCache:t}=window;delete t[e];const a=await GH,o=[];o.push(a.delete("assets",e)),o.push(a.delete("mp4Headers",e)),o.push(a.getAllKeysFromIndex("mp4Segments","mediaCacheId",e).then((async e=>{const t=[];for(const o of e)t.push(a.delete("mp4Segments",o));await Promise.all(t)}))),await Promise.all(o),pH(e,null),function(e,t){dH[e]=t}(e,0);const{state:n,dispatch:r}=tn(),{idbAssetIds:i}=n.studioLocal;if(null===i)return;r({type:"REMOVE_IDB_ASSET_ID",idbAssetId:e})}catch{}}))}async function AH(){try{window.idbCache={},await(await GH).clear("assets"),lH={},jc.set("asset_sizes",lH);const{dispatch:e}=tn();e({type:"CLEAR_IDB_ASSET_IDS"})}catch(e){console.error(e)}}async function NH(e){let t;const{idbCache:a}=window,o=a[e];if(o&&"complete"===o.status)t=o.asset;else if(o&&"pending"===o.status)t=await new Promise((e=>{o.subscribers.push(e)}));else{a[e]={subscribers:[],status:"pending"};try{t=await bi(7e3,(await GH).get("assets",e));const o=a[e];o&&(t?(o.status="complete",o.asset=t):o.status="failed")}catch(YEe){const o=a[e];o&&(o.status="failed")}finally{const o=a[e];o&&(o.subscribers.forEach((e=>{e(t)})),o.subscribers=[])}}return t}function PH(e){const{idbCache:t}=window,a=t[e];if(a&&"complete"===a.status)return a.asset}async function RH(){try{const e=[];e.push((await GH).getAllKeys("assets")),e.push((await GH).getAllKeys("mp4Headers"));const t=(await Promise.all(e)).flat();return[...new Set(t)]}catch{}return[]}async function LH(){let e=[];try{e=await(await GH).getAll("assets")}catch{}return e}async function DH(e,t,a){await(await GH).add("thumbnails",{mediaLibraryID:e,frameTime:t,imageData:a})}async function OH(e,t,a){let o;const n=IDBKeyRange.bound([e,t],[e,a]);try{const e=await(await GH).getAllFromIndex("thumbnails","mediaLibraryID+frameTime",n);if(!e.length)return;let r=0,i=e.length-1;const s=(a+t)/2;for(;r<i-1;){const t=Math.floor((i+r)/2),a=e[t];if(!a)throw Error("Missing asset");s<=a.frameTime?i=t:r=t}const l=e[r],d=e[i];if(o=d||l,l&&d){const e=Math.abs(l.frameTime-s);o=Math.abs(d.frameTime-s)<e?d:l}}catch(r){console.error(r)}return o}function FH(e){const[t,a]=r.exports.useState(null);return r.exports.useEffect((()=>{if(!e)return a(null),()=>{};return bH(e,(e=>{e&&a(e)}))}),[e]),(null==t?void 0:t.mediaLibraryID)!==e?null:t}function MH(e,t){var a,o;if("video"!==e.type)return e.file;if(!t)return(null==(a=e.file_v2)?void 0:a.file)||(null==(o=e.optimizedPreviewFile_v2)?void 0:o.file);const[n]=t.map((t=>{var a,o,n;switch(t){case"original":return null==(a=e.file_v2)?void 0:a.file;case"preview":return null==(o=e.optimizedPreviewFile_v2)?void 0:o.file;case"track":return null==(n=e.trackOptimizedPreviewFile_v2)?void 0:n.file;default:return null}})).filter((e=>!!e));return n}function UH(e,t){if("audio"===e.type)return{duration:e.duration};if("video"!==e.type)return null;let a=null;return t?[a]=t.map((t=>{switch(t){case"original":return e.file_v2;case"preview":return e.optimizedPreviewFile_v2;case"track":return e.trackOptimizedPreviewFile_v2;default:return null}})).filter((e=>!!e)):a=e.file_v2||e.optimizedPreviewFile_v2,{duration:null==a?void 0:a.duration,height:null==a?void 0:a.height,width:null==a?void 0:a.width}}async function BH(e){return(await GH).get("mp4Headers",e)}async function WH(e){(await GH).add("mp4Headers",e)}async function VH(e,t){var a;return null==(a=await(await GH).getFromIndex("mp4Segments","assetId+idx",[e,t]))?void 0:a.segment}async function jH(e,t,a,o){await(await GH).add("mp4Segments",{mediaCacheId:e,assetId:t,idx:a,segment:o})}let GH;function HH(e,t,a){const{dispatch:o,state:{mediaCache:{uploadIdToMediaCacheId:n},studio:{_id:r,thisProjectCMLFiles:i}}}=tn();m.exports.batch((()=>{if(o(jP([e])),t&&(o(Ly([t])),t.teamId?o(BE((e=>({...e,cmlIds:[...e.cmlIds,t.id]})))):(o(Ry([t.id])),(null==i?void 0:i[t.id])||o(nR(t,r))),t.duplicate&&o(By({id:t.id,modified:new Date(t.modified)})),a)){o(Fy({cmlFileId:t.id,uploadId:a}));const e=n[a];e&&o(Nr({assetId:t.asset_id,mediaCacheId:e}))}}))}function zH(){let e="";const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let a=0;a<8;a+=1)e+=t.charAt(Math.floor(Math.random()*t.length));return e}function $H(){const{history:e}=tn(),{pathname:t}=e.location;return t.match(/studio\/editor$/)||t.includes("upload")||t.includes("replace")||t.includes("mediaLibrary")||t.includes("search")||t.includes("emoji")||t.includes("remove-background")||t.includes("plugins")}"undefined"!=typeof window&&(GH=bi(5e3,(async()=>{try{await Me();const e=await Ue("kapwing",7,{upgrade(e,t){if(t<=0&&e.createObjectStore("assets",{keyPath:"pathname"}),t<=1&&(e.objectStoreNames.contains("assets")&&e.deleteObjectStore("assets"),e.createObjectStore("assets",{keyPath:"mediaLibraryID"}),e.createObjectStore("pendingConversions",{keyPath:"mediaLibraryID"}),e.createObjectStore("pendingUploads",{keyPath:"mediaLibraryID"})),t<=2&&e.createObjectStore("thumbnails",{autoIncrement:!0}).createIndex("mediaLibraryID+frameTime",["mediaLibraryID","frameTime"]),t<=3&&e.createObjectStore("pendingDownloads",{keyPath:"mediaLibraryID"}),t<=4&&e.objectStoreNames.contains("pendingUploads")&&e.deleteObjectStore("pendingUploads"),t<=5&&e.objectStoreNames.contains("pendingDownloads")&&e.deleteObjectStore("pendingDownloads"),t<=6){e.createObjectStore("mp4Headers",{keyPath:"mediaCacheId"});const t=e.createObjectStore("mp4Segments",{autoIncrement:!0});t.createIndex("assetId+idx",["assetId","idx"]),t.createIndex("mediaCacheId","mediaCacheId")}},async blocked(){await Be("kapwing")},async blocking(){await Be("kapwing")}});if(oH.clearDbOnLoad)for(const t of e.objectStoreNames)console.debug("Clearing ",t),e.clear(t);return e}catch(e){throw e instanceof Error&&"InvalidStateError"===e.name&&"string"==typeof e.message&&e.message.includes("A mutation operation was attempted on a database that did not allow mutations")&&(e.__SKIP_SENTRY=!0),e}})()),GH.catch((function(e){console.error(e);const{dispatch:t}=tn();t(KR())})));const KH=e=>{const t=JD(Ps.UNLIMITED_UPLOAD_SIZE_LIMIT),a=JD(Ps.UNLIMITED_EXPORT_DURATION_LIMIT);!tH(e)||t||SS(e.id)?"duration"in e&&e.duration&&e.duration>420&&!a&&!SS(e.id)&&vc("Paywalled Upload",{"Upload Type":e.type,Duration:e.duration}):vc("Paywalled Upload",{"Upload Type":e.type,"File Size":e.size})},YH=()=>({id:y()}),qH=async(e,t,a)=>{var o,n;const{state:{currentUser:{user:{_id:r}}}}=tn(),{name:i,size:s,type:l,recordType:d}=e,c=URL.createObjectURL(e),u=await hF(c,e),m=u?u.type:t.type;if(!m)throw Error("Could not identify media type");const p={videoDelay:0};(null==a?void 0:a.addAtSeeker)&&(p.videoDelay=ST());const h={...YH(),name:i,size:s,mime:l,...d&&{recordType:d},local_url:c,source:"local",objectFit:"cover",...t,...u,type:m,...(null==a?void 0:a.addAtSeeker)&&p,uploaderId:r};return"video"===(null==u?void 0:u.type)&&(h.startTime=null!=(o=t.startTime)?o:0,h.endTime=null!=(n=t.endTime)?n:u.duration),h},XH=async(e,t,a)=>{var o,n;const r=Rr(t),i=await NH(r);let s;if(i&&"video"===i.type){const e=null!=(o=i.optimizedPreviewFile_v2)?o:i.file_v2;e&&(s={duration:e.duration,hasAudio:e.hasAudio,width:t.width||e.width,height:t.height||e.height,type:i.type})}if(!s){const o={name:t.name,type:null!=(n=t.mime)?n:void 0};s=(null==a?void 0:a.mediaInfo)?a.mediaInfo:await hF(e,o)}const l=(null==a?void 0:a.overwriteLayerType)||(null==s?void 0:s.type)||t.type;if(!l)throw Error("Could not identify media type");return{...YH(),url:e,name:zH(),source:"upload",objectFit:"cover",...t,...s,type:l}},JH=e=>{var t,a,o,n;const r=e,i=QH(r);if(i)return i===ln.Image&&(null==(t=r.dimensions)?void 0:t.width)&&(null==(a=r.dimensions)?void 0:a.height)?{width:r.dimensions.width,height:r.dimensions.height,type:i}:i===ln.Audio&&r.duration?{duration:r.duration,hasAudio:!0,type:i}:i===ln.Video&&r.duration&&(null==(o=r.dimensions)?void 0:o.width)&&(null==(n=r.dimensions)?void 0:n.height)&&r.hasAudio?{width:r.dimensions.width,height:r.dimensions.height,duration:r.duration,hasAudio:r.hasAudio,type:i}:void 0},QH=e=>{var t,a;if(e.content_type){if(TF(e.content_type))return ln.Audio;if(nF(e.content_type))return ln.Image;if(rF(e.content_type)){if(!(null==(t=e.dimensions)?void 0:t.width)||!(null==(a=e.dimensions)?void 0:a.height))return;return cF(e.content_type,e.dimensions.width,e.dimensions.height)}}},ZH=(e,t)=>{var a,o;const{selectLayerInCreator:n=!1,sceneId:r="",currentVideo:i={},layerToReplace:s,newTimeline:l=!1,knownTimelineRow:d=!1,multiRowUploadForRecording:c=!1,singleFileUpload:u=!1,selectedGroupId:m=""}=t||{},{state:p}=tn(),h=!0;if(!(null==(a=null==p?void 0:p.currentUser)?void 0:a.token)&&(e.wasUploadedAnonymously=!0),!e.originalName&&e.name&&(e.originalName=e.name),e.requireConversion)return((e,t,a,o)=>{const{dispatch:n}=tn(),r={position:null,...e};KH(r);const i=a;return r.position=uS(r),SB(r),["convert","fit-video","resize"].includes(e.origin)||n(Kh({id:r.id,type:"layer"})),e.isMediaLibraryUpload||(o&&n(_h(o,"handleUploadRequiringConversion")),RB(r,{sceneId:i})),"resize"===e.uploadLocation&&(r.lockAspectRatio=!0),t&&$H()&&["pastedLink","local"].includes(e.source)&&"oneoff-landing-page"!==e.origin&&hT(),r})(e,n,r,s);!["pastedLink","local"].includes(null!=(o=e.source)?o:"")&&e.local_url&&e.metadataGathered&&!sz(e)||KH(e),"image"!==e.type&&"isMuted"in i&&(e.isMuted=!0);const g=c||u;return s||e.isMediaLibraryUpload||!g||SB(e),s?LB(e,s,{knownTimelineRow:d,newTimeline:l,sceneId:r,undoable:h}):e.isMediaLibraryUpload||RB(e,{knownTimelineRow:d,newTimeline:l,sceneId:r,undoable:h}),((e,t,a)=>{const{dispatch:o,history:n}=tn(),{pathname:r}=n.location;r.includes("/upgrade")||(t&&$H()||"oneoff-landing-page"===e.origin?(o(Kh(a?{id:a,type:"group"}:{id:e.id,type:"layer"})),"oneoff-landing-page"===e.origin||r.includes("/studio/editor")?(r.includes("/overlay/upload")||r.includes("/overlay/library")||r.includes("/overlay/search")||r.includes("/overlay/projects")||r.includes("/overlay/emojis")||r.includes("/plugins")||r.includes("/drag-upload")||r.includes("/replace")||r.includes("/mediaLibraryUpload"))&&hT():hT()):"resize"!==e.uploadLocation&&"fit-video"!==e.uploadLocation&&"convert"!==e.uploadLocation||hT())})(e,n,m),e},ez=e=>{const{dispatch:t}=tn(),a={};return FN.forEach((t=>{t in e&&(a[t]=e[t])})),t(function(e,t){return{type:"UPDATE_UPLOADED_LAYER",layer:e,properties:t}}(e,a)),e},tz=e=>`${(e/1e6).toFixed(1)}MB`;function az(e){if(!e)return null;const{progress:t=0,conversionProgress:{conversion:a=101,gather_assets:o=101,uploading_converted:n=101}={}}=e;let r=null;if(t<100)r=`Uploading ... ${t}%`;else if(o<100)r="Getting Assets ... ";else if(a<100)r=`Converting ... ${a}%`;else if(n<100)r="Uploading ... ";else if(e.uploadManager&&xF(e.uploadManager.layer))return"Converting ... ";return r}function oz(e){if(!e)return null;const{progress:t=0,conversionProgress:{conversion:a=101,gather_assets:o=101,uploading_converted:n=101}={}}=e;let r=null;return t<100?r=t:o<100?r=o:a<100?r=a:n<100&&(r=n),r}function nz(){return function(){const{state:e}=tn(),{scenes:t,background:a}=e.studio;return!(a!==lp&&!t.find((e=>e.background===lp)))}()?"png":"jpeg"}const rz=e=>{let t,a=0;for(const o of e){if(!["audio","video"].includes(o.type))continue;const e=Ld(o);e>a&&(t=o,a=e)}return t},iz=(e,t,a)=>{const o=e=>{const t=e.toString(16);return 1===t.length?`0${t}`:t};return`#${o(e)}${o(t)}${o(a)}`.toUpperCase()},sz=e=>{const{state:t}=tn(),a=Jw(e.id,t.studio);return!(null==a?void 0:a.position)||Object.keys(a.position).some((e=>{const t=e,o=a.position[t];return"string"==typeof o&&o.includes("NaN")}))},lz=[El.videos,El.images,El.elements,El.templates],dz={QUERY:"SIDEBAR_SEARCH_QUERY",RESULTS:{VIDEO:"SIDEBAR_VIDEO_RESULTS",IMAGE:"SIDEBAR_IMAGE_RESULTS",QUERY:{VIDEO:"SIDEBAR_VIDEO_QUERY",IMAGE:"SIDEBAR_IMAGE_QUERY"}}},cz="elements-sidebar",uz="sidebar-audio",mz="sidebar-transitions",pz=["boob","boobs","breast","breasts","butt","butts","seggs","kill","guns","foreplay","prostitution","mary jane","doobie","joint","spliff","shoot","drug","304","blood","nude","big bobs"],hz=["vodka","kicking","demon"],gz=()=>jc.remove(dz.QUERY),yz=()=>{const e=jc.get(dz.RESULTS.IMAGE,{disabled:null});return e?jc.get(dz.RESULTS.QUERY.IMAGE,{disabled:null})!==jc.get(dz.QUERY,{disabled:null})?[]:e:[]},fz=()=>jc.get(dz.QUERY,{disabled:""})||"",Ez=()=>{const e=jc.get(dz.RESULTS.VIDEO,{disabled:null});return e?jc.get(dz.RESULTS.QUERY.VIDEO,{disabled:null})!==jc.get(dz.QUERY,{disabled:null})?[[],[]]:e:[[],[]]},vz=async(e,t)=>Eu("image_search",{body:{query:e,pageNumber:t}}),wz=(e,t)=>{const{width:a,height:o}=t.dimensions;return e+o/a},bz=new Map,_z=async({url:e,options:t={}})=>{var a;if(!e)return null;const{dispatch:o}=tn(),n=Al(),r=t.layerProperties||{},i=await XH(e,{source:"pastedLink",pastedUrl:e,isMediaLibraryUpload:t.isMediaLibraryUpload,uploadId:y(),...r},t);o(Kh({id:i.id,type:"layer"})),t.isMediaLibraryUpload||bc(i.type,(null==(a=r.addedLayerFrom)?void 0:a.source)||t.pluginId||void 0);try{const e={selectLayerInCreator:!0,singleFileUpload:!0,knownTimelineRow:void 0!==r.timelineRow};let a={...i,uploadPending:!0};if(t.idOfLayerToReplace){const o=tn().state.studio.allLayers.byId[t.idOfLayerToReplace];o&&(a=jS(a,o),e.layerToReplace=o)}ZH(a,e)}catch(d){console.error(d)}const s={};r.name?s.fileName=r.name:"emojiDescription"in r&&r.emojiDescription&&(s.fileName=r.emojiDescription),t.skipCML&&(s.skipCML=!0);const l={};t.thumbnailUrl&&(l.thumbnailUrl=t.thumbnailUrl);try{bz.has(e)||bz.set(e,VG(i.url||"",s,l));const{asset:t,cmlFile:a}=await bz.get(e);HH(t,a),i.asset_id=t._id,t.url&&(i.url=t.url),a&&(i.cmlFileId=a.id)}catch(d){i.doRetryExtraction=!0}try{ez({...i,uploadPending:!1})}catch(c){b(c,{extra:{layer:i}}),console.error(c),px({[i.id]:{doRetryExtraction:!0}})}return n&&yT(),i},Tz=()=>(e,t)=>_z({url:e,options:t}),Sz=()=>{const e=Si(),t=m.exports.useDispatch(),a=tr((e=>{var t;return(null==(t=e.studio.scenes[0])?void 0:t.background)||"#ffffff"}));return o=>{const n=kS();let r="#ffffff";["#fff","#ffffff","white",lp].includes(a.toLowerCase())&&(r="#000000");let i={id:y(),type:ln.Shape,shapeType:o,background:r,stroke:lp,position:n,lineCap:["line","arrow"].includes(o)?"round":"butt",globalAlpha:1};const s="svg"===o?"0.1%":"0.3%";i.lineWidth=["line","arrow"].includes(o)?"0.6%":s,["line","arrow"].includes(o)&&(i={...i,position:n,lineRightAngle:"horizontal",linePointStartCorner:"topLeft",stroke:"#000000"}),"arrow"===o&&(i={...i,lineArrow:"open"}),["rectangle","ellipse","svg"].includes(o)&&(i.position=pS(i.position)),RB(i,{undoable:!0}),t(Kh({id:i.id,type:"layer"})),e&&yT()}},Iz=async(e,t)=>Eu("video_search",{body:{query:e,pageNumber:t}}),xz=e=>{const t=Ve.filter((e=>!hz.includes(e)));if(t.push(...pz),t.includes(e))return!0;const a=e.split(" ");for(const o of a)if(t.includes(o))return!0;return!1},kz=(e,t,a)=>{if("GOOGLE"===t){const t=e;return{name:t.name||a,smallUrl:t.url,largeUrl:t.url,downloadUrl:t.url,type:"GOOGLE",mimeType:t.mime}}const o=e;return{name:o.name||a,smallUrl:o.images.small,largeUrl:o.images.large,downloadUrl:o.images.download,type:"PEXELS",attribution:{providerUrl:"//pexels.com",altText:"Pexels Logo",logoSrc:FG,attributionUrl:o.attribution.url,attributionName:o.attribution.name},dimensions:o.dimensions,images:o.images}};let Cz=0;const Az=async e=>{const{dispatch:t}=tn(),a=Date.now();if(a-Cz<1e4)return;Cz=a;const o=await(async e=>{const t=`${OG}/${e}`,{templates:a}=await hu(t);return a})(e);o&&t(Jp({brandkitTemplates:o}))},Nz=async(e,t)=>{const{dispatch:a,state:o}=tn();try{const n={...e,teamId:o.teams.selectedTeamId,timestampCreated:Date.now()};a(th({template:n,index:t})),await(async e=>{await gu(OG,{body:{template:e}})})(n);a(Su({description:"Your text style is now accessible to everyone on your team!",type:"success"})),ID("add","textTemplate")}catch(YEe){Iu({description:"Failed to save text style.",error:YEe})}},Pz=async e=>{try{await(async e=>{await yu(OG,{body:{template:e}})})(e)}catch(YEe){Iu({description:"Failed to update text style.",error:YEe})}},Rz=async e=>{const{dispatch:t,state:a}=tn(),o=a.teams.selectedTeamId;if(o)try{t(oh({templateId:e})),await(async(e,t)=>{const a=`${OG}/${e}/${t}`;await pu(a)})(o,e),ID("remove","textTemplate")}catch(YEe){Iu({description:"Failed to remove text style.",error:YEe})}},Lz=(e,t={})=>{var a;const{state:o}=tn(),{ratio:n,scenes:r}=o.studio,{duration:i}=r[0],s=(null==(a=e.ratio)?void 0:a.join(":"))||"16:9",l=n!==s;return e.layers.map((a=>{const o=y(),{type:r}=a;let{position:s}=a;if(l&&s){const t=+n.split(":")[0],a=+n.split(":")[1],o={width:t/Math.min(t,a),height:a/Math.min(t,a)},r=e.ratio||[16,9],i=r[0]/r[1],l=bA({xPct:xS(s.x),yPct:xS(s.y),widthPct:xS(s.width),heightPct:xS(s.height)},{width:i,height:1},o,{left:!1,top:!1});s={...s,x:IS(l.xPct),y:IS(l.yPct),width:IS(l.widthPct),height:IS(l.heightPct)}}const d={...a,position:s,id:o,type:r,fromTextDefaults:e.templateId};if(i&&(SB(d),t.startTime)){const e=(d.endTime||0)-(d.startTime||0)||t.duration||0;d.duration=e,d.isTrimmed=!0,d.startTime=t.startTime,d.endTime=t.startTime+e}return d}))},Dz={},Oz=(e,t,a)=>{const o=`${e.templateId}_${t}_${a}`,n=Dz[o];if(n)return n;const r=Lz(e);let i=100,s=0,l=100,d=0;r.forEach((({position:e})=>{if(!e)return;const{x:t,y:a,width:o,height:n}=e,r=xS(t),c=xS(a),u=xS(o),m=xS(n);r<i&&(i=r),c<l&&(l=c),r+u>s&&(s=r+u),c+m>d&&(d=c+m)}));const c={width:t*(s-i)/100,height:a*(d-l)/100};return Dz[o]=c,c},Fz=async(e,t=!0,a={})=>{var o;mG();const{state:n,dispatch:r}=tn(),{ratio:i,scenes:s}=n.studio,{duration:l}=s[0],d=i!==((null==(o=e.ratio)?void 0:o.join(":"))||"16:9"),c=Lz(e,a);if(Jl.beginBatch(),1===c.length){const a=c[0],o=e.layers[0];if(RB(a,{undoable:t}),d&&((e,t=!0)=>{const{state:a}=tn(),{byId:o}=a.studio.allLayers,n=o[e];if(!n)return;let{position:r}=n;if(r){let e=50-xS(r.width)/2,a=50-xS(r.height)/2,o=xS(r.width),i=xS(r.height);o>100&&(o=100,i=xS(r.height)*o/xS(r.width),e=0,a=50-i/2),i>100&&(i=100,o=xS(r.width)*i/xS(r.height),e=0,a=50-o/2),r={...r,x:IS(e),y:IS(a),width:IS(o),height:IS(i)},px({[n.id]:{position:r}},t)}})(a.id,t),r(Kh({id:a.id,type:"layer"})),o.animation&&l){const e=h_(o.animation.animationName);e.transitionDuration=o.animation.transitionDuration,mN(a.id,e)}}else{const o=y(),n=Ii();for(let a=0;a<c.length;a+=1){const o=c[a];mn(o)&&o.url?(await _z({url:o.url,options:{layerProperties:o,skipCML:!0}}),r(Kh(null))):RB(o,{undoable:t,isReplacing:!0});const n=e.layers[a];if(n.animation&&l){const e=h_(n.animation.animationName);e.transitionDuration=n.animation.transitionDuration,mN(o.id,e)}}gV(c.map((e=>e.id)),o,!0,t),r(Vh(o,!1,t));const i={x:50,y:50};if(a.position){const{x:e,y:t,width:o,height:n}=a.position,r=xS(e),s=xS(t),l=xS(o),d=xS(n);i.x=r+l/2,i.y=s+d/2}((e,t=!0,a={x:50,y:50})=>{const{state:o}=tn(),n=o.studio.scenes[0];if(!n)return;const r=o.studio.groups[e];if(!r)return;const i=r.layers.map((e=>e.id)),s=n.layers.filter((e=>i.includes(e.id))),l={width:o.studio.width||0,height:o.studio.height||0};let d=null;const c=dA(s,0);if(c.width>l.width){const a=l.width-c.width;if(d={width:l.width,height:c.height*l.width/c.width,x:c.x-a/2,y:c.y-a/2},d.height>l.height){const e=l.height-d.height;d={width:d.width*l.height/d.height,height:l.height,x:d.x-e/2,y:d.y-e/2}}MV(e,{initialPosition:c,currentPosition:d,transformerNode:"topLeft"},t)}const u=d?{x:d.x+d.width/2,y:d.y+d.height/2}:LS(s),m=QT(a.x,a.y),p=m.x-u.x,h=m.y-u.y;MV(e,{xDiff:p,yDiff:h},t)})(o,t,i),r(Vh(o,!0,t)),n&&(r(Vh(o,!1,t)),r(Kh(null)))}Jl.endBatch();const u=!!Hp.find((t=>t.templateId===e.templateId)),m=!!e.teamId;vc("Added Text Template",{templateId:e.templateId,isDefaulTemplate:u,isBrandkitTemplate:m,dndTimeline:void 0!==a.timelineRow,dndCanvas:void 0!==a.position})};function Mz(){const e=xD(),t=tr((e=>e.teams.selectedTeamId)),{brandkitTemplates:a,templates:o}=tr((e=>e.textTemplates)),[n,i]=r.exports.useState(!1);if(r.exports.useEffect((()=>{Az(t)}),[t]),r.exports.useEffect((()=>{!async function(){await(async()=>{const{dispatch:e,state:t}=tn(),{templates:a,lastAssetUrlSignedAt:o}=t.textTemplates;if(Date.now()-(o||0)<144e5)return;const n=(e=>{const t=[];return e.forEach((({layers:e})=>{e.forEach((e=>{e.asset_id&&t.push(e.asset_id)}))})),t})(a);if(n.length)try{const t=await AD(n),o=a.map((e=>((e,t)=>{const{layers:a}=e,o=a.map((e=>{const{asset_id:a}=e;return a&&t[a]?{...e,url:t[a]}:e}));return{...e,layers:o}})(e,t)));e(Xp({templates:o})),e(rh(Date.now()))}catch(r){console.error("refreshSubtitlePresetFontAssetUrls err",r)}})(),e.current&&i(!0)}()}),[e]),!n)return{templates:[],brandkitTemplates:[]};const s=new Set(a.map((e=>e.templateId))),l=o.filter((e=>e&&e.templateId&&!s.has(e.templateId)));return{templates:Kp(l),brandkitTemplates:a}}const Uz=({template:e,isBrandkit:t})=>{const a=m.exports.useDispatch(),o=XD(Ps.TEXT_PRESETS),n=HU(),r=!t||o,s=[];return s.push(i.createElement("div",{className:DG,onClick:()=>{const a=()=>{t?Rz(e.templateId):Nz(e)};if(o)a();else{n(a,{action:Rs.TEXT_PRESETS})()}}},i.createElement("span",{style:{marginRight:4}},t?"Remove from Brand Kit":"Add to Brand Kit"),!o&&i.createElement(Pn,null))),r&&s.push(i.createElement("div",{className:DG,onClick:async()=>{const r=async()=>{a(eh({templateId:e.templateId,undoable:!t})),t&&await Rz(e.templateId)};if(o||!t)await r();else{n(r,{action:Rs.TEXT_PRESETS})()}}},"Remove template")),i.createElement(JU,{content:i.createElement(Le,{color:"gray",size:14}),options:s})},Bz="TemplatePreview-module_container_6p3Bp",Wz="TemplatePreview-module_brandkit_fHGvN",Vz="TemplatePreview-module_more_05Ink",jz="TemplatePreview-module_brandkitIcon_k1IVU";function Gz({id:e,fileName:t}){return{type:"ADD_UPLOAD_STATUS",id:e,fileName:t}}function Hz(e,t){return{type:"UPDATE_UPLOAD_STATUS",id:e,updates:t}}const zz=["library","resources","samples","static","team_assets","assets","conversions"],$z=["%252F","%2F"];function Kz(e){if(null==e)return null;let t=e;for(const a of $z)for(const e of zz)t.startsWith(`${e}${a}`)&&(t=decodeURIComponent(t));return t}function Yz(e){if(null==e)return[null,null];if(!e||"string"!=typeof e)return[null,null];const t=e.split("?",1)[0];if(!t)return[null,null];let a,o;if(t.startsWith(Fr)){const e=t.slice(Fr.length).split("/");[,a]=e,o=e.slice(2).join("/")}else if(t.startsWith("https://cdn.kapwing.com"))a="kapwing",o=t.slice("https://cdn.kapwing.com".length+1);else if(t.startsWith(Ur))a=Or,o=t.slice(Ur.length+1);else{a=Or;try{o=new URL(t).pathname}catch(YEe){}}return"undefined"===a&&(a=Or),[a,Kz(o)]}function qz(e){var t,a;const o=new Date,n=nd();return{projectName:e.projectName,dimensions:e.dimensions,done:!1,duration:e.duration,editorPath:e.editorPath,isGif:e.sourceVideo&&e.sourceVideo.isGif,isImage:e.sourceVideo&&e.sourceVideo.isImage,lastSeen:o,parentId:e.parentId,pastedUrl:e.sourceVideo&&e.sourceVideo.pastedUrl?e.sourceVideo.pastedUrl:void 0,privacy:null!=(a=null==(t=null==n?void 0:n.settings)?void 0:t.defaultPrivacy)?a:ii.unlisted,progressText:"Saved ...",sourceVideo:e.sourceVideo,submittedAt:o}}function Xz(e,t){return(a,o)=>{const{currentUser:n}=o(),{token:r,user:i}=n||{},s={privacy:t,token:r,userId:i&&i._id};return yu(`/api/v1/videos/${e}/privacy`,{params:s})}}function Jz(e){return{type:"SET_PREVIEW_VIDEO",video:e}}function Qz(){return{type:"MARK_AS_STUDIO"}}function Zz(e){var t,a,o,n,r;let i=e||{};if((e.scenes||(null==(t=e.allLayers)?void 0:t.byId))&&(i=s.exports.cloneDeep(e),(null==(a=null==i?void 0:i.allLayers)?void 0:a.byId)&&Object.values(i.allLayers.byId).forEach((e=>{delete e.local_url})),e.scenes))for(const s in(null==(o=i.scenes[0])?void 0:o.layers)||[])null==(r=null==(n=i.scenes[0])?void 0:n.layers[s])||delete r.local_url;return{...i,layersPendingUpload:{},deletedLayerLocalBlobDict:{},deletedLayerDict:{}}}const e$=/^rgba?\((-?\d{1,3}), ?(-?\d{1,3}), ?(-?\d{1,3})(?:(?:, ?)([0,1](?:\.\d*)?|undefined))?\)$/i;function t$(e,t,a){const o={...e.studio.scenes[0]};o.layers=o.layers.map((t=>{var n;const r={...t},i=null==(n=e.studio.canvasDimensions)?void 0:n.canvasWidth,s=e.studio.width,l=r.fontSizeRaw||o.subtitle.fontSizeRaw,d=r.fontSizeRatio||o.subtitle.fontSizeRatio;let c;if(a)c=r.fontSize||o.subtitle.fontSize;else if(null!=i&&null!=s)c=null!=l?l/i*s:d*s;else{const e=s||i;c=d&&null!=e?d*e:r.fontSize||o.subtitle.fontSize}return"subtitle"===r.type&&(r.background=function(e){const{backgroundColor:t,backgroundOpacity:a}=e,o=t.match(e$);return"undefined"!==(null==o?void 0:o[4])&&a?t:"rgba(0, 0, 0, 0.6)"}(o.subtitle),r.backgroundStyle=o.subtitle.backgroundStyle,r.color=r.textColor||o.subtitle.fontColor,r.duration=r.endTime-r.startTime,r.fontFamily=o.subtitle.font,r.hasCustomFont=o.subtitle.hasCustomFont,r.url=o.subtitle.url,r.fontType=o.subtitle.fontType,r.source=o.subtitle.source,r.fontSize=c,r.fontSizeRatio=d,r.fontSizeRaw=l,r.fontStyle=r.fontStyle||o.subtitle.fontStyle,r.fontWeight=r.fontWeight||o.subtitle.fontWeight,r.lineWidth=o.subtitle.lineWidth,r.textAlign=r.textAlign||o.subtitle.textAlign,r.textVerticalAlign=o.subtitle.textVerticalAlign,r.fixedPosition=o.subtitle.fixedPosition,r.textShadow=o.subtitle.textShadow,r.textDirection="rtl"===je(r.text)?"rtl":"ltr",r.height=e.studio.height,r.width=e.studio.width,r.lineHeight=o.subtitle.lineHeight),r})),o.layers=ab(o.layers),e.studio.scenes=[o];const n=eb(e.studio.scenes),{currentUser:{user:r},currentUser:i}=e||{},s=a$(n),l=sc(i)?null==r?void 0:r._id:void 0,d=sc(i)?null==r?void 0:r.email:void 0;if(t){const t="Studio Draft"===e.projectName||""===e.projectName?"Studio Project":e.projectName;e.projectName=t}return{isCreator:!0,isStudio:!0,...Zz(e.studio),...qz(e),duration:n,creatorId:l,creatorEmail:d,watermark:s,sessionSettings:void 0,..."Cypress"in window&&{isCypress:!0}}}const a$=e=>{const t=ld();return!t.hasPermission(Ps.EXPORT_ALL_WITHOUT_WATERMARK)&&!(e<=30&&t.hasPermission(Ps.EXPORT_30_SEC_WITHOUT_WATERMARK))};const o$=e=>{const{snapshotCreatedOn:t,video_id:a,id:o,...n}=e;return{version_number:0,created_on:t,snapshot_type:"legacy",export:!0,id:o,content:n,video_id:a}};async function n$(e){try{return(e=>{if(0===e.length)return[];const t=[];for(let a=0;a<e.length;a+=1){const o=e[a];if("full_video"===(null==o?void 0:o.snapshot_type))t.push({...o});else if("patch"===(null==o?void 0:o.snapshot_type)){const e=t[t.length-1];if(e){if(Ge(o.diff,e.content))continue;t.push({...o,content:He(ze(e.content),o.diff).newDocument})}}else t.push(o$(e[a]))}return t})(await hu(`/api/v1/snapshots/${e}`))}catch(YEe){throw console.error(YEe),YEe}}async function r$({migrateToVersion:e,snapshot_id:t,video_id:a}){try{const o=e?{migrateToVersion:e}:{};return await hu(`/api/v1/snapshots/${a}/${t}`,{params:o})}catch(YEe){throw console.error(YEe),YEe}}async function i$(e,t=!1){if(!e._id)throw Error("No video id present");const a=await gu(`/api/v1/snapshots/${e._id}`,{body:{video:e,exportSnapshot:t}});if(a.error)throw a;return a}async function s$(){var e,t;const{state:a}=tn();if((null==a?void 0:a.currentVideo)&&(null==(e=null==a?void 0:a.currentUser)?void 0:e.user)){const e=await t$(a,!!a.currentVideo,!0);if(!e)throw Error("No video present");const o=e.scenes[0];if(!o)throw Error("No scene present");const{layers:n}=o;let r=0;for(;r<n.length&&"subtitle"!==(null==(t=n[r])?void 0:t.type);)r+=1;r<n.length&&(o.layers=n.slice(0,r));const i=await gu("/api/file-size-estimate",{body:{video:e}});if(i.error)throw i;return i.estimate}throw Error()}async function l$(e){const{state:t,dispatch:a}=tn(),o=t.studio._id,{asset_id:n,conversion_type:r,pastedUrl:i,resource:s,type:l,layer:d}=e,c={asset_id:n,resource:s,type:l,conversion_type:r,layer:d,video_id:o,fragment:"test"===fs().mse};i&&(c.pastedUrl=i);const u={asset_id:n,resource:s,type:l,conversion_type:r,video_id:o};vc("Conversion Begins",u);try{const e=await gu("/api/v1/conversions",{body:c}),{conversion_id:t,asset:o}=e;return o&&a(jP([o])),t}catch(m){console.error(m);const{message:e}=xu(m);throw vc("Conversion Fails",{...u,failureMessage:e}),m}}async function d$(e){if(!e)throw new Error("No conversion id present");const t=await hu(`/api/v1/conversions/${e}`).catch((e=>{throw console.error(e),e}));if(t.status===Zi.failed){vc("Conversion Fails",{asset_id:t.asset_id,conversion_id:e,failureMessage:"conversion status === failed"})}return t}async function c$(e,t){if(!e.length)return[];const{dispatch:a}=tn(),{uploadOptions:{multiRowUploadForRecording:o}}=t;let n=Array.from(e).sort(((e,t)=>e.lastModified-t.lastModified));o&&(n=n.sort(((e,t)=>"screen"===e.recordType?-1:1)));const r=new $e(8),i=(await Promise.all(n.map(((e,a)=>r.runExclusive((()=>async function(e,t,a){var o,n,r;const{dispatch:i,state:s}=tn();let l,d,c,u=e;const m=u$(t,a),{uploadOptions:{dragUpload:p,isMediaLibraryUpload:h,uploadLocation:g,doDuplicateHandling:y,convertToAudio:f,isThumbnail:E,analyticsUploadSource:v},validationOptions:w,uploadId:b}=m;E||(vc("Upload Started",{"File Type":e.type,"Size (MB)":e.size/1e6,"Upload Location":v}),h||bc(null!=(r=null==(n=null==(o=e.type)?void 0:o.split("/"))?void 0:n[0])?r:"unknown",v));const _=((e,t)=>{var a;const{audiogramUpload:o=!1,audioUpload:n=!1,disallowImages:r=!1,disallowGif:i=!1,disallowVideo:s=!1,fontUpload:l=!1}=t,d=aF(e);return d?(null!=(a=e.size)?a:0)>6442450944?"You file is over 6GB and cannot be uploaded.":0===e.size?`Your upload has an invalid size of ${e.size} bytes. Please choose a valid file to upload.`:i&&"image/gif"===d?"Removing background from gifs is currently not supported. We support .jpg, .png, .mp4, .mov, .webm, avi, flv, wmv, mkv, .ogg, and .mpeg formats for this feature.":!s||o||nF(d)?rF(d)||TF(d)||!n?rF(d)||TF(d)||!r?nF(d)||rF(d)||TF(d)||l?!l||d.endsWith("ttf")||d.endsWith("otf")?null:"Upload failed. Please upload a font with valid file types.":"Your file format is not currently supported. Currently we only support .gif, .jpg, .png, .mp4, .mov, .webm, avi, flv, wmv, mkv, .ogg, .mpeg formats.":"You must choose video/audio to use this feature. Currently we support .mp3, wav, .mp4, .mov, avi, flv, wmv, mkv, .webm, .ogg, .mpeg formats.":"Your file format is not currently supported. Currently we only support .mp3, wav, .mp4, .mov, avi, flv, wmv, mkv, .webm, .ogg, .mpeg formats.":"You must choose an image to use this feature. Currently we support .jpg, .png, and .gif formats.":"Your upload has an invalid type. Please choose a video or image to upload, and make sure your file has a correct extension."})(e,w);if(_)return i(Su({description:_,type:"error"})),w$(m),{};if(w.fontUpload){const t={...YH(),uploadId:b,type:ln.Image,source:"upload",name:e.name};y$(m,e,t)}else try{if(l=await qH(e,{uploadId:b,uploadLocation:p?"dragUpload":g,isMediaLibraryUpload:h},{addAtSeeker:t.uploadOptions.addAtSeeker}),f&&l.type!==ln.Image&&!l.hasAudio)throw l=void 0,new Error("Please upload a file with Audio");if(u=await _$(m,e,l),y){const t=N$(e),a=await t.arrayBuffer(),o=await crypto.subtle.digest("SHA-256",a);if(d=P$(o),d){const e=s.CMLFiles.byId;for(const t of s.CMLFiles.myMediaIds){const a=e[t];(null==a?void 0:a.hash)&&0===Buffer.compare(d,new Uint8Array(a.hash.data))&&(c=a)}}}await bF(u,l)&&(l.requireConversion=!0,delete l.local_url)}catch(T){const{message:t}=xu(T);Iu({description:"Upload Failed",error:T}),vc("Upload Fails",{FailStage:"Process File and Create Layer",Origin:g,Message:t,FileType:e.type,"File Size (MB)":e.size/1e6}),w$(m)}return{file:u,layer:l,bundle:m,hash:d,cmlDuplicate:c}}(e,t,a))))))).filter((({layer:e})=>e));return i.length?(a(xg(!0)),o||C$(i),async function(e){const{dispatch:t,state:{assets:{byId:a},editorPath:o,mediaCache:{assetIdToMediaCacheId:n},studio:{_id:r,selectedItem:i,allLayers:{byId:s}},studioLocal:{localProjectId:l},uploadStatuses:d}}=tn();let c=!1;await Promise.all(e.map((async({file:e,layer:o,bundle:u,hash:m,cmlDuplicate:p})=>{if(!o)return;const{omitFromMediaLibrary:h,fontUpload:g,isMediaLibraryUpload:f,replace:E,convertToAudio:v}=u.uploadOptions;let w;if(h||!o.uploadId||g||(w=y(),t(Pr({mediaCacheId:w,uploadId:o.uploadId}))),p&&!oH.forceNewAssets){!async function(e){const{dispatch:t}=tn();t(By({id:e.id,modified:new Date})),await yu("/api/v1/cloudMediaLibrary/myMedia/updateFileModifiedDate",{body:{cmlFileID:e.id}})}(p),t(nR(p,r));const m=p.asset_id,h=a[m],g=n[m];if((!g||!(await NH(g)))&&w)try{kH({mediaCacheId:w,type:o.type,file:e}),t(Nr({mediaCacheId:w,assetId:m}))}catch(b){console.error(b)}let y={};if(v&&(y={type:ln.Audio,convert_type:"audio"}),E&&i&&"layer"===i.type&&h){s[i.id]&&L$(p,h,y)}else!f&&h&&(R$(p,h,y),t(Og(m)));t(Hz(u.uploadId,{stage:lh.done})),c=!0;const _=l!==u.initialLocalProjectId;k$(o,d,u,{retries:0},{projectIdChanged:_,isDuplicateUpload:!0})}else{u.hash=m;try{if(o.requireConversion)o.conversion_type=tF(o.url,e.type),x$(u,e,o);else{if(w)try{const a=await kH({mediaCacheId:w,type:o.type,file:e});o.isMediaLibraryUpload&&t(ur(w)),a&&vc("Upload Failed IDB Add",{fileType:e.type,fileSize:e.size})}catch(_){console.error(_)}T$(u,e,o)}}catch(_){Iu({description:"Upload failed",error:_}),w$(u)}}})));const u=e[0];u&&e.length>1&&u.bundle.uploadOptions.multiRowUploadForRecording&&Jl.execInUndoBatch((()=>{const t=y();gV(e.filter((e=>e.layer)).map((e=>{var t;return(null==(t=e.layer)?void 0:t.id)||""})),t,!0,!0),xV(t,!0,!0)}));t(xg(!1)),c&&iT(o)}(i),i.filter((({layer:e})=>e)).map((e=>e.bundle.uploadId))):[]}function u$(e,t){var a;const o=y();let{analyticsUploadSource:n}=e.uploadOptions;const r=void 0!==t?null==(a=e.uploadOptions.analyticsUploadSources)?void 0:a[t]:null;return r&&(n=r),{eventHandlers:{...e.eventHandlers},initialLocalProjectId:tn().state.studioLocal.localProjectId,uploadOptions:{...e.uploadOptions,analyticsUploadSource:n},validationOptions:{...e.validationOptions},uploadId:o}}function m$(e,t){if(e.uploadOptions.skipUploadStatusUpdates)return;const{dispatch:a}=tn();a(Hz(e.uploadId,t))}async function p$(e,t){const{dispatch:a,state:o}=tn(),n=y(),{mediaLibraryID:r}=e;if("video"===e.type&&!e.file_v2)throw Error("Do not have the original file. Cannot reupload.");const i="video"!==e.type?e.file:e.file_v2.file,s={eventHandlers:{...t.eventHandlers},initialLocalProjectId:o.studioLocal.localProjectId,uploadOptions:{...t.uploadOptions},validationOptions:{...t.validationOptions},uploadId:n};s.uploadOptions.isThumbnail||vc("Upload Started",{"File Type":i.type,"Size (MB)":i.size/1e6,"Upload Location":t.uploadOptions.analyticsUploadSource,"Is Reupload":!0}),a(Pr({mediaCacheId:r,uploadId:n}));try{const e=await qH(i,{uploadId:n}),t=await _$(s,i,e);T$(s,t,e)}catch(l){Iu({description:"Upload failed",error:l}),w$(s)}}async function h$(e,t,a){let o=t;const n={};t.uploadId||(n.uploadId=y()),t.local_url||(n.local_url=URL.createObjectURL(e)),s.exports.isEmpty(n)||(px({[t.id]:n}),o={...t,...n});const r={...u$(a),uploadId:o.uploadId};r.uploadOptions.isThumbnail||vc("Upload Started",{"File Type":e.type,"Size (MB)":e.size/1e6,"Upload Location":a.uploadOptions.analyticsUploadSource,"Is Reupload":!0});const i=await _$(r,e,t);T$(r,i,o)}function g$(e){const{state:{uploadStatuses:t={}},dispatch:a}=tn(),o=t[e];if(!o)return;const{uploadManager:n}=o;null==n||n.cancel(),a({type:"DELETE_UPLOAD_STATUS",id:e})}const y$=(e,t,a)=>{var o;const{dispatch:n,state:r}=tn(),{teams:{selectedTeamId:i}}=r,{uploadId:s,uploadOptions:{isThumbnail:l,fontUpload:d,uploadSourceComponent:c,createTeamAsset:u}}=e,m=JD(Ps.UNLIMITED_EXPORT_DURATION_LIMIT),p=nd(r),h=(null==(o=null==p?void 0:p.settings)?void 0:o.defaultPrivacy)||ii.unlisted;m&&"duration"in a&&a.duration&&a.duration>7200&&n(Su({description:"Your file is longer than 2 hour. You must trim your video to publish.",type:"warning"})),!m&&"duration"in a&&a.duration!==1/0&&a.duration&&a.duration>420&&Su({description:"Your file is longer than 7 minutes. Trim or upgrade to export videos longer than 7 minutes.",type:"warning"});const g=h===ii.private||!l,y=new _E({analyticsUploadSource:e.uploadOptions.analyticsUploadSource,file:t,layer:a,isPrivate:g,onError:b$(e),onProgress:f$(e),onFinish:v$(e),onCancel:()=>w$(e),onRetry:E$(e),origin:a.uploadLocation,uploadSourceComponent:c});y.upload(),e.uploadOptions.skipUploadStatusUpdates||n(Gz({id:s,fileName:t.name})),m$(e,{fontUpload:d,uploadManager:y,omitFromMediaLibrary:e.uploadOptions.omitFromMediaLibrary,teamId:u?i:void 0})},f$=e=>(t,a,o)=>{if(!o.uploadId)return;const n=Math.round(100*t);let r=`Uploading ... ${n.toString()}%`;100===n&&"image/gif"===a.type?r="Processing your GIF ...":100===n&&"video/3gpp"===a.type&&(r="Converting file to mp4 ..."),m$(e,{progressText:r,progress:n,stage:lh.inProgress})},E$=e=>(t,a)=>{t.uploadId&&m$(e,{retryInfo:a})},v$=e=>async(t,a,o,n,r)=>{var i,s,l;const{uploadId:d,uploadOptions:{fontUpload:c,isThumbnail:u,createTeamAsset:m,createWorkspaceAsset:p,usedProFeature:h},hash:g}=e,{dispatch:y,state:f}=tn(),{studio:{_id:E},workspaces:{selectedWorkspace:v},teams:{selectedTeamId:w}}=f,b=nd(f),_=(null==(i=null==b?void 0:b.settings)?void 0:i.defaultPrivacy)===ii.private,T=t=>{m$(e,{stage:t})};if(200!==t.status)return void b$(e)(t.statusText||"An error occurred during upload. Please try again.",o,n,"onGCSUploadFinish");T(lh.onGCSUploadFinish);const[S,I]=Yz(a),x={bucket:S||Or,size:o.size,mime:o.type,name:o.name,hash:g,usedProFeature:h};if(I&&(x.blob_name=I),c){const e=null!=(l=null==(s=x.name)?void 0:s.split(".").pop())?l:"";n.mime=`font/${e}`}const k={fontUpload:c,skipSigning:!_&&u,skipCML:u||c};E&&(k.video_id=E),p&&(k.workspaceId=v),m&&(k.teamId=w),T(lh.createAsset);const{asset:C,cmlFile:A}=await UG(x,k),N={...C};n.conversion_type&&(N.conversion_type=n.conversion_type),c||HH(N,A,d);const P={...n,asset_id:C._id,source:"upload",url:a,uploadConfirmed:Date.now()};if(T(lh.assetCreated),n.requireConversion){T(lh.runConversion);const e=await l$({asset_id:C._id,resource:I,type:"blob",conversion_type:n.conversion_type,layer:P});P.conversion_id=e,P.videoConvertedState="begun",T(lh.addPendingConversion),await IH(e,n.id,n.name,d,null==A?void 0:A.id)}else"local_url"in n&&n.local_url&&(x.local_url=n.local_url);if(x.name&&(P.name=x.name),A&&(P.cmlFileId=A.id),C.ffprobeData){P.ffprobeData=C.ffprobeData;const{duration:e}=C.ffprobeData,t=Number(e);"number"!=typeof t||isNaN(t)||(P.duration=t)}const R=Lr(n);R&&y(yr(R)),c||u||(T(lh.updateCompletedUploadInIDB),!n.requireConversion&&R&&await xH(R,{url:P.url,asset_id:P.asset_id})),T(lh.handleFinish),S$(e,P,r),T(lh.done)},w$=e=>{const{uploadId:t,eventHandlers:{handleCancel:a},uploadOptions:{dragUpload:o}}=e,{dispatch:n,state:r}=tn(),i=r.mediaCache.uploadIdToMediaCacheId[t];i&&n(yr(i)),o&&"Scenes"!==uA()&&hT(),a&&a(t)},b$=e=>(t,a,o,n,r)=>{w({category:"Upload Flow Error",message:`ErrorType: ${n} layer: ${JSON.stringify(o)} file: ${JSON.stringify(a)}`}),r&&b(new Error(t));const{eventHandlers:{handleError:i},initialLocalProjectId:s}=e,{dispatch:l}=tn();if(tn().state.studioLocal.localProjectId!==s)return;m$(e,{stage:lh.errored}),null==i||i();let d=t;t||(d="An error occurred while uploading. Please try again later."),l(Su({description:d,type:"error"})),w$(e)},_$=async(e,t,a)=>{const{dispatch:o}=tn();e.uploadOptions.skipUploadStatusUpdates||o(Gz({id:e.uploadId,fileName:t.name}));const n=await ZO(t,(t=>m$(e,{progressText:t})),b$(e));if(t!==n&&(a.local_url=URL.createObjectURL(n)),n.type.includes("video")||n.type.includes("audio")){const e=await aH(n);a.duration=e}return n},T$=(e,t,a)=>{const{state:{editorPath:o}}=tn();try{I$(e,a,t),y$(e,t,a)}catch(YEe){console.error("error during upload ",YEe),b$(e)("An error occurred during upload. Please make sure your media is a compatible format.",t,a,"checkFileAndUpload"),iT(o)}},S$=(e,t,a)=>{const{state:{studioLocal:{localProjectId:o},uploadStatuses:n}}=tn();try{const{eventHandlers:{handleFinish:r},initialLocalProjectId:i}=e,s=o!==i;k$(t,n,e,a,{projectIdChanged:s,isDuplicateUpload:!1}),r&&!s&&r(t)}catch(YEe){console.error("error during upload ",YEe),b$(e)(`An error occurred during upload. ${YEe}`,void 0,t,"handleFinish");const{state:{editorPath:o}}=tn();iT(o)}},I$=(e,t,a)=>{m$(e,{preemptivelyAvailableAt:performance.now()});try{const{eventHandlers:{handlePreemptiveFinish:a},initialLocalProjectId:o,uploadOptions:{multiRowUploadForRecording:n,recordScreenAndCameraUpload:r},selectedGroupId:i}=e,s=tn().state.studioLocal.localProjectId!==o;a&&!s&&a(t,{multiRowUploadForRecording:n,selectLayerInCreator:!0,selectedGroupId:i,recordScreenAndCameraUpload:r})}catch(YEe){console.error("error during upload ",YEe),b$(e)(`An error occurred during upload. ${YEe}`,a,t,"handleFinish");const{state:{editorPath:n}}=tn();iT(n)}},x$=(e,t,a)=>{const{state:{editorPath:o}}=tn();try{I$(e,a,t),y$(e,t,a)}catch(YEe){console.error("error during upload ",YEe),b$(e)("An error occurred during upload. Please make sure your media is a compatible format.",t,a,"checkFileAndUpload"),iT(o)}};function k$(e,t,a,o,n){var r;if(!a.uploadOptions.isThumbnail)try{const i=Lr(e),s={"Layer Type":e.type,mime:e.mime,"Size (MB)":(null!=(r=e.size)?r:0)/1e6,"Layer Duration":"duration"in e&&e.duration||0,"Conversion Required":e.requireConversion||!1,"Project ID Changed During Upload":n.projectIdChanged,mediaCacheId:i,"Upload Retries":o.retries,"Upload Location":a.uploadOptions.analyticsUploadSource,"Duplicate Upload":n.isDuplicateUpload},l=null==t?void 0:t[a.uploadId];if(l){const e=performance.now();s["Overall Upload Duration"]=(e-l.beganAt)/1e3,l.preemptivelyAvailableAt&&(s["Time to on Canvas"]=(l.preemptivelyAvailableAt-l.beganAt)/1e3,s["Upload Duration after on Canvas"]=(e-l.preemptivelyAvailableAt)/1e3)}"ffprobeData"in e&&e.ffprobeData&&(e.ffprobeData.codec_name&&(s.Codec=e.ffprobeData.codec_name),e.ffprobeData.codec_long_name&&(s["Codec (Long)"]=e.ffprobeData.codec_long_name)),vc("Upload Finished",s)}catch(YEe){console.error(YEe),b(YEe)}}const C$=e=>{const t=e[0];if(!t)return;const{state:a,dispatch:o}=tn(),n=A$(),r=Fl(a);let i=void 0===r?0:ST();const s=e.filter((({layer:e})=>e)).some((({layer:e})=>e.duration)),l=e.every((({layer:e,bundle:t})=>!(!e||t.uploadOptions.isThumbnail)&&"image"===e.type)),d="make/slideshow"===a.studio.origin&&l;if(!a.studio.duration&&l){const t=e.filter((({layer:e,bundle:t})=>e&&"Media sidebar button - This Project"!==t.uploadOptions.analyticsUploadSource)).map((({layer:e,file:t})=>`${e.id} ${t.lastModified}`));if(o(Cg([...a.studioLocal.staticUploadIds,...t])),e.filter((({layer:e})=>e)).length>1){const t=y();gV(e.filter((({layer:e})=>e)).map((({layer:e})=>e.id)),t,!1,!1),e.forEach((({bundle:e})=>{e.selectedGroupId=t}))}}if(!a.studio.duration&&!s&&!d)return;const c=[n];e.forEach((({layer:t,bundle:a})=>{if(!t)return;if(a.uploadOptions.isThumbnail)return;if(t.requireConversion){const e=A$(c);return t.timelineRow=e,void c.push(e)}e.length>1&&(t.timelineRow=n);["video","audio"].find((e=>e===t.type))?(t.videoDelay=i,i+=t.duration||0):(t.isTrimmed=!0,t.startTime=i,t.endTime=i+3,i=t.endTime)}));const u=a.studio.selectedTimelineRows,m=1===e.length,p=UB({...t.layer},ST(),Math.min(...u,0));if(m&&p&&u.length>0&&(t.layer.timelineRow=Math.min(...u)),!a.studio.duration&&s){const e=a.studio.scenes[0];e&&BA(e,i,!0)}d&&(e=>{const{dispatch:t}=tn(),a=y(),o=e.filter((({layer:e})=>e)).map((({layer:e})=>e.id));t(q_("")),gV(o,a,!0,!0),t(Kh({id:a,type:"group"}))})(e)},A$=(e=[])=>{const{state:t}=tn(),a=t.studio.scenes[0];if(!a)return 0;const{layers:o}=a;if(!t.studio.duration&&o.length)return o.length;const n=[...o.map((e=>e.timelineRow||0)),...e];for(let r=0;r<n.length+1;r+=1)if(!n.includes(r))return r;return 0},N$=e=>new File([e],"tempFile",{type:e.type}),P$=e=>{const t=Buffer.alloc(e.byteLength),a=new Uint8Array(e);for(let o=0;o<t.length;o+=1)t[o]=a[o];return t},R$=async(e,t,a={})=>{const{state:o,dispatch:n}=tn(),{isAdding:r}=o.studioLocal;let i=t;if(r[i._id]||$B(i._id),t.url||(i=await GG(t._id,"addFromMediaLib"),n(jP([i]))),!i.url)return $B(i._id),console.error(`Could not create layer for cml file ${e.id}: asset has no url`),null;const{dimensions:s}=i;try{const t={addedFromMediaLibrary:!0,asset_id:i._id,cmlFileId:e.id,name:i.name||i.blob_name,mime:i.content_type,...s,...a},o=await D$(i,t);return SB(o),RB(o,{undoable:!0}),o}catch(l){return Iu({description:"Failed to add layer",error:l}),null}},L$=async(e,t,a={})=>{const{dispatch:o,state:n}=tn(),{isAdding:r}=n.studioLocal;let i=t;if(r[i._id]||$B(i._id),t.url||(i=await GG(t._id,"addFromMediaLib"),o(jP([i]))),!i.url)return $B(i._id),console.error(`Could not create layer for cml file ${e.id}: asset has no url`),null;const{state:{studio:{selectedItem:s,scenes:l}}}=tn(),d=l[0];if(!d)return null;const c=IB((null==s?void 0:s.id)||"");if(!c)return null;try{const o=await D$(i,{addedFromMediaLibrary:!0,asset_id:t._id,cmlFileId:e.id,...a}),n=jS(o,c);return LB(n,c,{knownTimelineRow:!0,sceneId:d.id,undoable:!0}),o}catch(u){return Iu({description:"Failed to replace layer",error:u}),null}},D$=async(e,t={})=>{const{state:a,dispatch:o}=tn(),{mediaCache:{assetIdToMediaCacheId:n}}=a;let r;const i=n[e._id];if(i&&(r=await(async(e,t,a)=>{const o=await NH(e);if(!o)return;const n=MH(o,["preview","original"]),r=UH(o,["preview","original"]);if(!n)return;const{id:i}=YH(),s={};let l=t.preview;if(l&&(null==r?void 0:r.duration)&&(null==r?void 0:r.width)&&(null==r?void 0:r.height)&&(l={...l,...r}),null==l?void 0:l.url)if(l.width&&l.height&&l.duration){const{width:e,height:t,duration:a}=l;s.preview={...l,width:e,height:t,duration:a,startTime:0,endTime:a}}else{const e=await sF(l.url,"video/mp4");if(!e.success)return;const{width:t,height:a,duration:o}=e.properties;s.preview={...l,width:t,height:a,duration:o,startTime:0,endTime:o}}if(t.track_preview){s.track_preview={...t.track_preview,mediaLibraryID:e};const a=MH(o,["track"]);a&&KT(i,{trackPreviewLocalUrl:URL.createObjectURL(a)})}return s.preview&&s.track_preview&&(s.addedFromOptimizedFile=!0),{id:i,url:t.url,asset_id:o.asset_id,type:o.type,...r,source:"upload",local_url:URL.createObjectURL(n),size:n.size,name:n.name,originalName:n.name,mime:n.type,addedFromMediaLibrary:!0,...s,...a}})(i,e,t)),!r){const a=i||y();r=await(async(e,t,a)=>{if(!e.url)return;const o={...e.preview,mediaLibraryID:t};if(o&&o.url)if(o.width&&o.height&&o.duration){const{width:e,height:t,duration:n}=o;a.preview={...o,width:e,height:t,duration:n,startTime:0,endTime:n}}else{const e=await sF(o.url,"video/mp4");if(!e.success)return;const{width:t,height:n,duration:r}=e.properties;a.preview={...o,width:t,height:n,duration:r,startTime:0,endTime:r}}const n={...e.track_preview,mediaLibraryID:t};n&&(a.track_preview=n);const r=JH(e);return await XH(e.url,a,{overwriteLayerType:a.type,mediaInfo:r})})(e,a,t),o(Nr({assetId:e._id,mediaCacheId:a}))}return r},O$=async(e,t={})=>{const a=await qH(e.file,{...t,uploadId:e.layer.uploadId});return RB(a,{undoable:!0}),a},F$=async(e,t={})=>{const{state:{studio:{scenes:a,selectedItem:o}}}=tn(),n=IB((null==o?void 0:o.id)||"");if(!n)return null;const r=await qH(e.file,{...t,uploadId:e.layer.uploadId}),i=jS(r,n);return LB(i,n,{knownTimelineRow:!0,sceneId:a[0].id,undoable:!0}),r},M$=async(e,t={})=>{var a,o;const{state:n}=tn(),r=null==(o=null==(a=n.uploadStatuses)?void 0:a[e])?void 0:o.uploadManager;r&&await O$(r,t)},U$=e=>m.exports.batch((()=>{const{dispatch:t,state:a}=tn(),o=xB().filter((t=>e.id===t.cmlFileId)).map((e=>e.id));zB({layerIds:o}),t(rR(e.id,a.studio._id))})),B$=e=>m.exports.batch((()=>{const t=xB().filter((t=>e===t.uploadId)).map((e=>e.id));zB({layerIds:t}),g$(e)})),W$=()=>m.exports.batch((()=>{const{dispatch:e,state:{CMLFiles:{byId:t},studio:{_id:a,thisProjectCMLFiles:o},uploadStatuses:n={}}}=tn();if(!o)return;const r=Object.values(o).map((e=>e.cmlFileId)),i=new Set(r),s=xB().filter((e=>e.cmlFileId&&i.has(e.cmlFileId))).map((e=>e.id));zB({layerIds:s}),Object.values(o).forEach((({cmlFileId:o})=>{const n=t[o];n&&e(rR(n.id,a))})),Object.entries(n).forEach((([e,t])=>{t.stage!==lh.done&&g$(e)}))})),V$=(e,t)=>{const a={};Object.keys(t).forEach((e=>{const o=e,n=t[o];void 0!==n&&(a[o]=n)})),bG(e,!0,a)},j$=(e,t)=>{Object.keys(t).forEach((e=>{t[e]})),Fz(e,!0,t)},G$=async e=>{const{dndAsset:t}=e,{url:a,width:o,height:n,query:r,urlSource:i,name:s,actionSource:l,mediaType:d}=t,c=d===ln.Video,u={layerProperties:{addedLayerFrom:{source:l,query:r},name:s,...e.layerProperties||{}},mediaInfo:{height:n,width:o,...c&&{duration:t.duration,hasAudio:t.hasAudio},...e.mediaInfo||{},type:d},pluginId:e.pluginId||"",isMediaLibraryUpload:e.isMediaLibraryUpload||!1,idOfLayerToReplace:e.idOfLayerToReplace||"",urlSource:e.urlSource||""};return i&&vc(`Add layer from ${c?"video":"image"} search`,{source:i}),_z({url:a,options:u})},H$=async(e,t)=>{switch(e.type){case gh.CML_FILE:return zU((()=>R$(e.cmlFile,e.asset,t)),{if:e.brandkitItem,action:Rs.BRANDKIT})();case gh.UPLOADING_LAYER:return M$(e.uploadId,{addedFromMediaLibrary:!0});case gh.SIDEBAR_IMAGE:return G$({dndAsset:e.image,layerProperties:t});case gh.SIDEBAR_VIDEO:{let a=!1;return e.video.videoRef&&(a=await lF(e.video.videoRef.current)),G$({dndAsset:{...e.video,hasAudio:a},layerProperties:t})}case gh.TEXT_PRESET:return V$(e.preset,t||{});case gh.TEXT_TEMPLATE:return j$(e.template,t||{});case gh.TRANSITION_TILE:default:return null}},z$=()=>{const[e,t]=r.exports.useState({x:0,y:0}),[a,o]=r.exports.useState({x:0,y:0});return r.exports.useEffect((()=>{const e=e=>{t({x:e.screenX,y:e.screenY})};return window.addEventListener("mousedown",e),()=>{window.removeEventListener("mousedown",e)}})),r.exports.useEffect((()=>{const e=e=>{o({x:e.screenX,y:e.screenY})};return window.addEventListener("mouseup",e),()=>{window.removeEventListener("mouseup",e)}})),{initialCoords:e,finalCoords:a}};function $$(e,t){const{layer:a,x:o,y:n,width:r,height:i,canvasHeight:s,rotation:l}=e,d=ST(),[c,u]=zS(a,0),m=c<=d&&d<=u;if(!a)return{};const p=JB(null!=t?t:null,a,r,i),h=a.stroke||"#000000",g=a.lineWidth||0,y=s?parseFloat(g)/100*s:0,f={top:n,left:o,width:r,height:i,transform:`rotate(${l}deg)`,boxShadow:m?`0 0 0 ${y}px ${h}`:"none",borderRadius:`${p}px`,opacity:1,zIndex:"auto"};return a.filters&&a.filters.opacity&&(f.filter=`opacity(${a.filters.opacity}%)`),f}const K$=({x:e,y:t,width:a,height:o})=>i.createElement("div",null,i.createElement("div",{style:{background:"rgba(88, 107, 216, 0.5)",left:e,top:t,width:a,height:o,display:"block",position:"absolute",overflow:"hidden",outline:"1px dashed gray"}})),Y$="Subtitle-module_subtitlesContainer_9V0yq",q$="Subtitle-module_subtitlesTextContainer_3hMuZ",X$="Subtitle-module_subtitleTextContainer_dddwg",J$=s.exports.memoize(zS);class Q$ extends r.exports.Component{constructor(e){super(e),a(this,"getSubtitleHeight",(()=>{const{layer:e}=this.props,t=document.getElementById(`subtitles-text-container-${e.id}`);return t&&t.offsetHeight?t.offsetHeight:0})),a(this,"updateLayerPosition",(()=>{const{textVerticalAlign:e,fixedPosition:t,studioHeight:a,studioWidth:o,containerHeight:n,containerWidth:r}=this.props,i=this.getSubtitleHeight(),s={x:0,width:o,height:i};if("top"===e&&(s.y=t*a),"middle"===e&&(s.y=t*a-i/2),"bottom"===e&&(s.y=t*a-i),(s.y||0)+i>=a?s.y=a-i:(s.y||0)<0&&(s.y=0),mT()){const e=(n-a)/2;s.y=(s.y||0)+e;const t=(r-o)/2;s.x=(s.x||0)+t}this.setState({position:s})})),a(this,"updateNewFontsizeLayerPosition",(()=>{var e;const{studioHeight:t,layer:a}=this.props;if(!document.getElementById(`subtitles-container-${a.id}`))return;const o=this.getSubtitleHeight();let n=(null==(e=this.state.position)?void 0:e.y)||0;if(mT()){n-=(this.props.containerHeight-t)/2}n+o>=t&&(n=t-o),n<0&&(n=0),this.updateFixedPosition(o,n||0)})),a(this,"updateFixedPosition",((e,t)=>{const{textVerticalAlign:a,studioHeight:o,setSubtitleFixedPosition:n,setUpdateSubtitlePosition:r}=this.props;let i=t/o;"middle"===a&&(i=(t+e/2)/o),"bottom"===a&&(i=(t+e)/o),n(i),r()})),a(this,"getFontSize",(()=>{const{studioWidth:e,canvasWidth:t,subtitle:a,layer:o}=this.props,n=o.fontSizeRaw||a.fontSizeRaw;if(null!=n)return n/t*e;return(o.fontSizeRatio||a.fontSizeRatio)*e})),a(this,"reloadFont",(()=>{const{layer:e}=this.props;e.fontFamily&&lB({type:"default",fontFamily:e.fontFamily},!0)})),a(this,"getStyles",(()=>{const{layer:e,textAlign:t}=this.props,{position:a}=this.state;if(!a)return{};const{x:o,y:n,width:r,height:i}=a,{textAlign:s}=e,l={position:"absolute",left:o,top:n,width:r,height:i};switch(s||t){case"right":l.placeItems="flex-end",l.textAlign="right";break;case"center":l.placeItems="center",l.textAlign="center";break;default:l.placeItems="flex-start",l.textAlign="left"}return l})),a(this,"renderSubtitle",(e=>{const{color:t,fontFamily:a,fontStyle:o,fontWeight:n,textAlign:r,backgroundColor:s,backgroundStyle:l,lineHeight:d,lineWidth:c,textShadow:u,studioWidth:m}=this.props,{fontWeight:p,fontStyle:h,textAlign:g,textColor:y}=e,f=g||r,{fontSize:E}=this.state,v={},w={};let b;if(u&&"none"!==u)switch(c){case"2":b=.5;break;case"7":b=1;break;case"12":b=1.5;break;default:b=0}const _={color:y||t,fontFamily:a,fontSize:`${E}px`,fontStyle:h||o,fontWeight:p||n,textAlign:f,lineHeight:d||1.2,textShadow:b?`-${b}px -${b}px 0 ${u}, ${b}px -${b}px 0 ${u}, -${b}px ${b}px 0 ${u}, ${b}px ${b}px 0 ${u}`:void 0},T=.8*E,S=.06*(null!=m?m:0);switch(l){case"full":Object.assign(v,{background:s,padding:`${T}px ${S}px`,width:"100%"}),Object.assign(w,{});break;case"wrap":Object.assign(v,{padding:`0 ${S}px`,width:"100%"}),Object.assign(w,{background:s,left:"left"===f?"0px":void 0,right:"right"===f?"0px":void 0,width:"fit-content"});break;default:Object.assign(v,{padding:`0 ${S}px`}),Object.assign(w,{left:"left"===f?"0px":void 0,right:"right"===f?"0px":void 0})}const I=e.text.match(/[^\r\n]+/g)||[],x=I.map(((e,t)=>i.createElement("span",{"data-cy":"subtitle-text-container",className:X$,dir:"rtl"===je(e)?"rtl":"ltr",key:`subtitle-${t}`,style:{...w,..._}},e,i.createElement("span",null,"wrap"!==l||t===I.length-1?null:" "),t!==I.length-1&&i.createElement("br",null))));return i.createElement("div",{className:q$,"data-cy":"subtitles-text-container",id:`subtitles-text-container-${e.id}`,key:e.id,style:v},x)})),this.state={fontSize:this.getFontSize(),subtitleHeight:0}}componentDidMount(){const{subtitle:e}=this.props;this.updateLayerPosition(),this.reloadFont();const t=this.getSubtitleHeight();this.setState({subtitleHeight:t}),e.hasCustomFont&&lB({type:"custom",fontFamily:e.font,url:e.url,asset_id:e.asset_id})}componentDidUpdate(e,t){const{backgroundStyle:a,containerHeight:o,containerWidth:n,fixedPosition:r,fontSizeRatio:i,layer:s,refreshKey:l,textVerticalAlign:d,updateSubtitlePosition:c,studioHeight:u,studioWidth:m}=this.props,{fontSizeRatio:p}=s;r&&e.fixedPosition!==r&&this.updateLayerPosition(),e.textVerticalAlign===d&&e.backgroundStyle===a&&e.updateSubtitlePosition===c||this.updateLayerPosition();const h=this.getSubtitleHeight();t.subtitleHeight!==h&&(this.updateLayerPosition(),this.setState({subtitleHeight:h})),(o&&o!==e.containerHeight||n&&n!==e.containerWidth)&&this.updateLayerPosition(),(i&&e.fontSizeRatio!==i||s.fontSizeRatio&&e.layer.fontSizeRatio!==s.fontSizeRatio)&&setTimeout(this.updateNewFontsizeLayerPosition,10),s.fontFamily!==e.layer.fontFamily&&this.reloadFont(),(m!==e.studioWidth||u!==e.studioHeight||i&&i!==e.fontSizeRatio||p&&p!==e.layer.fontSizeRatio||e.refreshKey!==l)&&this.setState({fontSize:this.getFontSize()})}render(){const{layer:e}=this.props;return i.createElement("div",{"data-cy":"subtitles-container",className:Y$,id:`subtitles-container-${e.id}`,style:this.getStyles()},e&&this.renderSubtitle(e))}}const Z$=TT(m.exports.connect((()=>(e,t)=>{const a=J$(t.layer),{studio:o}=e,{scenes:n}=e.studio,r=n[0],{subtitle:i}=r;return{absoluteTimes:a,backgroundColor:i.backgroundColor,backgroundStyle:i.backgroundStyle,canvasHeight:e.studio.canvasDimensions.canvasHeight,canvasWidth:e.studio.canvasDimensions.canvasWidth,color:i.fontColor,containerHeight:o.containerHeight,containerWidth:o.containerWidth,fixedPosition:null!=i.fixedPosition?i.fixedPosition:1,fontFamily:i.font,fontSizeRatio:i.fontSizeRatio,fontStyle:i.fontStyle,fontWeight:i.fontWeight,lineHeight:i.lineHeight,lineWidth:i.lineWidth,refreshKey:e.studio.refreshKey,scene:r,studioWidth:o.width||0,studioHeight:o.height||0,subtitle:i,subtitleProperties:i,textAlign:i.textAlign,textShadow:i.textShadow,textVerticalAlign:i.textVerticalAlign,updateSubtitlePosition:i.updateSubtitlePosition}}),(e=>me({setSubtitleFixedPosition:kw,setUpdateSubtitlePosition:xw},e)))(Q$)),eK=!Nl()&&!Rl(),tK=(e,t,a,o=null,n=!1)=>{let r="";if(e)for(const i in e){switch(i){case"contrast":case"brightness":case"saturate":r+=`${i}(${e[i]/100})`;break;case"opacity":n||(r+=`opacity(${e[i]}%)`);break;case"blur":void 0===e.blurPercent&&(r+=`blur(${e[i]}px)`);break;case"blurPercent":{let n=Math.min(t,a);if(o){const e=Od(t,a,o);n=Math.min(e.width,e.height)}r+=`blur(${Math.round(n*e[i]/100)}px)`;break}}r+=" "}return r},aK=e=>({mixBlendMode:e.foregroundBlendMode,opacity:e.foregroundOpacity}),oK=(e,t,a)=>{const o=e/255,n=t/255,r=a/255,i=Math.min(o,n,r),s=Math.max(o,n,r),l=s-i;let d=0;0===l?d=0:(s===o&&(d=(n-r)/l*60),s===n&&(d=60*(2+(r-o)/l)),s===r&&(d=60*(4+(o-n)/l)));return{H:d,S:0===s?0:l/s,V:s}},nK=(e,t,a,o,n,r,i,s=1)=>{e.save();let l=0,d=a;r>1&&(d=a*r),n&&(l=t,d=a),e.globalAlpha=s||1,i&&(e.globalCompositeOperation=i);const c=e.createLinearGradient(l,0,0,d);for(let u=0;u<o.length;u+=1){const e=o[u];c.addColorStop(e.start,e.color)}e.fillStyle=c,e.fillRect(0,0,t,a),e.restore()},rK=(e,t)=>{const{width:a,height:o}=t.canvas;e.background&&nK(t,a,o,e.background,e.backgroundAngle,e.backgroundGradientEnd)},iK=(e,t)=>{const{width:a,height:o}=t.canvas;e.foreground&&nK(t,a,o,e.foreground,e.foregroundAngle,e.foregroundGradientEnd)},sK=(e,t,a,o,n)=>{const{width:r,height:i}=t.canvas;e.background&&nK(t,r,i,e.background,e.backgroundAngle,e.backgroundGradientEnd),t.globalCompositeOperation=e.backgroundBlendMode,t.filter=e.styles,t.save(),t.globalAlpha=e.opacity,o&&n?t.drawImage(a,0,0,o,n,0,0,r,i):t.drawImage(a,0,0,r,i),t.restore(),e.foreground&&nK(t,r,i,e.foreground,e.foregroundAngle,e.foregroundGradientEnd,e.foregroundBlendMode,e.foregroundOpacity)},lK="SafariFilterImage-module_filterCanvasWrapper_bIuXn",dK="SafariFilterImage-module_backgroundCanvas_wvbgJ",cK="SafariFilterImage-module_imageCanvasWrapper_HxI2u",uK="SafariFilterImage-module_imageCanvas_6eZMk",mK="SafariFilterImage-module_foregroundCanvas_eZFbn",pK=({image:e,filter:t,style:a,sizeStyle:o})=>{const n=r.exports.useRef(null),s=r.exports.useRef(null),l=r.exports.useRef(null),d=r.exports.useRef(null),[c,u]=r.exports.useState(!1),m=r.exports.useCallback(((a,o)=>{const r=n.current,i=s.current;if(!r||!i)return;const{width:l,height:d}=r,c=i.getContext("2d");c&&t&&(c.save(),c.clearRect(0,0,l,d),o(t,c),c.restore());const u=a.getContext("2d");u&&e&&(u.drawImage(e,0,0,l,d),u.save(),u.globalCompositeOperation="source-in",u.drawImage(i,0,0,l,d),u.restore())}),[e,t]),p=r.exports.useCallback((()=>{const t=n.current,a=null==t?void 0:t.getContext("2d");if(!e||!t||!a)return;if(!c)return void setTimeout((()=>u(!0)),0);const{width:o,height:r}=t;if(0===o||0===r)return;a.drawImage(e,0,0,o,r);const i=l.current,s=d.current;i&&s&&(m(i,iK),m(s,rK))}),[e,m,c]);return r.exports.useEffect((()=>{p()}),[p]),i.createElement("div",{style:a,className:lK},i.createElement("canvas",{ref:s,style:{...o,opacity:0},width:(null==e?void 0:e.width)||0,height:(null==e?void 0:e.height)||0}),i.createElement("canvas",{ref:d,className:dK,style:o,width:(null==e?void 0:e.width)||0,height:(null==e?void 0:e.height)||0}),i.createElement("div",{className:cK,style:(h=t||{},{mixBlendMode:h.backgroundBlendMode,opacity:h.opacity,filter:h.styles,WebkitFilter:h.styles})},i.createElement("canvas",{ref:n,width:(null==e?void 0:e.width)||0,height:(null==e?void 0:e.height)||0,className:uK,style:o})),i.createElement("canvas",{ref:l,className:mK,style:{...aK(t||{}),...o},width:(null==e?void 0:e.width)||0,height:(null==e?void 0:e.height)||0}));var h},hK=({image:e,filter:t,layer:a,style:o,sizeStyle:n})=>{const s=tr((e=>e.studioLocal.layerTempValues)),l=r.exports.useRef(null),d=r.exports.useRef(null),c=r.exports.useRef(null),[u,m]=r.exports.useState(!1),p=r.exports.useCallback((()=>{const t=c.current;if(!t||!e)return!1;const{width:a,height:o}=t;if(a<0||o<0)return!1;const n=t.getContext("2d");if(!n)return!1;n.drawImage(e,0,0,a,o);try{return n.getImageData(0,0,a,o)}catch(YEe){return console.error("CANVAS ERROR",YEe),null}}),[e]),h=r.exports.useCallback(((e,t,o,n)=>{if(!a)return null;const{chromaKeyThresholdTemp:r,chromaKeyHueTldTemp:i,chromaKeySatTldTemp:l,chromaKeyValTldTemp:d}=s[a.id]||{},c=r||a.chromaKeyThreshold||0,u=i||a.chromaKeyHueThreshold||0,m=l||a.chromaKeySatThreshold||0,p=d||a.chromaKeyValThreshold||0;if("colorKey"===a.chromaKeyChannel){const{H:a,S:r,V:i}=oK(e,t,o);return!(Math.abs(n.H-a)>=u)&&(!(Math.abs(n.S-r)>=m)&&!(Math.abs(n.V-i)>=p))}const h="green"===a.chromaKeyChannel?t:o,g="green"===a.chromaKeyChannel?[e,o]:[e,t],y=Math.max(e,t,o);if(y!==h)return!1;return y-Math.max(...g)>255-c}),[a,s]),g=r.exports.useCallback((async()=>{var t,o,n;const r=l.current,i=null==r?void 0:r.getContext("2d");if(!a)return;const{chromaKeyChannel:s,chromaKeyColor:d}=a;if("colorKey"===s&&d===lp){if(r&&i&&e){const{width:t,height:a}=r;i.drawImage(e,0,0,t,a)}return}let u;if("colorKey"===s&&d){const e=parseInt(d.slice(1,3),16),t=parseInt(d.slice(3,5),16),a=parseInt(d.slice(5,7),16);u=oK(e,a,t)}if(r&&u&&c.current){const e=p();if(!e)return;const a=e.data;for(let r=0;r<a.length;r+=4)h(null!=(t=a[r])?t:0,null!=(o=a[r+1])?o:0,null!=(n=a[r+2])?n:0,u)&&(a[r+3]=0);((e,t,a)=>{if(!t||!a)return;const{width:o,height:n}=t,r=t.getContext("2d");if(!r)return;const i=null==a?void 0:a.getContext("2d");if(!i)return;i.imageSmoothingEnabled=!0;const{width:s,height:l}=a;try{r.putImageData(e,0,0),i.clearRect(0,0,s,l),i.drawImage(t,0,0,o,n,0,0,s,l)}catch(YEe){console.error("CANVAS ERROR",YEe)}})(e,c.current,l.current)}}),[a,p,h,e]),y=r.exports.useCallback((()=>{const o=l.current,n=null==o?void 0:o.getContext("2d");if(!o||!n||!e)return;if(!u)return void setTimeout((()=>m(!0)),0);const{width:r,height:i}=o;if(0===r||0===i)return;n.clearRect(0,0,r,i),(null==a?void 0:a.chromaKey)?g():n.drawImage(e,0,0,r,i);const s=d.current,c=null==s?void 0:s.getContext("2d");t&&c&&s&&(c.save(),c.clearRect(0,0,r,i),sK(t,c,e),c.restore(),n.save(),n.globalCompositeOperation="source-in",n.drawImage(s,0,0,r,i),n.restore())}),[e,t,g,null==a?void 0:a.chromaKey,u]);return r.exports.useEffect((()=>{y()}),[y,e]),i.createElement("div",null,Rl()&&t?i.createElement(pK,{filter:t,image:e,style:o,sizeStyle:n}):i.createElement(i.Fragment,null,i.createElement("div",{style:{display:"none"}},i.createElement("canvas",{ref:c,width:(null==e?void 0:e.width)||0,height:(null==e?void 0:e.height)||0})),i.createElement("canvas",{ref:d,style:{display:"none"},width:(null==e?void 0:e.width)||0,height:(null==e?void 0:e.height)||0}),i.createElement("canvas",{ref:l,width:(null==e?void 0:e.width)||0,height:(null==e?void 0:e.height)||0,style:eK?o:n})))};function gK(e,t,a,o){const n=Math.abs(e),r=Math.abs(t);let i=Math.abs(a),s=Math.abs(o);const l=n/r,d=i/s;let c=1,u=1,m=0,p=0;d<l?(c=n/i,u=n/i,s=n*s/i,i=n,p=Math.abs(s-r)/2):d>=l&&(c=r/s,u=r/s,i=r*i/s,s=r,m=Math.abs(i-n)/2);return{xScaleFactor:c,yScaleFactor:u,xOffset:-1*m,yOffset:-1*p}}function yK(e,t,a,o){if(!o)return{x:0,y:0,width:e,height:t};const n=aA(a,{x:0,y:0,width:o.naturalWidth,height:o.naturalHeight}),r=gK(e,t,n?n.width:o.naturalWidth,n?n.height:o.naturalHeight),i=aA(a,{x:0,y:0,width:r.xScaleFactor*o.naturalWidth,height:r.yScaleFactor*o.naturalHeight});return{x:r.xOffset-(i?i.x:0),y:r.yOffset-(i?i.y:0),width:r.xScaleFactor*o.naturalWidth,height:r.yScaleFactor*o.naturalHeight}}const fK=(e,t,a)=>{const o=Number(e.width);return{width:t,height:a,transform:`translate(${e.left}px, ${e.top}px) scale(${o/t})`,transformOrigin:"top left"}},EK=s.exports.memoize(zS);class vK extends r.exports.Component{constructor(e){super(e),a(this,"image",null),a(this,"handleClick",(()=>{const{selectItem:e}=this.props;e(null)})),a(this,"getImageContainerStyles",(()=>{var e;const{forMovingZoomControls:t,height:a,imageShadowBlurTemp:o,imageShadowDistTemp:n,imageShadowRotTemp:r,isBeingInlineCropped:i,layer:s,rotation:l,staticPreview:d,width:c,x:u,y:m,isWaitingForNextEPLayer:p,borderRadiusTemp:h,waitingForSeekToResolve:g}=this.props,{imageEffect:y}=s,[f,E]=this.props.absoluteTimes,{studioTime:v}=this.props,w=t||f<=v&&v<=E,b=JB(null!=h?h:null,s,c,a),_={x:"",y:""};(null==(e=s.position)?void 0:e.flip)&&!this.props.forMovingZoomControls&&Object.assign(_,{x:s.position.flip.x?" scaleX(-1)":"",y:s.position.flip.y?" scaleY(-1)":""});const T=!(d||w||p||g);let S="",I="";if(s.imageEffect&&"dropShadow"===y){const e=.5*(o||s.imageShadowBlur||0),t=n||s.imageShadowDist||0,a=(r||s.imageShadowRot||0)*Math.PI/180;S=`drop-shadow(${2*t*Math.cos(a)}em ${2*t*Math.sin(a)}em ${e}em ${s.imageEffectColor})`,(Rl()||Pl())&&(I="filter")}let x=l||0;return 0!==b&&l&&l%90==0&&0!==l&&(x+=1e-5),{position:"absolute",left:u,top:m,width:c,height:a,overflow:i?"visible":"hidden",zIndex:i?5:"auto",filter:S,willChange:I,transform:`rotate(${x}deg)${_.x}${_.y}`,display:T?"none":"block",borderRadius:`${b}px`}})),a(this,"checkAnimationType",(e=>e&&e.type&&"none"!==e.id)),a(this,"getSizeStyles",(()=>{const{width:e,height:t,layer:a}=this.props,o=yK(e,t,a.crop,this.image);return{width:o.width,height:o.height}})),a(this,"getImageStyles",(()=>{const{width:e,height:t,staticPreview:a,layer:o,duration:n,trackIsBeingManipulated:r,isWaitingForNextEPLayer:i,keyframeChannels:s,studioTime:l,forMovingZoomControls:d,absoluteTimes:c,tempFilters:u,waitingForSeekToResolve:m}=this.props,[p,h]=c,g=!(a||(d||p<=l&&l<=h)||i||m),y=yK(e,t,jI(o,l,r),this.image),f=w_(o);let E={};!a&&n&&"none"!==(null==f?void 0:f.id)&&(E=Bj(o));const v={position:"absolute",left:y.x,top:y.y,width:y.width,height:y.height};if(this.props.forMovingZoomControls)return v;const{width:w,height:b}=yK(e,t,rA,this.image),_=fK(v,w,b);let T=u||o.filters;s&&(T=Kb(o,s,l));return Vj({position:"absolute",filter:tK(T,e,t,o),display:g?"none":"block",..._},E)})),a(this,"getAnimationOutlineStyles",(()=>{var e;const{staticPreview:t,layer:a,duration:o}=this.props;let n={};const r=$$(this.props,null!=(e=this.props.borderRadiusTemp)?e:null),i=w_(a);return!t&&o&&"none"!==(null==i?void 0:i.id)&&(n=Bj(a,r.transform)),{...r,...n}})),a(this,"imageRef",(e=>{this.image=e,KT(this.props.layer.id,{layerRef:e})})),this.state={loaded:!1}}componentDidUpdate(){const{staticPreview:e,layer:t,duration:a,updateLayerAnimationPosition:o}=this.props,n=w_(t);if(!e&&a&&o)if("none"!==(null==n?void 0:n.id)){const e=Bj(t);n.layerInvolvesMovement&&o(e)}else this.checkAnimationType(n)&&o(void 0)}hasPresetFilter(){const{layer:e}=this.props;return e.presetFilter&&e.presetFilter.name&&"Original"!==e.presetFilter.name||!0===e.chromaKey}renderImage(){const{loaded:e}=this.state,{layer:t}=this.props,a=this.props.url&&((o=this.props.url).includes("cdn.kapwing.com")||o.includes("cdn.kapwing-useast1.com/"));var o;const n={};return!this.props.url||this.props.url.startsWith("blob:")||"pastedLink"===t.source||a||(n.crossOrigin="anonymous"),i.createElement("img",{"data-cy":"image",ref:this.imageRef,src:this.props.url,onLoad:()=>this.setState((e=>({...e,loaded:!0}))),className:[jj.image,jj.disableselect].join(" "),style:e&&!this.hasPresetFilter()?this.getImageStyles():{display:"none"},draggable:!1,alt:"Studio preview",...n})}renderFilterImage(){const{loaded:e}=this.state,{layer:t}=this.props;return i.createElement(hK,{image:this.image,filter:t.presetFilter,layer:t,style:e?this.getImageStyles():{display:"none"},sizeStyle:this.getSizeStyles()})}renderConversion(){return i.createElement("div",{className:jj.videoConversion},i.createElement(CO,{textStyles:{color:"white",fontWeight:600,fontSize:"12px",fontFamily:"Open Sans, sans-serif"},text:"Converting Image..."}))}render(){const e=this.getImageContainerStyles(),{layer:t}=this.props,{loaded:a}=this.state;return i.createElement("div",null,i.createElement("div",{className:jj.imageContainer,style:e},t.requireConversion&&this.renderConversion(),a&&this.hasPresetFilter()&&this.renderFilterImage(),this.renderImage()),i.createElement("div",{style:this.getAnimationOutlineStyles(),className:jj.outline,onClick:this.handleClick}))}}const wK=m.exports.connect((()=>{const e=ZS();return(t,a)=>{var o,n,r;const{imageShadowBlurTemp:i,imageShadowDistTemp:s,imageShadowRotTemp:l}=ul(t,a.layer.id),d=EK(a.layer),[c,u]=d;let m=!1;JS(u,a.studioTime,t.studio.studioPaused)&&(m=e(t,u));const p=Oj(a.layer.id);return{absoluteTimes:d,containerWidth:t.studio.containerWidth,containerHeight:t.studio.containerHeight,duration:t.studio.scenes[0].duration,isBeingInlineCropped:(null==(o=t.studioLocal.layerTempValues[a.layer.id])?void 0:o.isBeingInlineCropped)||null,isDraggingGlobal:t.studio.isDragging,isResizingGlobal:t.studio.isResizing,isRotatingGlobal:t.studio.isRotating,imageShadowBlurTemp:i,imageShadowDistTemp:s,imageShadowRotTemp:l,trackIsBeingManipulated:gl(t,a.layer.id),isWaitingForNextEPLayer:m,url:tT(a.layer),keyframeChannels:p(t),tempFilters:null==(n=t.studioLocal.layerTempValues[a.layer.id])?void 0:n.filters,borderRadiusTemp:null==(r=t.studioLocal.layerTempValues[a.layer.id])?void 0:r.borderRadiusTemp}}}),(e=>me({selectItem:Kh},e)))(vK),bK="\nprecision mediump float;\n\nattribute vec3 a_vertexPosition;\nattribute vec2 a_textureCoord;\nvarying vec2 v_textureCoord;\n\nuniform float u_rotation;\n\nvec2 rotateTexture(vec2 pixelCoord, float rotation) {\n  if(rotation == 0.0) return pixelCoord;\n\n  float angle = radians(-rotation);\n  float sine = sin(angle);\n  float cosine = cos(angle);\n\n  vec2 centerTranslation = - vec2(0.5, 0.5);\n  vec2 centeredCoord = pixelCoord + centerTranslation;\n  mat2 rotMatrix = mat2(cosine, -sine,\n                      sine, cosine);\n  vec2 rotatedCoord = rotMatrix * centeredCoord;\n\n  return rotatedCoord - centerTranslation;\n\n}\n\nvoid main() {\n  gl_Position = vec4(a_vertexPosition, 1.0);\n  v_textureCoord = rotateTexture(a_textureCoord, u_rotation);\n}\n",_K=(e,t,a)=>{const o=e.createShader(t);if(!o)return null;e.shaderSource(o,a),e.compileShader(o);return e.getShaderParameter(o,e.COMPILE_STATUS)?o:(console.error(e.getShaderInfoLog(o)),e.deleteShader(o),null)},TK=(e,t,a,o,n)=>{const r=t,i=t+o,s=a,l=a+n;e.bufferData(e.ARRAY_BUFFER,new Float32Array([r,s,i,s,i,l,r,l]),e.STATIC_DRAW)},SK=(e,t)=>{const a=e.FLOAT;e.vertexAttribPointer(t,2,a,!1,0,0)},IK=(e,t,a)=>{const o=_K(e,e.VERTEX_SHADER,t),n=_K(e,e.FRAGMENT_SHADER,a);if(!o||!n)return null;const r=e.createProgram();if(!r)return null;e.attachShader(r,o),e.attachShader(r,n),e.linkProgram(r);return e.getProgramParameter(r,e.LINK_STATUS)?(e.useProgram(r),r):(console.error(e.getProgramInfoLog(r)),e.deleteProgram(r),null)},xK=(e,t,a,o)=>{((e,t)=>{const a=e.getAttribLocation(t,"a_vertexPosition"),o=e.createBuffer();e.enableVertexAttribArray(a),e.bindBuffer(e.ARRAY_BUFFER,o),TK(e,-1,-1,2,2),SK(e,a);const n=e.getAttribLocation(t,"a_textureCoord"),r=e.createBuffer();e.enableVertexAttribArray(n),e.bindBuffer(e.ARRAY_BUFFER,r),TK(e,0,0,1,1),SK(e,n)})(e,t),((e,t)=>{const a=e.createTexture();e.bindTexture(e.TEXTURE_2D,a),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t)})(e,a),((e,t)=>{const a=e.getUniformLocation(t,"u_resolution");e.uniform2f(a,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height)})(e,t),kK(e,t,{u_rotation:[o]})},kK=(e,t,a)=>{for(const[o,n]of Object.entries(a)){const a=e.getUniformLocation(t,o);1===n.length?e.uniform1fv(a,n):2===n.length?e.uniform2fv(a,n):3===n.length?e.uniform3fv(a,n):4===n.length&&e.uniform4fv(a,n)}},CK=e=>{e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT);e.drawArrays(e.TRIANGLE_FAN,0,4)},AK=(e,t,a,o)=>{const{channel:n,threshold:r}=a;if(!n||void 0===r)return;const i=IK(e,bK,"\nprecision mediump float;\n\n//Passed in from the vertex shader\nvarying vec2 v_textureCoord;\n\n// global variables\nuniform sampler2D u_textureImage;\nuniform int u_channel;\nuniform float u_threshold;\n\n\nbool shouldKeyOut(vec4 color) {\n  float channelValue = color.g;\n  vec2 otherChannels = color.rb;\n  if(u_channel == 2) {\n    channelValue = color.b;\n    otherChannels = color.rg;\n  }\n\n  float maxValue = max(max(color.r, color.g), color.b);\n  if(maxValue != channelValue) return false;\n\n  float midValue = max(otherChannels[0], otherChannels[1]);\n  return maxValue - midValue > 1.0 - u_threshold;\n\n}\n\nvoid main() {\n  // get pixel color from the texture.\n  vec4 color = texture2D(u_textureImage, v_textureCoord);\n\n  float transparency = 1.0;\n  if(shouldKeyOut(color)) transparency = 0.0;\n  gl_FragColor = vec4(color.rgb, transparency);\n}\n");if(!i)return;((e,t,a)=>{for(const[o,n]of Object.entries(a)){const a=e.getUniformLocation(t,o);1===n.length?e.uniform1iv(a,n):2===n.length?e.uniform2iv(a,n):3===n.length?e.uniform3iv(a,n):4===n.length&&e.uniform4iv(a,n)}})(e,i,{u_channel:["green"===n?1:2]}),kK(e,i,{u_threshold:[r/255]}),xK(e,i,t,o),CK(e)},NK=(e,t,a,o)=>{e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0);const{channel:n}=a;"colorKey"===n?((e,t,a,o)=>{const{key:n,hueThreshold:r,satThreshold:i,valThreshold:s}=a;if(!n||void 0===r||void 0===i||void 0===s)return;const l=IK(e,bK,"\nprecision mediump float;\n\n//Passed in from the vertex shader\nvarying vec2 v_textureCoord;\n\n// global variables\nuniform sampler2D u_textureImage;\nuniform vec3 u_key;\nuniform float u_hueThreshold;\nuniform float u_satThreshold;\nuniform float u_valThreshold;\n\nvec3 rgbToHsl(vec4 rgb) {\n  const float degMultiplier = 60.0;\n  const float greenRotation = 2.0;\n  const float blueRotation = 4.0;\n\n  //WebGL colors are already in the 0 to 1 range\n  float minColor = min(min(rgb.r, rgb.g), rgb.b);\n  float V = max(max(rgb.r, rgb.g), rgb.b);\n  float C = V - minColor;\n\n  float H = 0.0;\n  if(C != 0.0) {\n    if (V == rgb.r) H = degMultiplier * ((rgb.g - rgb.b) / C);\n    if (V == rgb.g) H = degMultiplier * (greenRotation + (rgb.b - rgb.r) / C);\n    if (V == rgb.b) H = degMultiplier * (blueRotation + (rgb.r - rgb.g) / C);\n  }\n\n  float S = 0.0;\n  if(V != 0.0) {S = C / V;}\n  return vec3(H, S, V);\n\n}\n\nbool shouldKeyOut(vec3 hsl) {\n  if (abs(u_key[0] - hsl[0]) >= u_hueThreshold) return false;\n  if (abs(u_key[1]- hsl[1]) >= u_satThreshold) return false;\n  if (abs(u_key[2] - hsl[2]) >= u_valThreshold) return false;\n  return true;\n}\n\nvoid main() {\n  // get pixel color from the texture.\n  vec4 color = texture2D(u_textureImage, v_textureCoord);\n\n  float transparency = 1.0;\n  if(shouldKeyOut(rgbToHsl(color))) transparency = 0.0;\n  gl_FragColor = vec4(color.rgb, transparency);\n}\n");if(!l)return;xK(e,l,t,o);const d={u_key:[n.H,n.S,n.V],u_hueThreshold:[r],u_satThreshold:[s],u_valThreshold:[i]};kK(e,l,d),CK(e)})(e,t,a,o):AK(e,t,a,o)},PK=(e,t,a,o,n,r,i,s)=>{if("audio"===e.type&&!e.isAudiogram)return{};const l=i?Kb(e,i,s):e.filters;let d={filter:tK(l,n,r,e),display:"audio"===e.type?"none":"block",opacity:1,...o};const c=w_(e),{introTransition:u,outroTransition:m}=T_(e);if(!t&&("none"!==(null==c?void 0:c.id)||u||m)){const t=Wj(e,!!a,d.transform||"",u),o=Wj(e,!!a,d.transform||"",m);d={...Vj(d,Bj(e,d.transform||"")),...t,...o}}return d},RK=(e,t,a,o)=>{const n=function(e,t,a){const o=aA(a,{x:0,y:0,width:t[0],height:t[1]}),n=gK(e[0],e[1],o?o.width:t[0],o?o.height:t[1]),r=aA(a,{x:0,y:0,width:n.xScaleFactor*t[0],height:n.yScaleFactor*t[1]});return{x:n.xOffset-(r?r.x:0),y:n.yOffset-(r?r.y:0),width:n.xScaleFactor*t[0]||e[0],height:n.yScaleFactor*t[1]||e[1]}}(t,a,e),{width:r,height:i}=DK(a,[n.width,n.height]);return{position:"relative",left:n.x,top:n.y,width:o?n.width:r,height:o?n.height:i}},LK=(e,t)=>{const{width:a,height:o}=RK(rA,e,t);return{width:Number(a),height:Number(o)}},DK=(e,t)=>{const[a,o]=t,n=e[1]?e[0]/e[1]:t[0]/t[1],r=Math.ceil(a),i=Math.ceil(o);let s,l;return r-a>i-o?(l=r,s=r*(1/n)):(s=i,l=i*n),{width:l,height:s}};const OK=async(e,t,a,o)=>{let n=((e,t)=>{const{state:a}=tn(),{draggedTracksOverrides:o={}}=a.studioLocal,n=Ld(e),r=!!o[e.id];let i=1;e.playbackRate&&(i=e.playbackRate);let s=t;return s-=e.videoDelay||0,s>n&&!r&&(s%=n),s*=i,s+=e.startTime||0,e.isReversed&&(s=e.duration-s),s})(e,a);if(n>=t.duration&&(n=t.duration-.01),e.isReversed){const t=e.duration-n;o&&(o.currentTime=t)}if(jT(t.currentTime,n,1/30)&&0!==t.currentTime)return;const r=new Promise((e=>{t.onseeked=()=>{e()}}));t.currentTime=n,await r},FK={slow:3,default:1,fast:.5},MK={invertedParabola:(e,t=!0)=>t?1-(1-e)*(1-e):(1-e)*(1-e)},UK=(e,t,a)=>({startTime:a-t,endTime:a-e}),BK=(e,t,a)=>({startTime:-1*(t-a),endTime:-1*(e-a)});class WK{constructor(){a(this,"mutexes",new Map)}getMutex(e){const t=this.mutexes.get(e);if(t)return t;const a=new We;return this.mutexes.set(e,a),a}async runExclusive(e,t){return this.getMutex(e).runExclusive(t)}}const VK=e=>e/1e3,jK=(e,t)=>{GK.components[e].numberOfRenders+=1,GK.components[e].totalDuration+=t,GK.components[e].totalSquaredDuration+=t*t};let GK={components:{Canvas:{numberOfRenders:0,totalDuration:0,totalSquaredDuration:0},"Main Studio View":{numberOfRenders:0,totalDuration:0,totalSquaredDuration:0},"Studio Trackpad":{numberOfRenders:0,totalDuration:0,totalSquaredDuration:0}},"Project fetch time":[],waveforms:{}};function HK(){const e=tr((e=>e.studioLocal.isProjectFetched));return r.exports.useEffect((function(){if(e)return()=>{};const t=performance.now();return()=>{const e=performance.now();GK["Project fetch time"].push(VK(e-t))}}),[e]),r.exports.useEffect((function(){return GK={components:{Canvas:{numberOfRenders:0,totalDuration:0,totalSquaredDuration:0},"Main Studio View":{numberOfRenders:0,totalDuration:0,totalSquaredDuration:0},"Studio Trackpad":{numberOfRenders:0,totalDuration:0,totalSquaredDuration:0}},"Project fetch time":[],waveforms:{}},()=>{var e;const t={...Vc()},a=GK["Project fetch time"].reduce(((e,t)=>e+t),0)/GK["Project fetch time"].length;t["Project fetch time"]=Number.isNaN(a)?null:a;for(const[c,u]of Object.entries(GK.components)){const{numberOfRenders:e,totalDuration:a,totalSquaredDuration:o}=u,n=a/e,r=o/e-n*n,i=Math.sqrt(r);t[`${c} (Avg)`]=Number.isNaN(n)?null:n,t[`${c} (Std)`]=Number.isNaN(i)?null:i,t[`${c} (Count)`]=e}const o=VK(performance.now());let n=0,r=0,i=0,s=0,l=0;const d=[];for(const[c,u]of Object.entries(GK.waveforms)){let t=0;void 0===u.duration?(n+=1,t=o-u.startTime,l+=t):(t=u.duration,r+=1,i+=u.duration,s+=null!=(e=u.fileDuration)?e:0),t>=600&&d.push({assetId:c,videoDuration:u.fileDuration,completed:void 0!==u.duration,generationTime:t})}t["Avg waveform generation time"]=i/r,t["Avg unfinished waveform time"]=l/n,t["Generation time per asset second"]=i/s,vc("Performance Baseline",t),d.length>0&&Math.random()<.2&&d.forEach((e=>{vc("Long waveform generation",{...e,...Vc()})}))}}),[]),null}const zK=23,$K=1,KK=30,YK=29,qK=Math.log(30),XK=Math.floor(110.25),JK=new We,QK=new WK,ZK=Rl(),eY=(e,t)=>new Promise(((a,o)=>{const n=e.decodeAudioData(t);n&&"then"in n?n.then((e=>a(e))).catch((e=>o(e))):e.decodeAudioData(t,(e=>a(e)),(e=>{e&&o(e)}))})),tY=e=>MH(e,["track","preview","original"]),aY=e=>{var t,a,o;return"video"===e.type?(null==(t=e.trackOptimizedPreviewFile_v2)?void 0:t.duration)||(null==(a=e.optimizedPreviewFile_v2)?void 0:a.duration)||(null==(o=e.file_v2)?void 0:o.duration):e.duration},oY=e=>JK.runExclusive((async()=>{var t,a;window.AudioContext=window.AudioContext||window.webkitAudioContext;const o=await e.arrayBuffer(),n=new AudioContext,r=await eY(n,o),i=new OfflineAudioContext(r.numberOfChannels,22050*r.duration,22050),s=i.createBufferSource();s.buffer=r,s.start(0),s.connect(i.destination);const l=await(d=i,new Promise(((e,t)=>{d.oncomplete=t=>e(t.renderedBuffer);const a=d.startRendering();a&&a.catch&&a.catch((e=>t(e)))})));var d;const c=l.getChannelData(0),u=new Float32Array(Math.floor(c.length/XK));for(let e=0,h=0;e<c.length;e+=XK,h+=1){let a=0;for(let n=0;n<XK;n+=1)a+=Math.abs(null!=(t=c[e+n])?t:0);const o=a/XK;u[h]=o}const m=u.filter((e=>e>.01)).sort(((e,t)=>e-t)),p=1/(m.length>0&&null!=(a=m[Math.floor(.95*m.length)])?a:1);if(1!==p)for(let e=0;e<u.length;e+=1){const t=u[e]*p,a=Math.log(29*t+1)/qK;u[e]=a}return[u,{duration:l.duration,sampleRate:l.sampleRate/XK,scalingFactor:p}]}));class nY{constructor(e,t){a(this,"dataArray"),a(this,"duration"),a(this,"sampleRate"),a(this,"isFfmpeg"),a(this,"scalingFactor"),a(this,"unallocate",(()=>{this.dataArray=new Float32Array})),this.dataArray=new Float32Array(t),this.duration=e.duration,this.sampleRate=e.sampleRate,this.isFfmpeg=e.isFfmpeg,this.scalingFactor=e.scalingFactor}static async fromDataFile(e){const t=await e.file.arrayBuffer();return new nY(e,t)}}const rY={audio:{desktop:100*Br,lowendDesktop:30*Br,mobile:10*Br},video:{desktop:1.9*Wr,lowendDesktop:200*Br,mobile:100*Br}};async function iY(e){var t;try{const t=new Worker("/waveform-worker.js");t.postMessage({sourceFile:tY(e)});const{data:a,duration:o}=await new Promise((e=>{t.onmessage=a=>{t.terminate(),a.data&&e({data:a.data.data,duration:a.data.duration})}}));return{file:new File([a],"file"),duration:o,sampleRate:a.length/o,isFfmpeg:!0}}catch(YEe){return lY({method:"ffmpeg",error:YEe.message,assetId:e.asset_id,assetDuration:aY(e),fileType:null==(t=tY(e))?void 0:t.type},YEe),null}}async function sY(e,t){var a;const o=Al(),n=o&&Nl(),r=tn().state.mediaCache.mediaCacheIdToAssetId[e],i=(()=>{if(o)return"mobile";if(!("memory"in performance))return"desktop";return performance.memory.jsHeapSizeLimit<2147483648?"lowendDesktop":"desktop"})(),s="audio"===t.type?"audio":"video",l=tY(t);if(!l)throw console.error(t),Error("No file");const d=sh(t)?null==(a=t.file_v2)?void 0:a.duration:t.duration;r&&((e,t)=>{GK.waveforms[e]={startTime:VK(performance.now()),fileDuration:t}})(r,d);let c;return!n&&l.size>rY[s][i]||ZK&&"video/quicktime"===l.type?c=await iY(t):(c=await async function(e){var t,a,o;try{const[o,n]=await oY(tY(e)),r=null!=(t=aY(e))?t:n.duration;if(Math.abs(n.duration-r)>=2){const{dispatch:t}=tn();t(Df({waveformCreationFailure:!0})),lY({method:"audioContext",error:"Waveform duration delta too large",assetId:e.asset_id,assetDuration:r,fileType:null==(a=tY(e))?void 0:a.type},new Error("Waveform duration delta too large"))}return{file:new File([o],"file"),duration:n.duration,sampleRate:n.sampleRate,scalingFactor:n.scalingFactor,isFfmpeg:!1}}catch(YEe){return lY({method:"audioContext",error:YEe.message,assetId:e.asset_id,assetDuration:aY(e),fileType:null==(o=tY(e))?void 0:o.type},YEe),null}}(t),c||(c=await iY(t))),c?(r&&(e=>{GK.waveforms[e]&&(GK.waveforms[e].duration=VK(performance.now())-GK.waveforms[e].startTime)})(r),xH(e,{waveformData_v5:c}),nY.fromDataFile(c)):null}const lY=(e,t)=>{console.error("Waveform log generation failed!!",e.error);const{dispatch:a}=tn();var o,n;b(t,{tags:{audioContextFailure:!0,assetId:e.assetId,fileType:e.fileType}}),a(Df({waveformCreationFailure:!0,waveformUsesFFMPEG:"ffmpeg"===e.method})),e.assetId&&(o=e.assetId,delete GK.waveforms[o]),n=e,vc("Waveform Generation Failure",{...n,...Vc()})};async function dY(e){const t=await NH(e);return t?"waveformData_v5"in t&&t.waveformData_v5?nY.fromDataFile(t.waveformData_v5):QK.runExclusive(e,(async()=>{const t=await NH(e);return t?"image"===t.type?null:"waveformData_v5"in t&&t.waveformData_v5?nY.fromDataFile(t.waveformData_v5):sY(e,t):null})):null}function cY(){return new Worker("/assets/chromakey-worker.047b7a99.js")}function uY(){return new Worker("/assets/reverseaudio-worker.2ae5bc59.js")}const mY=(e,t)=>!(e<0||e>64)&&(e<8?Boolean(t[0]&1<<e):e<16?Boolean(t[1]&1<<e-8):e<24?Boolean(t[2]&1<<e-16):Boolean(t[3]&1<<e-24)),pY=({blurPixels:e,image:t,createCanvas:a=((e,t)=>{const a=document.createElement("canvas");return a.width=e,a.height=t,a}),width:o,height:n})=>{if("number"!=typeof t.width||"number"!=typeof t.height)throw Error("Unexpected SVG image");const[r,i]=[o||t.width,n||t.height],s=3*e,l=a(r+2*s,i+2*s),d=l.getContext("2d");if(!d)throw Error("Failed to create canvas ctx");const[c,u,m,p,h,g,y]=[t.width,t.height,r,i,s,r+s,i+s];return d.drawImage(t,0,0,c,1,h,0,m,h),d.drawImage(t,0,u-1,c,1,h,y,m,h),d.drawImage(t,0,0,1,u,0,h,h,p),d.drawImage(t,c-1,0,1,u,g,h,h,p),d.drawImage(t,0,0,1,1,0,0,h,h),d.drawImage(t,c-1,0,1,1,g,0,h,h),d.drawImage(t,0,u-1,1,1,0,y,h,h),d.drawImage(t,c-1,u-1,1,1,g,y,h,h),d.drawImage(t,h,h,m,p),[l,s]};async function hY(e){const{bucket_name:t,blob_name:a,url:o}=e;if(o)return o;if(t)return`${Fr}/${t}/${a}}`;try{if((await lu(`${Fr}/${Or}/${a}}`,{method:"HEAD"})).ok)return`${Fr}/${Or}/${a}}`}catch(YEe){}return`${Fr}/kapwing/${a}}`}const gY=({style:e,children:t,layer:a})=>i.createElement("div",{style:e,"data-cy":"filter-layer-style-wrapper"},i.createElement("div",{className:a.presetFilter?`cssco ${a.presetFilter.className}`:"","data-cy":"filter-style-wrapper"},t)),yY=e=>{const{width:t,height:a,x:o,y:n,background:r}=e,s="#ffffff"===r.toLowerCase()?"https://storage.googleapis.com/kapwing/samples/waveform_placeholder_purple.png":"https://storage.googleapis.com/kapwing/samples/waveform_placeholder_pwhite.png";return i.createElement("img",{style:{width:t,height:a,left:o,top:n},src:s,alt:"Waveform placeholder"})},fY=[[204.35838132923993,203.00945332832035,199.65900469732605,194.98271845278515,189.56132214289326,183.33473438912372,172.52400430499736,167.07532066537684,187.47065016402843,198.68807545388097,203.48982568521964,204.1176240653317,202.15691732602392,200.06529787993665,199.29780568337057,198.68467837138908,197.26189269581153,195.4906761781706,193.5894680197673,190.99841409170546,187.04933995236826,182.25360885686126,177.63250777500204,173.28407960282425,167.70417685616633,158.76226893469703,144.56500607291406,141.00209952410114,145.56804845329737,145.98247959194708,151.30333957601397,158.65594331047583,163.28351501985006,165.0274425332393,164.56009034724005,162.69563468431807,160.3371300218423,158.2700085578228,157.39999468815182,158.03471062124936,159.09200990304208,159.69089115160511,159.86921679067325,159.6075664376986,158.52087286589776,156.6650151944958,155.10307758735354,154.76731334199766,154.53817469416,152.83946762235234,149.7773929680549,146.91810966789785,145.2304213494264,144.0396936303876,142.34788989257112,140.02924475411893,137.86488379627102,136.94443024999612,137.23038873543342,137.02795358522172,135.09262390148805,131.78995127630665,127.15201700601123,118.07364045259453,92.95048846026552,111.58227970522246,129.45278563115795,138.2921805525958,143.1711053210688,145.54670069071844,146.10057562215798,145.83463815520878,146.36977981790818,148.0554387843523,149.43629769169783,149.03798836610676,145.92771765577686,140.3413699534398,134.16252749146054,130.7483709722678,129.62976562861337,128.55726783363963,128.17372090103626,128.68453448110859,129.61467268224547,131.37936708272957,133.615185772025,134.24522747949015,132.49724810152492,130.3479207101576,132.49438546853943,136.93991181373855,139.66216072746448,140.10834545254787,138.1270546398033,132.51069038452,120.69558867721602,89.01754914367318,110.34211587855022,120.83417434236462,122.36200772241834,119.71362583248677,117.22074187792266,119.75264768893518,126.5367395343374,132.2061093130478,133.96693353280494,130.6684966876412,123.6815217863759,126.52157795061277,134.62983091628038,139.3180272591702,140.28667668531253,137.62219818584865,131.98348466528336,124.07663570706792,114.2267694499014,103.44772202882844,92.9584608439638,83.35329993623219,82.46689771012865,75.82770036464417,66.06349703115293,98.03414526793118,111.33889876855572,118.98648423031145,122.54177224513953,122.47951959397489,118.64583070128839,113.87371352182163,119.12974241422387,127.33420020821598,131.46335674969552,131.3822456107658,127.3830481228133,119.37978564347974,107.60067684669835,111.66825278667098,124.05076277537741,131.22772394028615,134.48448788702927,134.7861839517469,131.92539177767685,127.40494750758486,124.68811639326971,123.8965060008981,120.9054998438967,114.88101986961341,109.76176859442026,112.1629841277428,119.27887876494424,124.82951411454222,128.02837046990257,129.85943432178908,131.89986646363,134.2959664200011,135.78516337340758,135.22114124260463,131.84250434163295,126.45507975231583,121.93106290183131,122.11921102289395,126.02335733427888,130.41644177850932,134.06653952639124,136.5638564699891,138.01616957258577,138.23945775755297,136.29941618189454,131.33912440717808,125.33728980410184,126.77827246986509,131.88614297305546,134.5995306065226,136.2399757750571,139.04068907529907,142.9197060262825,145.9078344918701,147.13650225775328,146.41335613205808,143.84972114295687,139.64912794324272,134.3253574737259,129.02642302040337,124.93796462149683,121.5393264193191,117.322732247941,114.73057166609908,118.8452229107018,125.32158129160658,130.25817923584472,133.19297336645127,134.27063636776148,133.61613697497285,131.3563797543291,127.81845352593217,124.49172753170508,123.7513624080227,124.38224504365684,121.98895450367736,114.08596503252865,105.82629767516569,110.88300039306839,119.90552132506646,127.202147201513,131.9667614478077,133.76958758760802,132.70781458819803,129.56830485026168,125.94077414424684,122.38418137561702,117.21442780157889,104.9489244287997,92.05361102549689,112.54203234883539,121.46683920506331,124.38005590514472,123.53852557520595,121.56477951652924,121.33882435595636,122.2275429466472,121.4062971945044,117.93754225866843,112.6971528635918,104.27515467306111,88.6528521160044,96.42663339577929,107.60183673130071,106.82225946173723,88.40507400283728,104.04178637381129,117.95828545895965,122.46746248313711,124.28669381415281,126.67005328527794,129.27522451899023,129.7650229950298,126.52643324838441,118.86804102107371,109.40834958178631,110.93113718338012,114.07121904322369,108.35331346001797,88.96705472009042,100.66853781444378,109.97573475103614,108.08517276324821,95.58895557030422,89.06300976096674,100.91403830932555,104.06730366572654,102.81085812399192,102.27248417282829,109.75997332490616,122.65446694505044,131.27973072984534,134.659499974981,132.34540824765594,122.983550056949,117.08732924209211,129.23091278150616,136.1537186103394,138.83472161916444,139.99022039298902,140.92873074735414,141.4350478891782,140.302255484849,137.183074064597,134.8362750409565,136.08173198415673,137.3102051022957,135.29421222826153,129.14481974035795,120.98443896939034,122.10389522255312,129.55517351459943,133.1448836556803,130.95005729684308,120.2247398448641,88.75300107301513,115.15603565056695,125.57494349672899,129.060984495252,130.1292469749284,130.3401027591469,129.43479875948742,127.3812776144528,128.0007642924076,131.7025425637015,133.04022544791667,130.59201431746015,123.86052071405743,111.95477123616325,105.70885785702148,118.51401850384497,127.74406905646723,132.76569119540864,134.50333751053557,133.95982949270305,133.34831260302562,135.23414699652548,138.76267935057723,141.77778219016764,143.28657189711944,142.627691535347,139.3644825559961,133.4722084696932,125.10044387363267,112.46111177234778,92.09275680431377,116.55997780602732,126.09832147776532,124.7534823951912,110.71875423547183,96.50112043365947,112.4485124681327,113.26506731234124,108.58103656834763,101.99803482567827,97.14913597763675,113.57660886046824,125.21760786245515,131.97504303651732,137.11982745823596,142.19699775863148,146.74299115161836,149.8110840053253,151.14779573703814,151.33695915010136,151.12865162025216,150.500088718598,148.7887948486843,145.75817203220814,142.99623735437788,143.01809980998883,145.25921794002127,146.94978222310706,145.90004561737913,140.90565004641883,132.09016956580749,120.14784234370435,115.32010047236865,127.36594813894344,133.55111744902817,133.779199329228,130.05306182494044,125.02575693885959,122.87310149941793,123.0047656386207,121.46331452528521,117.8741314694841,117.78964041278229,122.5987050435432,125.50729776735199,124.54332009302718,120.16906619959042,114.14090655164526,115.6280158581019,124.03749904425878,128.12242075902333,125.8990361446127,117.54157651579577,109.15688815418844,117.72541720595963,127.23209372584536,131.4583482182636,131.00135069548762,127.335942799752,121.62186226856994,114.22543748940511,114.85572068019748,122.37860097066992,126.59694202163297,127.4986334752324,125.67563125327746,122.00225729495378,119.92276357023357,122.23990555829354,126.51250740094001,129.903949786847,131.71070023688006,131.97553484395505,129.78930892615406,123.78174072681384,116.3424370534271,118.26378107046335,123.7633490117246,125.59327470473724,122.7324601126848,114.68183007149709,101.26825438324576,86.63384744011921,83.21618025600223,92.5882747839233,101.81575376052287,107.16764512838256,109.37281048707132,112.3974640636089,119.9366852918811,127.35884663106289,132.47940283462185,135.70218555776887,137.10112609991162,136.34754082287984,133.0083175599282,126.02857776304094,112.29113303317646,97.16001644870359,111.40431919504549,114.2106564702352,106.30950393288109,94.81430769903297,96.47370642704341,84.92532458224564,60.545487148081754,79.88039774315853,68.67596712239431,89.11906170616737,91.34917675692962,73.856623411296,90.26844758457986,104.1086223795779,111.58070017271665,116.49222512452609,118.90377264729761,118.22411457287104,114.23802667459175,107.40620915533147,100.60987015302861,97.57527844151682,97.34158232256256,98.10290657702991,98.66362467593973,101.7433519346422,106.2073561951195,108.69895880734114,110.8035723792059,112.15569136889091,109.49690243299439,103.93036448482624,100.92628029593007,97.86096217096936,95.66608809626983,101.03380856504565,108.34648051731253,116.07978807883318,123.8283548391442,130.54394791018052,135.56296750803784,138.76204157391325,140.13435297163534,139.4593490534493,136.21123380350022,129.43441998628626,117.31101607955178,103.73912043267357,112.44864947671577,118.98964903641227,121.21591071320593,121.98924397601607,122.15980962476785,121.38400859362196,119.26549450974018,116.8959893414305,115.88483515515084,114.78338677210779,112.33315907937443,107.62137119796489,98.73602747048403,87.73038295136323,91.13378536825944,101.16947207803058,106.2253997649699,104.13784134633754,100.52905925732327,105.68729473617451,108.82944337043381,105.65177463603948,99.53348804272758,99.12635127717267,101.89825121460251,104.22530938942084,106.5199998892505,109.53476613473762,113.18969053622115,115.68672529991734,115.68799615105743,113.54259565985197,111.07854773053354,109.34605744693557,106.82092535033571,101.93352157530809,95.15483646585035,85.77495510365729,71.47980071875158,56.42559082770286,37.29837819664849,61.63020725776271,60.59370173495803,29.06580455390409,48.298454080119065,55.25910173785193,49.07081918616964,27.913389433570206,46.06408623486975,65.30229863737705,69.00799421180668,62.951246181167086,78.39628391473362,92.91338861566796,101.18515479771182,107.06300736303153,112.21793848064252,116.14938312247597,118.20778576944683,118.84594635653883,119.06929816454088,119.14718314409345,118.36809783419976,116.29053669089575,113.1890980334156,109.04454487149671,102.72609076505472,92.41500440345374,76.33094400443694,52.15810967929434,60.53209431838238,74.51909568179593,71.77931834367912,39.82659016836722,60.1169244820835,62.52548851218519,62.11074567808925,63.45832055316442,46.8261122989831,57.52269917794884,70.21957081125319,80.99419298885374,93.73663259384219,102.81429704783874,108.98970049077947,114.1615558836602,118.65326487722758,121.47156722067137,121.70532057926238,119.0050512192624,113.91296124678925,108.02487100201645,102.45933706749719,99.47598191566438,103.07457144991398,107.83179905939933,109.71431398958043,111.18776497305835,115.9312322534841,122.2031968088484,127.06021086188508,129.01757233521474,127.38100954224436,121.95378438456284,113.88747930721628,108.24673019657541,108.8848456885361,110.8492682187245,110.54528629513362,106.91146973958499,100.23720183593618,93.09935251508304,88.52204668469803,83.40893002956824,75.3313841827785,73.00260059182122,74.77627146153478,76.25559930918028,84.45871817093106,89.97952576061537,91.3626377391236,91.7720533305402,92.52791684811231,92.58468973705524,90.10201677066587,83.06805232336963,69.79640996980096,59.46018368728643,64.53504442365393,64.72506424680589,48.59176666190088,42.997013594499144,58.400853744202436,49.148725852729285,19.301829008746356,45.525192245861724,34.586577726746604,32.89897205356545,37.35431487600631,39.36070499932478,47.28944881987594,55.80702434942269,58.31379853055729,53.27520107576588,51.77221796539581,59.30468018244898,64.77574569278,63.45891452054705,57.60286625521149,64.7802979806566,76.39692667582972,85.4774034636836,91.17797207425647,93.54958517538748,93.58937200947447,93.20455317792343,93.90957285858832,95.18829374855927,95.20282588854431,94.1588385341336,93.16395918149897,91.64607366999336,88.37909124667785,83.1975774402594,76.5085768647885,68.0130768674399,55.14813057328617,44.67960299230243,66.19961637978649,73.74863121315964,73.14806942281302,70.76269255868576,73.75017282602815,80.37283457139709,87.42884063345399,91.6920197763112,92.84484827437588,93.15688891664955,95.12943817890444,98.85873726821387,102.5135604044542,104.24947206735496,103.74848206676312,101.97082217522741,99.89393393504812,97.42699236602259,93.52313150722814,87.44822165948382,79.08988655073196,68.55796791028351,57.70810591072713,50.239173324672905,44.00139587945284,39.17083257776271,37.56426246163583,31.857100767319398,20.165041089762884,30.798890823664454,32.02446587793886,19.32695305555075,27.48639441172864,10.930601425652121,12.518216720193713,2.623565728612991,22.124740941086785,21.123585398658616,24.3753003574641,30.536378710455626,30.35213053286443,22.59887852402723,11.9977441597185,25.025017367983914,26.00439871228424,18.850166521576575,9.604053766122993,13.011991569025879,7.01229322727204,11.365433863731198,8.7599170980214,15.208450149837269,15.512142053824034,13.521601913144004,15.627891152571781,18.21907486102378,14.10397536331784,6.684626869803753,14.97313805067607,17.469824613321073,9.143059568749683,9.72404561637773,10.913143242930877,11.254267483348588,12.760208164488825,11.77213667443736,11.140989359072801,11.10708686047775,13.140019528204556,14.488009330945031,14.833626779648931,6.488046088213211,16.2637832245964,18.805897212928652,19.046297637613492,19.094705802544446,13.896945197556589,5.927629107022312,4.88997960497853,13.662719862992427,12.802014202571163,15.88131005611988,20.900868342879562,14.231926082696635,3.084827018001512,11.369536829619058,15.940886671074017,11.84259622372541,9.559611031609194,14.878394008099942,16.009889164087866,11.666183139837901,0,12.514914259860406,15.279401813005864,17.800918809356883,21.1931645496907,17.429196777389954,7.843912801881345,5.419655023241892,13.47154206569122,15.202617570591675,10.050371931296217,13.540489467787344,15.464754579117251,11.21828400842651,2.3313856619575697,0,0,7.332534216620066,10.865586005260077,0,2.224326565846797,7.864873951393415,4.891568249139188,6.328567349711326,9.358049038355206,15.130964014834193,15.451401393072944,11.804496346795498,7.581079491398729,11.531322431346336,0,8.785004433259628,9.392121069315627,11.304817166597942,17.287662196476834,16.980347110242366,10.820287423168313,0,2.1537316621570883,12.37549089851758,11.882712849582024,0,0,8.332193257260796,14.52776345255954,15.534839890870575,5.716670958406418,0,9.193888869630946,12.165761627915707,14.438050716725746,10.029858466961555,2.5528491032018263,1.1157600999344226,9.023402532060699,11.84909143756013,10.996168833136753,1.1101978370485968,1.6905400167320037,9.165985999739283,11.476104803759513,6.424915969262808,8.078837643373163,15.305529378163936,11.383243139804426,.2952564977218819,6.767946143193262,12.780993948718079,14.38604755985657,14.007328091697389,3.734705766356697,9.029154344080528,13.815128884049631,18.164041081188802,19.24454885612999,17.615774330925618,11.30736552162138,15.281484694967853,19.860681293473736,14.219040359734858,10.568559653800875,13.531719935107636,6.619084727827993,18.10185293789845,20.20005490406164,12.977800532040959,13.630593272325221,15.613474662488834,1.4071067722403952,5.104100308028737,4.453092250334667,7.950531831873705,12.546181719144284,16.912889584119306,13.611063804511913,0,5.14340750155569,4.168112019595056,7.907150889977693,8.979147446431407,9.426140225224962,13.243225390442396,11.469977914072203,6.748875731042129,12.419333543855343,17.67077925645081,18.880096475694156,17.976945230424562,13.259975924641125,9.110054638830176,13.897020932221713,10.897095324514966,7.8151207360060235,9.849822772927759,11.325162474719361,12.016694841102133,11.961220785443153,17.26423194554651,21.170934171205246,19.36679035480077,10.251257554114659,12.697790518293173,12.226322012316976,8.797966914057117,7.304920597468326,6.035264457772584,9.213676766218406,6.700444658116453,0,9.469079930845345,12.587156119390347,10.245214753239326,0,3.9196260047336264,14.939554766587442,20.32950591396716,17.43295039442306,12.232478269551809,7.075514116679573,11.653567301617436,14.522086687604194,4.999105820822678,8.972467820299194,14.752996098031064,12.58737256922795,8.269772553863397,6.845181399549767,9.453814130341753,6.702038616580293,0,5.248058865577265,9.060301063117464,4.959265667263332,1.6907237601620995,12.1849239447419,10.75358814568625,5.579890828342152,10.25437631919848,8.727296893037195,8.674164699122215,8.654266132067589,17.559192518562003,18.013714536426534,3.19846928252853,15.138023018241498,13.120210256537089,13.25959664576775,14.705757047417212,13.646956860434232,11.4493918726612,14.42216931817045,15.61832623520531,9.588827906656373,13.530472972857197,12.078871233581653,12.325619997935547,16.171122133369753,12.287442774753139,9.18184999018405,15.581479804162036,18.89011269904545,12.610509248201758,4.349945852315997,10.24488560466813,7.227081000118217,5.75185749552973,10.778581893610276,13.024889141559335,1.6624037980402562,0,5.918273781830605,11.381155590038007,13.981295548325248,13.94288510294386,10.133007988991162,2.121248558055799,0,1.9723575884446862,0,3.6330911978320097,0,10.113576400672237,10.40896817062201,0,10.454790827761203,10.174902839382536,0,3.5765172429638006,0,1.6182090693881206,0,1.7447440566893428,10.14584872592788,14.082806239138574,14.13045625770746,11.519994887021749,6.000767441228888,0,1.342626361452378,12.895630837651595,10.65092334647549,5.653708141569734,7.225975812423864,10.279236321645836,4.420118550235051,12.63436625022545,18.90372918109156,15.609480264737144,9.227081575590395,12.28784948291024,16.150819092173037,12.313925939027017,12.108909431418597,13.543631056849733,9.508949273227547,15.512028540224131,14.328925846207822,11.606027192071757,13.781481597455045,14.782072988727856,13.30651238407281,13.138829884869365,15.116653621679085,2.9554299337869274,17.91580710523786,17.470496727492755,8.753478916254254,8.814297997449522,8.777238025275853,10.263800483364781,5.636264759368252,10.794078851559046,12.174723218930296,1.4999538295923966,4.8007532181192625,9.094005719383269,5.504161448330176,0,6.91445360252918,9.53931383986776,6.812469238027456,8.104675064882583,12.402321867359854,14.575215846710353,8.894139055166587,5.41943166165391,14.702972067789473,11.856970622795508,7.31333026934427,12.322306413619625,17.448578513027048,20.310376499547864,14.862257403880673,3.6298947871426073,0,10.22551953701423,12.663942733922736,9.61832375637568,0,6.745343890336374,9.1393486211929,5.781388148243254,6.969392453063516,8.48361378533504,12.179137558366316,12.915935053266153,10.579301518169789,19.476760426918048,21.219739452820882,17.2642243065431,11.862556627260657,11.853653103061724,11.114382480645585,9.604425225673191,7.6263471783133365,10.939435292913382,13.995774524794472,9.214802148624713,13.269349891158216,17.961464275474153,18.8761951030306,17.698161852858053,12.50827264365707,6.932947620998374,11.58021263899969,13.310898121668322,9.484703064785522,9.030022395410246,7.984609496401385,4.285134891752637,5.175920875087389,0,13.47134581762161,16.757700789043493,12.272879876417079,7.605413336393965,4.436834888590431,5.3134281624631585,1.586948407695722,15.628696329790479,13.638049432844555,12.981066845845277,20.19082567242849,18.075206606619627,6.555147116491932,13.552012665837841,10.672208165568314,14.32546649410791,19.931514729626965,15.377797494051292,11.375769236373975,17.588585804754313,19.15950620196171,18.01841039563144,13.588143662169683,9.003820447085538,4.03228667394176,14.040446206569532,14.325258350511012,12.642339255005362,6.742497661212694,.7632554290740886,11.504334170814484,15.332947927875477,8.03418629947505,6.311434613265711,11.402639779964485,9.08442868708418,1.601545623919535,1.3179729309311625,11.175473098509213,12.027947817686973,9.206758553558133,1.3016492801836677,2.486550006182436,9.873629602046508,14.267461740251058,11.989494723427752,9.41420926886248,0,6.207702433978429,15.662305858152648,14.565948407450774,8.191337129018594,0,0,11.59078022260681,12.47321848095627,2.679199564616129,0,10.77357845916403,16.891122441267942,17.1738294458997,11.228060112174784,9.666473753231518,9.186067689083913,0,11.708749974182963,7.648578892756032,11.719897248816912,15.319507064767029,14.968844289851205,9.178167370766324,6.354883478391251,5.0317240483073755,7.875625082238901,2.016429963438845,0,10.81387157350129,7.390275955986494,0,0,2.473783795561967,11.283288373376966,15.494440278723957,13.529264929400577,9.9355770563046,15.074756774232712,13.328369502150904,5.5117560855136665,8.147300916502846,17.538402466378802,21.23247911794689,17.79172658927885,15.18189805300655,12.281546300058944,0,11.647743078165266,16.218227783549956,15.059530854897316,9.791646218821802,12.002311842637019,16.021067746218772,11.394436422577598,2.8364568713671985,14.060141217183588,20.80123791581557,15.77343773482499,12.726059083415214,13.584190131875445,4.713261533825819,6.033935500495772,14.02584255505931,19.162913910339118,19.09196180796629,18.83135815701536,16.263660209745257,6.366220890786104,14.713260017851788,14.321220889923108,13.119121396181448,11.41273340341992,11.490232130794169,12.058640417183204,12.939169262726953,11.333490287597444,10.857884175240345,9.538347399436034,8.87164508142129,17.33526561528871,14.797043625492982,6.303864751177793,14.008458579047376,18.281616804764848,15.714776244389387,13.536078416015936,15.43565038521385,15.085553833964894,8.816838562473114,11.57889252690025,7.243366337808657,13.049992675819164,9.562100439480858,18.8423624821782,26.026230764925945,25.063588495745275,12.088440383270365,22.598703824524417,30.335175370360073,30.507203823934503,24.31575743172064,21.091347153092375,22.192008263984746,2.6921532477189625,12.555925389688039,10.955792349554407,27.496596933783845,19.32309532965342,32.02016781504115,30.79363057915056,20.153705208595028,31.84733432313043,37.55422676155908,39.161318089373836,43.99725905548563,50.239521349711644,57.709945157232774,68.56102072874769,79.09277757582453,87.45022449812227,93.52414032558913,97.42708629345228,99.89326580207333,101.96969528883949,103.74738305478293,104.24929170393897,102.51409565496083,98.85891221948177,95.12889229516455,93.15575142612721,92.84481690448938,91.69353557099636,87.43065766212484,80.37511065919674,73.75278758416235,70.76481546499228,73.1488809356018,73.748251522107,66.19754420726265,44.67055040009078,55.14127984460118,68.00897312875901,76.50577378971266,83.19565707317221,88.37928427891767,91.64707205600125,93.1645549214913,94.15892605231977,95.2024261748412,95.18759292865255,93.90926869773944,93.20519129451228,93.58993179108286,93.54980638035424,91.17789631782823,85.47711109836708,76.39650364258733,64.77967081028163,57.60148341599023,63.457047409979346,64.77373700220063,59.30619115439834,51.77610792645369,53.27738581379225,58.31513815008083,55.809899784465536,47.29546194987288,39.36798475813622,37.358230987929666,32.900513693669474,34.58876357417883,45.52733381871206,19.30418051352355,49.14605651861594,58.39674489502643,42.985076505824125,48.58277552730088,64.72489073088832,64.53855632176429,59.46461446008204,69.79866094213094,83.06895000871368,90.10241292436534,92.58477826421021,92.52767576810614,91.77141536117016,91.36164373019474,89.97832484647684,84.45765489771985,76.25612211802503,74.77793832270372,73.00464769163953,75.33322759939438,83.40998967778759,88.52257846445491,93.09950831286169,100.23713376604933,106.91129234333648,110.54503255674483,110.84895308710479,108.88450078687669,108.24640086701157,113.88723795443882,121.95382120919903,127.38124075994413,129.01779133987984,127.06035587666086,122.20320925325537,115.93106559880616,111.18750587058453,109.71416357836468,107.8317384576405,103.07442993273,99.47570439915134,102.45913685400123,108.02480011537054,113.91292131176246,119.00504719734893,121.70543114560706,121.4717871530839,118.65353350928577,114.16181719598866,108.98992131815601,102.8145364807752,93.73710616384784,80.99522436021847,70.22074977909531,57.522235111051,46.820031202418996,63.45379796911414,62.10573859306925,62.522478315454485,60.116833586304146,39.831630797412195,71.7806367413494,74.5199217836516,60.53234686501897,52.15602168536246,76.32972481770639,92.41450363484631,102.72603832002034,109.04463777755306,113.18911196254741,116.29040798264832,118.3678616281676,119.14690593059633,119.06909211625258,118.84607224151263,118.20797609910174,116.14962898219424,112.21827699609415,107.06342747939058,101.18559829646743,92.9137702620287,78.39634865319103,62.949900114705216,69.0062502703019,65.30050053459482,46.064088050295645,27.925213019067385,49.07620602908922,55.26130242039997,48.297181557952335,29.0547768428826,60.59226990706777,61.63229498033179,37.31050251614931,56.42876438016364,71.47969431040048,85.77420915075048,95.15419246153931,101.93312177445505,106.82075655302869,109.34608956875489,111.07870777085459,113.54273215819515,115.68801133344986,115.68660528363839,113.18945966755618,109.53447768330773,106.51968978192635,104.22493771561832,101.89789204190814,99.12657145417897,99.53419272300803,105.65227830143226,108.8297392582113,105.68749484539899,100.52925035881725,104.13800355421641,106.2254843732615,101.16934758006757,91.13304937350996,87.72891307583734,98.7349633067024,107.62097112736863,112.3335144467274,114.78372232892166,115.8850378488818,116.89611504765251,119.26561324794429,121.3841409612775,122.15993185509966,121.98932645564041,121.21593174035927,118.98958046309708,112.44840636612393,103.73853807373665,117.31064469551029,129.43421370886102,136.2111032227428,139.4593666500088,140.13445296046177,138.76213759970432,135.5630320707424,130.54393168059855,123.82818837992177,116.07941747991194,108.34647026968001,101.03456677959765,95.66676904546009,97.86113189561249,100.92602617581143,103.92989096852207,109.49660407900826,112.15584663912672,110.80382908028835,108.69898621387294,106.20701462462121,101.74262759240635,98.66422744858968,98.10394110643142,97.34235283999772,97.57566565538899,100.60994855041994,107.40617250158246,114.23798647603215,118.22408238485863,118.90373163887496,116.49216867904974,111.58068216565138,104.10879697628687,90.26906232119254,73.85763572461435,91.3491361317248,89.11836156706346,68.6726434655926,79.87799282974109,60.54385059908123,84.92760936178982,96.4752001963592,94.81545038646067,106.30970359538547,114.2104747499376,111.40391612227951,97.15934129972361,112.29095612707094,126.02848842354501,133.0082159148334,136.34745581511382,137.10109773309034,135.70217756931117,132.47935526768777,127.35878828072931,119.93677584068564,112.39768481660613,109.37303827394014,107.16791080188607,101.81608101208793,92.58847469956677,83.21567458536418,86.63294719282503,101.26812860539339,114.68214557056169,122.7327563809439,125.59348797481894,123.76350402125736,118.26389009957268,116.34245948001073,123.78168323041649,129.78921427083176,131.9754194958146,131.71057816330685,129.90384904754552,126.51249016784601,122.2400326926942,119.92296598384048,122.00238053081277,125.67563725822029,127.49855890937131,126.59682802396568,122.37848723288941,114.85566139586028,114.22547302310696,121.62189039066338,127.33590647591397,131.00124646643715,131.4581964185114,127.23195927702446,117.72549862641351,109.15718761707542,117.5417232792651,125.89906325638462,128.1223527402383,124.03727447364358,115.62748592770117,114.1414572415632,120.16950335825283,124.54351889399076,125.50728589986323,122.59848279111162,117.78921780035344,117.87374702603012,121.46344538503499,123.00503642802835,122.8734071286911,125.0260325714215,130.05322831072004,133.77926904706976,133.55111737490492,127.36586241105557,115.31977487505993,120.14742685497546,132.08991772494053,140.90571592124957,145.90019036520025,146.94986939321637,145.25922677868306,143.01802540646966,142.99611495827006,145.75805912714097,148.7887275816813,150.50010621591636,151.12869154826384,151.3369874794862,151.14782222367967,149.81112513081436,146.74304447140364,142.19704817050356,137.1198908229571,131.9752019882868,125.21794163113624,113.57714712439454,97.1496708876078,101.99777402644207,108.58044026376153,113.26447168913776,112.44799022370425,96.50035067728408,110.7184240927532,124.75329634069374,126.09814773550508,116.55980886066847,92.09290392856308,112.46133923706601,125.10058260240726,133.47227546085253,139.36449484155528,142.62766498926533,143.28651934923624,141.7777189620662,138.76263185246356,135.23412709801426,133.3482677848772,133.95975448544326,134.50352636166627,132.7659707744914,127.74442217998808,118.51443047524482,105.70920689819519,111.95472089630582,123.86037400016116,130.59188784746723,133.04014714791705,131.70252224342494,128.0008127705433,127.38138224297306,129.434918343866,130.34020737337966,130.12929658046303,129.06093066996556,125.57473288368382,115.15550893518736,88.75111693106655,120.22453810765779,130.95014630155598,133.14503685689422,129.55533244102588,122.1039896651948,120.98431843230455,129.14457830522727,135.29395885539418,137.31014313066748,136.0819237857414,134.83640740952785,137.1831284757891,140.30229214517712,141.43509044999527,140.92874954055137,139.99017540878293,138.83460020229015,136.15353009056514,129.23071391558705,117.08769051494484,122.98399945459973,132.34571375732787,134.6597375927039,131.27989475331978,122.65446358116598,109.75949319385768,102.27131663760005,102.80963036664456,104.0666210406399,100.91412970054837,89.06336437380658,95.58870434298841,108.08474410886177,109.975290454292,100.66889665503349,88.96843946142424,108.35377053933227,114.07147267518978,110.93133801377837,109.40847694746347,118.86806993241346,126.52642833562173,129.76501730620384,129.27523809375847,126.67010440280367,124.2867969604617,122.46761377773747,117.95846370606961,104.04194815548871,88.40480038565197,106.82193564925728,107.60151358936267,96.42637893625684,88.65279147756746,104.27502925063335,112.6969219771717,117.9373093683718,121.406189082809,122.22759791766974,121.33894117599992,121.56481739405223,123.53842605672006,124.37982270531079,121.4664769197343,112.5421258034038,92.05572428849077,104.95013039989355,117.2150495419483,122.38464342834497,125.94120162594115,129.56872072251423,132.70817382527588,133.76983838542708,131.96684976064296,127.20200356221375,119.90507895581473,110.88228885993007,105.82567256372081,114.08568971832912,121.98872160371074,124.38192964308752,123.75101574287024,124.49157990671355,127.81856423476499,131.35653746685884,133.61619154056436,134.27054425788754,133.19274055872873,130.25785139226338,125.32131062603564,118.84529769293798,114.73094669137538,117.32300402124814,121.53943096505532,124.9379924905757,129.02643889799754,134.3253630920495,139.64910289859577,143.8496663010949,146.41329976809035,147.13649400326642,145.90790583900943,142.91983020235745,139.0408100268394,136.24004215578535,134.59953604193316,131.88611703248006,126.77824631740835,125.3372918872163,131.3391518029233,136.2994523875791,138.23949026777544,138.01618690253528,136.56384741173846,134.06648656763667,130.41631523162945,126.02312916597072,122.11888737668045,121.93072850705732,126.4549135403018,131.84271947263983,135.2216409007247,135.78574715423088,134.29650210685182,131.90021668190013,129.8594835186377,128.02810329865105,124.82896562622523,119.27804181115263,112.1618210875847,109.7606065138958,114.88031169305953,120.90516479632258,123.89634815814485,124.68805393056857,127.40506420407145,131.92568913122147,134.78655438887444,134.4848762084327,131.22808687816396,124.05101542935647,111.6680648967376,107.59959271972605,119.37875651717499,127.38222796356523,131.3818360741695,131.46362921294215,127.33447882627286,119.12981556963278,113.87365385967676,118.6459118084248,122.47968242291527,122.54191464816928,118.98660493600012,111.3390799924638,98.03459026282384,66.0661580661814,75.82987579913082,82.46862653900081,83.35442562124413,92.95836763726317,103.44710699349196,114.2263158659949,124.07664699923747,131.9837736115233,137.62243813449857,140.2867189328989,139.3177998211297,134.62922878192632,126.52050160692933,123.68212005871749,130.6692723829163,133.96735606383828,132.20629593622854,126.5367302709491,119.75248527642005,117.22061060775094,119.7137227059548,122.3623542790754,120.83475813308127,110.34310180873224,89.01927960713165,120.69558179387168,132.5104431738287,138.12673652205208,140.1080316236496,139.66190688366913,136.93978178629223,132.49447508534894,130.34818088211662,132.497424113394,134.24522201135863,133.6150381540072,131.37917928582317,129.61449782803453,128.68427532159342,128.17334706648543,128.5570699958125,129.62991707093713,130.74845529998203,134.16233629157972,140.3412106741102,145.92797999640203,149.0383053133878,149.4364893947315,148.0554258060447,146.3695241642237,145.83421067683977,146.10029858906174,145.5471045139762,143.17158774370387,138.29280912280117,129.4537010593994,111.58363981456151,92.9500761571869,118.07215437644277,127.15033919507839,131.78855357780378,135.09324290014425,137.02860179241654,137.23047459407942,136.94397279949845,137.86427558389795,140.02962568671,142.3485383990313,144.04004642976972,145.23040828356415,146.91784789675518,149.77722092433748,152.83961538279263,154.53838820199408,154.767354252018,155.10287774079123,156.66466873822475,158.52065843724156,159.60779223082642,159.8694960176258,159.69121555858095,159.09241653554025,158.03511913820253,157.40026253234646,158.2700924193581,160.33717038158198,162.69577420981906,164.56028366121572,165.02755215312504,163.283454921089,158.65569137848354,151.30289226152428,145.98183448662513,145.5672642570963,141.00160436370405,144.56602842693394,158.76317699692117,167.70472832739583,173.28440040276342,177.63272863056815,182.25384109168323,187.0496190825908,190.998692836551,193.5896629106951,195.4906998402826,197.26171132802398,198.68440631822128,199.29787388223784,200.06585544947043,202.15749478072573,204.1179813944494,203.48988916928616,198.68772392755173,187.46942834049108,167.07117359067868,172.52204017273783,183.33627056640074,189.56207222209986,194.98293881072215,199.6589895567035]],EY=[[204.35838132923993,203.00945332832035,199.65900469732605,194.98271845278515,189.56132214289326,183.33473438912372,172.52400430499736,167.07532066537684,187.47065016402843,198.68807545388097,203.48982568521964,204.1176240653317,202.15691732602392,200.06529787993665,199.29780568337057,198.68467837138908,197.26189269581153,195.4906761781706,193.5894680197673,190.99841409170546,187.04933995236826,182.25360885686126,177.63250777500204,173.28407960282425,167.70417685616633,158.76226893469703,144.56500607291406,141.00209952410114,145.56804845329737,145.98247959194708,151.30333957601397,158.65594331047583,163.28351501985006,165.0274425332393,164.56009034724005,162.69563468431807,160.3371300218423,158.2700085578228,157.39999468815182,158.03471062124936,159.09200990304208,159.69089115160511,159.86921679067325,159.6075664376986,158.52087286589776,156.6650151944958,155.10307758735354,154.76731334199766,154.53817469416,152.83946762235234,149.7773929680549,146.91810966789785,145.2304213494264,144.0396936303876,142.34788989257112,140.02924475411893,137.86488379627102,136.94443024999612,137.23038873543342,137.02795358522172,135.09262390148805,131.78995127630665,127.15201700601123,118.07364045259453,92.95048846026552,111.58227970522246,129.45278563115795,138.2921805525958,143.1711053210688,145.54670069071844,146.10057562215798,145.83463815520878,146.36977981790818,148.0554387843523,149.43629769169783,149.03798836610676,145.92771765577686,140.3413699534398,134.16252749146054,130.7483709722678,129.62976562861337,128.55726783363963,128.17372090103626,128.68453448110859,129.61467268224547,131.37936708272957,133.615185772025,134.24522747949015,132.49724810152492,130.3479207101576,132.49438546853943,136.93991181373855,139.66216072746448,140.10834545254787,138.1270546398033,132.51069038452,120.69558867721602,89.01754914367318,110.34211587855022,120.83417434236462,122.36200772241834,119.71362583248677,117.22074187792266,119.75264768893518,126.5367395343374,132.2061093130478,133.96693353280494,130.6684966876412,123.6815217863759,126.52157795061277,134.62983091628038,139.3180272591702,140.28667668531253,137.62219818584865,131.98348466528336,124.07663570706792,114.2267694499014,103.44772202882844,92.9584608439638,83.35329993623219,82.46689771012865,75.82770036464417,66.06349703115293,98.03414526793118,111.33889876855572,118.98648423031145,122.54177224513953,122.47951959397489,118.64583070128839,113.87371352182163,119.12974241422387,127.33420020821598,131.46335674969552,131.3822456107658,127.3830481228133,119.37978564347974,107.60067684669835,111.66825278667098,124.05076277537741,131.22772394028615,134.48448788702927,134.7861839517469,131.92539177767685,127.40494750758486,124.68811639326971,123.8965060008981,120.9054998438967,114.88101986961341,109.76176859442026,112.1629841277428,119.27887876494424,124.82951411454222,128.02837046990257,129.85943432178908,131.89986646363,134.2959664200011,135.78516337340758,135.22114124260463,131.84250434163295,126.45507975231583,121.93106290183131,122.11921102289395,126.02335733427888,130.41644177850932,134.06653952639124,136.5638564699891,138.01616957258577,138.23945775755297,136.29941618189454,131.33912440717808,125.33728980410184,126.77827246986509,131.88614297305546,134.5995306065226,136.2399757750571,139.04068907529907,142.9197060262825,145.9078344918701,147.13650225775328,146.41335613205808,143.84972114295687,139.64912794324272,134.3253574737259,129.02642302040337,124.93796462149683,121.5393264193191,117.322732247941,114.73057166609908,118.8452229107018,125.32158129160658,130.25817923584472,133.19297336645127,134.27063636776148,133.61613697497285,131.3563797543291,127.81845352593217,124.49172753170508,123.7513624080227,124.38224504365684,121.98895450367736,114.08596503252865,105.82629767516569,110.88300039306839,119.90552132506646,127.202147201513,131.9667614478077,133.76958758760802,132.70781458819803,129.56830485026168,125.94077414424684,122.38418137561702,117.21442780157889,104.9489244287997,92.05361102549689,112.54203234883539,121.46683920506331,124.38005590514472,123.53852557520595,121.56477951652924,121.33882435595636,122.2275429466472,121.4062971945044,117.93754225866843,112.6971528635918,104.27515467306111,88.6528521160044,96.42663339577929,107.60183673130071,106.82225946173723,88.40507400283728,104.04178637381129,117.95828545895965,122.46746248313711,124.28669381415281,126.67005328527794,129.27522451899023,129.7650229950298,126.52643324838441,118.86804102107371,109.40834958178631,110.93113718338012,114.07121904322369,108.35331346001797,88.96705472009042,100.66853781444378,109.97573475103614,108.08517276324821,95.58895557030422,89.06300976096674,100.91403830932555,104.06730366572654,102.81085812399192,102.27248417282829,109.75997332490616,122.65446694505044,131.27973072984534,134.659499974981,132.34540824765594,122.983550056949,117.08732924209211,129.23091278150616,136.1537186103394,138.83472161916444,139.99022039298902,140.92873074735414,141.4350478891782,140.302255484849,137.183074064597,134.8362750409565,136.08173198415673,137.3102051022957,135.29421222826153,129.14481974035795,120.98443896939034,122.10389522255312,129.55517351459943,133.1448836556803,130.95005729684308,120.2247398448641,88.75300107301513,115.15603565056695,125.57494349672899,129.060984495252,130.1292469749284,130.3401027591469,129.43479875948742,127.3812776144528,128.0007642924076,131.7025425637015,133.04022544791667,130.59201431746015,123.86052071405743,111.95477123616325,105.70885785702148,118.51401850384497,127.74406905646723,132.76569119540864,134.50333751053557,133.95982949270305,133.34831260302562,135.23414699652548,138.76267935057723,141.77778219016764,143.28657189711944,142.627691535347,139.3644825559961,133.4722084696932,125.10044387363267,112.46111177234778,92.09275680431377,116.55997780602732,126.09832147776532,124.7534823951912,110.71875423547183,96.50112043365947,112.4485124681327,113.26506731234124,108.58103656834763,101.99803482567827,97.14913597763675,113.57660886046824,125.21760786245515,131.97504303651732,137.11982745823596,142.19699775863148,146.74299115161836,149.8110840053253,151.14779573703814,151.33695915010136,151.12865162025216,150.500088718598,148.7887948486843,145.75817203220814,142.99623735437788,143.01809980998883,145.25921794002127,146.94978222310706,145.90004561737913,140.90565004641883,132.09016956580749,120.14784234370435,115.32010047236865,127.36594813894344,133.55111744902817,133.779199329228,130.05306182494044,125.02575693885959,122.87310149941793,123.0047656386207,121.46331452528521,117.8741314694841,117.78964041278229,122.5987050435432,125.50729776735199,124.54332009302718,120.16906619959042,114.14090655164526,115.6280158581019,124.03749904425878,128.12242075902333,125.8990361446127,117.54157651579577,109.15688815418844,117.72541720595963,127.23209372584536,131.4583482182636,131.00135069548762,127.335942799752,121.62186226856994,114.22543748940511,114.85572068019748,122.37860097066992,126.59694202163297,127.4986334752324,125.67563125327746,122.00225729495378,119.92276357023357,122.23990555829354,126.51250740094001,129.903949786847,131.71070023688006,131.97553484395505,129.78930892615406,123.78174072681384,116.3424370534271,118.26378107046335,123.7633490117246,125.59327470473724,122.7324601126848,114.68183007149709,101.26825438324576,86.63384744011921,83.21618025600223,92.5882747839233,101.81575376052287,107.16764512838256,109.37281048707132,112.3974640636089,119.9366852918811,127.35884663106289,132.47940283462185,135.70218555776887,137.10112609991162,136.34754082287984,133.0083175599282,126.02857776304094,112.29113303317646,97.16001644870359,111.40431919504549,114.2106564702352,106.30950393288109,94.81430769903297,96.47370642704341,84.92532458224564,60.545487148081754,79.88039774315853,68.67596712239431,89.11906170616737,91.34917675692962,73.856623411296,90.26844758457986,104.1086223795779,111.58070017271665,116.49222512452609,118.90377264729761,118.22411457287104,114.23802667459175,107.40620915533147,100.60987015302861,97.57527844151682,97.34158232256256,98.10290657702991,98.66362467593973,101.7433519346422,106.2073561951195,108.69895880734114,110.8035723792059,112.15569136889091,109.49690243299439,103.93036448482624,100.92628029593007,97.86096217096936,95.66608809626983,101.03380856504565,108.34648051731253,116.07978807883318,123.8283548391442,130.54394791018052,135.56296750803784,138.76204157391325,140.13435297163534,139.4593490534493,136.21123380350022,129.43441998628626,117.31101607955178,103.73912043267357,112.44864947671577,118.98964903641227,121.21591071320593,121.98924397601607,122.15980962476785,121.38400859362196,119.26549450974018,116.8959893414305,115.88483515515084,114.78338677210779,112.33315907937443,107.62137119796489,98.73602747048403,87.73038295136323,91.13378536825944,101.16947207803058,106.2253997649699,104.13784134633754,100.52905925732327,105.68729473617451,108.82944337043381,105.65177463603948,99.53348804272758,99.12635127717267,101.89825121460251,104.22530938942084,106.5199998892505,109.53476613473762,113.18969053622115,115.68672529991734,115.68799615105743,113.54259565985197,111.07854773053354,109.34605744693557,106.82092535033571,101.93352157530809,95.15483646585035,85.77495510365729,71.47980071875158,56.42559082770286,37.29837819664849,61.63020725776271,60.59370173495803,29.06580455390409,48.298454080119065,55.25910173785193,49.07081918616964,27.913389433570206,46.06408623486975,65.30229863737705,69.00799421180668,62.951246181167086,78.39628391473362,92.91338861566796,101.18515479771182,107.06300736303153,112.21793848064252,116.14938312247597,118.20778576944683,118.84594635653883,119.06929816454088,119.14718314409345,118.36809783419976,116.29053669089575,113.1890980334156,109.04454487149671,102.72609076505472,92.41500440345374,76.33094400443694,52.15810967929434,60.53209431838238,74.51909568179593,71.77931834367912,39.82659016836722,60.1169244820835,62.52548851218519,62.11074567808925,63.45832055316442,46.8261122989831,57.52269917794884,70.21957081125319,80.99419298885374,93.73663259384219,102.81429704783874,108.98970049077947,114.1615558836602,118.65326487722758,121.47156722067137,121.70532057926238,119.0050512192624,113.91296124678925,108.02487100201645,102.45933706749719,99.47598191566438,103.07457144991398,107.83179905939933,109.71431398958043,111.18776497305835,115.9312322534841,122.2031968088484,127.06021086188508,129.01757233521474,127.38100954224436,121.95378438456284,113.88747930721628,108.24673019657541,108.8848456885361,110.8492682187245,110.54528629513362,106.91146973958499,100.23720183593618,93.09935251508304,88.52204668469803,83.40893002956824,75.3313841827785,73.00260059182122,74.77627146153478,76.25559930918028,84.45871817093106,89.97952576061537,91.3626377391236,91.7720533305402,92.52791684811231,92.58468973705524,90.10201677066587,83.06805232336963,69.79640996980096,59.46018368728643,64.53504442365393,64.72506424680589,48.59176666190088,42.997013594499144,58.400853744202436,49.148725852729285,19.301829008746356,45.525192245861724,34.586577726746604,32.89897205356545,37.35431487600631,39.36070499932478,47.28944881987594,55.80702434942269,58.31379853055729,53.27520107576588,51.77221796539581,59.30468018244898,64.77574569278,63.45891452054705,57.60286625521149,64.7802979806566,76.39692667582972,85.4774034636836,91.17797207425647,93.54958517538748,93.58937200947447,93.20455317792343,93.90957285858832,95.18829374855927,95.20282588854431,94.1588385341336,93.16395918149897,91.64607366999336,88.37909124667785,83.1975774402594,76.5085768647885,68.0130768674399,55.14813057328617,44.67960299230243,66.19961637978649,73.74863121315964,73.14806942281302,70.76269255868576,73.75017282602815,80.37283457139709,87.42884063345399,91.6920197763112,92.84484827437588,93.15688891664955,95.12943817890444,98.85873726821387,102.5135604044542,104.24947206735496,103.74848206676312,101.97082217522741,99.89393393504812,97.42699236602259,93.52313150722814,87.44822165948382,79.08988655073196,68.55796791028351,57.70810591072713,50.239173324672905,44.00139587945284,39.17083257776271,37.56426246163583,31.857100767319398,20.165041089762884,30.798890823664454,32.02446587793886,19.32695305555075,27.48639441172864,10.930601425652121,12.518216720193713,2.623565728612991,22.124740941086785,21.123585398658616,24.3753003574641,30.536378710455626,30.35213053286443,22.59887852402723,11.9977441597185,25.025017367983914,26.00439871228424,18.850166521576575,9.604053766122993,13.011991569025879,7.01229322727204,11.365433863731198,8.7599170980214,15.208450149837269,15.512142053824034,13.521601913144004,15.627891152571781,18.21907486102378,14.10397536331784,6.684626869803753,14.97313805067607,17.469824613321073,9.143059568749683,9.72404561637773,10.913143242930877,11.254267483348588,12.760208164488825,11.77213667443736,11.140989359072801,11.10708686047775,13.140019528204556,14.488009330945031,14.833626779648931,6.488046088213211,16.2637832245964,18.805897212928652,19.046297637613492,19.094705802544446,13.896945197556589,5.927629107022312,4.88997960497853,13.662719862992427,12.802014202571163,15.88131005611988,20.900868342879562,14.231926082696635,3.084827018001512,11.369536829619058,15.940886671074017,11.84259622372541,9.559611031609194,14.878394008099942,16.009889164087866,11.666183139837901,0,12.514914259860406,15.279401813005864,17.800918809356883,21.1931645496907,17.429196777389954,7.843912801881345,5.419655023241892,13.47154206569122,15.202617570591675,10.050371931296217,13.540489467787344,15.464754579117251,11.21828400842651,2.3313856619575697,0,0,7.332534216620066,10.865586005260077,0,2.224326565846797,7.864873951393415,4.891568249139188,6.328567349711326,9.358049038355206,15.130964014834193,15.451401393072944,11.804496346795498,7.581079491398729,11.531322431346336,0,8.785004433259628,9.392121069315627,11.304817166597942,17.287662196476834,16.980347110242366,10.820287423168313,0,2.1537316621570883,12.37549089851758,11.882712849582024,0,0,8.332193257260796,14.52776345255954,15.534839890870575,5.716670958406418,0,9.193888869630946,12.165761627915707,14.438050716725746,10.029858466961555,2.5528491032018263,1.1157600999344226,9.023402532060699,11.84909143756013,10.996168833136753,1.1101978370485968,1.6905400167320037,9.165985999739283,11.476104803759513,6.424915969262808,8.078837643373163,15.305529378163936,11.383243139804426,.2952564977218819,6.767946143193262,12.780993948718079,14.38604755985657,14.007328091697389,3.734705766356697,9.029154344080528,13.815128884049631,18.164041081188802,19.24454885612999,17.615774330925618,11.30736552162138,15.281484694967853,19.860681293473736,14.219040359734858,10.568559653800875,13.531719935107636,6.619084727827993,18.10185293789845,20.20005490406164,12.977800532040959,13.630593272325221,15.613474662488834,1.4071067722403952,5.104100308028737,4.453092250334667,7.950531831873705,12.546181719144284,16.912889584119306,13.611063804511913,0,5.14340750155569,4.168112019595056,7.907150889977693,8.979147446431407,9.426140225224962,13.243225390442396,11.469977914072203,6.748875731042129,12.419333543855343,17.67077925645081,18.880096475694156,17.976945230424562,13.259975924641125,9.110054638830176,13.897020932221713,10.897095324514966,7.8151207360060235,9.849822772927759,11.325162474719361,12.016694841102133,11.961220785443153,17.26423194554651,21.170934171205246,19.36679035480077,10.251257554114659,12.697790518293173,12.226322012316976,8.797966914057117,7.304920597468326,6.035264457772584,9.213676766218406,6.700444658116453,0,9.469079930845345,12.587156119390347,10.245214753239326,0,3.9196260047336264,14.939554766587442,20.32950591396716,17.43295039442306,12.232478269551809,7.075514116679573,11.653567301617436,14.522086687604194,4.999105820822678,8.972467820299194,14.752996098031064,12.58737256922795,8.269772553863397,6.845181399549767,9.453814130341753,6.702038616580293,0,5.248058865577265,9.060301063117464,4.959265667263332,1.6907237601620995,12.1849239447419,10.75358814568625,5.579890828342152,10.25437631919848,8.727296893037195,8.674164699122215,8.654266132067589,17.559192518562003,18.013714536426534,3.19846928252853,15.138023018241498,13.120210256537089,13.25959664576775,14.705757047417212,13.646956860434232,11.4493918726612,14.42216931817045,15.61832623520531,9.588827906656373,13.530472972857197,12.078871233581653,12.325619997935547,16.171122133369753,12.287442774753139,9.18184999018405,15.581479804162036,18.89011269904545,12.610509248201758,4.349945852315997,10.24488560466813,7.227081000118217,5.75185749552973,10.778581893610276,13.024889141559335,1.6624037980402562,0,5.918273781830605,11.381155590038007,13.981295548325248,13.94288510294386,10.133007988991162,2.121248558055799,0,1.9723575884446862,0,3.6330911978320097,0,10.113576400672237,10.40896817062201,0,10.454790827761203,10.174902839382536,0,3.5765172429638006,0,1.6182090693881206,0,1.7447440566893428,10.14584872592788,14.082806239138574,14.13045625770746,11.519994887021749,6.000767441228888,0,1.342626361452378,12.895630837651595,10.65092334647549,5.653708141569734,7.225975812423864,10.279236321645836,4.420118550235051,12.63436625022545,18.90372918109156,15.609480264737144,9.227081575590395,12.28784948291024,16.150819092173037,12.313925939027017,12.108909431418597,13.543631056849733,9.508949273227547,15.512028540224131,14.328925846207822,11.606027192071757,13.781481597455045,14.782072988727856,13.30651238407281,13.138829884869365,15.116653621679085,2.9554299337869274,17.91580710523786,17.470496727492755,8.753478916254254,8.814297997449522,8.777238025275853,10.263800483364781,5.636264759368252,10.794078851559046,12.174723218930296,1.4999538295923966,4.8007532181192625,9.094005719383269,5.504161448330176,0,6.91445360252918,9.53931383986776,6.812469238027456,8.104675064882583,12.402321867359854,14.575215846710353,8.894139055166587,5.41943166165391,14.702972067789473,11.856970622795508,7.31333026934427,12.322306413619625,17.448578513027048,20.310376499547864,14.862257403880673,3.6298947871426073,0,10.22551953701423,12.663942733922736,9.61832375637568,0,6.745343890336374,9.1393486211929,5.781388148243254,6.969392453063516,8.48361378533504,12.179137558366316,12.915935053266153,10.579301518169789,19.476760426918048,21.219739452820882,17.2642243065431,11.862556627260657,11.853653103061724,11.114382480645585,9.604425225673191,7.6263471783133365,10.939435292913382,13.995774524794472,9.214802148624713,13.269349891158216,17.961464275474153,18.8761951030306,17.698161852858053,12.50827264365707,6.932947620998374,11.58021263899969,13.310898121668322,9.484703064785522,9.030022395410246,7.984609496401385,4.285134891752637,5.175920875087389,0,13.47134581762161,16.757700789043493,12.272879876417079,7.605413336393965,4.436834888590431,5.3134281624631585,1.586948407695722,15.628696329790479,13.638049432844555,12.981066845845277,20.19082567242849,18.075206606619627,6.555147116491932,13.552012665837841,10.672208165568314,14.32546649410791,19.931514729626965,15.377797494051292,11.375769236373975,17.588585804754313,19.15950620196171,18.01841039563144,13.588143662169683,9.003820447085538,4.03228667394176,14.040446206569532,14.325258350511012,12.642339255005362,6.742497661212694,.7632554290740886,11.504334170814484,15.332947927875477,8.03418629947505,6.311434613265711,11.402639779964485,9.08442868708418,1.601545623919535,1.3179729309311625,11.175473098509213,12.027947817686973,9.206758553558133,1.3016492801836677,2.486550006182436,9.873629602046508,14.267461740251058,11.989494723427752,9.41420926886248,0,6.207702433978429,15.662305858152648,14.565948407450774,8.191337129018594,0,0,11.59078022260681,12.47321848095627,2.679199564616129,0,10.77357845916403,16.891122441267942,17.1738294458997,11.228060112174784,9.666473753231518,9.186067689083913,0,11.708749974182963,7.648578892756032,11.719897248816912,15.319507064767029,14.968844289851205,9.178167370766324,6.354883478391251,5.0317240483073755,7.875625082238901,2.016429963438845,0,10.81387157350129,7.390275955986494,0,0,2.473783795561967,11.283288373376966,15.494440278723957,13.529264929400577,9.9355770563046,15.074756774232712,13.328369502150904,5.5117560855136665,8.147300916502846,17.538402466378802,21.23247911794689,17.79172658927885,15.18189805300655,12.281546300058944,0,11.647743078165266,16.218227783549956,15.059530854897316,9.791646218821802,12.002311842637019,16.021067746218772,11.394436422577598,2.8364568713671985,14.060141217183588,20.80123791581557,15.77343773482499,12.726059083415214,13.584190131875445,4.713261533825819,6.033935500495772,14.02584255505931,19.162913910339118,19.09196180796629,18.83135815701536,16.263660209745257,6.366220890786104,14.713260017851788,14.321220889923108,13.119121396181448,11.41273340341992,11.490232130794169,12.058640417183204,12.939169262726953,11.333490287597444,10.857884175240345,9.538347399436034,8.87164508142129,17.33526561528871,14.797043625492982,6.303864751177793,14.008458579047376,18.281616804764848,15.714776244389387,13.536078416015936,15.43565038521385,15.085553833964894,8.816838562473114,11.57889252690025,7.243366337808657,13.049992675819164,9.562100439480858,18.8423624821782,26.026230764925945,25.063588495745275,12.088440383270365,22.598703824524417,30.335175370360073,30.507203823934503,24.31575743172064,21.091347153092375,22.192008263984746,2.6921532477189625,12.555925389688039,10.955792349554407,27.496596933783845,19.32309532965342,32.02016781504115,30.79363057915056,20.153705208595028,31.84733432313043,37.55422676155908,39.161318089373836,43.99725905548563,50.239521349711644,57.709945157232774,68.56102072874769,79.09277757582453,87.45022449812227,93.52414032558913,97.42708629345228,99.89326580207333,101.96969528883949,103.74738305478293,104.24929170393897,102.51409565496083,98.85891221948177,95.12889229516455,93.15575142612721,92.84481690448938,91.69353557099636,87.43065766212484,80.37511065919674,73.75278758416235,70.76481546499228,73.1488809356018,73.748251522107,66.19754420726265,44.67055040009078,55.14127984460118,68.00897312875901,76.50577378971266,83.19565707317221,88.37928427891767,91.64707205600125,93.1645549214913,94.15892605231977,95.2024261748412,95.18759292865255,93.90926869773944,93.20519129451228,93.58993179108286,93.54980638035424,91.17789631782823,85.47711109836708,76.39650364258733,64.77967081028163,57.60148341599023,63.457047409979346,64.77373700220063,59.30619115439834,51.77610792645369,53.27738581379225,58.31513815008083,55.809899784465536,47.29546194987288,39.36798475813622,37.358230987929666,32.900513693669474,34.58876357417883,45.52733381871206,19.30418051352355,49.14605651861594,58.39674489502643,42.985076505824125,48.58277552730088,64.72489073088832,64.53855632176429,59.46461446008204,69.79866094213094,83.06895000871368,90.10241292436534,92.58477826421021,92.52767576810614,91.77141536117016,91.36164373019474,89.97832484647684,84.45765489771985,76.25612211802503,74.77793832270372,73.00464769163953,75.33322759939438,83.40998967778759,88.52257846445491,93.09950831286169,100.23713376604933,106.91129234333648,110.54503255674483,110.84895308710479,108.88450078687669,108.24640086701157,113.88723795443882,121.95382120919903,127.38124075994413,129.01779133987984,127.06035587666086,122.20320925325537,115.93106559880616,111.18750587058453,109.71416357836468,107.8317384576405,103.07442993273,99.47570439915134,102.45913685400123,108.02480011537054,113.91292131176246,119.00504719734893,121.70543114560706,121.4717871530839,118.65353350928577,114.16181719598866,108.98992131815601,102.8145364807752,93.73710616384784,80.99522436021847,70.22074977909531,57.522235111051,46.820031202418996,63.45379796911414,62.10573859306925,62.522478315454485,60.116833586304146,39.831630797412195,71.7806367413494,74.5199217836516,60.53234686501897,52.15602168536246,76.32972481770639,92.41450363484631,102.72603832002034,109.04463777755306,113.18911196254741,116.29040798264832,118.3678616281676,119.14690593059633,119.06909211625258,118.84607224151263,118.20797609910174,116.14962898219424,112.21827699609415,107.06342747939058,101.18559829646743,92.9137702620287,78.39634865319103,62.949900114705216,69.0062502703019,65.30050053459482,46.064088050295645,27.925213019067385,49.07620602908922,55.26130242039997,48.297181557952335,29.0547768428826,60.59226990706777,61.63229498033179,37.31050251614931,56.42876438016364,71.47969431040048,85.77420915075048,95.15419246153931,101.93312177445505,106.82075655302869,109.34608956875489,111.07870777085459,113.54273215819515,115.68801133344986,115.68660528363839,113.18945966755618,109.53447768330773,106.51968978192635,104.22493771561832,101.89789204190814,99.12657145417897,99.53419272300803,105.65227830143226,108.8297392582113,105.68749484539899,100.52925035881725,104.13800355421641,106.2254843732615,101.16934758006757,91.13304937350996,87.72891307583734,98.7349633067024,107.62097112736863,112.3335144467274,114.78372232892166,115.8850378488818,116.89611504765251,119.26561324794429,121.3841409612775,122.15993185509966,121.98932645564041,121.21593174035927,118.98958046309708,112.44840636612393,103.73853807373665,117.31064469551029,129.43421370886102,136.2111032227428,139.4593666500088,140.13445296046177,138.76213759970432,135.5630320707424,130.54393168059855,123.82818837992177,116.07941747991194,108.34647026968001,101.03456677959765,95.66676904546009,97.86113189561249,100.92602617581143,103.92989096852207,109.49660407900826,112.15584663912672,110.80382908028835,108.69898621387294,106.20701462462121,101.74262759240635,98.66422744858968,98.10394110643142,97.34235283999772,97.57566565538899,100.60994855041994,107.40617250158246,114.23798647603215,118.22408238485863,118.90373163887496,116.49216867904974,111.58068216565138,104.10879697628687,90.26906232119254,73.85763572461435,91.3491361317248,89.11836156706346,68.6726434655926,79.87799282974109,60.54385059908123,84.92760936178982,96.4752001963592,94.81545038646067,106.30970359538547,114.2104747499376,111.40391612227951,97.15934129972361,112.29095612707094,126.02848842354501,133.0082159148334,136.34745581511382,137.10109773309034,135.70217756931117,132.47935526768777,127.35878828072931,119.93677584068564,112.39768481660613,109.37303827394014,107.16791080188607,101.81608101208793,92.58847469956677,83.21567458536418,86.63294719282503,101.26812860539339,114.68214557056169,122.7327563809439,125.59348797481894,123.76350402125736,118.26389009957268,116.34245948001073,123.78168323041649,129.78921427083176,131.9754194958146,131.71057816330685,129.90384904754552,126.51249016784601,122.2400326926942,119.92296598384048,122.00238053081277,125.67563725822029,127.49855890937131,126.59682802396568,122.37848723288941,114.85566139586028,114.22547302310696,121.62189039066338,127.33590647591397,131.00124646643715,131.4581964185114,127.23195927702446,117.72549862641351,109.15718761707542,117.5417232792651,125.89906325638462,128.1223527402383,124.03727447364358,115.62748592770117,114.1414572415632,120.16950335825283,124.54351889399076,125.50728589986323,122.59848279111162,117.78921780035344,117.87374702603012,121.46344538503499,123.00503642802835,122.8734071286911,125.0260325714215,130.05322831072004,133.77926904706976,133.55111737490492,127.36586241105557,115.31977487505993,120.14742685497546,132.08991772494053,140.90571592124957,145.90019036520025,146.94986939321637,145.25922677868306,143.01802540646966,142.99611495827006,145.75805912714097,148.7887275816813,150.50010621591636,151.12869154826384,151.3369874794862,151.14782222367967,149.81112513081436,146.74304447140364,142.19704817050356,137.1198908229571,131.9752019882868,125.21794163113624,113.57714712439454,97.1496708876078,101.99777402644207,108.58044026376153,113.26447168913776,112.44799022370425,96.50035067728408,110.7184240927532,124.75329634069374,126.09814773550508,116.55980886066847,92.09290392856308,112.46133923706601,125.10058260240726,133.47227546085253,139.36449484155528,142.62766498926533,143.28651934923624,141.7777189620662,138.76263185246356,135.23412709801426,133.3482677848772,133.95975448544326,134.50352636166627,132.7659707744914,127.74442217998808,118.51443047524482,105.70920689819519,111.95472089630582,123.86037400016116,130.59188784746723,133.04014714791705,131.70252224342494,128.0008127705433,127.38138224297306,129.434918343866,130.34020737337966,130.12929658046303,129.06093066996556,125.57473288368382,115.15550893518736,88.75111693106655,120.22453810765779,130.95014630155598,133.14503685689422,129.55533244102588,122.1039896651948,120.98431843230455,129.14457830522727,135.29395885539418,137.31014313066748,136.0819237857414,134.83640740952785,137.1831284757891,140.30229214517712,141.43509044999527,140.92874954055137,139.99017540878293,138.83460020229015,136.15353009056514,129.23071391558705,117.08769051494484,122.98399945459973,132.34571375732787,134.6597375927039,131.27989475331978,122.65446358116598,109.75949319385768,102.27131663760005,102.80963036664456,104.0666210406399,100.91412970054837,89.06336437380658,95.58870434298841,108.08474410886177,109.975290454292,100.66889665503349,88.96843946142424,108.35377053933227,114.07147267518978,110.93133801377837,109.40847694746347,118.86806993241346,126.52642833562173,129.76501730620384,129.27523809375847,126.67010440280367,124.2867969604617,122.46761377773747,117.95846370606961,104.04194815548871,88.40480038565197,106.82193564925728,107.60151358936267,96.42637893625684,88.65279147756746,104.27502925063335,112.6969219771717,117.9373093683718,121.406189082809,122.22759791766974,121.33894117599992,121.56481739405223,123.53842605672006,124.37982270531079,121.4664769197343,112.5421258034038,92.05572428849077,104.95013039989355,117.2150495419483,122.38464342834497,125.94120162594115,129.56872072251423,132.70817382527588,133.76983838542708,131.96684976064296,127.20200356221375,119.90507895581473,110.88228885993007,105.82567256372081,114.08568971832912,121.98872160371074,124.38192964308752,123.75101574287024,124.49157990671355,127.81856423476499,131.35653746685884,133.61619154056436,134.27054425788754,133.19274055872873,130.25785139226338,125.32131062603564,118.84529769293798,114.73094669137538,117.32300402124814,121.53943096505532,124.9379924905757,129.02643889799754,134.3253630920495,139.64910289859577,143.8496663010949,146.41329976809035,147.13649400326642,145.90790583900943,142.91983020235745,139.0408100268394,136.24004215578535,134.59953604193316,131.88611703248006,126.77824631740835,125.3372918872163,131.3391518029233,136.2994523875791,138.23949026777544,138.01618690253528,136.56384741173846,134.06648656763667,130.41631523162945,126.02312916597072,122.11888737668045,121.93072850705732,126.4549135403018,131.84271947263983,135.2216409007247,135.78574715423088,134.29650210685182,131.90021668190013,129.8594835186377,128.02810329865105,124.82896562622523,119.27804181115263,112.1618210875847,109.7606065138958,114.88031169305953,120.90516479632258,123.89634815814485,124.68805393056857,127.40506420407145,131.92568913122147,134.78655438887444,134.4848762084327,131.22808687816396,124.05101542935647,111.6680648967376,107.59959271972605,119.37875651717499,127.38222796356523,131.3818360741695,131.46362921294215,127.33447882627286,119.12981556963278,113.87365385967676,118.6459118084248,122.47968242291527,122.54191464816928,118.98660493600012,111.3390799924638,98.03459026282384,66.0661580661814,75.82987579913082,82.46862653900081,83.35442562124413,92.95836763726317,103.44710699349196,114.2263158659949,124.07664699923747,131.9837736115233,137.62243813449857,140.2867189328989,139.3177998211297,134.62922878192632,126.52050160692933,123.68212005871749,130.6692723829163,133.96735606383828,132.20629593622854,126.5367302709491,119.75248527642005,117.22061060775094,119.7137227059548,122.3623542790754,120.83475813308127,110.34310180873224,89.01927960713165,120.69558179387168,132.5104431738287,138.12673652205208,140.1080316236496,139.66190688366913,136.93978178629223,132.49447508534894,130.34818088211662,132.497424113394,134.24522201135863,133.6150381540072,131.37917928582317,129.61449782803453,128.68427532159342,128.17334706648543,128.5570699958125,129.62991707093713,130.74845529998203,134.16233629157972,140.3412106741102,145.92797999640203,149.0383053133878,149.4364893947315,148.0554258060447,146.3695241642237,145.83421067683977,146.10029858906174,145.5471045139762,143.17158774370387,138.29280912280117,129.4537010593994,111.58363981456151,92.9500761571869,118.07215437644277,127.15033919507839,131.78855357780378,135.09324290014425,137.02860179241654,137.23047459407942,136.94397279949845,137.86427558389795,140.02962568671,142.3485383990313,144.04004642976972,145.23040828356415,146.91784789675518,149.77722092433748,152.83961538279263,154.53838820199408,154.767354252018,155.10287774079123,156.66466873822475,158.52065843724156,159.60779223082642,159.8694960176258,159.69121555858095,159.09241653554025,158.03511913820253,157.40026253234646,158.2700924193581,160.33717038158198,162.69577420981906,164.56028366121572,165.02755215312504,163.283454921089,158.65569137848354,151.30289226152428,145.98183448662513,145.5672642570963,141.00160436370405,144.56602842693394,158.76317699692117,167.70472832739583,173.28440040276342,177.63272863056815,182.25384109168323,187.0496190825908,190.998692836551,193.5896629106951,195.4906998402826,197.26171132802398,198.68440631822128,199.29787388223784,200.06585544947043,202.15749478072573,204.1179813944494,203.48988916928616,198.68772392755173,187.46942834049108,167.07117359067868,172.52204017273783,183.33627056640074,189.56207222209986,194.98293881072215,199.6589895567035]],vY=(e,t)=>e[0]<=t&&t<=e[1],wY=s.exports.memoize(zS);class bY extends r.exports.Component{constructor(e){super(e),a(this,"canvas"),a(this,"ctx",null),a(this,"playPromise"),a(this,"seekWaveform",(async()=>{const{video:e}=this.props;if(!cT()&&(this.setState({seekOnPause:!0}),!this.playPromise))try{await(null==e?void 0:e.play()),this.playPromise=!0}catch(t){this.playPromise=!1}this.animateWaveform(!0)})),a(this,"drawZeroStateWaveform",(()=>{const{layer:e,width:t,height:a}=this.props,o=a/2,n="wave"===e.waveformStyle?o:a;if(this.ctx)if(this.ctx.fillStyle=e.color,"wave"===e.waveformStyle){let e=.01*a;e>5?e=5:e<2&&(e=2),this.ctx.fillRect(0,n,t,e)}else for(let r=0;r<t;r+=1){const e=.005*t||1,o=r*(2*e),n=.05*a;this.ctx.fillRect(o,a,e,-n)}})),a(this,"drawWaveStyleWaveform",((e,t,a,o)=>{var n,r;const i=Math.floor(.0015*a)||1,s=e*i,l=.5*o,d=t/255*o*.34;null==(n=this.ctx)||n.fillRect(s,l+1,i,-d),null==(r=this.ctx)||r.fillRect(s,l-1,i,d)})),a(this,"drawBarStyleWaveform",((e,t,a,o)=>{var n;const r=.005*a||1,i=e*(2*r),s=o,l=-(t/255)*o*.8;null==(n=this.ctx)||n.fillRect(i,s,r,l)})),a(this,"animateWaveform",((e=!1,t=0)=>{var a;const{seekOnPause:o}=this.state,{analyser:n,layer:r,height:i,width:s,studioPaused:l,video:d}=this.props;let c=t;if(!vY(this.props.absoluteTimes,this.props.studioTime))return void(null==(a=this.ctx)||a.clearRect(0,0,s,i));if(cT())return void this.drawMockWaveform();if(l){if(!e&&!o)return void("bar"!==r.waveformStyle&&this.drawZeroStateWaveform());if(12===t)return this.setState({seekOnPause:!1}),void(void 0!==this.playPromise&&(this.playPromise&&(null==d||d.pause()),this.playPromise=void 0))}window.requestAnimationFrame((()=>{c+=1,this.animateWaveform(!1,c)})),n.fftSize=4096;const u=new Uint8Array(n.frequencyBinCount);n.getByteFrequencyData(u),this.drawWaveform(u)})),this.state={seekOnPause:!1},this.canvas=r.exports.createRef()}componentDidMount(){const{analyser:e,video:t}=this.props;if(this.canvas.current){const e=this.canvas.current.getContext("2d");this.ctx=e}t&&e&&this.createWaveform()}componentDidUpdate(e){const{analyser:t,height:a,layer:o,studioPaused:n,studioTime:r,width:i}=this.props;if(t&&this.canvas){e.analyser||this.createWaveform();const t=vY(e.absoluteTimes,e.studioTime),a=vY(this.props.absoluteTimes,this.props.studioTime);!t&&a&&this.animateWaveform(),e.studioPaused&&!n&&(this.setState({seekOnPause:!1}),this.animateWaveform()),!n||e.layer.color===o.color&&e.layer.waveformStyle===o.waveformStyle||this.seekWaveform(),e.studioPaused&&e.studioTime!==r&&this.seekWaveform()}e.width===i&&e.height===a||(cT()?this.animateWaveform():this.drawZeroStateWaveform())}drawWaveform(e){if(!this.ctx)return;const{layer:t,height:a,width:o}=this.props;this.ctx.clearRect(0,0,o,a),this.ctx.fillStyle=t.color;const n=o;for(let r=0;r<n;r+=1)"wave"===t.waveformStyle?this.drawWaveStyleWaveform(r,e[r],o,a):"bar"===t.waveformStyle&&this.drawBarStyleWaveform(r,e[r],o,a)}drawMockWaveform(){const{layer:e}=this.props;let t;if("wave"===e.waveformStyle)[t]=EY;else[t]=fY;this.drawWaveform(t)}createWaveform(){const e=this.canvas.current;if(!e)return;const t=e.getContext("2d");this.ctx=t,this.drawZeroStateWaveform(),this.animateWaveform()}render(){const{width:e,height:t}=this.props;return i.createElement("canvas",{width:e,height:t,ref:this.canvas})}}const _Y=we(TT(m.exports.connect((()=>(e,t)=>({absoluteTimes:wY(t.layer),studioPaused:e.studio.studioPaused})))(bY))),TY=e=>{const t=new AbortController,a=new Set(e);function o(){t.abort(),function(){for(const e of a)e.removeEventListener("abort",o)}()}function n(e){t.signal.aborted||(e.aborted?o():(e.addEventListener("abort",o),a.add(e)))}for(const r of a)n(r);return t.signal};class SY extends Error{}function IY(e){if(e.aborted)throw e.reason?e.reason:new SY("Signal aborted")}class xY extends Error{constructor(e,t){super(t),a(this,"name","Mp4FileError"),this.mediaCacheId=e}}const kY=e=>({size:e.getUint32(0),type:String.fromCharCode(e.getUint8(4),e.getUint8(5),e.getUint8(6),e.getUint8(7))});class CY extends Error{constructor(e,t){super(t),a(this,"name","FetchError"),a(this,"status"),a(this,"statusText"),this.response=e,this.status=e.status,this.statusText=e.statusText}}class AY{constructor(e,t=0){a(this,"currentStream"),this._stream=e,this.byteOffset=t}[Symbol.asyncIterator](){return this}async getStream(){if(null==this.currentStream||0===this.currentStream.length){const e=await this._stream.next();if(e.done)return;this.currentStream=e.value}return this.currentStream}async consumeAtMost(e){const t=await this.getStream();if(null==t)return;if(null!=e&&t.length>e){const a=t.subarray(0,e);return this.currentStream=t.subarray(e),this.byteOffset+=a.length,a}const a=t;return this.currentStream=void 0,this.byteOffset+=a.length,a}async peakExactly(e){const t=await this.getStream();if(null==t)return;if(t.length>=e)return t.subarray(0,e);const a=[t];let o=t.length;for(;o<e;){this.currentStream=void 0;const e=await this.getStream();if(null==e)break;o+=e.length,a.push(e)}const n=new Uint8Array(o);let r=0;for(const i of a)n.set(i,r),r+=i.length;return this.currentStream=n,n.subarray(0,e)}async nextAtMost(e){const t=await this.consumeAtMost(e);return null==t?{done:!0,value:void 0}:{done:!1,value:t}}async nextExactly(e){const t=await this.consumeAtMost(e);if(null==t)return{done:!0,value:void 0};const a=new Uint8Array(e);a.set(t,0);let o=t.length;for(;o<e;){const t=await this.consumeAtMost(e-o);if(null==t)throw new Error("Not enough bytes");a.set(t,o),o+=t.length}return{done:!1,value:a}}async next(){return this.nextAtMost(void 0)}return(...e){return this._stream.return(...e)}throw(e){return this._stream.throw(e)}}async function NY(e){const t=await e.peakExactly(8);if(!(null==t||t.length<8))return kY(new DataView(t.buffer,t.byteOffset,t.length))}const PY=async e=>{const t=await BH(e.mediaLibraryId);if(null!=t&&t.assetId===e.assetId){if(!t.fragmented||null==t.headers)throw new xY(e.mediaLibraryId,"IndexDB file is not fragmented");return t.headers}const a=()=>{WH({mediaCacheId:e.mediaLibraryId,assetId:e.assetId,fragmented:!1})};let o,n,r=0;const i=[],s=new AY(async function*({url:e,signal:t,headers:a}){const o=new AbortController,n=t?TY([t,o.signal]):o.signal,r=await fetch(e,{signal:n,headers:a});if(!r.body||!r.ok)throw new CY(r);const i=r.body.getReader();let s;try{for(;;){if(s=await i.read(),IY(t),s.done)return;yield s.value}}finally{o.abort()}}(e));for await(const l of async function*(e){try{for(;;){const t=await NY(e);if(null==t)return;const a=await e.nextExactly(t.size);if(a.done||a.value.length<t.size)return;yield a.value}}finally{e.return()}}(s)){switch(kY(new DataView(l.buffer,l.byteOffset,l.byteLength)).type){case"ftyp":o=l;break;case"moov":if(!o)throw a(),new xY(e.mediaLibraryId,"Mp4 file doesn't contain ftyp\nthis should be impossible");n=new Uint8Array(o.length+l.length),n.set(o,0),n.set(l,o.length);break;case"sidx":i.push({offset:r,bytes:l})}r+=l.length;const t=await NY(s);if(null==t||"moof"===t.type||"mdat"===t.type)break}if(s.return(),null==n||0===i.length){if(a(),!n)throw new xY(e.mediaLibraryId,"Could not parse the initialization segment");if(0===i.length)throw new xY(e.mediaLibraryId,"Could not parse any sidx atoms")}return WH({mediaCacheId:e.mediaLibraryId,assetId:e.assetId,fragmented:!0,headers:{initSegment:n,sidx:i}}),{assetId:e.assetId,initSegment:n,sidx:i}},RY=new Map,LY=async e=>{const t=await ic(RY,e.assetId,{async insert(){const t=await PY(e);return RY.delete(e.assetId),t}}),a=t.sidx.map((e=>{const t=Ke.inspect(e.bytes)[0];return t.offset=e.offset,t})),[o,n]=((e,t,a)=>{const o=qe();1===s.exports.uniqBy(a,(e=>e.firstOffset+e.offset+e.size)).length&&p("Fragmented mp4 file has multiple distinct sidx atoms",{extra:{mediaLibraryId:e,assetId:t}}),a.length&&a[0].references.length>0&&p("Fragmented mp4 file is empty",{extra:{mediaLibraryId:e,assetId:t}});const n=a[0];if(null==n)throw new xY(e,"No sidx atoms to parse\nIs this file fragmented?");const{timescale:r}=n;let i,l=n.earliestPresentationTime,d=n.firstOffset+n.offset+n.size;if(0===r)throw new xY(e,"Invalid timescale");let c=0;for(const s of n.references){if(0!==s.referenceType)throw new xY(e,"Unsupported SIDX format");const a=l/r,n=(l+s.subsegmentDuration)/r,u=d,m=d+s.referencedSize-1,p={idx:c,mediaLibraryId:e,assetId:t,startTime:a,endTime:n,duration:s.subsegmentDuration/r,size:s.referencedSize,byteRange:[u,m]};c+=1,i||(i=p),o.insert([a,n,p]),l+=s.subsegmentDuration,d+=s.referencedSize}return[i,o]})(e.mediaLibraryId,e.assetId,a),r=(i=a,Math.max(...i.map((e=>e.references.reduce(((e,t)=>e+t.subsegmentDuration),0)/e.timescale))));var i;const l=Ye.tracks(t.initSegment);return{mimeType:`${l.some((e=>"video"===e.type))?"video":"audio"}/mp4; codecs="${l.map((e=>e.codec)).join(",")}";`,initializationSegment:t.initSegment,firstNode:o,intervalTree:n,duration:r}},DY=e=>new Promise((t=>e.addEventListener("updateend",t,{once:!0}))),OY=new Map;async function FY(e,t,a,o){const n=a.map((({segment:t})=>{const a=`${t.mediaLibraryId}_${t.idx}`;return ic(OY,a,{async insert(){try{const r=await VH(t.assetId,t.idx);if(null!=r)return r;const i=await fetch(e,{headers:{Range:`bytes=${t.byteRange[0]}-${t.byteRange[1]}`}}).then((e=>{if(!e.ok)throw e;return e})).then((e=>e.blob())).then((e=>e.arrayBuffer())).then((e=>new Uint8Array(e)));return o=t.mediaLibraryId,n=t.size,dH[o]?dH[o]+=n:dH[o]=n,hH("asset_segment_sizes",dH),BT(t.mediaLibraryId,t.size),jH(t.mediaLibraryId,t.assetId,t.idx,i),i}finally{OY.delete(a)}var o,n}})}));for(const r of n){const e=await r;if(IY(o),e){for(;t.updating;)await DY(t),IY(o);t.appendBuffer(e)}}}class MY{constructor(e,t,o){a(this,"queue",[]),a(this,"queueSorted",!1),a(this,"controller"),this.url=e,this.signal=t,this.buffer=o}isSegmentLoaded(e){let t=0,a=this.buffer.buffered.length-1;for(;t<=a;){const o=Math.floor((t+a)/2),n=this.buffer.buffered.start(o),r=this.buffer.buffered.end(o);if(e.startTime>=n&&e.endTime<=r)return!0;r<=e.startTime?t=o+1:a=o-1}return!1}async enqueue(e){for(const o of e)this.isSegmentLoaded(o.segment)||(this.queue.push(o),this.queueSorted=!1);if(null!=this.controller&&!this.controller.signal.aborted)return;const t=new AbortController;this.controller=t;const a=TY([this.signal,t.signal]);try{for(;this.queue.length;){this.queueSorted||(this.queue.sort(((e,t)=>e.priority-t.priority)),this.queueSorted=!0);const e=[];for(;e.length<5&&this.queue.length;){const t=this.queue.shift();null==t||this.isSegmentLoaded(t.segment)||e.push(t)}await FY(this.url,this.buffer,e,a)}}finally{t.abort()}}}const UY=class{constructor(e){a(this,"mediaLibraryId"),a(this,"video"),a(this,"signal"),a(this,"controller"),a(this,"mediaSource"),a(this,"mediaSourceLink"),a(this,"sourceBuffer"),a(this,"data"),a(this,"url"),a(this,"nextSegmentToLoad"),a(this,"segmentLoader"),a(this,"destroyed",!1),this.mediaLibraryId=e.mediaLibraryId,this.video=e.video,this.controller=new AbortController,this.signal=TY([this.controller.signal,e.signal]),this.mediaSource=e.mediaSource,this.mediaSourceLink=e.mediaSourceLink,this.sourceBuffer=e.sourceBuffer,this.data=e.data,this.url=e.url,this.nextSegmentToLoad=e.data.firstNode,this.segmentLoader=new MY(e.url,this.signal,this.sourceBuffer),this.error=this.error.bind(this),this.cleanup=this.cleanup.bind(this),this.listen=this.listen.bind(this),this.bufferCurrentTime=this.bufferCurrentTime.bind(this),this.forceBufferCurrentTime=this.forceBufferCurrentTime.bind(this),this.listen()}updateUrl(e){this.url=e,this.segmentLoader.url=e}getNodesToBuffer(e,t=0){const a=[],o=UY.MAX_BUFFER_TIME*this.video.playbackRate;if(this.data.intervalTree.queryInterval(e-o,e+o,(([,,e])=>{a.push(e)})),0===a.length)return p("can't find a node for this time? this should never happen",{extra:{time:e,mediaLibraryId:this.mediaLibraryId}}),[];return a.map((a=>{let o;return o=a.startTime<=e&&e<=a.endTime?-1:a.endTime<=e?e-a.endTime:a.startTime-e,{segment:a,priority:o+t}})).sort(((e,t)=>e.priority-t.priority))}prebuffer(e){const t=this.getNodesToBuffer(e,5);this.segmentLoader.enqueue(t)}forceBufferCurrentTime(){var e;const t=this.getNodesToBuffer(this.video.currentTime);null==(e=this.segmentLoader.controller)||e.abort(),this.segmentLoader.queue.splice(0,this.segmentLoader.queue.length),this.segmentLoader.enqueue(t)}async bufferCurrentTime(){const e=this.getNodesToBuffer(this.video.currentTime);this.segmentLoader.enqueue(e)}listen(){this.video.addEventListener("timeupdate",this.bufferCurrentTime),this.video.addEventListener("seeking",this.forceBufferCurrentTime),this.video.addEventListener("playing",this.forceBufferCurrentTime),this.video.addEventListener("error",this.error),this.signal.addEventListener("abort",this.cleanup),this.sourceBuffer.addEventListener("error",this.error),this.mediaSource.addEventListener("sourceclose",this.error)}error(e){b(e),this.cleanup()}cleanup(){if(!this.destroyed){this.destroyed=!0,this.signal.removeEventListener("abort",this.error),this.video.removeEventListener("error",this.error),this.controller.abort(),this.video.removeEventListener("timeupdate",this.bufferCurrentTime),this.video.removeEventListener("seeking",this.forceBufferCurrentTime),this.video.removeEventListener("playing",this.forceBufferCurrentTime),this.sourceBuffer.removeEventListener("error",this.cleanup),this.mediaSource.removeEventListener("sourceclose",this.error),URL.revokeObjectURL(this.video.src),delete this.video.dataset.mse,this.video.src=this.url,this.video.load();for(const e of this.mediaSource.activeSourceBuffers)this.mediaSource.removeSourceBuffer(e)}}};let BY=UY;a(BY,"MAX_BUFFER_TIME",15);const WY=e=>{console.log("OnPause: ",e)};class VY{constructor(e){a(this,"audioContextByDomId",new Map),a(this,"domElementByLayerId",new Map),a(this,"gainNodeByDomId",new Map),a(this,"initAudioContexts"),a(this,"isCanvas"),a(this,"layerIdsByMediaId",new Map),a(this,"layerIdsByElementId",new Map),a(this,"layerByLayerId",new Map),a(this,"domElementByDomId",new Map),a(this,"numVideoElements",0),a(this,"sourceNodeByDomId",new Map),a(this,"abortController",new AbortController),a(this,"streamsByElementId",new Map);const{initAudioContexts:t=!1,isCanvas:o=!1}=e||{};this.initAudioContexts=t,this.isCanvas=o}getJsonLayerIdToElementId(){const e={};for(const[t,a]of this.domElementByLayerId)e[t]=a.id;return e}static doTimesOverlap(e,t,a=!0){return!a&&e[0]<t[1]&&e[1]>t[0]||!!(a&&e[0]<=t[1]&&e[1]>=t[0])}logAmplitudeEvents(e,t){const a=t.startsWith("blob:")?"local":"remote";e.onplay=()=>{console.log("OnPlay: ",e.id)},e.onpause=WY.bind(null,e.id),e.onseeking=()=>{const t=`OnSeeked: ${e.id}`;console.time(t)},e.onseeked=()=>{console.timeEnd(`OnSeeked: ${e.id}`)},e.onerror=()=>{var o,n;console.log("ElementPool onerror",{src:t,localOrRemoteSrc:a,errorCode:null==(o=e.error)?void 0:o.code,errorMessage:null==(n=e.error)?void 0:n.message})},e.onwaiting=()=>{console.log("OnWaiting: ",e.id)}}logAmplitudeUsageEvents(){const e=MT.getMetrics();e&&vc("Video usage",e),MT.map.clear()}createAudioContext(e,t){if(this.audioContextByDomId.has(t))return;const a=new AudioContext,o=a.createMediaElementSource(e),n=a.createGain();o.connect(n),n.connect(a.destination),n.gain.value=1,this.audioContextByDomId.set(t,a),this.sourceNodeByDomId.set(t,o),this.gainNodeByDomId.set(t,n)}createVideoElement(e){const{url:t,disableCORS:a,type:o,mediaId:n}=e,r=document.createElement("video");r.id=`v${this.numVideoElements}`;return"video"===o&&(this.isCanvas,e.mediapipe,!1)&&e.fragmented?async function(e,{url:t,signal:a,mediaLibraryId:o,assetId:n}){let r;e.dataset.mse="true",e.dataset.mediaId=o;try{r=await LY({url:t,mediaLibraryId:o,assetId:n,signal:a})}catch(YEe){return b(YEe),void(e.src=t)}if(!MediaSource.isTypeSupported(r.mimeType))return void(e.src=t);const i=new MediaSource,s=URL.createObjectURL(i);return e.src=s,new Promise((n=>{i.addEventListener("sourceopen",(async()=>{if(a.aborted)return;i.duration=r.duration;const l=i.addSourceBuffer(r.mimeType);let d;function c(){l.removeEventListener("error",u),d=new BY({mediaLibraryId:o,video:e,signal:a,mediaSource:i,sourceBuffer:l,data:r,url:t,mediaSourceLink:s}),d.forceBufferCurrentTime(),n(d)}function u(a){l.removeEventListener("updateend",c),b(a),d?d.cleanup():(URL.revokeObjectURL(e.src),delete e.dataset.mse,n(void 0)),e.src=t,e.load()}l.appendBuffer(r.initializationSegment),l.addEventListener("updateend",c,{once:!0}),l.addEventListener("error",u,{once:!0})}),{once:!0})}))}(r,{url:t,mediaLibraryId:e.mediaId,assetId:e.previewAssetId,signal:this.abortController.signal}).then((e=>{e&&this.streamsByElementId.set(r.id,e)})):r.src=t,r.autoplay=!1,r.preload="auto",r.crossOrigin="anonymous",r.playsInline=!0,r.setAttribute("style","width: 100%; height: 100%;"),this.logAmplitudeEvents(r,t),a&&(r.crossOrigin=null),Nl()&&r.setAttribute("data-hasBeenPlayed","false"),this.numVideoElements+=1,r.addEventListener("canplay",(()=>{if(r.setAttribute("data-hasBeenPlayable","true"),this.layerIdsByElementId.has(r.id)){const e=this.layerIdsByElementId.get(r.id).map((e=>[e,{hasBeenPlayable:!0}]));YT(Object.fromEntries(e))}}),{once:!0}),MT.attachEvents(r,n),FT.attachEvents(r,n),r}findLayerIdWithReusableElement(e){const t=this.layerIdsByMediaId.get(e.mediaId);let a;for(const o of t){const{startEndTimes:t}=this.layerByLayerId.get(o);if(VY.doTimesOverlap(t,e.startEndTimes))continue;const n=this.domElementByLayerId.get(o),r=this.layerIdsByElementId.get(n.id);let i=!1;for(const a of r){const t=this.layerByLayerId.get(a);if(VY.doTimesOverlap(e.startEndTimes,t.startEndTimes)){i=!0;break}}if(!i){a=o;break}}return a}findLayersOverlappingTarget(e){const t=this.layerIdsByMediaId.get(e.mediaId),a=[];return t?(t.forEach((t=>{const o=this.layerByLayerId.get(t);VY.doTimesOverlap(e.startEndTimes,o.startEndTimes)&&a.push(o)})),a):[]}isCurrentElementMappingValid(e,t){const a=this.domElementByLayerId.get(e.layerId);if(!a)return console.error("Ran `isCurrentElementMappingValid` with no valid target element."),!0;for(const o of t)if(o.layerId!==e.layerId&&this.domElementByLayerId.get(o.layerId)===a)return!1;return!0}getCachedLayerIdsToInvalidate(e){const t=[];e.filter((e=>{const t=this.layerByLayerId.get(e.layerId);if(!t)return!1;const[a,o]=t.startEndTimes,[n,r]=e.startEndTimes;return!(a===n&&o===r)})).forEach((e=>{const a=this.findLayersOverlappingTarget(e);this.isCurrentElementMappingValid(e,a)||t.push(e.layerId)}));return e.filter((e=>!this.layerByLayerId.get(e.layerId))).forEach((a=>{this.findLayersOverlappingInNewTimeline(a,e).forEach((e=>{t.includes(e.layerId)||t.push(e.layerId)}))})),t}findLayersOverlappingInNewTimeline(e,t){const a=t.filter((t=>t.mediaId===e.mediaId)),o=[];return a.forEach((t=>{t.layerId!==e.layerId&&VY.doTimesOverlap(e.startEndTimes,t.startEndTimes,!1)&&o.push(t)})),o}destroyDomPool(){this.logAmplitudeUsageEvents(),this.abortController.abort(),this.abortController=new AbortController;for(const[e,t]of this.domElementByDomId)t.remove();for(const[e,t]of this.streamsByElementId)t.cleanup();this.streamsByElementId.clear(),this.audioContextByDomId.clear(),this.domElementByDomId.clear(),this.domElementByLayerId.clear(),this.gainNodeByDomId.clear(),this.layerByLayerId.clear(),this.layerIdsByElementId.clear(),this.layerIdsByMediaId.clear(),this.numVideoElements=0,this.sourceNodeByDomId.clear()}regenerateDomPool(e){var t;const a=new Map(this.domElementByLayerId);this.getCachedLayerIdsToInvalidate(e).forEach((e=>{a.delete(e)})),this.domElementByLayerId=new Map,this.layerIdsByMediaId=new Map,this.layerIdsByElementId=new Map,this.layerByLayerId=new Map,e.forEach((e=>{this.layerByLayerId.set(e.layerId,e)}));for(const o of e){const e=this.initAudioContexts&&!o.disableCORS;if(a.has(o.layerId)){const t=a.get(o.layerId),n=this.streamsByElementId.get(t.id);let r;if(r=t.dataset.mse?null==n?void 0:n.url:t.src,o.url!==r&&void 0!==r){const a=()=>{const{currentTime:a,muted:r}=t;t.dataset.mse?null==n||n.updateUrl(o.url):t.src=o.url,t.muted=!0,t.currentTime=a,t.muted=r,t.crossOrigin="anonymous",e&&"true"!==t.dataset.audioContextInitted&&(this.createAudioContext(t,t.id),t.dataset.audioContextInitted="true"),Nl()&&t.load()};t.paused?a():t.onpause=()=>{a(),t.onpause=WY.bind(null,t.id)}}this.domElementByLayerId.set(o.layerId,t),this.domElementByDomId.set(t.id,t),t.hasAttribute("data-hasBeenPlayable")&&KT(o.layerId,{hasBeenPlayable:!0}),this.layerIdsByElementId.has(t.id)?this.layerIdsByElementId.get(t.id).push(o.layerId):this.layerIdsByElementId.set(t.id,[o.layerId]),this.layerIdsByMediaId.has(o.mediaId)?this.layerIdsByMediaId.get(o.mediaId).push(o.layerId):this.layerIdsByMediaId.set(o.mediaId,[o.layerId]),a.delete(o.layerId)}else if(this.layerIdsByMediaId.has(o.mediaId)){const a=this.findLayerIdWithReusableElement(o);if(a){const e=this.domElementByLayerId.get(a);this.domElementByLayerId.set(o.layerId,e),this.domElementByDomId.set(e.id,e),null==(t=this.layerIdsByElementId.get(e.id))||t.push(o.layerId),this.layerIdsByMediaId.get(o.mediaId).push(o.layerId),e.hasAttribute("data-hasBeenPlayable")&&KT(o.layerId,{hasBeenPlayable:!0})}else{const t=this.createVideoElement(o);this.domElementByLayerId.set(o.layerId,t),this.domElementByDomId.set(t.id,t),this.layerIdsByElementId.set(t.id,[o.layerId]),this.layerIdsByMediaId.get(o.mediaId).push(o.layerId),e&&(this.createAudioContext(t,t.id),t.dataset.audioContextInitted="true")}}else{const t=this.createVideoElement(o);this.domElementByLayerId.set(o.layerId,t),this.domElementByDomId.set(t.id,t),this.layerIdsByElementId.set(t.id,[o.layerId]),this.layerIdsByMediaId.set(o.mediaId,[o.layerId]),e&&(this.createAudioContext(t,t.id),t.dataset.audioContextInitted="true")}}for(const[o,n]of a)n.pause(),n.remove();for(const[o,n]of this.streamsByElementId)this.domElementByDomId.has(o)||(n.cleanup(),this.streamsByElementId.delete(o));for(const o of this.domElementByDomId.keys()){const e=this.layerIdsByElementId.get(o);e&&e.length||(this.domElementByDomId.delete(o),this.gainNodeByDomId.has(o)&&(this.gainNodeByDomId.get(o).disconnect(),this.gainNodeByDomId.delete(o)),this.sourceNodeByDomId.has(o)&&(this.sourceNodeByDomId.get(o).disconnect(),this.sourceNodeByDomId.delete(o)),this.audioContextByDomId.has(o)&&(this.audioContextByDomId.get(o).close(),this.audioContextByDomId.delete(o)))}}}function jY(){return/^((?!chrome|android).)*safari/i.test(window&&window.navigator&&window.navigator.userAgent||"")}!function(){function e(e){e&&(e.setTargetAtTime||(e.setTargetAtTime=e.setTargetValueAtTime))}"undefined"!=typeof window&&jY()&&(window.hasOwnProperty("webkitAudioContext")&&!window.hasOwnProperty("AudioContext")&&(window.AudioContext=webkitAudioContext,AudioContext.prototype.hasOwnProperty("createGain")||(AudioContext.prototype.createGain=AudioContext.prototype.createGainNode),AudioContext.prototype.hasOwnProperty("createDelay")||(AudioContext.prototype.createDelay=AudioContext.prototype.createDelayNode),AudioContext.prototype.hasOwnProperty("createScriptProcessor")||(AudioContext.prototype.createScriptProcessor=AudioContext.prototype.createJavaScriptNode),AudioContext.prototype.hasOwnProperty("createPeriodicWave")||(AudioContext.prototype.createPeriodicWave=AudioContext.prototype.createWaveTable),AudioContext.prototype.internal_createGain=AudioContext.prototype.createGain,AudioContext.prototype.createGain=function(){var t=this.internal_createGain();return e(t.gain),t},AudioContext.prototype.internal_createDelay=AudioContext.prototype.createDelay,AudioContext.prototype.createDelay=function(t){var a=t?this.internal_createDelay(t):this.internal_createDelay();return e(a.delayTime),a},AudioContext.prototype.internal_createBufferSource=AudioContext.prototype.createBufferSource,AudioContext.prototype.createBufferSource=function(){var t=this.internal_createBufferSource();return t.start?(t.internal_start=t.start,t.start=function(e,a,o){void 0!==o?t.internal_start(e||0,a,o):t.internal_start(e||0,a||0)}):t.start=function(e,t,a){t||a?this.noteGrainOn(e||0,t,a):this.noteOn(e||0)},t.stop?(t.internal_stop=t.stop,t.stop=function(e){t.internal_stop(e||0)}):t.stop=function(e){this.noteOff(e||0)},e(t.playbackRate),t},AudioContext.prototype.internal_createDynamicsCompressor=AudioContext.prototype.createDynamicsCompressor,AudioContext.prototype.createDynamicsCompressor=function(){var t=this.internal_createDynamicsCompressor();return e(t.threshold),e(t.knee),e(t.ratio),e(t.reduction),e(t.attack),e(t.release),t},AudioContext.prototype.internal_createBiquadFilter=AudioContext.prototype.createBiquadFilter,AudioContext.prototype.createBiquadFilter=function(){var t=this.internal_createBiquadFilter();return e(t.frequency),e(t.detune),e(t.Q),e(t.gain),t},AudioContext.prototype.hasOwnProperty("createOscillator")&&(AudioContext.prototype.internal_createOscillator=AudioContext.prototype.createOscillator,AudioContext.prototype.createOscillator=function(){var t=this.internal_createOscillator();return t.start?(t.internal_start=t.start,t.start=function(e){t.internal_start(e||0)}):t.start=function(e){this.noteOn(e||0)},t.stop?(t.internal_stop=t.stop,t.stop=function(e){t.internal_stop(e||0)}):t.stop=function(e){this.noteOff(e||0)},t.setPeriodicWave||(t.setPeriodicWave=t.setWaveTable),e(t.frequency),e(t.detune),t})),window.hasOwnProperty("webkitOfflineAudioContext")&&!window.hasOwnProperty("OfflineAudioContext")&&(window.OfflineAudioContext=webkitOfflineAudioContext))}();const GY=new VY({initAudioContexts:!0,isCanvas:!0});window.canvasElementPool=GY;const HY=i.createContext(GY),zY=({children:e})=>{const t=_T(),a=tr((e=>HS(e))),o=tr((e=>$S(e))),n=tr((e=>e.studioLocal.isLayerMountedByLayerId),m.exports.shallowEqual),s=tr((e=>null!==e.studioLocal.userManualSeek)),l=r.exports.useRef([]),d=r.exports.useRef((e=>!1));return r.exports.useEffect((()=>{d.current=e=>{const t=o.find((t=>jT(e,t.startEndTimes[0],.03333333333333333)))||a.find((t=>t.type===ln.Video&&jT(e,t.startEndTimes[0],.03333333333333333)));return!!t&&!n[t.layerId]}}),[o,a,n]),r.exports.useEffect((function(){GY.regenerateDomPool(a)}),[a]),r.exports.useEffect((function(){const e=[];for(const[a,o]of GY.domElementByDomId){const n=GY.layerIdsByElementId.get(a);if(!n){console.warn(`Video ${a}: no layers for `,o.src);continue}const r=e=>{const a=GY.layerByLayerId.get(e),[o,n]=a.startEndTimes;return o<=t&&t<=n||(!(!JS(n,t,!1)||!d.current(n))||!(!l.current.includes(e)||!s))};if(n.every((t=>!r(t)||(e.push(t),!1)))){const e=n.find((e=>{const a=GY.layerByLayerId.get(e),[o,n]=a.startEndTimes;return t<o}))||n[0],a=GY.layerByLayerId.get(e);o.pause(),o.remove(),xT(e,!1),jT(o.currentTime,a.relativeStartEndTimes[0],.03333333333333333)||setTimeout((()=>{o.currentTime=a.relativeStartEndTimes[0]}),0)}}l.current=e}),[t,s]),r.exports.useEffect((function(){return()=>{GY.destroyDomPool()}}),[]),i.createElement(HY.Provider,{value:GY},e)};const $Y=!Ll(),KY=kl();let YY,qY;sl()?(YY=new Promise((e=>e({}))),qY=new Promise((e=>e({})))):(YY=vP((()=>import("./index.08ca7c2d.js")),["assets/index.08ca7c2d.js","assets/graph_model.49d095af.js","assets/vendor.96643be6.js"]),qY=vP((()=>import("./body-pix.esm.8e048d83.js")),["assets/body-pix.esm.8e048d83.js","assets/graph_model.49d095af.js","assets/vendor.96643be6.js"]));const XY=(e,t)=>e[0]<=t&&t<e[1],JY=s.exports.memoize(zS),QY=class extends r.exports.Component{constructor(e){var t;super(e),a(this,"analyser",null),a(this,"audioContext"),a(this,"audiogramErrorToastShown"),a(this,"canvas",null),a(this,"container",i.createRef()),a(this,"didLogVideoAnalytics"),a(this,"firstTimeReferenceLayer",!1),a(this,"filterCanvas",null),a(this,"fullIntermediateCanvas",null),a(this,"gainNode"),a(this,"loadError"),a(this,"logFileExperiment",null),a(this,"logFileSize",null),a(this,"logFileSource"),a(this,"logFileType",null),a(this,"longLoadTimeout",null),a(this,"loopSetStudioTimeID",null),a(this,"mounted"),a(this,"mountTime"),a(this,"onCanPlayTime"),a(this,"onLoadedDataTime"),a(this,"onLoadedMetadataTime"),a(this,"onLoadStartTime"),a(this,"previousDrawingTime",null),a(this,"reverseAudio",null),a(this,"reverseAudioSource",null),a(this,"reversedIntervalID",null),a(this,"setStudioTimeLoopRunning",!1),a(this,"shouldSetStudioTimeFromVideo",!1),a(this,"smallIntermediateCanvas",null),a(this,"source",null),a(this,"staticVideo",null),a(this,"video",null),a(this,"videoDriftCounter"),a(this,"videoDriftInterval"),a(this,"videoLoaded"),a(this,"webGLCanvas",null),a(this,"selfieSegmentation",null),a(this,"mediapipeSegmentResults",null),a(this,"currentProcessedBlurValue",null),a(this,"initializingSelfieSegmentation",!1),a(this,"initSelfieSegmentationRetries",0),a(this,"setupSelfieSegmentation",(()=>{const{layer:e}=this.props;$Y&&!this.selfieSegmentation&&(e.removeBg||e.blurBg)&&(this.selfieSegmentation=new Xe({locateFile:e=>`https://cdn.jsdelivr.net/npm/@mediapipe/selfie_segmentation/${e}`}),this.selfieSegmentation.setOptions({modelSelection:1}),this.selfieSegmentation.onResults(this.onMediapipeSegmentResults),this.initSelfieSegmentation())})),a(this,"initSelfieSegmentation",(async()=>{if(this.selfieSegmentation)if(QY.initializingSelfieSegmentation)setTimeout(this.initSelfieSegmentation,100);else try{QY.initializingSelfieSegmentation=!0,this.initializingSelfieSegmentation=!0,await this.selfieSegmentation.initialize(),QY.initializingSelfieSegmentation=!1,this.initializingSelfieSegmentation=!1,this.setState({selfieSegmentationLoaded:"loaded"}),this.state.loading&&this.stopLoading()}catch(YEe){if(QY.initializingSelfieSegmentation=!1,this.initializingSelfieSegmentation=!1,this.initSelfieSegmentationRetries<5){const e=2**this.initSelfieSegmentationRetries*100;this.initSelfieSegmentationRetries+=1,setTimeout(this.initSelfieSegmentation,e)}else this.setState({selfieSegmentationLoaded:"failed"})}})),a(this,"setStudioTimeFromVideo",(async()=>{if(!this.video||!XS()||!PT(this.props.layer))return;const[e,t]=this.props.absoluteTimes,a=this.props.layer.startTime||0,o=this.props.layer.playbackRate||1,n=HT(this.props.studioTime,e,a,o);if(this.firstTimeReferenceLayer){if(!GT(n,this.video.currentTime,n+.03333333333333333)){const e=(r=this.video,new Promise((e=>{r.addEventListener("seeked",(function(){e()}),{once:!0})})));$T(this.video,n),await e}this.firstTimeReferenceLayer=!1}else{const{currentTime:t}=this.video;if(!(t-.03333333333333333<=n&&n<=t+.03333333333333333)){const t=zT(this.video.currentTime,e,a,o);IT(t)}}var r})),a(this,"loopSetStudioTimeFromVideo",(()=>{this.loopSetStudioTimeID=window.setTimeout((async()=>{this.shouldSetStudioTimeFromVideo?(await this.setStudioTimeFromVideo(),this.loopSetStudioTimeFromVideo()):this.setStudioTimeLoopRunning=!1}),33.333333333333336)})),a(this,"openSetStudioTimeInterval",(()=>{this.setStudioTimeLoopRunning||(this.setStudioTimeLoopRunning=!0,this.shouldSetStudioTimeFromVideo=!0,this.firstTimeReferenceLayer=!0,this.loopSetStudioTimeFromVideo())})),a(this,"closeSetStudioTimeInterval",(()=>{this.shouldSetStudioTimeFromVideo=!1})),a(this,"setVideoSrc",((e=!1)=>{const{layer:t}=this.props,{videoSrc:a}=this.state,o=tT(t)||"",n=o.startsWith("blob:"),r=null==a?void 0:a.startsWith("blob:");if((n||!r)&&o!==a){const t={videoSrc:o};e&&!this.state.videoSrc&&(t.videoSrcAtMount=o||""),this.setState(t),this.logFileSource="gcs"}})),a(this,"updateReversedVideoTime",(()=>{var e;this.video&&void 0!==this.video.currentTime&&(this.video.currentTime-=.1*(null!=(e=this.props.layer.playbackRate)?e:1)*this.props.globalPlaybackRate)})),a(this,"setupVideo",(async()=>{const{layer:e,staticPreview:t,studioPaused:a}=this.props;await this.initCanvasVideo(),t||(this.longLoadTimeout=window.setTimeout(this.recordLongLoadAmplitudeEvent,15e3)),this.video&&(this.video.onloadedmetadata=this.initVideo,this.video.onerror=this.handleError,(e.isAudiogram||e.local_url)&&(e.isReversed&&this.initReverseAudio(),e.isAudiogram&&this.initAnalyser()),a&&(this.video.pause(),this.gainNode&&(this.gainNode.gain.value=-1)),this.props.forMovingZoomControls&&(await OK(this.props.layer,this.video,this.props.studioTime),QA())),this.staticVideo&&(this.staticVideo.onloadedmetadata=this.initStaticVideo,this.staticVideo.onerror=this.handleError,this.staticVideo.onloadeddata=({currentTarget:t})=>{t&&(t.currentTime=ST()-(e.videoDelay||0)||e.startTime||0)},this.staticVideo.onseeked=this.drawPreviewToCanvas)})),a(this,"checkHasAudio",(()=>{const{video:e}=this,{layer:t}=this.props;if(e){const a=e.mozHasAudio||(e.audioTracks||[]).length>0||e.webkitAudioDecodedByteCount>0;px({[t.id]:{hasAudio:a}},!1)}})),a(this,"getNumVideoLayers",(()=>{const{scenes:e}=this.props;let t=0;return e.forEach((e=>{e.layers.every((e=>("video"===e.type&&(t+=1),"subtitle"!==e.type)))})),t})),a(this,"recordLongLoadAmplitudeEvent",(()=>{var e,t,a,o,n,r;const{location:i,layer:s}=this.props;if(this.videoLoaded||!this.mounted||this.loadError||s.requireConversion)return;if(s.longLoadFired)return;px({[s.id]:{longLoadFired:!0}});const l=this.getVideoSrc(!0).substring(0,500),d=this.state.videoSrcAtMount.substring(0,500),c=this.getNumVideoLayers();Math.random()>.25||vc("Long Video Load",{url:l,urlAtMount:d,urlChanged:l===d,addedFromMediaLibrary:s.addedFromMediaLibrary,numVideoLayers:c,pathname:i.pathname,source:s&&s.source||"",sourceAtMount:this.state.sourceAtMount,mime:s&&s.mime||"",size:s&&s.size||0,asset_id:s&&s.asset_id||"",optimized_asset_id:(null==(e=null==s?void 0:s.preview)?void 0:e.asset_id)||"",longLoadThreshold:15,local:l&&l.startsWith("blob"),isAssetInIDB:this.state.isAssetInIDB,assetRefetched:this.state.assetRefetched,retries:this.state.retries,blurBg:s.blurBg,removeBg:s.removeBg,chromaKey:s.chromaKey,experimentName:null==(t=this.logFileExperiment)?void 0:t.name,experimentTimeToInit:null==(a=this.logFileExperiment)?void 0:a.timeToInit,experimentTimeToTranscode:null==(o=this.logFileExperiment)?void 0:o.timeToTranscode,experimentStatus:null==(n=this.logFileExperiment)?void 0:n.status,error:null==(r=this.logFileExperiment)?void 0:r.error})})),a(this,"setVolume",(()=>{const e=!this.gainNode,{layer:t,layerTempValues:a}=this.props,{volumeTemp:o}=a[t.id]||{};if(void 0===t.volume&&void 0===o)e?this.video&&(this.video.volume=1):this.gainNode&&(this.gainNode.gain.value=1);else{const a=Number(this.props.layer.volume);let n=null!=o?o:a;e&&(n=Math.min(n,1)),!Number.isNaN(n)&&this.gainNode&&this.audioContext?this.gainNode.gain.setValueAtTime(n,this.audioContext.currentTime):this.video&&(this.video.volume=null!=n?n:1);const{absoluteTimes:[r,i],studioTime:s}=this.props,{audioEffect:l,fadePosition:d,fadeSpeed:c}=t;if("fade"===l){const t=(e=>{const{start:t,end:a,current:o,fadeSpeed:n,fadePosition:r}=e;if(!n)return 0;const i=FK[n];if(!i)return 0;let s=1;("intro"===r||"both"===r)&&t<=o&&o<t+i&&(s=MK.invertedParabola((o-t)/i));("outro"===r||"both"===r)&&a-i<o&&o<=a&&(s=MK.invertedParabola((o-(a-i))/i,!1));return Math.max(Math.min(s,1),0)})({current:s,end:i,fadePosition:d,fadeSpeed:c,start:r});e?this.video&&(this.video.volume=n*t):this.gainNode&&this.audioContext&&this.gainNode.gain.setValueAtTime(n*t,this.audioContext.currentTime)}}})),a(this,"initStaticVideo",(()=>{const{staticVideo:e}=this,{layer:t}=this.props;if(e&&e.videoHeight&&e.videoWidth&&this.setIntermediateCanvasWidth(e.videoWidth,e.videoHeight),!t.duration&&e){const a=parseFloat(e.duration);px({[t.id]:{duration:a}})}})),a(this,"setLoading",(()=>{this.setState({loading:!0})})),a(this,"stopLoading",(()=>{this.setState({loading:!1})})),a(this,"handleAudiogramPlayError",(e=>{const{layer:t}=this.props;t.isAudiogram&&"pastedLink"===t.source&&e&&e.catch((()=>{this.audiogramErrorToastShown||(this.audiogramErrorToastShown=!0,this.props.showToast({description:"Failed to draw waveform using pasted URL. Please wait for asset to download.",type:"warning"}))}))})),a(this,"handleError",(async e=>{var t;const{layer:a,mediaCacheId:o}=this.props,{retries:n}=this.state,{code:r,message:i}=(e.target||{}).error||e;if(this.loadError=!0,e.target&&console.info(`Failed to load video. Error ${r} details: ${i}`),n>=5)return;this.sendErrorAmplitudeEvent(e.target,r,i);const s=null==(t=null==a?void 0:a.preview)?void 0:t.asset_id;let l=s||a.asset_id;if(l){this.setState({retries:n+1});let e=null;try{e=await GG(l,"Video_handleError_preview")}catch(YEe){if(l===s&&a.asset_id){l=a.asset_id;try{e=await GG(l,"Video_handleError_original")}catch(d){console.error(`Failed to fetch asset_id ${l} on layer.id ${a.id}`)}}else console.error(`Failed to fetch asset_id ${l} on layer.id ${a.id}`)}if(e){const{blob_name:t,status:n}=e;if(n===ri.uploaded&&t){const t=await hY(e);if(this.setState({videoSrc:t,isAssetInIDB:!1,assetRefetched:!0}),o&&CH(o),!s)return void px({[a.id]:{url:t,soundUrl:null,source:"upload"}});px({[a.id]:{preview:{...a.preview,url:t},soundUrl:null,source:"upload"}})}}}"pastedLink"===a.source&&(async()=>{this.setState({retries:n+1});const e=await _F(a.pastedUrl);px({[a.id]:{soundUrl:null,url:e.url}})})()})),a(this,"initVideo",(()=>{const{video:e}=this,{layer:t,studioPaused:a,studioTime:o,globalPlaybackRate:n}=this.props;if((null==e?void 0:e.getAttribute("data-initVideoLayerId"))!==t.id)if(null==e||e.setAttribute("data-initVideoLayerId",t.id),e&&e.videoHeight&&e.videoWidth?(e.width=e.videoWidth,e.height=e.videoHeight,this.setIntermediateCanvasWidth(e.videoWidth,e.videoHeight),setTimeout((()=>{this.videoLoaded=!0,(t.removeBg||t.blurBg||t.chromaKey)&&(a?this.drawPausedFrameToCanvas():this.drawVideoToCanvas())}),100)):"audio"===t.type&&setTimeout((()=>{this.videoLoaded=!0}),100),e){if(e.loop=!!t.converted_gif,e.muted=!!t.isMuted,e.playsInline=!0,e.playbackRate=n,t.playbackRate&&(e.playbackRate*=t.playbackRate),a&&e.pause(),!t.duration||t.duration<0){const a=parseFloat(e.duration);px({[t.id]:{duration:a}})}t.isTrimmed||(KT(t.id,{removeBgPreviewUrl:null}),px({[t.id]:{endTime:e.duration,startTime:0}})),t.isReversed?(e.pause(),OK(t,e,o,this.reverseAudio)):e.currentTime=t.startTime||0,t.removeBg||t.blurBg||this.stopLoading()}else console.warn(`Video.tsx initVideo - No video for ${t.id}!`)})),a(this,"setIntermediateCanvasWidth",((e,t)=>{let a,o;e>t?(a=Math.min(e,720),o=t*(a/e)):(o=Math.min(t,720),a=e*(o/t)),this.setState({intermediateCanvasWidth:a,intermediateCanvasHeight:o})})),a(this,"getSizeStyles",(()=>{if(this.props.layer.isAudiogram)return{display:"none"};if(this.isAudioOnly())return{display:"none"};const e=this.getVideoWidthAndHeight(),{width:t,height:a}=LK([this.props.width,this.props.height],e);return{width:`${t}px`,height:`${a}px`}})),a(this,"initAnalyser",(()=>{if(!this.audioContext)return;const e=this.audioContext.createAnalyser();e.minDecibels=-120,this.gainNode&&this.gainNode.connect(e),this.analyser=e})),a(this,"initReverseAudio",(async()=>{var e,t,a,o,n;if(!this.audioContext)return;const{mediaCacheId:r,globalPlaybackRate:i}=this.props,{playbackRate:s}=this.props.layer;if(!this.reverseAudio||!r)return;const l=await NH(r);if(!l)return;const{reversedAudioBlob:d}=l;if(d)this.reverseAudio.src=URL.createObjectURL(d);else{const{layer:i}=this.props,s=await(null==(n=(null==(e=l.trackOptimizedPreviewFile_v2)?void 0:e.hasAudio)&&(null==(t=l.trackOptimizedPreviewFile_v2)?void 0:t.file)||(null==(a=l.optimizedPreviewFile_v2)?void 0:a.file)||(null==(o=l.file_v2)?void 0:o.file))?void 0:n.arrayBuffer());if(!s)return;const d=await eY(this.audioContext,s);window.webWorkerDict||(window.webWorkerDict={}),window.webWorkerDict[i.id]=new uY;const{webWorkerDict:c}=window;let m=null;if(c&&(m=c[i.id]||null),m)try{const{numberOfChannels:e,sampleRate:t,length:a}=d,o={};for(let r=0;r<e;r+=1)o[r]=d.getChannelData(r);const n={mapChannelToChannelData:o,numberOfChannels:e,sampleRate:t,length:a};m.postMessage(n);const i=await new Promise((e=>{m.onmessage=t=>{e(t.data)}})),{wav:s}=i;await xH(r,{reversedAudioBlob:s}),this.reverseAudio.src=URL.createObjectURL(s),m.terminate()}catch(u){return}}this.reverseAudio.playbackRate=i*(s||1),this.reverseAudio.crossOrigin="anonymous";const c=this.reverseAudioSource||this.audioContext.createMediaElementSource(this.reverseAudio);this.reverseAudioSource||(this.reverseAudioSource=c),this.reverseAudioSource.connect(this.gainNode)})),a(this,"openReverseVideoInterval",(()=>{this.reversedIntervalID||(this.reversedIntervalID=window.setInterval(this.updateReversedVideoTime,100))})),a(this,"closeReverseVideoInterval",(()=>{this.reversedIntervalID&&(clearInterval(this.reversedIntervalID),this.reversedIntervalID=null)})),a(this,"getVideoRef",(()=>this.video)),a(this,"startCanvasVideo",(async()=>{await this.initCanvasVideo(),this.staticVideo&&this.drawPreviewToCanvas()})),a(this,"initCanvasVideo",(async()=>{const{layer:e,staticPreview:t}=this.props;this.setLoading(),(e.removeBg||e.blurBg)&&($Y||(window.bodyPixNet||(window.bodyPixNet=await(await qY).load({}),"cpu"===(await YY).getBackend()&&(window.slowTFJS=!0,window.bodyPixNet=await(await qY).load({architecture:"ResNet50"}))),t||this.drawSelfieSegmentationImage())),e.chromaKey&&window.Worker&&(window.ckWebWorkerDict||(window.ckWebWorkerDict={}),window.ckWebWorkerDict[e.id]||(window.ckWebWorkerDict[e.id]=new cY),window.ckStaticWorkerDict||(window.ckStaticWorkerDict={}),window.ckStaticWorkerDict[e.id]||(window.ckStaticWorkerDict[e.id]=new cY)),!t&&(e.removeBg||e.blurBg||e.chromaKey)&&(this.previousDrawingTime=performance.now(),this.drawVideoToCanvas(performance.now()))})),a(this,"bodyPixRemoveBackground",(async e=>{const t=window.slowTFJS?"low":"medium",a=await window.bodyPixNet.segmentPerson(e,{flipHorizontal:!1,internalResolution:t,segmentationThreshold:.7}),o=e.data;for(let n=0;n<o.length;n+=4)0===a.data[n/4]&&(o[n+3]=0)})),a(this,"drawUrlToCanvas",(e=>{const{layer:t}=this.props;if(!this.canvas)return;const a=this.canvas.getContext("2d");if(!a)return;a.imageSmoothingEnabled=!0;const{width:o,height:n}=this.canvas;a.clearRect(0,0,o,n);const r=new Image;r.onload=()=>{a.drawImage(r,0,0,o,n),t.presetFilter&&this.filterCanvas&&this.drawPresetFilter()},r.src=e})),a(this,"drawToIntermediateCanvas",((e,t,a=!0)=>{if(!t||!e)return!1;const{width:o,height:n}=t;if(o<0||n<0)return!1;const r=t.getContext("2d");if(!r)return!1;if(r.drawImage(e,0,0,o,n),!a)return null;try{return r.getImageData(0,0,o,n)}catch(YEe){return console.error("CANVAS ERROR",YEe),null}})),a(this,"drawIntermediateDataToCanvas",((e,t,a=!0)=>{if(!t||!this.canvas)return;const{layer:o}=this.props,{width:n,height:r}=t,i=t.getContext("2d");if(!i)return;const s=this.canvas.getContext("2d");if(!s)return;s.imageSmoothingEnabled=!0;const{width:l,height:d}=this.canvas;try{i.putImageData(e,0,0),s.clearRect(0,0,l,d),s.drawImage(t,0,0,n,r,0,0,l,d),a&&o.presetFilter&&this.filterCanvas&&this.drawPresetFilter()}catch(YEe){console.error("CANVAS ERROR",YEe)}})),a(this,"drawSelfieSegmentationImage",(async()=>{if(!this.video||0===this.video.videoWidth||0===this.video.videoHeight)return;const{loading:e,selfieSegmentationLoaded:t}=this.state,{layer:a}=this.props,o=!!a.preview;if(($Y||!window.slowTFJS&&window.bodyPixNet)&&"failed"!==t){if(this.setupSelfieSegmentation(),$Y&&this.video&&this.videoLoaded&&"loaded"===t&&this.selfieSegmentation&&this.canvas&&this.video.videoWidth>0){try{let e=this.video;!o&&this.smallIntermediateCanvas&&this.smallIntermediateCanvas.width>0&&(this.drawToIntermediateCanvas(this.video,this.smallIntermediateCanvas,!1),e=this.smallIntermediateCanvas),await bi(1e3,this.selfieSegmentation.send({image:e}))}catch(YEe){console.error(YEe)}e&&this.stopLoading()}if(!$Y){const t=this.drawToIntermediateCanvas(this.video,this.smallIntermediateCanvas);t&&(await this.bodyPixRemoveBackground(t),this.canvas&&this.drawIntermediateDataToCanvas(t,this.smallIntermediateCanvas),e&&this.stopLoading())}}else if(this.canvas){const e=this.canvas.getContext("2d");if(!e)return;const{width:t,height:a}=this.canvas;e.drawImage(this.video,0,0,t,a)}})),a(this,"setRemoveBgPreviewUrl",(async e=>{const{layer:t,layerTempValues:a}=this.props,{removeBgPreviewUrl:o}=a[t.id]||{};if(!o&&"pastedLink"!==t.source){const a=await new Promise((t=>e.toBlob(t))),o=URL.createObjectURL(a);KT(t.id,{removeBgPreviewUrl:o})}})),a(this,"drawRemoveBgPreview",(async()=>{const{layer:e,layerTempValues:t}=this.props,{removeBgPreviewUrl:a}=t[e.id]||{};if(a)return void this.drawUrlToCanvas(a);if(this.canvas){const e=this.canvas.getContext("2d"),{width:t,height:a}=this.canvas;null==e||e.drawImage(this.staticVideo,0,0,t,a)}const o=this.drawToIntermediateCanvas(this.staticVideo,this.smallIntermediateCanvas);if(o){if(await this.bodyPixRemoveBackground(o),this.canvas){if(this.drawIntermediateDataToCanvas(o,this.smallIntermediateCanvas,!1),"pastedLink"!==e.source){const t=await new Promise((e=>this.canvas.toBlob(e))),a=URL.createObjectURL(t);KT(e.id,{removeBgPreviewUrl:a})}e.presetFilter&&this.filterCanvas&&this.drawPresetFilter()}}else setTimeout(this.drawRemoveBgPreview,100)})),a(this,"rgbToHsv",((e,t,a)=>{const o=e/255,n=t/255,r=a/255,i=Math.min(o,n,r),s=Math.max(o,n,r),l=s-i;let d=0;0===l?d=0:(s===o&&(d=(n-r)/l*60),s===n&&(d=60*(2+(r-o)/l)),s===r&&(d=60*(4+(o-n)/l)));return{H:d,S:0===s?0:l/s,V:s}})),a(this,"chromaKeyOut",((e,t,a,o)=>{const{layer:n,layerTempValues:r}=this.props,{chromaKeyThresholdTemp:i,chromaKeyHueTldTemp:s,chromaKeySatTldTemp:l,chromaKeyValTldTemp:d}=r[n.id]||{},c=i||n.chromaKeyThreshold,u=s||n.chromaKeyHueThreshold,m=l||n.chromaKeySatThreshold,p=d||n.chromaKeyValThreshold;if("colorKey"===n.chromaKeyChannel){const{H:n,S:r,V:i}=this.rgbToHsv(e,t,a);return!(Math.abs(o.H-n)>=u)&&(!(Math.abs(o.S-r)>=m)&&!(Math.abs(o.V-i)>=p))}const h="green"===n.chromaKeyChannel?t:a,g="green"===n.chromaKeyChannel?[e,a]:[e,t],y=Math.max(e,t,a);if(y!==h)return!1;return y-Math.max(...g)>255-c})),a(this,"drawChromaKeyImage",(async e=>{if(!e)return;const{layer:t,staticPreview:a,studioPaused:o,layerTempValues:n}=this.props,{chromaKeyThreshold:r,chromaKeyHueThreshold:i,chromaKeySatThreshold:s,chromaKeyValThreshold:l,chromaKeyChannel:d,chromaKeyColor:c,ffprobeData:u}=t,{loading:m}=this.state,{chromaKeyThresholdTemp:p,chromaKeyHueTldTemp:h,chromaKeySatTldTemp:g,chromaKeyValTldTemp:y}=n[t.id]||{};if("colorKey"===d&&c===lp){if(this.canvas){const t=this.canvas.getContext("2d");if(!t)return;const{width:a,height:o}=this.canvas;t.drawImage(e,0,0,a,o)}return}let f;if("colorKey"===d&&c){const e=parseInt(t.chromaKeyColor.slice(1,3),16),a=parseInt(t.chromaKeyColor.slice(3,5),16),o=parseInt(t.chromaKeyColor.slice(5,7),16);f=this.rgbToHsv(e,o,a)}const E={key:f,threshold:p||r,hueThreshold:h||i,satThreshold:g||s,valThreshold:y||l,channel:d};if(this.webGLCanvas){const a=this.webGLCanvas.getContext("webgl",{premultipliedAlpha:!1})||this.webGLCanvas.getContext("experimental-webgl",{premultipliedAlpha:!1});if(a){let n=e;const r=!u||!u.rotate;let i=r?0:parseFloat(u.rotate);if(this.fullIntermediateCanvas&&(Rl()||o||r)&&(this.drawToIntermediateCanvas(e,this.fullIntermediateCanvas),n=this.fullIntermediateCanvas,i=0),NK(a,n,E,i),this.canvas){const e=this.canvas.getContext("2d");if(!e)return;e.imageSmoothingEnabled=!0;const{width:a,height:o}=this.canvas;e.clearRect(0,0,a,o),e.drawImage(this.webGLCanvas,0,0,a,o),t.presetFilter&&this.filterCanvas&&this.drawPresetFilter()}return}}if(this.canvas){let o=this.drawToIntermediateCanvas(e,this.fullIntermediateCanvas);if(!o)return;let n=null;const r=a?window.ckStaticWorkerDict:window.ckWebWorkerDict;if(r&&(n=r[t.id]||null),n){const e={...E,pixels:o};try{n.postMessage(e);if(o=(await new Promise((e=>{n.onmessage=t=>{e(t.data)}}))).pixels,!o)return}catch(v){return}}else{const e=o.data;for(let t=0;t<e.length;t+=4)this.chromaKeyOut(e[t],e[t+1],e[t+2],f)&&(e[t+3]=0)}this.drawIntermediateDataToCanvas(o,this.fullIntermediateCanvas)}m&&this.stopLoading()})),a(this,"drawPreviewToCanvas",(async()=>{const{layer:e}=this.props,{removeBg:t,blurBg:a,chromaKey:o}=e;if(this.mounted&&this.canvas&&this.staticVideo)if(t||a)await this.drawRemoveBgPreview();else if(o)await this.drawChromaKeyImage(this.staticVideo);else{const e=this.canvas.getContext("2d");if(!e)return;e.drawImage(this.staticVideo,0,0,this.canvas.width,this.canvas.height)}})),a(this,"drawPausedFrameToCanvas",(async()=>{const{layer:e}=this.props,{removeBg:t,blurBg:a,chromaKey:o}=e;if(this.videoLoaded&&this.canvas&&this.video)if(t||a)await this.drawSelfieSegmentationImage();else if(o)await this.drawChromaKeyImage(this.video);else{const t=this.canvas.getContext("2d");if(!t)return;t.drawImage(this.video,0,0,this.canvas.width,this.canvas.height),this.couldBeTransparent()&&e.presetFilter&&this.filterCanvas&&this.drawPresetFilter()}})),a(this,"onMediapipeSegmentResults",(e=>{this.mediapipeSegmentResults=e,this.drawMediapipeResults()})),a(this,"drawMediapipeResults",(()=>{if(!this.mediapipeSegmentResults)return;const{canvas:e}=this,t=null==e?void 0:e.getContext("2d");if(!e||!t)return;const{layer:a}=this.props;if(a.blurBg){const a=document.createElement("canvas");a.width=e.width,a.height=e.height;const o=a.getContext("2d");a&&o&&KY?(this.drawBlurredBackgroundToCanvas(t),this.drawPortraitToCanvas(o),t.drawImage(a,0,0)):t.drawImage(this.mediapipeSegmentResults.image,0,0,e.width,e.height)}else this.drawPortraitToCanvas(t);this.setRemoveBgPreviewUrl(e)})),a(this,"drawBlurredBackgroundToCanvas",(e=>{if(!this.mediapipeSegmentResults||!e)return;const{layer:t,layerTempValues:a}=this.props,{blurBgValueTemp:o}=a[t.id]||{},n=null!=o?o:t.blurBgValue;if(null==n)return;const r=e.canvas.width,i=e.canvas.height;e.save(),e.clearRect(0,0,r,i);const s=Math.min(r,i);this.currentProcessedBlurValue=n;const l=n*s/100,[d,c]=pY({blurPixels:l,image:this.mediapipeSegmentResults.image,width:r,height:i});e.filter=`blur(${l}px)`,e.drawImage(d,-c,-c,d.width,d.height),e.globalCompositeOperation="destination-out",e.restore()})),a(this,"drawPortraitToCanvas",(e=>{if(!this.mediapipeSegmentResults||!e)return;const t=e.canvas.width,a=e.canvas.height;e.save(),e.clearRect(0,0,t,a),e.drawImage(this.mediapipeSegmentResults.image,0,0,t,a),e.globalCompositeOperation="destination-in",e.drawImage(this.mediapipeSegmentResults.segmentationMask,0,0,t,a),e.restore()})),a(this,"drawVideoToCanvas",(async e=>{const{layer:t,studioPaused:a}=this.props,{removeBg:o,blurBg:n,chromaKey:r}=t;if(!this.mounted)return;const i="number"==typeof e&&"number"==typeof this.previousDrawingTime?e-this.previousDrawingTime:null,s=1e3/24;if(null!==i&&(i>s||"requestVideoFrameCallback"in HTMLVideoElement.prototype)&&(this.previousDrawingTime=e-i%s,this.videoLoaded&&this.canvas&&this.video)){const{canvas:e}=this,a=e.getContext("2d");if(!a)return;"video/webm"!==t.mime&&"video/quicktime"!==t.mime||o||n||a.clearRect(0,0,e.width,e.height),o||n?await this.drawSelfieSegmentationImage():r?await this.drawChromaKeyImage(this.video):(a.drawImage(this.video,0,0,this.canvas.width,this.canvas.height),this.couldBeTransparent()&&t.presetFilter&&this.filterCanvas&&this.drawPresetFilter()),this.props.isLayerMountedValueInStudioLocal||xT(t.id,!0)}XY(this.props.absoluteTimes,this.props.studioTime)&&!a&&window.requestAnimationFrame(this.drawVideoToCanvas)})),a(this,"canvasRef",(e=>{this.canvas=e,KT(this.props.layer.id,{layerRef:e})})),a(this,"setVideoAttributes",(e=>{const t=Object.entries(this.getSizeStyles()).map((([e,t])=>`${e}: ${t};`)).join("");e.setAttribute("style",t),e.getAttribute("data-hasSetAttributes")||(e.className=`${jj.video} ${jj.disableselect}`,e.draggable=!1,"pastedLink"!==this.props.layer.source?e.crossOrigin="anonymous":e.crossOrigin=null,e.onloadstart=e=>{this.didLogVideoAnalytics||(this.onLoadStartTime=e.timeStamp)},e.onloadedmetadata=e=>{this.didLogVideoAnalytics||(this.onLoadedMetadataTime=e.timeStamp)},e.onloadeddata=e=>{this.didLogVideoAnalytics||(this.onLoadedDataTime=e.timeStamp)},e.oncanplay=e=>{void 0===this.props.layer.hasAudio&&this.checkHasAudio(),this.didLogVideoAnalytics||(this.onCanPlayTime=e.timeStamp)},e.oncanplaythrough=t=>{var a,o,n,r,i;if(this.didLogVideoAnalytics)return;if(Math.random()>.002&&!this.logFileExperiment)return;if(this.props.layer.requireConversion||this.props.layer.removeBg||this.props.layer.blurBg||this.props.layer.chromaKey)return;vc("VideoTagLoad",{eventVersion:3,onLoadedMetadata:s.exports.round((this.onLoadedMetadataTime-this.onLoadStartTime)/1e3,1),onLoadedData:s.exports.round((this.onLoadedDataTime-this.onLoadStartTime)/1e3,1),onCanPlay:s.exports.round((this.onCanPlayTime-this.onLoadStartTime)/1e3,1),onCanPlayThrough:s.exports.round((t.timeStamp-this.onLoadStartTime)/1e3,1),videoHeight:e.videoHeight,videoWidth:e.videoWidth,duration:e.duration,fileSource:this.logFileSource,fileType:this.logFileType,size:s.exports.round(this.logFileSize/1048576,1),deviceMemory:navigator.deviceMemory,mountToCanPlayThrough:s.exports.round((performance.now()-this.mountTime)/1e3,1),numberOfVideoElementsInDocument:document.getElementsByTagName("video").length,experimentName:null==(a=this.logFileExperiment)?void 0:a.name,experimentTimeToInit:null==(o=this.logFileExperiment)?void 0:o.timeToInit,experimentTimeToTranscode:null==(n=this.logFileExperiment)?void 0:n.timeToTranscode,experimentStatus:null==(r=this.logFileExperiment)?void 0:r.status,error:null==(i=this.logFileExperiment)?void 0:i.error}),this.didLogVideoAnalytics=!0},e.setAttribute("data-hasSetAttributes","true"))})),a(this,"setAudioContext",(()=>{const{layer:e}=this.props,{id:t}=e,a=this.props.canvasElementPool,o=a.domElementByLayerId.get(t);if(!o)return;const n=o.id;(this.audioContext||this.source||this.gainNode)&&this.isEPGainNodeConsistent(n)||(this.audioContext=a.audioContextByDomId.get(n)||null,this.source=a.sourceNodeByDomId.get(n)||null,this.gainNode=a.gainNodeByDomId.get(n)||null,this.audioContext&&this.audioContext.resume())})),a(this,"isEPGainNodeConsistent",(e=>{const{canvasElementPool:t}=this.props,a=t.gainNodeByDomId.get(e);return this.gainNode===a})),a(this,"videoRef",(e=>{this.video=e,e&&(e.readyState>0?this.initVideo():e.onloadedmetadata=this.initVideo,this.mountVideo(e)),KT(this.props.layer.id,{layerRef:e})})),a(this,"mountVideo",(async e=>{const{forMovingZoomControls:t,layer:a,studioPaused:o}=this.props;if(this.setVideoAttributes(e),this.container.current&&!this.container.current.contains(e)){e.parentNode&&e.parentNode.removeChild(e);const n=t?"[data-cy=filter-layer-style-wrapper]":"[data-cy=filter-layer-style-wrapper] [data-cy=filter-style-wrapper]",r=this.container.current.querySelector(n);if(r)for(const e of r.children)"VIDEO"===e.tagName&&r.removeChild(e);null==r||r.appendChild(e);const{startTime:i=0}=a;if(!jT(e.currentTime,i,.03333333333333333)){const t=new Promise((t=>{e.addEventListener("seeked",t),e.addEventListener("error",t)}));e.currentTime=i;try{await bi(5e3,t),this.handleDriftingVideo()}catch(YEe){console.error(YEe)}}a.type!==ln.Video||a.blurBg||a.chromaKey||a.removeBg||o||e.addEventListener("playing",(function(){xT(a.id,!0)}),{once:!0})}})),a(this,"renderConversion",(()=>{const{isRemoteUploadingLayer:e,viewOnly:t,layer:a}=this.props;return!a.requireConversion||a.preview||"complete"===a.videoConvertedState||t||e?null:i.createElement("div",{className:jj.videoConversion},i.createElement(CO,{textStyles:{color:"white",fontWeight:600,fontSize:"12px",fontFamily:"Open Sans, sans-serif"},text:this.getConversionText()}))})),a(this,"renderLoading",(()=>{const{loading:e}=this.state,{viewOnly:t,layer:a,hasBeenPlayable:o,isRemoteUploadingLayer:n}=this.props;return e?t||o||a.requireConversion&&!a.preview||n?null:i.createElement("div",{style:{position:"absolute",textAlign:"center",top:10,width:"100%"}},i.createElement(CO,{text:""})):null})),a(this,"renderVideo",(()=>{const{staticPreview:e,layer:t,width:a,height:o,x:n,y:r,background:s,trackIsBeingManipulated:l,tempFilters:d}=this.props,c=this.getVideoWidthAndHeight(),u=jI(this.props.layer,this.props.studioTime,l),m=RK(u,[this.props.width,this.props.height],c,kI(t)),{width:p,height:h}=LK([this.props.width,this.props.height],c),g=fK(m,p,h),y=PK({...t,filters:d||t.filters},!!e,!!this.props.multiScene,g,this.props.width,this.props.height,this.props.keyframeChannels,this.props.studioTime),f="none"===y.display;if(y.display="hidden",e){const{removeBg:e,blurBg:l,chromaKey:d}=t,c=e||l||d;return c&&(y.display="hidden"),i.createElement(i.Fragment,null,c&&this.renderCanvasVideo(),t.isAudiogram&&i.createElement(yY,{width:a,height:o,x:n,y:r,background:s}),i.createElement(gY,{layer:t,style:y},!c&&i.createElement("video",{id:"staticvideo",className:jj.video,ref:e=>{this.staticVideo=e},style:this.getSizeStyles(),src:this.getVideoSrc(),draggable:!1,muted:!0,autoPlay:!0,onLoadStart:e=>{e.target.pause()},onPlaying:e=>{e.target.pause()},playsInline:!0,..."pastedLink"!==t.source&&{crossOrigin:"anonymous"}})))}return t.removeBg||t.blurBg||t.chromaKey||f?y.display="none":y.display="block",this.props.forMovingZoomControls?i.createElement("div",{style:y,"data-cy":"filter-layer-style-wrapper"}):i.createElement(i.Fragment,null,(t.removeBg||t.blurBg||t.chromaKey)&&this.renderCanvasVideo(),t.isAudiogram&&i.createElement(_Y,{layer:t,width:a,height:o,video:this.getVideoRef(),analyser:this.analyser}),t.isReversed&&i.createElement("audio",{ref:e=>{this.reverseAudio=e}}),i.createElement(gY,{layer:t,style:y}))})),this.state={retries:0,loading:!0,videoSrc:"",videoSrcAtMount:"",sourceAtMount:(null==(t=e.layer)?void 0:t.source)||"",selfieSegmentationLoaded:"not_loaded"},this.videoDriftCounter=i.createRef(),this.videoDriftInterval=window.setInterval((()=>{this.videoDriftCounter.current=(this.videoDriftCounter.current||0)+1}),1e3)}async componentDidMount(){const{layer:e}=this.props;this.didLogVideoAnalytics=!1,this.mountTime=performance.now(),e.local_url||this.setVideoSrc(!0),this.mounted=!0,await this.setupVideo(),e.isReversed&&e.hasAudio&&this.initReverseAudio()}async componentDidUpdate(e,t){var a,o,n,r,i,s,l,d;const{absoluteTimes:c,userManualSeek:u,draggedTracksOverrides:m,layer:p,layerTempValues:h,possibleReferenceLayers:g,staticPreview:y,studioPaused:f,studioTime:E,updateLayerAnimationPosition:v,globalPlaybackRate:w,isWaitingForNextEPLayer:b}=this.props,_=XY(e.absoluteTimes,e.studioTime),T=this.props.canvasElementPool.layerByLayerId.get(this.props.layer.id),S=XY(c,E)||(null==T?void 0:T.isAtEnd)&&jT(E,c[1],.03333333333333333);let I=this.props.canvasElementPool.domElementByLayerId.get(this.props.layer.id)||null;this.props.forMovingZoomControls?this.video||(I=document.createElement("video"),I.src=this.props.layer.local_url||(null==(o=null==(a=this.props.layer)?void 0:a.preview)?void 0:o.url)||this.props.layer.url||"",this.videoRef(I)):(!S||y||this.video&&!this.isVideoRefOutdated(I)||(this.videoRef(I),this.setAudioContext(),p.isAudiogram&&this.initAnalyser()),S&&!y&&I&&this.container.current&&!this.container.current.contains(I)&&this.mountVideo(I),this.video&&this.setVideoAttributes(this.video),S||b||!this.video||(this.videoRef(null),xT(p.id,!1)));const{videoSrc:x}=this.state,k=e.layer.hasAudio;t.videoSrc===x&&k===p.hasAudio||this.setupVideo(),this.audioContext||e.layer.isAudiogram||!p.isAudiogram||(this.setAudioContext(),this.initAnalyser()),!e.layer.isAudiogram&&p.isAudiogram&&this.audioContext&&!this.analyser&&this.initAnalyser(),this.video&&(null==(n=e.layer)?void 0:n.isReversed)!==p.isReversed&&(this.closeReverseVideoInterval(),p.isReversed?(this.video.pause(),this.initReverseAudio(),OK(p,this.video,E,this.reverseAudio)):OK(p,this.video,E));const C=!!(null==m?void 0:m[p.id]),A=!!(null==(r=e.draggedTracksOverrides)?void 0:r[p.id]);!this.video||C||A||S||!_||(this.video.pause(),this.closeSetStudioTimeInterval(),p.isReversed&&OK(p,this.video,E),this.reverseAudio&&(this.reverseAudio.pause(),this.reverseAudio.currentTime=p.startTime||0));if(VT(c,E,g)&&S?this.openSetStudioTimeInterval():this.closeSetStudioTimeInterval(),this.video&&this.reverseAudio&&p.isReversed&&S&&!_&&(this.reverseAudio&&this.reverseAudio.paused&&this.reverseAudio.play(),this.drawVideoToCanvas(),OK(p,this.video,E,this.reverseAudio),f||this.openReverseVideoInterval()),e.studioPaused&&!f&&this.audioContext&&this.audioContext.resume(),null!==u&&p.isReversed&&!S&&this.closeReverseVideoInterval(),this.video&&!y){this.video.playbackRate=w,p.playbackRate&&(this.video.playbackRate*=p.playbackRate,this.reverseAudio&&(this.reverseAudio.playbackRate=w*p.playbackRate)),this.video.muted=!!p.isMuted,this.setVolume();const[a,o]=c;if(a<=E&&E<=o||C){if(null!==u){this.videoDriftCounter.current=0,await OK(p,this.video,ST(),this.reverseAudio);p.removeBg||p.blurBg||p.chromaKey?f?this.drawPausedFrameToCanvas().then((()=>{xT(p.id,!0)})):(p.isReversed&&(this.openReverseVideoInterval(),this.reverseAudio&&this.reverseAudio.paused&&this.reverseAudio.play()),this.drawVideoToCanvas()):xT(p.id,!0)}else E<e.studioTime-.5?(this.videoDriftCounter.current=0,await OK(p,this.video,E,this.reverseAudio)):this.videoDriftCounter.current&&this.videoDriftCounter.current>5&&this.handleDriftingVideo();if(!p.isReversed&&!f&&(null==(i=this.video)?void 0:i.paused)){const e=jT(p.startTime||0,0,.1)&&jT(E,a,.1);if(this.video.currentTime===this.video.duration&&!e)return;const t=null==(s=this.video)?void 0:s.play();this.handleAudiogramPlayError(t),(p.chromaKey||p.removeBg||p.blurBg)&&this.drawVideoToCanvas()}p.isReversed&&f!==e.studioPaused&&!f&&(this.openReverseVideoInterval(),this.reverseAudio&&this.reverseAudio.paused&&this.reverseAudio.play(),this.drawVideoToCanvas()),!f||(null==(l=this.video)?void 0:l.paused)&&!p.isReversed||(p.isReversed?(this.closeReverseVideoInterval(),this.reverseAudio&&!this.reverseAudio.paused&&this.reverseAudio.pause()):null==(d=this.video)||d.pause()),f&&this.shouldDrawPausedFrameToCanvas(e,t)&&this.drawPausedFrameToCanvas()}else null!==u?OK(p,this.video,a,this.reverseAudio):this.video.paused||this.video.pause()}if("pastedLink"!==p.source){const e=tT(p);e!==x&&this.setState({videoSrc:e})}(p.removeBg&&!e.layer.removeBg||p.blurBg&&!e.layer.blurBg)&&this.startCanvasVideo(),this.staticVideo&&(this.staticVideo.onloadedmetadata=this.initStaticVideo,this.shouldDrawPreviewToCanvas(e)&&this.drawPreviewToCanvas()),this.mounted&&this.setVideoSrc();const N=w_(p),{introTransition:P,outroTransition:R}=T_(p);if(y||"none"===(null==N?void 0:N.id)&&!P&&!R)v&&v(null);else if(N.layerInvolvesMovement){const e=Bj(p,"");v&&v(e)}const{blurBgValueTemp:L}=h[p.id]||{},D=null!=L?L:p.blurBgValue;this.mediapipeSegmentResults&&D!==this.currentProcessedBlurValue&&this.drawMediapipeResults()}async componentWillUnmount(){this.mounted=!1,this.closeReverseVideoInterval(),this.initializingSelfieSegmentation&&QY.initializingSelfieSegmentation&&(QY.initializingSelfieSegmentation=!1),this.video=null,clearInterval(this.videoDriftInterval),this.longLoadTimeout&&clearTimeout(this.longLoadTimeout),this.loopSetStudioTimeID&&clearTimeout(this.loopSetStudioTimeID)}getVideoWidthAndHeight(){let e=[0,0];return this.video?e=[this.video.videoWidth,this.video.videoHeight]:this.staticVideo&&(e=[this.staticVideo.videoWidth,this.staticVideo.videoHeight]),e}isVideoRefOutdated(e){var t;return(null==e?void 0:e.id)!==(null==(t=this.video)?void 0:t.id)}getVideoSrc(e=!1){const{videoSrc:t}=this.state,a=t;return a&&a.startsWith("blob:")&&e?"blob":a||""}getConversionText(){const{layer:e,uploadStatuses:t}=this.props,a=e.uploadId?null==t?void 0:t[e.uploadId]:null;return a?az(a):null}sendErrorAmplitudeEvent(e,t,a){var o,n,r,i,s,l;try{const{retries:d,sourceAtMount:c}=this.state,u=new URL(e.src),{layer:m,location:p}=this.props;if(0!==d)return;if(m.loadErrorFired)return;px({[m.id]:{loadErrorFired:!0}});const h=4===t&&(u.hostname.includes("googlevideo")||u.hostname.includes("youtube")),g=this.getNumVideoLayers();if(Math.random()>.25)return;vc("Video Element Error",{url:u.toString(),pathname:p.pathname,numVideoLayers:g,code:t,message:a,suspectedYoutubeCORSError:h,source:m&&m.source||"",sourceAtMount:c,mime:m&&m.mime||"",asset_id:m&&m.asset_id||"",optimized_asset_id:(null==(o=null==m?void 0:m.preview)?void 0:o.asset_id)||"",experimentName:null==(n=this.logFileExperiment)?void 0:n.name,experimentTimeToInit:null==(r=this.logFileExperiment)?void 0:r.timeToInit,experimentTimeToTranscode:null==(i=this.logFileExperiment)?void 0:i.timeToTranscode,experimentStatus:null==(s=this.logFileExperiment)?void 0:s.status,error:null==(l=this.logFileExperiment)?void 0:l.error})}catch(YEe){console.error(YEe)}}isAudioOnly(){const{layer:e}=this.props;return"audio"===e.type&&!e.isAudiogram}drawPresetFilter(){if(!this.canvas)return;const{layer:e}=this.props;if(!e.presetFilter||!this.filterCanvas)return;if("Original"===e.presetFilter.name)return;const t=this.canvas.getContext("2d");if(!t)return;const{width:a,height:o}=this.canvas,n=this.filterCanvas.getContext("2d");n&&(n.save(),n.clearRect(0,0,a,o),sK(e.presetFilter,n,this.canvas,this.canvas.width,this.canvas.height),n.restore(),t.save(),t.globalCompositeOperation="source-in",t.drawImage(this.filterCanvas,0,0,a,o),t.restore())}shouldDrawPreviewToCanvas(e){const{layer:t}=this.props;return t.chromaKey&&!e.layer.chromaKey||t.chromaKeyChannel!==e.layer.chromaKeyChannel||t.chromaKeyThreshold!==e.layer.chromaKeyThreshold||t.chromaKeyColor!==e.layer.chromaKeyColor||t.chromaKeyHueThreshold!==e.layer.chromaKeyHueThreshold||t.chromaKeySatThreshold!==e.layer.chromaKeySatThreshold||t.chromaKeyValThreshold!==e.layer.chromaKeyValThreshold||t.presetFilter!==e.layer.presetFilter}shouldDrawPausedFrameToCanvas(e,t){const{layer:a,layerTempValues:o}=this.props,{selfieSegmentationLoaded:n}=this.state,r=e.layerTempValues[e.layer.id]||{},{chromaKeyThresholdTemp:i,chromaKeyHueTldTemp:s,chromaKeySatTldTemp:l,chromaKeyValTldTemp:d}=o[a.id]||{};return a.chromaKey!==e.layer.chromaKey||a.removeBg!==e.layer.removeBg||a.blurBg!==e.layer.blurBg||n!==t.selfieSegmentationLoaded||i!==r.chromaKeyThresholdTemp||s!==r.chromaKeyHueTldTemp||l!==r.chromaKeySatTldTemp||d!==r.chromaKeyValTldTemp||this.shouldDrawPreviewToCanvas(e)}couldBeTransparent(){const{layer:e}=this.props;return e.chromaKey||e.removeBg||e.blurBg||"video/webm"===e.mime}handleDriftingVideo(){const{absoluteTimes:e,layer:t,possibleReferenceLayers:a,studioTime:o}=this.props,n=e[0],r=VT(e,o,a),i=XS();if(this.video){const e=this.video.currentTime-(t.startTime||0),a=this.props.studioTime-n;if((()=>{var t;if(null==(t=this.video)?void 0:t.paused)return!1;const o=1/30;return!(e>=a-o&&e<=a+o)})()&&r&&!i){YA(a+(e-a)/2+n)}this.videoDriftCounter.current=0}}renderCanvasVideo(){if(!this.video&&!this.staticVideo||this.isAudioOnly())return null;const{layer:e,trackIsBeingManipulated:t}=this.props,{videoWidth:a,videoHeight:o}=this.staticVideo||this.video||{},{intermediateCanvasWidth:n,intermediateCanvasHeight:r}=this.state,s=this.getVideoWidthAndHeight(),l=jI(this.props.layer,this.props.studioTime,t),d=RK(l,[this.props.width,this.props.height],s,kI(e)),{width:c,height:u}=LK([this.props.width,this.props.height],s),m=fK(d,c,u),p=PK({...this.props.layer,filters:this.props.tempFilters||this.props.layer.filters},!!this.props.staticPreview,!!this.props.multiScene,m,this.props.width,this.props.height,this.props.keyframeChannels,this.props.studioTime);return i.createElement(i.Fragment,null,i.createElement("div",{style:{display:"none"}},i.createElement("canvas",{ref:e=>{this.smallIntermediateCanvas=e},width:n,height:r})),i.createElement("div",{style:{display:"none"}},i.createElement("canvas",{ref:e=>{this.fullIntermediateCanvas=e},width:a,height:o})),i.createElement("div",{style:{display:"none"}},i.createElement("canvas",{ref:e=>{this.filterCanvas=e},width:a,height:o})),i.createElement("div",{style:{display:"none"}},i.createElement("canvas",{ref:e=>{this.webGLCanvas=e},width:a,height:o})),this.couldBeTransparent()||!e.presetFilter?i.createElement("canvas",{"data-cy":"ep-container",ref:this.canvasRef,style:p,width:a,height:o}):i.createElement(gY,{layer:e,style:p},i.createElement("canvas",{"data-cy":"ep-container",ref:this.canvasRef,width:a,height:o})))}render(){const{layer:{requireConversion:e,preview:t}}=this.props;return i.createElement("span",{ref:this.container},this.renderConversion(),this.renderLoading(),e&&!t?null:this.renderVideo())}};let ZY=QY;a(ZY,"initializingSelfieSegmentation",!1);const eq=m.exports.connect((()=>{const e=ZS();return(t,a)=>{var o,n,r,i;const s=Oj(a.layer.id),l=Lr(a.layer,t.mediaCache),d=a.layer.uploadId&&t.uploadStatuses&&!(a.layer.uploadId in t.uploadStatuses),c=JY(a.layer),[u,m]=c;let p=!1;JS(m,a.studioTime,t.studio.studioPaused)&&(p=e(t,m));const h=s(t);return{absoluteTimes:c,background:t.studio.scenes[0].background,userManualSeek:t.studioLocal.userManualSeek,draggedTracksOverrides:t.studioLocal.draggedTracksOverrides,globalPlaybackRate:null!=(o=t.studioLocal.playbackRate)?o:1,isRemoteUploadingLayer:d,layerTempValues:t.studioLocal.layerTempValues,borderRadiusTemp:null==(n=t.studioLocal.layerTempValues[a.layer.id])?void 0:n.borderRadiusTemp,mediaCacheId:l,possibleReferenceLayers:YS(t),scene:t.studio.scenes[0],scenes:t.studio.scenes,studioPaused:t.studio.studioPaused,trackIsBeingManipulated:gl(t,a.layer.id),uploadStatuses:t.uploadStatuses,hasBeenPlayable:!!(null==(r=t.studioLocal.layerTempValues[a.layer.id])?void 0:r.hasBeenPlayable),isWaitingForNextEPLayer:p,isLayerMountedValueInStudioLocal:t.studioLocal.isLayerMountedByLayerId[a.layer.id],keyframeChannels:h,tempFilters:null==(i=t.studioLocal.layerTempValues[a.layer.id])?void 0:i.filters}}}),(e=>me({playStudio:Y_,showToast:Su},e))),tq=(aq=TT(we(eq(ZY))),e=>i.createElement(HY.Consumer,null,(t=>i.createElement(aq,{...e,canvasElementPool:t}))));var aq;class oq extends r.exports.Component{constructor(){super(...arguments),a(this,"getRectStyles",(()=>{const{layer:e,width:t,height:a,canvasHeight:o,keyframeChannels:n,studioTime:r}=this.props,{lineWidth:i}=e,s=parseFloat(i)/100*o,l=$b(e,n,r),d=(null==n?void 0:n[Sn.OPACITY])?Kb(e,n,r).opacity/100:e.globalAlpha;return{width:t,height:a,x:s/2,y:s/2,fill:l,stroke:e.stroke,strokeWidth:s,opacity:d}}))}render(){const{layer:e,borderRadiusTemp:t,width:a,height:o}=this.props,n=JB(null!=t?t:null,e,a,o);return i.createElement("rect",{style:this.getRectStyles(),rx:n})}}const nq=m.exports.connect(((e,t)=>({keyframeChannels:Oj(t.layer.id)(e)})))(TT(oq));class rq extends r.exports.Component{constructor(){super(...arguments),a(this,"getEllipseStyles",(()=>{const{layer:e,width:t,height:a,canvasHeight:o,studioTime:n,keyframeChannels:r}=this.props,{lineWidth:i}=e,s=parseFloat(i)/100*o,l=$b(e,r,n),d=(null==r?void 0:r[Sn.OPACITY])?Kb(e,r,n).opacity/100:e.globalAlpha;return{cx:s/2+t/2,cy:s/2+a/2,rx:t/2,ry:a/2,fill:l,stroke:e.stroke,strokeWidth:s,opacity:d}}))}render(){return i.createElement("ellipse",{style:this.getEllipseStyles()})}}const iq=m.exports.connect(((e,t)=>({keyframeChannels:Oj(t.layer.id)(e)})))(TT(rq));class sq extends r.exports.Component{constructor(){super(...arguments),a(this,"getLineStyles",(()=>{const{layer:e,canvasHeight:t,keyframeChannels:a,studioTime:o}=this.props,{lineWidth:n}=e,r=parseFloat(n)/100*t,i=(null==a?void 0:a[Sn.OPACITY])?Kb(e,a,o).opacity/100:e.globalAlpha;return{stroke:e.stroke,strokeWidth:r,opacity:i,strokeLinecap:e.lineCap}})),a(this,"getLineMarkerEnd",(e=>{switch(e){case"open":return{path:"M0,0 L3,1.5 L0,3",fill:!1};case"closed":return{path:"M0,0 V3 L3,1.5 Z",fill:!0};default:return{path:"",fill:!1}}})),a(this,"getLineDashArray",((e,t)=>{switch(e){case"big dash":return[4*t,2*t];case"small dash":return[2*t];case"dotted":return[0,t+t/2];default:return[]}})),a(this,"handleSelectLayer",(()=>{const{selectedItem:e,layer:t,selectItem:a}=this.props;(null==e?void 0:e.id)!==t.id&&a({id:t.id,type:"layer"})}))}render(){const{width:e,height:t,layer:a,points:o,lineResizing:n,canvasHeight:r}=this.props,{id:s,stroke:l,lineCap:d,lineWidth:c,lineStyle:u,lineArrow:m,linePointStartCorner:p}=a,h=`markerEnd${s}`,g=m?`url(#${h})`:"",y=parseFloat(c)/100*r,f=this.getLineMarkerEnd(m),E=this.getLineDashArray(u,y),v={topLeft:[y,y,e,t],topRight:[e,y,y,t],bottomLeft:[y,t,e,y],bottomRight:[e,t,y,y]},[w,b,_,T]=v[p||"topLeft"];return i.createElement(i.Fragment,null,f.path&&i.createElement("defs",null,i.createElement("marker",{id:h,orient:"auto",markerWidth:"4",markerHeight:"8",refX:"3",refY:"1.5",style:{overflow:"visible"}},i.createElement("path",{d:f.path,stroke:l,strokeWidth:1,fill:f.fill?l:"none",strokeLinejoin:d,strokeLinecap:d,strokeDasharray:10}))),i.createElement("line",{x1:n?o[0]+y:w,y1:n?o[1]+y:b,x2:n?o[2]+y:_,y2:n?o[3]+y:T,style:this.getLineStyles(),strokeDasharray:E||"",markerEnd:g,className:jj.svgLine,onClick:this.handleSelectLayer}))}}const lq=m.exports.connect(((e,t)=>{const a=Oj(t.layer.id);return{selectedItem:e.studio.selectedItem,keyframeChannels:a(e)}}),(e=>me({selectItem:Kh},e)))(TT(sq)),dq=e=>{const t=r.exports.useMemo((()=>Oj(e)),[e]);return tr(t,m.exports.shallowEqual)},cq=(e,t,a)=>(null==e?void 0:e.type)&&"path"===e.type?i.createElement("path",{d:e.props.d,style:t,transform:a,key:e.props.d}):"circle"===(null==e?void 0:e.type)?i.createElement("circle",{cx:e.props.cx,cy:e.props.cy,r:e.props.r,pathLength:e.props.pathLength,style:t,transform:a}):null,uq=({layer:e,canvasHeight:t,position:{width:a,height:o}})=>{tr((e=>e.studio.containerWidth)),tr((e=>e.studio.containerHeight));const n=dq(e.id),r=_T(),s=()=>{var o;const{lineWidth:i}=e,s=parseFloat(i)/100*t,l=parseFloat(a)/((null==(o=null==e?void 0:e.position)?void 0:o.svg_width)||1),d=$b(e,n,r),c=(null==n?void 0:n[Sn.OPACITY])?Kb(e,n,r).opacity/100:e.globalAlpha;return{fill:d,stroke:e.stroke,strokeWidth:s/l,opacity:c}},l=()=>{var n,r;const{lineWidth:i}=e,s=parseFloat(i)/100*t,l=parseFloat(a)/((null==(n=null==e?void 0:e.position)?void 0:n.svg_width)||1),d=parseFloat(o)/((null==(r=null==e?void 0:e.position)?void 0:r.svg_height)||1),c=s/l/2,u=s/d/2;return`scale(${l},${d})${"line"!==e.shapeType?`,translate(${c},${u})`:""}`};return"string"==typeof e.svgData?i.createElement("path",{style:s(),d:e.svgData,transform:l()}):i.createElement(i.Fragment,null,e.svgChildren&&e.svgChildren.map((e=>cq(e,s(),l()))))};class mq extends r.exports.Component{constructor(){super(...arguments),a(this,"getProgressBarStyles",(()=>{const{layer:e,width:t,height:a,canvasHeight:o,staticPreview:n,layerScene:r,studioTime:i}=this.props,{progressBarStyle:s}=e;let l=i;if(e.startTime&&(l-=e.startTime),null==r)return{};let d=0;void 0!==e.startTime&&void 0!==e.endTime?d=e.endTime-e.startTime:r.duration&&(d=r.duration);const c=l/d;let u;n||(u=Bj(e));const m={};"solid"===s||"glowing"===s?m.background=e.background:"gradient"===s?m.background=`linear-gradient(to right, ${e.gradientStyleColor}, ${e.background})`:"background"===s&&(n?m.background=e.background:(u={},m.background=`linear-gradient(to right, ${e.background} 0% ${100*c}%, ${e.backgroundStyleColor} ${100*c}% 100%)`));const{lineWidth:p}=e,h=parseFloat(p)/100*o;return{width:t,height:a+h,...u,x:h/2,y:h/2,borderColor:e.stroke,borderStyle:"solid",borderWidth:h,opacity:e.globalAlpha,...m}})),a(this,"ProgressBar",(()=>i.createElement("div",{style:this.getProgressBarStyles()})))}componentDidMount(){const{layer:e,layerScene:t}=this.props;void 0!==(null==e?void 0:e.startTime)&&void 0!==(null==e?void 0:e.endTime)||px({[e.id]:{startTime:0,endTime:t.duration}})}render(){const{layer:e}=this.props,{progressBarStyle:t}=e;return"glowing"===t?i.createElement("div",{style:{filter:`drop-shadow(0px 0px 12px ${e.glowingStyleColor})`}},this.ProgressBar()):this.ProgressBar()}}const pq=TT(m.exports.connect((e=>{const{scenes:t}=e.studio;return{layerScene:t[0]}}))(mq)),hq=s.exports.memoize(zS);class gq extends r.exports.Component{constructor(){super(...arguments),a(this,"getStyles",(()=>{const{layer:e,staticPreview:t}=this.props,[a,o]=this.props.absoluteTimes,{studioTime:n}=this.props,r=!t&&!(a<=n&&n<=o),i={...this.getDivSize(),display:r?"none":"block"},s=w_(e);let l={};return t||"progress-bar"===(null==s?void 0:s.id)||(l=Bj(e,i.transform)),Vj(i,l)})),a(this,"getDivSize",(()=>{const{layer:e,x:t,y:a,width:o,height:n,rotation:r,canvasHeight:i}=this.props,{lineWidth:s}=e,l=parseFloat(s)/100*i/2;return{position:"absolute",left:t-l,top:a-l,width:o+2*l,height:n+2*l,transform:`rotate(${r}deg)`}})),a(this,"renderShapes",(()=>{const{layer:e}=this.props;return"progressBar"===e.shapeType?i.createElement("div",{className:jj.svgContainer},this.renderShape()):i.createElement("svg",{className:jj.svgContainer,height:"100%",width:"100%","data-cy":"shape"},this.renderShape())})),a(this,"renderShape",(()=>{const{layer:e,x:t,y:a,width:o,height:n,points:r,lineResizing:s,canvasHeight:l,staticPreview:d,borderRadiusTemp:c}=this.props,u={x:t,y:a,width:o,height:n};switch(e.shapeType){case"progressBar":return i.createElement(pq,{staticPreview:d,layer:e,width:o,height:n,canvasHeight:l});case"rectangle":return i.createElement(nq,{layer:e,width:o,height:n,canvasHeight:l,borderRadiusTemp:c});case"ellipse":return i.createElement(iq,{layer:e,width:o,height:n,canvasHeight:l});case"line":case"arrow":return i.createElement(lq,{layer:e,width:o,height:n,points:r,lineResizing:s,canvasHeight:l});case"svg":return i.createElement(uq,{layer:e,position:u,canvasHeight:l});default:return null}}))}componentDidUpdate(){const{layer:e,staticPreview:t,updateLayerAnimationPosition:a}=this.props,[o,n]=this.props.absoluteTimes,{studioTime:r}=this.props,i=!t&&!(o<=r&&r<=n),s={...this.getDivSize(),display:i?"none":"block"},l=w_(e);if(!t&&"progress-bar"!==(null==l?void 0:l.id)){const t=Bj(e,s.transform);l.layerInvolvesMovement&&a(t)}}render(){const e=this.getStyles();return i.createElement("div",{style:e,className:jj.disableselect},this.renderShapes())}}const yq=we(m.exports.connect((()=>(e,t)=>{var a;return{absoluteTimes:hq(t.layer),borderRadiusTemp:null==(a=e.studioLocal.layerTempValues[t.layer.id])?void 0:a.borderRadiusTemp}}))(gq)),fq="Placeholder-module_placeholder_laym8",Eq="Placeholder-module_placeholderImage_HtXg2",vq="Placeholder-module_placeholderPreview_ogQth",wq=s.exports.memoize(zS),bq=TT((e=>{const{previewUrl:t,layer:a}=e,[o,n]=wq(a);return i.createElement("div",{className:fq,style:(()=>{const{layer:t,x:a,y:r,width:i,height:s,staticPreview:l,rotation:d,studioTime:c}=e,u=!l&&!(o<=c&&c<=n);return{position:"absolute",left:a,top:r,width:i,height:s,background:t.background,display:u?"none":"flex",transform:`rotate(${d}deg)`}})()},t?i.createElement("img",{src:t,alt:"placeholder preview",className:vq}):i.createElement("img",{src:"/assets/placeholder.29822612.svg",className:Eq,alt:"placeholder icon"}))})),_q=e=>{const{dispatch:t}=tn();e.preventDefault(),t({type:"HIDE_CONTEXT_MENU"})},Tq=(e,t,a)=>{const{state:o,dispatch:n}=tn();if(!t)return;if(!o.userPermissions.canWrite)return;let r,i;if(e.preventDefault(),e.stopPropagation(),"clientX"in e)r=e.clientX,i=e.clientY;else{const t=e.touches[0];if(!t)return;r=t.clientX,i=t.clientY}const s={type:t,properties:a,clientX:r,clientY:i};var l,d;o.contextMenu?(l=o.contextMenu,d=s,Math.abs((null==l?void 0:l.clientX)-(null==d?void 0:d.clientX))<2&&Math.abs((null==l?void 0:l.clientY)-(null==d?void 0:d.clientY))<2&&_q(e)):(n({type:"ADD_CONTEXT_MENU_ANALYTICS"}),n(function(e){return{type:"SHOW_CONTEXT_MENU",contextMenu:e}}(s)))},Sq=(e,t)=>Tq(e,hh.track,{layerId:t}),Iq=(e,t)=>Tq(e,hh.layer,{layerId:t}),xq=e=>Tq(e,hh.gap),kq=e=>Tq(e,hh.trackpad),Cq=e=>Tq(e,hh.background),Aq=e=>Tq(e,hh.row);let Nq=null;const{dispatch:Pq}=tn(),Rq=e=>{e.preventDefault(),e.stopPropagation(),Nq===e.target&&(Nq=null,Pq(og(!1)))},Lq=e=>{e.preventDefault(),e.stopPropagation(),Nq=null,Pq(og(!1))},Dq=e=>{if(!xi(e))return Nq=null,void Pq(og(!1));e.preventDefault(),e.stopPropagation(),Nq=e.target,Pq(og(!0))};function Oq(e){const t=function(e){const t=r.exports.useRef(e);return t.current=e,t}(e);return r.exports.useCallback((function(...e){return t.current(...e)}),[])}const Fq="ContextMenu-module_wrapper_PG8XD",Mq=(e,t)=>Math.sqrt((t.x-e.x)**2+(t.y-e.y)**2);let Uq;const Bq=()=>{},Wq=({children:e,onContextMenu:t=Bq})=>{const a=(e=>{const[t]=r.exports.useState((()=>Math.random().toString(36).substring(2))),a=Oq(e),o=r.exports.useRef(null),n=r.exports.useRef(),i=r.exports.useRef(),s=r.exports.useCallback((e=>{if(Uq)return;Uq=t;const r=e.touches[0];r&&(n.current={x:r.clientX,y:r.clientY},i.current=n.current,o.current=setTimeout((()=>{null!=n.current&&null!=i.current&&Mq(n.current,i.current)<15&&a(e)}),600))}),[t,a]),l=r.exports.useCallback((e=>{const t=e.touches[0];t&&(i.current={x:t.clientX,y:t.clientY})}),[]),d=r.exports.useCallback((()=>{Uq=void 0,o.current&&clearTimeout(o.current)}),[]);return Nl()?{onTouchStart:s,onTouchMove:l,onTouchEnd:d}:{onContextMenu:a}})(t);return Object.is(t,Bq)?i.createElement(i.Fragment,null,e):i.createElement("div",{className:Fq,...a,"data-testid":"context-menu"},e)},Vq=(e,t="Content",a="middle")=>{if(!e)return t;if(e.length<30)return e;let o=10,n=e.length-10;switch(a){case"beginning":o=0,n=e.length-20;break;case"end":o=20,n=e.length}return`${e.substring(0,o)}...${e.substring(n,e.length)}`},jq=(e,t,a)=>{const{start:o,end:n}=Rd(e,a),r=fI(t,o),i=fI(t,n);return{left:r,width:Math.max(i-r,.01)}},Gq=new WeakMap;const Hq=c(OB,(e=>WA(e)),(e=>Wl(e)),NC,(e=>{var t;return!!(null==(t=e.comments.comments)?void 0:t.length)}),((e,t,a,o,n)=>{const r=function({layers:e,pxInSecond:t,sceneDuration:a,hasMagicSubtitles:o,hasComments:n}){var r;const i=[],s={},l={};for(const d of e){const c=null!=(r=d.timelineRow)?r:0;let u=!0;const m=s[c];void 0!==m?u=m:(u=zk(c,e),s[c]=u);const p=$k(u);let h=0;const g=l[c];void 0!==g?h=g:(h=Wk(Vk(c,e,o),n),l[c]=h);const y={...d,timelineRow:c,timelinePosition:{...jq(d,t,a),height:p,top:h},isTall:u},f=Gq.get(d);f&&f.isTall===y.isTall&&ar(y.timelinePosition,f.timelinePosition)?i.push(f):(Gq.set(d,y),i.push(y))}return i.sort(((e,t)=>e.timelinePosition.left-t.timelinePosition.left)),i}({layers:e,pxInSecond:a||0,sceneDuration:t,hasMagicSubtitles:o,hasComments:n});return r})),zq=c(Hq,(e=>{var t;return null==(t=e.studioLocal.mouseState)?void 0:t.id}),(e=>e.studio.selectedItem),(e=>e.studio.groups),((e,t,a,o)=>e.filter((e=>{if(e.id===t)return!0;if(!a)return!1;if("layer"===a.type)return e.id===a.id;if("group"===a.type){const t=o[a.id];return SV(e.id,{currentGroup:t})}return!1})))),$q=()=>c(Hq,((e,t)=>t),((e,t)=>e.find((e=>e.id===t)))),Kq={},Yq=c(zq,((e,t)=>t),((e,t)=>{const a={},o={};for(const n of e)o[n.id]=n;for(const n in t){const e=t[n],r=o[n];let i;if(r&&(i=r.isTall),e){const{newIsTall:t}=e,{newTimelineRow:o}=e;t===i&&(a[o]="same"),t&&!i&&(a[o]="expanded"),!t&&i&&(a[o]="shrunk")}}return s.exports.isEmpty(a)?Kq:a})),qq=["audio","subtitle"],Xq=c((e=>e.studio.scenes),(e=>e.studio.allLayers.byId),(e=>e.studio.groups),((e,t)=>t),((e,t,a,o)=>{const n=Object.entries(a),r=[],i=[],s=e[0];if(!s)return[];const l=s.layers.filter((e=>{const[t,a]=zS(e);return t<=o&&o<=a&&!e.locked&&!qq.includes(e.type)}));return n.length>0&&l.forEach((e=>{const a=n.find((([t,a])=>a.layers.find((t=>t.id===e.id))));if(a){a[1].layers.forEach((e=>{i.push(e.id)}));const e=a[0];if(!!!r.find((({id:t})=>t===e))){const o=a[1].layers.map((e=>t[e.id])).filter(rl),{rotation:n,origin:i}=a[1],{tl:s,tr:l,br:d,bl:c}=RS({position:dA(o,n,i),shapeType:"group",positionType:"pixel"}),u=[s,l,d,c];r.push({id:e,points:u,item:{type:"group"}})}}})),l.forEach((e=>{if(!i.includes(e.id)&&e.position){const{tl:t,tr:a,br:o,bl:n}=RS({position:e.position,shapeType:e.shapeType,positionType:"percent"}),i=[t,a,o,n],{id:s}=e;r.push({id:s,points:i,item:{type:"layer"}})}})),r})),Jq=c(Hq,(e=>e.filter((e=>e.type!==ln.Subtitle)).map((e=>{const{id:t}=e,{top:a,left:o,width:n,height:r}=e.timelinePosition;return{id:t,points:[{x:o,y:a},{x:o+n,y:a},{x:o+n,y:a+r},{x:o,y:a+r}],item:{type:"layer"}}})))),Qq=c(JC,(e=>e.map((e=>{const{id:t}=e,{top:a,left:o,width:n,height:r}=e.timelinePosition;return{id:t,points:[{x:o,y:a},{x:o+n,y:a},{x:o+n,y:a+r},{x:o,y:a+r}],item:{type:"magicSubtitle",frames:e.containedFrames}}}))));function Zq(){return tr(sN)}const eX="BoxSelect-module_boxSelectContainerWorkspace_CjCbh",tX="BoxSelect-module_boxSelectContainerCanvas_-0Joz",aX="BoxSelect-module_boxSelectContainerTrackpad_T9zxF";function oX(e,t){const a=[e,t];let o,n,r,i,s,l,d;for(const c of a)for(i=0;i<c.length;i+=1){const a=(i+1)%c.length,u=c[i],m=c[a],p={x:m.y-u.y,y:u.x-m.x};for(o=void 0,n=void 0,s=0;s<e.length;s+=1)r=p.x*e[s].x+p.y*e[s].y,(void 0===o||r<o)&&(o=r),(void 0===n||r>n)&&(n=r);for(l=void 0,d=void 0,s=0;s<t.length;s+=1)r=p.x*t[s].x+p.y*t[s].y,(void 0===l||r<l)&&(l=r),(void 0===d||r>d)&&(d=r);if(n<l||d<o)return!1}return!0}const nX=[],rX=({autoScrollDisplacement:e,boxSelectIsHappening:t,boxSelectStartCoords:a,containerOffsetX:o,containerOffsetY:n,disabled:l=!1,location:d,setBoxSelectIsHappening:c,setBoxSelectStartCoordsToNull:u,unlockedProjectsArray:p})=>{var h,g;const y=m.exports.useDispatch(),[f,E]=r.exports.useState(null),[v,w]=r.exports.useState({}),b=tr((e=>e.studioLocal.boxSelectedIds)),_=tr((e=>{return"trackpad"===d?Jq(e):"workspace"===d&&p?null==(t=p)?void 0:t.map((e=>{const{top:t,left:a,width:o,height:n}=e.position?e.position:{top:0,left:0,width:0,height:0},r=[{x:a,y:t},{x:a+o,y:t},{x:a+o,y:t+n},{x:a,y:t+n}];return{id:e._id,points:r,item:{type:"project"}}})):Xq(e,ST());var t})),T=tr((e=>"trackpad"!==d?nX:Qq(e))),S=Zq().map((e=>null==e?void 0:e.id)),I={x:0,y:0},x={x:I.x,y:I.y};let k=0,C=0;if(f){I.x=a.x-o,I.y=a.y-n,k=f.x+(null!=(h=null==e?void 0:e.horizontal)?h:0),C=f.y+(null!=(g=null==e?void 0:e.vertical)?g:0),k<0&&(I.x+=k),C<0&&(I.y+=C),x.x=I.x+Math.abs(k),x.y=I.y+Math.abs(C);const t=[{x:I.x,y:I.y},{x:x.x,y:I.y},{x:x.x,y:x.y},{x:I.x,y:x.y}],r=e=>!e.points.every((e=>0===e.x&&0===e.y))&&oX(e.points,t),i=_.filter(r),l=T.filter(r),d=(i.length>0?i:l).reduce(((e,t)=>(e[t.id]=t.item,e)),{});s.exports.isEqual(d,v)||w(d)}const A=Oq((()=>{if(c&&t&&c(!1),null!==f){E(null);let e=Object.entries(v).filter((e=>"layer"===e[1].type||"group"===e[1].type)).map((e=>e[0]));(null==S?void 0:S.length)&&(e=[...new Set([...e,...S])]),Tj({});if(Object.values(v).some((e=>"magicSubtitle"===e.type))){const e=Object.values(v).filter((e=>"magicSubtitle"===e.type)).map((e=>e.frames)).flat();y(Kh({type:"magicSubtitle",frames:e}))}else TV(e,"trackpad"===d);Object.keys(v).length>0&&w({}),u()}u()})),N=Oq((e=>{c&&!t&&c(!0);const{clientX:o,clientY:n}=e,r=o-a.x,i=n-a.y;E({x:r,y:i}),S.length&&!c&&tn().dispatch(Kh(null))}));return r.exports.useEffect((()=>(document.addEventListener("mousemove",N),document.addEventListener("mouseup",A),()=>{document.removeEventListener("mousemove",N),document.removeEventListener("mouseup",A)})),[N,A]),r.exports.useEffect((()=>{s.exports.isEqual(v,b)||Tj(v)}),[v,b]),f&&!l?i.createElement("div",{className:(()=>{switch(d){case"workspace":return eX;case"canvas":return tX;default:return aX}})(),style:{left:`${I.x}px`,top:`${I.y}px`,width:`${Math.max(Math.abs(k),1)}px`,height:`${Math.max(Math.abs(C),1)}px`}}):null},iX=e=>e.length-1;function sX(e,t){const{x:a,y:o,width:n,height:r}=e,i=t*Math.PI/180,s=a+n/2,l=o+r/2;return{tl:{x:(a-s)*Math.cos(i)-(o-l)*Math.sin(i)+s,y:(a-s)*Math.sin(i)+(o-l)*Math.cos(i)+l},tr:{x:(a+n-s)*Math.cos(i)-(o-l)*Math.sin(i)+s,y:(a+n-s)*Math.sin(i)+(o-l)*Math.cos(i)+l},bl:{x:(a-s)*Math.cos(i)-(o+r-l)*Math.sin(i)+s,y:(a-s)*Math.sin(i)+(o+r-l)*Math.cos(i)+l},br:{x:(a+n-s)*Math.cos(i)-(o+r-l)*Math.sin(i)+s,y:(a+n-s)*Math.sin(i)+(o+r-l)*Math.cos(i)+l},origin:{x:s,y:l}}}function lX(e,t=!0){const{state:a}=tn(),{canvasX:o,canvasY:n}=a.studio,r=a.studio.width,i=a.studio.height,s=[];for(const l of e){const{width:e,height:t}=l,{x:a,y:d}=l;let c={x:a,y:d,width:e,height:t};if("position"in l&&l.position){const{x:e,y:t,width:a,height:s}=l.position;c={x:o+parseFloat(e)/100*r,y:n+parseFloat(t)/100*i,width:parseFloat(a)/100*r,height:parseFloat(s)/100*i},"shape"===l.type&&"ellipse"===l.shapeType&&(c.x-=c.width/2,c.y-=c.height/2)}const{tl:u,tr:m,bl:p,br:h,origin:g}=sX(c,l.position&&l.position.rotation||0);s.push({x:u.x,y:u.y},{x:m.x,y:m.y},{x:p.x,y:p.y},{x:h.x,y:h.y},{x:g.x,y:u.y},{x:g.x,y:h.y},{x:u.x,y:g.y},{x:h.x,y:g.y})}return t?s.filter((e=>e.x>=o&&e.x<=o+r&&e.y>=n&&e.y<=n+i)):s}function dX(e,t,a){return[90,270].includes(e)?{x:qT((t-a)/2),y:qT((a-t)/2)}:{x:0,y:0}}function cX(e,t){const a=function(){var e;const{state:t}=tn(),{scenes:a,selectedItem:o,canvasX:n,canvasY:r,width:i,height:s,groups:l}=t.studio,d=(null==o?void 0:o.id)||"";return lX([{x:n,y:r,width:i,height:s},...(null==(e=a[0])?void 0:e.layers.filter((e=>{var t;if(!e)return!1;const a=l&&l[d]&&(null==(t=l[d])?void 0:t.layers.map((e=>e.id)).includes(e.id)),[o,n]=zS(e),r=o<=ST()&&ST()<=n;return!a&&e.id!==d&&r&&"subtitle"!==e.type})))||[]])}(),{x:o,y:n,width:r,height:i}=e;let s=o,l=n;const d=dX(t,i,r);s-=d.x,l-=d.y;const c=[90,270].includes(t),u=c?i:r,m=c?r:i,p={top:!1,right:!1,bottom:!1,left:!1,centerX:!1,centerY:!1},h={},g={top:[],right:[],bottom:[],left:[],centerX:[],centerY:[]};for(const{x:x,y:k}of a){const e=x-3,t=x+3,a=k-3,o=k+3;l>=a&&l<=o&&(p.top=!0,g.top.push({x:x,y:k})),s+u>=e&&s+u<=t&&(p.right=!0,g.right.push({x:x,y:k})),l+m>=a&&l+m<=o&&(p.bottom=!0,g.bottom.push({x:x,y:k})),s>=e&&s<=t&&(p.left=!0,g.left.push({x:x,y:k}));const n=s+u/2;n>=e&&n<=t&&(p.centerX=!0,g.centerX.push({x:x,y:k}));const r=l+m/2;r>=a&&r<=o&&(p.centerY=!0,g.centerY.push({x:x,y:k}))}const[y,f,E,v,w,b,_,T]=lX([{x:s,y:l,width:u,height:m}],!1);if(!(y&&f&&E&&v&&w&&b&&_&&T))return{shouldSnap:p,snapPositions:h};const S=(e,t)=>((e={},t="",a="")=>{const o=e[t].sort(((e,t)=>e[a]-t[a]));return Object.assign(e,{[t]:o}),o})(g,e,t);let I=0;return p.top&&(S("top","x"),I=iX(g.top),f.x>g.top[I].x&&g.top.push({x:f.x,y:g.top[I].y}),y.x<g.top[0].x&&g.top.unshift({x:y.x,y:g.top[0].y})),p.bottom&&(S("bottom","x"),I=iX(g.bottom),v.x>g.bottom[I].x&&g.bottom.push({x:v.x,y:g.bottom[I].y}),E.x<g.bottom[0].x&&g.bottom.unshift({x:y.x,y:g.bottom[0].y})),p.left&&(S("left","y"),I=iX(g.left),E.y>g.left[I].y&&g.left.push({x:g.left[I].x,y:E.y}),y.y<g.left[0].y&&g.left.unshift({x:g.left[0].x,y:y.y})),p.right&&(S("right","y"),I=iX(g.right),v.y>g.right[I].y&&g.right.push({x:g.right[I].x,y:v.y}),f.y<g.right[0].y&&g.right.unshift({x:g.right[0].x,y:f.y})),p.centerX&&(S("centerX","y"),I=iX(g.centerX),b.y>g.centerX[I].y&&g.centerX.push({x:g.centerX[I].x,y:b.y}),w.y<g.centerX[0].y&&g.centerX.unshift({x:g.centerX[0].x,y:w.y})),p.centerY&&(S("centerY","x"),I=iX(g.centerY),T.x>g.centerY[I].x&&g.centerY.push({x:T.x,y:g.centerY[I].y}),_.x<g.centerY[0].x&&g.centerY.unshift({x:_.x,y:g.centerY[0].y})),Object.keys(g).forEach((e=>{const t=g[e];if(t.length){const a=t.length-1;Object.assign(h,{[e]:[{x:t[0].x,y:t[0].y},{x:t[a].x,y:t[a].y}]})}})),{shouldSnap:p,snapPositions:h}}const uX=e=>{const{x:t,y:a,width:o,height:n}=e,{state:r}=tn(),{canvasX:i,canvasY:s,width:l,height:d}=r.studio,c=e;return t<=i+3&&t>=i-3&&(c.x=i),a<=s+3&&a>=s-3&&(c.y=s),n<=d+3&&n>=d-3&&(c.height=d),o<=l+3&&o>=l-3&&(c.width=l),c},mX=(e,t,a="")=>{const{shouldSnap:o,snapPositions:n}=cX(e,t),{x:r,y:i,width:s,height:l}=e,{dispatch:d,state:c}=tn();let u=r,m=i;const p={},h=dX(t,l,s),g=[90,270].includes(t),y=g?l:s,f=g?s:l;let E=y,v=f;if(o.centerX){const e=n.centerX[0].x+h.x;if(a.includes("Right")){E+=2*(e-y/2-r)}else if(a.includes("Left")){const t=y+r-e;u=e-t,E=2*t}Object.assign(p,{centerX:{start:n.centerX[0],end:n.centerX[1]}})}if(o.centerY){const e=n.centerY[0].y+h.y;if(a.includes("bottom")){v+=2*(e-f/2-i)}else if(a.includes("top")){const t=i+f-e;m=e-t,v=2*t}Object.assign(p,{centerY:{start:n.centerY[0],end:n.centerY[1]}})}if(o.top){const e=n.top[0].y+h.y;m=e,v+=i-e,Object.assign(p,{top:{start:n.top[0],end:n.top[1]}})}if(o.right&&(E+=-1*y+(n.right[0].x-r)+h.x,Object.assign(p,{right:{start:n.right[0],end:n.right[1]}})),o.bottom&&(v+=-1*f+(n.bottom[0].y-i)+h.y,Object.assign(p,{bottom:{start:n.bottom[0],end:n.bottom[1]}})),o.left){const e=n.left[0].x+h.x;u=e,E+=r-e,u=n.left[0].x+h.x,Object.assign(p,{left:{start:n.left[0],end:n.left[1]}})}(Object.keys(p).length||c.studio.snapLines&&Object.keys(p).length!==Object.keys(c.studio.snapLines).length)&&d(Oh(p));return uX({x:u,y:m,width:g?v:E,height:g?E:v})},pX=(e,t,a=!0)=>{const{shouldSnap:o,snapPositions:n}=cX(e,t),{x:r,y:i,width:s,height:l}=e,{dispatch:d,state:c}=tn();let u=r,m=i;const p={},h=dX(t,l,s),g=[90,270].includes(t),y=g?l:s,f=g?s:l;o.top&&(m=n.top[0].y+h.y,Object.assign(p,{top:{start:n.top[0],end:n.top[1]}})),o.right&&(u=n.right[0].x-y+h.x,Object.assign(p,{right:{start:n.right[0],end:n.right[1]}})),o.bottom&&(m=n.bottom[0].y-f+h.y,Object.assign(p,{bottom:{start:n.bottom[0],end:n.bottom[1]}})),o.left&&(u=n.left[0].x+h.x,Object.assign(p,{left:{start:n.left[0],end:n.left[1]}})),o.centerX&&(u=n.centerX[0].x-s/2,Object.assign(p,{centerX:{start:n.centerX[0],end:n.centerX[1]}})),o.centerY&&(m=n.centerY[0].y-l/2,Object.assign(p,{centerY:{start:n.centerY[0],end:n.centerY[1]}})),(Object.keys(p).length||c.studio.snapLines&&Object.keys(p).length!==Object.keys(c.studio.snapLines).length)&&a&&d(Oh(p));const E={...e,x:u,y:m};return uX(E)},hX={home:"Transformer-module_home_oIkMB",homeHowBackgroundWhite:"Transformer-module_homeHowBackgroundWhite_lXDmU",largeButton:"Transformer-module_largeButton_a8Fs4",sectionContent:"Transformer-module_sectionContent_DUpV-",sectionHeader:"Transformer-module_sectionHeader_ROcM-",spacer:"Transformer-module_spacer_1JWk0",chevron:"Transformer-module_chevron_c9Ys4",splashText:"Transformer-module_splashText_zdbos",splashSubtext:"Transformer-module_splashSubtext_OwPHU",aboutSection:"Transformer-module_aboutSection_1zW2e",mobile:"Transformer-module_mobile_r3-eB",desktop:"Transformer-module_desktop_t7exQ",screenReaderOnlyLabel:"Transformer-module_screenReaderOnlyLabel_sfUXl",disabled:"Transformer-module_disabled_gVJ7y",noScrollBar:"Transformer-module_noScrollBar_8J5fU",textOverflowEllipsis:"Transformer-module_textOverflowEllipsis_nxsp7",genericButtonBlue:"Transformer-module_genericButtonBlue_cqcrv",button:"Transformer-module_button_Vi0nG",buttonDisabled:"Transformer-module_buttonDisabled_hnVvt",buttonSelected:"Transformer-module_buttonSelected_h7uwI",buttonOk:"Transformer-module_buttonOk_x3KcI",buttonStacked:"Transformer-module_buttonStacked_fKQ7m",doneButton:"Transformer-module_doneButton_5NtwR",desktopNoWrap:"Transformer-module_desktopNoWrap_-tLqx",mobileNoWrap:"Transformer-module_mobileNoWrap_f7WTr",controlSectionContainer:"Transformer-module_controlSectionContainer_hLek9",section:"Transformer-module_section_euMbw",input:"Transformer-module_input_m-yAq",cyanDoneButton:"Transformer-module_cyanDoneButton_IrFLD",cyanDoneButton__disabled:"Transformer-module_cyanDoneButton__disabled_M4k3M",cyanDoneButtonContainer:"Transformer-module_cyanDoneButtonContainer_P3-bu",genericButton:"Transformer-module_genericButton_1ijrh",genericButtonSelected:"Transformer-module_genericButtonSelected_iPBIo",groupControlContainer:"Transformer-module_groupControlContainer_zkpv8",controlSectionRows:"Transformer-module_controlSectionRows_4k6Qd",controlSectionRowsTimeline:"Transformer-module_controlSectionRowsTimeline_FlKJR",controlSectionRowsTwoPerRow:"Transformer-module_controlSectionRowsTwoPerRow_-4BFu",controlSectionRowsExpandChildren:"Transformer-module_controlSectionRowsExpandChildren_nmuI0",controlSectionRowsFullWidth:"Transformer-module_controlSectionRowsFullWidth_VhT5g",controlSectionRowsNoWrap:"Transformer-module_controlSectionRowsNoWrap_e-uIj",controlSectionRowsNoPadding:"Transformer-module_controlSectionRowsNoPadding_cx-6r",controlSectionRowsIconAndControl:"Transformer-module_controlSectionRowsIconAndControl_nFyPo",controlSectionWrapColumns:"Transformer-module_controlSectionWrapColumns_BivM-",controlSectionScrollableColumn:"Transformer-module_controlSectionScrollableColumn_J-gFN",controlSectionTitle:"Transformer-module_controlSectionTitle_XmRot",controlSectionTitleNoPadding:"Transformer-module_controlSectionTitleNoPadding_KtNiK",controlSectionDescription:"Transformer-module_controlSectionDescription_2-HSU",smallControlButton:"Transformer-module_smallControlButton_HIoC4",smallControlButtonDisabled:"Transformer-module_smallControlButtonDisabled_v6XIu",smallControlButtonSelected:"Transformer-module_smallControlButtonSelected_PbxGE",smallControlButtonLabel:"Transformer-module_smallControlButtonLabel_Z6bKj",controlSectionRow:"Transformer-module_controlSectionRow_QBQPc",controlButtonIcon:"Transformer-module_controlButtonIcon_ACT-S",controlButtonOnlyIcon:"Transformer-module_controlButtonOnlyIcon_5Eu5N",controlButtonOnlyIconRoundedSmallTheme:"Transformer-module_controlButtonOnlyIconRoundedSmallTheme_ZA-xU",bigOverlayButton:"Transformer-module_bigOverlayButton_OxS-t",bigOverlayButtonSelected:"Transformer-module_bigOverlayButtonSelected_XURUs",bigOverlayButtonDisabled:"Transformer-module_bigOverlayButtonDisabled_Rhhuh",bigOverlayButtonIcon:"Transformer-module_bigOverlayButtonIcon_GjO6b",incrementDecrementControl:"Transformer-module_incrementDecrementControl_CfA8b",incrementDecrementControlLightTheme:"Transformer-module_incrementDecrementControlLightTheme_9zl2W",incrementDecrementControlSmallTheme:"Transformer-module_incrementDecrementControlSmallTheme_9Rgzy",incrementDecrementControlExtraSmallTheme:"Transformer-module_incrementDecrementControlExtraSmallTheme_PbZBt",incrementDecrementButton:"Transformer-module_incrementDecrementButton_sMETt",incrementDecrementButtonLightTheme:"Transformer-module_incrementDecrementButtonLightTheme_1TfRV",incrementDecrementButtonSmallTheme:"Transformer-module_incrementDecrementButtonSmallTheme_8kYSG",incrementDecrementControlValue:"Transformer-module_incrementDecrementControlValue_Bx7yY",incrementDecrementControlValueSmallTheme:"Transformer-module_incrementDecrementControlValueSmallTheme_W03za",incrementControl:"Transformer-module_incrementControl_KmuZK",decrementControl:"Transformer-module_decrementControl_1Xcvp",disabledIncrementDecrementButton:"Transformer-module_disabledIncrementDecrementButton_WENvC",tooltip:"Transformer-module_tooltip_NF-Wl",selectDropDownContainer:"Transformer-module_selectDropDownContainer_P9GTI",selectDropDownDisplay:"Transformer-module_selectDropDownDisplay_F-vsU",selectDropDownLabel:"Transformer-module_selectDropDownLabel_P7-kO",selectDropDownLink:"Transformer-module_selectDropDownLink_5fZK7",selectDropDownList:"Transformer-module_selectDropDownList_V2HW3",selectDropDownItem:"Transformer-module_selectDropDownItem_-XZnv",bottomDivider:"Transformer-module_bottomDivider_RKXqa",selectDropDownItemSelected:"Transformer-module_selectDropDownItemSelected_2LCG6",selectDropDownShowing:"Transformer-module_selectDropDownShowing_qDUJJ",dropDownButtonIcon:"Transformer-module_dropDownButtonIcon_0OqsW",selectOptionIcon:"Transformer-module_selectOptionIcon_kjJnB",transparentSelectInput:"Transformer-module_transparentSelectInput_HygXf",selectOptionContainer:"Transformer-module_selectOptionContainer_qml6Z",dropDownHeader:"Transformer-module_dropDownHeader_GxJNc",noMargin:"Transformer-module_noMargin_0oBkV",halfWidth:"Transformer-module_halfWidth_dX1EJ",fullWidth:"Transformer-module_fullWidth_xPldo",selectDropDownIcon:"Transformer-module_selectDropDownIcon_hwd-X",controlButtonsContainer:"Transformer-module_controlButtonsContainer_cPbvi",loadingIcon:"Transformer-module_loadingIcon_MF0b4",spin:"Transformer-module_spin_1QE-k",iconAndLabelRow:"Transformer-module_iconAndLabelRow_Vr58x",dropdownDirectInput:"Transformer-module_dropdownDirectInput_LdF7r",transformer:"Transformer-module_transformer_AgKxF",groupTransformer:"Transformer-module_groupTransformer_7N1m-",selectedLayer:"Transformer-module_selectedLayer_wuDY5",eligibleForDottedLineHover:"Transformer-module_eligibleForDottedLineHover_Au-OO",groupTransformerParent:"Transformer-module_groupTransformerParent_ZbEKU",transformerNode:"Transformer-module_transformerNode_fv9Ib",middleTransformerNode:"Transformer-module_middleTransformerNode_BsDVF",middleTransformerNodeActive:"Transformer-module_middleTransformerNodeActive_iPzKE",transformerBorder:"Transformer-module_transformerBorder_HEMEY",groupTransformerBorder:"Transformer-module_groupTransformerBorder_VaT21",transformerBackground:"Transformer-module_transformerBackground_8y2Mk",middleTransformerNodeContainer:"Transformer-module_middleTransformerNodeContainer_sUXSe",rotateNode:"Transformer-module_rotateNode_KRuRD",rotateNodeIcon:"Transformer-module_rotateNodeIcon_ZafZL",rotateNodeHandle:"Transformer-module_rotateNodeHandle_6jbaW",transformerNodeTopLeft:"Transformer-module_transformerNodeTopLeft_F1qT7",transformerNodeBottomRight:"Transformer-module_transformerNodeBottomRight_f6KCz",transformerNodeTopRight:"Transformer-module_transformerNodeTopRight_LmneV",transformerNodeBottomLeft:"Transformer-module_transformerNodeBottomLeft_MfqPg",transformerNodeMiddleRight:"Transformer-module_transformerNodeMiddleRight_ke6CJ",transformerNodeMiddleLeft:"Transformer-module_transformerNodeMiddleLeft_a-4mB",transformerNodeHideUntilHover:"Transformer-module_transformerNodeHideUntilHover_z-gsf",hide:"Transformer-module_hide_1bWy6",transformerText:"Transformer-module_transformerText_5ZCPt",selectedTransformer:"Transformer-module_selectedTransformer_7K06Q",transformerBackgroundOverlay:"Transformer-module_transformerBackgroundOverlay_lf8MM",transformerBackgroundOverlayTransparent:"Transformer-module_transformerBackgroundOverlayTransparent_dvw-C",presentUserTag:"Transformer-module_presentUserTag_BhJvX"},gX=i.createContext(null),yX=({containerRef:e,children:t})=>i.createElement(gX.Provider,{value:e},t);class fX extends r.exports.Component{constructor(e){super(e),a(this,"useTouch"),a(this,"touchStartHandler",(e=>{this.useTouch=!0,this.handleMouseDown(e)})),a(this,"mouseDownHandler",(e=>{this.useTouch||this.handleMouseDown(e)})),a(this,"contextualSelectLayer",(e=>{const{selectItem:t}=this.props;t(e)})),a(this,"getIdOfOtherSelectedLayerPointerEventHappenedInside",(e=>{const{layer:t,selectedLayers:a,canvasContainerRef:o}=this.props;if(!o)return null;const{current:n}=o;if(t&&a.includes(t))return null;const{state:r}=tn(),i=n.getBoundingClientRect(),[s,l]=wi(e),d=s-i.left,c=l-i.top,u=Xq(r,ST()),m=[{x:d,y:c}];for(const p of u)if(a.some((e=>e.id===p.id))&&oX(p.points,m))return p.id;return null})),a(this,"handleMouseDown",(e=>{if(!HW(e))return;const{x:t,y:a,handleExitEditorClick:o,isBackgroundTransformer:n,isSelected:r,setDragging:i,handleMouseDownCallback:s}=this.props;if(HW(e)){null==s||s(e);const[o,l]=wi(e);let d=!1;!n&&r&&(d=!0),i(!0),this.setState({dragging:!0,didDrag:!1,layerWasSelected:d,mouseStartX:o,mouseStartY:l,layerStartX:t,layerStartY:a})}o()})),a(this,"handleMouseUp",(e=>{const{handleTransformFinish:t,layer:a,isSelected:o,setDragging:n,handleMouseUpCallback:r}=this.props;null==r||r(e),n(!1);const{didDrag:i,layerWasSelected:s}=this.state;a&&!i&&s&&o&&("placeholder"===(null==a?void 0:a.type)&&iT("/studio/editor/replace"),this.props.handleDoubleClick&&this.props.handleDoubleClick()),HW(e)&&(this.setState({dragging:!1,didDrag:!1,layerWasSelected:!1,mouseStartX:void 0,mouseStartY:void 0,layerStartX:void 0,layerStartY:void 0}),t("drag"),this.props.showSnapLines({}))})),a(this,"handleMouseMove",(e=>{const{isSelected:t,isBackgroundTransformer:a,width:o,height:n,rotation:r,handleTransform:i,shiftIsBeingPressed:s}=this.props,{dragging:l,didDrag:d,mouseStartX:c,mouseStartY:u,layerStartX:m,layerStartY:p}=this.state;if(!tn().state.studio.studioPaused&&$A(),!l)return;if(e.which>1)return;if(!t)return;if(a)return;const[h,g]=wi(e),y=h-(null!=c?c:0),f=g-(null!=u?u:0);let E=(null!=m?m:0)+y,v=(null!=p?p:0)+f;s&&(Math.abs(y)>Math.abs(f)&&(v=null!=p?p:0),Math.abs(y)<Math.abs(f)&&(E=null!=m?m:0));let w={x:E,y:v,width:o,height:n};OA()&&void 0!==r&&r%90==0&&(w=pX(w,r)),i(w,"drag"),!d&&(Math.abs(y)>0||Math.abs(f)>0)&&this.setState({didDrag:!0}),e.preventDefault()})),a(this,"getStyles",(()=>{const{x:e,y:t,width:a,height:o,rotation:n,isEditing:r,isBackgroundTransformer:i,zIndex:s,backgroundColor:l}=this.props;return{top:t,left:e,width:a,height:o,transform:`rotate(${n}deg)`,cursor:!i&&r?"text":"pointer",zIndex:s,backgroundColor:null!=l?l:"transparent"}})),a(this,"getPresenceStyles",(e=>{var t;const{presence:a,x:o,y:n,width:r,height:i}=this.props;return{border:`2px solid ${null==(t=a[e])?void 0:t.color}`,top:n,left:o,width:r,height:i}})),a(this,"handleContextMenu",(e=>{const{isBackgroundTransformer:t,layer:a,groupId:o}=this.props;if(t)return void Cq(e);let n="";const r=this.getIdOfOtherSelectedLayerPointerEventHappenedInside(e);r?n=r:o?(this.contextualSelectLayer({id:o,type:"group"}),n=o):a&&(this.contextualSelectLayer({id:a.id,type:"layer"}),n=a.id),Iq(e,n)})),this.useTouch=!1,this.state={dragging:!1,didDrag:!1,layerWasSelected:!1,mouseStartX:0,mouseStartY:0,layerStartX:0,layerStartY:0}}componentDidUpdate(e,t){const{dragging:a}=this.state,{isGhostTransformer:o,handleTransform:n,mIGhostLayerAbsolutePosition:r}=this.props;if(o&&OA()){const t=!s.exports.isEqual(r,null==e?void 0:e.mIGhostLayerAbsolutePosition),a=pX(r,0,t);t&&n(a,"drag")}a&&!t.dragging?this.addListeners():!a&&t.dragging&&this.removeListeners()}componentWillUnmount(){this.removeListeners()}addListeners(){document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp),document.addEventListener("touchmove",this.handleMouseMove,{passive:!1}),document.addEventListener("touchend",this.handleMouseUp)}removeListeners(){document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("touchmove",this.handleMouseMove),document.removeEventListener("touchend",this.handleMouseUp)}renderPresentUserSelection(){const{presentUser:e,presentUserId:t}=this.props;return e&&e!==t?i.createElement("div",{style:this.getPresenceStyles(e)}):null}render(){const{groupId:e,height:t,isBackgroundTransformer:a,isCollaborating:o,isDraggingGlobal:n,isSelectedLayerInSameGroup:r,isSelected:s,presence:l,width:d}=this.props;if(e&&!r)return null;const c=[hX.transformer];a&&c.push(hX.transformerBackground),s&&c.push(hX.selectedLayer);return(!a&&!s&&!n||this.state.dragging)&&c.push(hX.eligibleForDottedLineHover),i.createElement(Wq,{onContextMenu:this.handleContextMenu},i.createElement("div",{style:this.getStyles(),className:c.join(" "),onMouseDown:this.mouseDownHandler,onTouchStart:this.touchStartHandler,onDoubleClick:this.props.handleDoubleClick,"data-cy":"drag-handler"},i.createElement("div",{className:hX.transformerText},this.props.transformerText),e&&i.createElement("div",{style:{width:d,height:t},className:hX.groupTransformerBorder}),o&&l&&this.renderPresentUserSelection()))}}const EX=m.exports.connect(((e,t)=>{var a;const o=t.groupId&&(null==(a=e.studio.groups[t.groupId])?void 0:a.layers.some((t=>{var a;return(null==(a=e.studio.selectedItem)?void 0:a.id)===t.id})));return{isDraggingGlobal:e.studio.isDragging,isEditing:t.layer&&ml(e,t.layer.id),isSelectedLayerInSameGroup:o,shiftIsBeingPressed:e.studioLocal.shiftIsBeingPressed,isCollaborating:e.studio.isCollaborating,presence:e.studio.presence,presentUserId:e.studio.presentUserId,mIGhostLayerAbsolutePosition:hl(e),selectedLayers:sN(e)}}),(e=>me({selectItem:Kh,setDragging:j_,showSnapLines:Oh},e)))(function(e){return t=>i.createElement(gX.Consumer,null,(a=>i.createElement(e,{...t,canvasContainerRef:a})))}(fX));class vX extends r.exports.Component{constructor(e){super(e),a(this,"globalHandlersAdded",!1),a(this,"cleanupGlobalHandlers",(()=>{this.globalHandlersAdded&&(document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("touchmove",this.handleMouseMove),document.removeEventListener("touchend",this.handleMouseUp),this.globalHandlersAdded=!1)})),a(this,"handleMouseDown",(e=>{const{x:t,y:a,width:o,height:n,setRotating:r,handleMouseDownCallback:i}=this.props;null==i||i(e);const s=document.getElementById("canvas-container");if(!s)return;const l=s.getBoundingClientRect(),d={x:l.left+t+o/2,y:l.top+a+n/2};HW(e)&&(r(!0),this.setState({rotating:!0,startVector:d}))})),a(this,"handleMouseUp",(e=>{const{handleTransformFinish:t,setRotating:a,handleMouseUpCallback:o}=this.props;null==o||o(e),HW(e)&&(a(!1),this.setState({rotating:!1}),t("rotate"))})),a(this,"handleMouseMove",(e=>{const{handleTransform:t}=this.props,{rotating:a,startVector:o}=this.state;if(!a)return;if(e.which>1)return;const[n,r]=wi(e);let i=(DW(o,{x:n,y:r})-90)%360;if(OA()){const e=(s=i)-(l=45)*Math.floor(s/l);if(e>=41){i+=45-e}else e<=4&&(i-=e);(Math.abs(i)<1||Math.abs(i)>359)&&(i=0)}var s,l;t({rotation:i,x:this.props.x,y:this.props.y,width:this.props.width,height:this.props.height},"rotate"),e.preventDefault()})),a(this,"getStyles",(()=>{const{x:e,y:t,width:a,height:o,rotation:n=0}=this.props,r=e+a/2,i=t+o/2,s=o/2+20,l=n*Math.PI/180;let d=r-s*Math.sin(l),c=i+s*Math.cos(l);return d-=10,c-=10,{width:20,height:20,top:c,left:d}})),this.state={rotating:!1,startVector:{x:0,y:0}}}componentDidUpdate(e,t){const{rotating:a}=this.state;a&&!t.rotating?(document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp),document.addEventListener("touchmove",this.handleMouseMove,{passive:!1}),document.addEventListener("touchend",this.handleMouseUp),this.globalHandlersAdded=!0):!a&&t.rotating&&this.cleanupGlobalHandlers()}componentWillUnmount(){this.cleanupGlobalHandlers()}render(){return i.createElement("div",{style:this.getStyles(),"data-cy":"rotate-handler-node",className:[hX.transformer,hX.transformerNode,hX.rotateNode,hX.selectedTransformer].join(" "),onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onTouchStart:this.handleMouseDown,onTouchEnd:this.handleMouseUp},i.createElement(Je,{className:hX.rotateNodeIcon}))}}const wX=m.exports.connect(void 0,(e=>me({setRotating:z_},e)))(vX);class bX extends r.exports.Component{constructor(e){super(e),a(this,"presenceRef"),a(this,"transformerContainerRef"),a(this,"handleMouseDownCallback",(e=>{const{layer:t,handleMouseDownCallback:a}=this.props;"text"===(null==t?void 0:t.type)&&KT(t.id,{beingTransformed:!0}),a&&a(e)})),a(this,"handleMouseUpCallback",(e=>{const{layer:t,handleMouseUpCallback:a}=this.props;"text"===(null==t?void 0:t.type)&&KT(t.id,{beingTransformed:!1}),a&&a(e)})),a(this,"handleMouseDown",((e,{nodePosition:t})=>{const{x:a,y:o,width:n,height:r,handleExitEditorClick:i,canvasX:s,canvasY:l,handleMouseDownCallback:d,isBeingInlineCropped:c}=this.props;d&&d(e),e.stopPropagation();const[u,m]=wi(e);HW(e)&&(this.setIsResizing(!0),this.setState({resizing:!c,mouseStartX:u,mouseStartY:m,layerStartX:null!=a?a:s,layerStartY:null!=o?o:l,layerStartWidth:n,layerStartHeight:r,...!c&&{activeNodePosition:t}}),this.props.setNodePosition&&this.props.setNodePosition(t)),i()})),a(this,"handleMouseUp",(e=>{const{handleTransformFinish:t,handleMouseUpCallback:a}=this.props;HW(e)&&(this.setIsResizing(!1),this.setState({resizing:!1,mouseStartX:void 0,mouseStartY:void 0,layerStartX:void 0,layerStartY:void 0,layerStartWidth:void 0,layerStartHeight:void 0,activeNodePosition:void 0}),t("resize"),a&&a(e),this.props.setNodePosition&&this.props.setNodePosition(void 0))})),a(this,"handleMouseMove",(e=>{e.preventDefault();const{resizing:t}=this.state;e.which>1||t&&this.handleMouseMoveForResizing(e)})),a(this,"handleMouseMoveForResizing",(e=>{const{handleTransform:t,layers:a,lockAspectRatio:o,isBackgroundTransformer:n,canvasWidth:r,canvasHeight:i,shiftIsBeingPressed:s,forMovingZoomControls:l,rotation:d=0,textTemp:c,layer:u,hasPositionAffectingKeyframes:m}=this.props,{mouseStartX:p,mouseStartY:h,layerStartX:g,layerStartY:y,layerStartWidth:f,layerStartHeight:E,activeNodePosition:v}=this.state;if(!v)return;if(!r||!i)return;let w=g,b=y,_=f,T=E;const S=(g||0)+(f||0)/2,I=(y||0)+(E||0)/2,[x,k]=wi(e),C=x-(p||0),A=k-(h||0),N=Math.atan2(A,C),P=LW(C,A),R=N-OW(d||0),L=P*Math.cos(R),D=P*Math.sin(R),O={width:f||0,height:E||0,centerX:S,centerY:I,rotateAngle:d||0},F=["middleLeft","middleRight"].includes(v);let M=0;n||F||!o&&!s&&"text"!==(null==u?void 0:u.type)||(M=(f||0)/(E||1));let U=15,B=15;if((null==u?void 0:u.lockAspectRatio)&&(null==u?void 0:u.position)){const e=parseFloat(u.position.width)/100*r,t=parseFloat(u.position.height)/100*i;e>t?U=e*B/t:B=t*U/e}if(n){const e=cA(a),t=(e.right-e.left)/100*r,o=(e.bottom-e.top)/100*i;let n,s;switch(v){case"topLeft":n=r-e.right/100*r,s=i-e.bottom/100*i;break;case"topRight":n=e.left/100*r,s=i-e.bottom/100*i;break;case"bottomLeft":n=r-e.right/100*r,s=e.top/100*i;break;case"bottomRight":n=e.left/100*r,s=e.top/100*i;break;case"middleLeft":n=r-e.right/100*r,s=0;break;case"middleRight":n=e.left/100*r,s=0;break;default:n=0,s=0}t>U&&(U=t+n),o>B&&(B=o+s)}const W=WW(v,O,L,D,M,U,B);w=W.position.centerX-W.size.width/2,b=W.position.centerY-W.size.height/2,_=W.size.width,T=W.size.height;let V={x:w,y:b,width:_,height:T};if(m&&(V.x=S-_/2,V.y=I-T/2),n||l||!OA()||(d||0)%90!=0||(V=mX(V,d,v)),u&&Sd(u)&&F){w=V.x,b=V.y,_=V.width,T=V.height;const e=c||u.text||"",t=nV(u.baseWidth,f),a=(u.fontSize||1)/t,o=(u.lineHeight||1)*a,{textWithLineBreaks:n,minWidth:r}=sV(u,_,e,a),i=n.split("\n").length*o;_=Math.max(r,_),T=Math.max(r,i);const{width:s}=this.props;if(_===s)return;if(d){O.height=T;const e=WW(v,O,L,D,M,U,B);w=e.position.centerX-_/2,b=e.position.centerY-T/2}KT(u.id,{textTemp:n,fontSizingTemp:{fontSize:a,baseWidth:_,baseHeight:T}}),V={x:w,y:b,width:_,height:T}}t({...V,rotation:d},"resize"),a.forEach((e=>{KT(e.id,{inlineCropAspectRatio:null})}))})),a(this,"getNodeSize",(()=>{const{nodeSize:e}=this.props;let t=null!=e?e:18,a=null!=e?e:18;return Al()&&(t=22,a=22),{nodeWidth:t,nodeHeight:a}})),a(this,"getNodeStyles",(e=>{const{props:t}=this,{cornerBeingManipulated:a,x:o,y:n,width:r,height:i,layer:s,isBackgroundTransformer:l,isSelected:d,isBoxSelected:c,hasPositionAffectingKeyframes:u}=t,m=t.rotation||0;let{nodeWidth:p,nodeHeight:h}=this.getNodeSize();(p>r||h>i)&&(p/=2,h/=2);const g={width:p,height:h,display:"",zIndex:7};u&&(g.backgroundColor="white",g.borderColor="#0083E2"),(l||d||c||"ghost"===(null==s?void 0:s.id))&&!a||(g.display="none");let y,f,E=o,v=n;const w=m*Math.PI/180,b=o+r/2,_=n+i/2;switch(e){case"topLeft":return y=(o-b)*Math.cos(w)-(n-_)*Math.sin(w)+b,f=(o-b)*Math.sin(w)+(n-_)*Math.cos(w)+_,E=y-p/2,v=f-h/2,{top:v,left:E,...g};case"topRight":return E+=r,y=(E-b)*Math.cos(w)-(v-_)*Math.sin(w)+b,f=(E-b)*Math.sin(w)+(v-_)*Math.cos(w)+_,E=y-p/2,v=f-h/2,{top:v,left:E,...g};case"bottomLeft":return v+=i,y=(E-b)*Math.cos(w)-(v-_)*Math.sin(w)+b,f=(E-b)*Math.sin(w)+(v-_)*Math.cos(w)+_,E=y-p/2,v=f-h/2,{top:v,left:E,...g};case"bottomRight":return E+=r,v+=i,y=(E-b)*Math.cos(w)-(v-_)*Math.sin(w)+b,f=(E-b)*Math.sin(w)+(v-_)*Math.cos(w)+_,E=y-p/2,v=f-h/2,{top:v,left:E,...g};case"middleLeft":{if(v+=i/2,h=i-p,h<p&&(h=i),!Al()&&h>i){const e=p/h;h=i,p=i*e}y=(E-b)*Math.cos(w)-(v-_)*Math.sin(w)+b,f=(E-b)*Math.sin(w)+(v-_)*Math.cos(w)+_,E=y-p/2,v=f-h/2;let e=0;return Al()&&(e=p/4),{top:v,left:E-e,...g,height:h,width:p+e+e,transform:`rotate(${m}deg)`,backgroundColor:void 0}}case"middleRight":{if(E+=r,v+=i/2,h=i-p,h<p&&(h=i),!Al()&&h>i){const e=p/h;h=i,p=i*e}y=(E-b)*Math.cos(w)-(v-_)*Math.sin(w)+b,f=(E-b)*Math.sin(w)+(v-_)*Math.cos(w)+_,E=y-p/2,v=f-h/2;let e=0;return Al()&&(e=p/4),{top:v,left:E-e,...g,height:h,width:p+e+e,transform:`rotate(${m}deg)`,backgroundColor:void 0}}default:return g}})),a(this,"getNodeClassNames",(e=>{const{isSelected:t,isBackgroundTransformer:a,width:o,height:n,layer:r}=this.props,{activeNodePosition:i}=this.state,{nodeWidth:s,nodeHeight:l}=this.getNodeSize();let d=`${hX.transformerNode} `;switch(e){case"topLeft":d+=hX.transformerNodeTopLeft;break;case"topRight":d+=hX.transformerNodeTopRight;break;case"bottomLeft":d+=hX.transformerNodeBottomLeft;break;case"bottomRight":d+=hX.transformerNodeBottomRight;break;case"middleLeft":d=`${hX.middleTransformerNodeContainer} ${hX.transformerNodeMiddleLeft}`;break;case"middleRight":d=`${hX.middleTransformerNodeContainer} ${hX.transformerNodeMiddleRight}`;break;default:throw new Error("Improper NodePosition supplied")}if((a||t)&&(d+=` ${hX.selectedTransformer}`),r&&Sd(r)){const t=2*s,a=2.5*l,r=o<t||n<a,c=n<t,u=!["topLeft","middleRight"].includes(e)&&r,m=i&&i===e;(i?!m:u)&&(d+=c||i&&!m?` ${hX.hide}`:` ${hX.transformerNodeHideUntilHover}`)}return d})),a(this,"getOverlayStyles",(e=>{const{x:t,y:a,canvasX:o,canvasY:n,canvasWidth:r,canvasHeight:i,width:s,height:l,canvasBackground:d}=this.props,{activeNodePosition:c}=this.state,u="#252935";let m,p=d.includes("#")?d:void 0;if(!c||!r||!i)return{};switch(e){case"top":if(a>n&&(p=u),!c.includes("top"))return{};m={left:t>o?o:t,top:a>n?n:a,width:s>r?s:r,height:Math.abs(l-i),background:p};break;case"left":if(t>o&&(p=u),!c.includes("Left"))return{};m={left:t>o?o:t,top:"topLeft"!==c&&a>n&&t>o?n:a,width:Math.abs(s-r),height:"topLeft"===c||i<l?l:i,background:p};break;case"bottom":if(l<i&&(p=u),!c.includes("bottom"))return{};m={left:t,top:i>l?l+n:i+n,height:Math.abs(l-i),width:"bottomLeft"===c||r<s?s:r,background:p};break;case"right":if(s<r&&(p=u),!c.includes("Right"))return{};m={left:r>s?s+o:r+o,top:a,width:Math.abs(s-r),height:l,background:p};break;default:throw new Error("Improper NodePosition supplied")}return{left:`${m.left}px`,top:`${m.top}px`,width:`${m.width}px`,height:`${m.height}px`,background:m.background}})),a(this,"getPresentUserStyles",(e=>{var t,a;const{x:o,y:n,width:r,height:i,rotation:s,presence:l}=this.props,d=o+r/2,c=n+i/2,u=i/2+20,m=s*Math.PI/180;let p=d+u*Math.sin(m);const h=c-u*Math.cos(m);p-=r/2;const g=null==(t=this.presenceRef.current)?void 0:t.getBoundingClientRect(),y=(null==g?void 0:g.height)&&(null==g?void 0:g.height)>25?g.height/2:0;return{color:null==(a=l[e])?void 0:a.color,margin:"auto",top:h-y,left:p,padding:"2px",width:r,transform:`rotate(${s}deg)`}})),a(this,"handleContextMenu",(e=>{const{layer:t}=this.props;t?Iq(e,t.id):Cq(e)})),a(this,"renderTransformerNodes",(()=>{const{visibleNodes:e,hasPositionAffectingKeyframes:t}=this.props,{activeNodePosition:a}=this.state;return e.map((e=>{const o=["middleLeft","middleRight"].includes(e),n=this.getNodeStyles(e),r=a===e;return i.createElement("div",{key:e,className:this.getNodeClassNames(e),"data-cy":`${e}-transformer-node`,style:n,onTouchStart:t=>this.handleMouseDown(t,{nodePosition:e}),onTouchEnd:e=>this.handleMouseUp(e),onMouseDown:t=>this.handleMouseDown(t,{nodePosition:e}),onMouseUp:e=>this.handleMouseUp(e)},o&&i.createElement("div",{className:r?hX.middleTransformerNodeActive:hX.middleTransformerNode,style:{backgroundColor:t?"white":void 0,borderColor:t?"#0083E2":void 0,width:Number(n.width)/(Al()?2.5:1.5),height:Math.min(Number(n.width)*(Al()?1:1.5),Number(n.height))}}))}))})),a(this,"renderDragHandler",(()=>{var e;const{isBoxSelected:t,isSelected:a,layer:o,groupId:n,presence:r}=this.props,s=jf(r,null==o?void 0:o.id);return i.createElement(EX,{backgroundColor:this.props.backgroundColor,groupId:n,handleDoubleClick:this.props.handleDoubleClick,handleExitEditorClick:this.props.handleExitEditorClick,handleMouseDownCallback:this.handleMouseDownCallback,handleMouseUpCallback:this.handleMouseUpCallback,handleTransform:this.props.handleTransform,handleTransformFinish:this.props.handleTransformFinish,height:this.props.height,isBackgroundTransformer:!!this.props.isBackgroundTransformer,isGhostTransformer:"ghost"===(null==(e=this.props.layer)?void 0:e.id),isSelected:a,isBoxSelected:t,layer:this.props.layer,presentUser:s,rotation:this.props.rotation,transformerText:this.props.transformerText,viewOnly:this.props.viewOnly,width:this.props.width,x:this.props.x,y:this.props.y,zIndex:this.props.zIndex})})),this.state={resizing:!1},this.presenceRef=r.exports.createRef(),this.transformerContainerRef=r.exports.createRef()}componentDidUpdate(e,t){const{resizing:a}=this.state;a&&!t.resizing?(document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp),document.addEventListener("touchmove",this.handleMouseMove,{passive:!1}),document.addEventListener("touchend",this.handleMouseUp)):!a&&t.resizing&&(document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("touchmove",this.handleMouseMove),document.removeEventListener("touchend",this.handleMouseUp))}componentWillUnmount(){document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("touchmove",this.handleMouseMove),document.removeEventListener("touchend",this.handleMouseUp),this.setIsResizing(!1)}setIsResizing(e){const{layer:t,setResizing:a}=this.props;if(a(e),t){const a={beingTransformed:e};KT(t.id,a)}}renderPresentUserSelection(){var e;const{layer:t,presence:a,presentUserId:o}=this.props,n=jf(a,null==t?void 0:t.id);return n&&n!==o?i.createElement("div",{ref:this.presenceRef,className:hX.presentUserTag,style:this.getPresentUserStyles(n)},null==(e=a[n])?void 0:e.name):null}render(){const{canvasBackground:e,groupId:t,isBackgroundTransformer:a,isCollaborating:o,isSelected:n,presence:r,selectedItemIsALayer:s,layerIsDeselectedInGroup:l}=this.props;return this.props.forMovingZoomControls?i.createElement(i.Fragment,null,this.renderTransformerNodes(),this.renderDragHandler()):!t||s||l?i.createElement(Wq,{onContextMenu:this.handleContextMenu},i.createElement("div",{onDragEnter:Dq,onDoubleClick:()=>{a||this.props.layer&&(this.props.layer.type!==ln.Image&&this.props.layer.type!==ln.Video||n&&this.props.setIsInlineCropping(this.props.layer.id,"Double Click"))},ref:this.transformerContainerRef},a&&RW.map((t=>i.createElement("div",{key:`transformerOverlay${t}`,style:this.getOverlayStyles(t),className:hX.transformerBackgroundOverlay+(e.includes("#")?"":` ${hX.transformerBackgroundOverlayTransparent}`)}))),!a&&n&&!this.props.isBeingInlineCropped&&i.createElement(wX,{handleTransform:this.props.handleTransform,handleTransformFinish:this.props.handleTransformFinish,handleMouseDownCallback:this.handleMouseDownCallback,handleMouseUpCallback:this.handleMouseUpCallback,height:this.props.height,width:this.props.width,x:this.props.x,y:this.props.y,rotation:this.props.rotation}),!this.props.isBeingInlineCropped&&this.renderDragHandler(),o&&r&&this.renderPresentUserSelection(),!this.props.isBeingInlineCropped&&this.renderTransformerNodes())):null}}const _X=m.exports.connect(((e,t)=>{var a,o,n,r,i,s,l,d,c;const{scenes:u}=e.studio,m=t.layer?null==(a=Object.entries(e.studio.groups).find((([e,a])=>{var o;return a.layers.map((e=>e.id)).includes((null==(o=t.layer)?void 0:o.id)||"")})))?void 0:a[0]:null,p=m&&t.layer&&(null==(n=null==(o=e.studio.groups[m])?void 0:o.layers.find((e=>{var a;return e.id===(null==(a=t.layer)?void 0:a.id)})))?void 0:n.deselected),{textTemp:h,borderRadiusTemp:g,textPaddingTemp:y}=ul(e,(null==(r=t.layer)?void 0:r.id)||""),f=!(!g&&"number"!=typeof y),E=!m&&qI((null==(i=t.layer)?void 0:i.id)||"",Sn.POSITION),v=!m&&qI((null==(s=t.layer)?void 0:s.id)||"",Sn.ZOOM);return{canvasBackground:u[0].background,canvasHeight:e.studio.height,canvasWidth:e.studio.width,canvasX:e.studio.canvasX,canvasY:e.studio.canvasY,groupId:m,layerIsDeselectedInGroup:p,groups:e.studio.groups,isBeingInlineCropped:(null==(d=e.studioLocal.layerTempValues[(null==(l=t.layer)?void 0:l.id)||""])?void 0:d.isBeingInlineCropped)||!1,layers:u[0].layers,cornerBeingManipulated:f,selectedItem:e.studio.selectedItem,selectedItemIsALayer:"layer"===(null==(c=e.studio.selectedItem)?void 0:c.type),shiftIsBeingPressed:e.studioLocal.shiftIsBeingPressed,isCollaborating:e.studio.isCollaborating,presence:e.studio.presence,presentUserId:e.studio.presentUserId,textTemp:h,hasPositionKeyframes:E,hasZoomKeyframes:v,hasPositionAffectingKeyframes:E||v}}),(e=>me({setResizing:H_,setStudioDragDropActive:og,setIsInlineCropping:Jh},e)))(bX);class TX extends r.exports.Component{constructor(e){super(e),a(this,"handleMouseDown",((e,t)=>{const{x:a,y:o,width:n,height:r,handleExitEditorClick:i,layer:s,canvasHeight:l}=this.props,{lineWidth:d}=s,[c,u,m,p]=GW(s.linePointStartCorner,n,r,parseFloat(d)/100*l),[h,g]=wi(e);HW(e)&&this.setState({resizing:!0,mouseStartX:h,mouseStartY:g,nodePosition:t,x:a,y:o,width:n,height:r,start:{x:a+c,y:o+u},end:{x:a+m,y:o+p},initialStartCorner:s.linePointStartCorner}),i()})),a(this,"handleMouseUp",(e=>{const{handleTransformFinish:t}=this.props;HW(e)&&(this.setState({resizing:!1,mouseMove:!1}),t())})),a(this,"calculateNewPosition",((e,t,a=0,o=0)=>{const{nodePosition:n,start:r,end:i,x:s,y:l,width:d,height:c,initialStartCorner:u}=this.state;let m=s,p=l,h=d,g=c;const y=(e=>{const t={topLeft:e[0]<=e[2]&&e[1]<=e[3],bottomLeft:e[0]<=e[2]&&e[1]>=e[3],topRight:e[0]>=e[2]&&e[1]<=e[3],bottomRight:e[0]>=e[2]&&e[1]>=e[3]};return PW.find((e=>!0===t[e]))||"topLeft"})([r.x,r.y,i.x,i.y]);if(this.setState({linePointStartCorner:y}),"topLeft"===u)switch(n){case"start":m=s+a,p=l+o,h=d-a,g=c-o,this.setState({start:{x:m,y:p}});break;case"end":h=d+a-e,g=c+o-e,this.setState({end:{x:h+s,y:g+l}})}if("bottomRight"===u)switch(n){case"end":m=s+a,p=l+o,h=d-a-t,g=c-o-t,this.setState({end:{x:m,y:p}});break;case"start":h=d+a-e,g=c+o-e,this.setState({start:{x:h+s,y:g+l}})}if("bottomLeft"===u)switch(n){case"start":m=s+a,p=l+o,h=d-a,g=c-o-e,this.setState({start:{x:m,y:g+p+o}});break;case"end":h=d+a-e,g=c+o,this.setState({end:{x:h+s,y:p+o}})}if("topRight"===u)switch(n){case"start":m=s+a,p=l+o,h=d-a-e,g=c+o,this.setState({start:{x:h+m+a,y:p}});break;case"end":m=s+a,h=d+a,g=c+o-e,this.setState({end:{x:m,y:g+l}})}return{x:m,y:p,width:h,height:g,linePointStartCorner:y}})),a(this,"handleMouseMove",(e=>{const{handleTransform:t,layer:a,canvasHeight:o}=this.props,{mouseStartX:n,mouseStartY:r,resizing:i,start:s,end:l,nodePosition:d}=this.state;if(!i)return;if(e.which>1)return;this.setState({mouseMove:!0});const[c,u]=wi(e),{lineWidth:m}=a,p=parseFloat(m)/100*o,h=p/2,g=c-n,y=u-r,f=this.calculateNewPosition(p,h,g,y),{linePointStartCorner:E}=f;let v=f.x,w=f.y,b=f.width,_=f.height,T=[];switch(E){case"topLeft":v=s.x+h,w=s.y+h,b=l.x-s.x+h,_=l.y-s.y+h,T=[0,0,b-h,_-h];break;case"topRight":v=l.x+h,w=s.y+h,b=s.x-l.x+h,_=l.y-s.y+h,T=[b-h,0,0,_-h];break;case"bottomLeft":v=s.x+h,w=l.y+h,b=l.x-s.x+h,_=s.y-l.y+h,T=[0,_-h,b-h,0];break;case"bottomRight":v=l.x+h,w=l.y+h,b=s.x-l.x+h,_=s.y-l.y+h,T=[b-h,_-h,0,0]}const[S,I,x,k]=T,C=Math.atan2(x-S,k-I)/Math.PI*180;let A="";const N=OA();if(N){const e=((e,t,a,o,n,r,i,s,l,d)=>{let c=n,u=r,m=i,p=s,h=l;const g=o=>"start"===e?a[o]:t[o],y=g("x"),f=g("y");let E=o;const v=E-45*Math.floor(E/45);v>=41?E+=45-v:v<=4&&(E-=v);(Math.abs(E)<1||Math.abs(E)>359)&&(E=0);let w="";switch(E){case 0:c=y+d,m=d,h=[0,0,0,p-d],w="vertical";break;case 90:u=f+d,p=d,h=[0,0,m-d,0],w="horizontal";break;case-90:u=f+d,p=d,h=[m-d,0,0,0],w="horizontal";break;case 180:case-180:c=y+d,m=d,h=[0,p-d,0,0],w="vertical"}return{x:c,y:u,width:m,height:p,points:h,lineRightAngle:w}})(d,s,l,C,v,w,b,_,T,h);v=e.x,w=e.y,b=e.width,_=e.height,T=e.points,A=e.lineRightAngle}let P={x:v-h,y:w-h,width:b+h,height:_+h,points:T,lineResizing:!0,linePointStartCorner:E,lineRightAngle:A,lineWidth:p};N&&(P=(e=>{const{linePointStartCorner:t,lineWidth:a,lineRightAngle:o}=e,{x:n,y:r,width:i,height:s}=mX(e),l=GW(t,i,s,a);return{...e,x:n,y:r,width:"vertical"===o||i<a?a:i,height:"horizontal"===o||s<a?a:s,points:l}})(P)),t(P),e.preventDefault()})),a(this,"getNodeStyles",(e=>{const{x:t,y:a,width:o,height:n,selectedLayerId:r,layer:i,canvasHeight:s,boxSelectedIds:l}=this.props,{linePointStartCorner:d,mouseMove:c}=this.state;let u=18,m=18;Al()&&(u=22,m=22);const p={width:u,height:m},h=r===i.id,{lineWidth:g}=i,y=parseFloat(g)/100*s,f=y/2,[E,v,w,b]=GW(c?d:i.linePointStartCorner,o,n,y);switch(h||l[i.id]||(p.display="none"),e){case"start":return{left:t+E+f-u/2,top:a+v+f-m/2,...p};case"end":return{left:t+w+f-u/2,top:a+b+f-m/2,...p};default:return p}})),this.state={resizing:!1,start:{x:0,y:0},end:{x:0,y:0},nodePosition:"",linePointStartCorner:"topLeft"}}componentDidMount(){const{x:e,y:t,width:a,height:o,layer:n}=this.props,{linePointStartCorner:r}=n;this.setState({x:e,y:t,width:a,height:o,linePointStartCorner:r||"topLeft",mouseMove:!1})}componentDidUpdate(e,t){this.state.resizing&&!t.resizing?(document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp),document.addEventListener("touchmove",this.handleMouseMove,{passive:!1}),document.addEventListener("touchend",this.handleMouseUp)):!this.state.resizing&&t.resizing&&(document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),document.addEventListener("touchmove",this.handleMouseMove,{passive:!1}),document.addEventListener("touchend",this.handleMouseUp))}render(){var e;const{selectedLayerId:t,layer:a,groups:o,boxSelectedIds:n,presence:r}=this.props,s=t===a.id,l=a?null==(e=Object.entries(o).find((([e,t])=>t.layers.map((e=>e.id)).includes(a.id))))?void 0:e[0]:null,d=jf(r,null==a?void 0:a.id);return i.createElement("div",{style:{display:"block"}},i.createElement(EX,{groupId:l,handleExitEditorClick:this.props.handleExitEditorClick,handleMouseDownCallback:this.props.handleMouseDownCallback,handleMouseUpCallback:this.props.handleMouseUpCallback,handleTransform:this.props.handleTransform,handleTransformFinish:this.props.handleTransformFinish,height:this.props.height,isBackgroundTransformer:this.props.isBackgroundTransformer,isSelected:a.id===t,isBoxSelected:!!n[a.id],layer:this.props.layer,presentUser:d,rotation:this.props.rotation,viewOnly:this.props.viewOnly,width:this.props.width,x:this.props.x,y:this.props.y}),["start","end"].map(((e,t)=>i.createElement("div",{key:t,className:`${hX.transformerNode} ${s?hX.selectedTransformer:""}`,style:this.getNodeStyles(e),onTouchStart:t=>this.handleMouseDown(t,e),onTouchEnd:this.handleMouseUp,onMouseDown:t=>this.handleMouseDown(t,e),onMouseUp:this.handleMouseUp}))))}}const SX=m.exports.connect((e=>{var t;return{selectedLayerId:(null==(t=e.studio.selectedItem)?void 0:t.id)||"",boxSelectedIds:e.studioLocal.boxSelectedIds,groups:e.studio.groups,presence:e.studio.presence}}))(TX),IX=({layer:e,widthAndHeight:t,videoWidthAndHeight:a,keyframeChannels:o})=>{const n=r.exports.useRef(),s=r.exports.useRef(null),l=_T(),d=tr((t=>{var a;return null==(a=t.studioLocal.layerTempValues[e.id])?void 0:a.filters}),ar),c=tr((t=>gl(t,e.id))),u=r.exports.useMemo((()=>{const n=jI(e,l,c),r=RK(n,t,a,kI(e)),{width:i,height:s}=LK(t,a),u=fK(r,i,s);return PK({...e,filters:d||e.filters},!1,!1,u,t[0],t[1],o,l)}),[e,t,a,l,c,o,d]),p=m.exports.useDispatch();return r.exports.useEffect((function(){return n.current=new MutationObserver((t=>{for(const a of t)"childList"===a.type&&s.current&&KT(e.id,{layerRef:s.current.children[0]})})),()=>{var e;null==(e=n.current)||e.disconnect()}}),[p,e.id]),i.createElement(gY,{layer:e,style:u},i.createElement("div",{id:`EPContainer_${e.id}`,"data-cy":"ep-container",ref:t=>{var a,o;s.current=t,(null==t?void 0:t.children[0])&&KT(e.id,{layerRef:t.children[0]}),t?null==(a=n.current)||a.observe(t,{childList:!0}):null==(o=n.current)||o.disconnect()}}))};class xX extends r.exports.Component{constructor(e){super(e),a(this,"resizeLockRatioLayer",(e=>{const{layer:t,resizeLayer:a,convertPositionToPercent:o=lS,convertSizeToPercent:n=nS}=this.props;this.setLayerAbsolutePosition({...e});const{xPercent:r,yPercent:i}=o(e.x,e.y),{widthPercent:s,heightPercent:l}=n(e.width,e.height);KT(t.id,{positionTemp:null}),a(t,r,i,s,l)})),a(this,"updateLayerAnimationPosition",(e=>{s.exports.isEqual(this.state.layerAnimationPosition,e)||this.setState({layerAnimationPosition:e||null})})),a(this,"rotateGroupedLayer",(()=>{const{layerAbsolutePosition:e}=this.state;if(!this.props.groupInfo||!e)return;const{groupInitialPosition:t,groupAbsolutePosition:a}=this.props.groupInfo,o=this.getAbsolutePositionFromLayer(),{newX:n,newY:r,layerRotation:i}=jW(o,a,t);this.setLayerAbsolutePosition({...e,x:n,y:r,rotation:i})})),a(this,"resizeGroupedLayer",(()=>{const{layerAbsolutePosition:e}=this.state;if(!this.props.groupInfo||!e)return;const{groupInitialPosition:t,groupTransformerNode:a,groupAbsolutePosition:o}=this.props.groupInfo,n=this.getAbsolutePositionFromLayer(),r=VW(n,o,t,a);this.setLayerAbsolutePosition({...e,...r})})),a(this,"getAbsolutePositionFromLayer",(()=>{const{layer:e,getLayerPositionAndSize:t=cS}=this.props,a=t(e);if(!a)throw Error(`Could not get position for layer ${e.id}`);return w({category:"Studio Layer Mounted",message:`Layer: ${e.id}`}),"ellipse"===e.shapeType&&(a.x-=a.width/2,a.y-=a.height/2),a})),a(this,"setLayerAbsolutePosition",(e=>{this.setState({layerAbsolutePosition:e})})),a(this,"saveLayerPosition",Jl.withUndoBatch((()=>{var e;const{layerAbsolutePosition:t}=this.state,{resizeLayer:a,resizeLineLayer:o,setRotation:n,layer:r,setScale:i,convertPositionToPercent:s=lS,convertSizeToPercent:l=nS,keyframeChannels:d,studioTime:c,canvasWidth:u,canvasHeight:m}=this.props,p=rx(r,d,c,u||0,m||0);if(!t)return;let{xPercent:h,yPercent:g}=s(t.x,t.y);const{widthPercent:y,heightPercent:f}=l(t.width,t.height),E=r.position&&p.width!==y||r.position&&p.height!==f,v=r.position&&p.x!==h||r.position&&p.y!==g||E;if("ellipse"===r.shapeType&&(h=`${parseFloat(h)+parseFloat(y)/2}%`,g=`${parseFloat(g)+parseFloat(f)/2}%`),Id(r)&&"svg"===r.shapeType){i(r,t.width/r.position.svg_width,t.height/r.position.svg_height)}if(E&&(e=>{var t;const{state:a}=tn(),o=Jw(e,a.studio);if(!o)return void console.error("Could not find layer to add cross transition to");if((null==(t=o.keyframeAnimation)?void 0:t.id)!==WI.id)return;const{height:n,width:r}=o,{scaledHeight:i,scaledWidth:s}=TB(r,n),l={width:s,height:i,x:0,y:0,rotation:0},d=(e,t=l)=>{const{width:a,height:o}=t;return{topLeft:{x:e.x/a,y:e.y/o},bottomRight:{x:(e.x+e.width)/a,y:(e.y+e.height)/o}}},c=l,u=((e,t=l)=>{const{x:a,y:o}=e.topLeft,{x:n,y:r}=e.bottomRight,{width:i,height:s}=t;return{x:a*i,y:o*s,width:(n-a)*i,height:(r-o)*s,rotation:0}})(VI[0].transitions[0].endValues,l),m=d(c,l),p=d(u,l),h=o.keyframeAnimation,g=h.transitions[0];h&&g&&EB(o,{startValues:m,endValues:p})})(r.id),Id(r)&&r.shapeType&&["line","arrow"].includes(r.shapeType)&&v)return o(r,h,g,y,f,t.linePointStartCorner,t.lineRightAngle,!0),void n(r,t.rotation);if(KT(r.id,{positionTemp:null}),qI(r.id,Sn.ZOOM)){const{getLayerPositionAndSize:e=cS,canvasWidth:a=0,canvasHeight:o=0,canvasX:n,canvasY:i}=this.props,s=e(r);if(!s)return;const l=t.x+t.width/2-n,d=t.y+t.height/2-i,c=l-s.width/2,u=d-s.height/2,m={...r.position,x:c/a*100+"%",y:u/o*100+"%"};px({[r.id]:{position:m}},!0)}else a(r,h,g,y,f,!!r.position&&!!v);(null==(e=r.position)?void 0:e.rotation)!==t.rotation&&n(r,t.rotation,!0)}))),a(this,"handleTransform",((e,t)=>{const{layerAnimationPosition:a}=this.state,{studioPaused:o,layer:n,canvasWidth:r,canvasHeight:i}=this.props,{layerAbsolutePosition:s}=this.state,l=w_(n);o&&a&&"vibrate"===(null==l?void 0:l.id)&&null!=e.x&&null!=e.y&&(e.x-=a.x,e.y-=a.y),s&&this.setLayerAbsolutePosition({...s,...e}),"ellipse"===n.shapeType&&e.x&&e.y&&(e.x+=(e.width||0)/2,e.y+=(e.height||0)/2);const d=TS({...n,position:bS(e)},r||0,i||0);KT(n.id,{tempDisplayPosition:d}),this.setState({transformSource:t,transforming:!0})})),a(this,"handleTransformFinish",(()=>{const{showSnapLines:e,layer:t}=this.props;Jl.execInUndoBatch((()=>{this.addApplicableKeyframes(),"text"!==t.type&&this.saveLayerPosition()})),e({}),this.setState({transformSource:void 0,transforming:!1}),KT(t.id,{tempDisplayPosition:void 0})})),a(this,"handleEditorDoubleClick",(()=>{const{layer:e,viewOnly:t,isEditing:a}=this.props;t||a||Td(e)||(uV(e),$A())})),a(this,"handleDoubleClick",(()=>{const{viewOnly:e,layer:t,isEditing:a,selectedItem:o,groupIDForLayer:n}=this.props;(null==o?void 0:o.id)!==t.id&&n?this.contextualSelectLayer({id:t.id,type:"layer"}):Td(t)?this.setState({showTTSWarningOverlay:!0}):e||a||!Sd(t)||(uV(t),$A())})),a(this,"handleExitEditorClick",(()=>{const{layer:e,viewOnly:t}=this.props,{layerAbsolutePosition:a}=this.state;!t&&a&&cV(e,e.text)})),a(this,"contextualSelectLayer",(e=>{const{selectItem:t}=this.props;t(e)})),a(this,"handleMouseDown",(e=>{const{layer:t,selectedItem:a,groupIDForLayer:o}=this.props;(e.shiftKey||e.metaKey)&&"background"!==(null==a?void 0:a.id)&&""!==(null==a?void 0:a.id)&&t?o?VV({layerId:t.id,groupId:o,deselected:!1,undoable:!0}):bV(t.id,{isUndoable:!0,isTimelineGroup:!1}):t&&(null==a?void 0:a.id)!==t.id&&(o||this.contextualSelectLayer({id:t.id,type:"layer"}))})),a(this,"setNodePosition",(e=>{this.setState({nodePosition:e})})),a(this,"addApplicableKeyframes",(()=>{const{layer:e,convertPositionToPercent:t=lS}=this.props,{layerAbsolutePosition:a}=this.state;if(!e.position)return;const o=qI(e.id,Sn.ZOOM);if("resize"===this.state.transformSource&&o){const t=e.zoom||100,{width:o}=eS(e.position.width,e.position.height),n=a.width*t/o;QI({...e,zoom:n})}if("drag"===this.state.transformSource&&qI(e.id,Sn.POSITION)){"ellipse"===e.shapeType&&(a.x+=a.width/2,a.y+=a.height/2);let n=a.x,r=a.y;if(o){const t=a.x+a.width/2,o=a.y+a.height/2,{width:i,height:s}=eS(e.position.width,e.position.height);n=t-i/2,r=o-s/2}const{xPercent:i,yPercent:s}=t(n,r);JI({...e,position:{...e.position,x:i,y:s}})}})),a(this,"getKeyframedAbsolutePosition",(()=>{const{layer:e,getLayerPositionAndSize:t=cS,groupInfo:a,keyframeChannels:o,studioTime:n,canvasWidth:r,canvasHeight:i}=this.props,{layerAbsolutePosition:s,transforming:l}=this.state;let d={...s};if(!l&&XI(e.id)){const s=rx(e,o,n,r||0,i||0),l=t({...e,position:s});if(l&&"ellipse"===e.shapeType&&(l.x-=l.width/2,l.y-=l.height/2),d={...d,...l},a&&a.groupResizing){const{groupInitialPosition:e,groupAbsolutePosition:t}=a,o=t.width/e.width,n=d.x-e.x,r=d.y-e.y;d.x=t.x+n*o,d.y=t.y+r*o,d.width*=o,d.height*=o}}return d})),a(this,"renderLayer",(e=>{var t,a;const{staticPreview:o,layer:n}=this.props,{id:r,type:l}=n;if("ghost"===r)return i.createElement(K$,{key:`layer-${r}`,...e});switch((l||"").toLowerCase()){case"text":{const t={...e};return t.layer=s.exports.cloneDeep(e.layer),t.layer.videoDelay=t.layer.startTime,t.layer.startTime=0,t.layer.endTime=t.layer.duration,t.layer.type="audio",i.createElement(i.Fragment,{key:`layer-${r}`},i.createElement(Xj,{...e,nodePosition:this.state.nodePosition}),Td(n)&&i.createElement(tq,{...t}))}case"video":case"audio":{const o=(({layer:e,width:t,height:a,x:o,y:n,rotation:r,isBeingInlineCropped:i,borderRadiusTemp:s})=>{if("audio"===e.type&&!e.isAudiogram&&!e.requireConversion)return{opacity:0};const l=JB(null!=s?s:null,e,t,a);let d={x:"",y:""};e.position&&e.position.flip&&(d={x:e.position.flip.x?" scaleX(-1)":"",y:e.position.flip.y?" scaleY(-1)":""});let c=r;return 0!==l&&r%90==0&&0!==r&&(c+=1e-5),{position:"absolute",left:o,top:n,width:t,height:a,overflow:i?"visible":"hidden",zIndex:i?4:"auto",transform:`rotate(${c}deg) ${d.x}${d.y}`,opacity:1,borderRadius:`${l}px`}})({layer:e.layer,width:e.width,height:e.height,x:e.x,y:e.y,rotation:e.rotation,isBeingInlineCropped:this.props.isBeingInlineCropped,borderRadiusTemp:null!=(t=this.props.borderRadiusTemp)?t:null}),n="audio"===e.layer.type?{}:$$(e,null!=(a=this.props.borderRadiusTemp)?a:null);return i.createElement("div",null,i.createElement("div",{"data-cy":`video-layer-container-${o.opacity}`,className:jj.videoContainer,style:o,"data-testid":`video-layer-container-${r}`},(()=>{const t={...e,width:e.width,height:e.height};return e.staticPreview||!NT(e.layer)?i.createElement(tq,{key:`layer-${r}`,...t}):i.createElement(IX,{widthAndHeight:[t.width,t.height],videoWidthAndHeight:[e.layer.width,e.layer.height],layer:e.layer,keyframeChannels:this.props.keyframeChannels})})()),i.createElement("div",{style:n,className:jj.outline,onClick:()=>{this.props.selectItem(null)}}))}case"image":{const t={...e};return t.waitingForSeekToResolve=this.props.waitingForSeekToResolve,i.createElement(wK,{key:`layer-${r}`,...t})}case"shape":return i.createElement(yq,{key:`layer-${r}`,...e});case"subtitle":return o?null:i.createElement(Z$,{key:`layer-${r}`,...e});case"placeholder":return i.createElement(bq,{key:`layer-${r}`,...e});default:return null}})),a(this,"renderTransformer",((e,t)=>{var a;const{eyedropperMode:o,isShownAtStudioTime:n,layer:r,viewOnly:s,selectedItem:l,boxSelectedIds:d}=this.props,c=`layer-${r.id}-transformer`;if("ghost"!==r.id){if("audio"===r.type&&!r.isAudiogram)return null;if(s||o)return null;if(!mT())return null}if(r.shapeType&&["line","arrow"].includes(r.shapeType)&&0===(null==(a=r.position)?void 0:a.rotation))return i.createElement(SX,{key:c,canvasHeight:this.props.canvasHeight,handleExitEditorClick:this.handleExitEditorClick,handleTransform:this.handleTransform,handleTransformFinish:this.handleTransformFinish,height:this.state.layerAbsolutePosition.height,width:this.state.layerAbsolutePosition.width,x:e,y:t,rotation:this.state.layerAbsolutePosition.rotation,isBackgroundTransformer:!1,layer:this.props.layer,viewOnly:this.props.viewOnly,handleMouseDownCallback:this.handleMouseDown});const u="ghost"===r.id,m=n||u,p=r.id===(null==l?void 0:l.id),h=!!d[r.id],g=this.getKeyframedAbsolutePosition(),y=Sd(r)?PW:AW;return i.createElement("div",{onClick:()=>{this.props.setSelectedEditorPane("canvas")}},m&&i.createElement(_X,{key:c,handleDoubleClick:this.handleDoubleClick,handleExitEditorClick:this.handleExitEditorClick,setNodePosition:this.setNodePosition,handleTransform:this.handleTransform,handleTransformFinish:this.handleTransformFinish,isSelected:p,isBoxSelected:h,width:g.width,height:g.height,x:e,y:t,rotation:g.rotation,isBackgroundTransformer:!1,layer:this.props.layer,viewOnly:this.props.viewOnly,handleMouseDownCallback:this.handleMouseDown,lockAspectRatio:r.lockAspectRatio,visibleNodes:y}))}));const t=this.getAbsolutePositionFromLayer();this.state={layerAbsolutePosition:t,layerAnimationPosition:null,showTTSWarningOverlay:!1,studioTimeState:e.studioTime,transformSource:void 0,transforming:!1}}static getDerivedStateFromProps(e,t){const{studioTime:a}=e,{studioTimeState:o}=t;return o===a?null:{studioTimeState:a}}shouldComponentUpdate(e,t){const a={...e},o={...this.props};delete a.studioTime,delete o.studioTime;return!s.exports.isEqual(a,o)||!s.exports.isEqual(t,this.state)}componentDidUpdate(e){const{canvasPreviewWidth:t,canvasPreviewHeight:a,canvasWidth:o,canvasHeight:n,containerWidth:r,containerHeight:i,fitToCenter:s,groupInfo:l,layer:d,layers:c,previewOriginalDimensions:u,viewOnly:m,didDrop:p,item:h,dropResult:g,mIGhostLayerAbsolutePosition:y}=this.props;if(u&&u[0]&&u[1]&&t&&a&&"subtitle"!==d.type)return void(e.canvasPreviewWidth===t&&e.canvasPreviewHeight===a&&e.fitToCenter===s||(fS(c||[],u[0],u[1],t,a)?this.setLayerAbsolutePosition(ES(d,u[0],u[1],t,a)):s||d.lockAspectRatio?this.setLayerAbsolutePosition(yS(d,u[0],u[1],t,a,!0)):this.setLayerAbsolutePosition(this.getAbsolutePositionFromLayer())));let f=!1;if(!(m&&"subtitle"!==d.type)&&e.canvasWidth!==o||e.canvasHeight!==n||e.containerWidth!==r||e.containerHeight!==i){if("shape"===d.type&&"progressBar"===d.shapeType&&d.position&&(d.position.width="100%"),d.lockAspectRatio&&"text"!==d.type&&"shape"!==d.type&&!m){const t=function(e,t,a){var o,n;const{state:r}=tn(),{canvasX:i,canvasY:s}=r.studio,l={x:i,y:s,width:r.studio.width,height:r.studio.height,prevWidth:t,prevHeight:a};let d;if(!e.position)throw Error("Layer position missing");d=e.isAudiogram?(parseFloat(e.position.width)||parseFloat("100%"))/(parseFloat(e.position.height)||parseFloat("40%")):(null==(o=null==e?void 0:e.crop)?void 0:o.width)&&(null==(n=null==e?void 0:e.crop)?void 0:n.height)?e.width*e.crop.width/(e.height*e.crop.height):e.width/e.height;const{layerWidth:c,layerHeight:u}=hS(e.position,d,l),{layerX:m,layerY:p}=gS(e.position,c,u,l);return{x:m,y:p,width:c,height:u}}(d,e.canvasWidth,e.canvasHeight);this.resizeLockRatioLayer(t),f=!0}else this.setLayerAbsolutePosition(this.getAbsolutePositionFromLayer()),f=!0;"subtitle"===d.type&&(this.setLayerAbsolutePosition(this.getAbsolutePositionFromLayer()),f=!0)}if(l&&e.groupInfo){const{groupResizing:t,groupAbsolutePosition:a,groupRotating:o}=l;t&&e.groupInfo.groupAbsolutePosition&&e.groupInfo.groupAbsolutePosition.width!==a.width&&(this.resizeGroupedLayer(),f=!0),o&&e.groupInfo.groupAbsolutePosition&&e.groupInfo.groupAbsolutePosition.rotation!==a.rotation&&(this.rotateGroupedLayer(),f=!0)}if(!f&&this.shouldUpdateAbsolutePosition(e)&&"ghost"!==d.id&&this.setLayerAbsolutePosition(this.getAbsolutePositionFromLayer()),!e.didDrop&&p&&g.type!==ln.Placeholder&&g.id===d.id){const e={};y&&(e.position=bS(pX(y,0,!1))),H$(h,e)}}shouldUpdateAbsolutePosition(e){var t;const{canvasPreviewWidth:a,canvasPreviewHeight:o,layer:n,viewOnly:r,refreshKey:i,layerTempValues:l}=this.props,{layerAbsolutePosition:d}=this.state;return!d||(!!((r&&e.canvasPreviewWidth!==a||e.canvasPreviewHeight!==o)&&o&&a)||(!s.exports.isEqual(null==(t=e.layerTempValues)?void 0:t.positionTemp,null==l?void 0:l.positionTemp)||(!s.exports.isEqual(e.layer.position,n.position)&&"subtitle"!==n.type||i!==e.refreshKey)))}getPreviewUrl(e){switch(e.type){case gh.CML_FILE:return e.thumbnailUrl;case gh.SIDEBAR_IMAGE:return e.image.url;case gh.SIDEBAR_VIDEO:return e.video.thumbnailUrl;default:return""}}render(){const{layer:e,viewOnly:t,canvasHeight:a,canvasWidth:o,isCanvasPreview:n,isOverCurrent:r,item:s,staticPreview:l,onVideoLoad:d,groupInfo:c,canvasPreviewHeight:u,canvasPreviewWidth:m,refreshKey:p,studioTime:h}=this.props,{layerAnimationPosition:g}=this.state,y=this.getKeyframedAbsolutePosition(),f={layer:e,handleTransform:this.handleTransform,handleTransformFinish:this.handleTransformFinish,...y,refreshKey:p,viewOnly:t,staticPreview:l,handleEditorDoubleClick:this.handleEditorDoubleClick,handleExitEditorClick:this.handleExitEditorClick,canvasHeight:u||a,canvasWidth:m||o,onVideoLoad:d,updateLayerAnimationPosition:this.updateLayerAnimationPosition,isCanvasPreview:n,studioTime:h};if(!e)return null;c&&(f.x+=c.groupXDiff,f.y+=c.groupYDiff);const E=w_(e);g&&E&&E.layerInvolvesMovement&&(f.x+=g.x||0,f.y+=g.y||0),r&&(f.previewUrl=this.getPreviewUrl(s));const v=l||"ghost"===e.id?"none":"auto";return this.props.connectDropTarget(i.createElement("div",{style:{pointerEvents:v}},this.state.showTTSWarningOverlay&&i.createElement(Nj,{onClose:()=>this.setState({showTTSWarningOverlay:!1})}),this.renderTransformer(f.x,f.y),this.renderLayer(f)))}}const kX={drop:(e,t)=>{const a=t.getItem(),{layer:o,selectItem:n,selectedSceneId:r}=e,i=JD(Ps.BRANDKIT);if(o.type===ln.Placeholder){switch(n({id:o.id,type:o.type}),a.type){case gh.UPLOADING_LAYER:LB(o,a.layer,{knownTimelineRow:!0,sceneId:r,undoable:!0});break;case gh.SIDEBAR_IMAGE:G$({dndAsset:a.image,idOfLayerToReplace:o.id});break;case gh.SIDEBAR_VIDEO:G$({dndAsset:a.video,idOfLayerToReplace:o.id});break;case gh.TRANSITION_TILE:break;case gh.CML_FILE:zU((()=>{L$(a.cmlFile,a.asset)}),{if:a.brandkitItem&&!i,action:Rs.BRANDKIT})();break;case gh.TEXT_PRESET:V$(a.preset,{position:o.position})}return o}return{}}},CX=m.exports.connect(((e,t)=>{var a,o,n,r;const i=Oj(t.layer.id),{draggedTracksOverrides:s={}}=e.studioLocal;let l=!1;if(t.layer){const e=s[t.layer.id];if(e&&e.leftMost||t.layer.requireConversion)l=!0;else{const[e,a]=zS(t.layer,0);l=e<=t.studioTime&&t.studioTime<=a}}const d=Object.entries(e.studio.groups).find((e=>e[1].layers.some((e=>e.id===t.layer.id)))),c=d&&d[0];return{boxSelectedIds:e.studioLocal.boxSelectedIds,canvasHeight:e.studio.height,canvasWidth:e.studio.width,canvasX:e.studio.canvasX,canvasY:e.studio.canvasY,containerHeight:e.studio.containerHeight,containerWidth:e.studio.containerWidth,eyedropperMode:e.studio.eyedropperMode,groupIDForLayer:c,groups:e.studio.groups,isBeingInlineCropped:!!(null==(a=e.studioLocal.layerTempValues[t.layer.id])?void 0:a.isBeingInlineCropped),isEditing:ml(e,t.layer.id),isShownAtStudioTime:l,layers:null==(o=e.studio.scenes[0])?void 0:o.layers,layerTempValues:e.studioLocal.layerTempValues[t.layer.id],borderRadiusTemp:null==(n=e.studioLocal.layerTempValues[t.layer.id])?void 0:n.borderRadiusTemp,mediaCache:e.mediaCache,ratio:e.studio.ratio,refreshKey:e.studio.refreshKey,selectedItem:e.studio.selectedItem,studioPaused:e.studio.studioPaused,viewOnly:!e.userPermissions.canWrite||t.layer.locked&&t.layer.id!==(null==(r=e.studio.selectedItem)?void 0:r.id)||t.viewOnly,mIGhostLayerAbsolutePosition:hl(e),selectedSceneId:e.studio.scenes[0].id,keyframeChannels:i(e)}}),(e=>me({setSelectedEditorPane:eg,resizeLayer:Th,showSnapLines:Oh,setScale:Ih,setRotation:xh,resizeLineLayer:Sh,selectItem:Kh},e))),AX=we(CX(Qe([gh.CML_FILE,gh.SIDEBAR_IMAGE,gh.SIDEBAR_VIDEO],kX,((e,t)=>({didDrop:t.didDrop(),item:t.getItem(),dropResult:t.getDropResult(),connectDropTarget:e.dropTarget(),isOverCurrent:t.isOver({shallow:!0})})))(xX))),NX=i.createContext({renderCanvas:()=>null,renderCanvasContainer:()=>null}),PX="CanvasPreview-module_container_pNA0S",RX=e=>{if(e.position){const{x:t,y:a,width:o,height:n}=e.position,[r,i,s,l]=[parseFloat(t),parseFloat(a),parseFloat(o),parseFloat(n)];let d,c;return d=r<0?r+s:s>100-r?100-r:s,c=i<0?i+l:l>100-i?100-i:l,d*c/100}return-1},LX=e=>{let t=null,a=0;for(const o of e)if(UX(o)){const e=RX(o);e>=a&&(t=o,a=e)}return{layer:t,percent:a}},DX=(e,t,a)=>{var o,n,r,i,s,l;const d={...e,id:`blurred-layer-${z.v4()}`,originalLayerId:e.id,filters:{...e.filters,blurPercent:5},position:{x:"-5%",y:"-5%",width:"110%",height:"110%",rotation:0},crop:void 0,borderRadius:{relative:"0%"},isTrimmed:!0,animation:void 0,isCanvasBlurLayer:!0};if("video"===e.type){d.isMuted=!0;const c=null!=(o=e.playbackRate)?o:1,u=null!=(n=e.startTime)?n:0,m=(null!=(i=null!=(r=e.endTime)?r:e.duration)?i:0)-u,p=(t-(null!=(s=e.videoDelay)?s:0))/(m/c),h=(a-(null!=(l=e.videoDelay)?l:0))/(m/c);d.startTime=u+p*m,d.endTime=u+h*m,d.videoDelay=t}else d.startTime=t,d.endTime=a;return d},OX=e=>{const t=(e=>{const t=[];return e.forEach((e=>{if(e&&!1!==e.canvasBlurValid&&UX(e)){const[a,o]=zS(e,0);let n=null,r=null;if([...Array(t.length).keys()].forEach((i=>{const s=t[i];a>s.startTime&&a<s.endTime&&(n=i),o>s.startTime&&o<s.endTime&&(r=i),s.startTime>=a&&s.endTime<=o&&s.layers.push(e)})),0===t.length){if(a>0){const e={layers:[],startTime:0,endTime:a};t.push(e)}const n={layers:[e],startTime:a,endTime:o};t.push(n)}else if(o<t[0].startTime){const n=t[0].startTime,r={layers:[e],startTime:a,endTime:o},i={layers:[],startTime:o,endTime:n};t.push(r),t.push(i)}else if(a>t[t.length-1].endTime){const n={layers:[],startTime:t[t.length-1].endTime,endTime:a},r={layers:[e],startTime:a,endTime:o};t.push(n),t.push(r)}else{if(o>t[t.length-1].endTime){const a={layers:[e],startTime:t[t.length-1].endTime,endTime:o};t.splice(t.length,0,a)}if(null!==r&&null!==n&&n===r){const r=t[n],i=r.startTime;r.startTime=o;const s={layers:[...r.layers],startTime:i,endTime:a},l={layers:[...r.layers],startTime:a,endTime:o};l.layers.push(e),t.splice(n,0,l),t.splice(n,0,s)}else{if(null!==r){const a=t[r],n=a.startTime,i=o;a.startTime=i;const s={layers:[...a.layers],startTime:n,endTime:i};s.layers.push(e),t.splice(r,0,s)}if(null!==n){const o=t[n],r=a,i=o.endTime;o.endTime=r;const s={layers:[...o.layers],startTime:r,endTime:i};s.layers.push(e),t.splice(n+1,0,s)}}if(a<t[0].startTime){const o={layers:[e],startTime:a,endTime:t[0].startTime};t.splice(0,0,o)}}}})),t})(e),a=(e=>{const t=[];return e.forEach((e=>{const{layer:a,percent:o}=LX(e.layers);o>=99||null!==a&&t.push({layer:DX(a,e.startTime,e.endTime),startTime:e.startTime,endTime:e.endTime})})),t})(t);return a},FX=[],MX=c(Xk,(e=>e.studio.canvasBlur),((e,t)=>t?0===e.length?FX:OX(e):FX)),UX=e=>("video"===e.type||"image"===e.type)&&void 0===e.canvasBlurValid||e.canvasBlurValid,BX=()=>{var e;const{state:t}=tn();return!(null==(e=t.studio.scenes[0])?void 0:e.layers.every((e=>!UX(e))))},WX=i.memo(AX);class VX extends r.exports.Component{constructor(e){super(e),a(this,"div",null),a(this,"getResizeRatioCanvasDimensions",(()=>{const{resizeRatio:e,maxWidth:t,maxHeight:a}=this.props;if(e&&t&&a){if(e[0]>e[1]){return t*e[1]/e[0]>a?{width:a*e[0]/e[1],height:a}:{width:t,height:t*e[1]/e[0]}}if(e[1]>e[0])return{width:a*e[0]/e[1],height:a};if(t<a)return{width:t,height:t}}return{width:a,height:a}})),a(this,"getCanvasStyles",(()=>{const{width:e,height:t,currBackground:a}=this.state;return{width:e,height:t,background:tw(a)?"#4a4a4a":a}})),a(this,"getLayerPositionAndSize",(e=>{const{width:t,height:a,originalWidth:o,originalHeight:n}=this.state,r=mS(e,{x:0,y:0,width:t,height:a});return"shape"===e.type&&e.position&&o&&n&&t&&a?vS(e.position,t,a,o,n):r})),a(this,"convertPositionToPercent",((e,t)=>{const{width:a,height:o}=this.state;return iS(e,t,{x:0,y:0,width:a,height:o})})),a(this,"convertSizeToPercent",((e,t)=>{const{width:a,height:o}=this.state;return aS(e,t,{width:a,height:o})}));const{scene:t,canvasBlur:o,background:n=t.background}=this.props;this.state={loading:!0,currBackground:o&&BX()?"#202020":n}}componentDidMount(){var e;let{studioHeight:t,studioWidth:a}=this.props;const{maxHeight:o}=this.props,{maxWidth:n,canvasX:r,canvasY:i,setCanvasDimensions:s,setStudioDimensions:l,showStudioCanvas:d,staticPreview:c,setRatio:u,ratio:m,layers:p,resizeRatio:h}=this.props,g=(null==(e=this.div)?void 0:e.offsetWidth)||n||0;let y;if(h){const e=this.getResizeRatioCanvasDimensions();y={canvasWidth:null==e?void 0:e.width,canvasHeight:null==e?void 0:e.height}}else{if(!a||!t)if(m){const{ratioWidth:e,ratioHeight:o}=iA(m);LA(m,{x:r,y:i,width:g,height:g*o/e}),a=e,t=o}else u("400:400"),d(),a=400,t=400;y=xx({canvasWidth:a,canvasHeight:t,maxHeight:o})}c||(s(y),l({width:y.canvasWidth,height:y.canvasHeight,canvasX:0,canvasY:0})),this.setState({originalWidth:y.canvasWidth,originalHeight:y.canvasHeight,width:y.canvasWidth,height:y.canvasHeight,loading:!1});if(JD(Ps.BRANDKIT))for(const f of p)"text"===f.type&&f.hasCustomFont&&lB({type:"custom",fontFamily:f.fontFamily,url:f.url,asset_id:f.asset_id})}componentDidUpdate(e){const{scene:t,resizeRatio:a,canvasBlur:o,maxWidth:n,maxHeight:r,background:i=t.background}=this.props;if(a&&e.resizeRatio&&a[0]/a[1]!=e.resizeRatio[0]/e.resizeRatio[1]){const e=this.getResizeRatioCanvasDimensions();this.setState({width:null==e?void 0:e.width}),this.setState({height:null==e?void 0:e.height})}if(n!==e.maxWidth||r!==e.maxHeight){const e=this.getResizeRatioCanvasDimensions();this.setState({width:null==e?void 0:e.width}),this.setState({height:null==e?void 0:e.height})}o!==e.canvasBlur&&(o&&BX()?this.setState({currBackground:"#202020"}):this.setState({currBackground:i})),i&&e.background&&i!==e.background&&this.setState({currBackground:i})}render(){const{loading:e,originalWidth:t,originalHeight:a,width:o,height:n}=this.state,{layers:r,staticPreview:s,multiScene:l,onVideoLoad:d,fitToCenter:c,canvasBlur:u}=this.props;if(e)return i.createElement("div",{ref:e=>{this.div=e},style:{width:"100%",height:"100%"}});const m=r.filter((e=>{const[t,a]=zS(e);if(_d(e)){return t-1<=this.props.studioTime&&this.props.studioTime<=a+1}return t<=this.props.studioTime&&this.props.studioTime<=a})),{layer:p}=LX(m);if(u&&p&&UX(p)){const[e,t]=zS(p),a=DX(p,e,t);m.splice(0,0,a)}return s?i.createElement("div",{className:PX,style:this.getCanvasStyles()},m.map(((e,r)=>i.createElement(WX,{"data-cy":"canvas-layer-"+(1===r?"visible":"hidden"),layer:e,key:e.id,viewOnly:!0,isCanvasPreview:!0,studioTime:this.props.studioTime,fitToCenter:c,getLayerPositionAndSize:this.getLayerPositionAndSize,convertPositionToPercent:this.convertPositionToPercent,convertSizeToPercent:this.convertSizeToPercent,staticPreview:s,multiScene:l,canvasPreviewWidth:o,canvasPreviewHeight:n,previewOriginalDimensions:[t,a],onVideoLoad:d})))):i.createElement("div",{className:PX,style:this.getCanvasStyles()},this.context.renderCanvas())}}VX.contextType=NX;const jX=we(m.exports.connect((e=>({studioWidth:e.studio.width,studioHeight:e.studio.height,ratio:e.studio.ratio,showCanvas:e.studio.showCanvas,canvasX:e.studio.canvasX,canvasY:e.studio.canvasY,currentUser:e.currentUser})),(e=>me({setCanvasDimensions:Ix,setStudioDimensions:bx,setRatio:B_,showStudioCanvas:_x},e)))(VX)),GX="TemplateLayers-module_container_2qoFt",HX=i.memo((function({template:e,width:t=100,height:a=100,onClick:o}){const n=tr((e=>e.studio.scenes),ar);r.exports.useEffect((()=>{!async function(){const t=e.layers.filter((e=>e.type===ln.Text));await Promise.all(t.map((async e=>{const t=Nx(e);t&&await mB(t)})))}()}),[e]);const s=e.layers.map(((t,a)=>({...t,id:`${e.templateId}-${a}`})));return i.createElement(xG,{className:GX,style:{width:t,height:a},onClick:o},i.createElement(jX,{staticPreview:!0,layers:s,scene:n[0],maxWidth:t,maxHeight:a,resizeRatio:e.ratio||[1,1],background:"transparent",studioTime:0}))})),zX=i.memo((function({template:e,width:t=100,height:a=100,viewOnly:o,onClick:n}){const r=!!e.teamId;return i.createElement("div",{className:Bz},i.createElement(HX,{template:e,width:t,height:a,onClick:n}),!o&&i.createElement("div",{className:Vz},i.createElement(Uz,{template:e,isBrandkit:r})),r&&i.createElement("div",{className:Wz,onClick:n},i.createElement(SD,{message:"Added to your team’s Brand Kit",wrapWithDiv:!0},i.createElement(Fe,{className:jz}))))})),$X="DragPreview-module_item_OtsDt",KX=()=>{const{isDragging:e,item:t,sourceClientOffset:a,clientOffset:o}=Ze((e=>({isDragging:e.isDragging(),item:e.getItem(),sourceClientOffset:e.getSourceClientOffset(),clientOffset:e.getClientOffset()}))),{inTrackpadOrCanvas:n}=tr((e=>({inTrackpadOrCanvas:!!e.studioLocal.mediaItemDropLocation})),m.exports.shallowEqual),s=m.exports.useDispatch();r.exports.useEffect((()=>{e||s(cg(null))}),[e,s]);return t&&e&&!n?i.createElement("div",{style:function(){if(!a)return{display:"none"};const e={left:a.x,top:a.y,width:120,height:100};switch(t.type){case gh.CML_FILE:t.thumbnailUrl&&(e.backgroundImage=`url(${t.thumbnailUrl})`);break;case gh.UPLOADING_LAYER:break;case gh.TRANSITION_TILE:o&&(e.left=o.x-60,e.top=o.y-50,e.width=60,e.height=50,e.backgroundImage=t.isCrossTransition?"url(https://cdn-useast1.kapwing.com/static/Fyi-crossTransitionIcon.png)":"url(https://cdn-useast1.kapwing.com/static/hjX-singleVideoTransitionIcon.png)");break;case gh.SIDEBAR_IMAGE:{const{url:a,imageRef:o}=t.image,n=null==o?void 0:o.current;if(a&&(e.backgroundImage=`url(${a})`),n){const t=n.getBoundingClientRect();e.width=t.width,e.height=t.height}break}case gh.SIDEBAR_VIDEO:{const{thumbnailUrl:a,videoRef:o}=t.video,n=null==o?void 0:o.current;if(a&&(e.backgroundImage=`url(${a})`),n){const t=n.getBoundingClientRect();e.width=t.width,e.height=t.height}break}case gh.MAGIC_SUBTITLE_PRESET:e.width=106,e.height=133,e.background="transparent",e.overflow="hidden";break;case gh.TEXT_PRESET:case gh.TEXT_TEMPLATE:e.width=106,e.height=106,e.background="transparent",e.overflow="hidden"}return e}(),className:$X},(()=>{switch(t.type){case gh.MAGIC_SUBTITLE_PRESET:return i.createElement("div",{style:{backgroundColor:"#101010"}},i.createElement(nG,{preset:t.preset,animate:!0,viewOnly:!0}));case gh.TEXT_PRESET:return i.createElement("div",{style:{backgroundColor:"#101010"}},i.createElement(LG,{preset:t.preset,viewOnly:!0}));case gh.TEXT_TEMPLATE:return i.createElement("div",{style:{backgroundColor:"#101010"}},i.createElement(zX,{template:t.template,viewOnly:!0}));default:return null}})()):null},YX=({children:e})=>i.createElement(ie,null,i.createElement(et,null,e));class qX extends r.exports.Component{componentDidUpdate(e){this.props.location!==e.location&&window.scrollTo(0,0)}render(){return this.props.children}}const XX=we(qX),JX="LoadingFullScreen-module_loading-wrapper-full-screen_5bXDX",QX="LoadingFullScreen-module_loading-wrapper-full-screen-gray_AheSv",ZX="LoadingFullScreen-module_loadingLogo_-lDxm",eJ="LoadingFullScreen-module_loader_bxHuu",tJ="LoadingFullScreen-module_lightLoader_af6Rf",aJ="LoadingFullScreen-module_full-screen-loading-description_3zB0G",oJ=({darkMode:e=!1,title:t})=>{const a=e?"https://cdn-useast1.kapwing.com/static/8XE-Kapwing-transparent-logo-animation-gray.webp":"https://cdn-useast1.kapwing.com/static/yeX-Kapwing-transparent-logo-animation-white.webp",o=e?eJ:tJ;return i.createElement("div",{className:e?QX:JX},i.createElement("img",{className:ZX,alt:"loading",src:a}),i.createElement("div",{className:aJ,"data-cy":"loading-full-screen"},i.createElement("span",null,t||"Loading..."),i.createElement("div",{className:o})))},nJ={},rJ={fallback:i.createElement(oJ,{darkMode:!0,title:"Loading Kapwing..."})},iJ=tt((()=>vP((()=>import("./Team.81a6b301.js")),["assets/Team.81a6b301.js","assets/vendor.96643be6.js","assets/usePrevious.d5fd0124.js","assets/index.esm.dcd4a048.js","assets/index.378b79d8.css","assets/Navbar.94078e9d.js","assets/WorkspaceMobileMenu.0fe3f1b8.js","assets/WorkspaceMobileMenu.15976684.css","assets/Navbar.4581d767.css","assets/Team.c8d0cb30.css"])),nJ),sJ=tt((()=>vP((()=>import("./Settings.3b3ef87b.js")),["assets/Settings.3b3ef87b.js","assets/vendor.96643be6.js","assets/Settings.1e655fe6.css"])),nJ),lJ=tt((()=>vP((()=>import("./TemplateEditorContainer.e3cb8a49.js")),["assets/TemplateEditorContainer.e3cb8a49.js","assets/vendor.96643be6.js"])),rJ),dJ=tt((()=>vP((()=>import("./Folder.8a309f96.js")),["assets/Folder.8a309f96.js","assets/vendor.96643be6.js","assets/WorkspaceMobileMenu.0fe3f1b8.js","assets/WorkspaceMobileMenu.15976684.css","assets/index.esm.f761ec2a.js","assets/videos.af05fad2.js","assets/Folder.c94c9f80.css"])),nJ),cJ=tt((()=>vP((()=>import("./BrandkitEditor.58891979.js")),["assets/BrandkitEditor.58891979.js","assets/vendor.96643be6.js","assets/Navbar.94078e9d.js","assets/WorkspaceMobileMenu.0fe3f1b8.js","assets/WorkspaceMobileMenu.15976684.css","assets/Navbar.4581d767.css","assets/CloudMediaLibraryTile.202b21b0.js","assets/index.esm.f761ec2a.js","assets/CloudMediaLibraryTile.44b8320a.css","assets/FontSelector.13342a18.js","assets/FontSelector.1ba1a03a.css","assets/videos.af05fad2.js","assets/BrandkitEditor.0c7fde05.css"])),nJ),uJ=tt((()=>vP((()=>import("./Editor.8d572285.js")),["assets/Editor.8d572285.js","assets/vendor.96643be6.js","assets/workspace.9ea6ef3c.js","assets/CloudMediaLibraryTile.202b21b0.js","assets/index.esm.f761ec2a.js","assets/CloudMediaLibraryTile.44b8320a.css","assets/usePrevious.d5fd0124.js","assets/workspace.80030127.css","assets/Editor.44e6878a.css"])),rJ),mJ=tt((()=>vP((()=>import("./StudioEditor.8d586dd3.js")),["assets/StudioEditor.8d586dd3.js","assets/vendor.96643be6.js","assets/usePrevious.d5fd0124.js","assets/workspace.9ea6ef3c.js","assets/CloudMediaLibraryTile.202b21b0.js","assets/index.esm.f761ec2a.js","assets/CloudMediaLibraryTile.44b8320a.css","assets/workspace.80030127.css","assets/FontSelector.13342a18.js","assets/FontSelector.1ba1a03a.css","assets/index.esm.dcd4a048.js","assets/index.378b79d8.css","assets/index.876e2f9d.js","assets/StudioEditor.bb40ec1b.css"])),rJ),pJ=tt((()=>vP((()=>import("./AdminContainer.9f5763e6.js")),["assets/AdminContainer.9f5763e6.js","assets/vendor.96643be6.js","assets/index.esm.f761ec2a.js","assets/AdminOnly.f0e3ce7e.js","assets/AdminContainer.e26e79c5.css"])),nJ),hJ=tt((()=>vP((()=>Promise.resolve().then((()=>bfe))),void 0)),nJ),gJ=tt((()=>vP((()=>Promise.resolve().then((()=>TP))),void 0)),nJ),yJ=tt((()=>vP((()=>import("./DebugContainer.4a98c2e6.js")),["assets/DebugContainer.4a98c2e6.js","assets/vendor.96643be6.js","assets/AdminOnly.f0e3ce7e.js","assets/index.876e2f9d.js","assets/DebugContainer.6af96055.css"])),nJ),fJ=tt((()=>vP((()=>import("./HappyBirthday.1c1a9fcd.js")),["assets/HappyBirthday.1c1a9fcd.js","assets/vendor.96643be6.js"])),nJ);var EJ=(e=>(e.account="account",e.accountChange="account/change",e))(EJ||{});const vJ="Footer-module_footerText_pSvVq",wJ="Footer-module_footer-link-column-link_Av4m0",bJ="Footer-module_footer-link-column-link-last_iVeDd",_J="Footer-module_footer-div_w2pfL",TJ="Footer-module_footer-container_ERTV0",SJ="Footer-module_footer-company_Uzp5A",IJ="Footer-module_footer-company-header_pIHgf",xJ="Footer-module_footer-link-column_qoqNz",kJ="Footer-module_footer-link-column-header_gNA8j",CJ="Footer-module_footer-follow-link_UiWAy",AJ="Footer-module_footer-link-column-links-container_4YPIn",NJ="Footer-module_footer-instagram-icon-container_L0yKi",PJ="Footer-module_footer-instagram-image_hWHel",RJ="Footer-module_p_vTMHh";class LJ extends r.exports.Component{constructor(e){super(e),a(this,"showSignIn",(e=>{e.preventDefault(),this.setState({showSignIn:!0})})),a(this,"hideSignIn",(()=>this.setState({showSignIn:!1}))),a(this,"goToAccount",(()=>{const{history:e}=this.props;e.push("/my")})),this.state={showSignIn:!1}}render(){const{currentUser:e,currentFolderId:t,signOut:a}=this.props,{showSignIn:o}=this.state,n=cs(),r=sc(e);return i.createElement("div",{className:_J},i.createElement("div",{className:TJ},i.createElement("div",{className:SJ},i.createElement("div",{className:IJ},i.createElement("img",{alt:"Kapwing Logo",height:50,src:"https://cdn-useast1.kapwing.com/static/9XE-logo-small.webp",width:50}),i.createElement("a",{href:"/"},"KAPWING")),i.createElement("div",null,i.createElement("a",{href:"https://twitter.com/KapwingApp",target:"_Blank",rel:"noopener noreferrer",className:CJ,title:"Twitter"},i.createElement("div",{className:NJ},i.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/twitter-footer-light.webp",alt:"Twitter",className:PJ,width:"28px",height:"28px",loading:"lazy"}))),i.createElement("a",{href:"https://www.youtube.com/channel/UCR5GrKMeaZJxPKVMdEgKIKA?sub_confirmation=1",target:"_Blank",rel:"noopener noreferrer",className:CJ,title:"Youtube"},i.createElement("div",{className:NJ},i.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/yt-footer-light.webp",alt:"Youtube",className:PJ,width:"28px",height:"28px",loading:"lazy"}))),i.createElement("a",{href:"https://www.instagram.com/KapwingApp/",target:"_Blank",rel:"noopener noreferrer",className:CJ,title:"Instagram"},i.createElement("div",{className:NJ},i.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/ig-footer-light.webp",alt:"Instagram",className:PJ,width:"28px",height:"28px",loading:"lazy"}))),i.createElement("a",{href:"https://www.tiktok.com/@kapwing",target:"_Blank",rel:"noopener noreferrer",className:CJ,title:"TikTok"},i.createElement("div",{className:NJ},i.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/tiktok-footer-light.webp",alt:"TikTok",className:PJ,width:"28px",height:"28px",loading:"lazy"}))),i.createElement("a",{href:"https://www.facebook.com/groups/kapwing",target:"_Blank",rel:"noopener noreferrer",className:CJ,title:"Facebook"},i.createElement("div",{className:NJ},i.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/fb-footer-light.webp",alt:"Facebook",className:PJ,width:"28px",height:"28px",loading:"lazy"}))))),i.createElement("div",{className:xJ},i.createElement("a",{href:"/tools",className:kJ},"Tools"),i.createElement("div",{className:AJ},i.createElement("a",{href:"/video-editor",className:wJ},"Video Editor"),i.createElement("a",{href:"/subtitles",className:wJ},"Subtitles"),i.createElement("a",{href:"/meme-maker",className:wJ},"Meme Generator"),i.createElement("a",{href:"/tools/convert",className:wJ},"Convert Video"),i.createElement("a",{href:"/tools/trim",className:wJ},"Video Trimmer"),i.createElement("a",{href:"/tools/record/screen",className:wJ},"Screen Recorder"),i.createElement("a",{href:"/tools",className:`${wJ} ${bJ}`},"View All"))),i.createElement("div",{className:xJ},i.createElement("a",{href:"/ai",className:kJ},"AI-powered"),i.createElement("div",{className:AJ},i.createElement("a",{href:"/tools/smart-cut",className:wJ},"Smart Cut"),i.createElement("a",{href:"/ai-video-generator",className:wJ},"AI Video Generator"),i.createElement("a",{href:"/tools/remove-background/noise",className:wJ},"Clean Audio"),i.createElement("a",{href:"/ai/image-generator",className:wJ},"AI Image Generator"),i.createElement("a",{href:"/meme-maker/ai",className:wJ},"AI Meme Generator"),i.createElement("a",{href:"/tools/text-to-speech",className:wJ},"Text to Speech"),i.createElement("a",{href:"/ai/document-to-video",className:wJ},"Document to Video"),i.createElement("a",{href:"/ai",className:`${wJ} ${bJ}`},"View All"))),i.createElement("div",{className:xJ},i.createElement("a",{href:"/templates",className:kJ},"Templates"),i.createElement("div",{className:AJ},i.createElement("a",{href:"/templates",className:wJ},"Video Templates"),i.createElement("a",{href:"/meme-templates",className:wJ},"Meme Templates"),i.createElement("a",{href:"/templates/collage",className:wJ},"Collage Templates"),i.createElement("a",{href:"/templates/instagram",className:wJ},"Instagram Video"),i.createElement("a",{href:"/templates/popular",className:wJ},"Popular Templates"),i.createElement("a",{href:"/templates/edu",className:wJ},"EDU Templates"),i.createElement("a",{href:"/templates",className:`${wJ} ${bJ}`},"View All"))),i.createElement("div",{className:xJ},i.createElement("div",{className:kJ},"Learn"),i.createElement("div",{className:AJ},i.createElement("a",{href:"/about",className:wJ},"About Us"),i.createElement("a",{href:"/resources",target:"_self",className:wJ},"Resources"),i.createElement("a",{href:"/help",target:"_blank",rel:"noreferrer noopener",className:wJ},"Help Center"),i.createElement("a",{href:"/blog",target:"_self",className:wJ},"Blog"),i.createElement("a",{href:"/edu",className:wJ},"EDU"),i.createElement("a",{href:"/explore",className:wJ},"Explore"),i.createElement("a",{href:"/teams",className:wJ},"Teams"),i.createElement("a",{href:"/contact-us",className:wJ},"Contact Us"),r?i.createElement(i.Fragment,null,i.createElement(at,{className:wJ,to:`/folder/${t}`},"My Workspace"),i.createElement(at,{className:wJ,to:{pathname:`/folder/${t}`,state:{openModal:EJ.account}}},"My Account"),i.createElement("div",{className:wJ,onClick:a},"Sign out")):i.createElement("div",{className:wJ,onClick:this.showSignIn},"Sign in"),o&&i.createElement(ZF,{hideSignIn:this.hideSignIn,onSuccess:this.goToAccount}))),i.createElement("div",{className:xJ},i.createElement("div",{className:kJ},"Company"),i.createElement("div",{className:AJ},i.createElement("a",{href:"/pricing",className:wJ},"Pricing"),i.createElement("a",{href:"/careers",className:wJ},"Careers"),i.createElement("a",{href:"/partnerships",className:wJ},"Partnerships"),i.createElement("a",{href:"/affiliates",className:wJ},"Affiliates"),i.createElement("a",{href:"/plugins",className:wJ},"Plugins"),i.createElement("a",{className:wJ,href:"/help/tag/release-notes/"},"Release Notes"),i.createElement("a",{href:"/creators-fund",className:wJ},"Creators Fund"),i.createElement("a",{href:"/policies/refund",className:wJ},"Refund Policy"),i.createElement("a",{href:"/policies/privacy",className:wJ},"Privacy Policy"),i.createElement("a",{href:"/policies/terms-of-service",className:wJ},"Terms of Service")))),i.createElement("div",{className:vJ},"© ",(new Date).getFullYear()," Kapwing. Release ","v2023.06.13.1","—",n,".",i.createElement("p",{className:RJ},"Made with love in San Francisco, California.")))}}const DJ=we(m.exports.connect((e=>({currentUser:e.currentUser,currentFolderId:e.workspaces.selectedWorkspace})),(e=>me({signOut:Jc},e)))(LJ));function OJ(e,t=!0){return{type:"SET_SOURCE_VIDEO",video:e,updateSharedDoc:t}}function FJ(e,t="sourceVideo"){return{type:"SET_UPLOAD_PROGRESS_TEXT",text:e,id:t}}function MJ(){return{type:"RESET_EDITOR"}}function UJ(){return{type:"RESET_EDITOR_FLAGS"}}const BJ="OverlayWrapper-module_overlayBackground_IgN-u",WJ="OverlayWrapper-module_overlayContainer_Dbxsu",VJ="OverlayWrapper-module_overlayContainerPadding_acU1f",jJ="OverlayWrapper-module_exit_qhRlo",GJ="OverlayWrapper-module_overlayContent_0qiec",HJ="OverlayWrapper-module_overlayInput_Vxuv0";class zJ extends r.exports.Component{constructor(){super(...arguments),a(this,"escFunction",(e=>{27===e.keyCode&&this.handleClose()})),a(this,"handleClose",(()=>{const{dragUpload:e,hideDragUploadDialog:t,history:a}=this.props;e?t&&t():a.length<=1?a.push("/"):a.goBack()}))}componentDidMount(){document.addEventListener("keydown",this.escFunction,!1)}componentWillUnmount(){document.removeEventListener("keydown",this.escFunction,!1)}getContainerStyle(){return this.props.biggerPadding?VJ:WJ}render(){const{showDragUploadDialog:e,handleDragUpload:t}=this.props;return i.createElement("div",null,i.createElement("div",{className:BJ,onClick:this.handleClose,"data-cy":"overlay-background"}),e&&t&&i.createElement("input",{className:HJ,accept:"image/*,video/mp4,video/*",onClick:e=>{this.handleClose(),e.preventDefault()},onChange:e=>{t(e.target&&e.target.files)},type:"file",multiple:!0}),i.createElement("div",{style:this.props.maxWidth?{maxWidth:`${this.props.maxWidth}px`}:void 0,className:this.getContainerStyle()},i.createElement("div",{className:jJ,onClick:this.handleClose},i.createElement(pe,null)),i.createElement("div",{className:GJ},this.props.children)))}}const $J=we(zJ),KJ="DragUpload-module_dragUploadButton_BJfl-",YJ="DragUpload-module_dragUploadLabel_ex8yk",qJ="DragUpload-module_uploadContainer_X-54s",XJ="DragUpload-module_dragUploadLabelHeader_vnj-D";class JJ extends r.exports.Component{componentDidUpdate(e){this.props.files!==e.files&&this.props.handleMultiFileUpload(this.props.files)}render(){const{multiple:e,inputClassNames:t,labelClassNames:a,handleMultiFileUpload:o}=this.props;let n=KJ;t&&(n+=` ${t}`);let r=YJ;return a&&(r+=` ${a}`),i.createElement("div",{className:qJ,style:{height:"400px"}},i.createElement("input",{className:n,style:{height:"424px"},accept:this.props.returnAccepts(),onChange:e=>o(e.target&&e.target.files),type:"file",multiple:e?"multiple":null}),i.createElement("label",{htmlFor:"uploader-input",className:r},i.createElement("div",null,i.createElement("div",{className:XJ},i.createElement(ot,{size:23,style:{marginRight:10,marginBottom:5}}),"Drag here to upload"))))}}function QJ(e){if(!e)return!1;if(!e.startsWith("http"))return!1;try{return new URL(e),!0}catch(YEe){return console.error(YEe),!1}}async function ZJ({acceptAudio:e=!0,acceptImage:t=!0,acceptVideo:a=!0,additionalAssetParams:o,progressCallback:n,analyticsCallback:r,url:i,doDuplicateHandling:s=!1}){if(!i)throw Error("No url to extract");const l={...o||{}},d=await qO({url:i,analyticsCallback:r,doDuplicateHandling:s}),{mime:c}=d,[u]=(c||"").split(";",2)[0].split("/",2);let m=!1;switch(u){case"audio":e||(m=!0);break;case"image":t||(m=!0);break;case"video":a||(m=!0)}if(m)throw new Error("Invalid mime type");n&&n("Just a second..."),r({stage:dh.AssetCreation});const{asset:p,cmlFile:h}=await VG(i,l,d);HH(p,h),((null==h?void 0:h.duplicate)||d.hasUploadedAssetDuplicate)&&(d.url=p.url);const g=function(e){const t=eF(e);return!!wF.includes(t||"")}(d.url);return r({requiresConversion:g}),g&&(d.requireConversion=!0,d.conversion_type=tF(d.url,d.type),d.conversion_id=await l$({asset_id:p._id,conversion_type:d.conversion_type,pastedUrl:i,resource:d.url,type:"pastedLink"})),{asset:p,cmlFile:h,extractInfo:d}}const eQ=()=>{};class tQ extends r.exports.Component{constructor(e){super(e),a(this,"handleChange",(async e=>{const{destination:t,disallowImages:a,disallowVideo:o,handleFinish:n,resetEditor:r,setProgressText:i,setSourceVideo:s,showToast:l,startUpload:d,stopUpload:c,history:u}=this.props,{pathname:m}=u.location,p=e.target.value;if(!QJ(p))return void l({description:`${p} is not a valid URL`,type:"error"});if(oF(p))return void l({description:"MPD files are not currently supported. Please try a different file format.",type:"error"});let h=p.substring(0,Math.min(50,p.length));p.length>50&&(h+=" ..."),d(),i(`Fetching ${h} ...`);try{const{asset:e,extractInfo:d}=await ZJ({acceptAudio:!o,acceptImage:!a,acceptVideo:!o,progressCallback:i,analyticsCallback:eQ,url:p}),u=d.mime||"",g="image/gif"===u,f=!g&&u&&u.startsWith("image/"),E={_id:y(),conversion_id:e.conversion_id,isGif:g,isImage:f,pastedUrl:p,source:"pastedLink",uploadedAt:new Date,...d};E.requireConversion&&(i("Converting..."),await this.pollConversion(E)),i("Finalizing..."),r();const v=n(E),w=await(null==v?Promise.resolve(!0):v);if(s(E),c(),i(""),!w)return l({description:`Sorry, that URL (${h}) didn't work.`,type:"error"}),void c();t&&!m.includes("/upgrade")&&iT(t)}catch(g){console.error(g);l({description:`Sorry, that URL (${h}) didn't work. ${xu(g)}`,type:"error"}),c()}})),this.state={pastedLink:""}}async pollConversion(e){return new Promise((t=>{const a=setInterval((async()=>{const o=await d$(e.conversion_id);o.status===Zi.completed&&(e.url=o.output_url,e.asset_id=o.asset_id,delete e.local_url,clearInterval(a),t()),o.status===Zi.failed&&clearInterval(a)}),5e3)}))}render(){const{pastedLink:e}=this.state,t=`upload-link-input-${y()}`;return i.createElement("div",{className:"upload-link-container"},i.createElement("label",{htmlFor:t},i.createElement("input",{id:t,className:"primary-text-field upload-link-input",placeholder:"Paste a URL",value:e,onChange:this.handleChange,type:"url"})))}}const aQ=we(m.exports.connect(void 0,(e=>me({extractAsset:ZJ,resetEditor:MJ,setSourceVideo:OJ,showToast:Su},e)))(tQ)),oQ=we((e=>{const{handleFileUpload:t,returnAccepts:a}=e,o=`upload-button-input-${y()}`;return i.createElement("div",{className:"upload-button-container"},i.createElement("label",{htmlFor:o,className:"upload-button"},"Upload",i.createElement("input",{"data-cy":"upload-input",id:o,className:"upload-button-input",accept:a(),onChange:t,type:"file"})))}));class nQ extends r.exports.Component{constructor(e){super(e),this.state={loading:!1},this.saveRandom=this.saveRandom.bind(this)}async saveRandom(){const{setSourceVideo:e,destination:t,handleFinish:a,resetEditor:o,useImage:n,allowAudio:r,history:i}=this.props,{pathname:s}=i.location;this.setState({loading:!0});let l={_id:z.v4(),asset_id:"5cb6720fbb291826f269a84d",lastModified:1511336812e3,name:"samples/GElVraM.mp4",size:594982,type:"video/mp4",uploadedAt:new Date,isGif:!1,isImage:!1,source:"upload",url:"https://cdn-useast1.kapwing.com/samples/GElVraM.mp4",mime:"video/mp4"};this.props.sample&&(l=this.props.sample),n&&(l={_id:z.v4(),asset_id:"5cb77af3f3efea242e375232",lastModified:1511336812e3,name:"samples/DiRXHpj.jpg",size:46354,type:"image/jpg",uploadedAt:new Date,isGif:!1,isImage:!0,source:"upload",url:"https://cdn-useast1.kapwing.com/samples/DiRXHpj.jpg",mime:"image/jpg"}),e(l),r&&!this.props.sample&&(l={asset_id:"5cb6720fbb291826f269a84e",name:"samples/Summer_Love_trim.mp3",url:"https://cdn-useast1.kapwing.com/samples/Summer_Love_trim.mp3",size:1172125,mime:"audio/mp3",source:"upload",uri:"https://cdn-useast1.kapwing.com/samples/Summer_Love_trim.mp3"}),o(),this.setState({loading:!1});const d=await a(l);await(null==d?Promise.resolve(!0):d)&&t&&!s.includes("/upgrade")&&iT(t)}render(){const{loading:e}=this.state;return e?i.createElement("div",{className:"upload-separator"},"just a second..."):i.createElement("div",{className:"upload-separator"},"or"," ",i.createElement("span",{className:"upload-test-link",onClick:this.saveRandom,"data-cy":"non-studio-sample-link"},"try a sample!"))}}const rQ=we(m.exports.connect(void 0,(e=>me({setSourceVideo:OJ,resetEditor:MJ},e)))(nQ)),iQ="NonStudioUploadContainer-module_cancel_g6boc",sQ="NonStudioUploadContainer-module_cancelIcon_9WNYy";class lQ extends r.exports.Component{constructor(e){super(e),a(this,"numRetries"),a(this,"unmounted"),a(this,"uploadAndConvertData"),a(this,"fileInfo"),a(this,"startUpload",(()=>{this.unmounted||this.setState({uploading:!0})})),a(this,"stopUpload",(()=>{this.unmounted||this.setState({uploading:!1})})),a(this,"setProgressText",(e=>{const{setUploadProgressText:t}=this.props;t(e),this.unmounted||this.setState({progressText:e})})),a(this,"returnAccepts",(()=>{const{allowAudio:e,disallowImages:t}=this.props;let a="video/mp4,video/*,video/3gpp,video/avi,video/x-flv,.mkv,video/x-ms-wmv";return e&&(a+=",.mp3,.wav"),t||(a+=",image/*"),a})),a(this,"handleError",((e,t="",a=!0)=>{const{showToast:o,resetEditor:n,history:r}=this.props;let i=e;e||(i="An error occurred while uploading. Please try again later."),n(),this.setProgressText(""),o({description:i,type:"error"}),this.stopUpload(),a&&r.goBack()})),a(this,"loadMetadataBeforeUpload",(e=>{const{isSubtitler:t,isAddAudioToVideo:a}=this.props,o=document.createElement("video");o.src=e.local_url||"",o.onloadedmetadata=()=>{e.duration=o.duration;const n=((e,t=!1,a=!1)=>{const{dispatch:o}=tn();let n=!0;return!JD(Ps.UNLIMITED_EXPORT_DURATION_LIMIT)&&(e.duration||0)>420?t&&(e.duration||0)>7200?o(Su({description:"You cannot export videos longer than 2 hour, but you can upgrade to download the SRT file.",type:"error"})):t?o(Su({description:"Your file is longer than 7 minutes. Upgrade to export videos longer than 7 minutes.",type:"warning"})):a?(o(Su({description:"Your content must be under 7 minutes.",type:"error"})),n=!1):o(Su({description:"Your file is longer than 7 minutes. Trim or upgrade to export videos longer than 7 minutes.",type:"warning"})):(e.duration||0)>7200&&(t?o(Su({description:"You cannot export videos longer than 2 hour, but you can download the SRT file.",type:"error"})):a?(o(Su({description:"Your content must be under 2 hour.",type:"error"})),n=!1):o(Su({description:"Your file is longer than 2 hour. You must trim your video to publish.",type:"warning"}))),n})(e,t,a);n?this.preProcessAndUpload(e):this.stopUpload()}})),a(this,"handleResumableUpload",(e=>{const{resetEditor:t,setSourceVideo:a,showToast:o,setProjectName:n,projectName:r,editorPath:i,isCartoonify:s}=this.props;if(""===r)if(e.name){let t=e.name;const a=t.split("."),o=a.pop();fP[o]&&(t=a.join(".")),n(t)}else null!=yP[i]&&n(yP[i]);this.setProgressText("Uploading ..."),vE({files:[{file:e}]}).then((o=>{const{read_uri:n,upload_uri:r}=o.uris[0],i=new URLSearchParams(r.split("?").slice(1).join("?"));let l=!1,d=!1;"image/gif"===e.type?l=!0:e.type.match(/.(jpg|jpeg|png)$/i)&&(d=!0);const c={_id:y(),lastModified:e.lastModified,lastModifiedDate:e.lastModifiedDate,size:e.size,type:e.type,uploadedAt:new Date,url:n,isGif:l,isImage:d,bucket:Or,name:i.get("name"),blob_name:i.get("name"),source:"upload",local_url:e.local_url,testFileKey:!0};this.fileInfo=c,s&&(t(),a(c)),this.uploadToGCS(r,e)})).catch((e=>{o({description:e.message,type:"error"}),this.stopUpload()}))})),a(this,"uploadToGCS",((e,t,a={})=>{const o=new XMLHttpRequest;o.open("PUT",e,!0),o.onload=()=>{this.onUploadFinish(o,t)},o.upload.onprogress=this.onUploadProgress,o.setRequestHeader("Content-Type",t.type),Object.entries(a).forEach((([e,t])=>{o.setRequestHeader(e,t)})),o.send(t),o.onerror=()=>{this.onUploadError(e,t,o.status)}})),a(this,"resumeUploadToGCS",((e,t)=>{const a=new XMLHttpRequest;a.open("PUT",e,!0),a.onload=o=>{if(308===o.target.status){const o=a.getResponseHeader("Range");if(!o)return void this.onUploadError(e,t,a.status);const n=parseInt(o.split("-").pop(),10);if(n<0)return void this.onUploadError(e,t,a.status);const r=n+1,i=t.size-1,s={"Content-Range":`bytes ${r}-${i}/${t.size}`};this.uploadToGCS(e,t.slice(r,i+1),s)}},a.upload.onprogress=e=>this.onUploadProgress(e),a.onerror=()=>{this.onUploadError(e,t,a.status)},a.setRequestHeader("Content-Range",`bytes */${t.size}`),a.send(t)})),a(this,"handleFileUpload",(async e=>{const{disallowImages:t,disallowVideo:a,showToast:o,allowedTypes:n,allowAudio:r,isCartoonify:i}=this.props,s=JD(Ps.UNLIMITED_UPLOAD_SIZE_LIMIT);let l;if(this.startUpload(),this.setProgressText("Starting upload..."),e.target?[l]=e.target.files:[l]=e,i||(l.local_url=URL.createObjectURL(l)),!l)return o({description:"Please choose a file to upload.",type:"error"}),void this.stopUpload();const d=aF(l);if(!i)try{const e=await hF(l.local_url,l);Object.assign(l,e)}catch(c){console.error(c)}d?r||!t||rF(d,n)?r||!a||nF(l.type)?r&&!["video/quicktime","audio/mp3","audio/mpeg","audio/wav","video/3gpp","video/avi","video/mp4","video/mpeg","video/ogg","video/webm","video/x-flv","video/x-matroska","video/x-ms-wmv"].includes(d)?(o({description:"Your audio file format is not currently supported. Currently we only support .mp3 and .wav formats.",type:"error"}),this.stopUpload()):r||nF(l.type)||rF(d,n)?await bF(l,l)?(l.conversion_type=tF(l.url,l.type),this.processConversion(l)):(l.size>6442450944?(o({description:"Your content must be under 6GB",type:"warning"}),this.stopUpload()):l.size>262144e3&&!s&&o({description:"Your upload is over 250MB. You may need to upgrade to use some Kapwing features.",type:"warning"}),l.type.includes("video")||l.type.includes("audio")?this.loadMetadataBeforeUpload(l):this.preProcessAndUpload(l)):(o({description:"Your file format is not currently supported. Currently we only support .gif, .jpg, .png, .mp4, .mov, .webm, .ogg, .mpeg formats.",type:"error"}),this.stopUpload()):(o({description:"You must choose an image to use this feature. Currently we support .jpg, .png, and .gif formats.",type:"error"}),this.stopUpload()):(o({description:"You must choose a video to use this feature. Currently we support .mp4, .mov, .webm, .ogg, and .mpeg formats.",type:"error"}),this.stopUpload()):(o({description:"Your upload has an invalid type. Please choose a video or image to upload, and make sure your file has a correct extension.",type:"error"}),this.stopUpload())})),a(this,"preProcessAndUpload",(e=>{const{resetEditor:t,isCartoonify:a}=this.props;a||(t(),e.source="local",this.handleFinish(e,!0,!0));try{ZO(e,this.setProgressText,this.handleError).then((e=>{this.handleResumableUpload(e)}))}catch(YEe){console.error("error during upload ",YEe),this.handleError("An error occurred during upload. Please make sure your media is a compatible format.","checkFileAndUpload")}})),a(this,"onUploadProgress",(e=>{if(e.lengthComputable){const t=`Uploading ... ${Math.round(e.loaded/e.total*100).toString()}%`;this.setProgressText(t)}})),a(this,"onUploadError",((e,t,a)=>{if(this.numRetries<3&&a>=500)return this.resumeUploadToGCS(e,t),void(this.numRetries+=1);this.handleError("An network error occurred during upload. Please check your internet connection and try again.","onUploadError")})),a(this,"onUploadFinish",(async(e,t)=>{200===e.status?await bF(t,t)?UG(this.fileInfo).then((async({asset:e,cmlFile:a})=>{HH(e,a),await bF(t,t)&&await l$({asset_id:e._id,resource:this.fileInfo.name,type:"blob",conversion_type:t.conversion_type}).then((e=>{this.fileInfo.conversion_id=e,this.setProgressText("Converting file to mp4 ...")}));const o=setInterval((async()=>{var e;const t=await d$(this.fileInfo.conversion_id),a=`Converting file to mp4 ... ${null==(e=t.progress)?void 0:e.conversion}%`;if(this.setProgressText(a),Zi.completed===t.status){const e={...this.fileInfo,url:t.output_url,conversion_id:this.fileInfo.conversion_id,asset_id:t.asset_id};delete e.local_url,this.handleFinish(e,!0,!0),clearInterval(o),this.uploadAndConvertData.timeToConvert=(Date.now()-this.uploadAndConvertData.startTime)/1e3,delete this.uploadAndConvertData.startTime,vc("Upload and convert, one-off",this.uploadAndConvertData),this.uploadAndConvertData={}}Zi.failed===t.status&&(clearInterval(o),this.uploadAndConvertData.timeToConvert=(Date.now()-this.uploadAndConvertData.startTime)/1e3,delete this.uploadAndConvertData.startTime,this.uploadAndConvertData.failed=!0,vc("Upload and convert, one-off",this.uploadAndConvertData),this.uploadAndConvertData={},this.setProgressText("Failed to convert"),setTimeout(this.stopUpload,1e3))}),5e3)})):(this.stopUpload(),this.setProgressText(""),UG(this.fileInfo).then((({asset:e,cmlFile:t})=>{this.fileInfo.asset_id=e._id,HH(e,t),this.handleFinish(this.fileInfo,!0,!0)}))):this.handleError(e.statusText||"An error occurred during upload. Please try again.","onUploadFinish")})),a(this,"handleFinish",(async(e,t=!1,a=!1)=>{const{destination:o,handleFinish:n,history:r,setSourceVideo:i}=this.props,{pathname:s}=r.location;try{return null!=n&&n(e),t&&o&&!s.includes("/upgrade")&&iT(o),a&&i(e),!0}catch(YEe){return console.error("error during upload ",YEe),this.handleError("An error occurred during upload. Please make sure your media is a compatible format.","handleFinish",!1),!1}})),this.state={uploading:!1,progressText:""},this.numRetries=0,this.uploadAndConvertData={},this.unmounted=!1}componentWillUnmount(){this.unmounted=!0}async processConversion(e,t){e.id=y();const{destination:a,ffmpegTranscode:o}=this.props;try{this.uploadAndConvertData.size=e.size,this.uploadAndConvertData.conversionType=e.conversion_type,this.uploadAndConvertData.startTime=Date.now(),this.handleResumableUpload(e)}catch(YEe){console.error("error during upload ",YEe),this.handleError("An error occurred during upload. Please make sure your media is a compatible format.","checkFileAndUpload"),t&&iT(t)}if((new kR).isSupportedByClient()&&"/editor/convert"===a)try{o({file:e})}catch(YEe){console.error(YEe)}}renderUploading(){const{progressText:e}=this.state;return i.createElement("div",{className:"upload-container"},i.createElement("div",{className:"upload-loading"},i.createElement("div",{className:"loader upload-loader"}),i.createElement("span",null,e||"Loading...")),i.createElement("div",{className:iQ,onClick:this.stopUpload},i.createElement("span",null,"Cancel"),i.createElement(nt,{className:sQ})))}renderDragUpload(){const{hideDragUploadDialog:e}=this.props;return i.createElement($J,{hideDragUploadDialog:e,handleDragUpload:this.handleFileUpload,showDragUploadDialog:!0,dragUpload:!0},i.createElement("div",{className:"drag-header"},"Upload video or image"),i.createElement(JJ,{returnAccepts:this.returnAccepts,handleMultiFileUpload:this.handleFileUpload,multiple:!0}))}renderNormalUpload(){const{destination:e,disallowImages:t,disallowVideo:a,sample:o,allowAudio:n,helperText:r,isOverlay:s=!1}=this.props,l=Ni({"upload-container":!0,"upload-overlay":s});return i.createElement("div",{className:l},i.createElement(oQ,{handleFileUpload:this.handleFileUpload,returnAccepts:this.returnAccepts}),i.createElement(aQ,{destination:e,disallowImages:t,disallowVideo:a,handleFinish:this.handleFinish,setProgressText:this.setProgressText,startUpload:this.startUpload,stopUpload:this.stopUpload}),i.createElement(rQ,{allowAudio:n,destination:e,handleFinish:this.handleFinish,sample:o,useImage:a}),i.createElement("div",{className:"upload-subtext"},r))}render(){const{uploading:e}=this.state,{showDragUploadDialog:t,ffmpegReducer:a}=this.props;if("FULFILLED"===a.ffmpegStatus&&void 0!==a.outputFile&&this.fileInfo){const e={...this.fileInfo};e.source="local",e.local_url=a.outputFileUrl,this.handleFinish(e,!1,!0)}return e?this.renderUploading():t?this.renderDragUpload():this.renderNormalUpload()}}const dQ=we(m.exports.connect((e=>({currentUser:e.currentUser,projectName:e.projectName,editorPath:e.editorPath,ffmpegReducer:e.ffmpegReducer})),(e=>me({setSourceVideo:OJ,resetEditor:MJ,setProjectName:JP,setUploadProgressText:FJ,ffmpegTranscode:CR,showToast:Su},e)))(lQ));function cQ(){return(e,t)=>{const{currentUser:a,sourceVideo:o}=t(),{token:n,user:r}=a||{},{_id:i}=r||{};return gu("/api/v1/videos",{body:{publish:!0,token:n,userId:i,video:{creatorId:i,done:!1,isCartoonify:!0,isImage:!0,lastSeen:new Date,progressText:"Loading ...",sourceVideo:o,submittedAt:new Date,watermark:!1}}})}}class uQ extends r.exports.Component{constructor(e){super(e),a(this,"handleFinish",(()=>{const{createCartoonifyImage:e,history:t}=this.props;this.setState({submitting:!0}),console.debug("Finished uploading"),e().then((e=>{this.setState({submitting:!1}),t.push(`/videos/${e._id}`)})).catch((e=>{console.error(e),Su({description:e.message,type:"error"}),this.setState({submitting:!1})}))})),this.state={submitting:!1}}componentDidMount(){lB({type:"default",fontFamily:"Just Me Again Down Here"},!0)}render(){const{submitting:e}=this.state;return i.createElement("div",null,i.createElement("div",{className:"startup-videos-wrapper"},i.createElement(rt,null,i.createElement("title",null,"Cartoonify Your Images Online – Kapwing"),i.createElement("meta",{name:"description",content:"Use Kapwing's cartoonify AI generator to turn your photo into a cartoon drawing. Upload any image to get your cartoon."}),i.createElement("meta",{name:"keywords",content:"cartoonify, cartoon image"}),i.createElement("link",{rel:"canonical",href:"https://www.kapwing.com/cartoonify"}))),i.createElement("div",{className:"cartoonify-container"},i.createElement("div",{className:"cartoonify-main-actions"},i.createElement("div",{className:"cartoonify-header"},"What happens when artificial intelligence tries to draw your photo?"),i.createElement("div",{className:"cartoonify-description"},i.createElement("b",null,"Cartoonify")," turns your photo into a cartoon drawing, powered by"," ",i.createElement("a",{href:"https://github.com/danmacnish/cartoonify",target:"_blank",rel:"noopener noreferrer"},"Draw This")," ","by"," ",i.createElement("a",{href:"http://danmacnish.com/2018/07/01/draw-this/",target:"_blank",rel:"noopener noreferrer"},"Dan Macnish")," ","and the Google"," ",i.createElement("a",{href:"https://github.com/googlecreativelab/quickdraw-dataset",target:"_blank",rel:"noopener noreferrer"},"QuickDraw dataset"),". Upload any image below to try it out!"),e?i.createElement("div",{className:"cartoonify-upload-loading"},i.createElement(CO,null)):i.createElement("div",{className:"cartoonify-upload"},i.createElement(dQ,{disallowVideo:!0,handleFinish:this.handleFinish,isCartoonify:!0})))),i.createElement("div",{className:"cartoonify-samples"},i.createElement("div",{className:"cartoonify-samples-header"},"Gallery"),i.createElement("div",{className:"cartoonify-sample-image-container"},i.createElement("img",{src:"https://i.imgur.com/LXZP7Gm.jpg",alt:"married couple",className:"cartoonify-sample-image"})),i.createElement("div",{className:"cartoonify-sample-image-container"},i.createElement("img",{src:"https://i.imgur.com/F83jS5G.png",alt:"married couple cartoon",className:"cartoonify-sample-image"})),i.createElement("div",{className:"cartoonify-sample-image-container"},i.createElement("img",{src:"https://i.imgur.com/L5hSdaH.jpg",alt:"dog with ball",className:"cartoonify-sample-image"})),i.createElement("div",{className:"cartoonify-sample-image-container"},i.createElement("img",{src:"https://i.imgur.com/F4xVyJP.png",alt:"dog with ball cartoon",className:"cartoonify-sample-image"})),i.createElement("div",{className:"cartoonify-sample-image-container"},i.createElement("img",{src:"https://i.imgur.com/TXbUKFV.png",alt:"dinner setting cartoon",className:"cartoonify-sample-image"})),i.createElement("div",{className:"cartoonify-sample-image-container"},i.createElement("img",{src:"https://i.imgur.com/zqrSkcL.jpg",alt:"dinner setting",className:"cartoonify-sample-image"})),i.createElement("div",{className:"cartoonify-sample-image-container"},i.createElement("img",{src:"https://i.imgur.com/cmbzJD2.png",alt:"cake cartoon",className:"cartoonify-sample-image"})),i.createElement("div",{className:"cartoonify-sample-image-container"},i.createElement("img",{src:"https://i.imgur.com/a38OHga.jpg",alt:"cake",className:"cartoonify-sample-image"})),i.createElement("div",{className:"cartoonify-sample-image-container"},i.createElement("img",{src:"https://i.imgur.com/boD9cbO.jpg",alt:"couple",className:"cartoonify-sample-image"})),i.createElement("div",{className:"cartoonify-sample-image-container"},i.createElement("img",{src:"https://i.imgur.com/yGA2WrC.png",alt:"couple cartoon",className:"cartoonify-sample-image"})),i.createElement("div",{className:"cartoonify-sample-image-container"},i.createElement("img",{src:"https://i.imgur.com/6cQPGMG.jpg",alt:"cat",className:"cartoonify-sample-image"})),i.createElement("div",{className:"cartoonify-sample-image-container"},i.createElement("img",{src:"https://i.imgur.com/5RWBf1S.png",alt:"cat",className:"cartoonify-sample-image"}))),i.createElement("div",{className:"cartoonify-container"},i.createElement("div",{className:"cartoonify-samples-header"},"About this project"),i.createElement("div",{className:"cartoonify-description"},i.createElement("b",null,"Cartoonify")," uses a neural network to turn your uploaded photo into a unique cartoon. This project was based off of Dan Macnish's"," ",i.createElement("a",{href:"http://danmacnish.com/2018/07/01/draw-this/"},"Draw This project"),", which was a camera that turned the images it took into cartoons.",i.createElement("p",null,"Instead of requiring a Raspberry Pi based camera, this site allows anyone to try cartooning any image."),i.createElement("p",null,"For best results, try using images with clear objects on a solid background."),i.createElement("p",{className:"cartoonify-bottom-hero-image-container"},i.createElement("img",{src:"https://i.imgur.com/vyiDq0y.png",alt:"bicycles",className:"cartoonify-bottom-hero-image"})))),i.createElement("div",{className:"share-footer"},i.createElement(it,{url:"https://www.kapwing.com/cartoonify",quote:"Cartoonify - can a neural network turn your photo into a simple cartoon?",className:"startup-demo-share-button"},i.createElement(st,{size:40,round:!0})),i.createElement(lt,{url:"https://www.kapwing.com/cartoonify",title:"Cartoonify - can a neural network turn your photo into a simple cartoon?",via:"kapwingapp",hashtags:["cartoon","ai"],className:"startup-demo-share-button"},i.createElement(dt,{size:40,round:!0})),i.createElement("div",{className:"startup-demo-videos-text"},"Created with love by the team at"," ",i.createElement("a",{href:"https://www.kapwing.com"},"Kapwing"))),i.createElement(DJ,null))}}const mQ=we(m.exports.connect((e=>({sourceVideo:e.sourceVideo})),(e=>me({createCartoonifyImage:cQ,showToast:Su},e)))(uQ)),pQ=({children:e,...t})=>{const[a,o]=i.useState(!1);return r.exports.useEffect((()=>{o(!0)}),[]),a?i.createElement(i.Fragment,{...t},e):null},hQ="UpgradePill-module_upgradePill_xkjUA",gQ="UpgradePill-module_proSparkle_-APHJ",yQ=({action:e=Rs.HEADER,className:t=""})=>{const a=HU();return i.createElement("div",{className:`${hQ} ${t}`,onClick:t=>{t.stopPropagation(),a((()=>{}),{action:e})()},"data-testid":"upgrade-pill","data-cy":"upgrade-pill"},"Upgrade",i.createElement(Pn,{className:gQ}))},fQ="SubscriptionStatePill-module_reactivatePill_3CQxI",EQ="SubscriptionStatePill-module_proSparkle_9cSXz",vQ="SubscriptionStatePill-module_pastDuePill_XQCI0",wQ=({className:e=""})=>{const t=Ie(),a=id(),{subscription:o}=af(),{isPastDue:n}=gd(o),r=e=>{e.stopPropagation(),t.push(`/team/${a._id}/billing`)};return o?fd(o)?i.createElement("div",{className:`${fQ} ${e}`,onClick:r,"data-testid":"reactivate-pill","data-cy":"reactivate-pill"},"Reactivate",i.createElement(Pn,{className:EQ})):n?i.createElement("div",{className:`${vQ} ${e}`,"data-testid":"past-due-pill","data-cy":"past-due-pill",onClick:r},"Payment Incomplete"):null:null},bQ=(e,t,a)=>{const o=t||200,n=a||200,{fb_id:r,loggedInWith:i,picture:s,customPicture:l}=e||{};let d;switch((i||"").toLowerCase()){case"facebook":d=`https://graph.facebook.com/${r}/picture?width=${o}&height=${n}`;break;case"google":d=s?`${s}?sz=${o}`:void 0;break;default:d=s||void 0}var c;return l&&(d=(c=l).startsWith("https://cdn.kapwing.com")?c.replace("https://cdn.kapwing.com",Ur):c),d},_Q=({height:e,letter:t,width:a})=>{const o=document.createElement("canvas");o.width=a,o.height=e;const n=o.getContext("2d");if(n)return n.fillStyle="#78909C",n.fillRect(0,0,a,e),n.font=`normal ${a/2}px sans-serif`,n.textAlign="center",n.textBaseline="middle",n.fillStyle="white",n.fillText(t,a/2,e/2),o.toDataURL("image/png")};class TQ extends r.exports.Component{constructor(e){super(e),a(this,"onImageError",(()=>{this.setState({error:!0})})),this.state={error:!1}}render(){const{currentUser:e,custom:t,suggestedWidth:a,suggestedHeight:o,absoluteWidth:n,absoluteHeight:r,className:l,team:d}=this.props,{error:c}=this.state;let u={};const m=!(!this.props.user||!("pending"in this.props.user))&&this.props.user.pending;u=this.props.user&&!s.exports.isEmpty(this.props.user)?this.props.user:e.user;const p=a||300,h=o||300;let g;if(c||m||t||d||(g=bQ(u,p,h)),!c&&d&&"personal"!==d._id&&d.picture&&(g=d.picture),!g){let a="";if(t&&t.name)a=t.name.charAt(0).toUpperCase();else if(d&&d.name)a=d.name.charAt(0).toUpperCase();else if(m&&u.name)a=u.name.charAt(0).toUpperCase();else if(this.props.user&&!s.exports.isEmpty(this.props.user)){const{firstName:e}=u;e&&(a=e.charAt(0).toUpperCase())}if(!a){const t=mc(e);t&&(a=t.charAt(0).toUpperCase())}g=_Q({height:h,letter:a,width:p})}return n&&r?i.createElement("img",{width:n,height:r,src:g,alt:"",className:l,"data-cy":"profile-picture","data-testid":"profile-picture",onError:this.onImageError}):i.createElement("img",{src:g,alt:"",className:l,"data-cy":"profile-picture","data-testid":"profile-picture",onError:this.onImageError})}}const SQ=m.exports.connect((e=>({currentUser:e.currentUser})))(TQ);class IQ extends r.exports.Component{constructor(){super(...arguments),a(this,"handleError",((e,t="signIn",a="Sign In")=>{const{showToast:o}=this.props;let n=e;e||(n="An error occurred during sign in with One Tap. Please try again later."),vc("Sign In Error Occurred",{"Error Type":t,Details:a,"One-Tap":!0}),o({description:n,type:"error"})})),a(this,"handleGoogleSuccessResponse",(e=>{const{fetchGoogleUser:t}=this.props;t(e,!0).catch((e=>{this.handleError(e.message,"fetchGoogleUser")}))}))}componentDidMount(){"undefined"!=typeof window&&(window.oneTapHandleSuccess=e=>{this.handleGoogleSuccessResponse(e)})}render(){var e,t,a;const{user:o}=this.props;return s.exports.isEmpty(o)?i.createElement("div",{id:"g_id_onload","data-client_id":"823730063895-iqn5t0hivtu1ss7c2mhpfdmh1ghlf9fa.apps.googleusercontent.com","data-callback":"oneTapHandleSuccess","data-itp_support":"true","data-cancel_on_tap_outside":"false"}):(null==(a=null==(t=null==(e=window.google)?void 0:e.accounts)?void 0:t.id)||a.cancel(),null)}}const xQ=we(m.exports.connect((e=>({user:e.currentUser.user})),(e=>me({fetchGoogleUser:Qc,showToast:Su},e)))(IQ)),kQ={upsellButton:"HeaderBar-module_upsellButton_-TB89",darkUpsellButton:"HeaderBar-module_darkUpsellButton_xOVIr",lightSparkle:"HeaderBar-module_lightSparkle_wE6a2",workspaceLink:"HeaderBar-module_workspaceLink_J1fiZ",divider:"HeaderBar-module_divider_r-sB3",workspaceDropDown:"HeaderBar-module_workspaceDropDown_d9WUp",plusIcon:"HeaderBar-module_plusIcon_dHLMZ",workspaceSwitcher:"HeaderBar-module_workspaceSwitcher_0qJrS",profileImage:"HeaderBar-module_profileImage_esu87",profileImageWithEmail:"HeaderBar-module_profileImageWithEmail_BzRZo",userName:"HeaderBar-module_userName_USIud",menuIcon:"HeaderBar-module_menuIcon_U0IHM",menu:"HeaderBar-module_menu_IWxm0",headerLinkText:"HeaderBar-module_headerLinkText_2leOT",headerActiveLinkText:"HeaderBar-module_headerActiveLinkText_h-inP",headerBar:"HeaderBar-module_headerBar_bSCyV",impersonating:"HeaderBar-module_impersonating_aKakH",headerBarEmpty:"HeaderBar-module_headerBarEmpty_7xuJg",headerRight:"HeaderBar-module_headerRight_8gDQm",headerLeft:"HeaderBar-module_headerLeft_UbvUw",headerMiddle:"HeaderBar-module_headerMiddle_b816Y",menuLogoImage:"HeaderBar-module_menuLogoImage_bbzDs",headerBarLogoText:"HeaderBar-module_headerBarLogoText_-wwuS",headerBarLogoImage:"HeaderBar-module_headerBarLogoImage_ZwwLj",hideMobile:"HeaderBar-module_hideMobile_YKjEF",hideDesktop:"HeaderBar-module_hideDesktop_xJuMZ",signedInContainer:"HeaderBar-module_signedInContainer_-giip",accountName:"HeaderBar-module_accountName_rI-4h",accountNameWithEmail:"HeaderBar-module_accountNameWithEmail_EeiGe",email:"HeaderBar-module_email_KPhaQ",accountLink:"HeaderBar-module_accountLink_3r30W",proLabel:"HeaderBar-module_proLabel_-pF20",planLabel:"HeaderBar-module_planLabel_8mUnY",basicLabel:"HeaderBar-module_basicLabel_mRaDf",freeLabel:"HeaderBar-module_freeLabel_sYx10",pill:"HeaderBar-module_pill_3sGIa",badges:"HeaderBar-module_badges_8PPmC"},CQ=async(e="",t="")=>{const{history:a,dispatch:o}=tn(),n=await o(gR(t,e))||"";await o(VE()),qf(e),a.push(`/folder/${n}`)},AQ=async(e="")=>{const{history:t,dispatch:a,state:o}=tn(),{teams:{allTeams:n},workspaces:{allWorkspaces:r}}=o;let i="",s="";const l=n.find((e=>e.primary));if(l){i=l._id;const e=r.find((e=>e.teamId===i));s=null==e?void 0:e._id}s||(s=await a(gR(e,i))),s?t.push(`/folder/${s}`):t.push("/home")},NQ=e=>{const{history:t,dispatch:a}=tn();a(yv(e)),t.push(`/folder/${e}`)},PQ=e=>{const{history:t,dispatch:a}=tn();vc("Open Shared with Me",{location:e}),a(yv(mi)),t.push("/shared-with-me")},RQ=e=>{const t=oP(e);return t&&!!(null==t?void 0:t.sharedAt)},LQ=(e,t)=>{const{history:a,dispatch:o}=tn(),n=function(e,t){const{allWorkspaces:a}=tn().state.workspaces,o=SE(a,e).find((e=>e._id!==t));return(null==o?void 0:o._id)||""}(t,e);o(yv(n)),a.push(`/folder/${n}`)};function DQ(e){const{state:t}=tn(),{token:a,user:o}=t.currentUser||{};return gu(`/api/v1/admin/users/${e}`,{body:{token:a,userId:o._id}})}function OQ(e){const{state:t}=tn(),{token:a,user:o}=t.currentUser||{},{_id:n}=o;return gu("/api/v1/admin/fetchUserByEmail",{body:{email:e,token:a,userId:n}})}function FQ(e,t){const{state:a}=tn(),{token:o,user:n}=a.currentUser||{};return gu("/api/v1/admin/fetchContentByEmail",{body:{targetUserEmail:e,pageNum:t,token:o,userId:n._id}})}function MQ(e,t){return gu("/api/v2/admin/addStripeId",{body:{targetTeamId:t,stripeId:e}})}function UQ(e){const{state:t}=tn(),{user:a}=t.currentUser||{};return gu("/api/v2/admin/removeStripeId",{body:{targetTeamId:e,userId:a._id}})}function BQ(e,t){const{state:a}=tn(),{token:o,user:n}=a.currentUser||{};return gu("/api/v2/admin/upgradeTeam",{body:{targetTeamId:e,planTier:t,token:o,userId:n._id}})}function WQ(e){const{state:t}=tn(),{token:a,user:o}=t.currentUser||{};return gu("/api/v2/admin/setTeamToFree",{body:{targetTeamId:e,token:a,userId:o._id}})}function VQ(e,t){const{state:a}=tn(),{token:o,user:n}=a.currentUser||{};return gu("/api/v1/admin/updateAccountType",{body:{targetUserId:e,newAccountType:t,token:o,userId:n._id}})}function jQ(){return()=>Eu("stripe_stats",{timeout:6e4,includeAuth:!0})}function GQ(e){return async(t,a)=>{const{token:o,user:n,impersonatingAdminEmail:r}=a().currentUser;t(LE(""));const i=await gu("/api/v1/admin/impersonateUser",{parseJSON:!0,body:{token:o,userId:n._id,userToImpersonateId:e}});await t(qc(i.user,i.token,r||n.email)),await t(jE()),await t(gR()),TO()}}function HQ(){return async(e,t)=>{const{token:a,user:o}=t().currentUser,{history:n}=tn();e(LE(""));const r=await gu("/api/v1/admin/revertImpersonation",{parseJSON:!0,body:{token:a,userId:o._id}});await e(qc(r.user,r.token)),await e(jE()),await e(HE());const i=await e(gR());i?(e=>{const{history:t,dispatch:a}=tn();a(yv(e)),t.push(`/folder/${e}`)})(i):n.push("/home"),TO()}}function zQ(e){return gu("/api/v2/admin/blockSuggestedDomain",{body:{domain:e}})}const $Q="AdminImpersonationWarning-module_spacer_VCvul",KQ="AdminImpersonationWarning-module_contentBox_oZsGS",YQ="AdminImpersonationWarning-module_warningText_ugxIc",qQ="AdminImpersonationWarning-module_dangerIcon_BMphk",XQ=m.exports.connect((e=>({currentUser:e.currentUser})),(e=>me({revertUserImpersonation:HQ},e)))((({className:e,currentUser:t,revertUserImpersonation:a})=>{const{user:o,impersonatingAdminEmail:n}=t,{email:i}=o;if(!n)return null;return r.exports.createElement("div",{className:`${$Q} ${e||""}`},r.exports.createElement("span",{className:qQ,style:{left:"4px"}},"⚠"),r.exports.createElement("div",{className:KQ},r.exports.createElement("span",{className:YQ},"Admin - You are acting as ",r.exports.createElement("b",null,i),"."),r.exports.createElement("button",{type:"button",onClick:async()=>{await a()}},"Revert to ",n)),r.exports.createElement("span",{className:qQ,style:{right:"4px"}},"⚠"))})),JQ=({currentUser:e,isMobile:t})=>{const a=mc(e),o=pc(e),n=sd();return i.createElement("div",{className:kQ.signedInContainer},i.createElement("div",{className:kQ.badges},i.createElement(wQ,{className:kQ.pill,entryPoint:"Workspace Header Pill"}),n.showUpgrades&&i.createElement(i.Fragment,null,i.createElement("div",{className:kQ[`${n.name.toLowerCase()}Label`]},n.name," Plan"),i.createElement("div",{"data-cy":"upgrade-label-header"},i.createElement(yQ,{className:kQ.pill})))),i.createElement(ct,{to:{pathname:"/home",state:{openModal:EJ.account}},className:kQ.headerLinkText,activeClassName:kQ.headerActiveLinkText,"data-cy":"account-nav-link"},i.createElement("div",{className:kQ.accountLink},i.createElement("div",null,i.createElement("div",{className:o?kQ.accountNameWithEmail:kQ.accountName},a||"My Account"),!t&&o&&i.createElement("div",{className:kQ.email},o)),i.createElement("div",null,i.createElement(SQ,{suggestedWidth:300,suggestedHeight:300,className:o?kQ.profileImageWithEmail:kQ.profileImage})))))},QQ=we(m.exports.connect((e=>({currentUser:e.currentUser,workspaces:e.workspaces,allWorkspaces:e.workspaces.allWorkspaces,currentFolderId:e.workspaces.selectedWorkspace})))((e=>{const{currentUser:t,history:a,location:o}=e,n=sc(t),[s,l]=r.exports.useState(!1),[d,c]=r.exports.useState(!1),[u,m]=r.exports.useState(!1),p=Si(),h=r.exports.useRef(null);r.exports.useEffect((()=>{c(!1)}),[o]);const g=e=>{h&&h.current&&h.current.contains(e.target)||c(!1)};r.exports.useEffect((()=>(document.addEventListener("mousedown",g),()=>{document.removeEventListener("mousedown",g)})),[]);const y=()=>sc(t)?e.currentFolderId?`/folder/${e.currentFolderId}`:"/home":"/",f=()=>i.createElement(i.Fragment,null,i.createElement("a",{className:kQ.headerLinkText,href:"/tools","data-cy":"tools-nav-link"},"Tools"),i.createElement("a",{className:kQ.headerLinkText,href:"/ai","data-cy":"tools-nav-link"},"AI"),i.createElement("a",{className:kQ.headerLinkText,href:"/templates","data-cy":"templates-nav-link"},"Templates"),i.createElement("a",{className:kQ.headerLinkText,target:"_blank",rel:"noopener noreferrer",href:"https://www.kapwing.com/resources"},"Learn"),i.createElement("a",{className:kQ.headerLinkText,href:"/pricing","data-cy":"pricing-nav-link"},"Pricing"));return i.createElement(i.Fragment,null,i.createElement(xQ,null),i.createElement("div",{className:kQ.headerBar+(Of(t)?` ${kQ.impersonating}`:"")},i.createElement(XQ,null),p?i.createElement(i.Fragment,null,i.createElement("div",{className:kQ.headerLeft},i.createElement("a",{href:y()},i.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/9XE-logo-small.webp",alt:"Kapwing Logo",className:kQ.headerBarLogoImage,"data-cy":"header-logo",width:36,height:36})),i.createElement("a",{className:kQ.headerBarLogoText,href:y()},"KAPWING")),d?i.createElement("div",{className:kQ.menu,ref:h},f()):null):i.createElement(i.Fragment,null,i.createElement("div",{className:kQ.headerLeft},i.createElement("a",{href:y()},i.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/9XE-logo-small.webp",className:kQ.headerBarLogoImage,alt:"Kapwing Logo","data-cy":"header-logo",width:36,height:36})),i.createElement("a",{className:kQ.headerBarLogoText,href:y()},"KAPWING")),i.createElement("div",{className:kQ.headerMiddle},f())),i.createElement(pQ,null,i.createElement("div",{className:kQ.headerRight},n&&nd()?i.createElement(JQ,{currentUser:t,isMobile:p,showPaywall:u,setShowPaywall:m}):i.createElement("div",{className:kQ.headerLinkText,onClick:()=>{l(!0)},"data-cy":"signin-nav-link"},"Sign In"),p?d?i.createElement(pe,{"data-cy":"mobile-nav-menu-toggle",className:kQ.menuIcon,onClick:()=>{c(!d)}}):i.createElement(ut,{"data-cy":"mobile-nav-menu-toggle",className:kQ.menuIcon,onClick:()=>{c(!d)}}):null),s?i.createElement(ZF,{hideSignIn:()=>{l(!1)},onSuccess:()=>{a.push(y())}}):null)))}))),ZQ="EduLogin-module_background_Uy-3-",eZ="EduLogin-module_backgroundImage_mlfkY",tZ="EduLogin-module_signInContainer_MyMim",aZ="EduLogin-module_signInHeader_60jiv",oZ="EduLogin-module_signInText_-ZNvH",nZ="EduLogin-module_text_ss9wC",rZ="EduLogin-module_signInBox_zT-YJ",iZ=()=>{const e="EDU Program Sign In — Kapwing",t="Sign in to apply to the EDU Program offered by Kapwing. Kapwing PRO is 100% free for qualified students, teachers, and educators.";return i.createElement(i.Fragment,null,i.createElement(QQ,null),i.createElement(rt,null,i.createElement("title",null,e),i.createElement("meta",{name:"description",content:t}),i.createElement("meta",{property:"og:title",content:e}),i.createElement("meta",{property:"og:description",content:t}),i.createElement("meta",{name:"robots",content:"noindex, nofollow"})),i.createElement("div",{className:ZQ},i.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/U90-Kit-Bob-Background.webp",alt:"student kit and bob",className:eZ}),i.createElement("div",{className:tZ},i.createElement("div",{className:aZ},"Sign in to get started with Kapwing for Education"),i.createElement("div",{className:oZ},i.createElement("div",{className:nZ},"Please sign in with your official school email address.")),i.createElement("div",{className:rZ},i.createElement(jF,{immediateRedirectPathname:"/edu/signup"})))),i.createElement(DJ,null))},sZ="EduSignup-module_container_8iB8J",lZ="EduSignup-module_typeformBackground_zAuBk",dZ="EduSignup-module_typeformWidget_Woiw9",cZ=()=>{const e=tr((e=>e.currentUser)),t=uc(e),a=pc(e),o=sc(e);if(r.exports.useEffect((()=>{o||iT("/edu/login")})),!o||void 0===o)return null;const n="EDU Program Sign up — Kapwing",s="Sign up and apply to the EDU Program offered by Kapwing. Kapwing PRO is 100% free for qualified students, teachers, and educators.";return i.createElement(i.Fragment,null,i.createElement(QQ,null),i.createElement(rt,null,i.createElement("title",null,n),i.createElement("meta",{name:"description",content:s}),i.createElement("meta",{property:"og:title",content:n}),i.createElement("meta",{property:"og:description",content:s}),i.createElement("meta",{name:"robots",content:"noindex, nofollow"})),i.createElement("div",{className:sZ},i.createElement("div",{className:lZ},i.createElement(mt.exports.Widget,{id:"yz2hQIEC",hidden:{kapwing_name:t,kapwing_email:a},onSubmit:e=>{(async e=>{await gu("/api/v1/edu/submit",{body:{userID:t,userEmail:a,responseID:e}})})(e.responseId)},className:dZ}))),i.createElement(DJ,null))},uZ=()=>{const e="EDU Program Sign Up — Kapwing",t="Sign up as a district admin and apply for the EDU Program offered by Kapwing. Kapwing PRO is 100% free for qualified students, teachers, and educators.";return i.createElement(i.Fragment,null,i.createElement(QQ,null),i.createElement(rt,null,i.createElement("title",null,e),i.createElement("meta",{name:"description",content:t}),i.createElement("meta",{property:"og:title",content:e}),i.createElement("meta",{property:"og:description",content:t}),i.createElement("meta",{name:"robots",content:"noindex, nofollow"})),i.createElement("div",{className:sZ},i.createElement("div",{className:lZ},i.createElement(mt.exports.Widget,{id:"agzKsq7v",className:dZ}))),i.createElement(DJ,null))};function mZ(e,t){return()=>gu("/api/v1/email/add",{body:{email:e,source:t,submittedAt:new Date}})}const pZ={home:"common-module_home_1RmXS",homeHowBackgroundWhite:"common-module_homeHowBackgroundWhite_tmS3r",largeButton:"common-module_largeButton_mqeEp",sectionContent:"common-module_sectionContent_oGtD5",sectionHeader:"common-module_sectionHeader_lqs-I",spacer:"common-module_spacer_4jJEN",chevron:"common-module_chevron_ue8Fs",splashText:"common-module_splashText_XxRuH",splashSubtext:"common-module_splashSubtext_doe31",aboutSection:"common-module_aboutSection_67WbE",mobile:"common-module_mobile_xYfSm",desktop:"common-module_desktop_r-fmO",screenReaderOnlyLabel:"common-module_screenReaderOnlyLabel_W-yva",disabled:"common-module_disabled_qze4D",noScrollBar:"common-module_noScrollBar_rA8Ld",textOverflowEllipsis:"common-module_textOverflowEllipsis_eFSw-",genericButtonBlue:"common-module_genericButtonBlue_2nvue"};class hZ extends r.exports.Component{constructor(e){super(e),a(this,"renderSubmitted",(()=>i.createElement("div",{className:"youre-in"},"You're in! Thanks for signing up!"))),this.state={emailValue:"",loading:!1,submitted:!1},this.handleChange=this.handleChange.bind(this),this.handleSubmit=this.handleSubmit.bind(this)}handleChange(e){this.setState({emailValue:e.target.value})}handleSubmit(e){e.preventDefault();const{emailValue:t}=this.state,{addEmail:a,source:o}=this.props;this.setState({loading:!0}),a(t,o).then((()=>{this.setState({loading:!1,submitted:!0})})).catch((e=>{Iu({description:"There was an error signing up.",error:e}),this.setState({loading:!1})}))}renderCollection(){const{emailValue:e,loading:t}=this.state;return i.createElement("form",{onSubmit:this.handleSubmit,className:"subscribe-form"},i.createElement("label",{htmlFor:"email-subscribe"},i.createElement("span",{className:pZ.screenReaderOnlyLabel},"Email"),i.createElement("input",{id:"email-subscribe",placeholder:"youremail@gmail.com",type:"text",className:"primary-text-field email-subscribe-input",value:e,onChange:this.handleChange})),t?i.createElement("button",{type:"submit",className:"primary-button email-subscribe-button"},"Loading..."):i.createElement("button",{type:"submit",className:"primary-button email-subscribe-button"},"Sign up"))}render(){const{submitted:e}=this.state;return i.createElement("div",null,e?this.renderSubmitted():this.renderCollection())}}const gZ=m.exports.connect(void 0,(e=>me({addEmail:mZ},e)))(hZ),yZ=[{id:"google",name:"Google",image:"https://i.imgur.com/qvCOvDE.jpg",logo:"https://i.imgur.com/RUYUxk0.jpg",date:"1998",description:"See the evolution of Google from the early days at Stanford to the iconic company it is today.",states:[{year:"1998",description:"The early days of Google, when Larry and Sergey still were at Stanford.",image:"https://i.imgur.com/gesKoOF.png",link:"https://web.archive.org/web/19981111183552/http://google.stanford.edu:80/"},{year:"2000",description:"Google implements its iconic, simple homepage, but still is focused on search, not any other products.",image:"https://i.imgur.com/yhmmQvJ.png",link:"https://web.archive.org/web/20000301214819/http://google.com:80/"},{year:"2002",description:"Google introduces image search, groups, and some other search features.",image:"https://i.imgur.com/Ws1RiTX.png",link:"https://web.archive.org/web/20020222232203/http://www.google.com:80/"},{year:"2004",image:"https://i.imgur.com/CuNRKyh.png",link:"https://web.archive.org/web/20040221050042/http://www.google.com:80/"},{year:"2006",description:"By 2006, Google starts looking much like the simple, centered home page of today.",image:"https://i.imgur.com/vMmprt2.png",link:"https://web.archive.org/web/20060301031331/http://www.google.com/"},{year:"2012",description:"Fast forward another 6 years, and Google simplifies its homepage further, and shifts to a header bar UI.",image:"https://i.imgur.com/WPJR94n.png",link:"https://web.archive.org/web/20120227195823/http://www.google.com/"},{year:"2016",description:"By 2006, Google starts looking much like the simple, centered home page of today.",image:"https://i.imgur.com/f8LQfDv.png",link:"https://web.archive.org/web/20060301031331/http://www.google.com/"},{year:"Today",description:"Google introduces a new, flatter logo, but still maintains its simple, uncluttered homepage.",image:"https://i.imgur.com/UnQhOkQ.png",link:"https://www.google.com/"}]},{id:"amazon",name:"Amazon",image:"https://i.imgur.com/rPSZBZY.jpg",logo:"https://i.imgur.com/g8O5Sur.jpg",date:"1999",description:"Bookseller to electronics to personalization and content creation to everything else. Here's how an ecommerce trickle turned into the Amazon",states:[{year:"1999",description:"Books take center stage on the original Amazon landing page.",image:"https://i.imgur.com/jwJsUEZ.png",link:"https://web.archive.org/web/19990828014913/http://www.amazon.com:80/"},{year:"2001",description:"Early on, Amazon prominently advertises personalized recommendations on the home page.",image:"https://i.imgur.com/XX7upff.png",link:"https://web.archive.org/web/20010630235838/http://www.amazon.com:80/exec/obidos/subst/home/home.html"},{year:"2005",description:"Introducing Amazon Prime! Two-day shipping makes its debut.",image:"https://i.imgur.com/q22junf.png",link:"https://web.archive.org/web/20050531233632/http://www.amazon.com:80/exec/obidos/subst/home/home.html"},{year:"2008",description:"Introducing Kindle. Amazon pivots towards electronics. Also, where did the search bar go?",image:"https://i.imgur.com/DsMabM8.png",link:"https://web.archive.org/web/20080301234936/http://www.amazon.com:80/"},{year:"2011",description:"The categories on the left show a clear shift towards electronics and TV.",image:"https://i.imgur.com/5nWXqaD.png",link:"https://web.archive.org/web/20110715002059/http://www.amazon.com/"},{year:"2013",description:"Amazon launches a more mobile-friendly version of the site with personalized recommendations and extended vertical scroll",image:"https://i.imgur.com/jppfbI9.png",link:"https://web.archive.org/web/20130531235338/http://www.amazon.com/"},{year:"Today",description:"Today, Amazon shows off their inventory with more visuals, less text. and bold colors.",image:"https://i.imgur.com/yqZ4QkK.png",link:"https://www.amazon.com/"}]},{id:"pinterest",name:"Pinterest",image:"https://i.imgur.com/b75lGep.png",logo:"https://i.imgur.com/OfE2Yh1.jpg",date:"2010",description:"Pinterest started with small groups of enthusiastic users, wanting to pin their favorite images from across the web.",meta:{title:"Evolution of Pinterest – Kapwing",description:"See how Pinterest evolved from an invite-only website for users to pin images to the online destination for visual inspiration for everyone."},states:[{year:"2010",description:"For a long time, joining Pinterest was by invite only. But the content was available for everyone.",image:"https://i.imgur.com/o7Xy4Jl.png",link:"https://web.archive.org/web/20110131073434/http://pinterest.com:80/"},{year:"2012",description:"By 2012, Pinterest introduced its iconic red color.",image:"https://i.imgur.com/FqL1q5v.png",link:"https://web.archive.org/web/20120131141949/https://www.pinterest.com/"},{year:"2014",description:"Pinterest quickly gained popularity for its quirky images and high quality content.",image:"https://i.imgur.com/fBs78Gv.png",link:"https://web.archive.org/web/20140812045916/http://www.pinterest.com/all/animals/"},{year:"Today",description:"Today Pinterest is a destination for ideas, especially those that involve highliy visual content.",image:"https://i.imgur.com/HvgP6fy.png ",link:"https://www.pinterest.com/"}]},{id:"facebook",name:"Facebook",image:"https://i.imgur.com/jGnmW6z.png",logo:"https://i.imgur.com/ZaZkeBt.jpg",date:"2004",description:"Watch one of the most popular websites in the world grow up!",states:[{year:"2004",description:'Facebook started as a social network for college students. You can see on their home page their claim as a "Mark Zuckerberg Production".',image:"https://i.imgur.com/8bM2yqy.png",link:"https://web.archive.org/web/19981111183552/http://google.stanford.edu:80/"},{year:"2008",description:"Facebook's landing page changes to reflect a more globally appealing service",image:"https://i.imgur.com/MnV886O.png",link:"https://web.archive.org/web/20090722142049/http://www.facebook.com/"},{year:"2009",description:"Facebook's famous Wall is used by millions to communicate with each other",image:"https://i.imgur.com/IX05Lyd.png",link:"https://web.archive.org/web/20090722142049/http://www.facebook.com/zuck"},{year:"2012",description:"Facebook turns its attention to mobile.",image:"https://i.imgur.com/5AoFmRV.png",link:"https://web.archive.org/web/20120722140441/https://www.facebook.com/"},{year:"Today",description:"The Facebook homepage has not changed much, but the product and its services definitely have",image:"https://i.imgur.com/eN3eGRb.png",link:"https://www.facebook.com/"}]},{id:"youtube",name:"YouTube",image:"https://i.imgur.com/JqulZ1O.png",logo:"https://i.imgur.com/4gegwsM.jpg",date:"2005",description:"YouTube was started by three former Paypal employees - Chad Hurley, Steve Chen, and Jawed Karim - who went on to sell the company to Google.",states:[{year:"2006",description:"In the early days of YouTube, there was a single feed that everyone consumed of popular videos on the site.",image:"https://i.imgur.com/GPZH7Z0.png",link:"https://web.archive.org/web/20060303064630/http://www.youtube.com/"},{year:"2008",description:"By 2008, Youtube had developed its iconic player and started surfacing trending video content on the web.",image:"https://i.imgur.com/Oohhd1Q.pngg",link:"https://web.archive.org/web/20080306015406/http://www.youtube.com/"},{year:"2010",description:"Youtube's integration with Google brought changes, some popular and others not so much.",image:"https://i.imgur.com/RSrULXl.png",link:"https://web.archive.org/web/20100306024813/http://www.youtube.com:80/"},{year:"2012",description:"YouTube relied heavily on Flash, and also began showing ads alongside content.",image:"https://i.imgur.com/7gXP0Vu.png",link:"https://web.archive.org/web/20120731224216/http://www.youtube.com/"},{year:"2016",description:"By 2016, YouTube had a very similar look and feel to the content today, with many popular channels for users to choose from.",image:"https://i.imgur.com/Bj3Tgy9.png",link:"https://web.archive.org/web/20160731223744/https://www.youtube.com/"},{year:"Today",description:"Today YouTube is one of the most popular video sharing sites out there!",image:"https://i.imgur.com/RwuvuZL.png",link:"https://www.youtube.com/"}]},{id:"reddit",name:"Reddit",image:"https://i.imgur.com/jUDALgT.jpg",logo:"https://i.imgur.com/bbDAN5t.jpg",date:"2005",description:"Not much has changed about Reddit's design over the last decade, until very recently. But, the community has grown to be one of the most vibrant on the internet.",states:[{year:"2005",description:"In the beginning, Reddit was just an interesting collection of links on the homepage.",image:"https://i.imgur.com/SkvHFAC.png",link:"https://web.archive.org/web/20051128021349/http://reddit.com:80/"},{year:"2007",description:"As more and more people joined the community, sub-reddits started emerging around different topics.",image:"https://i.imgur.com/2GJUO1u.png",link:"https://web.archive.org/web/20071128120627/http://reddit.com:80/"},{year:"2009",description:"Reddit's design from 2009 looks very similar to the homepage today, but note the lower number of upvotes on the homepage.",image:"https://i.imgur.com/tP2S7ug.png",link:"https://web.archive.org/web/20091125194850/http://www.reddit.com/"},{year:"2015",description:"Five years later, Reddit introduces new features like Reddit Gold, but the links remain the same.",image:"https://i.imgur.com/4d80yc7.png",link:"https://web.archive.org/web/20151125194114/https://www.reddit.com/"},{year:"Today",description:"New Reddit was just introduced, marking a shift away from its blue link design. What do you think?",image:"https://i.imgur.com/fs3zSEg.png",link:"https://www.reddit.com/"}]},{id:"airbnb",name:"Airbnb",image:"https://i.imgur.com/fBoKbXA.png",logo:"https://i.imgur.com/ncRM7O9.jpg",date:"2008",description:"From hustling on Craigslist to Unicorn status, Airbnb has grown exponentially since in lauched in 2008. Watch it become the largest hotel chain in the world.",states:[{year:"2008",description:"TechCrunch covers a YC travel startup called 'AirBed&Breakfast'. This is the screenshot from the first article.",image:"https://i.imgur.com/v7T7hej.png",link:"https://techcrunch.com/2008/08/11/airbed-and-breakfast-takes-pad-crashing-to-a-whole-new-level/"},{year:"2010",description:"The basic home page lets users search for available listings and features a few homes. The counter shows a few thousand homes available.",image:"https://i.imgur.com/2bti8rK.png",link:"https://web.archive.org/web/20100701085507/http://www.airbnb.com:80/"},{year:"2012",description:"Big, beautiful splash photos dominate the home page. Users can search for listings and discover.",image:"https://i.imgur.com/NTqW0f5.png",link:"https://web.archive.org/web/20120629225044/https://www.airbnb.com/"},{year:"2014",description:"AirBnb overlays the search UI on a gallery of featured photos. Airbnb also publishes content on cities and travel planning.",image:"https://i.imgur.com/uly4OER.png",link:"https://web.archive.org/web/20140629193814/https://www.airbnb.com/"},{year:"2016",description:"AirBnb updates their logo. Landing page full of beautiful photos to explore and inspire.",image:"https://i.imgur.com/iz8vZwk.png",link:"https://web.archive.org/web/20160602025743/https://www.airbnb.com/"},{year:"2018",description:"In the last few years, AirBnb has moved into travel experiences. The home page showcases photos of people rather than homes.",image:"https://i.imgur.com/inwtiDB.png",link:"https://www.airbnb.com"}]},{id:"twitter",name:"Twitter",image:"https://i.imgur.com/GSV165q.png",logo:"https://i.imgur.com/80f3Fb2.jpg",date:"2006",description:"The platform for short, real-time communication didn't always have it's full domain. When it started, it was known as Twttr.",meta:{title:"Evolution of Twitter – Kapwing",description:"Explore the museum of websites to see how Twitter evolved from a small community to the online destination for short, real-time communication."},states:[{year:"2006",description:"Just like any other startup, Twitter began as a small community.",image:"https://i.imgur.com/8xhyyf3.png",link:"https://web.archive.org/web/20061109073453/http://twitter.com:80/"},{year:"2008",description:"It took a while for folks to learn what Twitter was all about.",image:"https://i.imgur.com/cum4mXe.png",link:"https://web.archive.org/web/20080731045131/http://twitter.com/"},{year:"2010",description:"By 2010, the world learned about the hashtag and Twitter handles. And the service was growing, fast.",image:"https://i.imgur.com/PczLnvV.png",link:"https://web.archive.org/web/20100731060657/http://twitter.com/"},{year:"2012",description:"The basic profile that we recognize today was coming together by 2012.",image:"https://i.imgur.com/Vpv19cB.png",link:"https://web.archive.org/web/20120804170203/http://twitter.com/jack"},{year:"2015",description:"Twitter embraces flat design and creates a cleaner interface.",image:"https://i.imgur.com/BpqxxxP.png",link:"https://web.archive.org/web/20150803233857/https://twitter.com/jack"},{year:"Today",description:"It's clear that the world is becoming more and more visual, as posts on Twitter have less text and more media.",image:"https://i.imgur.com/H7foyal.png",link:"https://www.twitter.com/jack"}]},{id:"yelp",name:"Yelp",image:"https://i.imgur.com/4YN5brG.png",logo:"https://i.imgur.com/IN0Hphi.png",date:"2004",description:"Check out how Yelp soared from a dud to IPO in 7 years to became the leading platform for reviewing local businesses.",states:[{year:"2004",description:"In October, Yelp debuts as a an email-based referral network.",image:"https://i.imgur.com/csMuwiZ.jpg",link:"https://web.archive.org/web/20041014015116/http://www.yelp.com:80/home"},{year:"2005",description:"Yelp revamps its site to showcase reviews from 'real' people and motivate people to leave more reviews. Yelp receives $5M Series B in November.",image:"https://i.imgur.com/fDjMvuw.png",link:"https://web.archive.org/web/20051014001110/http://www.yelp.com:80/home"},{year:"2009",description:"Yelp goes international! The review site covers more cities, verticals, and features.",image:"https://i.imgur.com/tPeZBV5.png",link:"https://web.archive.org/web/20090226093725/http://www.yelp.com/"},{year:"2013",description:"Yelp showcases photos and enables mobile reviewing for the first time. The home page emphasizes fresh reviews and new businesses.",image:"https://i.imgur.com/u9GBTit.png",link:"https://web.archive.org/web/20130308045039/http://www.yelp.com/c/sf/food"},{year:"Today",description:"The mobile-friendly modern Yelp landing page has lots to browse and discover.",image:"https://i.imgur.com/yzQwf5h.png",link:"https://www.yelp.com"}]},{id:"yahoo",name:"Yahoo",image:"https://i.imgur.com/6D5x6zo.jpg",logo:"https://i.imgur.com/L4MA3H5.jpg",date:"1995",description:"Yahoo was the starting page for many in the earliest days of the internet.",states:[{year:"1997",description:"In the very beginning, Yahoo was a hand-curated collection of links to the most interesting pages on the web.",image:"https://i.imgur.com/T4zRjSr.png",link:"https://web.archive.org/web/19970109130853/http://www9.yahoo.com:80/"},{year:"2001",description:"Over time, the collection grew, as well as the services that Yahoo offered.",image:"https://i.imgur.com/alWc6FJ.png",link:"https://web.archive.org/web/20010614222934/http://www.yahoo.com:80/"},{year:"2003",description:"By 2003, Yahoo was the portal to the rest of the internet. It's homepage had news, sports, email, and more.",image:"https://i.imgur.com/jxycn9G.png",link:"https://web.archive.org/web/20030618011248/http://www.yahoo.com:80/"},{year:"2005",image:"https://i.imgur.com/95mqTZx.png",link:"https://web.archive.org/web/20050616111951/http://www.yahoo.com/"},{year:"2010",description:"By 2010, Yahoo had rebranded to embrace larger screens, as well as change their logo to the iconic purple color.",image:"https://i.imgur.com/o8LBSCS.png",link:"https://web.archive.org/web/20100616094317/http://www.yahoo.com/"},{year:"2014",description:"Yahoo embraces a more modern design and also struggles to find its identity in the world of social media and Google.",image:"https://i.imgur.com/gkel5vv.png",link:"https://web.archive.org/web/20140616095746/https://www.yahoo.com/"},{year:"Today",description:"The original web portal that Yahoo once was almost seems irrelevant today. But Yahoo was the original internet services pioneer.",image:"https://i.imgur.com/6LbyyXf.png",link:"https://www.yahoo.com"}]},{id:"new-york-times",name:"The New York Times",image:"https://i.imgur.com/aeJ0xx8.jpg",logo:"https://i.imgur.com/Gym4mbz.jpg",date:"2001",description:"Of course, the NYT has been around much longer than any internet company, but their online presence began around 2001.",states:[{year:"2001",description:"In the early 2000s, publishers like the NYT were still trying to find their identity online.",image:"https://i.imgur.com/k0fsABv.png",link:"https://web.archive.org/web/20010124140244/http://www2.nytimes.com:80/"},{year:"2003",description:"Over time, images became more important, and there was an increasing amount of digital content produced.",image:"https://i.imgur.com/U80nb2L.png",link:"https://web.archive.org/web/20030124140244/http://www2.nytimes.com:80/"},{year:"2008",description:"The New York Times brings its iconic print design to the web.",image:"https://i.imgur.com/Z3dkhaN.png",link:"https://web.archive.org/web/20080126085449/http://www.nytimes.com:80/"},{year:"2012",description:"By 2012, the Times has started pushing digital subscriptions amidst declinging print revenues.",image:"https://i.imgur.com/XZfD6ak.png",link:"https://web.archive.org/web/20120126092410/http://www.nytimes.com/"},{year:"2016",description:"In 2016, the Times website was simplified and looked to as an example of good journalism design on the web",image:"https://i.imgur.com/6y4HHdr.png",link:"https://web.archive.org/web/20160914235337/http://www.nytimes.com/"},{year:"Today",description:"Today's times embraces large screens, bold imagery, and eye-catching media.",image:"https://i.imgur.com/CM4KGrM.png",link:"https://www.nytimes.com"}]},{id:"product-hunt",name:"Product Hunt",image:"https://i.imgur.com/yP7Pzk9.png",logo:"https://i.imgur.com/3PeWAOV.jpg",date:"2014",description:"This go-to site for discovering new products started as a simple email list, but then grew quickly to become a large community of founders, entrepreneurs, and tech enthusiasts.",states:[{year:"2014",description:"Product Hunt was lean from the beginning, starting out as a simple list of products to upvote.",image:"https://i.imgur.com/ZlORgvU.png",link:"https://web.archive.org/web/20141001005151/http://www.producthunt.com/"},{year:"2016",description:"Product Hunt continued to grow, adding new categories and topics and expanding beyond the usual tech products.",image:"https://i.imgur.com/IubDg1T.png",link:"https://web.archive.org/web/20160731192941/https://www.producthunt.com/"},{year:"2017",description:"By 2017 Product Hunt's kitten becomes iconic in the tech community and beyond.",image:"https://i.imgur.com/fZGsprA.png",link:"https://web.archive.org/web/20170731212954/https://www.producthunt.com/"},{year:"Today",description:"Today, Product Hunt is a vibrant community that goes beyond a simple list of products. There are Q&A forums, discussions, job boards, and more that takes place on the site.",image:"https://i.imgur.com/yuAgMDi.png",link:"https://www.producthunt.com"}]},{id:"netflix",name:"Netflix",image:"https://i.imgur.com/r2nbum1.png",logo:"https://i.imgur.com/Kqrbs65.png",date:"1999",description:"Check out how Netflix grew up from a monthly DVD subscription service to a video streaming site to a content powerhouse.",meta:{title:"Evolution of Netflix – Kapwing",description:"Explore the museum of websites to see how Netflix evolved from a monthly DVD subscription service to a content powerhouse."},states:[{year:"1999",description:"Netflix launches their monthly subscription model: unlimited DVD rentals for a monthly fee.",image:"https://i.imgur.com/aR7DLVr.png",link:"https://web.archive.org/web/19990117011532/http://www.netflix.com:80/"},{year:"2003",description:"Netflix continues selling DVD subscriptions, building up their recommendations algorithm over time.",image:"https://i.imgur.com/usqc2ZB.png",link:"https://web.archive.org/web/20031003021435/http://www.netflix.com:80/Default?mqso=60141305"},{year:"2007",description:"Now the world's largest DVD rental company, Netflix launches a streaming service so that members can watch video direclty on their computer or TV.",image:"https://i.imgur.com/fNQbP8g.png",link:"https://web.archive.org/web/20071001023739/http://www.netflix.com:80/"},{year:"2010",description:"The company grows fast and acquires more than 20 million subscribers.",image:"https://i.imgur.com/Ca6sM1p.png",link:"https://web.archive.org/web/20100702101138/https://www.netflix.com/"},{year:"2013",description:'In February, Netflix debuts "House of Cards," an original TV series that earned 8 Emmy nominations.',image:"https://i.imgur.com/hdaURms.png",link:"https://web.archive.org/web/20130303055138/https://signup.netflix.com/#do-login"},{year:"2018",description:"With dozens of original shows and more than 50 Million subscribers, Netflix stock has gone up more than 10x since 2010.",image:"https://i.imgur.com/0FS9hBP.png",link:"https://www.netflix.com"}]}];class fZ extends r.exports.Component{constructor(){super(...arguments),a(this,"playVideo",(e=>{const{history:t}=this.props;t.push(`/museum-of-websites/${e.id}`)})),a(this,"renderVideoItem",(e=>i.createElement("div",{key:z.v4(),className:"startup-demo-videos-item-container"},i.createElement("div",{className:"evolution-of-products-image-container",onClick:()=>this.playVideo(e)},i.createElement("img",{alt:e.name,src:e.logo,className:"evolution-of-products-image"}),i.createElement("div",{className:"startup-demo-videos-image-play-button"},i.createElement("span",{className:"evolution-of-products-go-button"},"View gallery"),i.createElement("div",{className:"evolution-of-products-overlay"}))),i.createElement("div",{className:"startup-demo-videos-item-metadata"},i.createElement("img",{alt:e.name,src:e.image,className:"startup-demo-videos-logo"}),i.createElement("div",{className:"startup-demo-videos-item-name"},e.name),i.createElement("div",{className:"startup-demo-videos-item-date"},e.date),i.createElement("div",{className:"startup-demo-videos-item-description"},e.description)))))}render(){return i.createElement("div",null,i.createElement("div",{className:"startup-videos-wrapper"},i.createElement(rt,null,i.createElement("title",null,"Museum of Websites – Kapwing"),i.createElement("meta",{name:"description",content:"Explore this hand-curated gallery featuring the evolution of famous internet companies. See the evolution of Google, Amazon, Pinterest, Reddit, and more!"}),i.createElement("link",{rel:"canonical",href:"https://www.kapwing.com/museum-of-websites"})),i.createElement("div",{className:"evolution-of-products-header-container"},i.createElement("div",null,i.createElement("div",{className:"evolution-of-products-header"},"Museum of Websites",i.createElement("img",{src:"https://i.imgur.com/cfD5uhb.png",alt:"Museum of Websites Logo",className:"museum-of-websites-logo"})),i.createElement("div",{className:"evolution-of-products-description"},"A hand-curated gallery of how famous internet companies have changed over time."),i.createElement("div",{className:"startup-demo-videos-share"},i.createElement(it,{url:"https://www.kapwing.com/museum-of-websites",quote:"Museum of Websites - Kapwing",className:"startup-demo-share-button"},i.createElement(st,{size:40,round:!0})),i.createElement(lt,{url:"https://www.kapwing.com/museum-of-websites",title:"🦖 Museum of Websites - Kapwing",via:"kapwingapp",hashtags:["startups","museum","gallery"],className:"startup-demo-share-button"},i.createElement(dt,{size:40,round:!0}))),i.createElement("div",{className:"evolution-of-products-text"},"Curated with love by the team at"," ",i.createElement("a",{href:"https://www.kapwing.com",className:"evolution-of-products-header-link"},"Kapwing")))),i.createElement("div",{className:"evolution-of-products-background"},i.createElement("div",{className:"startup-demo-videos-list-container"},yZ.map((e=>this.renderVideoItem(e))),i.createElement("div",{className:"startup-demo-videos-item-container"},i.createElement("div",{className:"startup-demo-videos-image-container"},i.createElement("img",{alt:"More to come!",src:"https://i.imgur.com/uXJdIsY.png",className:"startup-demo-videos-image"})))),i.createElement("div",{className:"startup-demo-videos-list-container startup-demo-videos-footer-container"},i.createElement("div",{className:"startup-demo-videos-email-subscribe"},i.createElement("div",{className:"startup-demo-videos-subscribe-header"},"Looking for more?"),i.createElement("div",{className:"startup-demo-videos-subscribe-description"},"Sign up for our mailing list to get the latest updates:"),i.createElement(gZ,{source:"evolution-of-products"})),i.createElement("div",{className:"startup-demo-videos-footer-text"},"We're adding to the collection on a regular basis! Have a submission for a gallery? Contact us at"," ",i.createElement("a",{href:"mailto:hello@kapwing.com"},"hello@kapwing.com"),"!")))),i.createElement(DJ,null))}}const EZ=we(fZ);class vZ extends r.exports.Component{constructor(e){super(e),a(this,"imgNode",null),this.state={loaded:!1,isLightBoxOpen:!1},this.onImageLoad=this.onImageLoad.bind(this),this.openLightbox=this.openLightbox.bind(this),this.closeLightbox=this.closeLightbox.bind(this)}componentDidMount(){var e;const t=new window.Image;t.onload=this.onImageLoad,t.src=null==(e=this.imgNode)?void 0:e.getAttribute("src")}onImageLoad(){this.imgNode&&this.setState({loaded:!0})}openLightbox(){this.setState({isLightBoxOpen:!0})}closeLightbox(){this.setState({isLightBoxOpen:!1})}render(){const{className:e,lightBoxSrc:t,src:a}=this.props,{loaded:o,isLightBoxOpen:n}=this.state,r=["image"];e&&r.splice(0,0,e),o&&r.push("image-loaded");const s=i.createElement("img",{alt:"Click to expand",ref:e=>{this.imgNode=e},src:a,className:r.join(" "),onClick:this.openLightbox});return i.createElement("div",null,s,i.createElement(pt,{images:[{src:t||a}],isOpen:n,onClose:this.closeLightbox,backdropClosesModal:!0,enableKeyboardInpu:!0,showImageCount:!1}))}}class wZ extends r.exports.Component{constructor(e){super(e),this.state={currentProduct:void 0}}componentDidMount(){const{match:e,history:t}=this.props;if(e&&e.params&&e.params.id){const a=yZ.find((t=>t.id===e.params.id));a?this.setState({currentProduct:a}):t.push("/museum-of-websites")}else t.push("/museum-of-websites")}renderTimeline(){const{currentProduct:e}=this.state;return i.createElement("div",{className:"evolution-of-products-item-timeline"},e.states.map((e=>i.createElement("div",{className:"evolution-of-products-item-state",key:e.link},i.createElement("div",{className:"evolution-of-products-item-state-image-container"},i.createElement(vZ,{src:e.image,className:"evolution-of-products-item-state-image"})),i.createElement("div",{className:"evolution-of-products-item-state-info"},i.createElement("div",{className:"evolution-of-products-item-state-year"},e.year),e.description&&i.createElement("div",{className:"evolution-of-products-item-state-description"},e.description),e.link&&i.createElement("div",{className:"evolution-of-products-item-state-link-container"},i.createElement("a",{href:e.link,target:"_blank",rel:"noopener noreferrer"},"Visit Page")))))))}renderProduct(){const{currentProduct:e}=this.state,{meta:{title:t,description:a}={}}=e,{history:o}=this.props;return i.createElement(i.Fragment,null,i.createElement(rt,null,i.createElement("title",null,t),i.createElement("meta",{name:"description",content:a}),i.createElement("link",{rel:"canonical",href:`https://www.kapwing.com/museum-of-websites/${e.id}`})),i.createElement("div",{className:"evolution-of-products-item-wrapper"},i.createElement("div",{className:"evolution-of-products-item-header"},i.createElement("div",{className:"evolution-of-products-item-back",onClick:()=>o.push("/museum-of-websites")},"← Back to all companies"),i.createElement("div",{className:"evolution-of-products-item-logo-container"},i.createElement("img",{alt:`${e.name} Logo`,className:"evolution-of-products-item-logo",src:e.image})),i.createElement("div",{className:"evolution-of-products-header"},e.name),i.createElement("div",{className:"evolution-of-products-item-date"},e.date),i.createElement("div",{className:"evolution-of-products-item-description"},e.description)),this.renderTimeline()))}render(){const{currentProduct:e}=this.state;return e?this.renderProduct():null}}const bZ=we(wZ),_Z="MapContainer-module_spacer_4NUeL",TZ="MapContainer-module_footerLink_Hjx3w",SZ="MapContainer-module_mapContainer_s-E1u",IZ="MapContainer-module_mapTextContainer_rgv2o",xZ="MapContainer-module_mapTextHeader_zQJAI",kZ="MapContainer-module_mapTextDescription_2BurH",CZ="MapContainer-module_mapPreviewImage_czzLc",AZ="MapContainer-module_mapPreview_7vsiG",NZ=we((()=>i.createElement("div",{className:SZ},i.createElement(rt,null,i.createElement("title",null,"Sonoma County Fire Satellite Map — Kapwing"),i.createElement("meta",{name:"description",content:"The Sonoma County Fire map allowed residents to see the status of their homes using satellite imagery after the Tubbs fire in November 2017."}),i.createElement("meta",{property:"og:url",content:"https://www.kapwing.com/sonoma-county-fire-map"}),i.createElement("meta",{property:"og:title",content:"Sonoma County Fire Satellite Map"}),i.createElement("meta",{property:"og:description",content:"This map compares the before and after of the Sonoma County fire. The imagery was taken on 10/11/2017 and is courtesy of Digital Globe."}),i.createElement("meta",{property:"og:image",content:"https://cdn-useast1.kapwing.com/static/firemap.png"}),i.createElement("meta",{property:"og:image:url",content:"https://cdn-useast1.kapwing.com/static/firemap.png"}),i.createElement("meta",{property:"twitter:image",content:"https://cdn-useast1.kapwing.com/static/firemap.png"}),i.createElement("link",{rel:"canonical",href:"https://www.kapwing.com/sonoma-county-fire-map"})),i.createElement("div",{className:IZ},i.createElement("div",{className:xZ},"Sonoma County Fire Map"),i.createElement("div",{className:kZ},i.createElement("p",null,"The Sonoma County Fire Map was a project created by Eric Lu after the Tubbs Fire in November 2017. The map allowed residents to see the status of their homes after the fires using satellite imagery, before the roads reopened."),i.createElement("p",null,"Eric, a long time Santa Rosa resident, created the map to help other residents see their homes."),i.createElement("p",null,"The map was featured in various news outlets including the"," ",i.createElement("a",{href:"https://www.mercurynews.com/2017/10/13/before-and-after-the-fire-satellite-photos-of-santa-rosa-neighborhoods/"},"Mercury Times"),", the"," ",i.createElement("a",{href:"https://www.huffingtonpost.com/entry/santa-rosa-fire-3-angelsnot-in-disguise_us_59e65b00e4b0e60c4aa365d2"},"Huffington Post"),", and"," ",i.createElement("a",{href:"https://www.kqed.org/news/11623382/map-santa-rosa-residents-see-your-home-after-the-fires"},"KQED"),".")),i.createElement("div",{className:_Z}),i.createElement("div",{className:AZ},i.createElement("img",{src:"https://i.imgur.com/zZELAYl.png",alt:"Map Preview",className:CZ})),i.createElement("div",{className:AZ},i.createElement("img",{src:"https://i.imgur.com/hfOM9Le.png",alt:"Map Preview",className:CZ})),i.createElement("div",{className:_Z}),i.createElement("div",{className:kZ},i.createElement("p",null,"My heart goes out to those families who lost loved ones in the fire, and prayers for all others who were devastatingly affected."),i.createElement("p",null,"I am thankful for our local firefighters for risking their lives to save lives and property that night. I am so grateful for many other community members who worked tirelessly to help affected residents get back on their feet."),i.createElement("p",null,"Thanks for visiting the Sonoma County Fire Map and have a nice day."),i.createElement("div",{className:TZ},i.createElement("a",{href:"/"},"← Return to Kapwing.com"))))))),PZ=[{title:"This Page is Lost in Space",url:"https://i.imgur.com/A040Lxr.png",description:"You thought this mission to the moon would be a quick six month thing. Your neighbor offered to look after your dog. Your high school math teacher was impressed. He once said you wouldn’t amount to anything.You sure showed him. But now here you are, fifty feet from your spaceship with no way to get back. Your dog will be so sad. Your math teacher will be so smug. Pretty devastating.",containerStyles:{backgroundColor:"#83D9C8",color:"#5C77AC"}},{title:"This Page is Lost in the Wind",url:"https://i.imgur.com/oCkEbrA.png",description:"The child had looked so excited when the clown had presented a large red balloon. You had seen this, but in the throes of your morning commute you didn’t register it until it was too late. Who asked the government to support a fair right through Main Street during a week day anyway? Your bike barrelled right between the child and the clown and sent the balloon on its merry way. You didn’t turn back to see the damage you had done. Later you saw the balloon floating outside your office window.",containerStyles:{backgroundColor:"#D5E9F6",color:"#4E43FA"}},{title:"This Page is Buried in the Sand",url:"https://i.imgur.com/FOeYt4E.png",description:"You have never seen an ostrich head. Whenever you’re around it seems ostriches are avoiding your gaze. You came on this trip specifically to see an ostrich head, but here is this ostrich right in front of you, head invisible. You may never see an ostrich head.",containerStyles:{backgroundColor:"#EFEDFA",color:"#9F6C66"}},{title:"This Page is Broken",url:"https://i.imgur.com/g3hgqe8.png",description:"A broken clock is right twice a day. But if you just have one clock, it’s impossible to tell exactly when the clock is right. So it could be right at any moment. And that brings you to the crux of the conceptualization. What is time? Nothing but an abyss. Clocks are just false attempts to harness its power. It’s cruel really.",containerStyles:{backgroundColor:"#FFE4EA",color:"#709BFA"}},{title:"Caution! This Page is Cordoned Off",url:"https://i.imgur.com/qIufhof.png",description:"The earthquake was not good to the bike lane on your way to work. A large gap in the pavement (too big to be called a pothole) had swallowed three oblivious bikers whole. So the city had put up two pylons and yellow caution tape. Pretty frustrating for you given your propensity to do 360 jumps over the gap.",containerStyles:{backgroundColor:"#83D9C8",color:"#965418"}},{title:"This Page is Broken",url:"https://i.imgur.com/yW2W9SC.png",description:"This mug was a family heirloom. Of your neighbor. Your neighbor always loved the color, shape, and quantity of coffee held by this mug. But your neighbor moved out and left it on their porch, no explanation, no repair materials, no nothing. So you have this broken mug.",containerStyles:{backgroundColor:"#D5E9F6",color:"#2F8E89"}},{title:"This Page is Burnt to a Crisp",url:"https://i.imgur.com/WvEu0cO.png",description:"Toast takes so long to make. You stare at the toaster tapping your feet. Your laundry is in the dryer and it just dinged. Maybe you’ll take it out. After all, you have time. You take out your laundry. You fold your underwear. You think about folding your socks. You remember your toast! It is too late. It’s burnt to a crisp. The process repeats itself. You should probably figure out your toasting settings.",containerStyles:{backgroundColor:"#FFF4BB",color:"#4376C0"}},{title:"A Dog Ate this Page",url:"https://i.imgur.com/lKJiT77.png",description:"Your dog is cute but honestly a menace. Where are my shoes? Where is my graduation certificate? Where is the chocolate cake I baked for my Aunt’s birthday? And why did you take your dog to the vet on that same Thursday?!",containerStyles:{backgroundColor:"#FFE4EA",color:"#824B2"}},{title:"Don’t Cry Over Spilled Page",url:"https://i.imgur.com/oEUksmz.png",description:"Gulp. You hold back tears as the white liquid spreads across the floor from your sad looking carton. You should have bought the chocolate milk, it was clearly the better choice. And then maybe you wouldn’t have so carelessly smacked it across the room when you emphatically pointed at a bird outside. Too late now. You wipe the single tear from your eye and go fetch the mop.",containerStyles:{backgroundColor:"#FFE4EA",color:"#673164"}},{title:"Oh no! We tripped up!",url:"https://i.imgur.com/3suxlvm.png",description:"You had been told you should always check your shoes before getting up from the bleachers. Freshman were known to walk under them and tie peoples’ shoes together.",containerStyles:{backgroundColor:"#FFF4BB",color:"#180AD8"}},{title:"This Page is Wrong",url:"https://i.imgur.com/DWO5Hzg.png",description:"You have been trying for ten minutes. It’s pretty late at night and pretty dark in your room. You reach over and flick on a lamp. You feel oh so stupid. The gap in the toy is a triangle and you only have the cylinder and cube pieces. In dismay you toss the toy aside. Curse your five year old’s inability to keep track of the triangle!",containerStyles:{backgroundColor:"#D5E9F6",color:"#DF245D"}},{title:"This Page is Not on the Map",url:"https://i.imgur.com/Q2BAOd2.png",description:"You told your friends you weren’t bringing your phone, to try and experience what travel was like back in the day. You bought a map and a bottle of water and carried your camera for the money shot. But the map was from 2005 and the landscape had changed. So here you are, in the middle of a large field, that the map continues to claim is a local grocer.",containerStyles:{backgroundColor:"#83D9C8",color:"#386177"}},{title:"There’s a Leak in the Website",url:"https://i.imgur.com/U3vTGjX.png",description:"The boat had looked good to the naked eye. But you wear a very strong prescription and should have been wearing glasses. As you cling on to the bouey the coast guard had thrown at you, you watch the water rush into you beloved dingy. The leak sprays water higher and higher. Then the boat was swallowed and sunk into the abyss.",containerStyles:{backgroundColor:"#EFEDFA",color:"#684CFF"}},{title:"This Page is a Ghost",url:"https://i.imgur.com/QIxIKBH.png",description:"Once alive and now dead, this ghost appears to have some unfinished business. Could it be with you? Or the treasure hidden under the floorboards of the old mansion in the hills that may never reach its rightful owner, a compassionate school teacher in Brooklyn.",containerStyles:{backgroundColor:"#D5E9F6",color:"#5F749C"}},{title:"This Page Contains Nothing but Scraps",url:"https://i.imgur.com/kZNTPqI.png",description:"A perfectly enticing pizza box sitting on a table. You open it filled with anticipation. And find… nothing but scraps. Perhaps a half eaten crust. And a lot of grease. The anticipation turns to deep disappointment and despair. There’s nothing left!",containerStyles:{backgroundColor:"#83D9C8",color:"#386177"}},{title:"This Page is Lost",url:"https://i.imgur.com/flHudHE.png",description:"You bought a little bracelet for the express purpose of not losing your keys. You put a hook on your door specifically meant for keeping your keys. You briefly attempted to attach your keys to your phone. But here they are. In the dirt. In the park across the street from that bar you used to like but decided the last time you went that you probably wouldn’t go again. You’ll never find them.",containerStyles:{backgroundColor:"#FFF4BB",color:"#226FAB"}},{title:"This Page is in the Garbage",url:"https://i.imgur.com/Oqnene0.png",description:"When the king of racoons approached you during the fall of 2005, you were taken aback by the generosity of the offer he made and also his ability to talk. You’ve been living in harmony ever since. They pay 50% of your rent and you “forget” to take out the garbage every other week.",containerStyles:{backgroundColor:"#FFE4EA",color:"#4C76EC"}},{title:"This Page is Not Real",url:"https://i.imgur.com/hkRuanu.png",description:"The imposing figure with the trenchcoat shows you the two polaroids. One appears to show the Loch Ness monster herself in the middle of a stretch of dark water. The other shows a sasquatch picking it’s way through a dark forest. You look closer. The animal shapes are drawn on with ink. “This isn’t real!” You scream and throw the polaroids to the floor, sobbing.",containerStyles:{backgroundColor:"#EFEDFA",color:"#092048"}},{title:"This Page is Melted in the Sun",url:"https://i.imgur.com/O0DCcQy.png",description:"People questioned your desire to get strawberry. “That’s the worst flavor,” they said. But you are strong and independent so you got it anyway. And honestly, it wasn’t great. Luckily, two licks in a bike whizzed past you and knocked the cone out of your hand. “Oh no!” you yelled as the creamy pink became a mess in the dirt. But really you were happy.",containerStyles:{backgroundColor:"#FFF4BB",color:"#E896ED"}},{title:"More illustrations to come",url:"https://i.imgur.com/iRjGBZj.png",description:"We're working hard to put out new illustrations for your lost URLs. There will be many more stories and trendy images to come in the future. Stay tuned for new 404 illustrations!",containerStyles:{backgroundColor:"white",color:"black"}}],RZ="FourOFour-module_container_0yyqP",LZ="FourOFour-module_headerContainer_trv8C",DZ="FourOFour-module_headerText_iaNQl",OZ="FourOFour-module_headerH1_zUrvB",FZ="FourOFour-module_headerH2_g-T7o",MZ="FourOFour-module_downloadAllButton_z9qN3",UZ="FourOFour-module_headerImageContainer_hNc6c",BZ="FourOFour-module_headerImage_uYdq3",WZ="FourOFour-module_headerFooter_yvR9K",VZ="FourOFour-module_shareButton_h-oGz",jZ="FourOFour-module_headerFooterText_9XanJ",GZ="FourOFour-module_illustrationWrapper_lyyun",HZ="FourOFour-module_illustrationRow_ZBtsm",zZ="FourOFour-module_illustrationContainer_8bYmu",$Z="FourOFour-module_illustrationHeader_U8Flw",KZ="FourOFour-module_illustrationDescription_SngMr",YZ="FourOFour-module_illustration_DfJFt",qZ="FourOFour-module_illustrationImage_VkzOT",XZ="FourOFour-module_illustrationDownloadButton_M2z5D",JZ="FourOFour-module_emailWrapper_Bh6j6";class QZ extends r.exports.Component{renderImage(e){return i.createElement("div",{className:zZ,style:e.containerStyles},i.createElement("a",{href:e.url,className:XZ,target:"_blank",rel:"noopener noreferrer"},"View full image"),i.createElement("div",{className:YZ},i.createElement("img",{src:e.url,alt:e.title,className:qZ})),i.createElement("div",{className:$Z},e.title),i.createElement("div",{className:KZ},e.description))}render(){const e=[];for(let t=0;t<PZ.length;t+=2)e.push(i.createElement(i.Fragment,{key:t},this.renderImage(PZ[t]),this.renderImage(PZ[t+1])));return i.createElement("div",{className:RZ},i.createElement(rt,null,i.createElement("title",null,"404 Illustrations – Trendy 404 Images – Kapwing"),i.createElement("meta",{name:"description",content:"Explore this collection of free trendy illustrations to make an eye-catching 404 error page on your website. Many more 404 error illustrations to come!"}),i.createElement("meta",{name:"keywords",content:"404 illustrations"}),i.createElement("meta",{property:"og:url",content:"https://www.kapwing.com/404-illustrations"}),i.createElement("meta",{property:"og:title",content:"404 Illustrations - Trendy 404 page images for your next project"}),i.createElement("meta",{property:"og:description",content:"This website is a hand-crafted collection of illustrations that you can use for your website's 404 (Not Found) page. Your URL might not be found, but your user can still have a delightful experience. Many more illustrations to come!"}),i.createElement("meta",{property:"og:image",content:"https://i.imgur.com/2HLc0dN.jpg"}),i.createElement("meta",{property:"og:image:url",content:"https://i.imgur.com/2HLc0dN.jpg"}),i.createElement("meta",{property:"twitter:image",content:"https://i.imgur.com/2HLc0dN.jpg"}),i.createElement("link",{rel:"canonical",href:"https://www.kapwing.com/404-illustrations"})),i.createElement("div",{className:LZ},i.createElement("div",{className:DZ},i.createElement("div",{className:OZ},"404 Illustrations"),i.createElement("div",{className:FZ},"Trendy, ready to use images for your 404 page"),i.createElement("a",{href:"https://drive.google.com/drive/folders/1yFKI9f9-R_WUhAMZnrxzATPHKaOVdCkl?usp=sharing",target:"_blank",rel:"noopener noreferrer"},i.createElement("div",{className:MZ},"Download All")),i.createElement("div",{className:WZ},i.createElement("div",null,i.createElement(it,{url:"https://www.kapwing.com/404-illustrations",quote:"404 Illustrations - trendy, ready to use images for your 404 page",className:VZ},i.createElement(st,{size:40,round:!0})),i.createElement(lt,{url:"https://www.kapwing.com/404-illustrations",title:"404 Illustrations - trendy, ready to use images for your 404 page",hashtags:["404","illustrations"],className:VZ},i.createElement(dt,{size:40,round:!0}))),i.createElement("div",{className:jZ},"Curated with love by the team at Kapwing"))),i.createElement("div",{className:UZ},i.createElement("img",{src:"https://i.imgur.com/QUC2CyX.png",alt:"Ice Cream Cone Melting",className:BZ}))),i.createElement("div",{className:GZ},e.map(((e,t)=>i.createElement("div",{className:HZ,key:t},e)))),i.createElement("div",{className:JZ},i.createElement("div",{className:"startup-demo-videos-list-container startup-demo-videos-footer-container"},i.createElement("div",{className:"startup-demo-videos-email-subscribe"},i.createElement("div",{className:"startup-demo-videos-subscribe-header"},"Looking for more?"),i.createElement("div",{className:"startup-demo-videos-subscribe-description"},"Sign up for our mailing list to get the latest updates:"),i.createElement(gZ,{source:"404-illustrations"})))),i.createElement(DJ,null))}}const ZZ=we(QZ);function e0(e){return{type:"SET_DIMENSIONS",dimensions:e}}function t0(e){return{type:"SET_DURATION",duration:e}}function a0(e){switch(e){case"Pridi":return"Pridi-Regular";case"Montserrat":return"Montserrat-Regular";case"Noto Sans":return"NotoSans-Regular";default:return null==e?void 0:e.replace(/ /g,"-")}}function o0(e){return{type:"SET_NUM_LOOPS",numLoops:e}}function n0(){return{type:"MARK_AS_LOOPED"}}function r0(e){return{type:"SET_EDITOR_PATH",path:e}}const i0="LooperHome-module_home_XMs19",s0="LooperHome-module_homeHowBackgroundWhite_7yMHF",l0="LooperHome-module_splashText_8ObiG",d0="LooperHome-module_splashSubtext_C2J5z",c0="LooperHome-module_dottedLineContainer_FTRTa",u0="BackButton-module_backButton_ltWHd",m0="BackButton-module_buttonIcon_Y-FC8",p0="BackButton-module_buttonLabel_pI3AF",h0=e=>{const{url:t}=e;return i.createElement("a",{className:u0,href:t},i.createElement("div",{className:m0},i.createElement(ht,null)),i.createElement("div",{className:p0},"Back"))};class g0 extends r.exports.Component{constructor(e){super(e),a(this,"handleDragEnter",(e=>{e.dataTransfer&&this.setState({dragging:!0}),e.stopPropagation()})),a(this,"handleDragLeave",(e=>{this.setState({dragging:!1}),e.stopPropagation()})),a(this,"hideDragUploadDialog",(()=>{this.setState({showDragUploadDialog:!1})})),a(this,"handleFinish",(()=>{this.props.markAsLooped(),this.props.setEditorPath("/editor/loop-video")})),this.state={dragging:!0,showDragUploadDialog:!1}}componentDidUpdate(e,t){const{dragging:a}=this.state;a&&!t.dragging&&this.setState({showDragUploadDialog:!0})}render(){const{showDragUploadDialog:e}=this.state;return i.createElement(i.Fragment,null,i.createElement(rt,null,i.createElement("title",null,"Loop Video Online — Upload — Kapwing"),i.createElement("meta",{name:"robots",content:"noindex, nofollow"})),i.createElement(QQ,null),i.createElement("div",{className:i0,onDragEnter:this.handleDragEnter,onDragLeave:this.handleDragLeave},i.createElement(h0,{url:"/tools/loop"}),i.createElement("div",{className:`${s0} ${c0}`},i.createElement("div",{className:l0},i.createElement("h1",null,"Loop Video"),i.createElement("h2",{className:d0},"Upload or paste a link to a video or GIF to get started!"),i.createElement(dQ,{destination:"/editor/loop-video",disallowImages:!0,handleFinish:this.handleFinish,showDragUploadDialog:e,hideDragUploadDialog:this.hideDragUploadDialog})))),i.createElement(DJ,null))}}const y0=m.exports.connect(void 0,(e=>me({markAsLooped:n0,setEditorPath:r0},e)))(g0);function f0(){return{type:"TOGGLE_REVERSE_STOP_MOTION"}}function E0(e){return{type:"SET_STOP_MOTION_CLIP_RATE",clipRate:e}}function v0(e){return{type:"SET_STOP_MOTION_SPEED",speed:e}}function w0(){return{type:"MARK_AS_STOP_MOTION"}}const b0="StopMotionHome-module_home_ampDM",_0="StopMotionHome-module_homeHowBackgroundWhite_vBIhy",T0="StopMotionHome-module_splashText_gn3Sd",S0="StopMotionHome-module_splashSubtext_E-hMP",I0="StopMotionHome-module_dottedLineContainer_iMjp1";class x0 extends r.exports.Component{constructor(e){super(e),a(this,"handleDragEnter",(e=>{e.dataTransfer&&this.setState({dragging:!0}),e.stopPropagation()})),a(this,"handleDragLeave",(e=>{this.setState({dragging:!1}),e.stopPropagation()})),a(this,"hideDragUploadDialog",(()=>{this.setState({showDragUploadDialog:!1})})),a(this,"handleFinish",(()=>{this.props.markAsStopMotion(),this.props.setEditorPath("/editor/stop-motion")})),this.state={dragging:!0,showDragUploadDialog:!1}}componentDidUpdate(e,t){const{dragging:a}=this.state;a&&!t.dragging&&this.setState({showDragUploadDialog:!0})}render(){const{showDragUploadDialog:e}=this.state;return i.createElement(i.Fragment,null,i.createElement(rt,null,i.createElement("title",null,"Stop Motion Maker — Upload — Kapwing"),i.createElement("meta",{name:"robots",content:"noindex, nofollow"})),i.createElement(QQ,null),i.createElement("div",{className:b0,onDragEnter:this.handleDragEnter,onDragLeave:this.handleDragLeave},i.createElement(h0,{url:"/tools/stop-motion"}),i.createElement("div",{className:`${_0} ${I0}`},i.createElement("div",{className:T0},i.createElement("h1",null,"Stop Motion"),i.createElement("h2",{className:S0},"Upload or paste a link to a video or GIF to get started!"),i.createElement(dQ,{destination:"/editor/stop-motion",helperText:"",disallowImages:!0,handleFinish:this.handleFinish,showDragUploadDialog:e,hideDragUploadDialog:this.hideDragUploadDialog}),!Ii()&&i.createElement("div",{className:"stop-motion-link-to-montage-maker"},"Want to create a stop motion from images?",i.createElement("br",null),"Use the ",i.createElement("a",{href:"/tools/make"},"Video Maker")," instead!"))),i.createElement(DJ,null)))}}const k0=[{toolsTitle:"Loop Video",toolsDescription:"Loop and repeat video online in just a few clicks. Makes it easy to lengthen a short video.",component:y0,url:"/upload/loop"},{toolsTitle:"Stop Motion Maker",toolsDescription:"Turn any video into a stop motion easily.",component:m.exports.connect(void 0,(e=>me({markAsStopMotion:w0,setEditorPath:r0},e)))(x0),url:"/upload/stop-motion"}];const C0=()=>{const e=Ie(),t=(()=>{const{search:e}=oe();return i.useMemo((()=>new URLSearchParams(e)),[e])})(),a=m.exports.useDispatch(),o=t.get("session_id"),n=t.get("onSuccessPath"),s=n&&decodeURI(n);return r.exports.useEffect((()=>{(async()=>{const t=await gu("/api/v1/stripe/getCheckoutSessionInfo",{body:{session_id:o}}),{session:n}=t,{metadata:r,subscription:i}=n,{plan:l}=i,{interval:d,nickname:c}=l,{paywallModalAction:u,extraAmplitudeEventProperties:m,teamId:p,seats:h}=r;let g="Your upgrade was successful. Thanks for supporting our team at Kapwing by upgrading to Kapwing Pro. You can now use all Pro features in your current workspace.";u&&(g=(e=>{switch(e){case Rs.DEFAULT_PRIVACY:return"You have successfully upgraded and can now change the default privacy for your videos.";case"high-quality":return"You have successfully upgraded and you can now select high quality";case"privacy":return"You have successfully upgraded and your content has been set to private";case"subtitler":return"Your workspace has been successfully upgraded. You can now download the SRT file.";case"upload-limit":case"single-video-duration-limit":return"Your workspace has been upgraded. You may now publish your project.";case"upload-fonts":return"Your workspace has been upgraded. You can now upload custom fonts.";case Rs.REMOVE_WATERMARK:case Rs.REMOVE_30_SEC_WATERMARK:return"Your team workspace has been upgraded sucessfully. Try again to re-export your project without a watermark. Thank you for supporting Kapwing!";case Rs.MAGIC_TRANSCRIBE:case Rs.TRIM_WITH_TRANSCRIPT_TRANSCRIBE:return"Congratulations! Your workspace has been successfully upgraded. You can now generate unlimited subtitles and transcriptions.";case Rs.BRANDKIT:return"Your workspace has been succesfully upgraded. You can now save assets to Brand Kit and use them in Kapwing.";default:return"Your team workspace has been successfully upgraded to Kapwing Pro. You can now use Pro features in your current workspace."}})(u)),a(Su({description:g,type:"success"}));let y="/studio/editor";s&&(y=s),e.replace(y),a((e=>gu("/api/v1/users/token/refresh").then((t=>{e({type:"SET_TOKEN",token:t.token})})))),a(GE()),Ic({interval:d,planTier:c,upgradeSource:u||Rs.UNKNOWN,extraAmplitudeEventProperties:JSON.parse(m),teamId:p,quantity:h}),an("Upgrade Workspace")})()}),[o,a,e,s]),i.createElement(oJ,null)};function A0(e,t,a,o,n,r,i,s){let l=a,d=o,c=r,u=n;2===arguments.length&&(l=0,d=0,c=e.canvas.height,u=e.canvas.width);let m="number"==typeof i?i:.5,p="number"==typeof s?s:.5;m<0&&(m=0),p<0&&(p=0),m>1&&(m=1),p>1&&(p=1);const h=t.width,g=t.height,y=Math.min(u/h,c/g);let f,E,v,w,b=h*y,_=g*y,T=1;b<u&&(T=u/b),Math.abs(T-1)<1e-14&&_<c&&(T=c/_),b*=T,_*=T,v=h/(b/u),w=g/(_/c),f=(h-v)*m,E=(g-w)*p,f<0&&(f=0),E<0&&(E=0),v>h&&(v=h),w>g&&(w=g),e.drawImage(t,f,E,v,w,l,d,u,c)}function N0(e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}const P0=tt((async()=>(await vP((()=>import("./index.f92710f2.js").then((e=>e.i))),["assets/index.f92710f2.js","assets/vendor.96643be6.js"])).TwitterPicker));class R0 extends r.exports.Component{constructor(e){super(e),a(this,"handleBackgroundColorChange",(e=>{this.setState({canvasBackground:e.hex},(()=>{this.drawMockup()}))})),a(this,"handlePhoneColorChange",(e=>{this.setState({phoneColor:e.hex},(()=>{this.drawMockup()}))})),a(this,"changeImageFit",(e=>{this.setState({imageFit:e},(()=>{this.drawMockup()}))})),a(this,"downloadImage",(()=>{const{mostRecentImage:e}=this.state,t=function(e){const t=atob(e.split(",")[1]),a=e.split(",")[0].split(":")[1].split(";")[0],o=new ArrayBuffer(t.length),n=new Uint8Array(o);for(let r=0;r<t.length;r+=1)n[r]=t.charCodeAt(r);return new Blob([o],{type:a})}(e);gt.saveAs(t,`mobile-mockup-${Date.now()}.png`)})),a(this,"drawMockup",(()=>{const{img:e,imageFit:t,phoneColor:a,canvasBackground:o}=this.state,n=document.getElementById("mobile-mockup-canvas"),r=n.getContext("2d");r.clearRect(0,0,n.width,n.height),n.width=1024,n.height=1024,r.fillStyle=o||"rgba(1,22,39,.08)",r.fillRect(0,0,n.width,n.height);const i=n.width/2-200,s=n.height/2-414;r.fillStyle=a||"#001323",r.strokeStyle=a||"#001323",r.shadowColor=function(e){const t=N0(e);if(!t)return"rgba(5,23,39,.5)";const{r:a,g:o,b:n}=t,r=[a,o,n];return Math.round((299*r[0]+587*r[1]+114*r[2])/1e3)>125?"rgba(5,23,39,.5)":"rgba(255, 255, 255,.7)"}(o),r.shadowBlur=100,r.shadowOffsetX=0,r.shadowOffsetY=0,function(e,t,a,o,n,r,i,s){const l={tl:0,tr:0,br:0,bl:0};"number"==typeof r?(l.br=r,l.bl=r,l.tl=r,l.tr=r):Object.assign(l,r),e.beginPath(),e.moveTo(t+l.tl,a),e.lineTo(t+o-l.tr,a),e.quadraticCurveTo(t+o,a,t+o,a+l.tr),e.lineTo(t+o,a+n-l.br),e.quadraticCurveTo(t+o,a+n,t+o-l.br,a+n),e.lineTo(t+l.bl,a+n),e.quadraticCurveTo(t,a+n,t,a+n-l.bl),e.lineTo(t,a+l.tl),e.quadraticCurveTo(t,a,t+l.tl,a),e.closePath(),i&&e.fill(),(s||null==s)&&e.stroke()}(r,i,s,400,828,60,!0,!0);const l=i+20,d=s+80,c=360,u=668;console.debug(c,u),r.shadowColor="transparent",r.shadowBlur=0,r.beginPath(),r.lineWidth="1",r.strokeStyle="#888",r.rect(l,d,c,u),r.stroke(),r.fillStyle="#ddd",r.fillRect(l,d,c,u),e&&("crop"===t?A0(r,e,l,d,c,u):"fit"===t?function(e,t,a,o,n,r){const i=n/t.width,s=r/t.height,l=Math.min(i,s),d=(n-t.width*l)/2,c=(r-t.height*l)/2;n>=r?e.drawImage(t,0,0,t.width,t.height,a-d,o+c,t.width*l,t.height*l):e.drawImage(t,0,0,t.width,t.height,a+d,o+c,t.width*l,t.height*l)}(r,e,l,d,c,u):"stretch"===t?r.drawImage(e,0,0,e.width,e.height,l,d,c,u):A0(r,e,l,d,c,u));const m=n.toDataURL("image/png");this.setState({mostRecentImage:m})})),a(this,"stopUpload",(()=>{this.setState({loading:!1})})),a(this,"handleFileUpload",(e=>{const{showToast:t}=this.props;this.setState({loading:!0});const a=e.target.files[0];if(!a)return void t({description:"Please choose a file to upload.",type:"error"});if(a.type)if(["image/gif","image/jpg","image/jpeg","image/png"].includes(a.type))if(a.size>8e7)t({description:"Your content must be under 80MB",type:"error"}),this.stopUpload();else{const e=new FileReader;e.onload=e=>{const t=new Image;t.onload=()=>{this.setState({img:t}),this.drawMockup(),this.stopUpload()},t.src=e.target.result},e.readAsDataURL(a)}else t({description:"You must choose an image to use this feature. Currently we support .jpg, .png, and .gif formats.",type:"error"}),this.stopUpload();else t({description:"Your upload has an invalid type. Please choose a video or image to upload, and make sure your file has a correct extension.",type:"error"}),this.stopUpload()})),this.state={loading:!1,img:void 0,imageFit:"crop",phoneColor:"#001323",canvasBackground:"#FFFFFF"}}componentDidMount(){this.drawMockup()}render(){const{loading:e,mostRecentImage:t,canvasBackground:a,phoneColor:o,imageFit:n}=this.state,r=function(e){const t=N0(e);if(!t)return"#242F40";const{r:a,g:o,b:n}=t,r=[a,o,n];return Math.round((299*r[0]+587*r[1]+114*r[2])/1e3)>125?"#242F40":"#EBECED"}(a);return i.createElement(i.Fragment,null,i.createElement("div",{className:"startup-videos-wrapper"},i.createElement(rt,null,i.createElement("title",null,"Mobile Mockup Generator – Kapwing"),i.createElement("meta",{name:"description",content:"Create a beautiful mobile mockup with a custom color, screenshot, and background color in just a few clicks. After customizing, save the final mockup."}),i.createElement("meta",{property:"og:url",content:"https://www.kapwing.com/mobile-mockup"}),i.createElement("meta",{property:"og:title",content:"Mobile Mockup - Kapwing"}),i.createElement("meta",{property:"og:description",content:"The simplest way to create a beautiful mobile mockup. In just three clicks, choose a screenshot and download your mockup!"}),i.createElement("meta",{property:"og:image",content:"https://i.imgur.com/6SDNZse.png"}),i.createElement("meta",{property:"og:image:url",content:"https://i.imgur.com/6SDNZse.png"}),i.createElement("meta",{property:"twitter:image",content:"https://i.imgur.com/6SDNZse.png"}),i.createElement("link",{rel:"canonical",href:"https://www.kapwing.com/mobile-mockup"})),i.createElement("div",{className:"mobile-mockup-editor-container",style:{background:a}},i.createElement("div",{className:"mobile-mockup-left"},i.createElement("div",{className:"mobile-mockup-left-content"},i.createElement("div",{className:"mobile-mockup-header",style:{color:r}},"Mobile Mockup"),i.createElement("div",{className:"mobile-mockup-description",style:{color:r}},"The simplest way to create a beautiful mobile mockup"),e?i.createElement("div",{className:"mobile-mockup-upload-button-container"},i.createElement("div",{className:"loader upload-loader"})):i.createElement("div",{className:"mobile-mockup-upload-button-container"},i.createElement("label",{htmlFor:"mobile-mockup-uploader-input"},i.createElement("div",{className:"mobile-mockup-upload-button"},i.createElement("div",{className:"mobile-mockup-download-button-header"},"Choose screenshot")),i.createElement("input",{id:"mobile-mockup-uploader-input",accept:"image/jpg,image/png,image/jpeg",onChange:this.handleFileUpload,type:"file"}))),i.createElement("div",{className:"mobile-mockup-controls-container"},["crop","fit","stretch"].map((e=>{let t="mobile-mockup-position-selector";return e===n&&(t+=" mobile-mockup-position-selector-selected"),i.createElement("div",{key:z.v4(),className:t,onClick:()=>this.changeImageFit(e)},e)}))),i.createElement(P0,{className:"mobile-mockup-twitter-picker",triangle:"hide",onChangeComplete:this.handleBackgroundColorChange,color:a,colors:["#EB144C","#FCB900","#7BDCB5","#00D084","#8ED1FC","#0693E3","#ABB8C3","#FFFFFF","#000000","#c9ba93"]}),i.createElement(P0,{className:"mobile-mockup-twitter-picker",triangle:"hide",onChangeComplete:this.handlePhoneColorChange,color:o,colors:["#001323","#FFFFFF","#c9ba93"]}),i.createElement("div",{className:"mobile-mockup-download-button-container"},i.createElement("div",{className:"mobile-mockup-download-button"},i.createElement("div",{className:"mobile-mockup-download-button-header",onClick:this.downloadImage},"Download mockup"))))),i.createElement("div",{className:"mobile-mockup-right"},i.createElement("div",{className:"mobile-mockup-canvas-container"},i.createElement("canvas",{id:"mobile-mockup-canvas"}),t?i.createElement("img",{src:t,className:"mobile-mockup-most-recent-image",alt:"Generated Mobile Screenshot"}):i.createElement("div",{className:"loader upload-loader"})))),i.createElement("div",{className:"mobile-mockup-sample-container"},i.createElement("img",{src:"https://i.imgur.com/Z15LwSm.png",className:"mobile-mockup-sample-image",alt:"Mobile Mockup Example Screenshot"}),i.createElement("img",{src:"https://i.imgur.com/eADTxZ4.png",className:"mobile-mockup-sample-image",alt:"Mobile Mockup Example Screenshot"}),i.createElement("img",{src:"https://i.imgur.com/LQoQlnI.png",className:"mobile-mockup-sample-image",alt:"Mobile Mockup Example Screenshot"}),i.createElement("img",{src:"https://i.imgur.com/c364bfG.png",className:"mobile-mockup-sample-image",alt:"Mobile Mockup Example Screenshot"})),i.createElement("div",{className:"mobile-mockup-demo-container"},i.createElement("div",{className:"mobile-mockup-demo-header"},"How it works"),i.createElement("div",{className:"mobile-mockup-demo-left"},i.createElement(vZ,{src:"https://i.imgur.com/dKGqVMt.jpg",alt:"Choose a screenshot to use",className:"mobile-mockup-demo-image"})),i.createElement("div",{className:"mobile-mockup-demo-right"},i.createElement("div",{className:"mobile-mockup-demo-step-header"},"Step 1"),i.createElement("div",{className:"mobile-mockup-demo-step-description"},"Choose a screenshot to use as your mockup. The most ideal size is 360x668, but any image will work!"))),i.createElement("div",{className:"mobile-mockup-demo-container"},i.createElement("div",{className:"mobile-mockup-demo-left"},i.createElement(vZ,{src:"https://i.imgur.com/sxxfufO.jpg",alt:"Choose a background color",className:"mobile-mockup-demo-image"})),i.createElement("div",{className:"mobile-mockup-demo-right"},i.createElement("div",{className:"mobile-mockup-demo-step-header"},"Step 2"),i.createElement("div",{className:"mobile-mockup-demo-step-description"},"Select the color of the background and the phone frame, in order to customize your mockup. You can also enter a custom color!"))),i.createElement("div",{className:"mobile-mockup-demo-container"},i.createElement("div",{className:"mobile-mockup-demo-left"},i.createElement(vZ,{src:"https://i.imgur.com/vcit8Ji.png",alt:"Download your final mockup!",className:"mobile-mockup-demo-image"})),i.createElement("div",{className:"mobile-mockup-demo-right"},i.createElement("div",{className:"mobile-mockup-demo-step-header"},"Step 3"),i.createElement("div",{className:"mobile-mockup-demo-step-description"},'Your mockup will be generated in real time. You can either right click the phone and save as, or you can click "Download" to save the final mockup!')))),i.createElement("div",{className:pZ.spacer}),i.createElement("div",{className:pZ.spacer}),i.createElement("div",{className:pZ.spacer}),i.createElement("div",{className:pZ.spacer}),i.createElement("div",{className:"startup-demo-videos-list-container startup-demo-videos-footer-container"},i.createElement("div",{className:"startup-demo-videos-email-subscribe"},i.createElement("div",{className:"startup-demo-videos-subscribe-header"},"Looking for more?"),i.createElement("div",{className:"startup-demo-videos-subscribe-description"},"Sign up for our mailing list to get the latest updates:"),i.createElement(gZ,{source:"mobile-mockup"}))),i.createElement("div",{className:"mobile-mockup-share"},i.createElement(it,{url:"https://www.kapwing.com/mobile-mockup",quote:"Mobile Mockup - The simplest way to create a beautiful mobile mockup",className:"startup-demo-share-button"},i.createElement(st,{size:40,round:!0})),i.createElement(lt,{url:"https://www.kapwing.com/mobile-mockup",title:"Mobile Mockup - The simplest way to create a beautiful mobile mockup",via:"kapwingapp",hashtags:["mockup","design"],className:"startup-demo-share-button"},i.createElement(dt,{size:40,round:!0})),i.createElement("div",{className:"startup-demo-videos-text"},"Created with love by the team at"," ",i.createElement("a",{href:"https://www.kapwing.com"},"Kapwing"))),i.createElement(DJ,null))}}const L0=we(m.exports.connect(void 0,(e=>me({showToast:Su},e)))(R0)),D0="OverlayWrapper-module_overlayBackground_-tLeA",O0="OverlayWrapper-module_overlayContainer_695xA",F0="OverlayWrapper-module_exit_chpXg",M0="OverlayWrapper-module_overlayContent_520T1";class U0 extends r.exports.Component{render(){return i.createElement("div",null,i.createElement("div",{className:D0,onClick:()=>{this.props.history.goBack()},"data-cy":"overlay-background"}),i.createElement("div",{className:O0},i.createElement("div",{className:F0,onClick:()=>{this.props.history.goBack()}},i.createElement(pe,null)),i.createElement("div",{className:M0},this.props.children)))}}const B0=we(U0),W0="CreateOverlay-module_header_olnUM",V0="CreateOverlay-module_description_cHmlQ",j0=we((()=>i.createElement(B0,null,i.createElement("div",{className:W0},"Create MOTION"),i.createElement("p",{className:V0},"Sadly, creating a custom Motion is no longer available as of Feb 2020. Motion was a project launched in 2019 with the goal of making geometric animations from still images. You can see examples of the animations created on the ",i.createElement(at,{to:"/motion"},"Motion homepage")," as well as on the"," ",i.createElement("a",{href:"https://www.producthunt.com/posts/motion",target:"_blank",rel:"noopener noreferrer"},"Product Hunt launch"),"."),i.createElement("p",{className:V0},"We're happy to have brought joyful Motions to thousands of visitors over the years. Thanks for visiting our site!"),i.createElement("p",{className:V0},i.createElement("a",{href:"/"},"Visit Kapwing.com →"))))),G0=we((()=>i.createElement(yt,null,i.createElement(ft,{path:"/motion/create",component:j0})))),H0="Gallery-module_container_DvCaF",z0="Gallery-module_header_0bS-A",$0="Gallery-module_gallery_NWA9Q",K0="Gallery-module_previewContainer_V10gW",Y0="Gallery-module_sourceContainer_wDBk-",q0="Gallery-module_outputContainer_Bss-j",X0="Gallery-module_sourceImage_J-uY0",J0="Gallery-module_outputImage_RuZBo",Q0=[{sourceUrl:"https://i.imgur.com/4FA6dDr.jpg",outputUrl:"https://i.imgur.com/5nBce1A.gif"},{sourceUrl:"https://cdn-useast1.kapwing.com/samples/source_409RSJ.jpeg",outputUrl:"https://cdn-useast1.kapwing.com/samples/5c1af2514fc10e43a2d25fcb.gif"},{sourceUrl:"https://i.imgur.com/rHFKIj4.jpg",outputUrl:"https://cdn-useast1.kapwing.com/samples/5c1b1afa39c6ae472dfe9db7.gif"},{sourceUrl:"https://cdn-useast1.kapwing.com/samples/source_OMGSU0.jpeg",outputUrl:"https://cdn-useast1.kapwing.com/samples/5c1ae61da0208b3eee521d0d.gif"},{sourceUrl:"https://i.imgur.com/G0Ntbe7.jpg",outputUrl:"https://cdn-useast1.kapwing.com/samples/5c1b1bd3cab1a1474b9fdfc5.gif"}],Z0=we((()=>i.createElement("div",{className:H0},i.createElement("div",{className:z0},"Or, browse the gallery:"),i.createElement("div",{className:$0},Q0.map((e=>i.createElement("div",{key:e.sourceUrl,className:K0},i.createElement("div",{className:Y0},i.createElement(vZ,{src:e.sourceUrl,className:X0,alt:"Source Input"})),i.createElement("div",{className:q0},i.createElement(vZ,{src:e.outputUrl,className:J0,alt:"Ouput"}))))))))),e1="Motion-module_spacer_F62TB",t1="Motion-module_aboutSection_ypDHd",a1="Motion-module_header_y0sAj",o1="Motion-module_section_Xd66Q",n1="Motion-module_aboutHeader_9dwPo",r1="Motion-module_aboutSubheader_tMYQE",i1="Motion-module_aboutP_kYZls",s1="Motion-module_wrapper_YCnsy",l1="Motion-module_headerLeft_KYpQR",d1="Motion-module_headerRight_2oVEu",c1="Motion-module_headerLogoText_gX3Z7",u1="Motion-module_headerButton_MxGnJ",m1="Motion-module_heroContainer_KIWOp",p1="Motion-module_heroText_BGpAs",h1="Motion-module_heroDescription_8OqNL",g1="Motion-module_heroAction_8Qla-",y1="Motion-module_footerButton_hRgDY",f1=we((()=>i.createElement("div",null,i.createElement(rt,null,i.createElement("title",null,"Motion – Create Geometric Animations – Kapwing"),i.createElement("meta",{name:"description",content:"Motion – Create Geometric Animations – Kapwing"}),i.createElement("meta",{name:"keywords",content:"watermark photo, watermark video online, add watermark, brand video, add image to video, add text to video"}),i.createElement("meta",{property:"og:url",content:"https://www.kapwing.com/motion"}),i.createElement("meta",{property:"og:title",content:"Motion - Create Geometric Animations"}),i.createElement("meta",{property:"og:description",content:"Create stunning geometric GIFs and images from a still image. Using machine learning, this tool with recreate images with geometric shapes for a vector image effect."}),i.createElement("meta",{property:"og:image",content:"https://i.imgur.com/Fxt1FYb.jpg"}),i.createElement("meta",{property:"og:image:url",content:"https://i.imgur.com/Fxt1FYb.jpg"}),i.createElement("meta",{property:"twitter:image",content:"https://i.imgur.com/Fxt1FYb.jpg"}),i.createElement("link",{rel:"canonical",href:"https://www.kapwing.com/motion"})),i.createElement("div",{className:s1},i.createElement("div",{className:a1},i.createElement("div",{className:l1},i.createElement("div",{className:c1},"MOTION")),i.createElement("div",{className:d1},i.createElement(at,{to:"/motion/create"},i.createElement("div",{className:u1},"CREATE")))),i.createElement("div",{className:m1},i.createElement("h1",{className:p1},"Create Geometric Animations"),i.createElement("h2",{className:h1},i.createElement("b",null,"Motion")," uses machine learning to create stunning GIFs using geometric shapes. Get started below or see the"," ",i.createElement("a",{href:"https://github.com/kapwing/motion",target:"_blank",rel:"noopener noreferrer"},"code on Github"),"."),i.createElement("div",{className:g1},i.createElement(at,{to:"/motion/create"},i.createElement("div",{className:y1},"Get Started")))),i.createElement(Z0,null),i.createElement("div",{className:`${o1} ${t1}`},i.createElement("h3",{className:n1},"More about ",i.createElement("b",null,"Motion")),i.createElement("div",{className:r1},"Create beautiful geometric animations from your images"),i.createElement("div",{className:i1},i.createElement("b",null,"MOTION")," is an exploration of geometry, video, and machine learning. By using ML techniques, the tool generates shapes to fit the lines and colors of your image."),i.createElement("div",{className:i1},"We wanted to create a tool that could make short looping videos from still images, and the abstract effect created by geomatric shapes has always been a source of inspiration. With a unique hill-climbing algorithm, we were able to convert still photographs into beautiful, moving GIFs."),i.createElement("div",{className:i1},i.createElement("b",null,"About the options:")," Choose from a variety of shapes to create different outputs from a single image. Because there is a component of randomness, each output will be unique."),i.createElement("div",{className:i1},"The project was inspired by"," ",i.createElement("a",{href:"https://primitive.lol/",target:"_blank",rel:"noopener noreferrer"},"Primitive")," ","as well as"," ",i.createElement("a",{href:"https://github.com/Tw1ddle/geometrize",target:"_blank",rel:"noopener noreferrer"},"Geometrize"),". The stitching of frames into GIFs is made possible by"," ",i.createElement("a",{href:"https://www.ffmpeg.org/",target:"_blank",rel:"noopener noreferrer"},"FFMPEG")," ","and"," ",i.createElement("a",{href:"https://www.imagemagick.org/script/index.php",target:"_blank",rel:"noopener noreferrer"},"ImageMagick"),". For the full repo, check out the"," ",i.createElement("a",{href:"https://github.com/kapwing/motion",target:"_blank",rel:"noopener noreferrer"},"code on Github"),"."))),i.createElement("div",{className:m1},i.createElement("div",{className:g1},i.createElement(at,{to:"/motion/create"},i.createElement("div",{className:y1},"Create MOTION")))),i.createElement("div",{className:e1}),i.createElement("div",{className:e1}),i.createElement("div",{className:"share-footer"},i.createElement(it,{url:"https://www.kapwing.com/motion",quote:"Motion - turn your photo into a geometric GIF, powered by machine learning.",className:"startup-demo-share-button"},i.createElement(st,{size:40,round:!0})),i.createElement(lt,{url:"https://www.kapwing.com/motion",title:"Motion - turn your photo into a geometric GIF, powered by machine learning",via:"kapwingapp",hashtags:["motion","gif"],className:"startup-demo-share-button"},i.createElement(dt,{size:40,round:!0})),i.createElement("div",{className:"startup-demo-videos-text"},"Created with love by the team at"," ",i.createElement("a",{href:"https://www.kapwing.com"},"Kapwing"))),i.createElement(G0,null),i.createElement(DJ,null)))),E1=()=>{const e=m.exports.useDispatch(),t=Ie();return r.exports.useEffect((()=>{!async function(){const a=jc.get("GOOGLE_ONE_TAP_RESPONSE",{disabled:""})||"";a?(jc.remove("GOOGLE_ONE_TAP_RESPONSE"),await e(Qc(a,!0)).catch((t=>{((t,a="signIn",o="Sign In")=>{let n=t;t||(n="An error occurred during sign in with One Tap. Please try again later."),vc("Sign In Error Occurred",{"Error Type":a,Details:o,"One-Tap":!0}),e(Su({description:n,type:"error"}))})(t.message,"fetchGoogleUser")})),t.push("/")):t.push("/signin")}()}),[e,t]),i.createElement(oJ,null)},v1="NewTabStretches-module_container_kt8At",w1="NewTabStretches-module_content_89ftM",b1="NewTabStretches-module_header_ERNeR",_1="NewTabStretches-module_icon_Ru5CL",T1="NewTabStretches-module_share_1gUqo",S1="NewTabStretches-module_shareButton_jErDV",I1="NewTabStretches-module_title_AynMX",x1="NewTabStretches-module_subtitle_6sxPV",k1="NewTabStretches-module_video_xprXb",C1="NewTabStretches-module_downloadButton_pva4g",A1="NewTabStretches-module_buttonLabel_HlqCe",N1="NewTabStretches-module_buttonChromeLogo_m76Jy",P1="NewTabStretches-module_body_ncn9O",R1="NewTabStretches-module_explainer_r8Rbh",L1="NewTabStretches-module_photo_tqx23",D1="NewTabStretches-module_coverImage_pGyim",O1=()=>i.createElement(i.Fragment,null,i.createElement(rt,null,i.createElement("title",null,"New Tab Stretches - Chrome Extension – Kapwing"),i.createElement("meta",{name:"description",content:"Use the New Tab Stretches Chrome extension to improve your flexibility while working from home. Start getting reminders to stretch right after installing!"}),i.createElement("meta",{property:"og:url",content:"https://www.kapwing.com/new-tab-stretches"}),i.createElement("meta",{property:"og:title",content:"New Tab Stretches — Kapwing"}),i.createElement("meta",{property:"og:description",content:"New Tab Stretches is a Chrome extension that reminds you to stretch your body while you're working from home. Whenever you open a new tab in Chrome, New Tab Stretches will show you a new stretch that you could do right in your office or even at your desk. Just follow the graphic and the on screen instructions and start stretching more throughout the day!"}),i.createElement("meta",{property:"og:image",content:"https://i.imgur.com/BQ0WNy7.png"}),i.createElement("meta",{property:"og:image:url",content:"https://i.imgur.com/BQ0WNy7.png"}),i.createElement("meta",{property:"twitter:image",content:"https://i.imgur.com/BQ0WNy7.png"}),i.createElement("link",{rel:"canonical",href:"https://www.kapwing.com/new-tab-stretches"})),i.createElement("div",{className:v1},i.createElement("header",{className:b1},i.createElement("img",{src:"https://i.imgur.com/1HWhtMo.jpg",alt:"New Tab Stretches Icon",width:"40",height:"40",className:_1}),i.createElement("div",{className:T1},i.createElement(it,{url:"https://www.kapwing.com/new-tab-stretches",quote:"New Tab Stretches - Improve your flexibility with every new tab",className:S1},i.createElement(st,{size:40,round:!0})),i.createElement(lt,{url:"https://www.kapwing.com/new-tab-stretches",title:"New Tab Stretches - Improve your flexibility with every new tab",via:"kapwingapp",hashtags:["stretch","yoga","working from home"],className:S1},i.createElement(dt,{size:40,round:!0})))),i.createElement("main",{className:w1},i.createElement("h1",{className:I1},"New Tab Stretches"),i.createElement("div",{className:x1},"Improve your flexibility with every new tab."),i.createElement("div",{className:D1},i.createElement("video",{src:"https://cdn-useast1.kapwing.com/static/new-tab-stretches.mp4",alt:"stretch",autoPlay:!0,muted:!0,className:k1,controls:!0,loop:!0})),i.createElement("a",{href:"https://chrome.google.com/webstore/detail/bfacamkncebkphfahhljkjkhpinmicof",target:"_blank",rel:"noopener noreferrer"},i.createElement("button",{type:"button",className:C1},i.createElement("div",{className:N1},i.createElement(Et,null)),i.createElement("div",{className:A1},"Add New Tab Stretches to Chrome"))),i.createElement("div",{className:P1},i.createElement("div",{className:R1},i.createElement("p",null,"New Tab Stretches is a Chrome extension that reminds you to stretch your body while you're working from home. Whenever you open a new tab in Chrome, New Tab Stretches will show you a new stretch that you could do right in your office or even at your desk."),i.createElement("p",null,"The current COVID-19 situation has our whole team working from home. Gyms and many public areas are all closed. Since it's hard to get moving, we end up sitting at our desk for hours at a time."),i.createElement("div",null,i.createElement("img",{src:"https://i.imgur.com/NAtTr6Q.jpg",className:L1,alt:"Quad stretch"})),i.createElement("p",null,"New Tab Stretches is a small way to remind yourself to stay healthy and active throughout the day. Whether you're working intensely on a new project or just spending time browsing the web, the set of illustrations in your new tab can serve as a small reminder to move around. Many of the stretches can be done without having to get up from your computer, and all of the stretches can be done right near your desk."),i.createElement("p",null,"There's nothing special that you need to do in order to get set up and get started with this extension. Just install it directly from the Chrome extension store, and it will start working on your next new tab. You don't even need to restart your browser."),i.createElement("div",null,i.createElement("img",{src:"https://i.imgur.com/glTpHA6.jpg",className:L1,alt:"Neck stretch"})),i.createElement("p",null,"We worked with a professional illustrator to create original drawings of a diverse set of models who represent the many different types of people who could benefit from stretching throughout the day. We're also trying to improve the number of stretches in the extension as we create more illustrations and learn more stretches!"),i.createElement("div",null,i.createElement("img",{src:"https://i.imgur.com/bGdcmpS.jpg",className:L1,alt:"Calf stretch"})),i.createElement("p",null,"We hope that this extension can be a way to help in a small way throughout this pandemic. Thanks for sharing it with your friends!"),i.createElement("p",null,i.createElement("a",{href:"https://chrome.google.com/webstore/detail/bfacamkncebkphfahhljkjkhpinmicof",target:"_blank",rel:"noopener noreferrer"},i.createElement("button",{type:"button",className:C1},i.createElement("div",{className:N1},i.createElement(Et,null)),i.createElement("div",{className:A1},"Add New Tab Stretches to Chrome")))),i.createElement("p",null,"Made with love by the team at"," ",i.createElement("a",{href:"https://www.kapwing.com",target:"_blank",rel:"noopener noreferrer"},"Kapwing"),".")))))),F1="NotFound-module_notFoundContainer_FbIpq",M1="NotFound-module_notFoundImageContainer_3O6EM",U1="NotFound-module_notFoundImage_RU2Pw",B1="NotFound-module_link_MCVdM",W1="NotFound-module_bigTitle_hjw-2",V1="NotFound-module_title_qFNuj",j1=()=>{const e="Page Not Found — 404 — Kapwing",t="Sorry, the page you were looking for cannot be found. Our team at Kapwing is investigating this 404 error. In the meantime, please return to Kapwing.com to continue browsing.";return i.createElement(i.Fragment,null,i.createElement(QQ,null),i.createElement(rt,null,i.createElement("title",null,e),i.createElement("meta",{name:"description",content:t}),i.createElement("meta",{name:"keywords",content:"404, Page Not Found"}),i.createElement("meta",{property:"og:title",content:e}),i.createElement("meta",{property:"og:description",content:t}),i.createElement("meta",{name:"robots",content:"noindex, nofollow"})),i.createElement("div",{className:F1},i.createElement("div",null,i.createElement("div",{className:M1},i.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/MHZ-404.webp",alt:"Not Found Kitten",className:U1})),i.createElement("h1",{className:W1},"404 — Page Not Found"),i.createElement("div",{className:V1},"Sorry, the page you were looking for cannot be found."),i.createElement("div",{className:V1},i.createElement("a",{href:"/",className:B1},"Click here to return home.")))),i.createElement(DJ,null))},G1=we(m.exports.connect(void 0,(e=>me({receiveUserAndSetToken:qc,getUserTeams:jE,setOnboarding:Mu,setWorkspaces:gv,setTeams:DE,showToast:Su},e)))((e=>{const{showToast:t,receiveUserAndSetToken:a,setOnboarding:o,setWorkspaces:n,setTeams:s}=e,l=Ie(),d=oe(),c=m.exports.useDispatch(),u=tr((e=>e.sessionValues.onboarding));return r.exports.useEffect((()=>{!async function(){const e=new URLSearchParams(d.search||""),r=e.get("code"),i=new URLSearchParams(e.get("state")||""),m=i.get("pathname")||"/",p=i.get("goToNext"),h=e=>{l.replace(m),t({description:e,type:"error"}),vc("Sign In Error Occurred",{"Error Type":"googleResponse",Details:e})};if(r)try{const e=await gu("/api/v1/users/google/loginWithOAuth",{body:{code:r}});a(e.user,e.token),Sc(e.user,e.newUser,"Google",!1),Oc(e.user,e.newUser,"Google",m),TO(),e.newUser&&o({...u,newUser:!0}),e.workspace&&n([e.workspace]),e.team?s([e.team]):await c(jE()),l.replace(m),p&&l.push(p)}catch(YEe){const{message:t}=xu(YEe);h(t||"An error occured while confirming Google authorization.")}else h("Missing Google authorization code.")}()}),[]),i.createElement(oJ,null)})));class H1 extends r.exports.Component{constructor(){super(...arguments),a(this,"installRickRoller",(()=>{window.open("https://chrome.google.com/webstore/detail/mjklaailjabbidpmbngdceejclkbikib","_blank")}))}render(){return i.createElement("div",null,i.createElement("div",{className:"startup-videos-wrapper"},i.createElement(rt,null,i.createElement("title",null,"Rick Roller – Kapwing"),i.createElement("meta",{name:"description",content:"Use this free Chrome extension to Rick Roll friends who forget to lock their computer or leave their computer unattended. Let the rick-rolling begin!"}),i.createElement("meta",{property:"og:url",content:"https://www.kapwing.com/rick-roller"}),i.createElement("meta",{property:"og:title",content:"Rick Roller - Kapwing"}),i.createElement("meta",{property:"og:description",content:"A Chrome extension to Rick Roll friends who forget to lock their computer"}),i.createElement("meta",{property:"og:image",content:"https://i.imgur.com/HWgjbJ0.jpg"}),i.createElement("meta",{property:"og:image:url",content:"https://i.imgur.com/HWgjbJ0.jpg"}),i.createElement("meta",{property:"twitter:image",content:"https://i.imgur.com/HWgjbJ0.jpg"}),i.createElement("link",{rel:"canonical",href:"https://www.kapwing.com/rick-roller"})),i.createElement("div",{className:"startup-demo-videos-header-container"},i.createElement("div",null,i.createElement("div",null,i.createElement("img",{src:"https://i.imgur.com/wU6NJAI.jpg",alt:"Rick Roller Logo",className:"rick-roller-logo"})),i.createElement("div",{className:"rick-roller-header"},"Rick Roller"),i.createElement("div",{className:"rick-roller-description"},"A Chrome extension to Rick Roll friends who forget to lock their computer"),i.createElement("div",{className:"rick-roller-download-container"},i.createElement("button",{type:"button",className:"rick-roller-download-button",onClick:this.installRickRoller},i.createElement("div",{className:"rick-roller-download-button-chrome-logo"},i.createElement(Et,null)),i.createElement("div",{className:"rick-roller-download-button-header"},"Add to Chrome"),i.createElement("div",{className:"rick-roller-download-button-description"},"(do it on your friend's computer)"))),i.createElement("div",{className:"rick-roller-demo-container"},i.createElement("div",{className:"rick-roller-demo-header"},"How it works"),i.createElement("div",{className:"rick-roller-demo-left"},i.createElement(vZ,{src:"https://i.imgur.com/j8DZRFK.png",alt:"Download the extension screenshot",className:"rick-roller-demo-image"})),i.createElement("div",{className:"rick-roller-demo-right"},i.createElement("div",{className:"rick-roller-demo-step-header"},"Step 1"),i.createElement("div",{className:"rick-roller-demo-step-description"},"When your friend leaves their computer unlocked, install the Rick Roller extension on the Chrome browser on their computer."))),i.createElement("div",{className:"rick-roller-demo-container"},i.createElement("div",{className:"rick-roller-demo-left"},i.createElement(vZ,{src:"https://i.imgur.com/H9yF65L.jpg",alt:"Watch your friend click a link",className:"rick-roller-demo-image"})),i.createElement("div",{className:"rick-roller-demo-right"},i.createElement("div",{className:"rick-roller-demo-step-header"},"Step 2"),i.createElement("div",{className:"rick-roller-demo-step-description"},"Once the extension is installed, wait for your friend to click some links for the fun to begin!"))),i.createElement("div",{className:"rick-roller-demo-container"},i.createElement("div",{className:"rick-roller-demo-left"},i.createElement(vZ,{src:"https://i.imgur.com/NEXyAsU.jpg",alt:"Wait and watch them get rick rolled!",className:"rick-roller-demo-image"})),i.createElement("div",{className:"rick-roller-demo-right"},i.createElement("div",{className:"rick-roller-demo-step-header"},"Step 3"),i.createElement("div",{className:"rick-roller-demo-step-description"},"Your friend gets randomly rick roll'd while browsing the web. Have fun!"))))),i.createElement("div",{className:"startup-demo-videos-list-container startup-demo-videos-footer-container"},i.createElement("div",{className:"startup-demo-videos-email-subscribe"},i.createElement("div",{className:"startup-demo-videos-subscribe-header"},"Looking for more?"),i.createElement("div",{className:"startup-demo-videos-subscribe-description"},"Sign up for our mailing list to get the latest updates:"),i.createElement(gZ,{source:"rick-roll"}))),i.createElement("div",{className:"rick-roller-share"},i.createElement(it,{url:"https://www.kapwing.com/rick-roller",quote:"Rick Roller - an extension to Rick Roll your friends",className:"startup-demo-share-button"},i.createElement(st,{size:40,round:!0})),i.createElement(lt,{url:"https://www.kapwing.com/rick-roller",title:"Rick Roller - an extension to Rick Roll your friends",via:"kapwingapp",hashtags:["rickroll","aprilfools"],className:"startup-demo-share-button"},i.createElement(dt,{size:40,round:!0})),i.createElement("div",{className:"startup-demo-videos-text"},"Created with love by the team at"," ",i.createElement("a",{href:"https://www.kapwing.com"},"Kapwing")))),i.createElement(DJ,null))}}const z1=we(H1),$1="Sidedoor-module_container_yhbWF",K1="Sidedoor-module_headerBar_6X8wc",Y1="Sidedoor-module_hero_hGi0x",q1="Sidedoor-module_heroHeader_osl7K",X1="Sidedoor-module_heroSubheader_3nDYp",J1="Sidedoor-module_heroButtons_tiMDO",Q1="Sidedoor-module_heroButton_EaauJ",Z1="Sidedoor-module_sectionLight_6Phc-",e2="Sidedoor-module_sectionSmall_np57A",t2="Sidedoor-module_sectionLarge_-3HOX",a2="Sidedoor-module_sectionRight_sxdyH",o2="Sidedoor-module_sectionHeader_Yi-eu",n2="Sidedoor-module_sectionSubheader_6IRjK",r2="Sidedoor-module_sectionLeft_5SXGj",i2="Sidedoor-module_sectionImage_9C-og",s2="Sidedoor-module_sectionButtons_ulfEY",l2="Sidedoor-module_sectionButton_j3tAp",d2="Sidedoor-module_howItWorks_rzT-d",c2="Sidedoor-module_howItWorksBullet_kws9z",u2="Sidedoor-module_howItWorksBulletNumber_9995R",m2="Sidedoor-module_howItWorksBulletDescription_Ifyb-",p2="Sidedoor-module_testimonials_kmFJr",h2="Sidedoor-module_testimonialsHeader_Ruz6u",g2="Sidedoor-module_testimonial_PqYY8",y2="Sidedoor-module_testimonialImageContainer_8IbSI",f2="Sidedoor-module_testimonialImage_ET-jj",E2="Sidedoor-module_testimonialName_xdK1r",v2="Sidedoor-module_footer_Ac-fS",w2="Sidedoor-module_footerHeader_88hLa",b2="Sidedoor-module_footerDescription_qsFZR",_2="Sidedoor-module_bestsellers_Rsgso",T2="Sidedoor-module_bestsellersItem_cXYcg",S2="Sidedoor-module_bestsellersItemInner_XuSa-",I2="Sidedoor-module_bestsellersHeader_Hs36r",x2="Sidedoor-module_bestsellersLeft_K-kFT",k2="Sidedoor-module_bestsellersRight_DOVYN",C2="Sidedoor-module_bestsellersImageContainer_IuzNS",A2="Sidedoor-module_bestsellersImage_WPOlQ",N2="Sidedoor-module_bestsellersName_XZkP-",P2="Sidedoor-module_bestsellersDescription_pwM7-",R2="Sidedoor-module_bestsellersButtonContainer_SGLx9",L2="Sidedoor-module_bestsellersButton_hlZkZ",D2="Sidedoor-module_returnContainer_8tbxt",O2="Sidedoor-module_startupDemoShareButton_uxH4S";class F2 extends r.exports.Component{render(){return i.createElement("div",{className:v2},i.createElement("div",{className:w2},"About Sidedoor"),i.createElement("div",{className:b2},"Sidedoor is a side-business created with love by the team at"," ",i.createElement("a",{href:"/"},"Kapwing"),". If you find it useful, please help spread the love with a share!"),i.createElement("div",{className:b2},i.createElement(it,{url:"https://www.kapwing.com/sidedoor",quote:"Sidedoor - College acceptance simplified",className:O2},i.createElement(st,{size:40,round:!0})),i.createElement(lt,{url:"https://www.kapwing.com/sidedoor",title:"Sidedoor - College acceptance simplified",hashtags:["college","accepted"],className:O2},i.createElement(dt,{size:40,round:!0}))))}}const M2=we(F2);class U2 extends r.exports.Component{render(){return i.createElement("div",{className:K1},i.createElement(at,{to:"/sidedoor"},"Sidedoor"))}}const B2=we(U2),W2=[{name:"Lori Loughlin",image:"https://i.imgur.com/BAa9OWe.jpg",description:"American actress"},{name:"Bill McGlashan",image:"https://i.imgur.com/422a6G7.png",description:"Founder of TGP Growth"},{name:"Chris Schaepe",image:"https://i.imgur.com/rIVdoFX.png",description:"Co-founder of Lightspeed Venture Partners"},{name:"Gamal Aziz",image:"https://i.imgur.com/dnChPbR.jpg",description:"President of Wynn Resorts"},{name:"Felicity Huffman",image:"https://i.imgur.com/KjioaI2.png",description:"American Actress"},{name:"You?",image:"https://i.imgur.com/u7fAmA2.png",description:"Our next happy partner!"}];class V2 extends r.exports.Component{constructor(e){super(e),lB({type:"default",fontFamily:"Rubik"})}render(){return i.createElement(i.Fragment,null,i.createElement(rt,null,i.createElement("title",null,"Sidedoor - College Acceptance Simplified"),i.createElement("meta",{name:"description",content:"Getting into college is too hard. With Sidedoor, you can easily purchase college acceptances at top universities, including Yale, USC, Georgetown, and more. You're different. Why apply like everyone else?"}),i.createElement("meta",{property:"og:url",content:"https://www.kapwing.com/sidedoor"}),i.createElement("meta",{property:"og:title",content:"Sidedoor - College Acceptance Simplified"}),i.createElement("meta",{property:"og:description",content:"Getting into college is too hard. With Sidedoor, you can easily purchase college acceptances at top universities, including Yale, USC, Georgetown, and more. You're different. Why apply like everyone else?"}),i.createElement("meta",{property:"og:image",content:"https://i.imgur.com/32NaUXQ.jpg"}),i.createElement("meta",{property:"og:image:url",content:"https://i.imgur.com/32NaUXQ.jpg"}),i.createElement("meta",{property:"twitter:image",content:"https://i.imgur.com/32NaUXQ.jpg"}),i.createElement("link",{rel:"canonical",href:"https://www.kapwing.com/sidedoor"})),i.createElement("div",{className:$1},i.createElement(B2,null),i.createElement("div",{className:Y1},i.createElement("div",{className:q1},"College acceptance simplified"),i.createElement("div",{className:X1},"Somewhere along the way, getting into college became too hard. We thought, there must be a better way. Introducing ",i.createElement("b",null,"Sidedoor"),"."),i.createElement("div",{className:J1},i.createElement(at,{to:"/sidedoor/ivy-league"},i.createElement("div",{className:Q1},"Shop Ivy League")),i.createElement(at,{to:"/sidedoor/west-coast"},i.createElement("div",{className:Q1},"Shop West Coast")))),i.createElement("div",{className:Z1},i.createElement("div",{className:e2},"Trusted, easy, and affordable"),i.createElement("div",{className:t2},"Your acceptance, guaranteed.")),i.createElement("div",null,i.createElement("div",{className:r2},i.createElement("div",{className:o2},"Ivy League"),i.createElement("div",{className:n2},"You've always forged your own path. You're not the kind to run with the crowd. So why apply just like everyone else?"),i.createElement("div",{className:s2},i.createElement(at,{to:"/sidedoor/ivy-league"},i.createElement("div",{className:l2},"Shop Ivy League")))),i.createElement("div",{className:a2},i.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/0a963c_c7763f3a5bc54773b082bf24cf22c6cd_mv2_d_2048_1365_s_2.jpg",className:i2,alt:"college boys"}))),i.createElement("div",null,i.createElement("div",{className:r2},i.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/jason-leung-417009-unsplash.jpg",className:i2,alt:"stanford"})),i.createElement("div",{className:a2},i.createElement("div",{className:o2},"West Coast"),i.createElement("div",{className:n2},"Sunshine, startups, and surfing. Home to burritos and the Warriors. Your golden future awaits."),i.createElement("div",{className:s2},i.createElement(at,{to:"/sidedoor/west-coast"},i.createElement("div",{className:l2},"Shop West Coast"))))),i.createElement("div",{className:d2},i.createElement("div",{className:o2},"How it works"),i.createElement("div",{className:c2},i.createElement("div",{className:u2},"1"),i.createElement("div",{className:m2},"Take your SATs with one of our trusted proctors. They'll make sure you get the scores you need.")),i.createElement("div",{className:c2},i.createElement("div",{className:u2},"2"),i.createElement("div",{className:m2},"Fill out an athletic profile. Don't worry - you don't need to have any actual athletic background.")),i.createElement("div",{className:c2},i.createElement("div",{className:u2},"3"),i.createElement("div",{className:m2},"Sidedoor works directly with coaches to make sure that your acceptance is guaranteed. No legacy status required!"))),i.createElement("div",{className:p2},i.createElement("div",{className:h2},"Serving thousands of happy customers"),W2.map((e=>i.createElement("div",{className:g2,key:e.name},i.createElement("div",{className:y2},i.createElement("img",{src:e.image,className:f2,alt:e.name})),i.createElement("div",{className:E2},e.name),i.createElement("div",null,e.description))))),i.createElement("div",{className:_2},i.createElement("div",{className:e2},"You're going to like what you find"),i.createElement("div",{className:I2},"Our Bestsellers"),i.createElement("div",{className:x2,onClick:()=>{this.props.history.push("/sidedoor/ivy-league/yale")}},i.createElement("div",{className:C2},i.createElement("img",{src:"https://i.imgur.com/qhYSTIj.jpg",className:A2,alt:"Yale"})),i.createElement("div",{className:N2},"Yale University"),i.createElement("div",{className:P2},"Since its founding in 1701, Yale has been dedicated to expanding and sharing knowledge, inspiring innovation, and preserving cultural and scientific information for future generations."),i.createElement("div",{className:R2},i.createElement("div",{className:L2},"Shop Yale - from $630k"))),i.createElement("div",{className:k2,onClick:()=>{this.props.history.push("/sidedoor/west-coast/usc")}},i.createElement("div",{className:C2},i.createElement("img",{src:"https://i.imgur.com/vJPoRZ7.jpg",className:A2,alt:"USC"})),i.createElement("div",{className:N2},"University of Southern California"),i.createElement("div",{className:P2},"The University of Southern California is one of the world’s top private research universities. USC’s curricular offerings provide extensive opportunities for interdisciplinary study."),i.createElement("div",{className:R2},i.createElement("div",{className:L2},"Shop USC - from $200k")))),i.createElement(M2,null)))}}const j2=we(V2),G2=[{name:"Yale University",shortname:"Yale",image:"https://i.imgur.com/qhYSTIj.jpg",description:"Since its founding in 1701, Yale has been dedicated to expanding and sharing knowledge, inspiring innovation, and preserving cultural and scientific information for future generations.",link:"/sidedoor/ivy-league/yale",borderColor:"#DFDFDE",price:"630k"},{name:"Harvard University",shortname:"Harvard",image:"https://i.imgur.com/Rj2ee8c.jpg",description:"Established in 1636, Harvard is the oldest institution of higher education in the United States. The University, which is based in Cambridge and Boston, Massachusetts, has an enrollment of over 20,000 degree candidates.",link:"/sidedoor/ivy-league/harvard",price:"1.3m"},{name:"Georgetown University",shortname:"Georgetown",image:"https://i.imgur.com/R9zjl1J.jpg",description:"Located in the nation's capitol, Georgetown is home to a vibrant community of accomplished students, distinguished faculty members and committed professional staff.",link:"/sidedoor/ivy-league/georgetown",price:"350k"}];class H2 extends r.exports.Component{render(){const{history:e}=this.props;return i.createElement(i.Fragment,null,i.createElement(rt,null,i.createElement("title",null,"Sidedoor - Ivy League"),i.createElement("meta",{name:"description",content:"Getting into college is too hard. With Sidedoor, you can easily purchase college acceptances at top universities, including Yale, USC, Georgetown, and more. You're different. Why apply like everyone else?"}),i.createElement("meta",{property:"og:url",content:"https://www.kapwing.com/sidedoor"}),i.createElement("meta",{property:"og:title",content:"Sidedoor - College Acceptance Simplified"}),i.createElement("meta",{property:"og:description",content:"Getting into college is too hard. With Sidedoor, you can easily purchase college acceptances at top universities, including Yale, USC, Georgetown, and more. You're different. Why apply like everyone else?"}),i.createElement("meta",{property:"og:image",content:"https://i.imgur.com/32NaUXQ.jpg"}),i.createElement("meta",{property:"og:image:url",content:"https://i.imgur.com/32NaUXQ.jpg"}),i.createElement("meta",{property:"twitter:image",content:"https://i.imgur.com/32NaUXQ.jpg"}),i.createElement("link",{rel:"canonical",href:"https://www.kapwing.com/sidedoor/ivy-league"})),i.createElement("div",{className:$1},i.createElement(B2,null),i.createElement("div",{className:_2,style:{paddingTop:"40px"}},i.createElement("div",{className:I2},"Ivy League"),G2.map((t=>i.createElement("div",{className:T2,key:t.name,onClick:()=>{e.push(t.link)}},i.createElement("div",{className:S2,style:{borderColor:t.borderColor}},i.createElement("div",{className:C2},i.createElement("img",{src:t.image,className:A2,alt:t.name})),i.createElement("div",{className:N2},t.name),i.createElement("div",{className:P2},t.description),i.createElement("div",{className:R2},i.createElement(at,{to:t.link},i.createElement("div",{className:L2},"Shop ",t.shortname," - from $",t.price))))))),i.createElement("div",{className:T2},i.createElement("div",{className:S2,style:{borderColor:"#DFDFDE"}},i.createElement("div",{className:C2},i.createElement("img",{src:"https://i.imgur.com/kq9v1JI.jpg",className:A2,alt:"More coming soon"})),i.createElement("div",{className:N2},"Stay tuned..."),i.createElement("div",{className:P2},"We're constantly building relationships and adding new schools. Stay tuned for more schools in Ivy League!"),i.createElement("div",null))),i.createElement("div",{className:D2},i.createElement(at,{to:"/sidedoor"},i.createElement("div",{className:L2},"Return home")))),i.createElement(M2,null)))}}const z2=we(H2),$2=[{name:"Stanford University",shortname:"Stanford",image:"https://cdn-useast1.kapwing.com/static/jason-leung-417009-unsplash.jpg",description:"Stanford University is one of the world’s leading research universities. It is known for its entrepreneurial character, drawn from the legacy of its founders, Jane and Leland Stanford, and its relationship to Silicon Valley",link:"/sidedoor/west-coast/stanford",borderColor:"#DFDFDE",price:"800k"},{name:"University of Southern California",shortname:"USC",image:"https://i.imgur.com/vJPoRZ7.jpg",description:"The University of Southern California is one of the world’s top private research universities. USC’s curricular offerings provide extensive opportunities for interdisciplinary study.",link:"/sidedoor/west-coast/usc",price:"75k"},{name:"University of California, Los Angeles",shortname:"UCLA",image:"https://i.imgur.com/zhdlPwy.jpg",description:"For nearly 100 years, UCLA has been a pioneer, persevering through impossibility, turning the futile into the attainable.",link:"/sidedoor/west-coast/ucla",price:"240k"}];class K2 extends r.exports.Component{render(){const{history:e}=this.props;return i.createElement(i.Fragment,null,i.createElement(rt,null,i.createElement("title",null,"Sidedoor - West Coast"),i.createElement("meta",{name:"description",content:"Getting into college is too hard. With Sidedoor, you can easily purchase college acceptances at top universities, including Yale, USC, Georgetown, and more. You're different. Why apply like everyone else?"}),i.createElement("meta",{property:"og:url",content:"https://www.kapwing.com/sidedoor"}),i.createElement("meta",{property:"og:title",content:"Sidedoor - College Acceptance Simplified"}),i.createElement("meta",{property:"og:description",content:"Getting into college is too hard. With Sidedoor, you can easily purchase college acceptances at top universities, including Yale, USC, Georgetown, and more. You're different. Why apply like everyone else?"}),i.createElement("meta",{property:"og:image",content:"https://i.imgur.com/32NaUXQ.jpg"}),i.createElement("meta",{property:"og:image:url",content:"https://i.imgur.com/32NaUXQ.jpg"}),i.createElement("meta",{property:"twitter:image",content:"https://i.imgur.com/32NaUXQ.jpg"}),i.createElement("link",{rel:"canonical",href:"https://www.kapwing.com/sidedoor/west-coast"})),i.createElement("div",{className:$1},i.createElement(B2,null),i.createElement("div",{className:_2,style:{paddingTop:"40px"}},i.createElement("div",{className:I2},"West Coast"),$2.map((t=>i.createElement("div",{className:T2,key:t.name,onClick:()=>{e.push(t.link)}},i.createElement("div",{className:S2,style:{borderColor:t.borderColor}},i.createElement("div",{className:C2},i.createElement("img",{src:t.image,className:A2,alt:t.name})),i.createElement("div",{className:N2},t.name),i.createElement("div",{className:P2},t.description),i.createElement("div",{className:R2},i.createElement(at,{to:t.link},i.createElement("div",{className:L2},"Shop ",t.shortname," - from $",t.price))))))),i.createElement("div",{className:T2},i.createElement("div",{className:S2,style:{borderColor:"#DFDFDE"}},i.createElement("div",{className:C2},i.createElement("img",{src:"https://i.imgur.com/kq9v1JI.jpg",className:A2,alt:"More coming soon"})),i.createElement("div",{className:N2},"Stay tuned..."),i.createElement("div",{className:P2},"We're constantly building relationships and adding new schools. Stay tuned for more schools on the west coast!"),i.createElement("div",null))),i.createElement("div",{className:D2},i.createElement(at,{to:"/sidedoor"},i.createElement("div",{className:L2},"Return home")))),i.createElement(M2,null)))}}const Y2=we(K2),q2={yale:{image:"https://i.imgur.com/jiHsYEp.jpg",name:"Yale University",description:"Admission to the school will be granted through the soccer team.",price:"630k"},harvard:{image:"https://i.imgur.com/75CICnw.jpg",name:"Harvard University",description:"Goodbye Z-list. Hello Sidedoor list.",price:"1.3m"},georgetown:{image:"https://i.imgur.com/ncwsxVU.jpg",name:"Georgetown University",description:'"Play" on the storied Georgetown tennis team.',price:"350k"},stanford:{image:"https://i.imgur.com/Ca5ft4n.jpg",name:"Stanford University",description:"Admittance through the sailing team. You can sail if you want to, too!",price:"800k"},usc:{image:"https://i.imgur.com/0PGHt5k.jpg",name:"University of Southern California",description:"Play on the storied football team. You could probably be a kicker, anyways.",price:"75k"},ucla:{image:"https://i.imgur.com/r6ydn22.jpg",name:"University of California, Los Angeles",description:"Play on the soccer team at UCLA. Don't worry, you won't have to start.",price:"240k"}};const X2="OverlayWrapper-module_overlayBackground_3fnyE",J2="OverlayWrapper-module_overlayContainer_iI6Ae",Q2="OverlayWrapper-module_exit_um-2i",Z2="OverlayWrapper-module_overlayContent_HdbWH";class e3 extends r.exports.Component{render(){return i.createElement("div",null,i.createElement("div",{className:X2,onClick:()=>{this.props.onClose()},"data-cy":"overlay-background"}),i.createElement("div",{className:J2},i.createElement("div",{className:Q2,onClick:()=>{this.props.onClose()}},i.createElement(pe,null)),i.createElement("div",{className:Z2},this.props.children)))}}const t3=we(e3),a3="School-module_background_CSIry",o3="School-module_tile_ySOVO",n3="School-module_tileHeader_HWaHu",r3="School-module_tileDescription_zai3l",i3="School-module_tileSteps_ZKHiI",s3="School-module_tileStep_Jl2Dw",l3="School-module_tileStepHeader_SRwjE",d3="School-module_tileStepSubheader_2hvzJ",c3="School-module_button_FL67u",u3="School-module_buttonHelper_K9NBt",m3="School-module_disclaimer_1dSDk",p3="School-module_overlayHeader_LXt9h",h3="School-module_overlayDescription_lEzDs";class g3 extends r.exports.Component{constructor(e){super(e),this.state={showOverlay:!1}}render(){const{school:e}=this.props.match.params,{history:t}=this.props,{showOverlay:a}=this.state,o=function(e){if(e in q2)return q2[e]}(e);if(!o)return t.push("/sidedoor"),null;return i.createElement(i.Fragment,null,i.createElement(rt,null,i.createElement("title",null,o.name," - Sidedoor"),i.createElement("meta",{name:"description",content:"Getting into college is too hard. With Sidedoor, you can easily purchase college acceptances at top universities, including Yale, USC, Georgetown, and more. You're different. Why apply like everyone else?"}),i.createElement("meta",{property:"og:url",content:"https://www.kapwing.com/sidedoor"}),i.createElement("meta",{property:"og:title",content:"Sidedoor - College Acceptance Simplified"}),i.createElement("meta",{property:"og:description",content:"Getting into college is too hard. With Sidedoor, you can easily purchase college acceptances at top universities, including Yale, USC, Georgetown, and more. You're different. Why apply like everyone else?"}),i.createElement("meta",{property:"og:image",content:"https://i.imgur.com/32NaUXQ.jpg"}),i.createElement("meta",{property:"og:image:url",content:"https://i.imgur.com/32NaUXQ.jpg"}),i.createElement("meta",{property:"twitter:image",content:"https://i.imgur.com/32NaUXQ.jpg"}),i.createElement("link",{rel:"canonical",href:`https://www.kapwing.com/sidedoor/${"harvard"===e||"georgetown"===e||"yale"===e?"ivy-league":"west-coast"}/${e}`})),i.createElement(B2,null),i.createElement("div",{className:a3,style:{width:"100vw",height:"100vh",backgroundColor:"#333333",backgroundImage:`url("${o.image}")`}},i.createElement("div",{className:o3},i.createElement("div",{className:n3},o.name),i.createElement("div",{className:r3},o.description),i.createElement("div",{className:i3},i.createElement("div",{className:s3},i.createElement("span",{className:l3},"1. Purchase upfront"),i.createElement("span",{className:d3},"Refundable for 30 days")),i.createElement("div",{className:s3},i.createElement("span",{className:l3},"2. Take our SAT"),i.createElement("span",{className:d3},"Location and proctor provided")),i.createElement("div",{className:s3},i.createElement("span",{className:l3},"3. Submit photos"),i.createElement("span",{className:d3},"Wearing athletic clothes")),i.createElement("div",{className:s3},i.createElement("span",{className:l3},"4. Enjoy senior year"),i.createElement("span",{className:d3},"Don't worry like everyone else"))),i.createElement("div",{className:c3,onClick:()=>{this.setState({showOverlay:!0})}},"Purchase now - $",o.price," ",i.createElement("span",{className:u3},"One time payment")),i.createElement("div",{className:m3},"* No legacy status required for purchase. Admissions are 100% legitimate and legal. Confidentiality guaranteed."),a?i.createElement(t3,{onClose:()=>this.setState({showOverlay:!1})},i.createElement("div",{className:p3},"Happy April Fools' Day!"),i.createElement("div",{className:h3},i.createElement("p",null,"Unfortunately, if you're trying to buy admission on this website, you probably can't afford it."),i.createElement("p",null,"Enjoy Sidedoor? Please help use spread the word on Facebook, Twitter, or your social network of choice!"),i.createElement("p",null,"Built with love by the team at"," ",i.createElement("a",{href:"https://www.kapwing.com",target:"_blank",rel:"noopener noreferrer"},"Kapwing"),"."),i.createElement("p",null,i.createElement(at,{to:"/sidedoor"},"Return to Sidedoor →")))):null)))}}const y3=we(g3);class f3 extends r.exports.Component{constructor(e){super(e),lB({type:"default",fontFamily:"Rubik"})}render(){return i.createElement(yt,null,i.createElement(ft,{path:"/sidedoor",exact:!0,component:j2}),i.createElement(ft,{path:"/sidedoor/ivy-league",exact:!0,component:z2}),i.createElement(ft,{path:"/sidedoor/ivy-league/:school",component:y3}),i.createElement(ft,{path:"/sidedoor/west-coast",exact:!0,component:Y2}),i.createElement(ft,{path:"/sidedoor/west-coast/:school",component:y3}))}}const E3=we(f3),v3="SignIn-module_signInWrapper_lkskh",w3="SignIn-module_signInLeft_KfIRn",b3="SignIn-module_signInContainer_FS7-R",_3="SignIn-module_signInImage_n-oku",T3="SignIn-module_image_mhEPP";var S3=(e=>(e.TEAMS="teams",e))(S3||{});const I3=()=>{const e=Ie(),t=tr((e=>e.currentUser)),{search:a}=oe(),o=r.exports.useMemo((()=>new URLSearchParams(a)),[a]),n=o.get("next");r.exports.useEffect((()=>{var a;if(sc(t))if(n)e.push({pathname:n});else{const n=null==(a=e.location.state)?void 0:a.pathname;e.push({pathname:null!=n?n:"/",state:{redirectSource:o.get("from")}}),"teams"===o.get("from")&&vc("Clicked Create a Team",{Email:t.user.email})}}),[t,e,o,n]);const s=async()=>{var t;if(n)e.push({pathname:n});else{const a=null==(t=e.location.state)?void 0:t.pathname;e.push({pathname:null!=a?a:"/",state:{redirectSource:o.get("from")}})}},l="Sign In or Sign Up — Kapwing",d="Kapwing works better if you sign in. Sign in to access your projects, save content to your workspace, preview beta features, and much more.";return i.createElement(i.Fragment,null,i.createElement(QQ,null),i.createElement(rt,null,i.createElement("title",null,l),i.createElement("meta",{name:"description",content:d}),i.createElement("meta",{name:"keywords",content:"sign in, login, signup, sign in to Kapwing"}),i.createElement("meta",{property:"og:title",content:l}),i.createElement("meta",{property:"og:description",content:d})),i.createElement("div",{className:v3},i.createElement("div",{className:w3},i.createElement("div",{className:b3},i.createElement("div",{className:zF},"Sign in to continue"),i.createElement("div",{className:$F},"Kapwing works better when you’re signed in. Sign in to save content to a workspace, share with others, and more."),n?i.createElement(jF,{onSuccess:s,immediateRedirectPathname:e.location.pathname+e.location.search,forceNavigationTo:n}):i.createElement(jF,{onSuccess:s,immediateRedirectPathname:e.location.pathname+e.location.search}))),i.createElement("div",{className:_3},i.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/7ne-sign-in-illustration.webp",className:T3,alt:"Benefits to signing in to Kapwing"}))),i.createElement(DJ,null))},x3="common-module_textContainer_D7NvK",k3="common-module_textHeader_W1lwT",C3="common-module_textDescription_VC-uV",A3="common-module_previewImage_7xj-G",N3="common-module_preview_v9ycp";class P3 extends r.exports.Component{render(){return i.createElement("div",null,i.createElement(rt,null,i.createElement("title",null,"Free Sound Effects for Video Editing – Kapwing"),i.createElement("meta",{name:"description",content:"Use Kapwing's trendy sound effects generator to add emphasis to a video in a few clicks. Choose from over 30 popular sound effects, from Pikachu to Pacman."}),i.createElement("meta",{name:"keywords",content:"sound effects, sound effect generator"}),i.createElement("meta",{property:"og:url",content:"https://www.kapwing.com/sound-effects"}),i.createElement("meta",{property:"og:title",content:"Trendy Sound Effects Editor - Kapwing"}),i.createElement("meta",{property:"og:description",content:"Add trendy sound effects directly to your video in just a few clicks. Choose from over 30 popular sound effects, from Pikachu to Pacman."}),i.createElement("meta",{property:"og:image",content:"https://i.imgur.com/SN2lyIK.png"}),i.createElement("meta",{property:"og:image:url",content:"https://i.imgur.com/SN2lyIK.png"}),i.createElement("meta",{property:"twitter:image",content:"https://i.imgur.com/SN2lyIK.png"}),i.createElement("link",{rel:"canonical",href:"https://www.kapwing.com/sound-effects"})),i.createElement(QQ,null),i.createElement("div",{className:x3},i.createElement("div",{className:k3},"Trendy Sound Effects Editor"),i.createElement("div",{className:C3},i.createElement("p",null,"The Trendy Sound Effects Editor was a fun project that allowed users to add, well, trendy sound effects to their videos."),i.createElement("p",null,"We created the app after watching many fun videos with funny sound effects, like a snap of fingers, or an explosion effect for extra emphasis."),i.createElement("p",null,"The sound effects editor was featured in various places online including"," ",i.createElement("a",{href:"https://www.producthunt.com/posts/trendy-sound-effect-editor/"},"Product Hunt")," ","as well as"," ",i.createElement("a",{href:"https://www.thewindowsclub.com/kapwing-meme-maker-generator"},"The Windows Club"),".")),i.createElement("div",null),i.createElement("div",{className:N3},i.createElement("img",{src:"https://i.imgur.com/VXAqJZW.png",alt:"Sound Effects Editor Home Page",className:A3})),i.createElement("div",{className:N3},i.createElement("img",{src:"https://i.imgur.com/iHjfHSa.png",alt:"Sound Effects Editor Preview",className:A3})),i.createElement("div",null),i.createElement("div",{className:C3},i.createElement("p",null,"The feature included a large variety of sounds that could be added to the video, including the Mario Power-up sound, iMessage sending, mouse clicking, and many more.")),i.createElement("div",{className:N3},i.createElement("img",{src:"https://i.imgur.com/QZR9LIc.png",alt:"Sound Effects Sounds Preview",className:A3})),i.createElement("div",{className:C3},i.createElement("p",null,"The feature was deprecated in October of 2018 due to a lack of maintainence. If you're looking to add sound to your video, you can use the ",i.createElement("a",{href:"/tools/add-audio"},"Add Sound to Video")," ","feature on ",i.createElement("a",{href:"/"},"Kapwing"),"."),i.createElement("p",null,"Thanks for visiting the Trendy Sound Effects Editor and have a nice day."))),i.createElement(DJ,null))}}const R3=[{id:"dropbox",name:"Dropbox",image:"https://i.imgur.com/z8sgVnv.png",logo:"https://i.imgur.com/YxDJLc6.png",date:"Sep 15, 2008",description:"A 24 year old Drew Houston gives the first introduction to Dropbox, in a video that responated with hackers.",youtubeLink:"https://www.youtube.com/watch?v=7QmCUDHpNzE",embedLink:"https://www.youtube.com/embed/7QmCUDHpNzE"},{id:"robinhood",name:"Robinhood",image:"https://i.imgur.com/tdMnozF.png",logo:"https://i.imgur.com/qV8t8BY.png",date:"Dec 10, 2014",description:"Watch the video that made Robinhood go viral on the internet, with the (at the time) revolutionary idea that stock trading could be free.",youtubeLink:"https://www.youtube.com/watch?v=Z_nsrcnwHQc",embedLink:"https://www.youtube.com/embed/Z_nsrcnwHQc"},{id:"uber",name:"Uber",image:"https://i.imgur.com/D9AB0t9.png",logo:"https://i.imgur.com/fiwh2Em.png",date:"May 10, 2010",description:"A demonstration of the UberCab app in 2010, when it was still focused on limousines.",youtubeLink:"https://youtu.be/k3wk4kem54k",embedLink:"https://www.youtube.com/embed/k3wk4kem54k"},{id:"google",name:"Google Street View",image:"https://i.imgur.com/XV8VL1t.png",logo:"https://i.imgur.com/0ABT4tR.png",date:"May 29, 2007",description:"Google's famous quirky-ness comes in full force in this fun introduction to Street View.",youtubeLink:"https://youtu.be/91wuBqlny50",embedLink:"https://www.youtube.com/embed/91wuBqlny50"},{id:"lyft",name:"Lyft (aka Zimride)",image:"https://i.imgur.com/QcL2jX1.png",logo:"https://i.imgur.com/WXputgn.png",date:"Sep 6, 2010",description:"Before Lyft, the founders created a ride share website for students called Zimride. Watch them walk through this product that led to much more.",youtubeLink:"https://youtu.be/ei5woMwH6vM",embedLink:"https://www.youtube.com/embed/ei5woMwH6vM"},{id:"linkedin",name:"LinkedIn",image:"https://i.imgur.com/zhea8VL.png",logo:"https://i.imgur.com/znK6zTR.png",date:"Apr 5, 2010",description:"LinkedIn wasn't super new when they put out this marketing video, but it's still interesting to watch and see how far they've come.",youtubeLink:"https://youtu.be/ZVlUwwgOfKw",embedLink:"https://www.youtube.com/embed/ZVlUwwgOfKw"},{id:"snapchat",name:"Snapchat Video",image:"https://i.imgur.com/o6IasQ7.png",logo:"https://i.imgur.com/jSPUZGJ.png",date:"Dec 13, 2012",description:"Looking at this old launch video for Snapchat video makes it seem crazy just how far the app has come.",youtubeLink:"https://youtu.be/r4237MZIb8g",embedLink:"https://www.youtube.com/embed/r4237MZIb8g"},{id:"apple",name:"Apple iPhone",image:"https://i.imgur.com/lx76CKr.png",logo:"https://i.imgur.com/s5aT8PJ.png",date:"Jan 10, 2007",description:"The original presentation by Steve Jobs that would change humanity in a real way.",youtubeLink:"https://youtu.be/ftf4riVJyqw",embedLink:"https://www.youtube.com/embed/ftf4riVJyqw"},{id:"twilio",name:"Twilio",image:"https://i.imgur.com/vPd1O46.png",logo:"https://i.imgur.com/uHkKO1v.png",date:"Mar 10, 2009",description:"Watch Evan Cooke, a co-founder of Twilio, give a basic whiteboard demonstration of their early service.",youtubeLink:"https://youtu.be/P4KaV3eiH3s",embedLink:"https://www.youtube.com/embed/P4KaV3eiH3s"},{id:"coinbase",name:"Coinbase Vault",image:"https://i.imgur.com/THA5PR9.png",logo:"https://i.imgur.com/l5M2lab.png",date:"Jul 2, 2014",description:"One of the early demos of Coinbase which set the stage for its latest success.",youtubeLink:"https://youtu.be/GX_c566xYcQ",embedLink:"https://www.youtube.com/embed/GX_c566xYcQ"},{id:"instacart",name:"Instacart",image:"https://i.imgur.com/jmLBfV2.png",logo:"https://i.imgur.com/KolJdHX.png",date:"Aug 24, 2012",description:"Apoorva Mehta gives an honest interview about his journey with Instacart during his time at Y Combinator, when no one knew about it.",meta:{title:"Evolution of Instacart – Kapwing",description:"Watch Apoorva Mehta share insight on his journey at Instacart as well as videos from other founders in the Startup demo video collection by Kapwing."},youtubeLink:"https://youtu.be/b5llwmsHXkw",embedLink:"https://www.youtube.com/embed/b5llwmsHXkw"},{id:"zenefits",name:"Zenefits",image:"https://i.imgur.com/RHknkvP.png",logo:"https://i.imgur.com/ywASlen.png",date:"Feb 10, 2013",description:"Watch a younger Parker Conrad, the founder of Zenefits, give the pitch in his application video to Y Combinator.",meta:{title:"Evolution of Zenefits – Kapwing",description:"Watch Parker Conrad, the founder of Zenefits, give his pitch in an application video. Explore more demo videos from the early days of successful startups."},youtubeLink:"https://youtu.be/-S83fysRwn4",embedLink:"https://www.youtube.com/embed/-S83fysRwn4"},{id:"docker",name:"Docker",image:"https://i.imgur.com/wtM1lus.png",logo:"https://i.imgur.com/hz8Wfd2.png",date:"May 10, 2010",description:"Docker seems like a no-brainer for developers today, but back when they first started, the idea of a container left many skeptical.",youtubeLink:"https://youtu.be/Q5POuMHxW-0",embedLink:"https://www.youtube.com/embed/Q5POuMHxW-0"},{id:"twitch",name:"Twitch (aka Justin.tv)",image:"https://i.imgur.com/zBrockk.png",logo:"https://i.imgur.com/L11W3bk.png",date:"Feb 4, 2010",description:"Before Twitch, was Justin.tv. Take a look at this authentic demo of their early live streaming technology on the web.",youtubeLink:"https://youtu.be/kfDBxa65m_A",embedLink:"https://www.youtube.com/embed/kfDBxa65m_A"}];class L3 extends r.exports.Component{constructor(e){super(e),this.state={currentVideo:void 0}}componentDidMount(){const{match:e,history:t}=this.props;if(e&&e.params&&e.params.id){const a=R3.find((t=>t.id===e.params.id));a?this.setState({currentVideo:a}):t.push("/startup-demo-videos")}else t.push("/startup-demo-videos")}renderVideo(){const{currentVideo:e}=this.state,{meta:{title:t,description:a}={}}=e,{history:o}=this.props;return i.createElement(i.Fragment,null,i.createElement(rt,null,i.createElement("title",null,t),i.createElement("meta",{name:"description",content:a}),i.createElement("link",{rel:"canonical",href:`https://www.kapwing.com/startup-demo-videos/${e.id}`})),i.createElement("div",{className:"startup-video-player-wrapper"},i.createElement("div",{className:"startup-video-player-container"},i.createElement("div",{className:"startup-video-player-back",onClick:()=>o.push("/startup-demo-videos")},"< Back to all videos"),i.createElement("div",{className:"splash-youtube-video"},i.createElement("iframe",{title:`${e.name} Video`,src:`${e.embedLink}?autoplay=1&showinfo=0&modestbranding=0`,frameBorder:"0"})),i.createElement("div",{className:"startup-video-player-metadata"},i.createElement("img",{alt:e.name,src:e.logo,className:"startup-demo-videos-logo"}),i.createElement("div",{className:"startup-demo-videos-item-name"},e.name),i.createElement("div",{className:"startup-video-player-date"},e.date),i.createElement("div",{className:"startup-demo-videos-item-description"},e.description)))))}render(){const{currentVideo:e}=this.state;return e?this.renderVideo():null}}const D3=we(L3);class O3 extends r.exports.Component{constructor(){super(...arguments),a(this,"playVideo",(e=>{const{history:t}=this.props;t.push(`/startup-demo-videos/${e.id}`)})),a(this,"renderVideoItem",(e=>i.createElement("div",{key:e.id,className:"startup-demo-videos-item-container"},i.createElement("div",{className:"startup-demo-videos-image-container",onClick:()=>this.playVideo(e)},i.createElement("img",{alt:e.name,src:e.logo,className:"startup-demo-videos-image"}),i.createElement("div",{className:"startup-demo-videos-image-play-button"},i.createElement("span",{className:"startup-demo-videos-play"},"►"),i.createElement("div",{className:"startup-demo-videos-overlay"}))),i.createElement("div",{className:"startup-demo-videos-item-metadata"},i.createElement("img",{alt:e.name,src:e.image,className:"startup-demo-videos-logo"}),i.createElement("div",{className:"startup-demo-videos-item-name"},e.name),i.createElement("div",{className:"startup-demo-videos-item-date"},e.date),i.createElement("div",{className:"startup-demo-videos-item-description"},e.description)))))}render(){return i.createElement("div",null,i.createElement("div",{className:"startup-videos-wrapper"},i.createElement(rt,null,i.createElement("title",null,"Startup Demo Videos – Kapwing"),i.createElement("meta",{name:"description",content:"Explore a collection of demo videos from the early days of successful startups such as Dropbox, LinkedIn, Robinhood, and more curated by the Kapwing team."}),i.createElement("meta",{property:"og:url",content:"https://www.kapwing.com/startup-demo-videos"}),i.createElement("meta",{property:"og:title",content:"Startup Demo Videos - Kapwing"}),i.createElement("meta",{property:"og:description",content:"A collection of demo videos from the early days of successful startups like Dropbox, LinkedIn, Robinhood, and more."}),i.createElement("meta",{property:"og:image",content:"https://i.imgur.com/nnvE6Bf.png"}),i.createElement("meta",{property:"og:image:url",content:"https://i.imgur.com/nnvE6Bf.png"}),i.createElement("meta",{property:"twitter:image",content:"https://i.imgur.com/nnvE6Bf.png"}),i.createElement("link",{rel:"canonical",href:"https://www.kapwing.com/startup-demo-videos"})),i.createElement("div",{className:"startup-demo-videos-header-container"},i.createElement("div",null,i.createElement("div",{className:"startup-demo-videos-header"},"Startup Demo Videos"," ",i.createElement("span",{role:"img","aria-label":"Lightbult Emoji"},"💡")),i.createElement("div",{className:"startup-demo-videos-description"},"A collection of demo videos from the early days of successful startups like Dropbox, LinkedIn, Robinhood, and more."),i.createElement("div",{className:"startup-demo-videos-share"},i.createElement(it,{url:"https://www.kapwing.com/startup-demo-videos",quote:"Startup Demo Videos - Kapwing",className:"startup-demo-share-button"},i.createElement(st,{size:40,round:!0})),i.createElement(lt,{url:"https://www.kapwing.com/startup-demo-videos",title:"💡 Startup Demo Videos - Kapwing",via:"kapwingapp",hashtags:["startups","videos"],className:"startup-demo-share-button"},i.createElement(dt,{size:40,round:!0}))),i.createElement("div",{className:"startup-demo-videos-text"},"Curated with love by the team at"," ",i.createElement("a",{href:"https://www.kapwing.com"},"Kapwing")))),i.createElement("div",{className:"startup-demo-videos-background"},i.createElement("div",{className:"startup-demo-videos-list-container"},R3.map((e=>this.renderVideoItem(e))),i.createElement("div",{className:"startup-demo-videos-item-container"},i.createElement("div",{className:"startup-demo-videos-image-container"},i.createElement("img",{alt:"More to come!",src:"https://i.imgur.com/uXJdIsY.png",className:"startup-demo-videos-image"})))),i.createElement("div",{className:"startup-demo-videos-list-container startup-demo-videos-footer-container"},i.createElement("div",{className:"startup-demo-videos-email-subscribe"},i.createElement("div",{className:"startup-demo-videos-subscribe-header"},"Looking for more?"),i.createElement("div",{className:"startup-demo-videos-subscribe-description"},"Sign up for our mailing list to get the latest updates:"),i.createElement(gZ,{source:"startup-demo-videos"})),i.createElement("div",{className:"startup-demo-videos-footer-text"},"We're adding new videos to the collection on a regular basis! Have a submission for a video? Contact us at"," ",i.createElement("a",{href:"mailto:hello@kapwing.com"},"hello@kapwing.com"),"!")))),i.createElement(DJ,null))}}const F3=we(O3);function M3(e){return{type:"SET_PARENT_ID",parentId:e}}function U3(e){return{type:"SET_CURRENT_TEMPLATE",currentTemplate:e}}function B3(e){return{type:"SET_TEMPLATES",templates:e}}function W3(e){return t=>hu("/api/v1/templates/getTemplate",{params:{slug:e}}).then((e=>(t(U3(e)),e)))}function V3(e){return()=>hu("/api/v1/templates/getTemplateFromId",{params:{_id:e}}).then((e=>e))}let j3=Date.now();function G3(e={},t){return a=>{j3=Date.now(),t&&(e.pattern={key:t.key,value:t.value});return hu("/api/v1/templates/getTemplates",{params:{args:JSON.stringify({...e,timeOfRequest:j3}),parseJson:!0}}).then((e=>{e.timeOfRequest===j3&&a(B3(e.templates))}))}}async function H3(e,t,a=60){const{dispatch:o}=tn(),n={body:{searchTerm:e,lastTemplateId:t,limit:a}},r=await gu("/api/v2/templates/paginated",n);r.templates.length&&o({type:"APPEND_TEMPLATES",templates:r.templates})}async function z3(e,t){const a=await Promise.all(e.map((async e=>{if("Trending Now"===e)return await hu("/api/v1/templates/getNewestNonMemeTemplates/1");const a={searchTerm:e};t&&(a.pattern={key:t.key,value:t.value});const o={params:{args:JSON.stringify(a)}};return(await hu("/api/v1/templates/getTemplates",o)).templates}))),o=new Map;return e.forEach(((e,t)=>{const n=a[t];n&&o.set(e,n)})),o}function $3(e=1){return t=>hu(`/api/v1/templates/getNewestTemplates/${e}`).then((e=>(t(B3(e)),e)))}function K3(e,t=null){return a=>hu(`/api/v1/templates/${e}/children`,{params:{lastId:t}}).then((e=>(a({type:"SET_RECENT_VIDEOS",videos:e}),e)))}function Y3(e){return t=>hu(`/api/v1/templates/${e}/examples`).then((e=>(t((()=>({type:"SET_TEMPLATE_EXAMPLE_VIDEOS",exampleVideos:e}))),e)))}function q3(e){const{currentUser:t}=tn().state,{token:a,user:o}=t||{},{_id:n}=o||{};return gu("/api/v1/templates/upsertTemplate",{body:e,params:{token:a,userId:n}})}function X3(e){const{currentUser:t}=tn().state,{token:a,user:o}=t||{},{_id:n}=o||{};return pu("/api/v1/templates/deleteTemplate",{body:e,params:{token:a,userId:n}})}function J3(e,t,a){return(o,n)=>{const{currentUser:r}=n(),{user:i}=r||{},{_id:s}=i||{};return("ADD"===e?yu:pu)(`/api/v1/templates/${t}/example`,{params:{_id:a,userId:s}}).then((t=>(o((()=>({type:"ADD"===e?"ADD_TEMPLATE_EXAMPLE":"REMOVE_TEMPLATE_EXAMPLE",example:a}))),t)))}}function Q3(e){return{type:"SET_TEMPLATE_SOURCE",source:e}}const Z3="AddRemoveExamples-module_actionButton_UlQDA",e5="AddRemoveExamples-module_container_DSqg7",t5="AddRemoveExamples-module_header_HPzwW",a5="AddRemoveExamples-module_description_V-4Xd";class o5 extends r.exports.Component{constructor(e){super(e),a(this,"fetchParentTemplate",(()=>{const{currentVideo:e,getTemplateFromId:t}=this.props;t(e.parentId).then((e=>{this.setState({parentTemplate:e,loadingParentTemplate:!1})})).catch((e=>{Iu({description:"Failed to fetch parent template",error:e}),this.setState({loadingParentTemplate:!1})}))})),a(this,"addToExamples",(()=>{const{currentVideo:e,updateTemplateExamples:t}=this.props,{parentTemplate:a}=this.state;this.setState({loadingTemplateExamples:!0}),t("ADD",a._id,e._id).then((()=>{this.fetchParentTemplate(),this.setState({loadingTemplateExamples:!1})})).catch((e=>{Iu({description:"an error occurred when updating examples",error:e}),this.setState({loadingTemplateExamples:!1})}))})),a(this,"removeFromExamples",(()=>{const{currentVideo:e,updateTemplateExamples:t}=this.props,{parentTemplate:a}=this.state;this.setState({loadingTemplateExamples:!0}),t("REMOVE",a._id,e._id).then((()=>{this.fetchParentTemplate(),this.setState({loadingTemplateExamples:!1})})).catch((e=>{Iu({description:"An error occurred when removing from examples",error:e}),this.setState({loadingTemplateExamples:!1})}))})),a(this,"currentVideoIsAlreadyExample",(()=>{const{currentVideo:e}=this.props,{parentTemplate:t}=this.state;return t&&t.examples&&t.examples.includes(e._id)})),this.state={loadingParentTemplate:!0,loadingTemplateExamples:!1,parentTemplate:{}}}componentDidMount(){const{currentVideo:e}=this.props;e&&e.parentId&&this.fetchParentTemplate()}renderExampleActions(){const{loadingTemplateExamples:e,parentTemplate:t}=this.state,a=this.currentVideoIsAlreadyExample();return e?i.createElement("div",{className:Z3},"Loading ..."):a?i.createElement("div",{className:Z3,onClick:this.removeFromExamples},"Remove from examples"):i.createElement("div",{className:Z3,onClick:this.addToExamples},"Add to examples for ",t.title)}render(){const{loadingParentTemplate:e,parentTemplate:t}=this.state;if(e||s.exports.isEmpty(t))return null;const a=this.currentVideoIsAlreadyExample();return console.info(t),i.createElement("div",{className:e5},i.createElement("div",{className:t5},"Example actions"),i.createElement("div",{className:a5},"This content is a child of template"," ",i.createElement(at,{to:`/explore/${t.slug}`},t.title?t.title:"Error: template has no title"),"."," ",i.createElement("span",null,a?"Content already added as an example.":null)),this.renderExampleActions())}}const n5=we(m.exports.connect((e=>({currentVideo:e.currentVideo,currentUser:e.currentUser})),(e=>me({getTemplateFromId:V3,updateTemplateExamples:J3},e)))(o5)),r5="VideoAdminActions-module_container_4MuJr",i5="VideoAdminActions-module_commentingContainer_XWbs5",s5="VideoAdminActions-module_header_bI4cD",l5="VideoAdminActions-module_description_S2wc7",d5="VideoAdminActions-module_actionButton_bYMFj";const c5=we(m.exports.connect((e=>({currentVideo:e.currentVideo,currentUser:e.currentUser,projectName:e.projectName})),(e=>me({setCurrentTemplate:U3},e)))((({history:e,currentVideo:t,projectName:a="",setCurrentTemplate:o,commentingView:n=!1})=>i.createElement("div",{className:n?i5:r5},i.createElement("div",{className:s5},"Admin actions"),i.createElement("div",{className:l5},"This section is visible only to admin accounts."),i.createElement("div",{className:d5,onClick:()=>{const{_id:n}=t,r={title:a,description:a,slug:(i=a,i.toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"-")),video_id:n};var i;o(r);e.push("/admin/templates/update")}},"Make template"),i.createElement("div",{className:d5,onClick:()=>{const e=`/videos/${t._id}/debug`;window.open(e)}},"Visit debug page ",i.createElement(vt,null)),i.createElement("div",{className:d5,onClick:async()=>{const{readonly:e}=t;await fu(`/api/v1/videos/${t._id}`,{body:{readonly:!e}}),window.location.reload()}},"Make video"," ",i.createElement("span",null,t.readonly?"writable":"readonly")),i.createElement(n5,null))))),u5="Tabs-module_disabled_3hlv9",m5="Tabs-module_tabContainer_sBadm",p5="Tabs-module_tabHolder_tJE-a",h5="Tabs-module_tabContent_Uom4r",g5="Tabs-module_noTopPadding_WDGcj",y5="Tabs-module_tabHolderTight_Ppsr-",f5="Tabs-module_mobileCommentsTabHolder_msAg-",E5="Tabs-module_tab_HQZWB",v5="Tabs-module_selected_ZDqaU",w5="Tabs-module_tabTight_wn7EO",b5="Tabs-module_noBottomPadding_yGGq6",_5="Tabs-module_tabHeader_qEy-m",T5="Tabs-module_mobileMultiTabHeader_wMYzG",S5="Tabs-module_mobileCommentsTabHeader_CpzwJ",I5="Tabs-module_scrollShadowBottom_g315I",x5="Tabs-module_scrollShadowTop_h0Fax",k5="Tabs-module_shadowVisible_TpuMa",C5="Tabs-module_shadowHidden_KEwuu",A5="Tabs-module_positionDefault_sYnG6",N5="Tabs-module_constrained_E4yLC",P5="Tabs-module_bottomSpacer_526LR",R5=i.createContext({scrollTop:null,setScrollTop:()=>null,offsetHeight:null,setOffsetHeight:()=>null,scrollHeight:null,setScrollHeight:()=>null,maxScrollTop:null,containerEl:null,setContainerEl:()=>null,didScrollToBottom:!1,refreshScrollHeight:()=>null}),L5=({children:e})=>{const[t,a]=r.exports.useState(null),[o,n]=r.exports.useState(null),[s,l]=r.exports.useState(null),[d,c]=r.exports.useState(null),u=(s||0)-(o||0),m=!(!t||!u)&&u-t<1,p=r.exports.useCallback((()=>{l((null==d?void 0:d.scrollHeight)||s)}),[d,s]),h=r.exports.useMemo((()=>({scrollTop:t,setScrollTop:a,offsetHeight:o,setOffsetHeight:n,scrollHeight:s,setScrollHeight:l,containerEl:d,setContainerEl:c,maxScrollTop:u,didScrollToBottom:m,refreshScrollHeight:p})),[t,a,o,n,s,l,d,c,u,m,p]);return i.createElement(R5.Provider,{value:h},e)},D5=({children:e})=>i.createElement(i.Fragment,null,e),O5=({children:e,cyPrefix:t,id:a,showOnlySelectedHeader:o=!1,tabTitles:n,disabled:s=!1,tightPadding:l=!1,mobileCommentsView:d=!1,addBottomPadding:c=!1,className:u,tabContentClassname:p=""})=>{const h=m.exports.useDispatch(),g=Si(),{selectedTabs:y}=tr((e=>({selectedTabs:e.selectedTabs})),m.exports.shallowEqual),f=(null==y?void 0:y[a])||"",E=n.findIndex((e=>e===f)),v=-1===E?0:E;r.exports.useEffect((()=>{v>=n.length&&h(VR({tabId:(null==n?void 0:n[0])||"",tabContainerId:a}))}),[n,v,a,h]);const{scrollTop:w,setScrollTop:b}=r.exports.useContext(R5),{offsetHeight:_,setOffsetHeight:T}=r.exports.useContext(R5),{scrollHeight:S,setScrollHeight:I}=r.exports.useContext(R5),{containerEl:x,setContainerEl:k}=r.exports.useContext(R5);r.exports.useEffect((()=>{if(x){const e=new wt.ResizeSensor(x,(({height:e})=>{T(e),b(x.scrollTop),I(x.scrollHeight)}));return()=>{e.detach()}}return()=>{}}),[x,T,b,I]);let C=!1,A=!1;if(null!==w&&null!==_&&null!==S){const e=3;w+_+e<S&&(A=!0),w>e&&(C=!0)}const N=[x5,C?k5:C5],P=[I5,A?k5:C5],R=[p5];g&&!d&&R.push(A5),l&&R.push(y5),d&&R.push(f5);const L="Subtitles"===n[v];return i.createElement("div",{className:`${m5} ${g?N5:""}`},i.createElement("div",{className:`${R.join(" ")} ${u}`},o?i.createElement("div",{className:`${E5} ${_5}`},n[v]):i.createElement(i.Fragment,null,n.map(((e,o)=>{const n=[E5];return o===v&&n.push(v5),s&&n.push(u5),l&&n.push(w5),g&&n.push(T5),d&&n.push(S5),i.createElement("div",{key:e,className:n.join(" "),onClick:()=>{s||h(VR({tabId:e,tabContainerId:a}))},"data-cy":`${t}-tab-${e}`},e)})))),i.createElement("div",{className:`${h5} ${d||L?g5:""} ${L?b5:""} ${p}`,onScroll:({currentTarget:e})=>{b(e.scrollTop),I(e.scrollHeight)},ref:e=>k(e)},i.Children.map(e,((e,t)=>t===v?e:null)),c?i.createElement("div",{className:P5}):null),i.createElement("div",{className:N.join(" ")}),i.createElement("div",{className:P.join(" ")}))};function F5(e){return i.createElement(L5,null,i.createElement(O5,{...e}))}const M5=(e,t,a,o)=>{var n;const r=e.startTime||0,i=(null==(n=e.animation)?void 0:n.duration)||e.endTime;let s;s=a?(a-r)/(i-r):0,function(e,t){if("background"!=t.progressBarStyle)return;e.fillStyle=t.backgroundStyleColor||0,e.fillRect(0,0,t.position.pixel_width,t.position.pixel_height)}(t,e),function(e,t){if("glowing"!=t.progressBarStyle)return;e.shadowColor=t.glowingStyleColor||0,e.shadowBlur=70}(t,e),function(e,t,a){switch(e.progressBarStyle){case"gradient":{const o=t.createLinearGradient(0,0,e.position.pixel_width*a,e.position.pixel_height);o.addColorStop(0,e.gradientStyleColor||0),o.addColorStop(1,e.background),t.fillStyle=o;break}default:t.fillStyle=e.background}}(e,t,s),t.fillRect(0,0,e.position.pixel_width*s,e.position.pixel_height),function(e,t,a,o){if(parseFloat(e)<=0)return;t.lineWidth=e,t.strokeStyle=a.stoke,t.beginPath(),t.moveTo(0,0),t.lineTo(a.position.pixel_width*o,0),t.stroke(),t.moveTo(0,0),t.lineTo(0,a.position.pixel_height),t.lineTo(a.position.pixel_width*o,a.position.pixel_height),t.stroke()}(o,t,e,s)};const U5=(e,t,a,o,n=D[0],r,i,s)=>{const l=e.getContext("webgl")||e.getContext("experimental-webgl");l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,!0);const d=l.createBuffer();l.bindBuffer(l.ARRAY_BUFFER,d),l.bufferData(l.ARRAY_BUFFER,new Float32Array([-1,-1,-1,4,4,-1]),l.STATIC_DRAW),l.viewport(0,0,e.width,e.height);const c=bt(l,t);c.minFilter=l.LINEAR,c.magFilter=l.LINEAR;const u=bt(l,a);u.minFilter=l.LINEAR,u.magFilter=l.LINEAR,_t(l,n).draw(o,c,u,r,i,s)},B5=(e,t,a,o,n,r,i,s=1)=>{e.save();let l=0;let d=a;r>1&&(d=a*r),n&&(l=t,d=a),e.globalAlpha=s||1,i&&(e.globalCompositeOperation=i);const c=e.createLinearGradient(l,0,0,d);for(let u=0;u<o.length;u+=1){const e=o[u];c.addColorStop(e.start,e.color)}e.fillStyle=c,e.fillRect(0,0,t,a),e.restore()};function W5(e,t,a){const{baseWidth:o,position:n}=a,r=parseFloat(null==n?void 0:n.width);if(null==o||isNaN(r))return e.height/(t.sceneHeight||1);return e.width*r/100/o}const V5=50,j5=50,G5=159,H5=830,z5=async(e,t=0,a=null,o=[],n=!1,r="original",i=6,s=!1,l=0,d)=>{let c,u;if(d)c=d.Image,u=d.createCanvas;else{if("undefined"==typeof Image)throw Error("CanvasInterface not set.");c=Image,u=(e,t)=>{const a=document.createElement("canvas");return a.width=e,a.height=t,a}}const m="rgba(-255,-255,-255,0)",p="string"!=typeof r;try{const n=(e,t,a,o)=>{let n;if("top"===o)n=a;else n=e.height-t-a;return n},d=t=>{const a=parseFloat(Math.min(1,Math.max(t.height,t.width)/3160)),o=G5*a,r=H5*a,i=V5*a,s=j5*a,l=t.width-r-i,d=e.alignWatermark||"bottom";return[l,n(t,o,s,d),r,o]},h=async(t,a)=>{t.save();const[o,n,r,i]=d(a),s=await N(e.watermark_img,!0,r,i);t.imageSmoothingEnabled=!0,t.drawImage(s,o,n,r,i),t.restore()},g=(e,t,a)=>{let o,n;switch(e){case"wrap":o=parseInt(.7*t,10),n=a;break;case"full":o=0,n=0;break;default:o=t,n=a}return[o,t-o,n,a-n]},y=(e,t,a,o)=>{let n;switch(a){case"center":n=.5*(e.width-t);break;case"right":n=e.width-o-t;break;default:n=o}return n},f=(e,t,a)=>"wrap"===e?t-a:0,E=(e,t,a,o)=>{let n;switch(a){case"bottom":n=t*e.height-o;break;case"middle":n=t*e.height-o/2;break;default:n=t*e.height}return n<0&&(n=0),e.height-n-o<0&&(n=e.height-o),n},v=(e,t,a,o,n,r,i,s,l,d)=>{const{backgroundStyle:c,textAlign:u,textHeight:m}=t;let p,h=m,g=n+.5*m;switch(c){case"none":p=0;break;case"wrap":p=o+2*l;break;default:p=e.width}r&&(h+=d,g+=d),i&&(h+=d);const E=y(e,o,u,s+l),v=f(c,E,l),w=p||o;return{...t,position:{adjusted_x:v,adjusted_y:n,adjusted_height:h,adjusted_width:w,pixel_height:h,pixel_width:w},text:a,textWidth:o,textX:E,textY:g}},w=(t,a,o)=>{let{text:n}=o;n=n||"";const r=parseInt((o.fontSize||"18px").toString().replace("px",""),10)*W5(a,e,o),i="default"!==o.fontStyle?o.fontStyle:null,s="default"!==o.fontWeight?o.fontWeight:null,l=`"${o.fontFamily}", Noto Sans, Apple Color Emoji, Noto Color Emoji`,d="none"===o.textShadow?null:o.textShadow;let c=parseFloat(o.lineWidth)||0;if(d&&c){const e=.004*(t.canvas.clientHeight||t.canvas.height);c=Math.max(2,e)}const u=c?d:null,m=`${i||"normal"} normal ${s||"normal"} ${r}px/1.2 ${l}`,p=1.2*r;Object.assign(o,{font:m,textHeight:p,lineWidth:c,textShadow:u}),t.font=m,t.lineWidth=c,t.textBaseline="middle",u&&(t.strokeStyle=u);const h=.06*a.width,y=r;let[f,w,b]=g(o.backgroundStyle,h,y);"full"===o.backgroundStyle&&(b=.8*r);const _=a.width-2*h,T=qx({ctx:t,lines:(n||"").match(/[^\r\n]+/g)||[],pxCap:_}),S=p*T.length+2*b;let I=E(a,o.fixedPosition,o.textVerticalAlign,S);return T.map((([e,t],n)=>{const r=v(a,o,e,t,I,0===n,n===T.length-1,f,w,b);return I+=r.position.adjusted_height,r}))},b=(e,t)=>{const{background:a,backgroundStyle:o,position:n}=t;!a||o&&!["full","wrap"].includes(o)||(e.fillStyle=a,e.fillRect(n.adjusted_x,n.adjusted_y,n.pixel_width,n.pixel_height))},_=(e,t,a)=>{const{color:o,text:n,textDirection:r}=a,{font:i,lineWidth:s,textShadow:l,textX:d,textY:c}=a;e.fillStyle=o,e.font=i,e.lineWidth=s,e.textAlign="left",e.textBaseline="middle",r&&t.setAttribute("dir",r),l&&(e.lineJoin="round",e.strokeStyle=l,e.strokeText(n,d,c)),e.fillText(n,d,c)},T=(t,a,o,n,r)=>{let i="";const s=Db(a,e.animations),l=s?Kb(a,s,r):a.filters,d=t.canvas.clientWidth||t.canvas.width,c=t.canvas.clientHeight||t.canvas.height;if(l)for(const e in l){switch(e){case"contrast":case"brightness":case"saturate":i+=`${e}(${l[e]/100})`;break;case"opacity":i+=`opacity(${l[e]}%)`;break;case"blur":void 0===l.blurPercent&&(i+=`blur(${parseFloat(l[e])/1e3*Math.max(d,c)}px)`);break;case"blurPercent":i+=`blur(${Math.min(o,n)*l[e]/100}px)`;break;case"blurBackground":i+=`blur(${Math.min(o,n)*l[e]/100}px)`;break}i+=" "}t.filter=i},S=(t,a,o,n)=>{const r=Db(o,e.animations),i=Kb(o,r,n);if(i.blur){const e=a.width+500,t=a.height+500,r=u(e,t),i=r.getContext("2d");T(i,o,a.width,a.height,n),i.drawImage(a,0,0,a.width,a.height,e/2-a.width/2,t/2-a.height/2,a.width,a.height);const s=u(a.width,a.height);s.getContext("2d").drawImage(r,e/2-a.width/2,t/2-a.height/2,a.width,a.height,0,0,a.width,a.height),a=s}else if(i.blurBackground){const e=Math.min(a.width,a.height),t=o.filters.blurBackground*e/100,r=u(a.width,a.height),i=r.getContext("2d"),[s,l]=pY({blurPixels:t,image:a,createCanvas:u});T(i,o,a.width,a.height,n),i.drawImage(s,-l,-l,s.width,s.height),a=r}else T(t,o,a.width,a.height,n);return a},I=(e,t,a)=>{const{crop_x:o,crop_y:n,crop_width:r,crop_height:i,file_width:s,file_height:l,pixel_width:d,pixel_height:c,adjusted_width:u,adjusted_height:m}=t.position;if(!t.crop&&!kI(t))return{x:o,y:n,width:r,height:i};if(!kI(t))return{x:o+t.crop.x/100*e.width,y:n+t.crop.y/100*e.height,width:r,height:i};const p=CI(t),h=II(p,a),g=xI(t.crop,h),y=s*(g.width/100),f=l*(g.height/100),E=y*d/u,v=f*c/m;return{x:g.x/100*e.width+(y-E)/2,y:g.y/100*e.height+(f-v)/2,width:E,height:v}},x=(e,t,a)=>{const o=e/255,n=t/255,r=a/255,i=Math.min(o,n,r),s=Math.max(o,n,r),l=s-i;let d;0===l?d=0:(s===o&&(d=60*(n-r)/l),s===n&&(d=60*(2+(r-o)/l)),s===r&&(d=60*(4+(o-n)/l)));return{H:d,S:0===s?0:l/s,V:s}},k=(e,t,a,o,n)=>{const{chromaKeyThreshold:r,chromaKeyHueThreshold:i,chromaKeySatThreshold:s,chromaKeyValThreshold:l,chromaKeyChannel:d}=n;if("colorKey"===d){const{H:n,S:r,V:d}=x(e,t,a),c=Math.abs(o.H-n)<i,u=Math.abs(o.S-r)<s,m=Math.abs(o.V-d)<l;return c&&u&&m}const c="green"===d?t:a,u="green"===d?[e,a]:[e,t],m=Math.max(e,t,a);if(m!==c)return!1;return m-Math.max(...u)>255-r},C=(e,t)=>{if("colorKey"===t.chromaKeyChannel&&t.chromaKeyColor===m)return e;let a;if("colorKey"===t.chromaKeyChannel&&t.chromaKeyColor){const e=parseInt(t.chromaKeyColor.slice(1,3),16),o=parseInt(t.chromaKeyColor.slice(3,5),16),n=parseInt(t.chromaKeyColor.slice(5,7),16);a=x(e,n,o)}const o=u(e.width,e.height),n=o.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),i=r.data;for(let s=0;s<i.length;s+=4)k(i[s],i[s+1],i[s+2],a,t)&&(i[s+3]=0);return n.clearRect(0,0,e.width,e.width),n.putImageData(r,0,0),e=o},A=async(e,t,a)=>{const o=u(e.width,e.height),n=o.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=Buffer.from(t.mask_base64_img.split(",")[1],"base64"),i=Tt.decode(r).data,s=n.getImageData(0,0,e.width,e.height),l=s.data,d=t.maskBitValuesToKeep[a]||[],c=[4,244,4,255];for(let u=0;u<l.length;u+=4){const e=i[u],t=i[u+1],a=i[u+2],o=i[u+3];d.some((n=>mY(n,[e,t,a,o])))||(l[u]=c[0],l[u+1]=c[1],l[u+2]=c[2],l[u+3]=c[3])}return n.clearRect(0,0,e.width,e.width),n.putImageData(s,0,0),e=o},N=async(e,t=!0,a,o)=>{if(!e)throw Error("Missing image source");const n=new c(a,o);return await new Promise(((o,r)=>{n.onload=()=>o(),t&&(n.onerror=e=>{r(e)}),n.src=e,(n.complete||!a&&n.width>0)&&o()})),n},P=(e,t,a,o)=>{var n,r,i;const s=t.split(","),l=Buffer.from(null!=(n=s[1])?n:"","base64"),d=(new DOMParser).parseFromString(l,"text/xml").documentElement,c=d.hasAttribute("width")&&!(null==(r=d.getAttribute("width"))?void 0:r.includes("100%")),u=d.hasAttribute("height")&&!(null==(i=d.getAttribute("height"))?void 0:i.includes("100%"));if(c||u)return 1;const m=e.canvas.clientHeight||e.canvas.height,p=e.canvas.clientWidth||e.canvas.width;return a/o>p/m?p/a:m/o},R=(e,t,a,o)=>{const n=t.width+1e3,r=t.height+1e3,i=u(n,r),s=i.getContext("2d"),l=a.imageShadowDist||0,d=(a.imageShadowRot||0)*Math.PI/180,c=100*l*Math.cos(d),m=100*l*Math.sin(d);return s.shadowColor=a.imageEffectColor,s.shadowBlur=50*a.imageShadowBlur,s.shadowOffsetX=c,s.shadowOffsetY=m,s.drawImage(t,o.x,o.y,o.width,o.height,50,50,a.position.pixel_width,a.position.pixel_height),e.drawImage(i,-50,-50,i.width,i.height),i},L=async(a,o,n)=>{let r;a.save(),r=await N(o.base64_img,!1);const i=Db(o,e.animations);o.chromaKey&&(r=C(r,o)),o.presetFilter&&!o.preProcessed&&(r=((e,t,a)=>{if(!t.presetFilter)return e;if("Original"===t.presetFilter.name)return e;const o=t.presetFilter,n=a(e.width,e.height),r=n.getContext("2d");if(!r)return;o.background&&B5(r,e.width,e.height,o.background,o.backgroundAngle,o.backgroundGradientEnd),r.globalCompositeOperation=o.backgroundBlendMode,r.filter=o.styles,r.save(),r.globalAlpha=o.opacity,r.drawImage(e,0,0,e.width,e.height),r.restore(),o.foreground&&B5(r,e.width,e.height,o.foreground,o.foregroundAngle,o.foregroundGradientEnd,o.foregroundBlendMode,o.foregroundOpacity);const i=a(e.width,e.height),s=i.getContext("2d");return s&&(s.drawImage(e,0,0,e.width,e.height),s.globalCompositeOperation="source-in",s.drawImage(n,0,0,e.width,e.height)),i})(r,o,u)),(o.filters||(e=>!!e&&("opacity"in e||"brightness"in e||"contrast"in e||"saturate"in e||"blurPercent"in e))(i))&&(r=S(a,r,o,n)),o.isSieveRemoveBackground&&(r=await A(r,o,t));const{xPos:s,yPos:l,width:d,height:c}=zb(o,e,n,a.canvas.clientWidth||a.canvas.width,a.canvas.clientHeight||a.canvas.height),m=s+o.position.pixel_width/2,p=l+o.position.pixel_height/2;a.translate(m,p);let h=!1,g=!1;if(o.position.flip){const{x:e,y:t}=o.position.flip,n=e?-1:1,r=t?-1:1;h=e,g=t,a.scale(n,r)}if(o.position.rotation){const{rotation:e}=o.position;let t=null;!h&&!g||h&&g||(t=360-e),a.rotate((t||e)*Math.PI/180)}a.translate(-m,-p),a.translate(s,l);const y=a.canvas.clientHeight||a.canvas.height;Lb(o,e.animations)&&await Fb(e.animations,o,a,n);let f=I(r,o,n);if("image/svg+xml"===o.mime||"image/svg+xml"===o.mime_type){const e=await P(a,o.base64_img,o.position.file_width,o.position.file_height);f={x:f.x*e,y:f.y*e,width:f.width*e,height:f.height*e}}else a.imageSmoothingEnabled=!0;const E=(o.objectFit||"cover").toLowerCase(),v=o.lineWidth?parseFloat(o.lineWidth)/100*y:o.lineWidth,w=o.stroke||"#000000";o.borderRadius&&"0%"!==o.borderRadius.relative&&(o.preProcessed||Wx(a,o,v,w)),!E||["cover","crop"].includes(E)?("dropShadow"!==o.imageEffect||o.preProcessed||o.borderRadius&&"0%"!=o.borderRadius.relative?a.drawImage(r,f.x,f.y,f.width,f.height,0,0,d,c):R(a,r,o,f),v>0&&(!o.borderRadius||"0%"===o.borderRadius.relative)&&(a.lineWidth=v,a.strokeStyle=w,a.strokeRect(-v/2,-v/2,d+v,c+v))):a.drawImage(r,0,0,d,c),a.restore()},O=(e,t,a,o)=>{e.lineCap="butt";const n=3*o,r=3*o,i=2*Math.PI,s=a.length;let l,d;l=a[s-2]-a[s-4],d=a[s-1]-a[s-3];const c=(Math.atan2(d,l)+i)%i;e.fillStyle=t.stroke,e.lineCap=t.lineCap,e.lineJoin=t.lineCap,e.save(),e.beginPath(),e.translate(a[s-2],a[s-1]),e.rotate(c),e.moveTo(0,0),"open"===t.lineArrow?(e.moveTo(-r,n/2),e.lineTo(0,0),e.lineTo(-r,-n/2)):(e.lineTo(-r,n/2),e.lineTo(-r,-n/2),e.closePath(),e.fill()),e.restore(),t.pointerAtBeginning&&(e.save(),e.translate(a[0],a[1]),l=a[2]-a[0],d=a[3]-a[1],e.rotate((Math.atan2(-d,-l)+i)%i),e.moveTo(0,0),e.lineTo(-r,n/2),e.lineTo(-r,-n/2),e.closePath(),e.restore()),e.setLineDash([]),e.stroke()},F=(e,t)=>{switch(e){case"big dash":return[4*t,2*t];case"small dash":return[2*t];case"dotted":return[0,t+t/2];default:return[]}},M=(e,t,a,o,n)=>{const r=new Path2D,i=n/2,s=("vertical"===t.lineRightAngle?n:a)-i,l=("horizontal"===t.lineRightAngle?n:o)-i,d={topLeft:[i,i,s,l],topRight:[s,i,i,l],bottomLeft:[i,l,s,i],bottomRight:[s,l,i,i]}[t.linePointStartCorner||"topLeft"],[c,u,m,p]=d,h=F(t.lineStyle||"solid",n);e.setLineDash(h),r.moveTo(c,u),r.lineTo(m,p),e.lineWidth=n,e.stroke(r),t.lineArrow&&O(e,t,d,n)},U=(e,t,a,o,n,r)=>{e.save(),e.scale(o,n);const i=new Path2D(r);e.fill(i),parseFloat(t.lineWidth)>0&&(e.lineWidth=a/o,e.stroke(i)),e.restore()},B=async(t,a,o)=>{const n=Db(a,e.animations),{xPos:r,yPos:i,width:s,height:l}=zb(a,e,o,t.canvas.clientWidth||t.canvas.width,t.canvas.clientHeight||t.canvas.height),{pixel_width:d,pixel_height:c}=a.position;if("placeholder"!==a.converted_type){let u=1,m=1;a.position.svg_width&&a.position.svg_height&&(u=s/a.position.svg_width,m=l/a.position.svg_height);const{lineWidth:p}=a,h=t.canvas.clientHeight||t.canvas.height,g=isNaN(p)?parseFloat(p)/100*h:p;t.save(),t.fillStyle=$b(a,n,o),t.strokeStyle=a.stroke,t.lineWidth=a.lineWidth,"number"==typeof a.globalAlpha&&(t.globalAlpha=a.globalAlpha),n&&n.opacity&&(t.globalAlpha=Kb(a,n,o).opacity/100);const y=r+d/2,f=i+c/2;"ellipse"===a.shapeType?t.translate(r,i):t.translate(y,f),a.position.rotation&&t.rotate(a.position.rotation*Math.PI/180),"ellipse"!==a.shapeType?(t.translate(-y,-f),t.translate(r,i)):t.translate(-d/2,-c/2),"progressBar"!==a.shapeType&&Lb(a,e.animations)&&await Fb(e.animations,a,t,o),"progressBar"===a.shapeType&&Lb(a,e.animations)?await M5(a,t,o,g):"rectangle"===a.shapeType?(Wx(t,a,g,t.strokeStyle),t.fill()):["line","arrow"].includes(a.shapeType)?(t.lineCap=a.lineCap||"square",M(t,a,s,l,g)):"ellipse"===a.shapeType?(t.translate(d/2,c/2),t.beginPath(),t.ellipse(0,0,s/2,l/2,0,0,2*Math.PI),t.save(),t.clip(),t.fill(),t.restore(),parseFloat(p)>0&&(t.lineWidth=g,t.stroke())):a.svgData?U(t,a,g,u,m,a.svgData):a.svgChildren&&a.svgChildren.forEach((({type:e,props:o})=>{if("path"===e){const{d:e}=o;U(t,a,g,u,m,e)}else if("circle"===e){const{cx:e,cy:a,r:n}=o;t.save(),t.scale(u,m),t.beginPath(),t.arc(e,a,n,0,2*Math.PI),t.closePath(),t.stroke(),t.fill(),t.restore()}}))}else{if(t.save(),a.position.rotation){const e=r+a.position.pixel_width/2,o=i+a.position.pixel_height/2;t.translate(e,o),t.rotate(a.position.rotation*Math.PI/180),t.translate(-e,-o)}t.translate(r,i);const e=new Path2D;e.rect(0,0,s,l),t.fillStyle=a.background,t.lineWidth=1,t.strokeStyle=a.borderColor||"black",t.setLineDash([10,5]),t.fill(e),t.stroke(e),t.setLineDash([])}t.restore()},W=({ctx:e,i:t,frequency:a,x:o,y:n,width:r,height:i})=>{const s=.004*r,l=o+t*(.002*r);if(l>o+r)return;let d,c;const u=i/2,m=a/255;c=-m*i*.3,d=n+i-u,e.fillRect(l,d+1,s,c),c=m*i*.3,d=n+i-u,e.fillRect(l,d-1,s,c)},V=({ctx:e,i:t,frequency:a,x:o,y:n,width:r,height:i})=>{const s=.005*r,l=o+t*(2*s);if(l>o+r)return;const d=n+i,c=-(a/255)*i*.8;e.fillRect(l,d,s,c)},j=(e,t,a)=>{e.save(),e.fillStyle=t.color;const o=e.canvas.clientHeight||e.canvas.height,n=e.canvas.clientWidth||e.canvas.width,r=parseFloat(t.position.width)/100*n,s=parseFloat(t.position.height)/100*o,l=parseFloat(t.position.x)/100*n,d=parseFloat(t.position.y)/100*o,c=parseInt(a,10),u=Math.floor(c/i),m=r,p=t.fft_data||[];let h;if("audiogramFrameData"in p)h=p.audiogramFrameData;else if(h=p[u],!h){const e=Object.values(p);h=e[e.length-1]}for(let i=0;i<m;i++){const a={ctx:e,i:i,frequency:h&&h[i]?h[i]:0,x:l,y:d,width:r,height:s};"wave"===t.waveformStyle?W(a):"bar"===t.waveformStyle&&V(a)}e.restore()},G=async(t,a,o,n,r)=>{const i=o.converted_type||o.type;let d=n/r;switch(s&&(d=l),i){case"text":await ck(t,o,d,W5(a,e,o),e.animations);break;case"placeholder":case"progressBar":case"shape":await B(t,o,d);break;case"subtitle":w(t,a,o).forEach((e=>{b(t,e),_(t,a,e)}));break;case"audio":o.isAudiogram&&await j(t,o,n);break;default:await L(t,o,d)}};let H;p?H=r:(document.body.style.margin="0px",H=document.getElementById(r),H.width=e.adjusted_width,H.height=e.adjusted_height);const z=H.getContext("2d",{alpha:!0});z.imageSmoothingEnabled=!1;const $=e.sceneBackground===m,K=["gif","image","webp"].includes(e.videoType);if(!$||e.sceneDuration&&!K?(z.fillStyle=$?"#ffffff":e.sceneBackground,z.fillRect(0,0,H.width,H.height)):z.clearRect(0,0,H.width,H.height),a){const e=await N(a);z.drawImage(e,0,0,H.width,H.height)}const Y={},q=e.animations&&e.animations.byId?Object.values(e.animations.byId).filter((e=>D.map((({name:e})=>e)).includes(e.animationName))):[];for(let a=0;a<q.length;a++){const n=q[a],r=e=>{const t=o.findIndex((t=>t.id===e));return[t,t>=0?o[t]:null]},i=([e,{animation:t,...a}])=>[e,a],{introLayerId:s,outroLayerId:l,animationName:d}=n,c=D.find((e=>e.name===d)),m=[r(l),r(s)];if(null==t||!m.some((e=>e[1])))continue;let p,h,g=-1,y=-1,f=0,E=Mb(n,e.animations);const v=m[0],w=m[1];if(null==v?void 0:v[1])if(null==w?void 0:w[1]){const[e,t]=m.map(i);e&&([y,h]=e),t&&([g,p]=t),f=Rd(p).start;E=Rd(h).end-f}else{[y,h]=i(v);f=Rd(h).end-E;const a=(t/e.maxFramerate-f)/E;if(a<0||a>1)continue}else{[g,p]=i(w),f=Rd(p).start;const a=(t/e.maxFramerate-f)/E;if(a<0||a>1)continue}const b=Math.max(y,g),_=t/e.maxFramerate,T=u(H.width,H.height),S=u(H.width,H.height),I=u(H.width,H.height),x=T.getContext("2d",{alpha:!0});x.imageSmoothingEnabled=!1;const k=I.getContext("2d",{alpha:!0});k.imageSmoothingEnabled=!1;const C=(_-f)/E;C<0||C>1||(h&&h.base64_img&&await G(x,T,h,t,e.maxFramerate),p&&p.base64_img&&await G(k,I,p,t,e.maxFramerate),U5(S,T,I,C,c,H.width,H.height,{}),Y[b]=S)}let X=!1;for(let a=0;a<o.length;a++){const n=o[a];if("audio"===n.converted_type&&!n.isAudiogram)continue;"subtitle"!==n.type&&!n.isMagicSubtitle||X||(X=!0,e.watermark&&await h(z,H));const r=e.sceneDuration||0;if(null!=t&&e.maxFramerate&&r&&!Md(n,t,{duration:r,maxFramerate:e.maxFramerate}))continue;if(s&&r>0&&!Ud(n,l,{duration:r}))continue;await G(z,H,n,t,e.maxFramerate);const i=Y[a];i&&z.drawImage(i,0,0,H.width,H.height)}e.watermark&&!X&&await h(z,H);const J=`image/${e.frameExt||"png"}`;return s?H:H.toDataURL(J,1)}catch(h){throw console.error("Failed to draw canvas",h.toString()),h}},$5=async(e,t,a="First Trim")=>{let{name:o}=e;const n=[e.startTime||0,e.endTime||e.duration];o||(o="input.mp4");const r={},i=n[1]-n[0];if(i<=0)throw new Error("Bad duration, sending to backend");r.trimsDuration=i,r.buildType="fixed memory";try{r.status="Initializing";const s=new kR,l=Date.now();await s.initialize();const d=Date.now(),c=(e=>{let t=e.replaceAll(" ","");return"mp4"!==t.split(".").pop()&&(t=`${t.split(".")[0]}.mp4`),t})(o),u=`trimmed-${y()}-${c}`;let m={},p="";const h=window.navigator.hardwareConcurrency;if("First Trim"===a&&e.ffprobeData&&e.ffprobeData.avg_frame_rate===e.ffprobeData.r_frame_rate)r.trimType="Quick Trim",p=K5(c,u,n,h);else if(e.ffprobeData&&e.ffprobeData.avg_frame_rate===e.ffprobeData.r_frame_rate||"First Trim"!==a){if(!("Slow Trim Mismatched Duration"===a&&i<=60))throw new Error("Quick trim failed and duration >1min, send to backend");r.trimType="Slow Trim after Quick Trim",p=Y5(c,u,n,h)}else r.trimType="Slow Trim Mismatched Framerate",p=Y5(c,u,n,h);if(r.command=p,m=await s.runCommandOnFile(p,t,c,u),!m)throw new Error("no output blob");r.status="Finished running command";const g=Date.now();if(r.status="Read output file",r.initTime=(d-l)/1e3,r.timeToRunCommand=(g-d)/1e3,r.newVideoDuration=await aH(m),r.durationsMatch=Math.abs(r.newVideoDuration-i)<=.5,!r.durationsMatch){if("First Trim"===a&&r.newVideoDuration<=60)return await $5(e,t,"Slow Trim Mismatched Duration");throw new Error("Slow trim failed and duration > 60, send to backend")}return r.browser=(new f.exports.UAParser).getBrowser(),r.device=(new f.exports.UAParser).getDevice().type,r.hardwareConcurrency=navigator.hardwareConcurrency,r.origVideoDuration=i,r.origVideoHeight=e.height,r.origVideoWidth=e.width,r.origVideoSize=e.size,{outputBlob:m,ffmpegData:r}}catch(YEe){throw r.error=YEe,YEe}},K5=(e,t,a,o)=>`-ss ${a[0]} -i ${e} -t ${a[1]-a[0]} -c copy -threads ${o/2} ${t}`,Y5=(e,t,a,o)=>`-ss ${a[0]} -i ${e} -t ${a[1]-a[0]} -threads ${o/2} ${t}`,q5=["addedFromMediaLibrary","asset_id","base64_img","blob_name","bucket","bucket_name","cmlFileId","content_type","converted_type","conversion_id","duration","endTime","ext","ffprobeData","gcsShortId","hasAudio","height","hidden","id","index","isMediaLibraryUpload","isSample","local_source_url","local_url","lockAspectRatio","locked","loadErrorFired","longLoadFired","loopMode","mediaLibraryID","metadataGathered","mime","mime_type","name","objectFit","optimization_id","optimization_failed","originalName","original_url","position","positionTemp","preview","projectName","removeBgPreviewUrl","requireConversion","searchQuery","size","soundUrl","source","startTime","temp_dir","thumbnailUrl","timelineRow","timestamp","track_preview","type","uploadConfirmed","uploadLocation","uploadId","uri","url","wasUploadedAnonymously","width"],X5={borderRadius:{relative:"0%"},borderRadiusTemp:null,filters:{},isAudiogram:!1,lineWidth:"0%",playbackRate:1,presetFilter:null,recordType:"",tempOverlayState:{},uploadPending:!1,uploadProgress:100,videoDelay:0,volume:1,volumeTemp:null},J5=["isTrimmed","origin","conversion_type","loopMode","loadErrorFired"],Q5={videoConvertedState:"complete"};function Z5(e,t,a,o){var n,r;let i=!1;for(const[l,d]of Object.entries(e)){if(!q5.includes(l)&&JSON.stringify(X5[l])!==JSON.stringify(d)){i=!1;break}i=!0}return i&&"video"===e.type&&((null==(n=e.mime)?void 0:n.includes("mp4"))||(null==(r=e.mime)?void 0:r.includes("quicktime")))&&!e.isTrimmed&&!e.crop&&OS(e)&&FS(e)&&U_(e)&&MS(e,t)&&function(e,t){const{width:a,height:o}=e,[n,r]=t.split(":").map((e=>parseInt(e)));return a===n&&o===r}(e,a)&&("Standard"===(s=o).exportQuality&&"AUTO"===s.exportResolution);var s}function e4(e,t){var a;const o=[...q5,...J5],n={...X5,...Q5};let r=!1;for(const[s,l]of Object.entries(e)){if(!o.includes(s)&&JSON.stringify(n[s])!==JSON.stringify(l)){r=!1;break}r=!0}const i=(null==(a=e.mime)?void 0:a.includes("mp4"))||"complete"===e.videoConvertedState;return r&&"video"===e.type&&i&&e.isTrimmed&&!e.crop&&(!e.videoDelay||0===e.videoDelay)&&OS(e)&&FS(e)&&U_(e)&&MS(e,t)}function t4(e,t){var a,o;if("videoState"===t){if(!e.studio)return!1;const{studio:t}=e;return 1===t.scenes.length&&1===t.scenes[0].layers.length&&"pastedLink"!==t.scenes[0].layers[0].source&&!(null==(a=null==e?void 0:e.audio)?void 0:a.url)}return"videoBuild"===t&&(!!e.scenes&&(1===e.scenes.length&&1===e.scenes[0].layers.length&&"pastedLink"!==e.scenes[0].layers[0].source&&!(null==(o=null==e?void 0:e.audio)?void 0:o.url)))}const a4={AUTO:0,"480p":848,"720p":1280,"1080p":1920,"4K":3840},o4={SD:"480p",HD:"720p",FHD:"1080p"},n4=e=>o4[e]||e,r4=e=>{if(!e.hasCustomOutput||(e=>{var t;return(e.duration||0)>0||!!((null==(t=e.scenes)?void 0:t.length)||[].length>1)})(e)){const t=n4(e.exportResolution);return a4[t]||a4["4K"]}const t=e.customOutputHeight||0,a=e.customOutputWidth||0;return Math.max(a,t,a4["4K"])},i4=e=>2*Math.ceil(Number(e)/2),s4=e=>Math.ceil(e),l4=(e,t,a)=>{let o=a;const n=Math.abs(e),r=Math.abs(t);if(!r||!n)return[n,r];let i=n,s=r;const l=r/n,d=n/r;n>=r?(i=Math.min(Math.max(n,0),n),s=l*i):(s=Math.min(Math.max(r,0),r),i=d*s),["1:1","9:16","16:9","5:4","4:5"].includes(a)||(o=`${i4(i)}:${i4(s)}`);const[c,u]=((e,t,a)=>{var o,n;let r=e,i=t;if("1:1"===a){const e=Math.max(r,i);return[e,e]}const s=a.split(":").map((e=>parseInt(e))),l=null!=(o=s[0])?o:1,d=null!=(n=s[1])?n:1;return r=i4(r),i=i4(i),r/i>l/d?(r=Math.ceil(r/l)*l,i=r*d/l):r/i<l/d&&(i=Math.ceil(i/d)*d,r=i*l/d),r%2==0&&i%2==0||(r+=l,i+=d),[r,i]})(i,s,o);return i=c,s=u,s=i4(s),i=i4(i),[i,s]},d4=(e,t,a)=>{if(!e)return[-1,-1];if(!(null==e?void 0:e.height)||!(null==e?void 0:e.width))return[-1,-1];let o=1,n=1;const[r,i]=((e,t)=>{const a=1280;let o=0,n=0,r=Math.abs(e.customOutputWidth||0),i=Math.abs(e.customOutputHeight||0),s=!0;for(const l of t){if(["placeholder","shape","subtitle","text","audio"].includes(l.type))continue;if(s=!1,!(null==l?void 0:l.position))return[0,0];const t=null==l?void 0:l.position;if(!t)return[0,0];for(const e of["width","height"])t[e]||(t[e]=0);const a=(null==t?void 0:t.width)||"100%",r=(null==t?void 0:t.height)||"100%",i=Number(String(r).replace("%",""))/100,d=Number(String(a).replace("%",""))/100,c=l.height||0,u=l.width||0;o=Math.max(o,c/(i||1)),n=Math.max(n,u/(d||1));const{ratio:m}=e;m&&([n,o]=l4(n,o,m))}if(0!==n&&0!==o||(o=e.height||a,n=e.width||a),e.hasCustomOutput&&r&&i)return r<i&&r<10?i=10*i/r:i<r&&i<10&&(r=10*r/i),[r,i];return s?n>o?[a,a*o/n]:[a*n/o,a]:[n,o]})(e,t);let s=r,l=i;0!==e.height&&0!==e.width||(e.width=s,e.height=l),e.height&&e.width&&(o=e.height/e.width,n=e.width/e.height);const d=((e,t)=>{const a=r4(e),o=t?a4["4K"]:a4["720p"];return a>o?o:a})(e,a),c=(e=>e.hasCustomOutput?0:100)(e);let{exportResolution:u}=e;u=n4(u);return["480p","720p","1080p","4K"].includes(u)?e.width>=e.height?(s=a4[u],l=o*s):(l=a4[u],s=n*l):e.width>=e.height?(s=Math.min(Math.max(s,c),d,a4["1080p"]),l=o*s):(l=Math.min(Math.max(l,c),d,a4["1080p"]),s=n*l),l=s4(l),s=s4(s),[s,l]},c4=e=>{for(const t of e){if(!["image","video"].includes(t.type))continue;const{width:e=0,height:a=0}=t;if(e<2e3||a<2e3)return!0}return!1};function u4(e,t){const a=t.position||cS(t),o=t.converted_type||t.type,n=t.objectFit||"";if("0%"!==a.width&&"0%"!==a.height){if(a.adjusted_x=(a.float_x||0)*e.adjusted_width/100,a.adjusted_y=(a.float_y||0)*e.adjusted_height/100,["placeholder","shape","subtitle","text"].includes(o))return a.adjusted_height=a.pixel_height,void(a.adjusted_width=a.pixel_width);["contain","fit"].includes(n)?function(e){const t=e.position||cS(e),a=t.file_height||1,o=t.file_width||1,n=t.pixel_height||1,r=t.pixel_width||1,i=o/a;if(i<r/n){t.adjusted_height=n;const e=t.adjusted_height*i;t.adjusted_width=e,t.adjusted_x=(t.adjusted_x||0)+(r-e)/2}else{t.adjusted_width=r;const{adjusted_y:e}=t,i=t.adjusted_width*a/o;t.adjusted_height=i,t.adjusted_y=(e||0)+(n-i)/2}}(t):function(e){const t=e.position||cS(e);let a=t.file_height||1,o=t.file_width||1;e.crop&&(a=a*(e.crop.height||100)/100,o=o*(e.crop.width||100)/100);const n=t.pixel_height||1,r=t.pixel_width||1,i=o/a,s=i<r/n;t.adjusted_width=s?r:n*i,t.adjusted_height=s?r*a/o:n,t.crop_width=o*r/t.adjusted_width,t.crop_height=a*n/t.adjusted_height,t.crop_x=(o-t.crop_width)/2,t.crop_y=(a-t.crop_height)/2}(t)}}function m4(e,t){const a=t.position||cS(t);for(const o of["width","height","x","y"]){const e=o;e in a&&(a[e]=a[e].toString().replace("NaN","0"))}a.float_width=parseFloat(a.width.toString().replace("%","")),a.float_height=parseFloat(a.height.toString().replace("%","")),a.float_x=parseFloat(a.x.toString().replace("%","")),a.float_y=parseFloat(a.y.toString().replace("%","")),a.pixel_width=a.float_width*e.adjusted_width*.01,a.pixel_height=a.float_height*e.adjusted_height*.01,u4(e,t)}function p4(e,t,a,o=!0){let n=t,r=e;if(!n||!r)return{outputWidth:r,outputHeight:n};const i=n/r;r<n?r=r/n*n:n=i*r;let s=a;["1:1","9:16","16:9","5:4","4:5"].includes(a)||(s=`${r}:${n}`);const l=function(e,t,a,o=!0){if("1:1"===a){const a=Math.max(e,t);return{outputWidth:a,outputHeight:a}}const[n=1,r=1]=a.split(":").map((e=>parseInt(e,10)));let i=t,s=e;return s/t>n/r?(s=Math.ceil(s/n)*n,i=s*r/n):s/t<n/r&&(i=Math.ceil(i/r)*r,s=i*n/r),s%2==0&&i%2==0||!o||(s+=n,i+=r),{outputWidth:s,outputHeight:i}}(r,n,s,o);return r=l.outputWidth,n=l.outputHeight,{outputWidth:r,outputHeight:n}}function h4(e){return"standard"===e.quality?1280:e.hasCustomOutput&&0===e.duration&&Math.max(e.customOutputWidth,e.customOutputHeight)>1920?Math.max(e.customOutputWidth,e.customOutputHeight):1920}function g4(e){return e.hasCustomOutput?0:100}async function y4(e,t=!0,a){let o=[];if("scenes"in e)for(const d of e.scenes)o=o.concat(d.layers);else o=e.layers||[];for(const d of o){const e=d.converted_type||d.type;if(["placeholder","shape","subtitle","text"].includes(e))continue;if(!d.position)continue;if(!d.base64_img)continue;if(void 0!==d.width&&void 0!==d.height){d.position.file_height=d.height,d.position.file_width=d.width;continue}const t=new Promise((e=>{const t=new Image;t.onload=()=>{d.position&&(d.position.file_height=t.height,d.position.file_width=t.width),e()},t.src=String(d.base64_img)}));await bi(5e3,t)}const[n,r]=d4(e,o,a);let i=1,s=1;e.height=e.height||0,e.width=e.width||0;const l=function(e,t=!0){let a=e.height||0,o=e.width||0,n=[];if("scenes"in e)for(const i of e.scenes)n=n.concat(i.layers);else n=e.layers||[];let r=!0;for(const i of n){const n=i.converted_type||i.type;if(["placeholder","shape","subtitle","text"].includes(n))continue;r=!1;const s=i.position||{},l=parseFloat((s.height||"100%").toString().replace("%",""))/100,d=parseFloat((s.width||"100%").toString().replace("%",""))/100;a=Math.max(a,(s.file_height||0)/(l||1)),o=Math.max(o,(s.file_width||0)/(d||1));const{ratio:c}=e;if(c){const{outputWidth:e,outputHeight:n}=p4(o,a,c,t);o=e,a=n}}if(0!==o&&0!==a||(a=e.height||0,o=e.width||0),e.hasCustomOutput)return{adjusted_width:e.customOutputWidth,adjusted_height:e.customOutputHeight};return r?o>a?{adjusted_width:1280,adjusted_height:1280*a/o}:{adjusted_width:1280*o/a,adjusted_height:1280}:{adjusted_width:o,adjusted_height:a}}(e,t);e.adjusted_width=l.adjusted_width,e.adjusted_height=l.adjusted_height,0!==e.height&&0!==e.width||(e.width=e.adjusted_width,e.height=e.adjusted_height),e.height&&e.width&&(i=e.height/e.width,s=e.width/e.height),e.width>=e.height?(e.adjusted_width=Math.min(Math.max(e.adjusted_width,g4(e)),h4(e)),e.adjusted_height=i*e.adjusted_width):(e.adjusted_height=Math.min(Math.max(e.adjusted_height,g4(e)),h4(e)),e.adjusted_width=s*e.adjusted_height),e.adjusted_width=Math.round(e.adjusted_width),e.adjusted_height=Math.round(e.adjusted_height),e.adjusted_width=n,e.adjusted_height=r;for(const d of e.scenes)d.adjusted_width=e.adjusted_width,d.adjusted_height=e.adjusted_height,d.width=e.width,d.height=e.height}function f4(e){if(e.position){const{width:t,height:a,x:o,y:n}=e.position,r={x:qT(o),y:qT(n),width:qT(t),height:qT(a)};return 100===r.width&&100===r.height&&0===r.x&&0===r.y}return!1}const E4="Static Image",v4="No Changes Video",w4="Trimmed Only Video";async function b4(e,t=!1){const a=await v(e,{mode:"no-cors"}),o=await a.blob();return a.ok?t?o:(n=o,new Promise(((e,t)=>{const a=new FileReader;a.readAsDataURL(n),a.onload=()=>{a.result?e(a.result):t(new Error("Reader result was empty"))},a.onerror=e=>t(e)}))):"FAIL";var n}const _4=async(e,t)=>{var a,o;const n=tT(e,void 0,"original"),{type:r}=e;var i,s;return n&&"image"===r?e.base64_img=await b4(n):n&&"video"===r?e.base64_img=await((e,t)=>{var a,o;const{state:n}=tn(),r=n.studioLocal.layerTempValues[e.id]||{},{removeBgPreviewUrl:i}=r,[s,l]=zS(e,0);if(!(s<=t&&t<=l))return"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";if((e.removeBg||e.blurBg)&&i)return b4(i);const d=document.createElement("video");return d.src=null!=(o=null!=(a=e.url)?a:e.local_url)?o:"",d.crossOrigin="anonymous",new Promise((a=>{d.onloadedmetadata=async()=>{try{d.pause(),d.volume=0,await bi(5e3,OK(e,d,t))}catch(o){console.info("Video doesn't auto play")}setTimeout((()=>{var t,o;const n=document.createElement("canvas"),r=n.getContext("2d");return n.width=null!=(t=e.width)?t:0,n.height=null!=(o=e.height)?o:0,r&&r.drawImage(d,0,0,n.width,n.height),d.pause(),a(n.toDataURL("image/jpeg"))}),60)},d.onerror=()=>(console.warn(`video ${d.src} failed to load`),a("FAIL"))}))})(e,t):"text"!==e.type&&"subtitle"!==e.type||e.fontFamily&&await(i=e,s=!0,bi(8e3,new Promise(((e,t)=>{lB(i,s,e,(e=>{const a="string"==typeof i?i:i.fontFamily;t(new Error(`Error loading font ${a}: ${e}`))}))})))),!e.mime&&(null==(o=null==(a=null==e?void 0:e.base64_img)?void 0:a.includes)?void 0:o.call(a,"image/svg+xml"))&&(e.mime="image/svg+xml"),null},T4=e=>{e.sourceVideo&&e.sourceVideo.base64_img&&delete e.sourceVideo.base64_img;for(const t of e.scenes)for(const e of t.layers)e&&e.base64_img&&delete e.base64_img};const S4=async(e,t=fh.None)=>{let a;try{const{state:o,dispatch:n}=tn(),{studio:r}=o,{imageType:i}=r,l=ST();a=s.exports.cloneDeep(e);const d=JD(Ps.HIGH_QUALITY);n(uw(d?"high":"standard"));const c=zC(o);if(a.animations.allIds.push(...c.animations.allIds),a.animations.byId={...a.animations.byId,...c.animations.byId},a.scenes[0].layers.push(...Object.values(c.magicSubtitlesOnExport).flat().filter((e=>e.startTime<=l&&e.endTime>l))),a.animations&&R4(o,a),r.canvasBlur){const e=MX(o);if(e.length>0){let t=e[0];e.forEach((e=>{l>=e.startTime&&l<=e.endTime&&(t=e)}));const o={...null==t?void 0:t.layer};o&&(a.scenes[0].layers=[o,...a.scenes[0].layers])}}await(async e=>{const t=ST(),a=[];for(const o of e.scenes)for(const e of o.layers)a.push(_4(e,t));return(await Promise.all(a)).some((e=>"FAIL"===e))?Promise.reject(new Error("A media layer failed to fetch!")):Promise.resolve()})(a),await y4(a,!1,d),function(e){e&&e.scenes&&e.scenes[0].layers&&e.scenes[0].layers[0]&&!e.scenes[0].layers[0].position&&(e.scenes[0].layers[0].position={x:"0%",y:"0%",width:"100%",height:"100%",file_height:e.height,file_width:e.width})}(a),function(e){for(const t of e.scenes)for(const a of t.layers)m4(e,a)}(a),a.watermark&&(a.watermark_img=await b4("https://cdn-useast1.kapwing.com/static/watermark.png"));const{alignWatermark:u,scenes:m,videoType:p,watermark:h,watermark_img:g,animations:f}=a,E=m[0];let v=nz();"webp"!==i||Rl()||(v="webp");const{adjusted_height:w,adjusted_width:b,background:_,duration:T,height:S,maxFramerate:I,width:x}=E;let{layers:k}=E;t===fh.Thumbnail&&(k=k.filter((e=>{const{start:t}=Rd(e);return 0===t}))),(e=>{for(const t of e)t.isAudiogram&&("wave"===t.waveformStyle?t.fft_data=EY:t.fft_data=fY)})(k),((e,t)=>{for(const a of e)"subtitle"===a.type&&(a.background=t.subtitle.backgroundColor,a.backgroundStyle=t.subtitle.backgroundStyle,a.color=a.color||t.subtitle.fontColor,a.fontFamily=t.subtitle.font,a.textAlign=a.textAlign||t.subtitle.textAlign,a.textVerticalAlign=t.subtitle.textVerticalAlign,a.fixedPosition=t.subtitle.fixedPosition)})(k,E);const C={videoArgs:{adjusted_height:w,adjusted_width:b,alignWatermark:u,animations:f,frameExt:v,maxFramerate:I,sceneBackground:_,sceneDuration:T,sceneHeight:S,sceneWidth:x,videoType:p,watermark_img:g,watermark:h},frame:0,finalImageDataUrl:null,currentLayers:k,lastBatch:!0,div:"canvas-scratchpad",numThreads:6,eyedropperMode:!1,studioTime:l};if(t===fh.EyedropperMode){C.eyedropperMode=!0;const e=await z5(C.videoArgs,C.frame,C.finalImageDataUrl,C.currentLayers,C.lastBatch,C.div,C.numThreads,C.eyedropperMode,C.studioTime);return T4(a),e}let A;if(t===fh.ImageExport){C.eyedropperMode=!0;const e=await z5(C.videoArgs,C.frame,C.finalImageDataUrl,C.currentLayers,C.lastBatch,C.div,C.numThreads,C.eyedropperMode,C.studioTime),t=`image/${C.videoArgs.frameExt||"png"}`;A=e.toDataURL(t,1)}else A=await z5(C.videoArgs,C.frame,C.finalImageDataUrl,C.currentLayers,C.lastBatch,C.div,C.numThreads,C.eyedropperMode,C.studioTime);T4(a);return[{id:y(),source:"local",name:`video_image.${v}`,local_url:A},A]}catch(o){console.error(o),T4(a);const{message:e}=xu(o);throw"Attempt to draw background removed video when no preview is calculated"!==e&&console.error("An error occurred when processing the client side image.",o),o}},I4=(e,t,a=!1)=>{const o=Nl()||Rl();return(!a||!Nl())&&(!(0!==t&&!a)&&(!!e.scenes&&(!(o&&e.canvasBlur&&BX())&&e.scenes.every((e=>e.layers.every((e=>(!o||null==e.filters&&!e.presetFilter)&&("image/gif"!==e.mime&&"gif"!==Hd(e.url)&&(("image/webp"!==e.mime||"static"===e.webpType)&&("pastedLink"!==e.source&&(!e.removeBg&&!e.blurBg&&("placeholder"!==e.type&&(!e.uploadPending||(console.error("Layer still uploading:",e),!1))))))))))))))};const x4=async(e,t,a,o=!1,n)=>{const{dispatch:r}=tn();let{studio:i}=t;await U4(i._id,{done:!1}),!i&&t.scenes&&(i=t);const s=function(e,t,a=!1,o="videoState"){let{studio:n}=e;!n&&e.scenes&&(n=e);let r="";if(I4(n,t,a))r=E4;else if(t4(e,o)){const e=n.scenes[0].layers[0],t=n.width/n.height;Z5(e,t,n.ratio,{exportQuality:n.exportQuality,exportResolution:n.exportResolution})&&(r=v4),e4(e,t)&&(r=w4)}return r}(t,a,o,n);let l,d,c,u=!0;switch(s){case E4:try{i.watermark=a$(i.duration);const[e,t]=o?await S4(i,fh.ImageExport):await S4(i),a=JO(e,t);l=a,d=URL.createObjectURL(l),r(sw(Ei.IMAGE))}catch(m){console.debug("Can't process image on client, send to server"),u=!1}break;case v4:case w4:try{const e=i.scenes[0].layers[0],t=await(async(e,t,a)=>{const{dispatch:o,history:n,state:r}=tn(),{currentUser:i}=r;let s=a,l={},d={};switch(e){case v4:try{l=(await QO(t)).file}catch(YEe){throw console.debug("Can't process no changes video on client, send to server"),s&&await U4(s,{progressText:"Client side video error, sending job to server..."}),YEe}break;case w4:try{let e=3e3;if(!s){const t=await o(D4({currentUser:i,publish:!1,auto:!1,createLocation:"trim-save"}));s=t._id,e=100}const a={submittedAt:new Date};await U4(s,a),o(dR(a)),setTimeout((()=>{null==n||n.push(`/videos/${s}`)}),e);const r=await QO(t),c=await $5(t,r.file);c.outputBlob.id=y(),c.outputBlob.local_url=window.URL.createObjectURL(c.outputBlob),l=c.outputBlob,d=c.ffmpegData}catch(YEe){throw console.debug("Can't trim video on client, send to server"),s&&await U4(s,{clientSideProcessingInProgress:!1,progressText:"Client side trim error, sending job to server..."}),YEe}}return{files:l,ffmpegData:d}})(s,e,i._id);l=t.files,d=t.files.local_url,c=t.ffmpegData,r(sw(Ei.MP4))}catch(m){console.error(m),u=!1}break;default:u=!1}if(u&&l&&!window.Cypress){const t=sc(e)&&e.user.defaultPrivacy===ii.private,a=y(),o=await qH(l,{uploadId:a});return new Promise((e=>{const a=new _E({analyticsUploadSource:"Client Side Processing",file:l,isPrivate:t,onFinish:async(t,a,o)=>{const n=await((e,t,a,o)=>{const{dispatch:n,state:r}=tn(),{studio:i}=r,s=t||i._id,l={clientSideProcessingInProgress:!1,pendingProcessOnClient:!1};if(!e)return n(dR(l)),s&&U4(s,l),null;const d=e.match(/\.([0-9a-z]+)(?:[?#]|$)/i),c=d?d[1]:"";n({type:"SET_FULL_PATH",fullPath:e});const u={...i.build,outputExt:c,outputByteSize:o.size,success:!0},m={fullPath:e,progressText:"Processed on client",url:e,build:u,...l};if(a===E4&&(m.image_url=e,n(F4(e))),n(dR(m)),s&&U4(s,m),i._id)return i$({...t$(r,!1),fullPath:e,build:u},!0);return null})(a,i._id,s,o);return e({files:l,processed:u,newUrl:d,ffmpegData:c,read_uri:a,buildInfo:n.content.build})},origin:"client side processing",uploadSourceComponent:"client-side-processing",layer:o});a.upload()}))}return{files:l,processed:u,newUrl:d,ffmpegData:c}};function k4(e,t,a){var o,n,r;if(!["mp4","mp4_convert"].includes(e.videoType))return;const i=(null!=(o=e.width)?o:0)/(null!=(n=e.height)?n:1);if(t4(e,"videoBuild")){const o=null==(r=e.scenes[0])?void 0:r.layers[0],{videoType:n}=e;o&&Z5(o,i,e.ratio,{exportQuality:e.exportQuality,exportResolution:e.exportResolution})&&(t["Client Side Processable"]={...t["Client Side Processable"],"No Changes":!0,"Processed on client":a}),o&&e4(o,i)&&(t["Client Side Processable"]={...t["Client Side Processable"],"Trim only":!0,"Processed on client":a}),o&&function(e,t,a){var o;return"mp4"===a&&"video"===e.type&&(null==(o=e.mime)?void 0:o.includes("mp4"))&&e.duration&&e.duration<=15&&OS(e)&&FS(e)&&U_(e)&&(e.crop||!MS(e,t))}(o,i,n)&&(t["Client Side Processable"]={...t["Client Side Processable"],"Short Duration Cropped or Resized Video":!0})}1===e.scenes.length&&(function(e){var t;let a=!0;return((null==(t=e.scenes[0])?void 0:t.layers)||[]).forEach((e=>{!["video","audio"].includes(e.type)&&"progressBar"!==e.shapeType&&OS(e)&&FS(e)&&U_(e)&&!e.isTrimmed||(a=!1)})),e.duration>0&&a}(e)&&(t["Client Side Processable"]={...t["Client Side Processable"],"Static Image Video":!0}),function(e){var t,a;if(2!==(null==(t=e.scenes[0])?void 0:t.layers.length))return!1;let o=!1,n=!1;return null==(a=e.scenes[0])||a.layers.forEach((t=>{var a,r;Z5(t,(null!=(a=e.width)?a:0)/(null!=(r=e.height)?r:1),e.ratio,{exportQuality:e.exportQuality,exportResolution:e.exportResolution})&&(o=!0),"audio"!==t.type||t.isTrimmed||t.isAudiogram||(n=!0)})),o&&n}(e)&&(t["Client Side Processable"]={...t["Client Side Processable"],"No Changes Video + Audio":!0}),function(e){var t,a;if(2!==(null==(t=e.scenes[0])?void 0:t.layers.length))return!1;let o=!1,n=!1;const r=(e.width||0)/(e.height||1);return null==(a=e.scenes[0])||a.layers.forEach((e=>{e4(e,r)&&(o=!0),"audio"!==e.type||e.isTrimmed||e.isAudiogram||(n=!0)})),o&&n}(e)&&(t["Client Side Processable"]={...t["Client Side Processable"],"Trimmed Video + Audio":!0}))}function C4(e,t={},a=!1){try{!async function(e,t={},a=!1){var o,n,r;const{state:i}=tn(),s=!1,l={};e._id&&(l["Video ID"]=e._id,l["Link to Video"]=`kapwing.com/videos/${e._id}`);"studio-publish-dropdown"===e.createLocation&&(l["Exported With Dropdown"]=!0);e.isStopMotionVideo?l.Editor="Stop Motion Maker":e.isLooped?l.Editor="Loop Video":e.isCreator||e.isStudio?l.Editor="Studio":e.isReversed?l.Editor="Reverse Video":e.isTrimmedOnly?l.Editor="Trim Video":e.isMuted?l.Editor="Mute Video":e.isImageVideo?l.Editor="Image to Video":e.isCartoonify?l.Editor="Cartoonify":e.isRotate?l.Editor="Rotate Video":e.isSpeedVideo?l.Editor="Video Speed Changer":e.isConvertVideo&&(l.Editor="Convert Video");const{origin:d}=e;d&&(l["Landing Page"]=d);const{templateSource:c}=i;c&&(l["Template Source"]=c);Dl()&&(l["Used PWA"]=!0);e.duration&&(l.Duration=e.duration);(e.isCreator||e.isStudio)&&function(e,t,a,o,n){var r,i,s,l,d;const c=e.scenes[0];if(0===e.duration||e.exportFrameTime>=0?n["Export Type"]="jpg":n["Export Type"]=e.videoType,e.exportQuality&&(n.exportQuality=e.exportQuality),e.exportResolution&&(n.exportResolution=e.exportResolution),"usedUndo"in t&&t.usedUndo&&(n["Used Undo"]=!0),t.usedEyedropper&&(n["Used Eyedropper"]=!0),Cc(n,t,a),t.analytics){const{analytics:e}=t;e.usedGapInsert&&(n["Used Drag Into Split/Small Gap"]=!0),e.usedRippleDelete&&(n["Used Ripple Delete"]=!0),e.usedRippleMode&&(n["Used Ripple Mode"]=!0),e.usedPasteModifications&&(n["Used Paste Modifications"]=!0),e.usedCanvasBlur&&(n["Used Canvas Blur"]=!0),e.usedSafezone&&(n["Used Safezone"]=!0),e.usedTimeline&&(n["Used Timeline V2"]=!0),e.usedCrop&&(n["Used Crop"]=!0),e.usedImageErase&&(n["Used Image Erase"]=!0),e.usedExactInput&&(n["Used Exact Input"]=!0),e.waveformCreationFailure&&(n["Waveform Creation Failure"]=!0),e.renameLayer&&(n["User Renamed Layer"]=!0),e.usedClassicTranscribe&&(n["Used Classic Transcribe"]=!0,n["Used Classic Autogenerate"]=!0),e.usedClassicTranslate&&(n["Used Classic Translate"]=!0,n["Used Classic Autogenerate"]=!0),e.usedUploadSRT&&(n["Used Upload SRT"]=!0),e.usedGenerateVideo&&(n["Used Generate Video"]=!0),e.usedGenerateImage&&(n["Used Generate Image"]=!0),e.usedGenerateMeme&&(n["Used Generate Meme"]=!0),e.usedGenerateVideoFromDocument&&(n["Used Document to Video Generator"]=!0)}"translate"in t&&!t.isTranscribed&&(n["Used Translate"]=!0),n["Number of Layers"]=Object.entries(e.allLayers.byId).length,n["Max Number of Rows Across Scenes"]=0,k4(e,n,o);const u=Object.keys({}).length;n["Number of Tracks Used"]=u,n["Strict Video Recorded Layers"]=0,n["Strict Audio Recorded Layers"]=0,n["Screen Recorded Layers"]=0,n["Video Recorded During Screen Record Layers"]=0,n["Audio Recorded During Screen Record Layers"]=0,n["Number of Subtitle Layers"]=0,n["Total Uploaded File Size (MB)"]=0;const m=new Set,p=new Set,h=new Set,g=(e,t)=>{n[e]?n[e].push(t):n[e]=[t]},y={};a.magicSubtitlePresets.presets.forEach((e=>{y[e.presetId]=e}));const f={};a.magicSubtitlePresets.brandkitPresets.forEach((e=>{f[e.presetId]=e}));const E={};a.textPresets.presets.forEach((e=>{E[e.presetId]=e}));const v={};a.textPresets.brandkitPresets.forEach((e=>{v[e.presetId]=e}));const w={};a.textTemplates.templates.forEach((e=>{w[e.templateId]=e}));const b={};a.textTemplates.brandkitTemplates.forEach((e=>{b[e.templateId]=e}));const _=new Set;let T=!1;for(const x of Object.values(e.allLayers.byId)){if("subtitle"===x.type&&("fontStyle"in x&&x.fontStyle!==c.subtitle.fontStyle||"textColor"in x&&x.textColor!==c.subtitle.fontColor||"fontSizeRatio"in x&&x.fontSizeRatio!==c.subtitle.fontSizeRatio||"fontWeight"in x&&x.fontWeight!==c.subtitle.fontWeight||"textAlign"in x&&x.textAlign!==c.subtitle.textAlign)&&(n["Has Individual Subtitle Style"]=!0),x.volume&&x.volume>0&&x.volume<1&&(n["Uses Layer Volume Adjust"]=!0),"number"==typeof x.timelineRow&&(c.id,x.timelineRow,n["Max Number of Rows Across Scenes"]=Math.max(x.timelineRow+1,n["Max Number of Rows Across Scenes"])),"video"===x.type&&x.videoDelay&&(n["Uses Video Delay"]=!0),x.type===ln.Shape&&(n["Has Shape"]=!0),"progressBar"===x.shapeType&&(n["Has Progress Bar"]=!0),"subtitle"===x.type&&(n["Has Subtitles"]=!0,n["Number of Subtitle Layers"]+=1),x.type===ln.Text)if(n["Has Text"]=!0,"wrap"===x.wrapOrFill?n["Used Text Background"]="wrap":"fill"===x.wrapOrFill||x.backgroundColor?n["Used Text Background"]="fill":n["Used Text Background"]="none",x.textShadow&&x.textShadow!==lp?n["Used Text Outline"]=x.textShadow:n["Used Text Outline"]="none",x.fromTextDefaults){const e=x.fromTextDefaults;if(!_.has(e)){_.add(e);const t=w[e],o=b[e],n=t||o;if(n){const e=!!o,r=$p(n),i=n.projectId!==a.studio.projectId;g("Reused Text Custom Template",!r&&i),g("Used Text Custom Template",!r&&!i),g("Used Text Brandkit Template",e),g("Used Text Brandkit Template From Another User",e&&!t),g("Used Text Default Template",r),r&&g("Text Default Template ID",n.templateId)}}}else{const e=_G(x),t=E[e.presetId],o=v[e.presetId],n=t||o,r=!!o,i=!!n&&Ap(n),s=(null==n?void 0:n.projectId)!==a.studio.projectId;g("Reused Text Custom Preset",!i&&s),g("Used Text Custom Preset",!i&&!s),g("Used Text Brandkit Preset",r),g("Used Text Brandkit Preset From Another User",r&&!t),g("Used Text Default Preset",i),i&&g("Text Default Preset ID",n.presetId)}"image"===x.type&&("dropShadow"===x.imageEffect&&(n["Has Image Drop Shadow"]=!0),"image/webp"===x.mime&&(n["Has Webp File"]=!0),x.isFreezeFrameLayer&&(n["Has Freeze Frame"]=!0)),x.pluginSource&&(n["Has Layer From Plugin"]=!0);const e=w_(x);e&&"none"!==e.id&&(n["Has Animation"]=!0,"image"===x.type&&(n["Has Image Animation"]=!0),"text"===x.type&&(n["Has Text Animation"]=!0),"video"===x.type&&(n["Has Video Animation"]=!0)),void 0!==b_(x).find((e=>"outro"===e.type))&&(n["Has Outro Animation"]=!0),kI(x)&&(n["Has Moving Zoom"]=!0);const{introTransition:t,outroTransition:o}=T_(x);if((t&&"none"!==t.id||o&&"none"!==o.id)&&(n["Has Transition"]=!0),(null==t?void 0:t.transitionId)&&Zb(null==t?void 0:t.transitionId)&&h.add(null==t?void 0:t.transitionId),(null==o?void 0:o.transitionId)&&Zb(null==o?void 0:o.transitionId)&&h.add(null==o?void 0:o.transitionId),"text"===x.type&&x.textEffect&&(n["Uses Text Effect"]=!0,"dropShadow"===x.textEffect&&(n["Uses Drop Shadow"]=!0),"textBlur"===x.textEffect&&(n["Uses Text Blur"]=!0)),(null==(r=x.draftJSTextTree)?void 0:r.blocks.length)&&!n["Uses Inline Styling"]){const{blocks:e}=x.draftJSTextTree,t=new Set(null==(i=e[0])?void 0:i.inlineStyleRanges.map((e=>e.style)));n["Uses Inline Styling"]=e.some((e=>e.inlineStyleRanges.some((a=>!t.has(a.style)||0!==a.offset||a.length!==e.text.length))))}"library"in x&&"emoji"===x.library&&(n["Has Emoji"]=!0),x.hasCustomFont&&(n["Has Custom Font"]=!0),"video"!==x.type&&"image"!==x.type||!("lineWidth"in x)||0===x.lineWidth||(n["Uses Image/Video Border"]=!0),x.isAudiogram&&(n["Has Audiogram"]=!0),x.removeBg&&(n["Uses Video Remove Background"]=!0),x.blurBg&&(n["Uses Video Blurred Background"]=!0),x.chromaKey&&(n["Uses Chroma Key"]=!0),x.isReversed&&(n["Uses Reverse Effect"]=!0),x.presetFilter&&x.presetFilter.name&&"Original"!==x.presetFilter.name&&(n["Uses Preset Filter"]=!0),"video"===x.recordType&&(n["Strict Video Recorded Layers"]+=1),"audio"===x.recordType&&(n["Strict Audio Recorded Layers"]+=1),"screen"===x.recordType&&(n["Screen Recorded Layers"]+=1),"screen-video"===x.recordType&&(n["Video Recorded During Screen Record Layers"]+=1),"screen-audio"===x.recordType&&(n["Audio Recorded During Screen Record Layers"]+=1),x.preemptiveDownloadError&&(n["Preemptive Download Error Detected"]=!0),x.addedFromMediaLibrary&&(n["Uses Media Library"]=!0),x.locked&&(n["Has a Locked Layer"]=!0),"rectangle"===x.shapeType&&x.borderRadius&&"0"!==x.borderRadius.relative&&(n["Has Rounded Rectangles"]=!0),x.isZoomed&&(n["Uses Zoom"]=!0),x.detachedAudioId&&(n["Detached Video"]=!0),x.audioEffect&&"fade"===x.audioEffect&&("audio"===x.type&&(n["Used Audio Fade"]=!0),"video"===x.type&&(n["Used Audio Fade for Video Layer"]=!0)),x.volume&&x.volume>1&&(n["Set Volume > 100%"]=!0),"number"==typeof x.size&&(n["Total Uploaded File Size (MB)"]+=x.size/1e6),!T&&a.teams.activeBrandkit&&((null==(s=a.teams.activeBrandkit)?void 0:s.cmlIds)&&x.cmlFileId&&a.teams.activeBrandkit.cmlIds.includes(x.cmlFileId)||x.color&&a.teams.activeBrandkit.colors.includes({value:x.color,default:!1})||x.backgroundColor&&a.teams.activeBrandkit.colors.includes({value:x.backgroundColor,default:!1})||x.fontFamily&&a.teams.activeBrandkit.fonts.some((e=>e.fontFamily===x.fontFamily))||x.fontColor&&a.teams.activeBrandkit.colors.includes({value:x.fontColor,default:!1}))&&(n["Used Brandkit Asset"]=!0,T=!0),x.hasAudio&&(m.add(x.asset_id),p.add(x.id))}if(n["Audible Assets"]=m.size,n["Audible Layers"]=p.size,n["GLTransitions Used"]=[...h],e.ratio&&(n.Ratio=e.ratio),e.audio&&e.audio.url&&(n["Has Audio"]=!0),n["Scene Count"]=1,e.scenes&&e.scenes.length>1&&(n["Scene Count"]=e.scenes.length),e.scenes){const t=e.scenes.map((e=>e.layers.filter((e=>"video"===e.type)).length)),a=Math.max(...t);n["Max Video Layers in Single Scene"]=a}if(e.groups&&Object.values(e.groups).filter((e=>e.saved)).length>0&&(n["Has a Group"]=!0),e.contextMenuUsed&&(n["Opened Context Menu"]=e.contextMenuUsed),null===e.duration&&(n["Null Duration"]=!0),void 0===e.duration&&(n["Undefined Duration"]=!0),(null==(l=a.projectSessionSettings.trimWithTranscriptAnalytics)?void 0:l.secondsRemoved)&&(n["Trim With Transcript - Seconds Removed"]=Math.ceil(a.projectSessionSettings.trimWithTranscriptAnalytics.secondsRemoved)),Object.values(t.magicSubtitles||{}).some((e=>null==e?void 0:e.enabled))){const e=Object.entries(t.magicSubtitles||{}).filter((([e,t])=>null==t?void 0:t.enabled)).map((([e])=>e)),o=new Set,r=new Set;for(const t of e){const e=mC(t)(a),n=e.transitionId||dn.None,{wordByWordAnimations:i}=e;if(i&&i.animationId!==dn.None&&i.animationName!==dn.None){const{animationId:e,animationName:t}=i,a=`${e}:${t}`;o.add(a)}n!==dn.None&&r.add(n)}const i=[...r],s=[...o];i.length&&(n["Magic Subtitle Transitions"]=i.join(" ")),s.length&&(n["Magic Subtitle Animations"]=s.join(" "));for(const l of e){const e=null==(d=t.magicSubtitles)?void 0:d[l];if(!e)continue;e.transcriptionSource&&"transcription"!==e.transcriptionSource||(n["Used Magic Autogenerate"]=!0),e.translatedLanguageCode&&(n["Used Magic Translate"]=!0);const o=wC(l)(a),r=!!(null==o?void 0:o.some((e=>e&&e.words.some((e=>e.styles&&Object.keys(e.styles).length>1)))));n["Used Magic Subtitles Inline Styling"]=r;const i=GD();if(i){const e=y[i.presetId],t=!!f[i.presetId],o=km(i),n=i.projectId!==a.studio.projectId;g("Used Magic Subtitles Custom Preset",!o&&!n),g("Reused Magic Subtitles Custom Preset",!o&&n),g("Used Magic Subtitles Brandkit Preset",t),g("Used Magic Subtitles Brandkit Preset From Another User",t&&!e),g("Used Magic Subtitles Default Preset",o),o&&g("Magic Subtitles Default Preset ID",i.presetId)}}}let S=!1;if(t.keyframing){let e=0,a=0;Object.values(t.keyframing).forEach((t=>{let o=!1;Object.entries(t).forEach((([t,a])=>{const{keyframes:r}=a;if(!r.length)return;const i=`Total ${t} Keyframes`;e+=r.length,o=!0,n[i]||(n[i]=0),n[i]+=r.length})),o&&(a+=1)})),e&&(S=!0,n["Total Keyframe Count"]=e,n["Total Keyframed Layer Count"]=a)}n["Has Keyframes"]=S;const I=FT.getMetrics();I&&Object.assign(n,I)}(e,t,i,a,l);l["Trim And Drag Onboarding Overlay Active"]=s;const{interval:u,status:m}=await of(),p=nd(),h=ld();l["Team ID"]=p?p._id:"None",l["Current Plan"]=h.name,l["Monthly/Annual"]=u,l["Subscription Status"]=m,l["Number of Workspace Members"]=p?null==(o=null==p?void 0:p.users)?void 0:o.length:0,l["Is Team Member"]=Yd(null!=(n=e.teamId)?n:""),l["Is Project Owner"]=Kd(null!=(r=e.creatorId)?r:""),vc("Create Video",l),an("Create Video")}(e,t,a)}catch(YEe){console.error(YEe),b(YEe)}}async function A4({callToAction:e,template:t,originOverride:a}){var o;const{state:n}=tn(),{currentUser:r,templateSource:i}=n,s=a||n.studio.origin,l={"Call to Action":e};if(l["Landing Page"]=s,!(null==l?void 0:l["Landing Page"]))switch(e){case gc.GetStarted:l["Landing Page"]="Home Page",l["Landing Page URL"]="https://www.kapwing.com/";break;case gc.NewContentWorkspace:l["Landing Page"]="Workspace",l["Landing Page URL"]="https://www.kapwing.com/folder";break;case gc.EditThisTemplate:l["Landing Page"]=(null==t?void 0:t.title)||"Unknown",l["Landing Page URL"]=`https://www.kapwing.com/explore/${null==t?void 0:t.slug}`;break;default:l["Landing Page"]="undefined",l["Landing Page URL"]="undefined"}i&&(l["Template Source"]=i),r&&r.user&&(l["Project Owner Email"]=r.user.email),l["Trim And Drag Onboarding Overlay Active"]=!1;const{interval:d,status:c}=await of(),u=nd(),m=ld();l["Team ID"]=u?u._id:"None",l["Current Plan"]=m.name,l["Monthly/Annual"]=d,l["Subscription Status"]=c,l["Quantity Legacy Members"]=0,l["Number of Workspace Members"]=(null==(o=null==u?void 0:u.users)?void 0:o.length)||0,vc("Started Editing",l),an("Started Editing")}async function N4(e,t){const{interval:a,status:o}=await of(),n=nd(),r=ld();vc("Download File",{"Is Signed In":e,"Team ID":n?n._id:"None","Current Plan":r.name,"Monthly/Annual":a,"Subscription Status":o,"Quantity Legacy Members":0,"Number of Workspace Members":n?n.users.length:0,"Entry Point":t})}function P4(){vc("Clicked Sign In to Export")}const R4=(e,t)=>{const a=t.scenes.reduce(((e,{layers:t})=>(t.forEach((t=>{e[t.id]=t})),e)),{}),o=t.animations.byId;Object.entries(e.studio.keyframing||{}).forEach((([e,n])=>{var r,i,s;const l=a[e];if(!l)return;const d=null==(r=t.backgroundLayers)?void 0:r.find((({originalLayerId:e})=>e===l.id));if(null==(i=l.animation)?void 0:i.constant)for(const t of l.animation.constant){const e=o[t];if(e.keyframeChannels)return d&&(d.animation={constant:[t]}),void(e.keyframeChannels=n)}const c={animationName:"Keyframes",id:y(),speed:"default",isCrossTransition:!1,layerId:e,keyframeChannels:n};t.animations.byId[c.id]=c,t.animations.allIds.push(c.id);const u=(null==(s=l.animation)?void 0:s.constant)||[],m={...l.animation,constant:[...u,c.id]};l.animation=m,d&&(d.animation={constant:[c.id]}),t.allLayers.byId[l.id].animation=m}))};function L4(e,t,a){let o,n=!1;e.isStopMotionVideo?o=function(e,t){const a=sc(e.currentUser)?e.currentUser.user._id:void 0;if(e.duration/e.stopMotionClipRate*e.stopMotionSpeed>60)throw new Error("Your final video cannot be longer than 1 min. Please trim the video or adjust the clip rate and speed.");const o=""===e.projectName?"Stop Motion Project":e.projectName;return e.projectName=o,{isStopMotionVideo:!0,stopMotionClipRate:e.stopMotionClipRate,stopMotionSpeed:e.stopMotionSpeed,reverseStopMotion:e.reverseStopMotion,...qz(e),watermark:t,startTime:e.startTime,endTime:e.endTime,withCustomWatermark:e.withCustomWatermark,watermarkPos:e.watermarkPos,watermarkText:e.watermarkText,watermarkFont:a0(e.watermarkFont),watermarkColor:e.watermarkColor,watermarkImg:e.watermarkImg,watermarkMedium:e.watermarkMedium,creatorId:a}}(e,a):e.isLooped?o=function(e,t){if((e.endTime-e.startTime)*e.numLoops>7200)throw new Error("The output video must be less than 2 hour long. Choose a fewer number of loops.");const a=sc(e.currentUser)?e.currentUser.user._id:void 0,o=""===e.projectName?"Looped Video Project":e.projectName;return e.projectName=o,{isLooped:!0,numLoops:e.numLoops,...qz(e),watermark:t,withCustomWatermark:e.withCustomWatermark,watermarkPos:e.watermarkPos,watermarkText:e.watermarkText,watermarkFont:a0(e.watermarkFont),watermarkColor:e.watermarkColor,watermarkImg:e.watermarkImg,watermarkMedium:e.watermarkMedium,startTime:e.startTime,endTime:e.endTime,creatorId:a}}(e,a):(o=t$(e,t),n=!0);const r=MX(e);return r.length>0&&(o.backgroundLayers=r.map((e=>e.layer))),[o,n]}function D4({currentUser:e,publish:t=!0,auto:a=!1,createLocation:o="NA",processedOnClient:n=!1}){return async(r,i)=>{const{token:s,user:l}=e||{},{_id:d}=l||{},c=!sc(e),u=i(),{selectedTeamId:m}=u.teams,{isBrandKitTemplate:h}=u.studio;if(!a&&AF(u)){const e=new Error("Your content is still uploading. Please try again in a few seconds.");return e.statusCode=425,function(e){if(!e.isStudio)return;const{studio:{_id:t,scenes:a=[]},uploadStatuses:o={}}=e;try{let e,n,r,i,s=!1,l=!1,d=0,c=!1,u=Number.MAX_SAFE_INTEGER;for(const t of a)for(const a of t.layers){const t=IF(a);if(!t)continue;d+=1;const m=a.uploadId?o[a.uploadId]:null;if(m){const{progress:o=0,stage:d,stageStarted:c}=m;o<1&&(s=!0),o>=99&&(l=!0),d<u&&(u=d,e=t,n=a.mime,r=a.url?eF(a.url):null,i=performance.now()-c>1e4)}a.addedFromMediaLibrary&&(c=!0)}const m={"Stuck at 0%":s,"Stuck at 99%":l,"Num Pending Uploads":d,"Added from Media Library":c,Stage:lh[u]||"missing","Stuck at Stage":i,"Still Uploading Reason":e,Mimetype:n,Extension:r};t&&(m["Video ID"]=t,m["Link to Video"]=`kapwing.com/videos/${t}`),vc("Export Blocked by Remaining Upload",m)}catch(YEe){console.error(YEe),b(YEe)}}(u),Promise.reject(e)}const[g,y]=L4(u,t,c);g.createLocation=o,g.workspaceId=(u.workspaces||{}).selectedWorkspace,g.teamId=m;const f=rd(m),E=Gs((null==f?void 0:f.planTier)||vs.Free);if(g.creatorHasLicense=E.isPaid,g.keyframing=u.studio.keyframing||{},g.animations){const{animations:e,magicSubtitlesOnExport:t}=zC(u);g.animations.allIds.push(...e.allIds),g.animations.byId={...g.animations.byId,...e.byId},g.magicSubtitlesOnExport=t,R4(u,g),(e=>{try{if(!e.scenes||!e.animations)return;const t=[];let a=e.scenes.map((({layers:e})=>e)).flat().map((({id:e})=>e));const o=Object.values(e.magicSubtitlesOnExport||{}).map((e=>{var t;return null==(t=e[0])?void 0:t.id})).filter((e=>!!e));a=a.concat(o);for(const n of e.animations.allIds){const o=e.animations.byId[n];o&&(["layerId","introLayerId","outroLayerId"].some((e=>a.includes(o[e])))&&t.push(o.id))}e.animations.allIds=t,e.animations.byId=t.reduce(((t,a)=>(t[a]=e.animations.byId[a],t)),{})}catch(YEe){p("Unable to clean video animations",{extra:{video:e.id,__FORCE_SAMPLE:!0}})}})(g)}g.isStudio&&"/studio/editor"!==g.editorPath&&p("Studio video but non studio editor!!"),t&&(!function(e,t,a){try{const{studio:o}=e;C4(t,o,a)}catch(YEe){console.info("Failed to log createVideo")}}(u,g,n),g._id&&r(function(e){return async t=>{try{const[a,o]=await S4(e,fh.Thumbnail);c$([JO(a,o)],{eventHandlers:{handleFinish:a=>{t(F4(a.url));const o={image_url:a.url};U4(e._id,o)}},uploadOptions:{analyticsUploadSource:"Thumbnail upload",omitFromMediaLibrary:!0,isThumbnail:!0,skipUploadStatusUpdates:!0,uploadSourceComponent:"Export"}})}catch(a){console.error(a)}}}(g)));const v=!g._id;if(!v&&!t&&y)return g;let w;w=v?"/api/v1/videos":t?"/api/v1/videos/publish":"/api/v1/videos/save";return async function(e,t,a,o){o&&(t(a?lR({...e,done:!1}):cR(!0)),function(e,t,a){t(O4(e._id)),t((o=e.projectId||"",{type:"SET_PROJECT_ID",projectId:o})),t({type:"SET_VIDEO_DRAFT_INFO",draft:!a&&e.draft,done:e.done,createdAt:e.createdAt,lastSaved:e.lastSaved});var o}(e,t,a));return e}(await gu(w,{body:{publish:t,processedOnClient:n,token:s,userId:d,video:g,selectedTeamId:m,isBrandKitTemplate:h}}),r,t,y)}}function O4(e){return{type:"SET_VIDEO_ID",_id:e}}function F4(e){return{type:"SET_IMAGE_URL",image_url:e}}function M4(e){return(t,a)=>{const{currentUser:o,isStudio:n,studio:r,editorPath:i}=a(),{token:s}=o||{};if(!e){w({category:"Bad Trigger Lambda",message:`isStudio: ${n} videoId ${r._id} editorPath ${i}`});const e=new Error("triggerLambda run with no video!");b(e)}return function(e,t){return gu("/api/v1/videos/triggerLambda",{body:{token:t,video:e}}).then((()=>e)).catch((e=>(console.error(e),e)))}(e,s)}}async function U4(e,t){const{token:a}=tn().state.currentUser||{};return yu(`/api/v1/videos/${e}`,{params:{clientVersion:"0.7"},body:t,headers:{"x-access-token":a},parseJSON:!1})}function B4({currentUser:e,newLayer:t,teamId:a}){return async()=>{var o,n;const{token:r,user:i}=e||{},{_id:s}=i||{},l=y(),{projectName:d,workspaceId:c}=t;delete t.projectName,delete t.workspaceId;const u={currentUser:e,projectName:d,studio:{background:"#ffffff",showCanvas:!0,isStudio:!0,isCreator:!0,creatorId:i._id,origin:"workspaceUpload",quality:"high",ratio:`${t.width}:${t.height}`,scenes:[{background:"#ffffff",duration:0,id:l,layers:[{...t}],subtitle:{...Yi}}],workspaceId:c,teamId:a}};let m;try{m=t$(u,true)}catch(g){return console.error("error"),Promise.reject(g)}m.editorPath="/studio/editor",m.projectVersion="0.7";const p=m.scenes[0],h=null==(n=null==(o=m.scenes[0])?void 0:o.layers[0])?void 0:n.duration;return h&&(p&&(p.duration=h),m.duration=h),function(e,t){var a,o;const n=rd(t);vc("Folder Upload",{"Team ID":n._id,"Folder ID":e,"Number of Workspace Members":null!=(o=null==(a=null==n?void 0:n.users)?void 0:a.length)?o:0,"Current Plan":ld().name})}(c,a),gu("/api/v1/videos",{body:{publish:true,processedOnClient:!1,token:r,userId:s,video:m}})}}const W4="GenericBlock-module_genericContainer_mgpDY",V4="GenericBlock-module_horizontalContainer_MSe08",j4="GenericBlock-module_content_XQG7Y",G4="GenericBlock-module_buttonWrapper_b15gp",H4="GenericBlock-module_img_2ESKP",z4="GenericBlock-module_genericBlockContainer_nLr9u",$4="GenericBlock-module_hasImg_TJcRj",K4="GenericBlock-module_contentContainer_nGFHZ",Y4="GenericBlock-module_heading_qzdFQ",q4="GenericBlock-module_withClose_A-83i",X4="GenericBlock-module_body_fTcX-",J4="GenericBlock-module_close_CWm3o",Q4=({body:e,heading:t,button:a,img:o,className:n="",headingClassName:r="",bodyClassName:s="",testId:l="",horizontal:d=!1,onDismiss:c})=>d?i.createElement("div",{className:`${W4} ${V4} ${o?$4:""} ${n}`,"data-cy":l},o&&i.createElement("img",{src:o.imgSrc,alt:o.imgAlt,className:`${H4} ${o.className}`}),i.createElement("div",{className:j4},t&&i.createElement("div",{className:`${Y4} ${r}`},t),e&&i.createElement("div",{className:`${X4} ${s}`},e)),i.createElement("div",{className:G4},a)):i.createElement("div",{className:`${W4} ${z4} ${o?$4:""} ${n}`,"data-cy":l,"data-testid":l},i.createElement("div",{className:K4},o&&i.createElement("img",{src:o.imgSrc,alt:o.imgAlt,className:`${H4} ${o.className}`}),i.createElement("div",{className:j4},t&&i.createElement("div",{className:`${Y4} ${void 0!==c?q4:""} ${r}`},t,c&&i.createElement("div",{className:J4,onClick:c,"data-cy":`${l} close`,"data-testid":`${l} close`},i.createElement(pe,null))),e&&i.createElement("div",{className:`${X4} ${s}`},e))),a),Z4="UpsellBlock-module_upsellBlock_sCLzk",e9="UpsellBlock-module_horizontalWrapper_17PU7",t9="UpsellBlock-module_button_QqETY",a9="UpsellBlock-module_wrapper_pX-Bc",o9="UpsellBlock-module_topLeftImg_g1fHG",n9="GenericButton-module_genericButton_OMRjJ",r9="GenericButton-module_disabled_AYYOH",i9="GenericButton-module_linkWrapper_7tPQ7",s9=({icon:e,buttonText:t="",className:a="",onClick:o=(()=>{}),testId:n,disabled:r=!1,href:s})=>s?i.createElement("a",{className:i9,href:s,target:"_blank",rel:"noreferrer"},i.createElement("div",{className:`${n9} ${a}`,onClick:o,"data-testid":n,"data-cy":n},t,e)):i.createElement("div",{className:`${n9} ${a} ${r?r9:""}`,onClick:o,"data-testid":n,"data-cy":n},t,e),l9=e=>{var t;const{currentUser:a}=e;return!!(null==(t=null==a?void 0:a.user)?void 0:t._id)},d9="UpsellButton-module_upsellButton_faS-2",c9="UpsellButton-module_darkUpsellButton_V2qDu",u9="UpsellButton-module_lightSparkle_xstp-",m9=({action:e,onPaywallSuccess:t=(()=>{}),hasIcon:a=!0,buttonText:o="Upgrade",className:n="",testId:r="upsell",team:s,darkStyle:l})=>{const d=m.exports.useDispatch(),c=HU(),u=id(),p=tr((e=>l9(e)));return i.createElement(s9,{className:`${d9} ${n} ${l?c9:""}`,buttonText:o,icon:a?i.createElement(Pn,{className:`${l?u9:null}`}):null,onClick:()=>{p?c(t,{action:e,teamId:(null==s?void 0:s._id)||u._id})():d({type:"SHOW_SIGN_IN"})},testId:`${r}-button`})},p9=e=>{const t=id(),{img:a,upsellBlockHeading:o,upsellBlockBody:n,buttonText:r}=js(e.action),s=e.topLeftImg?o9:e.imgClassName;return i.createElement("div",{className:a9},i.createElement(Q4,{className:`${Z4} ${e.horizontal?e9:""}`,img:e.noImg?null:{...a,imgSrc:e.imgSrc||a.imgSrc,className:s},heading:o,body:n,horizontal:e.horizontal,button:e.buttonText||r?i.createElement(m9,{className:t9,onPaywallSuccess:e.onPaywallSuccess,action:e.action,buttonText:e.buttonText||r,team:t,testId:e.testId}):null,testId:e.testId}))};var h9=(e=>(e.REMOVE_WATERMARK="removeWatermark",e.EXPORT_VIDEO="export",e.OPEN_EXPORT_PANEL="exportPanel",e.COMMENT="comment",e))(h9||{});const g9="RemoveWatermark-module_upsellBlock_A-Myi",y9="RemoveWatermark-module_override_NlJdb",f9=()=>{const e=oe(),t=Ie(),a=sd(),o=XD(Ps.EXPORT_ALL_WITHOUT_WATERMARK),n=XD(Ps.EXPORT_30_SEC_WITHOUT_WATERMARK),l=tr((e=>e.currentUser)),d=tr((e=>e.currentVideo)),c=m.exports.useDispatch(),[u,p]=r.exports.useState(!1),h=r.exports.useCallback((async()=>{p(!0);try{const e=await c(function(e,t=""){return async(a,o)=>{const{currentUser:n,workspaces:r}=o(),{token:i,user:l}=n||{},{_id:d}=l||{},{selectedWorkspace:c}=r||{};if(s.exports.isEmpty(e)){const e=new Error("No video found. Please try again later.");return Promise.reject(e)}const{_id:u,...m}=e;c&&Object.assign(m,{workspaceId:c}),Object.assign(m,{done:!1,finishedAt:void 0,fullPath:void 0,local_url:void 0,image_url:void 0,processedOnClient:void 0,lastSeen:new Date,paymentOption:t,progressText:"Loading ... Removing watermark ...",submittedAt:new Date,watermark:!1});const p=await gu("/api/v1/videos",{body:{publish:!0,token:i,userId:d,video:m}});return a(lR(p)),p}}(d));d.processedOnClient?t.push(`/${e._id}/studio/editor`):t.push(`/videos/${e._id}`)}catch(e){Iu({description:"Failed to remove watermark",error:e}),p(!1)}}),[c,d,t]);r.exports.useEffect((()=>{const t=new URLSearchParams(e.search);sc(l)&&n&&"true"===t.get(h9.REMOVE_WATERMARK)&&!u&&h()}),[l,e.search,h,u,n]);const g=((null==d?void 0:d.duration)||0)<30;return d.watermark?o||g&&n?i.createElement(Q4,{heading:"Re-export to remove the watermark",body:`Welcome to Kapwing ${a.name}, re-export to remove the watermark`,button:i.createElement(kU,{onClick:h,overrideColor:"lightBlue"},"Re-export without a watermark"),className:`${g9} ${y9}`,img:{imgSrc:"https://cdn-useast1.kapwing.com/static/ouU-img_upsell_remove_watermark.webp",imgAlt:`Welcome to Kapwing ${a.name}, re-export to remove our watermark from your projects.`},testId:"remove-watermark-upsell-block"}):i.createElement("div",{className:g9},i.createElement(p9,{action:g?Rs.REMOVE_30_SEC_WATERMARK:Rs.REMOVE_WATERMARK,onPaywallSuccess:h,testId:"remove-watermark-upsell-block"})):null},E9="SubscriptionStateBlock-module_errorBlock_0kzPV",v9="SubscriptionStateBlock-module_errorBlockHeading_eP7ZK",w9="SubscriptionStateBlock-module_errorButton_N32og",b9="SubscriptionStateBlock-module_reactivateBlock_79PEw",_9="SubscriptionStateBlock-module_reactivateButton_z4jPw",T9="SubscriptionStateBlock-module_pastDueBody_iPkzS",S9=({className:e=""})=>{const t=Ie(),a=id(),{subscription:o}=af(),n=sd(),r=()=>{t.push(`/team/${a._id}/billing`)};if(!o)return null;if(fd(o))return(()=>{const t=o?I(1e3*o.current_period_end).format("ddd, MMMM Do, YYYY"):"";return i.createElement(Q4,{className:`${b9} ${e}`,heading:`Your access to ${n.name} is ending`,body:`${t} is the last day you’ll have access to ${n.name} features including watermark-free projects ${n.hasPermission(Ps.HIGH_QUALITY)?" and HD video quality":""}. Reactivate to avoid losing access.`,button:i.createElement(s9,{className:_9,buttonText:"Visit Billing to Reactivate",onClick:r,icon:i.createElement(Pn,null)})})})();const{isPastDue:s}=gd(o);return s&&CE()?i.createElement(Q4,{className:`${E9} ${e}`,heading:"Payment incomplete",headingClassName:v9,body:i.createElement("div",{className:T9},"Your current payment is ",i.createElement("strong",null,"incomplete.")," Please update your payment details to avoid losing access to PRO."),button:i.createElement(s9,{className:w9,buttonText:"Update payment details",onClick:r})}):null},I9="ShareButton-module_tooltip_6GrU2",x9="ShareButton-module_shareButtonTooltip_duKu8",k9="ShareButton-module_shareButton_GeWEo",C9="ShareButton-module_shareButtonIcon_gcQXq",A9="ShareButton-module_shareButtonText_BsVtc",N9=we(m.exports.connect((e=>({currentUser:e.currentUser,videoId:e.studio._id,creatorEmail:e.studio.creatorEmail,videoSaving:e.videoSaving,editorPath:e.editorPath,canWrite:e.userPermissions.canWrite})),(e=>me({createVideo:D4},e)))((e=>{const[t,a]=r.exports.useState(!1),[o,n]=r.exports.useState(!1),s=Ee(),l=()=>{var t;const{canWrite:a}=e;a&&((null==(t=s.path)?void 0:t.endsWith("/share"))?iT(e.editorPath):d())},d=async t=>{const{createVideo:r,currentUser:i,creatorEmail:s,videoSaving:l}=e,{user:d}=i||{};if(t&&t.stopPropagation(),!sc(e.currentUser))return void a(!0);if(o)return;if(e.videoId){const t=null!=s?s:d.email;((e,t,a)=>{const o={"Project Owner Email":a,"Sharer Email":e.email,"Video ID":t};amplitude.getInstance().setUserId(e._id),amplitude.getInstance().setUserProperties({Email:e.email}),amplitude.getInstance().logEvent("Project Share Dialog Opened",o)})(d,e.videoId,t)}n(!0);let{videoId:c}=e;!c&&l?(await(async()=>new Promise(((e,t)=>{const a=setInterval((()=>{tn().state.studio._id&&(clearInterval(a),e())}),250)})))(),a(!1),iT("/studio/editor/share")):c?(a(!1),iT("/studio/editor/share")):c=await r({currentUser:i,publish:!1,auto:!1,createLocation:"studio-share"}).then((()=>{a(!1),iT("/studio/editor/share")})).catch((e=>(a(!1),Iu({description:"Failed to share video",error:e}),null))),n(!1)};return i.createElement(i.Fragment,null,(()=>{const{canWrite:t}=e;return t?i.createElement("div",{className:`${I9} ${k9}`,onClick:l,"data-cy":"share-button","data-testid":"studio-header-share-button"},i.createElement(St,{className:C9})," ",i.createElement("span",{className:A9},"Share"),i.createElement("span",{className:x9},"Share this project to invite ",i.createElement("br",null)," others to collaborate with you")):null})(),t&&i.createElement(ZF,{hideSignIn:()=>{a(!1)},onSuccess:()=>{e.onSignin&&e.onSignin(),d()},description:"Kapwing works better if you're signed in. Sign in to share your project with people and edit collaboratively in real time.",immediateRedirectPathname:"/studio/editor/share"}))})));const P9=[{author:{name:"eckskwisit",url:"https://open.spotify.com/artist/5c1yPkyqe6CGC7eZ9Fo0ZV?si=y7hi5iN4T9GG_dHav9uvbg"},metadata:{duration:320.500344},source:"https://cdn-useast1.kapwing.com/static/audio/Hustle%20Muscle%20-%20Unminus.com.mp3",tags:["trap","badass","bad","gangsta","gangster","hip-hop","hip_hop","trip","hustle","grimy","energy","rap","beat","drive","free_instrumental","strong","hard","cool","driveby"],title:"Hustle Muscle",type:"unminus"},{author:{name:"JNGS",url:"https://open.spotify.com/artist/6pvJuusRJQn0SM6BEWKczZ?si=2M-UdGseT5SnyKsEOZ_Zbg"},metadata:{duration:240.068525},source:"https://cdn-useast1.kapwing.com/static/audio/Midpoint.-%20Unminus.com.mp3",tags:["grimy","dark","trap","hip_hop","gangster","heavy","strong","bad","steel_drums","hip-hop","badass"],title:"Midpoint.",type:"unminus"},{author:{name:"Ezequiel Marotte",url:"https://soundcloud.com/ezequielmarotte"},metadata:{duration:560.461189},source:"https://cdn-useast1.kapwing.com/static/audio/Bad%20Behaviors%20www.wowa.me.mp3",tags:["heavy","electro","edm","free","hard","techno","bad","grimy"],title:"Bad Behaviors",type:"unminus"},{author:{name:"Wowa & Chris Rede",url:"https://t.umblr.com/redirect?z=https%3A%2F%2Fopen.spotify.com%2Fartist%2F6zZPxLiRfbGUnoEAJmfJJN&t=MjhmYjhiOTBkN2FkMjM2OGUyNmI4Njc1ZGY5YWJhOTJhNDU1NjkxYixSc0h3MlU5aQ%3D%3D&b=t%3Al9VQoiOTXdUwbYJUvbv1sA&p=https%3A%2F%2Fwww.unminus.com%2Fpost%2F162248618982%2Fpiratos&m=0&ts=1625757493"},metadata:{duration:117.106938},source:"https://cdn-useast1.kapwing.com/static/audio/Piratos%20www.wowa.me.mp3",tags:["pirate","marsch","drama","pirates","caribean","trumpet","horn","attack","war","dark","movie","presentation","mockup","free","cc0","soundtrack","gema_frei","downloadable","power","grimy","heavy","energy"],title:"Piratos",type:"unminus"},{author:{name:"Kevin Shrout",url:"https://soundcloud.com/Kevin-Shrout"},metadata:{duration:148.666878},source:"https://cdn-useast1.kapwing.com/static/audio/The%20Intro%20we%20have%20been%20waiting%20for%20-%20Kevin%20Shrout%20Unminus.com.mp3",tags:["happy","energy","edm","background","electro","fresh","motion","effects","sunny","instrumental","chillout","cool"],title:"The Intro We Have Been Waiting For",type:"unminus"},{author:{name:"Wowa",url:"https://open.spotify.com/artist/6zZPxLiRfbGUnoEAJmfJJN?si=WDq_5dZoTmmsN95o_HinNQ"},metadata:{duration:297.929756},source:"https://cdn-useast1.kapwing.com/static/audio/Autumn%20Allure%20unminus.com.mp3",tags:["calm","chill","chilled","relax","autumn","classic","classical","no_vocals","no_drums","strings","cello","nature","peace","trees","water","birds","happy","travel","fly","harp","royal","orchestra"],title:"Autumn Allure",type:"unminus"},{author:{name:"starfrosch",url:"https://href.li/?https://starfrosch.com"},metadata:{duration:242.0277},source:"https://cdn-useast1.kapwing.com/static/audio/Deadfro5h%20-%20Unminus.com.mp3",tags:["frog","happy","energy","synthi","electronic","elctro","edm","dance","space","stars","pluck","chill","chilled","house","simple","no_vocals","background","fly","instrumental"],title:"deadfro5h",type:"unminus"},{author:{name:"Wowa",url:"https://t.umblr.com/redirect?z=https%3A%2F%2Fopen.spotify.com%2Fartist%2F6zZPxLiRfbGUnoEAJmfJJN%3Fsi%3DWDq_5dZoTmmsN95o_HinNQ&t=NjI2NmY3ZGNiZDdhYzkxMThmY2E1MjY0MWE4Y2U3MDQ2NjQyMDQzYyxoR0FlVzROVg%3D%3D&b=t%3Al9VQoiOTXdUwbYJUvbv1sA&p=https%3A%2F%2Fwww.unminus.com%2Fpost%2F611334050473492480%2Fhangtime&m=0&ts=1625758050"},metadata:{duration:182.756689},source:"https://cdn-useast1.kapwing.com/static/audio/Hangtime%20-%20unminus.com.mp3",tags:["happy","energy","cool","jump","fly","bass","hip_hop","guitar","organ","free","snowboard","gopro","gangster","yeah","fresh","nice","skateboard","bmx","sport","trap","synthi","no_vocals","drums","action","motivation","cinematic","motivational","fun","street","power"],title:"Hangtime",type:"unminus"},{author:{name:"RRound",url:"https://t.umblr.com/redirect?z=https%3A%2F%2Fsoundcloud.com%2Frround&t=NWViMjEyMzk2YTg0ZTFkZTE0NzNlZDg2NzI0NDE0Yjc0OWIwZDNkZCwwTWFTMURiMw%3D%3D&b=t%3Al9VQoiOTXdUwbYJUvbv1sA&p=https%3A%2F%2Fwww.unminus.com%2Fpost%2F611483541377777664%2Freggaechill&m=0&ts=1625758050"},metadata:{duration:84.275933},source:"https://cdn-useast1.kapwing.com/static/audio/Reggaechill%20-%20unminus.com.mp3",tags:["happy","piano","chill","chilled","reggae","no_vocals","sun","smile","fun","simple","cool"],title:"Reggaechill",type:"unminus"},{author:{name:"RRound",url:"https://t.umblr.com/redirect?z=https%3A%2F%2Fsoundcloud.com%2Frround&t=NWFiYzBiMDIzZWNkYTI0YmQwZmIwZjhiMDA2NDE0NjM3OTIxN2QzMixwV2l1ZDdBag%3D%3D&b=t%3Al9VQoiOTXdUwbYJUvbv1sA&p=https%3A%2F%2Fwww.unminus.com%2Fpost%2F182829385352%2Fambisax&m=0&ts=1625758052"},metadata:{duration:80.199938},source:"https://cdn-useast1.kapwing.com/static/audio/Ambisax%20-%20Unminus.com.mp3",tags:["happy","guitar","jazzy","sax","saxophone","chilled","travel"],title:"Ambisax",type:"unminus"},{author:{name:"housefrau.me",url:"https://href.li/?https://housefrau.me/"},metadata:{duration:362.191781},source:"https://cdn-useast1.kapwing.com/static/audio/Berlin%20Dream%20-%20Unminus.com.mp3",tags:["happy","chilled","edm","berlin","dream","dreamy","synthi","no_vocals","ambient","electro","chillout","relax","lounge","instrumental"],title:"Berlin Dream",type:"unminus"},{author:{name:"JNGS",url:"https://t.umblr.com/redirect?z=https%3A%2F%2Fopen.spotify.com%2Fartist%2F6pvJuusRJQn0SM6BEWKczZ%3Fsi%3DbP7ZoMl-SV6NuHhr0lH6Yw&t=ZDU2ZDgzYTdmNmM3OWQwYmMyYjQzOGY2MzZmMzZhN2I2MWZhYThiMywySk9UY2JUNQ%3D%3D&b=t%3Al9VQoiOTXdUwbYJUvbv1sA&p=https%3A%2F%2Fwww.unminus.com%2Fpost%2F178424744077%2Fpalmtrees&m=0&ts=1625758054"},metadata:{duration:180.272667},source:"https://cdn-useast1.kapwing.com/static/audio/Palmtrees%20www.wowa.me.mp3",tags:["palms","palmtree","freemusic","cc0","nocopyright","unsplash","jngs","instrumental","fresh","chill","happy","chilled"],title:"Palmtrees",type:"unminus"},{author:{name:"Wowa",url:"https://t.umblr.com/redirect?z=https%3A%2F%2Fopen.spotify.com%2Fartist%2F6zZPxLiRfbGUnoEAJmfJJN&t=ZWU3Zjc5YWExZjI3MGUyNmY0OTY1YjFjM2FiYzRkZmJjYWQ4ZjI1NSxXTUl2UnpyUg%3D%3D&b=t%3Al9VQoiOTXdUwbYJUvbv1sA&p=https%3A%2F%2Fwww.unminus.com%2Fpost%2F163446305972%2Feasy&m=0&ts=1625758054"},metadata:{duration:118.935542},source:"https://cdn-useast1.kapwing.com/static/audio/Easy%20wowa.me%20CC0%20Free%20Beautiful%20Music.mp3",tags:["easy","motivation","happy","mobile","iphone","production","garageband","fresh","fly","keys","synth","synthi","piano","beat","drums","copyright_free_music","chilled","sad"],title:"Easy",type:"unminus"},{author:{name:"Pipo & Wowa",url:"https://t.umblr.com/redirect?z=https%3A%2F%2Fopen.spotify.com%2Fartist%2F6zZPxLiRfbGUnoEAJmfJJN&t=ZWZlNTVjYjZkZWI2ZWRhZTFjMmRmYjFlNjliYjVjMjMwZjM2MDRmNSx1VTZtRG45Zw%3D%3D&b=t%3Al9VQoiOTXdUwbYJUvbv1sA&p=https%3A%2F%2Fwww.unminus.com%2Fpost%2F162526528202%2Fpipo-interludo&m=0&ts=1625758054"},metadata:{duration:82.07675},source:"https://cdn-useast1.kapwing.com/static/audio/Pipo%20Interludo%20www.wowa.me.mp3",tags:["guitar","happy","intro","strings","chill","pipo","cc0","cc","no_copyright","unsplash","free","chilled"],title:"Pipo Interludo",type:"unminus"},{author:{name:"Pipo & Wowa",url:"https://t.umblr.com/redirect?z=https%3A%2F%2Fopen.spotify.com%2Fartist%2F6zZPxLiRfbGUnoEAJmfJJN%3Fsi%3DWDq_5dZoTmmsN95o_HinNQ&t=OTI1ZjI4ZWMxODhlMzJlZDU1NTYyMTUxYTYwZWQ3MTljYjhlNmE0NyxhTlZpUldHdA%3D%3D&b=t%3Al9VQoiOTXdUwbYJUvbv1sA&p=https%3A%2F%2Fwww.unminus.com%2Fpost%2F157456168112%2Fthey-say&m=0&ts=1625758056"},metadata:{duration:156.581178},source:"https://cdn-useast1.kapwing.com/static/audio/They%20Say%20unminus.com.mp3",tags:["guitar","chill","peace","sad","melancholic","melody","ukulele","background","lounge","calm","slow","bpm_93","love","happy","song","songwriter","free","download","public_domain","cc0","creative_commons","high","quality","fresh","relax","fireplace","couple","baby","child","way"],title:"They Say",type:"unminus"},{author:{name:"Wowa & eckskwisit",url:"https://t.umblr.com/redirect?z=https%3A%2F%2Fopen.spotify.com%2Fartist%2F6zZPxLiRfbGUnoEAJmfJJN&t=YzA0NTgwZTg4ZWE0NDEzODIzYjdjZDEwN2RiZTFjMTJiNzNhMjA3MCx5Ym9QZGs0TQ%3D%3D&b=t%3Al9VQoiOTXdUwbYJUvbv1sA&p=https%3A%2F%2Fwww.unminus.com%2Fpost%2F156714087877%2Fjust-cool&m=0&ts=1625758056"},metadata:{duration:188.05551},source:"https://cdn-useast1.kapwing.com/static/audio/Just%20Cool%20www.wowa.me.mp3",tags:["cool","free","wild","fresh","just","synthi","synth","hip_hop","hipster","rap","rnb","soul","bass","happy","funny","party","dance","west_coast","california","sunny","sun","warm","summer","holiday","energy"],title:"Just Cool",type:"unminus"},{author:{name:"Ryan Craig Martin",url:"https://www.linkedin.com/in/ryancraigmartin/"},metadata:{duration:386.328938},source:"https://cdn-useast1.kapwing.com/static/audio/Majesty%20Electro-House%20Music%20for%20Your%20Projects.mp3",tags:["electro","house","edm","dance","happy","energy","travel","ride","drive","motivation","jump","lucky","party","synthi","youtube","fast","run","speed"],title:"Majesty",type:"unminus"},{author:{name:"Wowa",url:"https://t.umblr.com/redirect?z=https%3A%2F%2Fopen.spotify.com%2Fartist%2F6zZPxLiRfbGUnoEAJmfJJN%3Fsi%3DWDq_5dZoTmmsN95o_HinNQ&t=N2UyNWVlN2QxYjQ2NWQzYjJjYTM0OTBlZDUzOGFmNTY4YTc0NGFiYyxka1dnTzVBZw%3D%3D&b=t%3Al9VQoiOTXdUwbYJUvbv1sA&p=https%3A%2F%2Fwww.unminus.com%2Fpost%2F182444650937%2Fgood-god&m=0&ts=1625758129"},metadata:{duration:100.340344},source:"https://cdn-useast1.kapwing.com/static/audio/Good%20God%20Unminus.com.mp3",tags:["energy","piano","anthem","motivation","melancholic","drums","instrumental","free","intro","hip-hop"],title:"Good God",type:"unminus"},{author:{name:"Wowa",url:"https://t.umblr.com/redirect?z=https%3A%2F%2Fopen.spotify.com%2Fartist%2F6zZPxLiRfbGUnoEAJmfJJN%3Fsi%3D6c-Ta96IT169fNxVTXJzpw&t=MjM4ZDMwYzNjMzFlNTQyNGQ1ZjQ3NGJjZDZiNzk5YWYyZGY5MTk1MSxQOUJCbWNrQQ%3D%3D&b=t%3Al9VQoiOTXdUwbYJUvbv1sA&p=https%3A%2F%2Fwww.unminus.com%2Fpost%2F178425430612%2Fruns&m=0&ts=1625758129"},metadata:{duration:155.381667},source:"https://cdn-useast1.kapwing.com/static/audio/Runs%20-%20Unminus.com.mp3",tags:["wowa","motivation","running","freemusic","publicdomain","gemafrei","instrumental","trap","run","energy","hip-hop"],title:"Runs",type:"unminus"},{author:{name:"JNGS",url:"https://t.umblr.com/redirect?z=https%3A%2F%2Fopen.spotify.com%2Fartist%2F6pvJuusRJQn0SM6BEWKczZ%3Fsi%3D2M-UdGseT5SnyKsEOZ_Zbg&t=ZjBkZDgyNWQ2NDJkMTMwOWIwNDIxZmYwYzlhZTY0YWNmOWNjYzcyZiwxMlloM05jNg%3D%3D&b=t%3Al9VQoiOTXdUwbYJUvbv1sA&p=https%3A%2F%2Fwww.unminus.com%2Fpost%2F181956501407%2Flit&m=0&ts=1625758129"},metadata:{duration:222.563275},source:"https://cdn-useast1.kapwing.com/static/audio/Lit%20www.wowa.me.mp3",tags:["lit","happy","energy","dance","latin","salsa","smile","nice","sun","party","beach","guitar","spanish"],title:"Lit",type:"unminus"},{author:{name:"JNGS",url:"https://t.umblr.com/redirect?z=https%3A%2F%2Fopen.spotify.com%2Fartist%2F6pvJuusRJQn0SM6BEWKczZ%3Fsi%3DbP7ZoMl-SV6NuHhr0lH6Yw&t=MjUyMGE1M2EwMDZkZDE4MWYxZjJhZTBiZWU5MjYwOTAwNTE2ZmQyYSx0ZUZvUnFTcQ%3D%3D&b=t%3Al9VQoiOTXdUwbYJUvbv1sA&p=https%3A%2F%2Fwww.unminus.com%2Fpost%2F178424982477%2Fbowers-wilkins&m=0&ts=1625758129"},metadata:{duration:224.626956},source:"https://cdn-useast1.kapwing.com/static/audio/Bowers%20%26%20Wilkins%20www.wowa.me.mp3",tags:["freemusic","nocopyright","cc0","wowa","publicdomain","gemafrei","bowerswilkins","bowersandwilkins","instrumental","hip_hop","energy"],title:"Bowers & Wilkins",type:"unminus"},{author:{name:"Wowa & Chris Rede",url:"https://t.umblr.com/redirect?z=https%3A%2F%2Fopen.spotify.com%2Fartist%2F6zZPxLiRfbGUnoEAJmfJJN&t=OWY3MmUxMTg2ODZhNjk0ZjY5ZmI5ZTJhMDRiMWMyNzFiM2NiYzZmNCw2U0Y1bXJvWg%3D%3D&b=t%3Al9VQoiOTXdUwbYJUvbv1sA&p=https%3A%2F%2Fwww.unminus.com%2Fpost%2F163444563422%2Ftrumpetz&m=0&ts=1625758131"},metadata:{duration:105.404082},source:"https://cdn-useast1.kapwing.com/static/audio/Trumpets%20in%20Your%20Ears%20wowa.me.mp3",tags:["trumpets","energy","loud","cc0","stock","no_copyright","motivation","stress","punchy","hard","action","fast","heavy"],title:"Trumpetz",type:"unminus"},{author:{name:"Wowa",url:"https://t.umblr.com/redirect?z=https%3A%2F%2Fopen.spotify.com%2Fartist%2F6zZPxLiRfbGUnoEAJmfJJN&t=NTA4Y2U2OTMyYmEzYmMwMzhmOTAzMzY4NzZmYjcxNWJjMDU4NzI3YSxwYkFBc3U2Ng%3D%3D&b=t%3Al9VQoiOTXdUwbYJUvbv1sA&p=https%3A%2F%2Fwww.unminus.com%2Fpost%2F162249374517%2Fvoisin&m=0&ts=1625758131"},metadata:{duration:69.12},source:"https://cdn-useast1.kapwing.com/static/audio/Voisin%20www.wowa.me.mp3",tags:["chill","calm","synthi","melody","free","chilled","energy"],title:"Voisin",type:"unminus"},{author:{name:"Neph da Menace / Hospitalized",url:"https://soundcloud.com/NephDaMenace"},metadata:{duration:260.466958},source:"https://cdn-useast1.kapwing.com/static/audio/Hospitalized%20-%20All%20Alone%20Dubstep%20138%20BPM%20wowa.me.mp3",tags:["dubstep","free","publicdomain","cc0","hard","gemafrei","freemusic","heavy","grimy"],title:"All Alone",type:"unminus"},{author:{name:"Wowa & Chris Rede",url:"https://t.umblr.com/redirect?z=https%3A%2F%2Fopen.spotify.com%2Fartist%2F6zZPxLiRfbGUnoEAJmfJJN&t=NDAxYTE1Yjc4YzczMmFmOTllZGM2OGM1MjA5NzI1MzdiNWMyMGU0MCxpSG5XMkllOQ%3D%3D&b=t%3Al9VQoiOTXdUwbYJUvbv1sA&p=https%3A%2F%2Fwww.unminus.com%2Fpost%2F163444962322%2Fbluesky&m=0&ts=1625758166"},metadata:{duration:55.118333},source:"https://cdn-useast1.kapwing.com/static/audio/Blue%20Sky%20www.wowa.me.mp3",tags:["blue","sky","heaven","fly","melancholic","melancho","synthi","strings","love","free_music","royalty_free","public_domain","stock_music","action","nocopyright","heavy","sad"],title:"Blue Sky",type:"unminus"},{author:{name:"Emescii",url:"https://soundcloud.com/emescii"},metadata:{duration:147.074756},source:"https://cdn-useast1.kapwing.com/static/audio/waveform%20-%20by%20Emescii%20Unminus.com.mp3",tags:["hip_hop","chillout","chilled","dark","city","hard","gangsta","gangster","lights","freaky","spooky","lofi","free_music","royalty_free_music","freedownload","moves","dance","synthi","trap","instrumental","cool","calm"],title:"waveform",type:"unminus"},{author:{name:"Pelayo",url:"https://soundcloud.com/pelayo"},metadata:{duration:162.016792},source:"https://cdn-useast1.kapwing.com/static/audio/Neuron%20Parking%20-%20Unminus.com%20MP3%20Full.mp3",tags:["cozy","sad","chill","chilled","neuron","melancholic","ice","winter","instrumental","chill_hop","drums","synthi","calm","chillout"],title:"Neuron Parking",type:"unminus"},{author:{name:"Dorel Stie",url:"https://href.li/?https://www.youtube.com/channel/UCQR3DebQYssa_7J5A7aJ8Zg"},metadata:{duration:47.574333},source:"https://cdn-useast1.kapwing.com/static/audio/Moon%20Landing%20Countdown%20-%20Unminus.com.mp3",tags:["space","launch","moon","landing","countdown","intro","outro","count","rocket","nasa","spacex","calm","chillout","relaxed"],title:"Moon Landing Countdown",type:"unminus"},{author:{name:"HaTom",url:"https://href.li/?https://www.youtube.com/channel/UC0JeACmSYU4Mt_Vozs4bFoQ"},metadata:{duration:248.533},source:"https://cdn-useast1.kapwing.com/static/audio/Naya%20-%20Unminus.com.mp3",tags:["tropical","world","chilled","motivation","calm","vocals","jungle","sun","smile","palm","beach","summer","chillout","relax"],title:"Naya",type:"unminus"},{author:{name:"JNGS",url:"https://open.spotify.com/artist/6pvJuusRJQn0SM6BEWKczZ?si=2M-UdGseT5SnyKsEOZ_Zbg"},metadata:{duration:267.079938},source:"https://cdn-useast1.kapwing.com/static/audio/Sad%20Circus%20unminus.com.mp3",tags:["sad","circus","trauriger_zirkus","chilled","calm","melancholic","complex","deep"],title:"Sad Circus",type:"unminus"},{author:{name:"Shock of Daylight",url:"https://href.li/?https://shockofdaylight.com/"},metadata:{duration:504.137143},source:"https://cdn-useast1.kapwing.com/static/audio/Kosu%20-%20Unminus.com.mp3",tags:["ambient","electro","melancholic","sad","chilled","strange","no_drums","depression","spooky"],title:"Kosu",type:"unminus"},{author:{name:"Wowa & Chris Rede",url:"https://t.umblr.com/redirect?z=https%3A%2F%2Fopen.spotify.com%2Fartist%2F6zZPxLiRfbGUnoEAJmfJJN%3Fsi%3DGvbyqdr_SgSnmFzVfJbvnw&t=OWJhNWU4ZDU2MDJiZmZmNTQzZDZmMzQ4Njc3NjAwYmU5Njg3MzUxZCxKcWlEWEdibw%3D%3D&b=t%3Al9VQoiOTXdUwbYJUvbv1sA&p=https%3A%2F%2Fwww.unminus.com%2Fpost%2F162489352477%2Fplease-wait&m=0&ts=1625758223"},metadata:{duration:287.425281},source:"https://cdn-useast1.kapwing.com/static/audio/Please%20Wait%20www.wowa.me.mp3",tags:["classic","drama","motivation","melancho","love","cc0","cc","instrumental","sad","strings","orchestra","movie","slow","chilled"],title:"Please Wait",type:"unminus"},{author:{url:"https://pixabay.com/music/beats-madirfan-both-of-us-14037",name:"Pixabay"},title:"madiRFAN - Both of Us",tags:["beats","beautiful plays","alternative hip-hop","podcast music"],source:"https://cdn.pixabay.com/download/audio/2022/01/12/audio_45cacdef8f.mp3?filename=madirfan-both-of-us-14037.mp3",type:"Pixabay",metadata:{duration:168}},{author:{url:"https://pixabay.com/music/beats-milk-shake-116330/",name:"Pixabay"},title:"Milk Shake",tags:["electronic","beats"],source:"https://cdn.pixabay.com/download/audio/2022/08/03/audio_54ca0ffa52.mp3?filename=milk-shake-116330.mp3",type:"Pixabay",metadata:{duration:133}},{author:{url:"https://pixabay.com/music/beats-fun-life-112188/",name:"Pixabay"},title:"Fun Life",tags:["electronic","upbeat","beats","alternative hip-hop","vlog music"],source:"https://cdn.pixabay.com/download/audio/2022/05/27/audio_ed655fa73a.mp3?filename=fun-life-112188.mp3",type:"Pixabay",metadata:{duration:109}},{author:{url:"https://pixabay.com/music/beats-guitar-electro-sport-trailer-115571",name:"Pixabay"},title:"Guitar Electro Sport Trailer",tags:["alternative hip-hop"],source:"https://cdn.pixabay.com/download/audio/2022/07/25/audio_3266b47d61.mp3?filename=guitar-electro-sport-trailer-115571.mp3",type:"Pixabay",metadata:{duration:118}},{author:{url:"https://pixabay.com/music/upbeat-clapping-music-for-typographic-video-version-2-112975",name:"Pixabay"},title:"Clapping Music For Typographic Video (Version 2)",tags:["upbeat","main title"],source:"https://cdn.pixabay.com/download/audio/2022/06/09/audio_9d22c770be.mp3?filename=clapping-music-for-typographic-video-version-2-112975.mp3",type:"Pixabay",metadata:{duration:29}},{author:{url:"https://pixabay.com/music/beautiful-plays-documentary-background-119940",name:"Pixabay"},title:"Documentary Background",tags:["modern classical"],source:"https://cdn.pixabay.com/download/audio/2022/09/14/audio_e5aba53171.mp3?filename=documentary-background-119940.mp3",type:"Pixabay",metadata:{duration:128}},{author:{url:"https://pixabay.com/music/beautiful-plays-price-of-freedom-33106",name:"Pixabay"},title:"Price of Freedom",tags:["beautiful plays","main title","modern classical","vlog music"],source:"https://cdn.pixabay.com/download/audio/2022/03/10/audio_b195486a22.mp3?filename=price-of-freedom-33106.mp3",type:"Pixabay",metadata:{duration:307}},{author:{url:"https://pixabay.com/music/beats-lofi-study-112191/",name:"Pixabay"},title:"Lofi Study",tags:["electronic","beats","alternative hip-hop","vlog music","podcast music"],source:"https://cdn.pixabay.com/download/audio/2022/05/27/audio_1808fbf07a.mp3?filename=lofi-study-112191.mp3",type:"Pixabay",metadata:{duration:147}},{author:{url:"https://pixabay.com/music/beats-sexy-fashion-beats-simulate-11176",name:"Pixabay"},title:"Sexy Fashion Beats (Simulate)",tags:["alternative hip-hop"],source:"https://cdn.pixabay.com/download/audio/2021/11/24/audio_c3dfe250e3.mp3?filename=sexy-fashion-beats-simulate-11176.mp3",type:"Pixabay",metadata:{duration:91}},{author:{url:"https://pixabay.com/music/beats-tuesday-glitch-soft-hip-hop-118327/",name:"Pixabay"},title:"Tuesday (Glitch Soft Hip-hop)",tags:["electronic","beats","alternative hip-hop","vlog music","podcast music"],source:"https://cdn.pixabay.com/download/audio/2022/08/25/audio_4f3b0a816e.mp3?filename=tuesday-glitch-soft-hip-hop-118327.mp3",type:"Pixabay",metadata:{duration:127}},{author:{url:"https://pixabay.com/music/meditationspiritual-peaceful-garden-healing-light-piano-for-meditation-zen-landscapes-112199",name:"Pixabay"},title:"Peaceful Garden - Healing Light Piano for meditation, z",tags:["beautiful plays","ambient"],source:"https://cdn.pixabay.com/download/audio/2022/05/28/audio_b79a40aa49.mp3?filename=peaceful-garden-healing-light-piano-for-meditation-zen-landscapes-112199.mp3",type:"Pixabay",metadata:{duration:179}},{author:{url:"https://pixabay.com/music/beats-best-time-112194/",name:"Pixabay"},title:"Best Time",tags:["electronic","upbeat","beats","alternative hip-hop","podcast music"],source:"https://cdn.pixabay.com/download/audio/2022/05/27/audio_5b08ce8e20.mp3?filename=best-time-112194.mp3",type:"Pixabay",metadata:{duration:128}},{author:{url:"https://pixabay.com/music/upbeat-catch-it-117676",name:"Pixabay"},title:"Catch It",tags:["upbeat","main title","vlog music","podcast music"],source:"https://cdn.pixabay.com/download/audio/2022/08/20/audio_55aa207a92.mp3?filename=catch-it-117676.mp3",type:"Pixabay",metadata:{duration:88}},{author:{url:"https://pixabay.com/music/beats-the-podcast-intro-111863/",name:"Pixabay"},title:"The Podcast Intro",tags:["electronic","upbeat","beats","alternative hip-hop","vlog music","podcast music"],source:"https://cdn.pixabay.com/download/audio/2022/05/23/audio_e341a2c57a.mp3?filename=the-podcast-intro-111863.mp3",type:"Pixabay",metadata:{duration:111}},{author:{url:"https://pixabay.com/music/beats-stylish-rock-beat-trailer-116346/",name:"Pixabay"},title:"Stylish Rock Beat Trailer",tags:["electronic","beats","main title","vlog music","podcast music"],source:"https://cdn.pixabay.com/download/audio/2022/08/03/audio_626ecbb571.mp3?filename=stylish-rock-beat-trailer-116346.mp3",type:"Pixabay",metadata:{duration:90}},{author:{url:"https://pixabay.com/music/beautiful-plays-ambient-piano-ampamp-strings-10711",name:"Pixabay"},title:"Ambient Piano & Strings",tags:["ambient"],source:"https://cdn.pixabay.com/download/audio/2021/11/13/audio_cb4f1212a9.mp3?filename=ambient-piano-ampamp-strings-10711.mp3",type:"Pixabay",metadata:{duration:217}},{author:{url:"https://pixabay.com/music/build-up-scenes-ethno-landscape-119949",name:"Pixabay"},title:"Ethno Landscape",tags:["modern classical"],source:"https://cdn.pixabay.com/download/audio/2022/09/14/audio_16e26e568b.mp3?filename=ethno-landscape-119949.mp3",type:"Pixabay",metadata:{duration:140}},{author:{url:"https://pixabay.com/music/ambient-mindfulness-relaxation-amp-meditation-music-22174",name:"Pixabay"},title:"Mindfulness Relaxation & Meditation Music",tags:["ambient"],source:"https://cdn.pixabay.com/download/audio/2022/03/07/audio_48408439d8.mp3?filename=mindfulness-relaxation-amp-meditation-music-22174.mp3",type:"Pixabay",metadata:{duration:240}},{author:{url:"https://pixabay.com/music/rock-stomping-rock-four-shots-111444",name:"Pixabay"},title:"Stomping Rock (Four Shots)",tags:["vlog music"],source:"https://cdn.pixabay.com/download/audio/2022/05/17/audio_407815a564.mp3?filename=stomping-rock-four-shots-111444.mp3",type:"Pixabay",metadata:{duration:119}},{author:{url:"https://pixabay.com/music/meditationspiritual-endless-by-prabajithk-118998",name:"Pixabay"},title:"Endless by PrabajithK",tags:["ambient"],source:"https://cdn.pixabay.com/download/audio/2022/09/03/audio_7e44a45464.mp3?filename=endless-by-prabajithk-118998.mp3",type:"Pixabay",metadata:{duration:640}},{author:{url:"https://pixabay.com/music/ambient-valley-of-hope-ambient-meditation-study-sleep-music-115453",name:"Pixabay"},title:"Valley of Hope ambient meditation study sleep music",tags:["ambient"],source:"https://cdn.pixabay.com/download/audio/2022/07/22/audio_58b0125cb0.mp3?filename=valley-of-hope-ambient-meditation-study-sleep-music-115453.mp3",type:"Pixabay",metadata:{duration:1330}},{author:{url:"https://pixabay.com/music/future-bass-electronic-future-beats-117997/",name:"Pixabay"},title:"Electronic Future Beats",tags:["electronic","beats","vlog music","podcast music"],source:"https://cdn.pixabay.com/download/audio/2022/08/23/audio_d16737dc28.mp3?filename=electronic-future-beats-117997.mp3",type:"Pixabay",metadata:{duration:126}},{author:{url:"https://pixabay.com/music/main-title-cinematic-fairy-tale-story-main-8697",name:"Pixabay"},title:"Cinematic Fairy Tale Story (Main)",tags:["modern classical"],source:"https://cdn.pixabay.com/download/audio/2021/09/25/audio_153f263349.mp3?filename=cinematic-fairy-tale-story-main-8697.mp3",type:"Pixabay",metadata:{duration:127}},{author:{url:"https://pixabay.com/music/beautiful-plays-inspiring-uplifting-cinematic-piano-119523",name:"Pixabay"},title:"Inspiring Uplifting Cinematic Piano",tags:["main title","modern classical"],source:"https://cdn.pixabay.com/download/audio/2022/09/09/audio_8b49bbfbc3.mp3?filename=inspiring-uplifting-cinematic-piano-119523.mp3",type:"Pixabay",metadata:{duration:164}},{author:{url:"https://pixabay.com/music/beats-into-the-night-20928",name:"Pixabay"},title:"Into The Night",tags:["alternative hip-hop"],source:"https://cdn.pixabay.com/download/audio/2022/02/15/audio_1e79dbf2b9.mp3?filename=into-the-night-20928.mp3",type:"Pixabay",metadata:{duration:140}},{author:{url:"https://pixabay.com/music/modern-classical-the-introvert-michael-kobrin-10959",name:"Pixabay"},title:"The Introvert - Michael Kobrin",tags:["modern classical"],source:"https://cdn.pixabay.com/download/audio/2021/11/20/audio_447ff1bec8.mp3?filename=the-introvert-michael-kobrin-10959.mp3",type:"Pixabay",metadata:{duration:139}},{author:{url:"https://pixabay.com/music/acoustic-group-morning-garden-acoustic-chill-15013",name:"Pixabay"},title:"Morning Garden - Acoustic Chill",tags:["ambient"],source:"https://cdn.pixabay.com/download/audio/2022/01/18/audio_ea75bab6d8.mp3?filename=morning-garden-acoustic-chill-15013.mp3",type:"Pixabay",metadata:{duration:233}},{author:{url:"https://pixabay.com/music/solo-guitar-the-cradle-of-your-soul-15700",name:"Pixabay"},title:"The Cradle of Your Soul",tags:["beautiful plays"],source:"https://cdn.pixabay.com/download/audio/2022/01/26/audio_d0c6ff1bdd.mp3?filename=the-cradle-of-your-soul-15700.mp3",type:"Pixabay",metadata:{duration:177}},{author:{url:"https://pixabay.com/music/soft-house-happy-summer-116584",name:"Pixabay"},title:"Happy Summer",tags:["upbeat"],source:"https://cdn.pixabay.com/download/audio/2022/08/07/audio_232269676a.mp3?filename=happy-summer-116584.mp3",type:"Pixabay",metadata:{duration:157}},{author:{url:"https://pixabay.com/music/build-up-scenes-stomp-117637",name:"Pixabay"},title:"Stomp",tags:["upbeat","main title","podcast music"],source:"https://cdn.pixabay.com/download/audio/2022/08/19/audio_e4bc494bba.mp3?filename=stomp-117637.mp3",type:"Pixabay",metadata:{duration:98}},{author:{url:"https://pixabay.com/music/acoustic-group-forest-lullaby-110624",name:"Pixabay"},title:"Forest Lullaby",tags:["beautiful plays","vlog music","podcast music"],source:"https://cdn.pixabay.com/download/audio/2022/05/05/audio_1395e7800f.mp3?filename=forest-lullaby-110624.mp3",type:"Pixabay",metadata:{duration:138}},{author:{url:"https://pixabay.com/music/beautiful-plays-spirit-landscape-118015",name:"Pixabay"},title:"Spirit Landscape",tags:["beautiful plays","main title","ambient"],source:"https://cdn.pixabay.com/download/audio/2022/08/23/audio_23da5d387d.mp3?filename=spirit-landscape-118015.mp3",type:"Pixabay",metadata:{duration:154}},{author:{url:"https://pixabay.com/music/beats-spirit-blossom-15285",name:"Pixabay"},title:"Spirit Blossom",tags:["alternative hip-hop"],source:"https://cdn.pixabay.com/download/audio/2022/01/21/audio_31743c58bd.mp3?filename=spirit-blossom-15285.mp3",type:"Pixabay",metadata:{duration:108}},{author:{url:"https://pixabay.com/music/upbeat-chilled-ambient-minimal-119323",name:"Pixabay"},title:"Chilled Ambient Minimal",tags:["ambient"],source:"https://cdn.pixabay.com/download/audio/2022/09/07/audio_dffc4fa57e.mp3?filename=chilled-ambient-minimal-119323.mp3",type:"Pixabay",metadata:{duration:144}},{author:{url:"https://pixabay.com/music/main-title-epicaly-113907",name:"Pixabay"},title:"Epicaly",tags:["beautiful plays","main title"],source:"https://cdn.pixabay.com/download/audio/2022/06/25/audio_944aab53cf.mp3?filename=epicaly-113907.mp3",type:"Pixabay",metadata:{duration:123}},{author:{url:"https://pixabay.com/music/ambient-relaxing-music-119247",name:"Pixabay"},title:"Relaxing Music",tags:["beautiful plays","ambient"],source:"https://cdn.pixabay.com/download/audio/2022/09/06/audio_eacbcf15ac.mp3?filename=relaxing-music-119247.mp3",type:"Pixabay",metadata:{duration:1324}},{author:{url:"https://pixabay.com/music/upbeat-the-weekend-117427/",name:"Pixabay"},title:"The Weekend",tags:["electronic","upbeat","beautiful plays","vlog music","podcast music"],source:"https://cdn.pixabay.com/download/audio/2022/08/17/audio_eb3864cceb.mp3?filename=the-weekend-117427.mp3",type:"Pixabay",metadata:{duration:145}},{author:{url:"https://pixabay.com/music/beautiful-plays-smooth-waters-115977",name:"Pixabay"},title:"Smooth Waters",tags:["beautiful plays","main title","vlog music"],source:"https://cdn.pixabay.com/download/audio/2022/07/30/audio_0fea22d728.mp3?filename=smooth-waters-115977.mp3",type:"Pixabay",metadata:{duration:299}},{author:{url:"https://pixabay.com/music/beats-soft-beat-115017",name:"Pixabay"},title:"Soft Beat",tags:["alternative hip-hop"],source:"https://cdn.pixabay.com/download/audio/2022/07/15/audio_bec711a8d2.mp3?filename=soft-beat-115017.mp3",type:"Pixabay",metadata:{duration:69}},{author:{url:"https://pixabay.com/music/meditationspiritual-soothing-music-120090",name:"Pixabay"},title:"Soothing Music",tags:["ambient"],source:"https://cdn.pixabay.com/download/audio/2022/09/16/audio_f84220790a.mp3?filename=soothing-music-120090.mp3",type:"Pixabay",metadata:{duration:1393}},{author:{url:"https://pixabay.com/music/modern-classical-rhythmic-strings-overly-attached-intro-119894",name:"Pixabay"},title:"Rhythmic Strings - Overly attached - Intro",tags:["modern classical"],source:"https://cdn.pixabay.com/download/audio/2022/09/14/audio_5a200a36c2.mp3?filename=rhythmic-strings-overly-attached-intro-119894.mp3",type:"Pixabay",metadata:{duration:60}},{author:{url:"https://pixabay.com/music/beats-jazzy-abstract-beat-11254",name:"Pixabay"},title:"Jazzy Abstract Beat",tags:["beats","alternative hip-hop","podcast music"],source:"https://cdn.pixabay.com/download/audio/2021/11/25/audio_91b32e02f9.mp3?filename=jazzy-abstract-beat-11254.mp3",type:"Pixabay",metadata:{duration:85}},{author:{url:"https://pixabay.com/music/upbeat-chill-abstract-intention-12099",name:"Pixabay"},title:"Chill Abstract (Intention)",tags:["upbeat"],source:"https://cdn.pixabay.com/download/audio/2021/12/13/audio_b9c0dc9e48.mp3?filename=chill-abstract-intention-12099.mp3",type:"Pixabay",metadata:{duration:88}},{author:{url:"https://pixabay.com/music/main-title-winning-elevation-111355",name:"Pixabay"},title:"Winning Elevation",tags:["beautiful plays","main title"],source:"https://cdn.pixabay.com/download/audio/2022/05/16/audio_db6591201e.mp3?filename=winning-elevation-111355.mp3",type:"Pixabay",metadata:{duration:121}},{author:{url:"https://pixabay.com/music/beautiful-plays-cinematic-documentary-115669/",name:"Pixabay"},title:"Cinematic Documentary",tags:["electronic","beautiful plays","main title","ambient","vlog music"],source:"https://cdn.pixabay.com/download/audio/2022/07/26/audio_ed0c111294.mp3?filename=cinematic-documentary-115669.mp3",type:"Pixabay",metadata:{duration:131}},{author:{url:"https://pixabay.com/music/adventure-this-is-epic-115231",name:"Pixabay"},title:"This Is Epic",tags:["beautiful plays","main title"],source:"https://cdn.pixabay.com/download/audio/2022/07/18/audio_604ae0002a.mp3?filename=this-is-epic-115231.mp3",type:"Pixabay",metadata:{duration:139}},{author:{url:"https://pixabay.com/music/beautiful-plays-out-of-time-15474",name:"Pixabay"},title:"Out of Time",tags:["modern classical"],source:"https://cdn.pixabay.com/download/audio/2022/01/23/audio_64fe965d5a.mp3?filename=out-of-time-15474.mp3",type:"Pixabay",metadata:{duration:306}},{author:{url:"https://pixabay.com/music/build-up-scenes-inspiring-cinematic-piano-116957",name:"Pixabay"},title:"Inspiring Cinematic Piano",tags:["modern classical"],source:"https://cdn.pixabay.com/download/audio/2022/08/10/audio_158527cbab.mp3?filename=inspiring-cinematic-piano-116957.mp3",type:"Pixabay",metadata:{duration:141}},{author:{url:"https://pixabay.com/music/acoustic-group-sedative-110241",name:"Pixabay"},title:"Sedative",tags:["beautiful plays"],source:"https://cdn.pixabay.com/download/audio/2022/04/27/audio_30ff2fdf22.mp3?filename=sedative-110241.mp3",type:"Pixabay",metadata:{duration:181}},{author:{url:"https://pixabay.com/music/beats-goldn-116392/",name:"Pixabay"},title:"Goldn",tags:["electronic","beats","alternative hip-hop","vlog music"],source:"https://cdn.pixabay.com/download/audio/2022/08/04/audio_2dde668d05.mp3?filename=goldn-116392.mp3",type:"Pixabay",metadata:{duration:159}},{author:{url:"https://pixabay.com/music/main-title-inspiring-cinematic-asia-116200",name:"Pixabay"},title:"Inspiring Cinematic Asia",tags:["modern classical"],source:"https://cdn.pixabay.com/download/audio/2022/08/02/audio_2d7a52e350.mp3?filename=inspiring-cinematic-asia-116200.mp3",type:"Pixabay",metadata:{duration:169}},{author:{url:"https://pixabay.com/music/soft-house-vocal-deep-house-your-love-to-borrow-emotional-summer-deep-house-119571",name:"Pixabay"},title:"Vocal Deep House - Your Love To Borrow (Emotional Summer Deep Ho",tags:["upbeat"],source:"https://cdn.pixabay.com/download/audio/2022/09/10/audio_03d2eaa5e7.mp3?filename=vocal-deep-house-your-love-to-borrow-emotional-summer-deep-house-119571.mp3",type:"Pixabay",metadata:{duration:224}},{author:{url:"https://pixabay.com/music/corporate-relaxing-light-background-116686",name:"Pixabay"},title:"Relaxing Light Background",tags:["upbeat","beautiful plays"],source:"https://cdn.pixabay.com/download/audio/2022/08/08/audio_0627597b4f.mp3?filename=relaxing-light-background-116686.mp3",type:"Pixabay",metadata:{duration:151}},{author:{url:"https://pixabay.com/music/corporate-happy-day-113985/",name:"Pixabay"},title:"Happy Day",tags:["electronic","upbeat","vlog music","podcast music"],source:"https://cdn.pixabay.com/download/audio/2022/06/27/audio_d1eeb72cda.mp3?filename=happy-day-113985.mp3",type:"Pixabay",metadata:{duration:170}},{author:{url:"https://pixabay.com/music/adventure-asia-travel-118018",name:"Pixabay"},title:"Asia Travel",tags:["modern classical"],source:"https://cdn.pixabay.com/download/audio/2022/08/23/audio_f811efdcf5.mp3?filename=asia-travel-118018.mp3",type:"Pixabay",metadata:{duration:155}},{author:{url:"https://pixabay.com/music/meditationspiritual-calming-music-119753",name:"Pixabay"},title:"Calming Music",tags:["ambient"],source:"https://cdn.pixabay.com/download/audio/2022/09/13/audio_3aa2a5f847.mp3?filename=calming-music-119753.mp3",type:"Pixabay",metadata:{duration:1356}},{author:{url:"https://pixabay.com/music/beats-madirfan-circles-2020-circles-119751",name:"Pixabay"},title:"madiRFAN - Circles - 2020 - Circles",tags:["alternative hip-hop"],source:"https://cdn.pixabay.com/download/audio/2022/09/13/audio_e13fd42abf.mp3?filename=madirfan-circles-2020-circles-119751.mp3",type:"Pixabay",metadata:{duration:163}},{author:{url:"https://pixabay.com/music/beautiful-plays-cinematic-ambient-piano-118668",name:"Pixabay"},title:"Cinematic Ambient Piano",tags:["beautiful plays","main title","modern classical","ambient"],source:"https://cdn.pixabay.com/download/audio/2022/08/30/audio_cfe7e03a4e.mp3?filename=cinematic-ambient-piano-118668.mp3",type:"Pixabay",metadata:{duration:106}},{author:{url:"https://pixabay.com/music/rock-powerful-stylish-stomp-rock-lets-go-114255",name:"Pixabay"},title:"Powerful Stylish Stomp Rock (Lets Go)",tags:["upbeat","main title","podcast music"],source:"https://cdn.pixabay.com/download/audio/2022/07/03/audio_8938382846.mp3?filename=powerful-stylish-stomp-rock-lets-go-114255.mp3",type:"Pixabay",metadata:{duration:136}},{author:{url:"https://pixabay.com/music/corporate-motivational-day-112790/",name:"Pixabay"},title:"Motivational Day",tags:["electronic","upbeat","podcast music"],source:"https://cdn.pixabay.com/download/audio/2022/06/06/audio_6e6377ef2d.mp3?filename=motivational-day-112790.mp3",type:"Pixabay",metadata:{duration:152}},{author:{url:"https://pixabay.com/music/future-bass-leonell-cassio-chapter-two-ft-carrie-114909/",name:"Pixabay"},title:"Leonell Cassio - Chapter Two (ft. Carrie)",tags:["electronic","beats","vlog music"],source:"https://cdn.pixabay.com/download/audio/2022/07/14/audio_b2e1adaa25.mp3?filename=leonell-cassio-chapter-two-ft-carrie-114909.mp3",type:"Pixabay",metadata:{duration:240}},{author:{url:"https://pixabay.com/music/modern-classical-touch-and-sound-113676",name:"Pixabay"},title:"Touch and Sound",tags:["modern classical","ambient"],source:"https://cdn.pixabay.com/download/audio/2022/06/21/audio_cf29d2c16c.mp3?filename=touch-and-sound-113676.mp3",type:"Pixabay",metadata:{duration:261}},{author:{url:"https://pixabay.com/music/future-bass-order-99518/",name:"Pixabay"},title:"Order",tags:["electronic","beats","alternative hip-hop","podcast music"],source:"https://cdn.pixabay.com/download/audio/2022/03/23/audio_07b2a04be3.mp3?filename=order-99518.mp3",type:"Pixabay",metadata:{duration:104}},{author:{url:"https://pixabay.com/music/beautiful-plays-inspiring-cinematic-ambient-116199",name:"Pixabay"},title:"Inspiring Cinematic Ambient",tags:["beautiful plays","modern classical","ambient"],source:"https://cdn.pixabay.com/download/audio/2022/08/02/audio_884fe92c21.mp3?filename=inspiring-cinematic-ambient-116199.mp3",type:"Pixabay",metadata:{duration:189}},{author:{url:"https://pixabay.com/music/modern-classical-inspiring-emotional-uplifting-piano-112623",name:"Pixabay"},title:"Inspiring Emotional Uplifting Piano",tags:["beautiful plays","main title","modern classical"],source:"https://cdn.pixabay.com/download/audio/2022/06/03/audio_c3d218496a.mp3?filename=inspiring-emotional-uplifting-piano-112623.mp3",type:"Pixabay",metadata:{duration:158}},{author:{url:"https://pixabay.com/music/upbeat-own-117683",name:"Pixabay"},title:"Own",tags:["upbeat"],source:"https://cdn.pixabay.com/download/audio/2022/08/20/audio_53e3aedf91.mp3?filename=own-117683.mp3",type:"Pixabay",metadata:{duration:126}},{author:{url:"https://pixabay.com/music/beats-trailer-sport-stylish-16073",name:"Pixabay"},title:"Trailer Sport Stylish",tags:["beats","alternative hip-hop"],source:"https://cdn.pixabay.com/download/audio/2022/01/31/audio_0f2416122a.mp3?filename=trailer-sport-stylish-16073.mp3",type:"Pixabay",metadata:{duration:181}},{author:{url:"https://pixabay.com/music/solo-piano-piano-moment-9835",name:"Pixabay"},title:"Piano Moment",tags:["modern classical"],source:"https://cdn.pixabay.com/download/audio/2021/10/25/audio_05570f2464.mp3?filename=piano-moment-9835.mp3",type:"Pixabay",metadata:{duration:273}},{author:{url:"https://pixabay.com/music/beats-hip-hop-rock-beats-118000/",name:"Pixabay"},title:"Hip Hop Rock Beats",tags:["electronic","upbeat","beats","podcast music"],source:"https://cdn.pixabay.com/download/audio/2022/08/23/audio_8d07c2f3af.mp3?filename=hip-hop-rock-beats-118000.mp3",type:"Pixabay",metadata:{duration:79}},{author:{url:"https://pixabay.com/music/main-title-cinematic-time-lapse-115672",name:"Pixabay"},title:"Cinematic Time Lapse",tags:["beautiful plays","main title","modern classical"],source:"https://cdn.pixabay.com/download/audio/2022/07/26/audio_112f2d606c.mp3?filename=cinematic-time-lapse-115672.mp3",type:"Pixabay",metadata:{duration:121}},{author:{url:"https://pixabay.com/music/beautiful-plays-inspirational-sentimental-romantic-116955",name:"Pixabay"},title:"Inspirational Sentimental Romantic",tags:["beautiful plays","main title","modern classical"],source:"https://cdn.pixabay.com/download/audio/2022/08/10/audio_2014b63921.mp3?filename=inspirational-sentimental-romantic-116955.mp3",type:"Pixabay",metadata:{duration:188}},{author:{url:"https://pixabay.com/music/upbeat-bounce-114024/",name:"Pixabay"},title:"Bounce",tags:["electronic","upbeat","beats","alternative hip-hop","vlog music","podcast music"],source:"https://cdn.pixabay.com/download/audio/2022/06/28/audio_ffe4e508f3.mp3?filename=bounce-114024.mp3",type:"Pixabay",metadata:{duration:95}},{author:{url:"https://pixabay.com/music/future-bass-leonell-cassio-the-blackest-bouquet-118766/",name:"Pixabay"},title:"Leonell Cassio - The Blackest Bouquet",tags:["electronic","beats","vlog music"],source:"https://cdn.pixabay.com/download/audio/2022/08/31/audio_419263fc12.mp3?filename=leonell-cassio-the-blackest-bouquet-118766.mp3",type:"Pixabay",metadata:{duration:221}},{author:{url:"https://pixabay.com/music/beats-toxic-love-117607",name:"Pixabay"},title:"Toxic Love",tags:["beats","alternative hip-hop","podcast music"],source:"https://cdn.pixabay.com/download/audio/2022/08/19/audio_783a242e3a.mp3?filename=toxic-love-117607.mp3",type:"Pixabay",metadata:{duration:165}},{author:{url:"https://pixabay.com/music/beats-fashion-upbeat-electronica-117535",name:"Pixabay"},title:"Fashion Upbeat Electronica",tags:["upbeat","alternative hip-hop"],source:"https://cdn.pixabay.com/download/audio/2022/08/18/audio_5ba7ef59dc.mp3?filename=fashion-upbeat-electronica-117535.mp3",type:"Pixabay",metadata:{duration:66}},{author:{url:"https://pixabay.com/music/beautiful-plays-field-grass-115973",name:"Pixabay"},title:"Field Grass",tags:["main title","modern classical","ambient"],source:"https://cdn.pixabay.com/download/audio/2022/07/30/audio_14f618bbd4.mp3?filename=field-grass-115973.mp3",type:"Pixabay",metadata:{duration:264}},{author:{url:"https://pixabay.com/music/main-title-epic-dramatic-action-trailer-99525",name:"Pixabay"},title:"Epic Dramatic Action Trailer",tags:["upbeat","main title"],source:"https://cdn.pixabay.com/download/audio/2022/03/23/audio_860cea5baa.mp3?filename=epic-dramatic-action-trailer-99525.mp3",type:"Pixabay",metadata:{duration:121}},{author:{url:"https://pixabay.com/music/modern-classical-uplifting-piano-is-112841",name:"Pixabay"},title:"Uplifting Piano Is",tags:["modern classical"],source:"https://cdn.pixabay.com/download/audio/2022/06/07/audio_7998efb548.mp3?filename=uplifting-piano-is-112841.mp3",type:"Pixabay",metadata:{duration:70}},{author:{url:"https://pixabay.com/music/build-up-scenes-epic-cinematic-trailer-113981",name:"Pixabay"},title:"Epic Cinematic Trailer",tags:["main title"],source:"https://cdn.pixabay.com/download/audio/2022/06/27/audio_896b171c42.mp3?filename=epic-cinematic-trailer-113981.mp3",type:"Pixabay",metadata:{duration:147}},{author:{url:"https://pixabay.com/music/meditationspiritual-meditative-rain-114484",name:"Pixabay"},title:"Meditative Rain",tags:["ambient"],source:"https://cdn.pixabay.com/download/audio/2022/07/06/audio_bafec9fdb3.mp3?filename=meditative-rain-114484.mp3",type:"Pixabay",metadata:{duration:540}},{author:{url:"https://pixabay.com/music/beats-electronic-rock-king-around-here-15045/",name:"Pixabay"},title:"Electronic Rock (King Around Here)",tags:["electronic","beats","vlog music","podcast music"],source:"https://cdn.pixabay.com/download/audio/2022/01/18/audio_d0a13f69d2.mp3?filename=electronic-rock-king-around-here-15045.mp3",type:"Pixabay",metadata:{duration:110}},{author:{url:"https://pixabay.com/music/meditationspiritual-a-meditation-118554",name:"Pixabay"},title:"A Meditation",tags:["ambient"],source:"https://cdn.pixabay.com/download/audio/2022/08/29/audio_38be17baf6.mp3?filename=a-meditation-118554.mp3",type:"Pixabay",metadata:{duration:489}},{author:{url:"https://pixabay.com/music/ambient-deep-in-the-ocean-116172",name:"Pixabay"},title:"Deep In The Ocean",tags:["ambient"],source:"https://cdn.pixabay.com/download/audio/2022/08/02/audio_5ac24f323d.mp3?filename=deep-in-the-ocean-116172.mp3",type:"Pixabay",metadata:{duration:539}},{author:{url:"https://pixabay.com/music/beats-whip-110235/",name:"Pixabay"},title:"Whip",tags:["electronic","upbeat","beats","alternative hip-hop","vlog music"],source:"https://cdn.pixabay.com/download/audio/2022/04/27/audio_67bcf729cf.mp3?filename=whip-110235.mp3",type:"Pixabay",metadata:{duration:164}}];class R9 extends Error{constructor(e){super(e),this.name="CancelledError"}}const L9=["dreamstime.com"],D9=new Set(["a","to","the","and","of","in","for","on","with","that","by","this","can","will","at","be","are","is","from","as","it","has","an","or","if","your","you","their","they","them","its"]),O9=class{constructor(e,{backgroundOpacity:t,fontBackgroundColor:o,fontDefaultColor:n,fontHighlightColor:r,fontFamily:i,aspectRatio:s}={}){a(this,"analyticsType","video"),a(this,"topic"),a(this,"outline",null),a(this,"usedUrls",new Set),a(this,"aspectRatio","9:16"),a(this,"backgroundOpacity",.5),a(this,"fontBackgroundColor","#000000"),a(this,"fontDefaultColor","#ffffff"),a(this,"fontHighlightColor","#FFCD1D"),a(this,"fontFamily","Montserrat"),a(this,"videoSearchByKeyword",new Map),a(this,"attributionByVideoUrl",new Map),a(this,"numClipsExtracted",0),a(this,"timelineOffsetSeconds",0),a(this,"cancellationSource",new kT),a(this,"generate",(async e=>{if(window.abc=e,!O9.isValidOutline(e))throw new Error("Invalid outline");return this.outline=e,this.main()})),this.topic=e,n&&(this.fontDefaultColor=n),o&&(this.fontBackgroundColor=o),r&&(this.fontHighlightColor=r),i&&(this.fontFamily=i),t&&(this.backgroundOpacity=t),s&&(this.aspectRatio=s)}cancel(){this.cancellationSource.cancel()}static isValidOutline(e){if("object"!=typeof e)return!1;if(!e)return!1;if(!("slides"in e))return!1;if(!("video_keyword"in e))return!1;if("string"!=typeof e.video_keyword)return!1;if(!Array.isArray(e.slides))return!1;for(const t of e.slides){if("object"!=typeof t)return!1;if(!t)return!1;if(!("text"in t))return!1;if("string"!=typeof t.text)return!1;if(!("title"in t))return!1;if("string"!=typeof t.title)return!1}return!0}static async getPreciseDuration(e){return new Promise((t=>{const a=document.createElement("video");a.src=e,a.preload="auto",a.onerror=()=>{a.remove(),t(Number.NaN)},a.ondurationchange=()=>{a.remove(),t(a.duration)},a.muted=!0,setTimeout((()=>{t(Number.NaN),a.remove()}),5e3),document.body.appendChild(a),a.width=0,a.height=0,a.style.visibility="hidden",a.style.position="absolute",a.style.left="-10000px",a.style.top="-10000px",a.load()}))}addTextHighlights(e){const t=this.topic.toLowerCase().split(" ");for(const a of e){if(a.type!==ln.Text)continue;const e=Y.convertToRaw(Y.ContentState.createFromText(a.text));if(!e.blocks[0])continue;let o=0,n=0,r=!0;for(const i of a.text.toLowerCase().split(" "))!D9.has(i)&&t.includes(i)?r&&(e.blocks[0].inlineStyleRanges.push({offset:n,length:o-n,style:`COLOR_${this.fontDefaultColor}`}),r=!1,n=o):r||(e.blocks[0].inlineStyleRanges.push({offset:n,length:o-n,style:`COLOR_${this.fontHighlightColor}`}),r=!0,n=o),o+=i.length+1;if(0===e.blocks[0].inlineStyleRanges.length){const t=a.text.split(" ");if(Math.round(Math.random()))e.blocks[0].inlineStyleRanges.push({offset:0,length:t.slice(0,3).join(" ").length,style:`COLOR_${this.fontHighlightColor}`}),r=!0,o=t.slice(0,3).join(" ").length+1,n=o;else{const i=t.slice(-3).join(" ").length;e.blocks[0].inlineStyleRanges.push({offset:0,length:a.text.length-i-1,style:`COLOR_${this.fontDefaultColor}`}),r=!1,o=a.text.length-i,n=o}}e.blocks[0].inlineStyleRanges.push({offset:n,length:a.text.length-n,style:r?`COLOR_${this.fontDefaultColor}`:`COLOR_${this.fontHighlightColor}`}),e.blocks[0].inlineStyleRanges.push({offset:0,length:a.text.length,style:"BOLD"}),a.draftJSTextTree=e}}async getAudioLayer(e){const{dispatch:t}=tn();let a=null,o=0;for(;!a;){const t=P9[Math.floor(Math.random()*P9.length)];if(t&&t.metadata.duration>e&&(a=t),o>30)throw new Error("Could not find a song that fits the duration");o+=1}const{asset:n,cmlFile:r}=await VG(a.source);HH(n,r);const i=await XH(a.source,{source:n.bucket_name?"upload":"pastedLink",asset_id:n._id,url:n.bucket_name?n.url:void 0,pastedUrl:a.source,cmlFileId:null==r?void 0:r.id,duration:a.metadata.duration,type:ln.Audio,isTrimmed:!0,startTime:0,endTime:e,videoDelay:this.timelineOffsetSeconds,timelineRow:4},{mediaInfo:{duration:a.metadata.duration,hasAudio:!0,type:ln.Audio,height:0,width:0}});return t(Nr({assetId:n._id,mediaCacheId:z.v4()})),i}static getKeyFrameAnimation(e,t){const a=.1*Math.random()+.05;return{id:"moving-zoom",name:"Moving Zoom",transitions:[{duration:t-e,easingFuncID:"linear",endValues:{bottomRight:{x:1-a,y:1-a},topLeft:{x:a,y:a}},startValues:{bottomRight:{x:1,y:1},topLeft:{x:0,y:0}},startTime:e,id:"moving-zoom-transition"}]}}async getVideoUrl(e,{targetDuration:t=0}={}){if(this.videoSearchByKeyword.has(e))return this.videoSearchByKeyword.get(e);const a=new Promise((a=>{(async function(e){try{const t=await Eu("yt_search",{body:{term:e}});return function(e){return"number"==typeof e.duration&&"number"==typeof e.height&&"string"==typeof e.originalUrl&&"string"==typeof e.url&&"number"==typeof e.width&&"string"==typeof e.yt_channel}(t)?(console.info(`searchYoutube response for ${e}:`,t),t):(console.error("searchYoutube response is malformed:",t),null)}catch(t){return console.error(t),null}})(e).then((e=>{e?O9.getPreciseDuration(e.url).then((o=>!Number.isNaN(o)&&t<o?a({...e,duration:o}):a(null))).catch((()=>{a(null)})):a(null)})).catch((()=>{a(null)}))}));return this.videoSearchByKeyword.set(e,a),a}getLayerTiming(e,t,a){var o;const n=e*((this.numClipsExtracted+1)/((null==(o=this.outline)?void 0:o.slides.length)||3));return this.numClipsExtracted+=1,{startTime:n,endTime:n+(a-t),videoDelay:t}}async getVideoLayer({startTime:e,endTime:t}){const{dispatch:a}=tn(),o=await this.getVideoUrl(this.outline.video_keyword,{targetDuration:t-e});if(this.cancellationSource.cancelled)return null;if(!o)return null;this.attributionByVideoUrl.set(o.originalUrl,o.yt_channel);const{asset:n,cmlFile:r}=await WG(o.originalUrl);if(this.cancellationSource.cancelled)return null;HH(n,r);const i=n.bucket_name&&n.url||o.url,s=await XH(i,{source:n.bucket_name?"upload":"pastedLink",...this.getLayerTiming(o.duration,e,t),isTrimmed:!0,position:{x:"0%",y:"0%",width:"100%",height:"100%",rotation:0},crop:{x:0,y:0,width:100,height:100},pastedUrl:o.originalUrl,timelineRow:2,asset_id:n._id,volume:0},{mediaInfo:{duration:o.duration,hasAudio:!0,type:ln.Video,height:o.height,width:o.width}});return a(Nr({assetId:n._id,mediaCacheId:z.v4()})),s}async getImageLayer({keyword:e,startTime:t,endTime:a}){const{dispatch:o}=tn(),n=await this.getImageLayerUrl(e);if(this.cancellationSource.cancelled)throw new R9;const{asset:r,cmlFile:i}=await VG(n);HH(r,i);const s=r.bucket_name&&r.url||n,l=await XH(s,{source:r.bucket_name?"upload":"pastedLink",startTime:t,endTime:a,isTrimmed:!0,position:{x:"0%",y:"0%",width:"100%",height:"100%",rotation:0},crop:{x:0,y:0,width:100,height:100},pastedUrl:n,keyframeAnimation:O9.getKeyFrameAnimation(t,a),timelineRow:2,asset_id:r._id,volume:0},{mediaInfo:{type:ln.Image}});if(this.cancellationSource.cancelled)throw new R9;return o(Nr({assetId:r._id,mediaCacheId:z.v4()})),l}async getImageLayerUrl(e){const t=await vz(`${e} photography`);for(const o of t.google)if(!this.usedUrls.has(o.url)&&await O9.isCorsOk(o.url)){if(this.usedUrls.has(o.url))continue;return this.usedUrls.add(o.url),o.url}const a=t.google[0];return(null==a?void 0:a.url)||""}async getVisualLayer({keyword:e,startTime:t,endTime:a,isVideoEligible:o=!1}){if(o){const e=await this.getVideoLayer({startTime:t,endTime:a});if(this.cancellationSource.cancelled)throw new R9;if(e)return e}return this.getImageLayer({keyword:e,startTime:t,endTime:a})}getTextAndBackgroundPosition(){let e=0,t=90,a=20,o=Math.random()*(35-a)+55;switch(this.aspectRatio){case"9:16":t=90,a=20,e=0,o=75;break;case"16:9":t=55,a=30,e=5;break;case"1:1":e=5,t=60,a=25;break;case"4:5":e=0,t=80,a=25;break;case"5:4":e=0,t=70,a=25}return{text:{x:`${3+e}%`,width:`${t}%`,height:`${a}%`,y:`${o}%`,rotation:0},background:{x:`${e}%`,width:`${t+6}%`,y:o-1.5+"%",height:`${a+3}%`,rotation:0}}}checkTimelineForOverlap(){const{scenes:e}=tn().state.studio,[t]=e;if(!t)return;const{duration:a}=yb(t);this.timelineOffsetSeconds=a}async updateProjectName(){const{dispatch:e}=tn(),{studio:t,currentUser:a}=tn().state;if(e(JP(this.topic)),t.projectId)try{await _v(t.projectId,{name:this.topic},a)}catch(YEe){}}async main(){const{dispatch:e}=tn();if(!this.outline)return;this.checkTimelineForOverlap();let t=0;const a=[],o=[],n=[],r=[];let i=0;for(const u of this.outline.slides){const{text:e,title:s}=u,l=e.split(" "),d=Math.max(.3*l.length,4),c=z.v4(),m=z.v4(),p=z.v4();o.push({id:p,animationName:dn.Reveal,transitionDuration:2,isCrossTransition:!1,layerId:c});const{text:h,background:g}=this.getTextAndBackgroundPosition();a.push({type:ln.Shape,globalAlpha:this.backgroundOpacity,position:g,isTrimmed:!0,timelineRow:1,startTime:this.timelineOffsetSeconds+t,endTime:this.timelineOffsetSeconds+t+d,background:this.fontBackgroundColor,id:m,shapeType:"rectangle",stroke:"rgba(-255,-255,-255,0)",lineWidth:"0%"}),a.push({type:ln.Text,startTime:this.timelineOffsetSeconds+t,endTime:this.timelineOffsetSeconds+t+d,id:c,text:e||s,backgroundColor:"rgba(-255,-255,-255,0)",color:"#FFFFFF",fontFamily:this.fontFamily,timelineRow:0,isTrimmed:!0,source:"pastedLink",textShadow:"transparent",position:h,textAlign:"left",animation:{outro:[],intro:[p],constant:[]},globalAlpha:1,lineHeight:1.15,fontWeight:"bold"}),r.push(this.getVisualLayer({keyword:u.keyword||this.outline.video_keyword,startTime:this.timelineOffsetSeconds+t,endTime:this.timelineOffsetSeconds+t+d,isVideoEligible:i%2==1})),n.push([c,m]),t+=d,i+=1}this.addTextHighlights(a),r.push(this.getAudioLayer(t));const[s,...l]=await Promise.allSettled([mB({type:"default",fontFamily:this.fontFamily}),...r]);if(this.cancellationSource.cancelled)return;const d=l.map((e=>"rejected"===e.status?null:e.value)).filter((e=>null!==e)),c=[];for(const u of d)if(u.type!==ln.Audio){const[e,t]=zS(u),a=new URL(u.pastedUrl);c.push({type:ln.Text,startTime:e,endTime:t,fontFamily:"Open Sans",text:this.attributionByVideoUrl.get(u.pastedUrl)||a.hostname,color:"#FFFFFF",globalAlpha:.8,position:{x:"10%",width:"88%",y:"3%",height:"2%",rotation:0},isTrimmed:!0,textAlign:"right",timelineRow:3,id:z.v4(),backgroundColor:"rgba(-255,-255,-255,0)",textShadow:"#555555",lineHeight:1.15,fontWeight:"bold"})}m.exports.batch((()=>{for(const t of n){const a=z.v4();e(Mh(t,a,!1,!1)),e(Vh(a,!0,!1))}e({type:"SHOW_STUDIO_CANVAS"}),e(sw(Ei.MP4)),e(B_(this.aspectRatio)),this.updateProjectName(),"video"===this.analyticsType?e(Df({usedGenerateVideo:!0})):e(Df({usedGenerateVideoFromDocument:!0})),o.forEach((t=>{e(Eh(t))})),e(bh({layers:[...d,...c,...a],isUndoable:!0})),IT(this.timelineOffsetSeconds)}))}};let F9=O9;a(F9,"isCorsOk",s.exports.memoize((async e=>{try{const t=new URL(e);if(L9.some((e=>t.hostname.includes(e))))return Promise.resolve(null)}catch(YEe){return Promise.resolve(null)}return new Promise((t=>{const a=new Image,o=setTimeout((()=>t(null)),5e3);a.onload=()=>{clearTimeout(o),t({width:a.width,height:a.height})},a.onerror=()=>{clearTimeout(o),t(null)},a.src=e}))})));const M9=[{key:"1:1",className:"oneOne"},{key:"9:16",className:"nineSixteen"},{key:"16:9",className:"sixteenNine"},{key:"4:5",className:"fourFive"},{key:"5:4",className:"fiveFour"}],U9=[{label:"Classic Dark",className:"classicDark",styles:{backgroundAlpha:.5,backgroundColor:"#000000",fontFamily:"Montserrat",highlightTextColor:"#ffcd1d",textColor:"#ffffff"}},{label:"Classic Light",className:"classicLight",styles:{backgroundAlpha:.7,backgroundColor:"#ffffff",fontFamily:"Montserrat",highlightTextColor:"#0083E2",textColor:"#000000"}},{label:"Highlight",className:"highlight",styles:{backgroundAlpha:1,backgroundColor:"#ffcd1d",fontFamily:"Raleway",highlightTextColor:"#0044aa",textColor:"#000000"}},{label:"Typewriter",className:"typewriter",styles:{backgroundAlpha:1,backgroundColor:"#ffffff",fontFamily:"Roboto Mono",highlightTextColor:"#ff4163",textColor:"#000000"}},{label:"New Leaf",className:"newLeaf",styles:{backgroundAlpha:1,backgroundColor:"#cdeebd",fontFamily:"Raleway",highlightTextColor:"#122609",textColor:"#2d531c"}}],B9="UpsellWarningBlock-module_upsellWarningBlockContainer_wf2ua",W9="UpsellWarningBlock-module_warning_dxw7f",V9="UpsellWarningBlock-module_iconWrapper_t8RBo",j9="UpsellWarningBlock-module_button_3oDiB",G9=({action:e,onPaywallSuccess:t=(()=>{}),warning:a=null,body:o=null,buttonText:n,className:r=""})=>i.createElement("div",{className:`${B9} ${r}`,"data-cy":"upsell-warning-block"},a&&i.createElement("div",{className:W9},i.createElement("div",{className:V9},i.createElement(It,null)),a),i.createElement("span",null,o),n&&i.createElement(m9,{className:j9,action:e,onPaywallSuccess:t,buttonText:n,hasIcon:!0})),H9={wrapper:"GenerateVideo-module_wrapper_gk7EQ",controls:"GenerateVideo-module_controls_c5gdi",controlsSmall:"GenerateVideo-module_controlsSmall_xZqTN",row:"GenerateVideo-module_row_sQ2gC",label:"GenerateVideo-module_label_n7AAw",input:"GenerateVideo-module_input_1HIz3",textarea:"GenerateVideo-module_textarea_lT-Ww",previewWrapper:"GenerateVideo-module_previewWrapper_3uSON",resultsWrapper:"GenerateVideo-module_resultsWrapper_g-MPn",previewHint:"GenerateVideo-module_previewHint_s50uO",previewContainer:"GenerateVideo-module_previewContainer_mbXvn",preview:"GenerateVideo-module_preview_GmJRv",previewBlur:"GenerateVideo-module_previewBlur_TRzUs",previewText:"GenerateVideo-module_previewText_zcEzP",generateContainer:"GenerateVideo-module_generateContainer_zRS-p",generateButton:"GenerateVideo-module_generateButton_1EgyD",disabled:"GenerateVideo-module_disabled_S12ip",loader:"GenerateVideo-module_loader_fBMfs",spin:"GenerateVideo-module_spin_z46x-",darkLoader:"GenerateVideo-module_darkLoader_liVB8",resultsContainer:"GenerateVideo-module_resultsContainer_3upR4",emptyState:"GenerateVideo-module_emptyState_76tfc",upsellContainer:"GenerateVideo-module_upsellContainer_OFciS",examplesWrapper:"GenerateVideo-module_examplesWrapper_Mpgy5",example:"GenerateVideo-module_example_37oHx",oneOne:"GenerateVideo-module_oneOne_ENn5q",nineSixteen:"GenerateVideo-module_nineSixteen_Q260C",sixteenNine:"GenerateVideo-module_sixteenNine_6SOr5",fourFive:"GenerateVideo-module_fourFive_LtwfB",fiveFour:"GenerateVideo-module_fiveFour_fZ-9i",sizeWrapper:"GenerateVideo-module_sizeWrapper_VgzyR",sizeContainer:"GenerateVideo-module_sizeContainer_MuybB",sizePreviewBackground:"GenerateVideo-module_sizePreviewBackground_KxQMg",optionLabel:"GenerateVideo-module_optionLabel_cOexS",sizePreview:"GenerateVideo-module_sizePreview_d6Uiu",textStylesWrapper:"GenerateVideo-module_textStylesWrapper_BkQuI",textStylesContainer:"GenerateVideo-module_textStylesContainer_18t5o",textStylesPreviewBackground:"GenerateVideo-module_textStylesPreviewBackground_1h1Ym",textPreview:"GenerateVideo-module_textPreview_6HsrL",classicDark:"GenerateVideo-module_classicDark_71GEx",highlightedText:"GenerateVideo-module_highlightedText_MvI-5",classicLight:"GenerateVideo-module_classicLight_m-InG",highlight:"GenerateVideo-module_highlight_Gz-RE",typewriter:"GenerateVideo-module_typewriter_iUAid",newLeaf:"GenerateVideo-module_newLeaf_S0gDl",active:"GenerateVideo-module_active_XeDcb"};class z9 extends Error{constructor(e){super(e),this.name="NotJSONError"}}function $9(e){window.outline=e;const t=e.indexOf("{"),a=e.indexOf("["),o=e.lastIndexOf("}"),n=e.lastIndexOf("]");if(-1===t||-1===a)throw new z9(e);const r=Math.min(t,a),i=Math.max(o,n);let s=e.slice(r);return s=s.slice(0,i-r+1),s.startsWith("{")||(s=`{ "slides": ${s} }`),s=s.replace(/"$/gm,'",'),s=s.replace(/,(?!\s*?[{["'\w])/g,""),JSON.parse(s)}async function K9(e){try{return await hu(`/api/v2/ai/jobs/${e}`)}catch(YEe){return console.error(YEe),null}}async function Y9(e,t){const a=await async function(e){try{const t=await hu("/api/v2/ai/generate-video",{params:{topic:e}});return t.succeeded?(Eu("generate_video",{body:{topic:e,id:t.id}}).catch((e=>{console.error(e)})),t.id):(console.error(t.message),null)}catch(YEe){return console.error(YEe),null}}(e);if(!a)return null;let o=0;for(;;){if(t.cancelled)return null;const e=await K9(a);if(t.cancelled)return null;if(!e)return null;if(o>30)throw new z9("Getting a response is taking longer than expected. Please try again later.");if("complete"===e.status)return $9(e.outline);if("error"===e.status)throw new z9(e.error);o+=1,await new Promise((e=>setTimeout(e,4e3)))}}async function q9(e){const{state:t,dispatch:a}=tn(),o=nd(t);if(o)try{const t=await fu(`/api/v2/teams/${o._id}/ai-feature-usage/${e}`);if(!t)return;if(!t.updated)return;a(function(e){return{type:"INCREMENT_AI_USAGE",feature:e}}(e))}catch(YEe){}}const X9=5,J9=[{query:"Michael Jordan"},{query:"how to cook broccoli"},{query:"starting a business"},{query:"hiking in Patagonia"}],Q9=({setLoading:e,onClose:t,setCancelFn:a,enforceSignIn:o})=>{const n=tr((e=>e.studioLocal.ai.videoGeneratorPrompt||"")),s=m.exports.useDispatch(),[l,d]=r.exports.useState(M9[0]),[c,u]=r.exports.useState(U9[0]),p=XD(Ps.GENERATE_VIDEO),h=HU(),g=tr((e=>{var t;return null==(t=e.teams.allTeams.find((t=>t._id===e.teams.selectedTeamId)))?void 0:t.limits.generatedVideos}))||0,y=r.exports.useCallback((async()=>{e(!0);try{vc("Started Video Generator",{Style:c.label,"Aspect Ratio":l.key,Topic:n});const o=new kT;a((()=>()=>o.cancel()));const r=await Y9(n,o);if(o.cancelled)return void e(!1);const i=new F9(n,{backgroundOpacity:c.styles.backgroundAlpha,fontBackgroundColor:c.styles.backgroundColor,fontDefaultColor:c.styles.textColor,fontFamily:c.styles.fontFamily,fontHighlightColor:c.styles.highlightTextColor,aspectRatio:l.key});a((()=>()=>i.cancel())),window.videoGenerator=i;try{await i.generate(r),q9("generatedVideos"),t()}catch(YEe){const{message:t}=xu(YEe);vc("Video Generator Failed",{Error:t}),Iu({description:"Failed to generate video.",error:YEe})}}catch(YEe){if(YEe instanceof z9)s(Su({type:"warning",description:YEe.message}));else{const{message:t}=xu(YEe);vc("Video Generator Failed",{Error:t}),Iu({description:"Received an unexpected GPT response.",error:YEe})}}e(!1)}),[e,c,l.key,n,t,s,a]),f=h((()=>y()),{action:Rs.GENERATE_VIDEO,if:g>=5}),E=()=>{if(p)return null;const e=Math.max(5-g,0);if(e>3)return null;const t=`You can generate ${Jd(e,"more video")} for free this month. Upgrade to generate even more.`;return i.createElement("div",{className:H9.upsellContainer},i.createElement(G9,{warning:t,action:Rs.GENERATE_VIDEO,buttonText:"Upgrade"}))};return i.createElement("div",{className:H9.wrapper},i.createElement("div",{className:H9.controls},i.createElement("div",{className:H9.row},i.createElement("div",{className:H9.label},"Make a video about:"),i.createElement("input",{className:H9.input,autoFocus:!0,placeholder:"What would you like to create a video about?",value:n,onChange:e=>s(Yg({videoGeneratorPrompt:e.target.value}))})),i.createElement("div",{className:H9.row},i.createElement("div",{className:H9.label},"Try an example"),i.createElement("div",{className:H9.examplesWrapper},J9.map((({query:e})=>i.createElement("div",{className:H9.example,key:e,onClick:()=>{s(Yg({videoGeneratorPrompt:e}))}},e))))),i.createElement("div",{className:H9.row},i.createElement("div",{className:H9.label},"Size"),i.createElement("div",{className:H9.sizeWrapper},M9.map((e=>{const{key:t,className:a}=e;let o=H9.sizePreviewBackground;return t===l.key&&(o+=` ${H9.active}`),i.createElement("div",{className:H9.sizeContainer,key:t,onClick:()=>{d(e)}},i.createElement("div",{className:o},i.createElement("div",{className:`${H9[a]} ${H9.sizePreview}`})),i.createElement("div",{className:H9.optionLabel},t))})))),i.createElement("div",{className:H9.row},i.createElement("div",{className:H9.label},"Text Style"),i.createElement("div",{className:H9.textStylesWrapper},U9.map((e=>{const{label:t,className:a}=e;let o=H9.textStylesPreviewBackground;return t===c.label&&(o+=` ${H9.active}`),i.createElement("div",{className:H9.textStylesContainer,key:a,onClick:()=>u(e)},i.createElement("div",{className:o},i.createElement("div",{className:`${H9[a]} ${H9.textPreview}`},"Your"," ",i.createElement("span",{className:H9.highlightedText},"AI-generated")," ","captions here")),i.createElement("div",{className:H9.optionLabel},t))}))))),i.createElement("div",{className:H9.previewWrapper},i.createElement("div",{className:H9.previewHint},"This is just a preview of the size and style of your video. Click Generate Video to start the creation process."),(()=>{let e={width:"80%",aspectRatio:"1/1"};switch(l.key){case"9:16":e={width:"55%",aspectRatio:"9/16"};break;case"16:9":e={width:"100%",aspectRatio:"16/9"};break;case"4:5":e={width:"80%",aspectRatio:"4/5"};break;case"5:4":e={width:"100%",aspectRatio:"5/4"}}return i.createElement("div",{className:H9.previewContainer},i.createElement("div",{className:H9.preview,style:e},i.createElement("div",{className:H9.previewBlur},i.createElement("div",{className:`${H9.previewText} ${H9[c.className]}`},"Kapwing AI will"," ",i.createElement("span",{className:H9.highlightedText},"generate a ",l.key," video")," ","about ",i.createElement("span",null,oc(n)||"anything you'd like!")))))})(),n?i.createElement("div",{className:H9.generateContainer},E(),i.createElement("div",{className:H9.generateButton,onClick:o(f)},"Generate Video")):i.createElement("div",{className:H9.generateContainer},E(),i.createElement("div",{className:`${H9.generateButton} ${H9.disabled}`},"Generate Video"))))};class Z9 extends Error{constructor(e){super(e),this.name="SafetyError"}}const e8=async e=>{const t=await hu(`/api/v2/generate/images?prompt=${e}`);if(t.error&&"invalid_request_error"===t.error.type)throw new Z9(t.error.message);return t.data},t8={wrapper:"Images-module_wrapper_tHC8u",controls:"Images-module_controls_CIyAd",controlsSmall:"Images-module_controlsSmall_y5156",row:"Images-module_row_cnENZ",label:"Images-module_label_zGJ-F",input:"Images-module_input_wKuIT",textarea:"Images-module_textarea_MO8pQ",previewWrapper:"Images-module_previewWrapper_rqNCB",resultsWrapper:"Images-module_resultsWrapper_ihxgK",previewHint:"Images-module_previewHint_iIkYr",previewContainer:"Images-module_previewContainer_Mbkey",preview:"Images-module_preview_ZYfXS",previewBlur:"Images-module_previewBlur_P7T2I",previewText:"Images-module_previewText_YUOGz",generateContainer:"Images-module_generateContainer_4Id7R",generateButton:"Images-module_generateButton_xBu2t",disabled:"Images-module_disabled_RnaWO",loader:"Images-module_loader_wrosF",spin:"Images-module_spin_rbQO2",darkLoader:"Images-module_darkLoader_ZmcWJ",resultsContainer:"Images-module_resultsContainer_fXENF",emptyState:"Images-module_emptyState_hR47k",upsellContainer:"Images-module_upsellContainer_Oqa2q",examplesWrapper:"Images-module_examplesWrapper_BADqw",example:"Images-module_example_9Huo4",sizeWrapper:"Images-module_sizeWrapper_8I1qm",sizeContainer:"Images-module_sizeContainer_RNCYe",sizePreviewBackground:"Images-module_sizePreviewBackground_DncUa",optionLabel:"Images-module_optionLabel_WhkUx",sizePreview:"Images-module_sizePreview_DSzO4",oneOne:"Images-module_oneOne_uZTba",nineSixteen:"Images-module_nineSixteen_INEif",sixteenNine:"Images-module_sixteenNine_eCdEa",fourFive:"Images-module_fourFive_e-R-p",fiveFour:"Images-module_fiveFour_y8SEu",active:"Images-module_active_DyGda",imagesWrapper:"Images-module_imagesWrapper_FsJDK",imagesContainer:"Images-module_imagesContainer_a2nti",instructions:"Images-module_instructions_1qpdj",loadingInstructionsText:"Images-module_loadingInstructionsText_yivSh",imageContainer:"Images-module_imageContainer_ASzET",image:"Images-module_image_qPHzS",loadingImageContainer:"Images-module_loadingImageContainer_bTajc",loadingImage:"Images-module_loadingImage_cqmBU",shimmer:"Images-module_shimmer_u-bvu"},a8=[{label:"lake sunset",query:"Ultrawide, lake of Annecy with golden ratio style, 4K, foreground is prairie, light is Golden hour, sky with red Clouds, ultrarealistic, CinémaScope, ultra wide format, ratio 16/9, 1/1000 sec, maximum resolution, Sharp details"},{label:"race car",query:"Synthwave halloween formula 1 car racing on a night road in Singapore"},{label:"modern home",query:"hyper realistic photo of a high end futuristic single-level house where walls are made of windows, light coming through the window, mid century modern style, cinematic lighting"}],o8=({onClose:e,setCancelFn:t,enforceSignIn:a})=>{const o=m.exports.useDispatch(),{topic:n,numGeneratedImages:s,images:l=[]}=tr((e=>{var t;return{topic:e.studioLocal.ai.imageGeneratorPrompt||"",numGeneratedImages:(null==(t=e.teams.allTeams.find((t=>t._id===e.teams.selectedTeamId)))?void 0:t.limits.generatedImages)||0,images:e.studioLocal.ai.imageGeneratorResults}}),ar),[d,c]=r.exports.useState(!1),[u,p]=r.exports.useState(!1),h=HU(),g=XD(Ps.GENERATE_IMAGES),y=r.exports.useCallback((async()=>{c(!0);try{vc("Started Image Generator",{Topic:n});const e=new kT;t((()=>()=>e.cancel()));const a=await e8(n);if(q9("generatedImages"),e.cancelled)return void c(!1);a.length?o(Yg({imageGeneratorResults:a.map((e=>e.url))})):o(Su({type:"warning",description:"Unable to generate image."}))}catch(YEe){if(console.error({e:YEe}),YEe instanceof Z9)o(Su({type:"warning",description:YEe.message}));else{const{message:t}=xu(YEe);vc("Image Generator Failed",{Error:t}),Iu({description:"Received an unexpected Dall-E response.",error:YEe})}}c(!1)}),[n,t,o]),f=h((()=>y()),{action:Rs.GENERATE_IMAGES,if:s>=5});return i.createElement("div",{className:t8.wrapper},i.createElement("div",{className:t8.controlsSmall},i.createElement("div",null,i.createElement("div",{className:t8.row},i.createElement("div",{className:t8.label},"Topic"),i.createElement("textarea",{className:t8.textarea,rows:4,autoFocus:!0,placeholder:"Create images about...",value:n,onChange:e=>o(Yg({imageGeneratorPrompt:e.target.value}))})),i.createElement("div",{className:t8.row},i.createElement("div",{className:t8.label},"Try an example"),i.createElement("div",{className:t8.examplesWrapper},a8.map((({label:e,query:t})=>i.createElement("div",{className:t8.example,key:e,onClick:()=>{o(Yg({imageGeneratorPrompt:t}))}},e)))))),(()=>{const e=d||!n;return i.createElement("div",{className:t8.generateContainer},(()=>{if(g)return null;const e=Math.max(5-s,0);if(e>3)return null;const t=`You can run ${Jd(e,"more job")} for free this month. Upgrade for unrestricted generations.`;return i.createElement("div",{className:t8.upsellContainer},i.createElement(G9,{warning:t,action:Rs.GENERATE_IMAGES,buttonText:"Upgrade"}))})(),i.createElement("button",{type:"button",className:[t8.generateButton,e?t8.disabled:""].join(" "),disabled:e,onClick:a(f)},d?"Generating Images...":"Generate Images"))})()),i.createElement("div",{className:t8.resultsWrapper},d?i.createElement("div",{className:t8.imagesWrapper},i.createElement("div",{className:t8.imagesContainer},i.createElement("div",{className:t8.instructions},i.createElement("div",{className:t8.loadingInstructionsText},"Generating images ... please wait")),[0,1,2,3].map((e=>i.createElement("div",{className:t8.loadingImageContainer,key:e},i.createElement("div",{className:t8.loadingImage})))))):l&&l.length?i.createElement("div",{className:t8.imagesWrapper},i.createElement("div",{className:t8.imagesContainer},i.createElement("div",{className:t8.instructions},u?i.createElement(i.Fragment,null,i.createElement("div",{className:t8.darkLoader}),i.createElement("div",{className:t8.loadingInstructionsText},"Adding image to project...")):i.createElement("div",{className:t8.loadingInstructionsText},"Click on an image to add it to your Kapwing project.")),l.map((t=>i.createElement("div",{className:t8.imageContainer,onClick:()=>{(async t=>{p(!0);const a={height:1024,width:1024,name:n};await _z({url:t,options:{layerProperties:a}}),o(Df({usedGenerateImage:!0})),p(!1),e()})(t)},key:t},i.createElement("img",{src:t,className:t8.image,alt:n})))))):i.createElement("div",{className:t8.resultsContainer},i.createElement("div",{className:t8.emptyState},"Type a prompt to generate, and your results will appear here once the generation is complete."))))},n8=class{constructor(e){a(this,"data",null),a(this,"topic"),a(this,"hydratedMemeSubscribers",[]),a(this,"_hydratedMemes",null),a(this,"generate",(async e=>{if(!n8.isValidMemes(e))throw new Error("Invalid meme");return this.data=e,this.main()})),a(this,"subscribe",(e=>{this._hydratedMemes?e(this._hydratedMemes):this.hydratedMemeSubscribers.push(e)})),this.topic=e}set hydratedMemes(e){this._hydratedMemes=e;for(const t of this.hydratedMemeSubscribers)t(e)}static async getImageLayer({url:e,width:t,height:a}){const{dispatch:o}=tn(),{asset:n,cmlFile:r}=await VG(e);HH(n,r);const i=n.bucket_name&&n.url||e,s=await XH(i,{source:n.bucket_name?"upload":"pastedLink",position:{x:"0%",y:"20%",width:"100%",height:"80%",rotation:0},crop:{x:0,y:0,width:100,height:100},pastedUrl:e,asset_id:n._id,volume:0},{mediaInfo:{type:ln.Image,width:t,height:a}});return o(Nr({assetId:n._id,mediaCacheId:z.v4()})),o(Df({usedGenerateMeme:!0})),s}async getImageLayerUrl(e){const t=e.replace(/-/g," ").trim(),a=await vz(`${t} blank meme template`);for(const n of a.google){const e=await F9.isCorsOk(n.url);if(e)return{url:n.url,width:e.width,height:e.height}}const o=a.google[0];return{url:(null==o?void 0:o.url)||"",width:500,height:500}}async main(){if(!this.data)return;const e=this.data.memes.map((async e=>{const t=await this.getImageLayerUrl(e.keyword);return{...e,...t}}));this.hydratedMemes={memes:await Promise.all(e)}}};let r8=n8;a(r8,"isValidMemes",(e=>{if(!e)return!1;if(!("memes"in e))return!1;for(const t of e.memes){if(!("text"in t))return!1;if(!("keyword"in t))return!1;if("string"!=typeof t.text)return!1;if("string"!=typeof t.keyword)return!1}return!0})),a(r8,"addMemeToProject",(async e=>{const{dispatch:t}=tn(),{width:a,height:o}=e,n=1.2*o,r=Math.min(a,n),i=`${a/r}:${n/r}`,s=await n8.getImageLayer({url:e.url,width:a,height:e.height}),l={id:z.v4(),backgroundColor:"rgba(-255,-255,-255,0)",color:"#000000",fontFamily:"Arial",globalAlpha:1,lineHeight:1.15,text:e.text,textAlign:"left",textShadow:"transparent",type:ln.Text,fontWeight:"normal",position:{x:"3%",y:"1%",width:"94%",height:"19%",rotation:0}};m.exports.batch((()=>{t({type:"SHOW_STUDIO_CANVAS"}),t(B_(i)),t(Df({usedGenerateMeme:!0})),t(bh({layers:[s,l]}))}))}));const i8={wrapper:"Memes-module_wrapper_jnqKC",controls:"Memes-module_controls_7-P-E",controlsSmall:"Memes-module_controlsSmall_FZS-R",row:"Memes-module_row_5evlo",label:"Memes-module_label_ZOX87",input:"Memes-module_input_RfhpL",textarea:"Memes-module_textarea_Si5Mx",previewWrapper:"Memes-module_previewWrapper_BvtwV",resultsWrapper:"Memes-module_resultsWrapper_dmP2Z",previewHint:"Memes-module_previewHint_SAsW0",previewContainer:"Memes-module_previewContainer_HOuct",preview:"Memes-module_preview_5Dp3L",previewBlur:"Memes-module_previewBlur_UmN8s",previewText:"Memes-module_previewText_M92vn",generateContainer:"Memes-module_generateContainer_MKu47",generateButton:"Memes-module_generateButton_G76-s",disabled:"Memes-module_disabled_YQNzu",loader:"Memes-module_loader_XBBOQ",spin:"Memes-module_spin_hjVfR",darkLoader:"Memes-module_darkLoader_asYP4",resultsContainer:"Memes-module_resultsContainer_WOjkc",emptyState:"Memes-module_emptyState_9jE87",upsellContainer:"Memes-module_upsellContainer_CWMIm",examplesWrapper:"Memes-module_examplesWrapper_Xk4hs",example:"Memes-module_example_2qVt0",typeWrapper:"Memes-module_typeWrapper_HXDAg",typeContainer:"Memes-module_typeContainer_8Vo1O",typePreviewBackground:"Memes-module_typePreviewBackground_nsBui",type:"Memes-module_type_Ij3rA",optionLabel:"Memes-module_optionLabel_iWTnq",typePreview:"Memes-module_typePreview_TBz1k",active:"Memes-module_active_h4JSW",imagesWrapper:"Memes-module_imagesWrapper_At80E",memeWrapper:"Memes-module_memeWrapper_eTIOy",meme:"Memes-module_meme_l7nFy",memeText:"Memes-module_memeText_3Lozg",loadingInstructionsText:"Memes-module_loadingInstructionsText_iS-db",imagesContainer:"Memes-module_imagesContainer_JfULW",imageContainer:"Memes-module_imageContainer_khQib",image:"Memes-module_image_7UmAP",instructions:"Memes-module_instructions_UcEyl",loadingImageContainer:"Memes-module_loadingImageContainer_n005x",loadingImage:"Memes-module_loadingImage_YAJRA",shimmer:"Memes-module_shimmer_7HKKI",form:"Memes-module_form_u-Zlr"};function s8(e){const t=e.indexOf("{"),a=e.indexOf("["),o=e.lastIndexOf("}"),n=e.lastIndexOf("]");if(-1===t||-1===a)throw new z9(e);const r=Math.min(t,a),i=Math.max(o,n);let s=e.slice(r);return s=s.slice(0,i-r+1),s.startsWith("{")||(s=`{ "memes": ${s} }`),s=s.replace(/"$/gm,'",'),s=s.replace(/,(?!\s*?[{["'\w])/g,""),JSON.parse(s)}async function l8(e){try{return await hu(`/api/v2/ai/jobs/${e}`)}catch(YEe){return console.error(YEe),null}}async function d8(e,t){const a=await async function(e){try{const t=await hu("/api/v2/ai/generate-meme",{params:{topic:e}});return t.succeeded?(Eu("generate_meme",{body:{topic:e,id:t.id}}).catch((e=>{console.error(e)})),t.id):(console.error(t.message),null)}catch(YEe){return console.error(YEe),null}}(e);if(!a)return null;let o=0;for(;;){if(t.cancelled)return null;const e=await l8(a);if(t.cancelled)return null;if(!e)return null;if(o>30)throw new z9("Getting a response is taking longer than expected. Please try again later.");if("complete"===e.status)return s8(e.memes);if("error"===e.status)throw new z9(e.error);o+=1,await new Promise((e=>setTimeout(e,4e3)))}}const c8=[{query:"studying"},{query:"watching tv"},{query:"basketball"}],u8=({onClose:e,setCancelFn:t,enforceSignIn:a})=>{const o=m.exports.useDispatch(),{topic:n,numMemesGenerated:s,previewMemes:l=[]}=tr((e=>{var t;return{topic:e.studioLocal.ai.memeGeneratorPrompt||"",numMemesGenerated:(null==(t=e.teams.allTeams.find((t=>t._id===e.teams.selectedTeamId)))?void 0:t.limits.generatedMemes)||0,previewMemes:e.studioLocal.ai.memeGeneratorResults}}),ar),[d,c]=r.exports.useState(!1),u=HU(),p=XD(Ps.GENERATE_MEME),[h,g]=r.exports.useState(!1),y=r.exports.useCallback((async()=>{c(!0);try{const e=new kT;t((()=>()=>e.cancel())),vc("Started Meme Generator",{Topic:n});const a=await d8(n,e);if(e.cancelled)return void c(!1);const r=new r8(n);r.subscribe((e=>{o(Yg({memeGeneratorResults:e.memes}))})),await r.generate(a),q9("generatedMemes")}catch(YEe){console.error({e:YEe}),Iu({description:"Received an unexpected GPT response.",error:YEe})}c(!1)}),[t,n,o]);return i.createElement("div",{className:i8.wrapper},i.createElement("div",{className:i8.controlsSmall},i.createElement("form",{className:i8.form,onSubmit:e=>{e.preventDefault();const t=u((()=>y()),{action:Rs.GENERARATE_MEME,if:s>=5});return a(t)()}},i.createElement("div",null,i.createElement("div",{className:i8.row},i.createElement("div",{className:i8.label},"Make memes about:"),i.createElement("input",{className:i8.input,autoFocus:!0,placeholder:"Generate memes about...",value:n,onChange:e=>o(Yg({memeGeneratorPrompt:e.target.value}))})),i.createElement("div",{className:i8.row},i.createElement("div",{className:i8.label},"Try an example"),i.createElement("div",{className:i8.examplesWrapper},c8.map((({query:e})=>i.createElement("div",{className:i8.example,key:e,onClick:()=>{o(Yg({memeGeneratorPrompt:e}))}},e)))))),(()=>{const e=d?"Generating memes ...":l.length?"Generate more memes":"Generate memes",t=d||!n;return i.createElement("div",{className:i8.generateContainer},(()=>{if(p)return null;const e=Math.max(5-s,0);if(e>3)return null;const t=`You can run ${Jd(e,"more job")} for free this month. Upgrade for unrestricted generations.`;return i.createElement("div",{className:i8.upsellContainer},i.createElement(G9,{warning:t,action:Rs.GENERARATE_MEME,buttonText:"Upgrade"}))})(),i.createElement("button",{className:[i8.generateButton,t&&i8.disabled].join(" "),type:"submit",disabled:t},e))})())),i.createElement("div",{className:i8.resultsWrapper},d?i.createElement("div",{className:i8.imagesWrapper},i.createElement("div",{className:i8.imagesContainer},i.createElement("div",{className:i8.instructions},i.createElement("div",{className:i8.loadingInstructionsText},"Generating memes ... please wait")),[0,1,2,3].map((e=>i.createElement("div",{className:i8.loadingImageContainer,key:e},i.createElement("div",{className:i8.loadingImage})))))):l&&l.length?i.createElement("div",{className:i8.imagesWrapper},i.createElement("div",{className:i8.imagesContainer},i.createElement("div",{className:i8.instructions},h?i.createElement(i.Fragment,null,i.createElement("div",{className:i8.darkLoader}),i.createElement("div",{className:i8.loadingInstructionsText},"Adding meme to project...")):i.createElement("div",{className:i8.loadingInstructionsText},"Click on an meme to add it to your Kapwing project.")),l.map((t=>i.createElement("div",{className:i8.memeWrapper,key:t.text,onClick:()=>{g(!0),r8.addMemeToProject(t).then((()=>{g(!1),e()}))}},i.createElement("div",{className:i8.meme},i.createElement("div",{className:i8.memeText},t.text),i.createElement("div",{className:i8.imageContainer},i.createElement("img",{src:t.url,className:i8.image,alt:t.keyword})))))))):i.createElement("div",{className:i8.resultsContainer},i.createElement("div",{className:i8.emptyState},"Type a prompt to generate, and your memes will appear here once the generation is complete."))))},m8={wrapper:"Script-module_wrapper_VdaDT",controls:"Script-module_controls_X8pSC",controlsSmall:"Script-module_controlsSmall_Fbh9e",row:"Script-module_row_rsLcI",label:"Script-module_label_ldqZE",input:"Script-module_input_UYuor",textarea:"Script-module_textarea_uZ4DC",previewWrapper:"Script-module_previewWrapper_QxKX5",resultsWrapper:"Script-module_resultsWrapper_DWvlc",previewHint:"Script-module_previewHint_PXLbX",previewContainer:"Script-module_previewContainer_r9jV0",preview:"Script-module_preview_L7wbR",previewBlur:"Script-module_previewBlur_WosJn",previewText:"Script-module_previewText_xWYPr",generateContainer:"Script-module_generateContainer_ANky8",generateButton:"Script-module_generateButton_XOh4B",disabled:"Script-module_disabled_dXtGV",loader:"Script-module_loader_-1Crq",spin:"Script-module_spin_bqoAj",darkLoader:"Script-module_darkLoader_H2Q6p",resultsContainer:"Script-module_resultsContainer_-Cead",emptyState:"Script-module_emptyState_pBmbF",upsellContainer:"Script-module_upsellContainer_oWODb",examplesWrapper:"Script-module_examplesWrapper_P1Nwq",example:"Script-module_example_ly-UB",description:"Script-module_description_HsIpq",typeWrapper:"Script-module_typeWrapper_FYjFg",typeContainer:"Script-module_typeContainer_8xzK2",typePreviewBackground:"Script-module_typePreviewBackground_6d0-4",type:"Script-module_type_uIyYZ",optionLabel:"Script-module_optionLabel_KkY7m",typePreview:"Script-module_typePreview_y1LEM",active:"Script-module_active_PVg-N",optionIcon:"Script-module_optionIcon_TEkLN",script:"Script-module_script_oeAeM",scriptContainer:"Script-module_scriptContainer_tc--Z",copyScript:"Script-module_copyScript_b-0qq"};async function p8(e){try{return await hu(`/api/v2/ai/jobs/${e}`)}catch(YEe){return console.error(YEe),null}}async function h8(e,t,a,o){const n=await async function(e,t,a){try{const o=await hu("/api/v2/ai/generate-script",{params:{idea:e,platform:t,duration:a}});return o.succeeded?(Eu("generate_script",{body:{id:o.id}}).catch((e=>{console.error(e)})),o.id):(console.error(o.message),null)}catch(YEe){return console.error(YEe),null}}(e,t,a);if(!n)throw new Error("Failed to initialize script generation");let r=0;for(;;){if(o.cancelled)return null;const e=await p8(n);if(o.cancelled)return null;if(!e)return null;if(r>30)throw new Error("Getting a response is taking longer than expected.");if("complete"===e.status)return e.script;if("error"===e.status)throw new Error(e.error);r+=1,await new Promise((e=>setTimeout(e,4e3)))}}const g8=[{query:"weird facts"},{query:"lunch recipes"},{query:"summer outfits"}],y8=[{seconds:15,label:"15s"},{seconds:30,label:"30s"},{label:"1m",seconds:60},{label:"2m",seconds:120},{label:"5m",seconds:300}],f8=[{name:"TikTok",icon:i.createElement(xt,null)},{name:"YouTube",icon:i.createElement(kt,null)},{name:"Reels",icon:i.createElement(Ct,null)},{name:"Shorts",icon:i.createElement(At,null)}],E8=({setCancelFn:e,enforceSignIn:t})=>{const a=m.exports.useDispatch(),{topic:o,script:n}=tr((e=>({topic:e.studioLocal.ai.scriptGeneratorPrompt||"",script:e.studioLocal.ai.scriptGeneratorResults})),ar),[s,l]=r.exports.useState(30),[d,c]=r.exports.useState(f8[0].name),[u,p]=r.exports.useState(!1),h=HU(),g=XD(Ps.GENERATE_SCRIPT),y=tr((e=>{var t;return null==(t=e.teams.allTeams.find((t=>t._id===e.teams.selectedTeamId)))?void 0:t.limits.generatedScripts}))||0,f=r.exports.useCallback((async()=>{p(!0);try{vc("Started Script Generator",{Topic:o,Platform:d,Duration:s});const t=new kT;e((()=>()=>t.cancel()));const n=await h8(o,d,s,t);if(t.cancelled)return;if(!n)return;a(Yg({scriptGeneratorResults:n})),q9("generatedScripts")}catch(YEe){console.error({e:YEe}),Iu({description:"Received an unexpected GPT response.",error:YEe})}p(!1)}),[a,s,d,e,o]),E=h((()=>f()),{action:Rs.GENERATE_SCRIPT,if:y>=5});return i.createElement("div",{className:m8.wrapper},i.createElement("div",{className:m8.controlsSmall},i.createElement("div",null,i.createElement("div",{className:m8.row},i.createElement("div",{className:m8.label},"Make a video script about:"),i.createElement("textarea",{className:m8.textarea,autoFocus:!0,placeholder:"Generate a video script about...",value:o,onChange:e=>a(Yg({scriptGeneratorPrompt:e.target.value}))})),i.createElement("div",{className:m8.row},i.createElement("div",{className:m8.label},"Try an example"),i.createElement("div",{className:m8.examplesWrapper},g8.map((({query:e})=>i.createElement("div",{className:m8.example,key:e,onClick:()=>{a(Yg({scriptGeneratorPrompt:e}))}},e))))),i.createElement("div",{className:m8.row},i.createElement("div",{className:m8.label},"Approximate Script Duration"),i.createElement("div",{className:m8.typeWrapper},y8.map((({label:e,seconds:t})=>{let a=m8.typePreviewBackground;return t===s&&(a+=` ${m8.active}`),i.createElement("div",{className:m8.typeContainer,key:t,onClick:()=>{l(t)}},i.createElement("div",{className:a},i.createElement("div",{className:m8.type},e)))})))),i.createElement("div",{className:m8.row},i.createElement("div",{className:m8.label},"Target platform"),i.createElement("div",{className:m8.typeWrapper},f8.map((({name:e,icon:t})=>{let a=m8.typePreviewBackground;return e===d&&(a+=` ${m8.active}`),i.createElement("div",{className:m8.typeContainer,key:e,onClick:()=>{c(e)}},i.createElement("div",{className:a},i.createElement("div",{className:m8.optionIcon},t)),i.createElement("div",{className:m8.optionLabel},e))}))))),(()=>{const e=!o||u;return i.createElement("div",{className:m8.generateContainer},(()=>{if(g)return null;const e=Math.max(5-y,0);if(e>3)return null;const t=`You can create ${Jd(e,"more script")} for free this month. Upgrade for unrestricted generations.`;return i.createElement("div",{className:m8.upsellContainer},i.createElement(G9,{warning:t,action:Rs.GENERARATE_MEME,buttonText:"Upgrade"}))})(),i.createElement("button",{type:"button",className:[m8.generateButton,e&&m8.disabled].join(" "),disabled:e,onClick:t(E)},u?"Generating script...":"Generate script"))})()),i.createElement("div",{className:m8.resultsWrapper},n?i.createElement("div",{className:m8.scriptContainer},i.createElement("button",{className:m8.copyScript,type:"button",onClick:()=>{navigator.clipboard.writeText(n).then((()=>{a(Su({type:"success",description:"Copied your script to clipboard!"}))})).catch((()=>{a(Su({type:"warning",description:"Failed to copy your script to clipboard."}))}))}},"Copy script to clipboard"),i.createElement("div",{className:m8.script},n)):i.createElement("div",{className:m8.resultsContainer},i.createElement("div",{className:m8.emptyState},"Type a prompt to generate, and your script will appear here once the generation is complete."))))},v8="ComingSoon-module_wrapper_CwChq",w8="ComingSoon-module_content_EyxdO",b8="ComingSoon-module_splash_vL-M3",_8="ComingSoon-module_image_9-vch",T8="ComingSoon-module_title_W8JPi",S8="ComingSoon-module_description_XV4rF",I8="ComingSoon-module_button_vqtie",x8="ComingSoon-module_icon_XrBHM",k8=({featureName:e})=>i.createElement("div",{className:v8},i.createElement("div",{className:w8},i.createElement("div",{className:b8},i.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/ckd-kthink-1.webp",alt:"Coming Soon",className:_8})),i.createElement("div",{className:T8},"Coming Soon"),i.createElement("div",{className:S8},i.createElement("span",null,e||"This feature")," is coming soon. Want early access?"),i.createElement("a",{href:"https://www.kapwing.com/ai",target:"_blank",rel:"noopener noreferrer",className:I8},"Join the waitlist ",i.createElement(Nt,{className:x8})))),C8={wrapper:"Document-module_wrapper_-C4XK",controls:"Document-module_controls_n41xD",controlsSmall:"Document-module_controlsSmall_-VDKr",row:"Document-module_row_XHvHn",label:"Document-module_label_tK31f",input:"Document-module_input_oh3qz",textarea:"Document-module_textarea_5teTd",previewWrapper:"Document-module_previewWrapper_ajYam",resultsWrapper:"Document-module_resultsWrapper_NnHd3",previewHint:"Document-module_previewHint_2gQlm",previewContainer:"Document-module_previewContainer_R4An6",preview:"Document-module_preview_2OwFC",previewBlur:"Document-module_previewBlur_zo97p",previewText:"Document-module_previewText_NAyw4",generateContainer:"Document-module_generateContainer_gIrvZ",generateButton:"Document-module_generateButton_qs98B",disabled:"Document-module_disabled_dKCyU",loader:"Document-module_loader_YzJBX",spin:"Document-module_spin_QslJ-",darkLoader:"Document-module_darkLoader_fQt77",resultsContainer:"Document-module_resultsContainer_bHxni",emptyState:"Document-module_emptyState_tohp3",upsellContainer:"Document-module_upsellContainer_HJLeK",examplesWrapper:"Document-module_examplesWrapper_OAsVP",example:"Document-module_example_GzG9p",oneOne:"Document-module_oneOne_4D2qA",nineSixteen:"Document-module_nineSixteen_H3Bgi",sixteenNine:"Document-module_sixteenNine_NuiJZ",fourFive:"Document-module_fourFive_3GqtH",fiveFour:"Document-module_fiveFour_tsP0y",sizeWrapper:"Document-module_sizeWrapper_CMRli",sizeContainer:"Document-module_sizeContainer_E3-gQ",sizePreviewBackground:"Document-module_sizePreviewBackground_7yNue",optionLabel:"Document-module_optionLabel_h6CkP",sizePreview:"Document-module_sizePreview_KwMvi",textStylesWrapper:"Document-module_textStylesWrapper_DE4Wi",textStylesContainer:"Document-module_textStylesContainer_mj6kM",textStylesPreviewBackground:"Document-module_textStylesPreviewBackground_re8-G",textPreview:"Document-module_textPreview_-EUfX",classicDark:"Document-module_classicDark_Qk7NO",highlightedText:"Document-module_highlightedText_vAPnG",classicLight:"Document-module_classicLight_x2NF2",highlight:"Document-module_highlight_E8H0X",typewriter:"Document-module_typewriter_g6IJa",newLeaf:"Document-module_newLeaf_M07QC",active:"Document-module_active_xNNep"},A8=({setLoading:e,onClose:t,setCancelFn:a,enforceSignIn:o})=>{const n=m.exports.useDispatch(),s=tr((e=>e.studioLocal.ai.documentToVideoPrompt)),[l,d]=r.exports.useState(M9[0]),[c,u]=r.exports.useState(U9[0]),[p,h]=r.exports.useState(!1),g=HU(),y=XD(Ps.GENERATE_DOCUMENT_TO_VIDEO),f=tr((e=>{var t;return null==(t=e.teams.allTeams.find((t=>t._id===e.teams.selectedTeamId)))?void 0:t.limits.generatedDocumentToVideo}))||0,E=r.exports.useCallback((async()=>{if(s&&s.trim()){vc("Started Document to Video Generator",{Style:c.label,"Aspect Ratio":l.key,Document:s.slice(0,40)}),h(!0),e(!0);try{const o=await gu("/api/v1/ai/summarize",{body:{document:s}});if(!o||!o.summary)throw new Error("Received an unexpected GPT response.");const{summary:r}=o;window.summary=r;try{const o=new kT;a((()=>()=>o.cancel()));const n=await Y9(r,o);if(o.cancelled)return h(!1),void e(!1);const i="string"==typeof r?r.slice(0,40):s.slice(0,40),d=new F9(i,{backgroundOpacity:c.styles.backgroundAlpha,fontBackgroundColor:c.styles.backgroundColor,fontDefaultColor:c.styles.textColor,fontFamily:c.styles.fontFamily,fontHighlightColor:c.styles.highlightTextColor,aspectRatio:l.key});a((()=>()=>d.cancel())),d.analyticsType="document",await d.generate(n),q9("generatedDocumentToVideo"),t()}catch(YEe){YEe instanceof z9?n(Su({type:"warning",description:YEe.message})):(console.error({e:YEe}),Iu({description:"Received an unexpected GPT response.",error:YEe}))}}catch(YEe){console.error({e:YEe}),Iu({description:"Could not preprocess your document. Please try again.",error:YEe})}e(!1),h(!1)}else n(Su({type:"warning",description:"Enter your text to convert a document to to video. For best results, use at least 500 characters."}))}),[s,e,n,c,l.key,t,a]),v=g((()=>E()),{action:Rs.GENERATE_DOCUMENT_TO_VIDEO,if:f>=5}),w=()=>{if(y)return null;const e=Math.max(5-f,0);if(e>3)return null;const t=`You can generate ${Jd(e,"more video")} for free this month. Upgrade to generate even more.`;return i.createElement("div",{className:C8.upsellContainer},i.createElement(G9,{warning:t,action:Rs.GENERATE_DOCUMENT_TO_VIDEO,buttonText:"Upgrade"}))};return i.createElement("div",{className:C8.wrapper},i.createElement("div",{className:C8.controls},i.createElement("div",{className:C8.row},i.createElement("div",{className:C8.label},"Topic"),i.createElement("textarea",{className:C8.textarea,rows:20,autoFocus:!0,placeholder:"Copy and paste the contents of your document here, and Kapwing AI will create a video from your document. For best results, use a document with at least 500 characters.",value:s,onChange:e=>n(Yg({documentToVideoPrompt:e.target.value}))})),i.createElement("div",{className:C8.row},i.createElement("div",{className:C8.label},"Size"),i.createElement("div",{className:C8.sizeWrapper},M9.map((e=>{const{key:t,className:a}=e;let o=C8.sizePreviewBackground;return t===l.key&&(o+=` ${C8.active}`),i.createElement("div",{className:C8.sizeContainer,key:t,onClick:()=>{d(e)}},i.createElement("div",{className:o},i.createElement("div",{className:`${C8[a]} ${C8.sizePreview}`})),i.createElement("div",{className:C8.optionLabel},t))})))),i.createElement("div",{className:C8.row},i.createElement("div",{className:C8.label},"Text Style"),i.createElement("div",{className:C8.textStylesWrapper},U9.map((e=>{const{label:t,className:a}=e;let o=C8.textStylesPreviewBackground;return t===c.label&&(o+=` ${C8.active}`),i.createElement("div",{className:C8.textStylesContainer,key:a,onClick:()=>u(e)},i.createElement("div",{className:o},i.createElement("div",{className:`${C8[a]} ${C8.textPreview}`},"Your"," ",i.createElement("span",{className:C8.highlightedText},"AI-generated")," ","captions here")),i.createElement("div",{className:C8.optionLabel},t))}))))),i.createElement("div",{className:C8.previewWrapper},i.createElement("div",{className:C8.previewHint},"This is just a preview of the size and style of your video. Click Generate Video to start the creation process."),(()=>{let e={width:"80%",aspectRatio:"1/1"};switch(l.key){case"9:16":e={width:"55%",aspectRatio:"9/16"};break;case"16:9":e={width:"100%",aspectRatio:"16/9"};break;case"4:5":e={width:"80%",aspectRatio:"4/5"};break;case"5:4":e={width:"100%",aspectRatio:"5/4"}}return i.createElement("div",{className:C8.previewContainer},i.createElement("div",{className:C8.preview,style:e},i.createElement("div",{className:C8.previewBlur},i.createElement("div",{className:`${C8.previewText} ${C8[c.className]}`},"Kapwing AI will"," ",i.createElement("span",{className:C8.highlightedText},"generate a ",l.key," video")," ","from your document."))))})(),p?i.createElement("div",{className:C8.generateContainer},w(),i.createElement("div",{className:`${C8.generateButton} ${C8.disabled}`},i.createElement("span",null,"Generating video ..."),i.createElement("div",{className:C8.loader}))):i.createElement("div",{className:C8.generateContainer},w(),i.createElement("button",{type:"button",className:[C8.generateButton,s?"":C8.disabled].join(" "),disabled:!s,onClick:o(v)},"Generate Video from Document"))))};var N8=(e=>(e.Video="Video",e.Image="Image",e.Meme="Meme",e.Script="Script",e.DocumentToVideo="DocumentToVideo",e.ArticleToVideo="ArticleToVideo",e))(N8||{});const P8=[{tab:"Video",icon:i.createElement(Pt,null),header:"Create Video"},{tab:"Image",icon:i.createElement(Rt,null),header:"Create Image"},{tab:"Meme",icon:i.createElement(Lt,null),header:"Meme Generator"},{tab:"Script",icon:i.createElement(Dt,null),header:"Create Script"},{tab:"DocumentToVideo",icon:i.createElement(Ot,null),header:"Document to Video"},{tab:"ArticleToVideo",icon:i.createElement(Ft,null),header:"Article to Video"}],R8="AiOverlay-module_background_-RaFH",L8="AiOverlay-module_wrapper_OfMsw",D8="AiOverlay-module_grid_8OsJX",O8="AiOverlay-module_container_WgC14",F8="AiOverlay-module_header_aEecZ",M8="AiOverlay-module_headerIcon_ElzuD",U8="AiOverlay-module_headerText_wCBjK",B8="AiOverlay-module_close_rQTQH",W8="AiOverlay-module_beta_w-uS6",V8="AiOverlay-module_tabs_-TXHC",j8="AiOverlay-module_tab_vuMXJ",G8="AiOverlay-module_active_yFmuK",H8="AiOverlay-module_tabIcon_0KhOz",z8="AiOverlay-module_tabHeader_eivMq",$8="AiOverlay-module_loadingWrapper_UWXsY",K8="AiOverlay-module_loading_-WUYX",Y8="AiOverlay-module_loader_6O7hP",q8="AiOverlay-module_loaderLeft_9jwC8",X8="AiOverlay-module_loadingText_GKFAG",J8="AiOverlay-module_cancelButtons_dw5qN",Q8="AiOverlay-module_cancelButton_Euln-",Z8="AiOverlay-module_actuallyCancelButton_VjwZQ",e7={container:"InputBar-module_container_u95A0",input:"InputBar-module_input_ScrVD",icon:"InputBar-module_icon_IuHy5",button:"InputBar-module_button_VRN7H",title:"InputBar-module_title_haULU",beta:"InputBar-module_beta_SbmjS",dropdown:"InputBar-module_dropdown_I5zy5",collapsed:"InputBar-module_collapsed_U1dNf",option:"InputBar-module_option_Vklct",selected:"InputBar-module_selected_Ozuyg",dropUpContainer:"InputBar-module_dropUpContainer_YoCIK",dropUpItem:"InputBar-module_dropUpItem_2w1Sd",chevron:"InputBar-module_chevron_4Xow0",dropUpItemSelected:"InputBar-module_dropUpItemSelected_5iSiR",query:"InputBar-module_query_Zhe7L",returnIcon:"InputBar-module_returnIcon_101gZ",itemIcon:"InputBar-module_itemIcon_ipvES"},t7=[{key:"aiVideoGenerator",label:"Create a video about",placeholder:"Create a video about...",icon:i.createElement(Pt,{className:e7.itemIcon}),showTopicPreview:!0,tab:N8.Video},{key:"aiImageGenerator",label:"Create an image about",placeholder:"Create an image about...",icon:i.createElement(Rt,{className:e7.itemIcon}),showTopicPreview:!0,tab:N8.Image},{key:"aiMemeGenerator",label:"Create a meme about",placeholder:"Create a meme about...",icon:i.createElement(Lt,{className:e7.itemIcon}),showTopicPreview:!0,tab:N8.Meme},{key:"aiScriptGenerator",label:"Create a video script about",placeholder:"Create a video script about...",icon:i.createElement(Dt,{className:e7.itemIcon}),showTopicPreview:!0,tab:N8.Script},{key:"aiDocumentToVideo",label:"Document to Video",icon:i.createElement(Ot,{className:e7.itemIcon}),showTopicPreview:!1,tab:N8.DocumentToVideo},{key:"aiArticleToVideo",label:"Article to Video",icon:i.createElement(Ft,{className:e7.itemIcon}),showTopicPreview:!1,tab:N8.ArticleToVideo}],a7=e=>{let t=t7.find((t=>t.key===e));return t||(t=t7[0]),t},o7=()=>{const e=m.exports.useDispatch(),t=tr((e=>e.toolTip)),a=tr((e=>e.studioLocal.ai.selectedTab))||a7(t).tab||N8.Video,[o,n]=r.exports.useState(!1),[s,l]=r.exports.useState(!1),[d,c]=r.exports.useState((()=>()=>{})),[u,p]=r.exports.useState(!1),h=r.exports.useCallback((function(e){const{state:t}=tn();return l9(t)?e:()=>(jc.set("AI_DATA",tn().state.studioLocal.ai),p(!0),null)}),[]),g=r.exports.useCallback((()=>{e(Yg({isModalOpen:!1}))}),[e]);function y(){d(),n(!1),l(!1)}const f=r.exports.useCallback((()=>{if(!o)return d(),void g();!o||s?o&&s&&(d(),g()):l(!0)}),[d,g,o,s]),E=r.exports.useCallback((e=>{"Escape"===e.key&&f()}),[f]);r.exports.useEffect((()=>(document.addEventListener("keydown",E,!1),()=>{document.removeEventListener("keydown",E,!1)})),[E]);let v=L8;return o&&(v+=` ${$8}`),i.createElement(i.Fragment,null,i.createElement("div",{className:R8,onClick:()=>{o||(d(),g()),o&&s&&(d(),g()),o&&l(!0)}}),u&&i.createElement(ZF,{hideSignIn:()=>{jc.getAndUnset("AI_DATA"),p(!1)},onSuccess:()=>{jc.getAndUnset("AI_DATA")}}),i.createElement("div",{className:v},o?s?i.createElement("div",{className:K8},i.createElement("div",{className:q8},i.createElement("div",{className:Y8}),i.createElement("div",{className:X8},"We're almost done generating your video. Are you sure you want to cancel?")),i.createElement("div",{className:J8},i.createElement("div",{className:Z8,onClick:y},"Yes, cancel"),i.createElement("div",{className:Q8,onClick:()=>{l(!1)}},"No, continue"))):i.createElement("div",{className:K8},i.createElement("div",{className:q8},i.createElement("div",{className:Y8}),i.createElement("div",{className:X8},"Generating video ... please wait. This may take a few seconds.")),i.createElement("div",{className:J8},i.createElement("div",{className:Q8,onClick:()=>{l(!0)}},"Cancel"))):i.createElement(i.Fragment,null,i.createElement("div",{className:B8,onClick:f},i.createElement(pe,null)),i.createElement("div",{className:D8},i.createElement("div",{className:O8},i.createElement("div",{className:V8},i.createElement("div",{className:F8},i.createElement("div",{className:U8},i.createElement(Mt,{className:M8})," ","Kapwing AI ",i.createElement("span",{className:W8},"Beta"))),P8.map((t=>{let o=j8;return t.tab===a&&(o+=` ${G8}`),i.createElement("div",{key:t.header,className:o,onClick:()=>{e(Yg({selectedTab:t.tab}))}},i.createElement("div",{className:H8},t.icon),i.createElement("div",{className:z8},t.header))}))),(()=>{switch(a){case N8.Video:return i.createElement(Q9,{setLoading:n,onClose:f,setCancelFn:c,enforceSignIn:h});case N8.Image:return i.createElement(o8,{onClose:f,setCancelFn:c,enforceSignIn:h});case N8.Meme:return i.createElement(u8,{onClose:f,setCancelFn:c,enforceSignIn:h});case N8.Script:return i.createElement(E8,{setCancelFn:c,enforceSignIn:h});case N8.DocumentToVideo:return i.createElement(A8,{setLoading:n,onClose:f,setCancelFn:c,enforceSignIn:h});case N8.ArticleToVideo:return i.createElement(k8,{featureName:"Article to video"});default:return i.createElement(Q9,{setLoading:n,onClose:f,setCancelFn:c,enforceSignIn:h})}})())))))},n7="LandingPageTooltipAnchor-module_popoverContent_gn3mG",r7="LandingPageTooltipAnchor-module_toolTipContent_vfe6a",i7="LandingPageTooltipAnchor-module_large_yCl-n",s7="LandingPageTooltipAnchor-module_arrow_ES-rL",l7="LandingPageTooltipAnchor-module_headerText_PIwRX",d7="LandingPageTooltipAnchor-module_iconWrapper_FCkYH",c7="LandingPageTooltipAnchor-module_subtextContainer_tdODa",u7="LandingPageTooltipAnchor-module_headerContainer_MTtS0",m7="LandingPageTooltipAnchor-module_exit_nup1B",p7={"silence-remover":{header:"Apply Smart Cut",position:{right:"280px",top:"280px"},subtext:"Use the sidebar button to access Smart Cut."},"trim-audio":{header:"Trim",subtext:"Use the handlers at each end of the track to trim the audio. Drag the track to change when it starts.",position:{bottom:"50%",left:"220px"},arrowPosition:"bottomRight"}},h7={animatedText:{header:"Animated Text",subtext:"Either upload your own image, GIF, or video, or use the GIPHY TEXT plugin to create animated text.",position:{left:"490px",top:"320px"},arrowPosition:"right"},"add-border":{header:"Add Border",subtext:"First upload your content, then use the 'Expand Padding' section in the right-hand sidebar to add a border."},blur:{header:"Blur",subtext:"First upload an image or video, then use the controls in the sidebar to adjust blur levels."},blurVideoBackground:{header:"Blur Video Background",subtext:"First upload a video, then use the controls in the sidebar to blur the background of your video."},censor:{header:"Censor",subtext:"Upload your content, then use the `Elements` tab to cover parts of your content."},collage:{header:"Make a collage",subtext:"Upload your files here, then rearrange them into the perfect collage."},"color-changing":{header:"Make Color Changing GIF",subtext:"Upload a GIF, then click the EFFECTS tab and select 'Hue Rotate' to add a rainbow effect."},crop:{header:"Crop",subtext:"First, upload your file. Then, in the sidebar, use the controls to crop your content to the desired size."},download:{header:"Download video",subtext:"Paste a link to the video you'd like to download, then click the green export button to get your final file."},extract:{header:"Extract Audio",subtext:"Upload a video or paste a youtube link. Then, in the timeline, right-click the video layer and select Detach Audio."},filter:{header:"Filter and adjust",subtext:"First, upload your file, then click the ADJUST tab in the sidebar."},"fit-video":{header:"Fit Content",position:{top:"25px"},subtext:"Choose an output size"},"freeze-frame":{header:"Freeze Frame",subtext:"Upload your video first, then use the sidebar to create a Freeze Frame"},glitch:{header:"Glitch",subtext:"Upload your video, then create a split where you want the glitch effect to be."},"ken-burns":{header:"Add Ken Burns Effect",subtext:"Upload a video, open the right sidebar, and select 'Moving Zoom' under 'Animation'."},keyframing:{header:"Add Keyframes to Video",subtext:"First upload your video, then add a keyframe with the “◇” button next to keyframable properties within the right sidebar."},gifMaker:{header:"Make a GIF",subtext:"Upload a video or image here, then choose Export as a GIF when you're ready."},montage:{header:"Create your Montage",position:{left:"60%",top:"-45%"},subtext:"Drag and drop the images you want to use in your montage here to get started."},podcast:{header:"Edit Audio for Podcasts",subtext:"Upload your audio and get started!"},pinning:{header:"Pin Object to Video",subtext:"First upload your video, then add a layer that you want to pin, like text or shape."},progressBar:{header:"Progress Bar",subtext:"Upload your content, then use the `Elements` tab to add a progress bar."},"safe-zone":{header:"Use Safe Zone",subtext:"Upload your content, then under the 'Canvas' tab, use the 'Safe Zones' section to resize your canvas.",arrowPosition:"right"},"record-screen":{header:"Record",subtext:"Use the record tab in the sidebar to record your screen, camera, or audio.",position:{top:"622px",left:"270px"},arrowPosition:"right"},resize:{header:"Resize",subtext:"First, upload your file. Then, in the sidebar, use the controls to adjust the size of your content."},"silence-remover":{header:"Remove silences",subtext:'Upload your audio, then use "Smart Cut" in the sidebar controls to remove silences'},text:{header:"Add text",subtext:"First, upload a video, then use the TEXT tab to add text to your video."},"add-audio":{arrowPosition:"right",header:"Add Audio",position:{left:"270px",top:"460px"},subtext:"Add audio to your project from the left sidebar."},transitions:{header:"Add Transitions",subtext:"First upload two videos, then click the 'Transitions' tab on the left sidebar to drag transitions onto your video."},"trim-audio":{header:"Trim Audio",subtext:"Upload your content here, then use the timeline that appears to trim your audio."},"trim-video":{header:"Trim",subtext:"Upload your content, then use the timeline that appears to trim your video."},"tv-static":{header:"Add TV Static",subtext:"Upload a video and start editing"},vhs:{arrowPosition:"right",position:{left:"270px",top:"290px"},header:"Add a VHS Effect",subtext:"Open the 'Images' tab and search for VHS effects to add to your content"},youtubeThumbnail:{header:"Create a Youtube Thumbnail",subtext:"Paste the link to your Youtube Video below, then click Export to create a single frame of the video."}},g7={"add-border":{header:"Add Border",subtext:"Click elsewhere on the canvas to de-select your content, then use the 'Expand Padding' section to add a border.",position:{right:"300px",top:"170px"}},animatedText:{header:"Animated Text",subtext:"Either upload your own image, GIF, or video, or use the GIPHY TEXT plugin to create animated text.",position:{left:"490px",top:"320px"},arrowPosition:"right"},blur:{header:"Add Blur",position:{right:"160px",top:"130px"},subtext:"Click on ADJUST, then use the controls to add blur to your image."},blurVideoBackground:{header:"Blur Image",position:{right:"280px",top:"140px"},subtext:"Click on ADJUST to add a blur effect to your image."},censor:{arrowPosition:"right",header:"Add an Element",position:{left:"270px",top:"340px"},subtext:"Open the 'Elements' tab and choose a shape to censor your content"},"color-changing":{header:"Color Change",subtext:"Click on EFFECTS to add a Hue Rotate effect to your gif",position:{right:"280px",top:"30px"}},crop:{arrowPosition:"left",header:"Select Crop",position:{right:"280px",top:"95px"},subtext:"Click the CROP button to crop your image to a desired size."},filter:{header:"Filter and Adjust",position:{right:"280px",top:"95px"},subtext:"Click on Filter to add a filter to your image, or Adjust to tweak adjustments."},gifMaker:{header:"Convert to GIF",position:{bottom:"160px",right:"280px"},subtext:"You need to convert your image to a video in order to export it as an animated GIF. Choose a duration here."},pinning:{arrowPosition:"left",header:"Pin Object with Keyframes",position:{right:"270px",top:"385px"},subtext:"Click on the “◇” button to mark its starting position then drag the seeker along the timeline and move your layer to the position of the object you are tracking in the video. Repeat this process to create a pinning effect."},resize:{arrowPosition:"left",header:"Resize",position:{right:"280px",top:"95px"},subtext:"Use the CROP button to crop your image, or deselect your image to resize the canvas."},text:{arrowPosition:"topLeft",header:"Use TEXT",position:{left:"320px",top:"85px"},subtext:"Click the TEXT button to add text to your image"},transitions:{arrowPosition:"right",header:"Add Transitions",position:{left:"270px",top:"380px"},subtext:"Upload a video, then use the 'Transitions' tab to drag transitions onto your video."},waveform:{arrowPosition:"right",header:"Add Waveform",position:{left:"270px",top:"390px"},subtext:"Open the ELEMENTS tab, then click one of the waveform patterns."},youtubeThumbnail:{arrowPosition:"left",header:"Make a thumbnail",position:{right:"280px",top:"95px"},subtext:"Click the CROP button to crop your image to a Youtube Thumbnail size."}},y7="limitToolTips-module_nobr_mCop0",f7=()=>{const[e,t]=r.exports.useState(!1);return i.createElement(i.Fragment,null,e&&i.createElement(WU,{action:Rs.SINGLE_VIDEO_DURATION_LIMIT,onClose:()=>t(!1)}),i.createElement("span",null,"Your video is longer than")," ",7," minutes, which is the limit for projects in free workspaces. Trim your video, or upgrade your workspace to Kapwing to export videos longer than ",7," ","minutes.")},E7=()=>{const[e,t]=r.exports.useState(!1);return i.createElement(i.Fragment,null,e&&i.createElement(WU,{action:Rs.UPLOAD_LIMIT,onClose:()=>t(!1)}),i.createElement("span",null,"Upgrade to export projects containing files larger than")," ",i.createElement("span",{className:y7},250," MB."))},v7=()=>i.createElement(i.Fragment,null,"Your project is above the"," ",i.createElement("span",{style:{fontWeight:"bold"}},2," hour limit"),". Trim your video to export it successfully."),w7=()=>i.createElement(i.Fragment,null,"This project contains a layer with Clean Audio applied. Upgrade or remove this layer to export."),b7=()=>i.createElement(i.Fragment,null,"This project contains layers edited with Smart Cut. Upgrade or remove these layers to export."),_7=()=>i.createElement(i.Fragment,null,"This project contains a video layer that uses Remove Background. Upgrade or remove this layer to export."),T7=()=>i.createElement(i.Fragment,null,"This project contains an audio Waveform layer. Upgrade or remove the waveform layer to export."),S7=()=>i.createElement(i.Fragment,null,"This project contains a Text to Speech audio layer. Upgrade now or delete this layer to export."),I7={freeUserDurationLimit:{header:"Duration Limit Exceeded",subtext:i.createElement(f7,null),position:{top:"40px",right:"33px"},arrowPosition:"topCenter",upsellAction:Rs.SINGLE_VIDEO_DURATION_LIMIT},freeUserSizeLimit:{header:"File Size Limit Exceeded",subtext:i.createElement(E7,null),position:{top:"40px",right:"33px"},arrowPosition:"topCenter",upsellAction:Rs.UPLOAD_LIMIT},proUserDurationLimit:{header:"Export Limit Exceeded",subtext:i.createElement(v7,null),position:{top:"40px",right:"33px"},arrowPosition:"topCenter"},cleanAudioUsed:{header:"Clean Audio Used",subtext:i.createElement(w7,null),position:{top:"40px",right:"33px"},arrowPosition:"topCenter",upsellAction:Rs.CLEAN_AUDIO},videoSmartCutUsed:{header:"Smart Cut Used",subtext:i.createElement(b7,null),position:{top:"40px",right:"33px"},arrowPosition:"topCenter",upsellAction:Rs.SMART_CUT_VIDEO},audioSmartCutUsed:{header:"Smart Cut Used",subtext:i.createElement(b7,null),position:{top:"40px",right:"33px"},arrowPosition:"topCenter",upsellAction:Rs.SMART_CUT_AUDIO},removeVideoBackgroundUsed:{header:"Video Background Removed",subtext:i.createElement(_7,null),position:{top:"40px",right:"33px"},arrowPosition:"topCenter",upsellAction:Rs.REMOVE_VIDEO_BACKGROUND},audiogramUsed:{header:"Waveform Added",subtext:i.createElement(T7,null),position:{top:"40px",right:"33px"},arrowPosition:"topCenter",upsellAction:Rs.AUDIOGRAM_BAR},textToSpeechUsed:{header:"Added Text to Speech Layer",subtext:i.createElement(S7,null),position:{top:"40px",right:"33px"},arrowPosition:"topCenter",upsellAction:Rs.TEXT_TO_SPEECH}},x7={"add-border":{header:"Add Border",subtext:"Click elsewhere on the canvas to de-select your content, then use the 'Expand Padding' section to add a border.",position:{right:"300px",top:"170px"}},animatedText:{header:"Animated Text",subtext:"Either upload your own image, GIF, or video, or use the GIPHY TEXT plugin to create animated text.",position:{left:"490px",top:"320px"},arrowPosition:"right"},blur:{header:"Add Blur",position:{right:"160px",top:"130px"},subtext:"Click on ADJUST, then use the controls to add blur to your video."},blurVideoBackground:{arrowPosition:"topRight",header:"Blur Video Background Effect",position:{right:"160px",top:"100px"},subtext:"Click the EFFECTS tab, then select 'Blur Background' to blur your video background."},censor:{arrowPosition:"right",header:"Add an Element",position:{left:"270px",top:"340px"},subtext:"Open the 'Elements' tab and choose a shape to censor your content"},chromakey:{arrowPosition:"topRight",header:"Chroma Key Effect",position:{right:"160px",top:"100px"},subtext:"Click the EFFECTS tab to apply a chroma key / green screen effect"},crop:{arrowPosition:"left",header:"Select Crop",position:{right:"280px",top:"95px"},subtext:"Click the CROP button to crop your video to a desired size."},download:{arrowPosition:"topRight",header:"Export to download",position:{right:"8%",top:"60px"},subtext:"Click Export to get a file you can download and share."},resize:{arrowPosition:"left",header:"Resize",position:{right:"280px",top:"95px"},subtext:"Click the CROP button to crop your video to a desired size. Or, de-select the video to resize the entire canvas."},filter:{header:"Filter and Adjust",position:{right:"280px",top:"130px"},subtext:"Click on Filter to add a filter to your image, or Adjust to tweak adjustments."},"freeze-frame":{arrowPosition:"topRight",header:"Freeze Frame",position:{right:"20px",top:"100px"},subtext:"Use the TIMING tab to generate a Freeze Frame of your video"},gifMaker:{arrowPosition:"topRight",header:"Make a GIF",position:{right:"8%",top:"60px"},subtext:"When you're ready, click Export and then choose GIF."},glitch:{arrowPosition:"right",header:"Add Transitions",position:{left:"270px",top:"450px"},subtext:"In the 'Transitions' tab, drag and drop “Glitch Displace” or “Glitch Memories” between layers."},keyframing:{arrowPosition:"left",header:"Add Keyframes",position:{right:"270px",top:"330px"},subtext:"Select your layer and click on the “◇” keyframe button to add a keyframe."},mute:{header:"Mute",position:{right:"280px",top:"184px"},subtext:"Click to mute/unmute"},progressBar:{arrowPosition:"right",header:"Progress Bar",position:{left:"270px",top:"340px"},subtext:"Click the ELEMENTS tab, then click one of the progress bar styles."},pinning:{arrowPosition:"left",header:"Pin Object with Keyframes",position:{right:"270px",top:"305px"},subtext:"First, add a text, shape, or image layer. Move it to the object you would like to track on your video then click on the “◇” button to mark its starting position."},"smart-cut-canvas-effects":{arrowPosition:"none",header:"Smart Cut and Effects",position:{right:"280px",top:"100px"},subtext:"Smart Cut is not currently supported for layers with video effects applied. Remove effects through the EFFECTS tab before using Smart Cut."},text:{arrowPosition:"right",header:"Use TEXT",position:{left:"270px",top:"135px"},subtext:"Click the TEXT button to add text to your video"},"add-audio":{arrowPosition:"right",header:"Add Audio",position:{left:"270px",top:"460px"},subtext:"Add audio to your project from the left sidebar."},transitions:{arrowPosition:"right",header:"Add Transitions",position:{left:"270px",top:"380px"},subtext:"Upload another video, then use the 'Transitions' tab to drag transitions onto your video."},"trim-audio":{arrowPosition:"bottomLeft",header:"Trim",position:{top:"55%",left:"220px"},subtext:"Use the handlers at each end of the track to trim the audio. Drag the track to change when it starts."},"trim-video":{arrowPosition:"bottomLeft",header:"Trim Video",position:{left:"220px",top:"55%"},subtext:"Use the handlers at each end of the track to trim the video. Drag the track to change when it starts."},"tv-static":{header:"Apply TV Static",subtext:"When you're ready, select the 'Transitions' tab and search for the TV Static transition",arrowPosition:"right",position:{left:"270px",top:"460px"}},waveform:{arrowPosition:"right",header:"Add Waveform",position:{left:"270px",top:"390px"},subtext:"Open the ELEMENTS tab, then click one of the waveform patterns."},youtubeThumbnail:{arrowPosition:"topRight",header:"Youtube Thumbnail",position:{right:"8%",top:"60px"},subtext:"Click Export, then select JPG to create an image thumbnail of your video."}},k7={adjust:{generic:{header:"Adjust",subtext:"First, upload your file, then adjust video quality and settings in the sidebar."},video:{header:"Adjust video",subtext:"Adjust video quality and settings here."},image:{header:"Adjust image",subtext:"Adjust image quality and settings here."}},compressVideo:{generic:{header:"Compress",subtext:"Upload your content, then adjust the Compression Level in the export settings."},video:{header:"Compress video",subtext:"Open the Export Settings to adjust the compression Level."}},convert:{generic:{header:"Convert",subtext:"First upload the content that you want to convert. Then you will be able to export in different formats."},image:{header:"Convert to Video",subtext:"If you want to convert your image to a video, add a duration to your project. Otherwise, hit Export to choose a conversion type."},mobile:{header:"Convert",subtext:"First upload your content, then click export to choose the format you want to export."},video:{header:"Convert",subtext:"Click Export, then choose the format you want to convert your video to."},audio:{header:"Convert",subtext:"Click Export, then choose the format you want to convert your audio to."}},fallback:{generic:{header:"Upload your content",subtext:"Upload a file here, or use the controls to the left to get started."}},link:{generic:{header:"Make a Link",subtext:"Upload a video or image here, then export your project to get your shareable link."}},musicVideo:{generic:{header:"Create a music video",subtext:"Upload a video here, or use the controls to the left to get started."},video:{header:"Add Music",subtext:"Upload your own music, or browse from 1000+ songs and sound effects to add to your video."}},removeBackgroundNoise:{generic:{header:"Remove Noise",subtext:"First, upload a video, then use the Clean Audio button in the sidebar to remove background noise."},audio:{header:"Remove Noise",subtext:"Click to remove background noise."},image:{header:"Erase background",subtext:"Click to remove the image background"},video:{header:"Remove Noise",subtext:"Click to remove background noise."}},"remove-image-background":{generic:{header:"Erase Image Background",subtext:"Upload an image, then use the ERASE button in the sidebar to remove the background."},image:{header:"Erase background",subtext:"Click to remove the image background"},video:{header:"Remove background",subtext:"Click to remove the video background"}},"remove-video-background":{generic:{header:"Erase Video Background",subtext:"Upload a video, then click the EFFECTS tab in the sidebar to remove the background."},image:{header:"Erase background",subtext:"Click to remove the image background"},video:{header:"Remove background",subtext:"Click to remove the video background"}},chromakey:{generic:{header:"Chroma Key",subtext:"Upload a video, then use the controls in the sidebar to apply a chroma key effect / edit the green screen."}},speed:{audio:{header:"Change Speed",subtext:"Use -/+ to increase or decrease the speed of your audio clip"},generic:{header:"Change Video Speed",subtext:"First, upload a file, then use the sidebar controls to change its speed."},video:{header:"Change Speed",subtext:"Use -/+ to increase or decrease the speed of your video"}},slowMotion:{generic:{header:"Upload",subtext:"First, upload the video you want to slow down. Then use the sidebar controls to change its speed."},video:{header:"Slow down video",subtext:"Use - to slow down your video."}},subtitles:{generic:{header:"Add Subtitles",subtext:"Upload a video, then you'll be able to use the controls to add subtitles to your content."},image:{header:"Choose a video",subtext:"You'll have to upload a video or audio file to add subtitles to your project."},video:{header:"Subtitle your video",subtext:"First auto-generate subtitles for your video, then you'll be able to edit them in your project."},audio:{header:"Create subtitles",subtext:"Auto-generate subtitles for your audio, then you'll be able to edit the project."},mobile:{header:"Create subtitles",subtext:"Auto-generate subtitles for your audio, then you'll be able to edit the project."}},timeline:{generic:{header:"Upload your content",subtext:"Upload video, images, or audio files and start editing them within the Kapwing editor."},image:{header:"Convert image to video",subtext:"If you want to make a video from this image, use the duration selector to change the duration of your image video."},video:{header:"Edit your video",subtext:"Use timeline to trim, merge, and edit your videos. Drag and drop files into Kapwing to start."},audio:{header:"Edit your audio",subtext:"Use timeline to trim, merge, and edit your audio files. Drag and drop files into Kapwing to start."}},"text-to-speech":{generic:{header:"Add Text to Speech",subtext:"Add your text here, then use the settings and buttons below to generate an audio layer."},video:{header:"Add Text to Speech",subtext:"Add your text here, then use the settings and buttons below to generate an audio layer."},audio:{header:"Add Text to Speech",subtext:"Add your text here, then use the settings and buttons below to generate an audio layer."},text:{header:"Add Text to Speech",subtext:"Add your text here, then use the settings and buttons below to generate an audio layer."}},translate:{generic:{header:"Translate",subtext:"First, upload your content here. You can generate translated subtitles afterward."},audio:{header:"Translate",subtext:"Click the Translate button to start generating subtitles."},video:{header:"Translate",subtext:"Click the Translate button to start generating subtitles."}},rotate:{video:{header:"Rotate Video",subtext:"Use the rotation controls to rotate, flip, or mirror your video."},image:{header:"Rotate Image",subtext:"Use the controls to rotate, mirror, or flip your image."},generic:{header:"Rotate",subtext:"First, upload a file, then use the sidebar controls to rotate your image or video."}},aiScriptGenerator:{generic:{header:"Create an AI Script",subtext:"Type an idea for a script that you'd like to generate, and Kapwing AI will take care of the rest."},image:{header:"Create an AI Script",subtext:"Use this button to open Kapwing AI and generate a script."},video:{header:"Create an AI Script",subtext:"Use this button to open Kapwing AI and generate a script."},audio:{header:"Create an AI Script",subtext:"Use this button to open Kapwing AI and generate a script."},mobile:{header:"Create an AI Script",subtext:"Use this button to open Kapwing AI and generate a script."}},aiVideoGenerator:{generic:{header:"Create a video with AI",subtext:"Type an idea for a video, and Kapwing AI will take care of the rest."},image:{header:"Create a video with AI",subtext:"Use Kapwing AI to generate a video from a text prompt."},video:{header:"Create a video with AI",subtext:"Use Kapwing AI to generate a video from a text prompt."},audio:{header:"Create a video with AI",subtext:"Use Kapwing AI to generate a video from a text prompt."},mobile:{header:"Create a video with AI",subtext:"Use Kapwing AI to generate a video from a text prompt."}},aiImageGenerator:{generic:{header:"Create an image with AI",subtext:"Type an idea for a image, and Kapwing AI will take care of the rest."},image:{header:"Create an image with AI",subtext:"Use Kapwing AI to generate an image from a text prompt."},video:{header:"Create an image with AI",subtext:"Use Kapwing AI to generate an image from a text prompt."},audio:{header:"Create an image with AI",subtext:"Use Kapwing AI to generate an image from a text prompt."},mobile:{header:"Create an image with AI",subtext:"Use Kapwing AI to generate an image from a text prompt."}},aiDocumentToVideo:{generic:{header:"Document to Video",subtext:"Open Kapwing AI, then paste the contents of your document to convert it into a video."},image:{header:"Document to Video",subtext:"Open Kapwing AI, then paste the contents of your document to convert it into a video."},video:{header:"Document to Video",subtext:"Open Kapwing AI, then paste the contents of your document to convert it into a video."},audio:{header:"Document to Video",subtext:"Open Kapwing AI, then paste the contents of your document to convert it into a video."},mobile:{header:"Document to Video",subtext:"Open Kapwing AI, then paste the contents of your document to convert it into a video."}},aiMemeGenerator:{generic:{header:"Create memes with AI",subtext:"Enter what you want to make memes about, and Kapwing AI will take care of the rest."},image:{header:"Create memes with AI",subtext:"Use Kapwing AI to generate a memes about whatever you'd like."},video:{header:"Create memes with AI",subtext:"Use Kapwing AI to generate a memes about whatever you'd like."},audio:{header:"Create memes with AI",subtext:"Use Kapwing AI to generate a memes about whatever you'd like."},mobile:{header:"Create memes with AI",subtext:"Use Kapwing AI to generate a memes about whatever you'd like."}},transcribe:{generic:{header:"Create a transcription",subtext:"First upload your video, then use the controls to create and download a transcription."},video:{header:"Transcribe your video",subtext:"Auto-generate subtitles for your video, then you'll be able to download the full transcript."},audio:{header:"Transcribe your audio",subtext:"Auto-generate subtitles for your audio, then you'll be able to download the full transcript."},image:{header:"Create a transcription",subtext:"You'll have to upload a video or audio file to use the transcription tool."},mobile:{header:"Create a transcription",subtext:"First upload your video, then use the controls to create and download a transcription."}},trimWithTranscript:{generic:{header:"Edit video by editing text",subtext:"Get started by uploading the video or audio file that you'd like to edit."},video:{header:"Edit your video by editing text",subtext:"First transcribe your video, then you'll be able to split, trim, and edit using the words spoken in your video."},audio:{header:"Edit your audio by editing text",subtext:"First transcribe your audio, then you'll be able to split, trim, and edit using the words spoken in your audio."}},vttFile:{generic:{header:"Create a VTT File",subtext:"First upload your video, then use the controls to create and download a VTT file for your video."},video:{header:"Create your VTT file",subtext:"Auto-generate subtitles for your video, then you'll be able to download the complete VTT file."},audio:{header:"Create your VTT file",subtext:"Auto-generate subtitles for your audio, then you'll be able to download the complete VTT file."},image:{header:"Upload a video",subtext:"You'll have to upload a video or audio file to use the VTT file maker tool."},mobile:{header:"Create a VTT File",subtext:"First upload your video, then use the controls to create and download a VTT file for your video."}},srtFile:{generic:{header:"Create an SRT File",subtext:"First upload your video, then use the controls to create and download a SRT file for your video."},video:{header:"Create your SRT file",subtext:"Auto-generate subtitles for your video, then you'll be able to download the complete SRT file."},audio:{header:"Create your SRT file",subtext:"Auto-generate subtitles for your audio, then you'll be able to download the complete SRT file."},image:{header:"Upload a video",subtext:"You'll have to upload a video or audio file to use the SRT file maker tool."},mobile:{header:"Create an SRT File",subtext:"First upload your video, then use the controls to create and download a SRT file for your video."}},"smart-cut":{generic:{header:"Smart Cut",subtext:'First, upload your file. Then, in the sidebar to select "Smart Cut".'},video:{header:"Smart Cut",subtext:"Use Smart Cut to automatically trim your video to remove silence and unwanted footage."}},waveform:{generic:{header:"Add a waveform / audiogram",subtext:"First, upload a file, then click on 'Elements' in the sidebar to add a waveform."}},record:{generic:{header:"Record",subtext:"Use the record tab in the sidebar to record your screen, camera, or audio."}},reverse:{generic:{header:"Reverse",subtext:"Upload your content, then use the controls in the right-hand sidebar to reverse your video or gif."},video:{header:"Reverse Video",subtext:"Use this checkbox to reverse your video."}},repurpose:{canvas:{header:"Resize",subtext:"Click the Resize Canvas button to change the size of your project."}},slideshow:{generic:{header:"Make a slideshow",subtext:"Upload images and videos to get started."},image:{header:"Add duration",subtext:"Add duration to your images to create a slideshow."}},srtEditor:{generic:{header:"Upload a video",subtext:"First, upload the video you'd like to add subtitles to. You can upload an SRT file in the next step."},mobile:{header:"Upload a video",subtext:"First, upload the video you'd like to add subtitles to. You can upload an SRT file in the next step."},video:{header:"Upload SRT file",subtext:"Upload an SRT file to edit your subtitles directly from the SRT file editor that will appear."}},volume:{video:{header:"Adjust Volume",subtext:"Use this slider to adjust the volume of your video."},audio:{header:"Adjust Volume",subtext:"Use this slider to adjust the volume of your audio."}},webcam:{generic:{header:"Test your webcam",subtext:"Allow Kapwing access in order to test your webcam. You can also record a video."}}};function C7({hasLayers:e,isMobile:t,selectedLayerType:a,toolTip:o}){if(!(o in k7))return null;const n=k7[o];if(!n)return null;if(t)return n.mobile?{data:n.mobile,type:"mobile"}:null;if(!a)return e?n.canvas?{data:n.canvas,type:"canvas"}:null:n.generic?{data:n.generic,type:"generic"}:null;const r=n[a];return r?{data:r,type:a}:null}const A7=({layersLength:e,mobileToolTip:t,selectedLayerType:a,toolTip:o})=>{let n={};if(!t&&0===e&&o in h7){n=h7[o];const{position:e,arrowPosition:t}=n;e||(n.position={bottom:"71%",left:"73%"}),t||(n.arrowPosition="bottomRight")}if("video"===a&&o in x7){if(n=x7[o],n.position){const{right:e,left:t}=n.position;e||t||(n.position.right="280px")}if(n.replaceTo){const{editorPath:e}=tn().state;lT(`${e}${n.replaceTo}`)}}if("image"===a&&o in g7&&(n=g7[o],n.position)){const{right:e,left:t}=n.position;e||t||(n.position.right="280px")}if("audio"===a&&o in p7&&(n=p7[o],n.position)){const{right:e,left:t}=n.position;e||t||(n.position.right="280px")}return o in I7&&(n=I7[o]),t&&(n={}),n},N7=({align:e="start",children:t,portal:a,position:o="top",tooltips:n})=>{const s=r.exports.useRef(!1),l=r.exports.useRef(null),d=Si(),c=m.exports.useDispatch(),u=tr((e=>e.toolTip)),p=tr((e=>{if(e.studio.selectedItem&&"layer"===e.studio.selectedItem.type){const t=e.studio.allLayers.byId[e.studio.selectedItem.id];if(t)return t.type}return null})),h=tr((e=>Object.keys(e.studio.allLayers.byId).length>0));r.exports.useLayoutEffect((function(){const e=()=>{},t=l.current;if(!t)return e;if(!("scrollIntoView"in t))return e;if(s.current)return e;let a=setTimeout((function e(){s.current||(null==t||t.scrollIntoView({block:"center",behavior:"smooth"}),a=setTimeout(e,750))}),200);const o=new IntersectionObserver((e=>{var t;!0===(null==(t=e[0])?void 0:t.isIntersecting)&&(s.current=!0,clearTimeout(a))}),{threshold:[1]});return o.observe(t),()=>{o.disconnect(),clearTimeout(a)}}),[]);const g=i.createElement(i.Fragment,null,t);if(!u)return g;let y=u in n?n[u]:null,f=C7({hasLayers:h,toolTip:u,selectedLayerType:p,isMobile:d});if(!f&&"fallback"in n){const e=A7({layersLength:h?1:0,mobileToolTip:d,selectedLayerType:p,toolTip:u});Object.keys(e||{}).length>0||(f=C7({hasLayers:h,toolTip:"fallback",selectedLayerType:p,isMobile:d}),y=n.fallback)}if(!f)return g;const{data:E,type:v}=f;if(!y||!y.includes(v))return g;const{subtext:w,header:b,large:_}=E,T=a?Ut:i.Fragment;return i.createElement(Bt,{open:!0},i.createElement(Wt,{asChild:!0,ref:l},t),i.createElement(T,null,i.createElement(Vt,{side:o,align:e,alignOffset:-40,arrowPadding:20,collisionPadding:12,sideOffset:2,className:`${n7}`},i.createElement("div",{className:`${r7} ${_?i7:""}`,"data-cy":`${u}-tool-tip-container`,id:"overlay-very-cool"},i.createElement("div",{className:u7},b&&i.createElement("div",{className:l7},b),i.createElement(jt,{asChild:!0,onClick:e=>{c(Q_("")),e.stopPropagation()}},i.createElement("span",{className:m7,"data-cy":`${u}-tool-tip-exit`},i.createElement("div",{className:d7},i.createElement(pe,null))))),i.createElement("div",{className:c7},w)),i.createElement(Gt,{className:s7,width:14,height:7}))))},P7="HeaderAiButton-module_disabled_NxSk-",R7="HeaderAiButton-module_headerButtonContainer_3s6M3",L7="HeaderAiButton-module_headerButtonIcon_mgxEX",D7="HeaderAiButton-module_headerAiButtonContainer_kuK5f",O7="HeaderAiButton-module_headerAiTooltip_zaJw-",F7=i.memo((({disabled:e})=>{const t=m.exports.useDispatch(),a=tr((e=>e.studioLocal.ai.isModalOpen));return i.createElement(i.Fragment,null,i.createElement(N7,{tooltips:{aiScriptGenerator:["image","video","audio","mobile"],aiVideoGenerator:["image","video","audio","mobile"],aiImageGenerator:["image","video","audio","mobile"],aiDocumentToVideo:["generic","image","video","audio","mobile"]}},i.createElement("div",{className:`${R7}\n        ${D7}\n        ${e?P7:""}`,onClick:()=>{t(Yg({isModalOpen:!0}))},"data-cy":"header-ai-button"},i.createElement(Mt,{className:L7}),i.createElement("span",{className:O7},"Create with Kapwing AI"))),a?i.createElement(o7,null):null)})),M7="ProfilerDashboard-module_portal_q41dD",U7="ProfilerDashboard-module_devDashboard_E-viJ",B7="ProfilerDashboard-module_hidden_n9vIU",W7="ProfilerDashboard-module_tabs_xBI-W",V7="ProfilerDashboard-module_data_vJsxM",j7="ProfilerDashboard-module_disabled_0vE4w",G7="ProfilerDashboard-module_header_svdlE",H7="ProfilerDashboard-module_status_3UAZd",z7="ProfilerDashboard-module_devDashboardButton_QM9UW",$7="ProfilerDashboard-module_warningFlag_jtC42",K7="ProfilerDashboard-module_title_CVYl9",Y7=Intl.NumberFormat(void 0,{maximumFractionDigits:0}),q7=Intl.NumberFormat(void 0,{maximumFractionDigits:1}),X7=e=>`${Y7.format(e)}ms`,J7=e=>`${q7.format(e/Math.pow(2,20))}mb`,Q7="reports-module_reports_wE3nG",Z7="reports-module_fetchTable_pkjW-",e6="reports-module_elementTable_okG1T",t6="reports-module_caret_Z57sj",a6="reports-module_expanded_t5yzt",o6="reports-module_profilerTree_wDsPU",n6="reports-module_subcategory_S6nQz",r6="reports-module_timing_fosLr",i6="reports-module_userEventTimings_5EpmX",s6="reports-module_pointerPosition_4y6IP",l6=e=>{let t=0,a=0,o=0,n=0,r=0,i=0;for(const s of e)r+=1,n+=s.transferSize,i+=s.responseEnd-s.fetchStart,"fetch"!==s.initiatorType&&"xmlhttprequest"!==s.initiatorType||(t+=1,a+=s.transferSize,o+=s.responseEnd-s.fetchStart);return{fetches:t,fetchedBytes:a,fetchTime:o,totalRequests:r,totalBytes:n,totalTime:i}},d6=i.memo((({setWarningStates:e,clear:t})=>{const[{fetches:a,fetchedBytes:o,fetchTime:n,totalBytes:s,totalRequests:l,totalTime:d},c]=r.exports.useState((()=>l6(performance.getEntriesByType("resource"))));r.exports.useEffect((()=>()=>{c(l6([]))}),[t]),r.exports.useEffect((()=>{e((e=>({...e,"fetches over 100":a>100})))}),[e,a]),r.exports.useEffect((()=>{const e=new PerformanceObserver((e=>{c((t=>{const a=l6(e.getEntries());return{fetches:t.fetches+a.fetches,fetchedBytes:t.fetchedBytes+a.fetchedBytes,fetchTime:t.fetchTime+a.fetchTime,totalRequests:t.totalRequests+a.totalRequests,totalBytes:t.totalBytes+a.totalBytes,totalTime:t.totalTime+a.totalTime}}))}));return e.observe({type:"resource",buffered:!0}),()=>{e.disconnect()}}),[]);const u="For chrome reasons. this is annoying to support the other 2 pieces of data";return i.createElement("div",{className:Z7},i.createElement("div",null),i.createElement("div",null,"Count"),i.createElement("div",{title:`1mb is 2^20 (${Math.pow(2,20)}) bytes`},"Bytes"),i.createElement("div",{title:"Timing may overlap with one another"},"Time"),i.createElement("div",null,"Fetches"),i.createElement("div",null,Y7.format(a)),i.createElement("div",null,J7(o)),i.createElement("div",null,ff(n)),i.createElement("div",null,"Total"),i.createElement("div",null,Y7.format(l)),i.createElement("div",null,J7(s)),i.createElement("div",null,ff(d)),i.createElement("div",{title:u},"WebSockets"),i.createElement("div",{title:u},Qo))}));function c6(e){const[t,a]=r.exports.useState(e);return[t,r.exports.useCallback((e=>{a((t=>{const a="function"==typeof e?e(t):e;return!1===ar(t,a)?a:t}))}),[])]}const u6=i.memo((({setWarningStates:e,shouldThrottle:t})=>{const[a,o]=c6({}),[n,s]=c6({}),[l,d]=c6({}),[c,u]=c6({}),m=tr((e=>e.studio.allLayers.byId)),p=tr((e=>e.studioLocal.layerTempValues));return r.exports.useEffect((function(){null!=l&&null!=c&&e((e=>({...e,"tts not local blob":!oH.remotePlayback&&!!n.nonLocalBlobs,"audio not local blob":!oH.remotePlayback&&!!a.nonLocalBlobs,"image not local blob":!oH.remotePlayback&&!!c.nonLocalBlobs,"video not local blob":!oH.remotePlayback&&!!l.nonLocalBlobs,"tts error":!!n.errors,"audio error":!!a.errors,"image loading":!!c.errors,"video error":!!l.errors})))}),[e,l,c,a,n]),r.exports.useEffect((function(){e(Object.values(m).filter((e=>"video"===e.type)),d);e(Object.values(m).filter((e=>"image"===e.type)),u);e(Object.values(m).filter((e=>"audio"===e.type)),o);function e(e,t){var a,o;let n=0;for(const r of e)r.local_url||(n+=1);if("video"===(null==(a=e[0])?void 0:a.type))for(const r of e)p[r.id]&&(null==(o=p[r.id])?void 0:o.trackPreviewLocalUrl)||(n+=1);t((t=>({...t,layerCount:e.length,nonLocalBlobs:n})))}e(Object.values(m).filter((e=>"text"===e.type&&e.ttsAudio)),s)}),[m,p]),r.exports.useEffect((()=>{const e=t?2e3:200;let a;const n=()=>{const t=document.getElementsByTagName("video"),r=t.length,i=[...t].filter((e=>e.error)).length,s=document.getElementsByTagName("img"),l=s.length,c=[...s].filter((e=>!e.complete||!e.naturalWidth||!e.naturalHeight)).length,m=document.getElementsByTagName("audio"),p=m.length,h=[...m].filter((e=>e.error)).length;d((e=>({...e,elements:r,errors:i}))),u((e=>({...e,elements:l,errors:c}))),o((e=>({...e,elements:p,errors:h}))),a=setTimeout(n,e)};return n(),()=>{a&&clearTimeout(a)}}),[t]),null==l||null==c?null:i.createElement("div",{className:e6},i.createElement("div",null),i.createElement("div",null,"Elements"),i.createElement("div",null,"Errors"),i.createElement("div",null,"Layers"),i.createElement("div",null,"Local files"),i.createElement("div",null,"Videos"),i.createElement("div",null,l.elements),i.createElement("div",{title:`${l.errors} have errors`},l.errors?"❌💩":"✅"),i.createElement("div",null,l.layerCount),i.createElement("div",{title:`${l.nonLocalBlobs} videos not using local urls`},l.nonLocalBlobs?"❌💩":"✅"),i.createElement("div",null,"Audio"),i.createElement("div",null),i.createElement("div",{title:`${a.errors} have errors`},a.errors?"❌💩":"✅"),i.createElement("div",null,a.layerCount),i.createElement("div",{title:`${a.nonLocalBlobs} audio elements not using local urls`},a.nonLocalBlobs?"❌💩":"✅"),i.createElement("div",null,"Images"),i.createElement("div",null,c.elements),i.createElement("div",{title:`${c.errors} are still loading`},c.errors?"❌💩":"✅"),i.createElement("div",null,c.layerCount),i.createElement("div",{title:`${c.nonLocalBlobs} images not using local urls`},c.nonLocalBlobs?"❌💩":"✅"),i.createElement("div",null,"TTS"),i.createElement("div",null),i.createElement("div",null),i.createElement("div",null,n.layerCount),i.createElement("div",{title:`${n.nonLocalBlobs} text to speech not using local urls`},n.nonLocalBlobs?"❌💩":"✅"))})),m6=({expanded:e})=>i.createElement("div",{className:`${t6} ${e?a6:""}`}),p6=i.memo((({shouldThrottle:e,clear:t})=>{const[a,o]=r.exports.useState({}),[n,s]=r.exports.useState((()=>qo.getSortedCategories()));r.exports.useEffect((()=>()=>{o({}),qo.clear(),s(qo.getSortedCategories())}),[t]);return r.exports.useEffect((()=>{if(e)return()=>{};const t=()=>{s(qo.getSortedCategories())};return t(),qo.addEventListener("update",t),()=>{qo.removeEventListener("update",t)}}),[e]),i.createElement("div",{className:o6},[...n].map((([e,t])=>i.createElement(r.exports.Fragment,{key:e},i.createElement("div",{onClick:()=>(e=>o((t=>({...t,[e]:!t[e]}))))(e)},e,i.createElement(m6,{expanded:a[e]})),i.createElement("div",{className:r6},"(",X7(t.total.time),"/",Y7.format(t.total.hits).padEnd(3," "),")"),a[e]&&[...t.totalByKey].map((([t,a])=>i.createElement(r.exports.Fragment,{key:`${e}${t}`},i.createElement("div",{className:n6},t),i.createElement("span",{className:r6},"(",X7(a.time),"/",Y7.format(a.hits).padEnd(3," "),")"))))))))})),h6=i.memo((({shouldThrottle:e,clear:t})=>{const a=r.exports.useRef([]),[o,n]=r.exports.useState(0),[s,l]=r.exports.useState(),d=r.exports.useRef(),[c]=r.exports.useState((()=>{const e=document.getElementById("userEventsPortal");if(e)return e;const t=document.createElement("div");return t.id="userEventsPortal",document.body.appendChild(t),t}));r.exports.useEffect((()=>()=>c.remove()),[c]),r.exports.useEffect((()=>()=>{a.current=[]}),[t]);const u=Oq((()=>{e||d.current||(d.current=setTimeout((()=>{d.current=void 0,n((e=>e+1))}),100))}));return r.exports.useEffect((()=>{const e=e=>{const t={};t.time=performance.now();const o=a.current[0];if(o?(t.index=1+o.index,t.timeSincePrevious=t.time-o.time):t.index=1,e instanceof KeyboardEvent)" "===e.key?t.name="space":t.name=e.key;else if(e instanceof PointerEvent){const a=["left","middle","right","back","forward"][e.button];t.name=`${a} click`,t.mouseEvent={x:e.pageX,y:e.pageY}}a.current.unshift(t),a.current.length>20&&a.current.pop(),u()};return document.addEventListener("keydown",e,{capture:!0,passive:!0}),document.addEventListener("pointerdown",e,{capture:!0,passive:!0}),()=>{document.removeEventListener("keydown",e,{capture:!0}),document.removeEventListener("pointerdown",e,{capture:!0})}}),[u]),i.createElement("div",{className:i6},a.current.map((({name:e,timeSincePrevious:t,index:a,mouseEvent:o})=>i.createElement(r.exports.Fragment,{key:a},i.createElement("div",{onPointerOver:()=>l(o),onPointerOut:()=>l(void 0)},a,") ",e),i.createElement("div",{className:r6},t?X7(t):"")))),s&&he.createPortal(i.createElement("div",{className:s6,style:{top:s.y,left:s.x}}),c))})),g6=i.memo((({className:e,clear:t,disabled:a,setWarningStates:o})=>i.createElement("div",{className:Ht(e,Q7)},i.createElement(u6,{shouldThrottle:a,setWarningStates:o}),i.createElement(d6,{clear:t,setWarningStates:o}),i.createElement(h6,{clear:t,shouldThrottle:a}),i.createElement(p6,{clear:t,shouldThrottle:a})))),y6="assets-module_videos_vvVwU",f6=async(e,t)=>{if(f6.cache.has(e))return f6.cache.get(e);const a=await fetch(e,{headers:{Range:"bytes=0-100000"},signal:t});if(null==a)return null;const o=await a.arrayBuffer(),n=[];return(()=>{const e={};let t=!1,a=0,r=!1;for(;a<o.byteLength&&!r;){const n={size:(i=new DataView(o,a,8)).getUint32(0),type:String.fromCharCode(i.getUint8(4),i.getUint8(5),i.getUint8(6),i.getUint8(7))};switch(n.type){case"ftyp":break;case"moov":e.mdat||(t=!0);break;default:r=!0}a+=n.size,e[n.type]?e[n.type]+=1:e[n.type]=1}var i;e.ftyp?(n.push("mp4"),e.sidx?n.push("fragmented"):t&&n.push("faststart")):n.push("not mp4")})(),f6.cache.set(e,n),n};f6.cache=new Map;const E6=sr((e=>e.studio.allLayers.byId),(e=>{const t=Object.values(e).filter((e=>"video"===e.type&&null!=e.asset_id));return s.exports.uniqBy(t,"asset_id")})),v6=i.memo((({className:e,clear:t,setWarningStates:a})=>{const o=tr(E6),[n]=r.exports.useState((()=>new AbortController)),[s,l]=r.exports.useState({}),d=r.exports.useRef({});return r.exports.useEffect((()=>{f6.cache.clear(),d.current={},l({})}),[t]),r.exports.useEffect((()=>{for(const e of o){const t=tT(e);null==d.current[t]&&(d.current[t]=(async()=>{const e=await f6(t,n.signal);l((a=>({...a,[t]:e})))})())}}),[o,n]),r.exports.useEffect((()=>{const e=o.some((e=>e.optimization_failed));a((t=>({...t,"optimize failed":e})))}),[o,a]),i.createElement("div",{className:e},i.createElement("div",{className:y6},i.createElement("div",null,"Asset id"),i.createElement("div",null,"Name"),i.createElement("div",null,"Size"),i.createElement("div",null,"Optimized"),i.createElement("div",null,"Local file"),i.createElement("div",null,"flags"),o.map((e=>{var t,a;let o;return o=e.optimization_failed?"❌ Failed":null!=e.preview?"Yes":"No",i.createElement(r.exports.Fragment,{key:e.asset_id},i.createElement("div",null,e.asset_id),i.createElement("div",null,null!=(t=e.originalName)?t:e.name),i.createElement("div",null,e.width,"x",e.height),i.createElement("div",null,o),i.createElement("div",null,e.local_url?"Yes":"No"),i.createElement("div",null,null==(a=s[tT(e)])?void 0:a.join(",")))}))))})),w6="utilities-module_utilities_Uzz0V",b6=i.memo((({className:e})=>{var t,a,o,n;const s=iH("enableMse");return r.exports.useEffect((()=>{const e=fs();rH({enableMse:"test"===e.mse})}),[]),i.createElement("div",{"data-draggable":!0,className:Ht(w6,e)},i.createElement("label",null,i.createElement("input",{type:"checkbox",title:"Don't download any assets",defaultChecked:null!=(t=oH.remotePlayback)&&t,onChange:e=>rH({remotePlayback:e.target.checked})}),"Force remote playback"),i.createElement("label",null,i.createElement("input",{type:"checkbox",title:"Delete the indexdb on a page load",defaultChecked:null!=(a=oH.clearDbOnLoad)&&a,onChange:e=>rH({clearDbOnLoad:e.target.checked})}),"Clear DB on load"),i.createElement("label",null,i.createElement("input",{type:"checkbox",title:"Ignore any de-duplication logic",defaultChecked:null!=(o=oH.forceNewAssets)&&o,onChange:e=>rH({forceNewAssets:e.target.checked})}),"Force new assets"),i.createElement("label",null,i.createElement("input",{type:"checkbox",title:"Enable experimental MediaSource Extensions",checked:null!=s&&s,onChange:e=>{const t=e.target.checked;var a;rH({enableMse:t}),a={mse:t?"test":"control"},null==gs&&(gs=ys()),Object.assign(gs,a),ps(gs)}}),"Enable MSE"),i.createElement("label",null,i.createElement("input",{type:"checkbox",title:"Show export preview canvas",defaultChecked:null!=(n=oH.showExportPreviewCanvas)&&n,onChange:e=>rH({showExportPreviewCanvas:e.target.checked})}),"Show export preview canvas"))})),_6=()=>{const e=r.exports.useRef(null),[t,a]=r.exports.useState(0),[o,n]=r.exports.useState(!1),[s,l]=r.exports.useState({}),[d,c]=r.exports.useState("reports"),[u]=r.exports.useState((()=>{const e="profiler-portal";let t=document.getElementById(e);return t||(t=document.createElement("div"),t.id=e,t.className=M7,document.body.appendChild(t),t)})),m=r.exports.useRef(),p=r.exports.useRef({left:.5,top:.5});r.exports.useEffect((()=>{function t(){e.current&&(e.current.style.left=100*p.current.left+"%",e.current.style.top=100*p.current.top+"%")}t();let a=!1;function o(e){a=!(e.target instanceof HTMLElement&&!e.target.dataset.draggable),a&&(m.current={left:e.clientX,top:e.clientY},document.addEventListener("pointermove",n))}function n(e){if(!m.current)return;const a=(e.clientX-m.current.left)/window.innerWidth,o=(e.clientY-m.current.top)/window.innerHeight;m.current={left:e.clientX,top:e.clientY},p.current.left+=a,p.current.top+=o,t()}function r(){m.current=void 0,document.removeEventListener("pointermove",n)}return document.addEventListener("pointerdown",o,{passive:!0}),document.addEventListener("pointerup",r,{passive:!0}),()=>{document.removeEventListener("pointerdown",o),document.removeEventListener("pointermove",n),document.removeEventListener("pointerup",r)}}),[]);const h=Object.values(s).some((e=>e));return i.createElement(i.Fragment,null,i.createElement("button",{type:"button",className:`${z7} ${h?$7:""}`,onClick:()=>n((e=>!e))},"🚀"),he.createPortal(i.createElement("div",{ref:e,className:Ht(U7,!o&&B7),"data-draggable":!0},i.createElement("div",{className:G7,"data-draggable":!0},i.createElement("div",{className:K7,"data-draggable":!0},"Dev Dashboard"),i.createElement("button",{type:"button",onClick:()=>a((e=>e+1))},"🚮"),i.createElement("button",{type:"button",onClick:()=>n(!1)},"🆇")),i.createElement("div",{className:W7,"data-draggable":!0},i.createElement("button",{type:"button",onClick:()=>c("reports")},"Reports"),i.createElement("button",{type:"button",onClick:()=>c("assets")},"Assets"),i.createElement("button",{type:"button",onClick:()=>c("utils")},"Utils")),i.createElement(g6,{className:Ht(V7,"reports"!==d&&j7),disabled:!o||"reports"!==d,clear:t,setWarningStates:l}),i.createElement(v6,{className:Ht(V7,"assets"!==d&&j7),disabled:!o||"assets"!==d,clear:t,setWarningStates:l}),i.createElement(b6,{className:Ht(V7,"utils"!==d&&j7),disabled:!o||"utils"!==d,clear:t,setWarningStates:l}),i.createElement("div",{className:H7},"Warnings:"," ",Object.entries(s).filter((([e,t])=>t)).map((([e])=>`"${e}"`)).join(", "))),u))},T6=r.exports.memo((()=>{const[e,t]=r.exports.useState(zo);return r.exports.useEffect((()=>Ko((()=>{t(!0)}))),[]),e?i.createElement(_6,null):null}));async function S6(e){if(!e)return null;return(await hu(`/api/v1/users/getUserById?id=${e}`)).user}const I6="RequestToEditButton-module_overlayContainer_Pb8g5",x6="RequestToEditButton-module_leftCol_puP-8",k6="RequestToEditButton-module_rightCol_uCq4I",C6="RequestToEditButton-module_picture_1eeJm",A6="RequestToEditButton-module_header_43brn",N6="RequestToEditButton-module_contentContainer_yTwnF",P6="RequestToEditButton-module_content_OgC8z",R6="RequestToEditButton-module_bold_nMgVa",L6="RequestToEditButton-module_button_jfXug",D6="RequestToEditButton-module_altButton_v9pX9",O6="RequestToEditButton-module_altDisabled_kZJhv",F6=({invite:e})=>{var t;const{currentUser:a,currentVideo:o,videoId:n}=tr((e=>({currentUser:e.currentUser,currentVideo:e.currentVideo,videoId:e.studio._id})),ar),s=m.exports.useDispatch(),[l,d]=r.exports.useState(),[c,u]=r.exports.useState(!0),[p,h]=r.exports.useState(),[g,y]=r.exports.useState();r.exports.useEffect((()=>{if(a.user)try{(async()=>{const e=await S6(o.creatorId);e&&d(e)})()}catch(YEe){console.error("Failed to fetch video creator",YEe),Iu({description:"Failed to fetch video creator",error:YEe})}return()=>{d(void 0)}}),[o.creatorId,a.user]),r.exports.useEffect((()=>((async()=>{if(o.workspaceId){const{name:e,teamId:t}=await KP(o.workspaceId);e&&h(e),t&&y(t)}})(),()=>{h(void 0)})),[o.workspaceId]);const f=null!=(t=l&&l.firstName)?t:uc(l);return i.createElement(i.Fragment,null,g&&i.createElement("button",{type:"button",className:D6,onClick:()=>{u(!0)}},"Accept invite"),c&&i.createElement(_O,{unsetCancelModal:()=>{u(!1)},usePortal:!0,noPadding:!0,noScrollBar:!0,style:{maxWidth:550}},i.createElement("div",{className:I6},i.createElement("div",{className:x6},i.createElement(SQ,{user:l,absoluteHeight:80,absoluteWidth:80,className:C6})),i.createElement("div",{className:k6},i.createElement("div",{className:N6},i.createElement("div",{className:A6},"Accept your invite to"," ",f?`${f}'s team!`:i.createElement("span",null,"the team!")),i.createElement("div",{className:P6},i.createElement("span",null,null!=f?f:"A Kapwing User")," has invited you to join ",i.createElement("b",null,p),". If you accept their invite, you'll be able to edit, comment on, and share this project!")),i.createElement(s9,{buttonText:"Accept invite",className:L6,onClick:async()=>{g&&(u(!1),await s(JE(e)),n&&await NL(n))}})))))},M6=()=>{var e;const{currentUser:t,currentVideo:a,showRequestEditModal:o}=tr((e=>({currentUser:e.currentUser,currentVideo:e.currentVideo,showRequestEditModal:e.sessionValues.showRequestEditModal})),ar),n=m.exports.useDispatch(),s=Si(),[l,d]=r.exports.useState(),[c,u]=r.exports.useState(!1),[p,h]=r.exports.useState(),[g,y]=r.exports.useState(!1),[f,E]=r.exports.useState([]),[v,w]=r.exports.useState();r.exports.useEffect((()=>{if(t.user)try{(async()=>{const e=await S6(a.creatorId);e&&d(e)})()}catch(YEe){console.error("Failed to fetch video creator",YEe)}return()=>{d(void 0)}}),[a.creatorId,t.user]),r.exports.useEffect((()=>((async()=>{if(a.workspaceId){const{name:e,teamId:t}=await KP(a.workspaceId);e&&h(e),t&&w(t)}})(),()=>{h(void 0)})),[a.workspaceId]);const b=sc(t);r.exports.useEffect((function(){return(async()=>{if(!b)return;const e=await YP();e&&E(e.map((e=>e.teamId)))})(),()=>{E([])}}),[b]),r.exports.useEffect((function(){o&&(u(!0),n(Uu(!1)))}),[o,n]);const _=v&&f.includes(v),T=null!=(e=l&&l.firstName)?e:uc(l),S=s?"Sent":"Request sent",I=s?"Edit":"Request to edit";return i.createElement(i.Fragment,null,v&&i.createElement("button",{type:"button",className:`${D6} ${_?O6:""}`,onClick:()=>{sc(t)?u(!0):y(!0),(async(e,t)=>{vc("Request to Edit Button Clicked",{"Team ID":t,"Video ID":e,...await cE()})})(a._id,v)}},_?i.createElement("span",null,S):i.createElement("span",null,I)),g&&i.createElement(ZF,{hideSignIn:()=>y(!1),onSuccess:()=>n(Uu(!0)),customTitle:"Sign in to request to edit this project",customImage:"https://cdn-useast1.kapwing.com/static/aJo-group_604.webp"}),c&&i.createElement(_O,{unsetCancelModal:()=>{u(!1)},usePortal:!0,noScrollBar:!0,noPadding:!0,style:{maxWidth:550}},i.createElement("div",{className:I6},i.createElement("div",{className:x6},i.createElement(SQ,{user:l,absoluteHeight:80,absoluteWidth:80,className:C6})),i.createElement("div",{className:k6},i.createElement("div",{className:N6},i.createElement("div",{className:A6},"Collaborate with ",T," in Kapwing!"),i.createElement("div",{className:P6},"Request edit access to"," ",T?`${T}'s`:i.createElement("span",null,"this")," project. If approved, you will also be added to"," ",T?`${T}'s`:i.createElement("span",null,"the")," team"," ",i.createElement("span",{className:R6},p),".")),i.createElement(s9,{buttonText:"Request edit access",className:L6,onClick:()=>{v&&($P(v,a._id),E((e=>[...e,v])),u(!1))}})))))},U6="ProjectName-module_projectNameContainer_FJ0U0",B6="ProjectName-module_hiddenSpan_zvycS";class W6 extends r.exports.Component{constructor(e){super(e),a(this,"inputRef",null),a(this,"spanRef",null),a(this,"projectNameOnChange",(e=>{this.setState({projectName:e.target.value})})),a(this,"projectNameOnSubmit",(()=>{const{setProjectName:e,projectId:t,currentUser:a}=this.props,{projectName:o}=this.state;null!=o&&e(o),t&&_v(t,{name:o},a)})),a(this,"onEnterPressed",(e=>{var t;"Enter"===e.code&&!1===e.shiftKey&&(e.preventDefault(),null==(t=this.inputRef)||t.blur())})),this.state={projectName:"",width:0}}componentDidMount(){var e;const{projectName:t}=this.props;this.setState({projectName:t,width:(null==(e=this.spanRef)?void 0:e.offsetWidth)||0})}componentDidUpdate(e,t){var a;const{projectName:o,projectId:n,currentUser:r}=this.props;this.state.projectName!==t.projectName&&this.setState({width:(null==(a=this.spanRef)?void 0:a.offsetWidth)||0}),o!==e.projectName&&(this.setState({projectName:o}),""===o&&n&&_v(n,{name:o},r))}render(){const{projectName:e,width:t}=this.state,{isBrandKitTemplate:a}=this.props;let o="Untitled Project";e?o=e:a&&(o="Untitled Template");const n=`${o} — Kapwing`;return i.createElement(i.Fragment,null,i.createElement(rt,null,i.createElement("title",null,n)),i.createElement("span",{className:B6,ref:e=>{this.spanRef=e}},o),i.createElement("input",{ref:e=>{this.inputRef=e},disabled:this.props.disabled,className:U6,style:{width:t},"data-cy":"studio-project-name-field",onChange:this.projectNameOnChange,onBlur:this.projectNameOnSubmit,onKeyDown:this.onEnterPressed,placeholder:a?"Untitled Template":"Untitled Project",value:e}))}}const V6=m.exports.connect((e=>({projectName:e.projectName,projectId:e.studio.projectId,currentUser:e.currentUser,isBrandKitTemplate:e.studio.isBrandKitTemplate})),(e=>me({setProjectName:JP},e)))(W6),j6=(e,t)=>!e||t,G6=async(e,t="",a=!1)=>{const{dispatch:o,state:n}=tn(),{studio:r,currentUser:i,videoSaving:s,projectName:l}=n,{_id:d,projectId:c,scenes:u,videoType:m,duration:p}=r,{pathname:h}=window.location,g=()=>window.location.pathname!==h;if("gif"===(t||m)&&p>60)return o(Su({description:"Max GIF duration is 60 seconds. Please trim your video or switch output to mp4.",type:"error"})),{success:!1};if(((e,t,a)=>e&&!t||!e&&a)(d,e,s))return o(Su({description:"Saving your work - please wait a second and try again.",type:"error"})),{success:!1};if(!(e=>{for(const t of e)for(const e of t.layers){if("begun"===e.videoConvertedState)return console.error("Layer still converting:",e),iT("/studio/editor/conversion-warning"),!1;if("image/webp"===e.mime&&"unknown"===e.webpType)return console.error("Layer still processing image:",e),iT("/studio/editor/image-processing-warning"),!1}return!0})(u))return o(Su({description:"A layer is still converting. Please try again later.",type:"error"})),{success:!1};a||o(cw(-1)),m!==Ei.MP3||t||o(sw(Ei.MP4));const f=function(e,t,a="videoState",o=!1,n){let{studio:r}=e;!r&&e.scenes&&(r=e);const{videoType:i}=r;if(i!==Ei.IMAGE)return!1;const s=Object.keys(r.magicSubtitles||{}).length>0;let l=!1;if(Dl())l=!1;else if(I4(r,t,o))l=!0;else if(t4(e,a)){if(s)return!1;const e=r.scenes[0].layers[0];if(!r.width||!r.height)return!1;const t=r.width/r.height;if("mp4"!==i&&"mp4_convert"!==i?l=!1:Z5(e,t,r.ratio,{exportQuality:r.exportQuality,exportResolution:r.exportResolution})&&n&&!a$(r.duration)&&(l=!0),e4(e,t)&&kl()&&n&&dc(n)){if(s)return!1;l=!0}}else l=!1;return l}(n,p,"videoState",a,i);let E,v,w=!1,b={};const _=Date.now(),T="Failed to client side process video";try{if(f)try{const e=await x4(i,n,p,a,"videoState");if(g())return{success:!0,processOnClient:f};if((!e.processed||!e.newUrl)&&r.duration>0)throw Error(T);w=e.processed,E=e.read_uri,v=e.ffmpegData,b=e.buildInfo}catch(YEe){throw Error(T)}const e="Studio Draft"===l||""===l?"Studio Project":l;c&&i&&await _v(c,{name:e},i),await(async()=>{const{state:e,dispatch:t}=tn(),a=lC(e);if(a.length<0)return;const o=async a=>{if(!VC({assetId:a,filterEmpty:!0,filterInvalid:!0})(e).length)return;const{preset:o,style:n,wordByWordAnimations:r,transitionId:i,transitionDuration:s,transitionOverlapDuration:l,transitionSpeed:d}=mC(a)(e),c=o||UD(n,r,i?{transitionId:i,transitionDuration:s,transitionOverlapDuration:l,transitionSpeed:d}:void 0,`preset-${y()}`,e.projectName);!c.projectId&&e.studio.projectId&&(c.projectId=e.studio.projectId),t(Ax({updates:{preset:c},undoable:!1})),(null==c?void 0:c.teamId)&&await CD({...c,sortNdx:0}),t($m({preset:c}))};try{await Promise.all(a.map(o))}catch(YEe){console.error(YEe)}})(),await function(){const{state:e,dispatch:t}=tn(),{projectId:a}=e.studio,o=Object.values(e.studio.allLayers.byId).filter((e=>e.type===ln.Text&&!e.fromTextDefaults));if(0===o.length)return;const n=e.textPresets.presets,r={};n.forEach((e=>{r[e.presetId]=e}));const i=new Set,s=[];o.forEach((e=>{const t=_G(e);let o=r[t.presetId];o&&TG(o,t)||(o=[...s,...n].find((e=>TG(e,t))));let l=null==o?void 0:o.presetId;!l&&(l=`preset-${y()}`,t.presetId=l,t.projectId=a||void 0),l&&!i.has(l)&&(i.add(l),s.push(t)),e.presetId!==l&&px({[e.id]:{presetId:l}})}));const l=n.filter((e=>!i.has(e.presetId)));s.reverse();const d=[...s,...l];t(Dp({presets:d}))}();const s=t||a?"studio-publish-dropdown":"studio-publish",d=await o(D4({currentUser:i,publish:!0,auto:!1,createLocation:s,processedOnClient:w}));if(g())return{success:!0,processOnClient:f};if(w){o(dR({local_url:E,fullPath:E,image_url:E})),await U4(d._id,{done:!0,draft:!1});const e=d.scenes[0].layers.some((e=>"video"===e.type));window.Cypress&&e?await U4(d._id,{done:!0,draft:!1}):((e,t,a,o,n)=>{var r;const i=sc(e)?e.user._id:null,s=Date.now();let l=0,d=0;t.scenes.forEach((e=>{l+=e.layers.length,d+=e.duration}));const c={...n,buildDuration:(s-a)/1e3,layerDuration:d,layerCount:l,outputDuration:null!=(r=t.duration)?r:null,sceneCount:t.scenes.length};o&&(c.ffmpegData=o),U4(t._id,{build:c}),"mp4"===t.videoType&&vc("Video Proccessed",{clientSideProcessed:!0,creatorId:i,isStudio:!0})})(i,d,_,v,b)}return f&&await U4(d._id,{processedOnClient:w}),{success:!0,processOnClient:f}}catch(S){if(!S||"object"!=typeof S)return Iu({description:"Failed to export",error:S}),{success:!1};if("statusCode"in S&&425===S.statusCode)return iT("/studio/editor/upload-warning"),{success:!1};const{message:e}=xu(S);return e===T&&d?(console.error(T),await H6(d,"Error"),{success:!1}):(Iu({description:"Failed to export",error:S}),{success:!1})}},H6=async(e,t)=>{const{dispatch:a,state:o}=tn(),{currentUser:n}=o;await a(D4({currentUser:n,publish:!0,auto:!1,createLocation:"studio-publish",processedOnClient:!1})),await U4(e,{pendingProcessOnClient:!1,clientSideProcessingInProgress:!1}),vc("Create Failed Client Side Video",{videoId:e,Reason:t})},z6="PublishContainer-module_disabled_IPIcO",$6="PublishContainer-module_createButton_RiHLs",K6="PublishContainer-module_createButtonDisabled_llU9O",Y6="PublishContainer-module_createButtonWarning_mGShM",q6="PublishContainer-module_buttonContainer_HL-ly",X6="PublishContainer-module_exportIcon_lDu4V",J6="PublishContainer-module_shortButtonName_1dDzb",Q6="PublishContainer-module_longButtonName_u55DI",Z6="PublishContainer-module_displayNone_KPyJE",eee="PublishOverlay-module_blueButton_G-bG6",tee="PublishOverlay-module_exportAnywayButton_6a9CT",aee="PublishOverlay-module_greenButton_qvdKy",oee="PublishOverlay-module_header_1ABTD",nee="PublishOverlay-module_primaryImage_2RGo1",ree="PublishOverlay-module_description_xSsYO",iee="PublishOverlay-module_descriptionGray_MncCf",see="PublishOverlay-module_descriptionScrollBox_9XkTn",lee="PublishOverlay-module_buttonContainer_evD-N",dee=e=>{const{onClose:t,onContinue:a,overlappingSubtitle:o}=e,n=m.exports.useDispatch(),r=o.type===pn.classic?"":" magic";return i.createElement(NM,{onClose:t},i.createElement("div",{className:oee},"Heads up! Overlapping Subtitles"),i.createElement("div",{className:ree},"Your project has overlapping",r," subtitles. This is likely unintentional. Please consider addressing this before exporting your project."),i.createElement("div",{className:lee},i.createElement("div",{className:aee,onClick:()=>a()},"Export anyway"),i.createElement("div",{className:eee,onClick:e=>{if(o.type===pn.classic&&n(Kh({id:o.layer.id,type:"layer"})),n(VR({tabId:El.subtitles,tabContainerId:"media-sidebar"})),"magic"===o.type){const{layer:e}=o,{start:t}=e.frame;IT(t+.01)}t(),e.stopPropagation()}},"Fix overlapping subtitles")))},cee=()=>{const{state:e}=tn(),{layers:t}=e.studio.scenes[0],{studio:{selectedTimelineRows:a}}=e,o=a[0],n=[...hee(o,t),...gee(o,t)],r={};n.forEach((e=>{r[e.id]={timelineRow:e.timelineRow+1}})),px(r,!0)},uee=()=>iT("/studio/editor/delete-row"),mee=()=>{const{state:e,dispatch:t}=tn(),{layers:a}=e.studio.scenes[0],{studio:{selectedTimelineRows:o}}=e;let n=[];for(let c=0;c<o.length;c+=1){const e=o[c],t=hee(e,a);n=[...n,...t]}const r=o.sort(((e,t)=>e-t)),i=r[0],s=r[r.length-1],l=[...yee(i,s,o,a),...gee(s,a)],d={};for(let c=i,u=0;c<=s;c+=1)c===r[u]&&(u+=1),d[c]=u;Jl.withUndoBatch((()=>{m.exports.batch((()=>{const e=n.map((e=>e.id));zB({layerIds:e});const t={};l.forEach((e=>{const{timelineRow:a=0}=e,o=a>s?d[s]:d[a];t[e.id]={timelineRow:a-o}})),px(t,!0)}))}))(),t(jh([]))},pee=(e,t)=>{const{state:a}=tn(),{layers:o}=a.studio.scenes[0];let n,r,i;[n,r,i]=e<t?[e,t,-1]:[t,e,1];const s=hee(e,o);let l=[];for(let c=n;c<=r;c+=1)c!==e&&(l=[...l,...hee(c,o)]);const d={};s.forEach((e=>{d[e.id]={timelineRow:t}})),l.forEach((e=>{d[e.id]={timelineRow:e.timelineRow+i}})),px(d,!0)},hee=(e,t)=>{let a=[];return t.every(((o,n)=>void 0!==o.timelineRow&&o.timelineRow===e?"subtitle"===o.type?(a=t.slice(n),!1):(a.push(o),!0):"subtitle"!==o.type)),a},gee=(e,t)=>{const a=[];return t.every((t=>void 0!==t.timelineRow&&t.timelineRow>e?(a.push(t),!0):"subtitle"!==t.type)),a},yee=(e,t,a,o)=>o.filter((({timelineRow:o})=>void 0!==o&&e<o&&o<t&&!a.includes(o))),fee=e=>{const{layers:t}=e.studio.scenes[0],{duration:a}=e.studio;if(0===a)return[];const o=[...t];o.sort(((e,t)=>zS(e,0)[0]-zS(t,0)[0]));const n=[{startTime:0,endTime:0}];if(o.forEach((e=>{const[t,a]=zS(e,0),o=n[n.length-1];t-.01<=o.endTime?n[n.length-1].endTime=Math.max(a,o.endTime):n.push({startTime:t,endTime:a})})),1===n.length)return[];const r=[];return n.forEach(((e,t)=>{const a=n[t+1];t!==n.length-1&&r.push({startTime:e.endTime,endTime:a.startTime})})),r},Eee=e=>{const{onClose:t,onExportAnyway:a}=e,{gapsInTimeline:o}=tr((e=>({gapsInTimeline:fee(e)})),ar),n=m.exports.useDispatch();return i.createElement(NM,{onClose:t},i.createElement("div",{className:oee},"Empty Frames Detected In Your Video"),i.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/dFU-gapsInTimeline.png",className:nee,alt:"Gaps in timeline"}),i.createElement("div",{className:iee},"We found gaps in your project! Did you mean for this to happen? Add media or adjust your timing to avoid empty space in your final project."),i.createElement("div",{className:iee},i.createElement("div",null,i.createElement("b",null,"Empty frames detected in your project")),i.createElement("div",{className:see},o.map(((e,t)=>i.createElement("div",{key:t},`${uf(e.startTime)} -- ${uf(e.endTime)}`))))),i.createElement("div",{className:lee},i.createElement("div",{className:tee,onClick:()=>{t(),a()}},"Export anyway"),i.createElement("div",{className:eee,onClick:()=>{iT("/studio/editor"),n(Bu(!1));const e=o[0];e&&YA(e.startTime),n(ag(!0)),t()}},"Check the timeline")))},vee=()=>{var e,t;const{state:a}=tn(),{scenes:o}=a.studio,n=o[0],{layers:r}=n;let i=!1;for(let s=0;s<r.length;s+=1)if("subtitle"===(null==(e=r[s])?void 0:e.type)&&""!==(null==(t=r[s])?void 0:t.text)){i=!0;break}return i},wee=e=>Math.round(1e3*e)/1e3;function bee(e,t){for(let a=0;a<e.length-1;a+=1){const o=e[a],n=e[a+1];if((!(null==o?void 0:o.frame)||!(null==n?void 0:n.frame)||o.frame.id!==n.frame.id)&&(o&&wee(o.endTime)-t>wee(n.startTime)))return o}}const _ee=()=>{var e,t,a,o,n,r,i,s;const{studio:l}=tr((e=>e)),d=tr((e=>AF(e))),{byId:c}=tr((e=>e.assets)),u=tr((e=>e.studio.scenes),ar),m=XD(Ps.REMOVE_BACKGROUND),p=!m&&(null==(e=u[0])?void 0:e.layers.some((e=>{var t;return e.backgroundRemoved||e.asset_id&&"remove-background"===(null==(t=c[e.asset_id])?void 0:t.usedProFeature)}))),h=!m&&(null==(t=u[0])?void 0:t.layers.some((e=>"remove-video-background"===e.usedProFeature))),g=!XD(Ps.CLEAN_AUDIO)&&(null==(a=u[0])?void 0:a.layers.some((e=>{var t;return e.asset_id&&"clean-audio"===(null==(t=c[e.asset_id])?void 0:t.usedProFeature)}))),y=XD(Ps.SMART_CUT),f=!y&&(null==(o=u[0])?void 0:o.layers.some((e=>"smart-cut"===e.usedProFeature&&e.type===ln.Video))),E=!y&&(null==(n=u[0])?void 0:n.layers.some((e=>"smart-cut"===e.usedProFeature&&e.type===ln.Audio))),v=!XD(Ps.AUDIOGRAM)&&(null==(r=u[0])?void 0:r.layers.some((e=>"audiogram"===e.usedProFeature))),w=!XD(Ps.TEXT_TO_SPEECH)&&(null==(i=u[0])?void 0:i.layers.some((e=>"text-to-speech"===e.usedProFeature))),b=!XD(Ps.UNLIMITED_EXPORT_DURATION_LIMIT)&&l.duration>420,_=!XD(Ps.UNLIMITED_UPLOAD_SIZE_LIMIT)&&(null==(s=u[0])?void 0:s.layers.some(tH));let T;p?T=Rs.BACKGROUND_IMAGE_ERASE:_?T=Rs.UPLOAD_LIMIT:b?T=Rs.SINGLE_VIDEO_DURATION_LIMIT:g?T=Rs.CLEAN_AUDIO:f?T=Rs.SMART_CUT_VIDEO:E?T=Rs.SMART_CUT_AUDIO:h?T=Rs.REMOVE_VIDEO_BACKGROUND:v?T=Rs.AUDIOGRAM_BAR:w?T=Rs.TEXT_TO_SPEECH:JG()?T=Rs.SINGLE_VIDEO_DURATION_LIMIT:QG()&&(T=Rs.DEFAULT);const S=(()=>{const e=lC(tn().state);for(const t of e){const e=OC({assetId:t,filterEmpty:!0,filterInvalid:!0})(tn().state);e.sort(((e,t)=>e.startTime-t.startTime));const a=bee(e,0);if(a)return a}})(),I=(()=>{const{layers:e}=tn().state.studio.scenes[0];return bee(AB(e).sort(((e,t)=>e.startTime-t.startTime)),.01)})();let x;return S?x={type:pn.magic,layer:S}:I&&(x={type:pn.classic,layer:I}),{exportBlockedAction:T,overlappingSubtitle:x,pendingUploads:d}},Tee=({submitting:e,handleClick:t,exportBlocked:a,isBrandKitTemplate:o,exportBlockedOnDurationPro:n,shrinkCreateButton:r})=>{const{exportBlockedAction:s}=_ee(),l=tr((e=>e.userPermissions.canWrite)),d=tr((e=>{var t;return"exportPanel"===(null==(t=e.projectSessionSettings.overlay)?void 0:t.key)})),{buttonName:c,buttonIcon:u,shortButtonName:m}=((e,t,a,o)=>{let n=i.createElement(zt,{className:X6}),r="Export Project";return e&&(r="published"===e?"Published to Workspace":"Publish to Workspace"),"published"===e&&(r="Published to Workspace"),t&&(n=null,r=e?"Publish":"Export"),a&&!o&&(n=i.createElement(Pn,null)),{buttonName:r,shortButtonName:e?"Publish":"Export",buttonIcon:n}})(o,r,a,n);return e?i.createElement("div",{className:`${$6} ${K6}`,"data-cy":"loading-create-button"},"Loading..."):i.createElement("div",{className:`${$6}\n          ${s||a&&!n?Y6:""}\n          ${d||!l?z6:""}\n          ${n?K6:""}\n          ${o?Z6:""}`,"data-cy":"create-button",onClick:e=>{e.stopPropagation(),t()}},i.createElement("span",{className:Q6},c),i.createElement("span",{className:J6},m),u)},See=(e,t)=>{const a=(()=>{const[e,t]=r.exports.useState(!document.hidden);return r.exports.useEffect((()=>{const e=()=>t(!document.hidden);return document.addEventListener("visibilitychange",e),()=>document.removeEventListener("visibilitychange",e)}),[]),e})();r.exports.useEffect((()=>{const o=setInterval(a?e:()=>null,t);return()=>clearInterval(o)}),[e,t,a])},Iee=e=>async t=>{const{currentUser:a}=tn().state;if(!sc(a))return;const o=await hu(`/api/v2/snapshots/${e}/exports?fetchRunningExports`);t(Xm(o))},xee=(e,t)=>async a=>{const{currentUser:o}=tn().state;if(!sc(o))return;a(Qm());const n=await hu(`/api/v2/snapshots/${e}/exportHistory?fetchSnapshots`,{signal:t});a(Jm(n))},kee="LoadingSpinner-module_spinnerWrapper_sY-yh",Cee="LoadingSpinner-module_spinner_HkeKv",Aee=({fontSize:e=16})=>i.createElement("div",{className:kee},i.createElement($t,{className:Cee,style:{fontSize:e}})),Nee=[5,11,17,23,30,40,50,66,85,100,125,155,178,200,250],Pee=e=>{if(!e.progressDict)return 0;const{stageNum:t,numStages:a,stagePercentage:o}=e.progressDict,n=a&&(t-1)/a*100,r=a&&o/a,i=Math.round(isNaN(n+r)?0:n+r);if(i>=Nee.length)return Math.round(i);const s=((new Date).getTime()-new Date(e.createdAt).getTime())/1e3;let l=0;for(let d=0;d<Nee.length;d++){const e=Nee[d];if(!e)return Math.max(15,i);if(!(s>=e))break;l+=1}return Math.max(i,l)};var Ree=(e=>(e.Workspace="workspace",e.Studio="studio",e))(Ree||{});const Lee="ExportProgressButton-module_buttonWrapper_Lenyy",Dee="ExportProgressButton-module_innerButtonWrapper_CVZWC",Oee="ExportProgressButton-module_progressNum_g7F6x",Fee="ExportProgressButton-module_progressPercent_7B7X5",Mee="ExportProgressButton-module_icon_aejxg",Uee=()=>{const{progress:e,isDisabled:t,pendingExport:a,runningExportsLength:o}=(()=>{const e=m.exports.useDispatch(),t=tr((e=>e.studio._id)),a=tr((e=>e.userPermissions.canWrite)),o=tr((e=>e.exports.pendingExport)),n=tr((e=>{var t;return"exportPanel"===(null==(t=e.projectSessionSettings.overlay)?void 0:t.key)})),{runningExportsLength:i,exportProgress:s}=tr((e=>{const{runningExports:t}=e.exports;if(t.length>0){const e=[...t].sort(((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()))[0];if(e)return{runningExportsLength:t.length,exportProgress:Pee(e)}}return{runningExportsLength:t.length,exportProgress:0}}),ar);r.exports.useEffect((function(){e(rp()),t&&e(Iee(t))}),[e,t]);const[l,d]=r.exports.useState(i),[c,u]=r.exports.useState(s);r.exports.useEffect((()=>{u(s)}),[s]),r.exports.useEffect((()=>{d(i)}),[i]);const[p,h]=r.exports.useState(l);return r.exports.useEffect((()=>{l<p&&(u(101),setTimeout((()=>u(0)),1e4),t&&e(xee(t)),new Audio("/export-notification-chime.mp3").play()),h(l)}),[l,t,e,p]),See((()=>{t&&(i||o)&&e(Iee(t))}),6e3),See((()=>{t&&e(Iee(t))}),6e4),{progress:c,isDisabled:n||!a,pendingExport:o,runningExportsLength:i}})();return i.createElement("div",{className:Lee},i.createElement(kU,{progress:e,noPadding:!0,onClick:()=>pA(uh.HISTORY),overrideColor:Ree.Studio,disabled:t},i.createElement("div",{className:Dee},e||a||o?e>=100?i.createElement(Te,{className:Mee}):o||!(e<=0)&&e?i.createElement("span",{className:Oee},e,i.createElement("span",{className:Fee},"%")):i.createElement(Aee,null):i.createElement(Kt,{className:Mee}))))},Bee=c((e=>e.studio.videoType),(e=>e.studio.duration),(e=>e.studio.scenes),((e,t,a)=>{const o=e.toLowerCase();let n="";return t?n="gif"===o?"GIF":"Video":"gif"===o?n="GIF":(e=>{for(const t of e)for(const e of t.layers)if("video"===e.type&&!e.converted_gif)return!0;return!1})(a)||(n="Image"),n}));class Wee extends r.exports.Component{constructor(e){super(e),a(this,"_mounted",!1),a(this,"validationStageModals",[{stage:"gapInTimeline",render:()=>i.createElement(Eee,{onClose:()=>this.bailOnExportValidation(),onExportAnyway:()=>this.advanceValidationStage(this.nextStage())})},{stage:"classicOverlap",render:()=>i.createElement(dee,{onClose:()=>{var e;this.bailOnExportValidation();const t=null==(e=this.state.overlappingClassicSubtitle)?void 0:e.id;t&&tn().dispatch(Kh({id:t,type:"layer"})),iT("/studio/editor/subtitles")},onContinue:()=>this.advanceValidationStage(this.nextStage()),overlappingSubtitle:{type:pn.classic,layer:this.state.overlappingClassicSubtitle}})},{stage:"magicOverlap",render:()=>i.createElement(dee,{onClose:()=>{this.bailOnExportValidation(),tn().dispatch(Kh({type:"magicSubtitle",frames:[]})),iT("/studio/editor/subtitles")},onContinue:()=>this.advanceValidationStage(this.nextStage()),overlappingSubtitle:{type:pn.magic,layer:this.state.overlappingMagicSubtitle}})}]),a(this,"setSubmitting",(e=>{this.setState({submitting:e})})),a(this,"handleClick",(()=>{const{overlayWithHeader:e,exportBlocked:t,exportBlockedAction:a,exportBlockedOnDurationPro:o,canWrite:n,dispatch:r}=this.props;if(n){if(!o)return t?(vc("Paywalled Export Clicked",{"Limit Source":kc(a)}),void zU((()=>{}),{action:a})()):void(JG()?iT("/studio/editor/warning"):QG()?iT("Scenes"===e?"/studio/editor/scenes/upgrade":"/studio/editor/upgrade"):this.advanceValidationStage(0));r(Q_("proUserDurationLimit"))}})),a(this,"handleExport",(async(e="")=>{const{videoFetched:t}=this.props;try{this.setSubmitting(!0),await G6(t,e)}catch(a){console.error(a)}finally{this._mounted&&this.setSubmitting(!1)}})),a(this,"nextStage",(()=>{var e;return(null!=(e=this.state.exportStageNdx)?e:0)+1})),a(this,"advanceValidationStage",(e=>{var t;if(null===e)return void this.advanceValidationStage(0);const a=null==(t=this.validationStageModals[e])?void 0:t.stage;if(!a)return this.setState({exportStageNdx:null}),void pA();switch(a){case"gapInTimeline":if(fee(tn().state).length>0)return void this.setState({exportStageNdx:e});break}this.advanceValidationStage(e+1)})),a(this,"bailOnExportValidation",(()=>{this.setState({exportStageNdx:null,overlappingMagicSubtitle:void 0,overlappingClassicSubtitle:void 0})})),this.state={exportStageNdx:null}}componentDidMount(){const{signedOut:e,location:t,canWrite:a}=this.props;a&&(this.showTooltipIfFreeLimitExceeded(),this.showTooltipIfProLimitExceeded(),this.showTooltipIfCleanAudioUsed(),this.showTooltipIfSmartCutUsed(),this.showTooltipIfRemoveVideoBackgroundUsed(),this.showTooltipIfAudiogramUsed(),this.showTooltipIfTextToSpeechUsed());const o=new URLSearchParams(t.search);e||("true"===o.get(h9.EXPORT_VIDEO)?this.handleExport():"true"===o.get(h9.OPEN_EXPORT_PANEL)&&pA(uh.SETTINGS)),this._mounted=!0}componentDidUpdate(e){const{dispatch:t,exportBlocked:a,canWrite:o}=this.props;e.exportBlocked&&!a&&(t(mw("freeUserFileSizeLimitWarned",!1)),t(mw("freeUserDurationLimitWarned",!1)),t(mw("cleanAudioUsed",!1)),t(mw("smartCutUsed",!1)),t(mw("removeVideoBackgroundUsed",!1)),t(mw("audiogramUsed",!1)),t(mw("textToSpeechUsed",!1))),o&&(this.showTooltipIfFreeLimitExceeded(),this.showTooltipIfProLimitExceeded(),this.showTooltipIfCleanAudioUsed(),this.showTooltipIfSmartCutUsed(),this.showTooltipIfRemoveVideoBackgroundUsed(),this.showTooltipIfAudiogramUsed(),this.showTooltipIfTextToSpeechUsed())}componentWillUnmount(){this._mounted=!1}showTooltipIfFreeLimitExceeded(){const{dispatch:e,exportBlocked:t,exportBlockedOnDuration:a,exportBlockedOnFilesize:o,freeUserDurationLimitWarned:n,freeUserFileSizeLimitWarned:r,isProjectFetched:i,showingTooltip:s}=this.props;i&&(a&&!n?(e(Q_("freeUserDurationLimit")),e(mw("freeUserDurationLimitWarned",!0))):o&&!r?(e(Q_("freeUserSizeLimit")),e(mw("freeUserFileSizeLimitWarned",!0))):t||"freeUserDurationLimit"!==s&&"freeUserSizeLimit"!==s||e(Q_("")))}showTooltipIfProLimitExceeded(){const{dispatch:e,exportBlockedOnDurationPro:t,showingTooltip:a,proUserDurationLimitWarned:o}=this.props;t&&!o?(e(Q_("proUserDurationLimit")),e(mw("proUserDurationLimitWarned",!0))):t||"proUserDurationLimit"!==a||e(Q_(""))}showTooltipIfCleanAudioUsed(){const{dispatch:e,exportBlockedOnCleanAudio:t,cleanAudioFeatureUsedWarned:a,showingTooltip:o}=this.props;t&&!a?(e(Q_("cleanAudioUsed")),e(mw("cleanAudioUsed",!0))):t||"cleanAudioUsed"!==o||e(Q_(""))}showTooltipIfSmartCutUsed(){const{dispatch:e,exportBlockedOnSmartCutAudio:t,exportBlockedOnSmartCutVideo:a,smartCutFeatureUsedWarned:o,showingTooltip:n}=this.props,r=t||a;if(r&&!o){e(Q_(a?"videoSmartCutUsed":"audioSmartCutUsed")),e(mw("smartCutUsed",!0))}else r||"videoSmartCutUsed"!==n&&"audioSmartCutUsed"!==n||e(Q_(""))}showTooltipIfRemoveVideoBackgroundUsed(){const{dispatch:e,exportBlockedOnRemoveVideoBackground:t,removeVideoBackgroundUsedWarned:a,showingTooltip:o}=this.props;t&&!a?(e(Q_("removeVideoBackgroundUsed")),e(mw("removeVideoBackgroundUsed",!0))):t||"removeVideoBackgroundUsed"!==o||e(Q_(""))}showTooltipIfAudiogramUsed(){const{dispatch:e,exportBlockedOnAudiogram:t,audiogramUsedWarned:a,showingTooltip:o}=this.props;t&&!a?(e(Q_("audiogramUsed")),e(mw("audiogramUsed",!0))):t||"audiogramUsed"!==o||e(Q_(""))}showTooltipIfTextToSpeechUsed(){const{dispatch:e,exportBlockedOnTextToSpeech:t,textToSpeechUsedWarned:a,showingTooltip:o}=this.props;t&&!a?(e(Q_("textToSpeechUsed")),e(mw("textToSpeechUsed",!0))):t||"textToSpeechUsed"!==o||e(Q_(""))}render(){const{disabled:e,shrinkCreateButton:t,isBrandKitTemplate:a,exportBlocked:o,canWrite:n}=this.props,{exportStageNdx:r}=this.state;if(!n)return null;const s=a?"Publish":"Export",l=a?"Publish to Workspace":"Export Project";if(e)return i.createElement(N7,{tooltips:{convert:["mobile"]},position:"bottom"},i.createElement("div",{className:`${$6} ${K6} ${a?Z6:""}`},t?s:l));const d=null!==r?this.validationStageModals[r]:null,c=e?i.createElement("div",{className:`${$6} ${K6} ${a?Z6:""}`},t?s:l):i.createElement("div",{className:q6},d&&d.render(),i.createElement(Tee,{submitting:!!this.state.submitting,handleClick:this.handleClick,exportBlocked:!!o,isBrandKitTemplate:!!a,exportBlockedOnDurationPro:this.props.exportBlockedOnDurationPro,shrinkCreateButton:!!t}),this.props.videoId&&i.createElement(Uee,{videoId:this.props.videoId,handleClick:this.handleClick}));return i.createElement(N7,{tooltips:{convert:["mobile","video","audio"],compressVideo:["video"]},position:"bottom"},c)}}const Vee=we(m.exports.connect((e=>{var t,a,o,n,r,i,s,l;const{studio:d,currentUser:c,assets:{byId:u}}=e,{scenes:m}=d,p=!c.token,h=JD(Ps.REMOVE_BACKGROUND),g=!h&&(null==(t=m[0])?void 0:t.layers.some((e=>{var t;return e.backgroundRemoved||e.asset_id&&"remove-background"===(null==(t=u[e.asset_id])?void 0:t.usedProFeature)}))),y=!h&&(null==(a=m[0])?void 0:a.layers.some((e=>"remove-video-background"===e.usedProFeature))),f=!JD(Ps.CLEAN_AUDIO)&&(null==(o=m[0])?void 0:o.layers.some((e=>{var t;return e.asset_id&&"clean-audio"===(null==(t=u[e.asset_id])?void 0:t.usedProFeature)}))),E=JD(Ps.SMART_CUT),v=!E&&(null==(n=m[0])?void 0:n.layers.some((e=>"smart-cut"===e.usedProFeature&&e.type===ln.Video))),w=!E&&(null==(r=m[0])?void 0:r.layers.some((e=>"smart-cut"===e.usedProFeature&&e.type===ln.Audio))),b=!JD(Ps.AUDIOGRAM)&&(null==(i=m[0])?void 0:i.layers.some((e=>"audiogram"===e.usedProFeature))),_=!JD(Ps.TEXT_TO_SPEECH)&&(null==(s=m[0])?void 0:s.layers.some((e=>"text-to-speech"===e.usedProFeature))),T=!JD(Ps.UNLIMITED_EXPORT_DURATION_LIMIT)&&d.duration>420,S=!JD(Ps.UNLIMITED_UPLOAD_SIZE_LIMIT)&&(null==(l=m[0])?void 0:l.layers.some(tH)),I=d.duration>7200,x=T||I||S||g||f||w||v||y||b||_;let k=Rs.DEFAULT;return g?k=Rs.BACKGROUND_IMAGE_ERASE:S?k=Rs.UPLOAD_LIMIT:T?k=Rs.SINGLE_VIDEO_DURATION_LIMIT:f?k=Rs.CLEAN_AUDIO:v?k=Rs.SMART_CUT_VIDEO:w?k=Rs.SMART_CUT_AUDIO:y?k=Rs.REMOVE_VIDEO_BACKGROUND:b?k=Rs.AUDIOGRAM_BAR:_&&(k=Rs.TEXT_TO_SPEECH),{type:Bee(e),exportBlocked:x,exportBlockedAction:k,exportBlockedOnRemoveBg:g,exportBlockedOnCleanAudio:f,exportBlockedOnSmartCutAudio:w,exportBlockedOnSmartCutVideo:v,exportBlockedOnAudiogram:b,exportBlockedOnRemoveVideoBackground:y,exportBlockedOnTextToSpeech:_,exportBlockedOnDuration:T,exportBlockedOnDurationPro:I,exportBlockedOnFilesize:S,freeUserDurationLimitWarned:Vl(e,"freeUserDurationLimitWarned"),freeUserFileSizeLimitWarned:Vl(e,"freeUserFileSizeLimitWarned"),proUserDurationLimitWarned:Vl(e,"proUserDurationLimitWarned"),cleanAudioFeatureUsedWarned:Vl(e,"cleanAudioUsed"),smartCutFeatureUsedWarned:Vl(e,"smartCutUsed"),removeVideoBackgroundUsedWarned:Vl(e,"removeVideoBackgroundUsed"),audiogramUsedWarned:Vl(e,"audiogramUsed"),textToSpeechUsedWarned:Vl(e,"textToSpeechUsed"),isProjectFetched:e.studioLocal.isProjectFetched,overlayWithHeader:d.overlayWithHeader,showingTooltip:e.toolTip,signedOut:p,isBrandKitTemplate:e.studio.isBrandKitTemplate,brandkitTemplates:e.teams.brandkitTemplates,videoId:e.studio._id,canWrite:e.userPermissions.canWrite}}))(Wee));let jee,Gee;async function Hee(e,t,a,o){let n,r;try{const e=await t.getInternalRecorder();if(n=await new Promise((t=>e.stop(t))),kl()&&(n=await Yt(n,o)),!n||!n.size)throw new Error("Screen recording failed. Please try again.")}catch(YEe){return void console.error(YEe)}e.getTracks().forEach((e=>e.stop())),t.reset(),r="screen"===a||"screen-video"===a||"video"===a?"video/webm":"audio/webm";const i=new File([n],`${a}-recording.webm`,{type:r});return i.recordType=a,i}function zee(e){const t=e.getTracks().some((e=>"video"===e.kind)),a=function(e,t){if("audio"===t)return new Gee(e,{type:"audio",mimeType:"audio/webm",disableLogs:!1,timeSlice:3e4,recorderType:jee});return new Gee(e,{videoBitsPerSecond:$ee(e),type:"video",mimeType:"video/webm",disableLogs:!1,timeSlice:3e4,recorderType:jee})}(e,t?"video":"audio");return a.startRecording(),a}function $ee(e){const t=e.getVideoTracks()[0];if(null==t)return;const a=t.getSettings();if("number"!=typeof a.width||"number"!=typeof a.height)return 8e6;const o=a.width>a.height?a.height:a.width;return"number"!=typeof a.frameRate||a.frameRate<=30?o<=360?1e6:o<=480?25e5:o<=720?5e6:8e6:o<=360?15e5:o<=480?4e6:o<=720?75e5:12e6}async function Kee(e){let t;try{t=navigator.mediaDevices.getDisplayMedia?await navigator.mediaDevices.getDisplayMedia({video:{cursor:"always",frameRate:24},audio:e}):await navigator.getDisplayMedia({video:{cursor:"always",frameRate:24},audio:e})}catch(a){if(a instanceof Error&&"NotAllowedError"===a.name)return"permissionError"}return t}async function Yee(e,t,a){let o;try{o=await navigator.mediaDevices.getUserMedia({video:{deviceId:t},audio:!!e&&{deviceId:a}})}catch(n){if(n instanceof Error&&"NotAllowedError"===n.name)return"permissionError"}return o}async function qee(e){let t;try{t=await navigator.mediaDevices.getUserMedia({audio:{deviceId:e}})}catch{}return t}function Xee(){let e=!1,t=!1,a=!1;return Rl()||Nl()||(navigator.mediaDevices&&"getUserMedia"in navigator.mediaDevices&&(e=!0,t=!0),(navigator.mediaDevices&&"getDisplayMedia"in navigator.mediaDevices||"getDisplayMedia"in navigator)&&(a=!0)),{supportsAudio:e,supportsVideo:t,supportsScreenRecord:a}}"undefined"!=typeof window&&vP((()=>import("./RecordRTC.d45d91af.js").then((e=>e.R))),["assets/RecordRTC.d45d91af.js","assets/vendor.96643be6.js"]).then((e=>{Gee=e.RecordRTCPromisesHandler,jee=e.MediaStreamRecorder}));const Jee=["overlay/record/video","overlay/record/audio","overlay/record/screen"],Qee=r.exports.createContext(void 0),Zee=({children:e})=>{const t=m.exports.useDispatch(),[a,o]=r.exports.useState(void 0),n=r.exports.useRef(null),[s,l]=r.exports.useState(void 0),d=r.exports.useRef(null),[c,u]=r.exports.useState(!1),[p,h]=r.exports.useState([]),[g,y]=r.exports.useState(void 0),[f,E]=r.exports.useState([]),[v,w]=r.exports.useState(void 0),[b,_]=r.exports.useState(),{pathname:T}=oe(),S=r.exports.useCallback(((e,a)=>{const o=ZH(e,{selectLayerInCreator:!0});hT(),function(e){var t,a;const{state:o,dispatch:n}=tn(),{byId:r}=o.studio.allLayers,i=null==(t=o.studioLocal.awaitingRecordings)?void 0:t.screen,s=null==(a=o.studioLocal.awaitingRecordings)?void 0:a.video;if("recordType"in e)switch(e.recordType){case"screen-audio":case"screen-video":"string"==typeof i&&tte(r,e,i),n(Tg({video:e.id}));break;case"screen":"string"==typeof s&&tte(r,e,s),n(Tg({screen:e.id}))}}(o),"recordType"in o&&("screen-video"===o.recordType&&(KT(e.id,{positionTemp:null}),t(Th(o,"3%","67%","30%","30%")),t(Ch(o))),"screen"===o.recordType&&(null==a?void 0:a.recordScreenAndCameraUpload)&&t(Ah(o)))}),[t]),I=r.exports.useCallback((()=>{var e;null==(e=n.current)||e.destroy(),n.current=null,o((e=>{null==e||e.getTracks().forEach((e=>e.stop()))}))}),[]),x=r.exports.useCallback((()=>{var e;null==(e=d.current)||e.destroy(),d.current=null,l((e=>{null==e||e.getTracks().forEach((e=>e.stop()))}))}),[]);r.exports.useEffect((()=>()=>{null==a||a.getTracks().forEach((e=>e.stop()))}),[a]),r.exports.useEffect((()=>()=>{null==s||s.getTracks().forEach((e=>e.stop()))}),[s]);const k=r.exports.useCallback((()=>{_(Date.now()),o((e=>(e&&(n.current=zee(e),u(!0)),e)))}),[]),C=r.exports.useCallback((()=>{_(Date.now()),l((e=>(e&&(d.current=zee(e),u(!0)),e)))}),[]),A=r.exports.useCallback((()=>{C(),k()}),[C,k]),N=r.exports.useRef(!1),P=Oq((async()=>{const e=[];if(!N.current){N.current=!0;try{const t=Date.now()-(null!=b?b:0);if(_(void 0),n.current&&a){const o=a.getTracks().some((e=>"video"===e.kind));let r,i;s&&d.current?(r=o?"screen-video":"screen-audio",i="Record screen"):o?(i="Record video",r="video"):(i="Record audio",r="audio"),e.push(Hee(a,n.current,r,t).then((e=>({file:e,analyticsUploadSource:i}))).finally((()=>I())))}d.current&&s&&e.push(Hee(s,d.current,"screen",t).then((e=>({file:e,analyticsUploadSource:"Record screen"}))).finally((()=>x())));const o=(await Promise.all(e)).filter((({file:e})=>e)).map((({file:e,analyticsUploadSource:t})=>({file:e,analyticsUploadSource:t})));u(!1);const r=o.map((({file:e})=>e)),i=o.map((({analyticsUploadSource:e})=>e)),l=!!r.find((e=>"screen-video"===e.recordType));return c$(r,{eventHandlers:{handlePreemptiveFinish:S,handleFinish:ez},uploadOptions:{addAtSeeker:!0,analyticsUploadSource:i[0],analyticsUploadSources:i,uploadSourceComponent:"RecordContext",multiRowUploadForRecording:!0,recordScreenAndCameraUpload:l}})}finally{N.current=!1}}})),R=r.exports.useCallback((async()=>{const e=await async function(){const e=(await navigator.mediaDevices.enumerateDevices()).filter((e=>"default"!==e.deviceId)).filter((e=>""!==e.deviceId));return{videoInputDevices:e.filter((e=>"videoinput"===e.kind)),audioInputDevices:e.filter((e=>"audioinput"===e.kind))}}();return h(e.videoInputDevices),E(e.audioInputDevices),e}),[]);return r.exports.useEffect((()=>{!g&&p.length>0&&y(p[0])}),[g,p]),r.exports.useEffect((()=>{!v&&f.length>0&&w(f[0])}),[v,f]),r.exports.useEffect((()=>{if(s&&c){const e=s.getVideoTracks()[0];e&&(e.onended=P)}}),[s,c,P]),r.exports.useEffect((()=>{Jee.some((e=>T.includes(e)))||c||(I(),x())}),[x,I,T,c]),r.exports.useEffect((()=>()=>{x(),I()}),[x,I]),i.createElement(Qee.Provider,{value:{videoAudioStream:a,isRecording:c,micDevices:f,selectedMic:v,setSelectedMic:w,cameraDevices:p,selectedCamera:g,setSelectedCamera:y,setVideoAudioStream:o,setScreenStream:l,pollDevices:R,saveRecordings:P,recordScreen:C,recordVideo:k,record:A,startTime:b}},e)};function ete(){const e=r.exports.useContext(Qee);if(!e)throw new Error("useRecord must be used within a RecordProvider");return r.exports.useEffect((()=>{e.pollDevices()}),[]),e}function tte(e,t,a){var o,n;const r=e[t.id],i=e[a];if(!r||!i)return;const s=null!=(o=null==r?void 0:r.duration)?o:0,l=null!=(n=null==i?void 0:i.duration)?n:0,d=Math.min(s,l);px({[r.id]:{endTime:d,isTrimmed:!0},[i.id]:{endTime:d,isTrimmed:!0}})}const ate="Header-module_disabled_LhZ0P",ote="Header-module_logo_xESyj",nte="Header-module_headerContainer_RrHY4",rte="Header-module_impersonating_JikJn",ite="Header-module_headerLeft_EG9z0",ste="Header-module_headerCenter_uKoNh",lte="Header-module_headerRight_7wFRV",dte="Header-module_headerButtonContainer_zZNYX",cte="Header-module_commentsLabel_yp6vG",ute="Header-module_selectedCommentsLabel_ChtfY",mte="Header-module_headerButtonIcon_o7HhI",pte="Header-module_accountButton_0kzGN",hte="Header-module_headerLogoContainer_ph4oL",gte="Header-module_signInButton_iafs6",yte="Header-module_breadcrumbContainer_fsVUd",fte="Header-module_breadcrumbLink_-MM7g",Ete="Header-module_upgradeLabel_g6s9W",vte="Header-module_presenceIconContainer_BWWNU",wte="Header-module_presenceIconWrapper_W2fBp",bte="Header-module_presenceIcon_heHaB",_te="Header-module_presenceHoverText_fN9cH",Tte="Header-module_plusIcon_uWwzN",Ste="Header-module_projectName_nFOnW",Ite="Header-module_noEvents_V9leN",xte="Header-module_settingsButtonIcon_GD7-G",kte="Header-module_impersonationWarning_n-t3Y",Cte="Header-module_headerUploadButtonContainer_5jmhN",Ate="Header-module_headerButtonTooltip_8qmPx",Nte="Header-module_headerSubtitlesButtonContainer_Qd8we",Pte="Header-module_headerSubtitlesTooltip_-2O5k",Rte="Header-module_headerSettingsButtonContainer_zVBTs",Lte="Header-module_headerSettingsTooltip_1ZgFQ",Dte="Header-module_headerCommentsButtonContainer_lSiRM",Ote="Header-module_headerCommentsTooltip_OLlwb",Fte="Header-module_commentsIcon_64rNH",Mte="OnlineStatus-module_onlineStatusContainer_gjuCw",Ute="OnlineStatus-module_containerUserNoLicense_g9v3x";const Bte=()=>{const e=(al(5e3),window.navigator.onLine),t=(al(15e3),tr(yl)||!e),{timeOfLastSyncSuccess:a}=tr((e=>({timeOfLastSyncSuccess:e.studioLocal.lastSyncedUserFacing})),m.exports.shallowEqual),o=sd(),n=tr(l9),r=m.exports.useDispatch();let s="";if(a){s=`Last ${t?"saved":"edited"} ${qt.duration(-qt().diff(qt(a))).humanize(!0)} `}return n&&s?i.createElement("div",{className:`${Mte} ${o.planTier!==vs.Free?"":Ute}`,onClick:()=>{r(VR({tabId:BR.Versions,tabContainerId:"controls"}))}},t?i.createElement(i.Fragment,null,i.createElement(Xt,{color:"grey",size:14,style:{marginRight:5,marginTop:2}}),s):s):null},Wte=async e=>{const{state:t,dispatch:a}=tn(),{workspaces:o}=t,{selectedTeamId:n}=t.teams;try{let t=null!=e?e:o.selectedWorkspace;if(t===mi){const e=(()=>{const{currentUser:e,teams:t}=tn().state,{allTeams:a}=t,{user:o}=e;return a.find((e=>e.primary&&e.creatorId===o._id))})(),r=SE(o.allWorkspaces,(null==e?void 0:e._id)||n)[0];if(r)t=r._id;else{t=(await hP("New Folder",Jr.team,null==e?void 0:e._id))._id}a(yv(t))}}catch(r){console.error(r)}},Vte=async e=>{const{state:t,dispatch:a}=tn(),{currentUser:o,currentVideo:n,workspaces:r}=t;try{if(!n.isStudio||!sc(o))return void en.push(`/editor/videos/${n._id}`);let t=r.selectedWorkspace;if(sc(o)){const e=qP(t);if(!((null==e?void 0:e.creatorId)===o.user._id)){const e=r.allWorkspaces.find((e=>e.creatorId===o.user._id));e&&(t=e._id)}}Wte(t);const{copiedProject:i}=await a(fv(n.projectId,{entryPoint:e}));n._id&&a(q_("re-edit")),en.push(`/${i.videoId}/studio/editor`)}catch(i){console.error(i)}},jte=async(e,t,a)=>{var o;const{state:n,dispatch:r}=tn(),{currentVideo:i,workspaces:s}=n;try{const n=null!=a?a:s.selectedWorkspace;Wte(n);const{copiedProject:l}=await r(fv(t?t.projectId:i.projectId,{destinationFolderId:n,name:`Template of ${null!=(o=(null==t?void 0:t.projectName)||(null==t?void 0:t.name))?o:"Untitled Project"}`,setAsTemplate:!0,entryPoint:e}));en.push(`/${l.videoId}/studio/editor`)}catch(l){console.error(l)}},Gte=()=>{const e=m.exports.useDispatch();return(t,a)=>new Promise(((o,n)=>{Pu({modalType:ku.MOVE_PROJECT,projectIds:t,onSubmit:async n=>{const r=await bv(t,n);r.destinationFolder&&r.movedProjects&&e({type:rL,payload:r}),Ec(Bd.MOVE_PROJECT,{projectAction:Tn.MOVE,numberOfProjects:t.length,entryPoint:a}),o(r)},onCancel:n})}))},Hte=()=>{const e=Ou(),t=lc();return(a,o)=>new Promise(((n,r)=>{const i=async e=>{try{n(await fv(a,e)())}catch(YEe){Iu({description:"Failed to copy project",error:YEe}),r(YEe)}};t?e&&t&&!o.destinationFolderId&&!o.duplicate?Pu({modalType:ku.COPY_PROJECT,projectId:a,onSubmit:async e=>{await i({name:e.name||o.name,destinationFolderId:e.destinationFolderId,entryPoint:o.entryPoint})},onCancel:r}):i(o):(async()=>{try{await Vte(o.entryPoint),Ec(Bd.COPY_PROJECT,{projectAction:Tn.COPY,entryPoint:o.entryPoint})}catch(YEe){Iu({description:"Failed to copy project",error:YEe}),r(YEe)}})()}))},zte=()=>{const e=Ou();return(t,a,o)=>new Promise(((n,r)=>{const i=async e=>{try{n(await async function(e,t){try{return await gu(`/api/v2/project/${e}/snapshot-copy`,{body:t})}catch(YEe){throw console.error(YEe),YEe}}(t,e))}catch(YEe){Iu({description:"Failed to make a copy",error:YEe}),r(YEe)}};if(!e||o.destinationFolderId)return void i(o);Pu({modalType:ku.COPY_PROJECT,name:o.name,projectId:a,onSubmit:async e=>{await i({name:e.name||o.name,destinationFolderId:e.destinationFolderId,entryPoint:o.entryPoint})},onCancel:r})}))};var $te=(e=>(e.FINAL_VIDEO_PAGE="Final Video Page",e.SNAPSHOT_PAGE="Snapshot Page",e.VERSION_HISTORY="Version History",e.EXPORT_HISTORY="Export History",e))($te||{}),Kte=(e=>(e.VERSION_HISTORY="Version History",e.PROJECT_DROPDOWN="Project Dropdown",e.STUDIO_HEADER="Studio Header",e.FINAL_VIDEO_PAGE="Final Video Page",e.ADMIN_DEBUG_PAGE="Admin Debug Page",e.RESIZE="Resize Overlay",e))(Kte||{}),Yte=(e=>(e.PROJECT_DROPDOWN="Project Dropdown",e.WORKSPACE_BULK_MOVE="Workspace Bulk Move",e))(Yte||{});function qte(e,t,a="mousedown"){r.exports.useEffect((()=>{const o=a=>{e.current&&!e.current.contains(a.target)&&t(a)};return document.addEventListener(a,o),document.addEventListener("touchstart",o),()=>{document.removeEventListener(a,o),document.removeEventListener("touchstart",o)}}),[e,t,a])}const Xte="HeaderOverflow-module_headerOverflowContainer_annIJ",Jte="HeaderOverflow-module_headerOverflowIcon_ADqXM",Qte="HeaderOverflow-module_headerOverflowDropdownMenu_K0-rF",Zte="HeaderOverflow-module_headerOverflowDropdownItem_j8E2W",eae=()=>{const e=r.exports.useRef(null);qte(e,(()=>d(!1)));const{currentUser:t,isBrandKitTemplate:a,video:o}=tr((e=>({currentUser:e.currentUser,isBrandKitTemplate:!!e.studio.isBrandKitTemplate,video:e.currentVideo})),ar),n=XD(Ps.BRANDKIT),s=sc(t),[l,d]=r.exports.useState(!1),[c,u]=r.exports.useState(!1),m=HU(),p=Hte(),h=()=>{s?(vc("Make a brand template within the studio"),jte(Kte.STUDIO_HEADER,o)):u(!0)};return i.createElement("div",{ref:e,className:Xte},i.createElement(Jt,{className:Jte,onClick:()=>d(!l),"data-cy":"header-overflow-icon"}),l&&i.createElement("div",{className:Qte},a?i.createElement("div",{className:Zte,onClick:()=>{m((()=>{s?(vc(Bd.NEW_BRAND_TEMPLATE_STUDIO),window.open("/studio/editor/new-brand-template/","_blank")):u(!0)}),{if:!n,action:Rs.BRANDKIT})()}},"Start new brand template",!n&&i.createElement(Pn,null)):i.createElement("div",{className:Zte,onClick:()=>{s?(vc(Bd.NEW_PROJECT_STUDIO),window.open("/studio/editor","_blank")):u(!0)}},"Start a new project"),i.createElement("div",{className:Zte,"data-cy":"header-overflow-copy",onClick:async()=>{if(s){if(o.projectId){if(!sc(t)||a)return void(await Vte(Kte.STUDIO_HEADER));const{copiedProject:e}=await p(o.projectId,{entryPoint:Kte.STUDIO_HEADER});window.location.href=`/${e.videoId}/studio/editor`}}else u(!0)}},"Make copy"),!a&&i.createElement("div",{className:Zte,onClick:()=>{n?h():m(h,{action:Rs.BRANDKIT})()}},"Save as Brand Template ",!n&&i.createElement(Pn,null))),c?i.createElement(ZF,{hideSignIn:()=>{u(!1)}}):null)},tae=({videoFetched:e})=>{const t=Si(),a=m.exports.useDispatch(),{currentUser:o,currentFolderId:n,isCollaborating:s,presence:l,presentUserId:d,shouldHidePreview:c,isBrandKitTemplate:u,videoFolder:p,canWrite:h,userTeamInvites:g,folderId:y}=tr((e=>({currentUser:e.currentUser,currentFolderId:e.workspaces.selectedWorkspace,showCanvas:e.studio.showCanvas,isCollaborating:e.studio.isCollaborating,presence:e.studio.presence,presentUserId:e.studio.presentUserId,shouldHidePreview:Gl(e),isBrandKitTemplate:e.studio.isBrandKitTemplate,videoFolder:e.videoFolder,canWrite:e.userPermissions.canWrite,userTeamInvites:e.teams.userTeamInvites,folderId:e.studio.workspaceId})),m.exports.shallowEqual),f=Of(o),{isRecording:E}=ete(),{showUpgrades:v}=sd(),[w,b]=r.exports.useState(),_=id(),T=r.exports.useCallback((async()=>{try{if(a(HE()),y&&!h){const e=await gP(y);b(e)}}catch(YEe){console.error(YEe)}}),[h,a,y]);r.exports.useEffect((()=>{T()}),[T]);const S=e=>{e.stopPropagation()},I=null==g?void 0:g.find((e=>e.team._id===_._id));return i.createElement("div",{className:nte+(f?` ${rte}`:""),onClick:()=>a(Kh(null))},sc(o)&&i.createElement(XQ,{className:kte}),i.createElement("div",{className:ite},i.createElement(lae,{currentFolderId:n}),i.createElement("div",{className:yte,"data-cy":"breadcrumbs"},sc(o)?u?i.createElement(at,{to:"/brandkit",onClick:S,className:fte},"Brand Templates"):i.createElement(at,{to:"Shared with Me"===p.name?"/shared-with-me":`/folder/${p._id}`,onClick:S,className:fte,"data-testid":"header-breadcrumb-link",translate:"no"},p.name):i.createElement(at,{to:"/",onClick:S,className:fte},"Kapwing"),i.createElement(Se,null)),i.createElement("span",{className:Ste},i.createElement(V6,{disabled:!h}),i.createElement(eae,null)),h&&i.createElement(i.Fragment,null,i.createElement(sae,{disabled:!h}),i.createElement(rae,{disabled:!h})),h&&i.createElement(F7,null),v&&h&&i.createElement(yQ,{className:Ete,action:Rs.STUDIO}),sc(o)&&i.createElement(wQ,{className:Ete})),i.createElement("div",{className:ste},!h&&(I?i.createElement(F6,{invite:I}):w!==Jr.personal&&i.createElement(M6,null))),i.createElement("div",{className:lte},i.createElement(Bte,null),s&&l&&!t&&i.createElement(aae,{presence:l,presentUserId:d}),i.createElement(oae,{isMobile:t}),h&&i.createElement(nae,{disabled:!h}),i.createElement(N9,null),i.createElement(Vee,{videoFetched:e,disabled:c||E,shrinkCreateButton:t}),i.createElement(T6,null),i.createElement(iae,{currentUser:o})))},aae=({presence:e,presentUserId:t})=>{const a=[],o=Si(),[n,s]=r.exports.useState(3);r.exports.useEffect((function(){s(o?2:3)}),[e,o]),Object.entries(e).forEach((([e,t])=>{Gf(t.heartbeat)&&a.push(e)}));const l=t=>{var a,o,n;return(null==(a=e[t])?void 0:a.profileImg)?null==(o=e[t])?void 0:o.profileImg:function(e,t){var a,o;let n;const r=document.createElement("canvas"),i=e;r.width=i,r.height=i;const s=r.getContext("2d");if(s){s.fillStyle="#78909C",s.fillRect(0,0,i,i),s.font=`normal ${i/2}px sans-serif`,s.textAlign="center",s.textBaseline="middle",s.fillStyle="white";const e=null!=(o=null==(a=null==t?void 0:t.split(" ")[0])?void 0:a[0])?o:"";s.fillText(e,i/2,i/2),n=r.toDataURL("image/png")}return n}(20,(null==(n=e[t])?void 0:n.name)||"")},d=t=>{var a;return{border:`2px solid ${null==(a=e[t])?void 0:a.color}`}};return i.createElement("div",{className:vte},a.map(((a,o)=>{var r;return o<n?i.createElement("div",{className:wte,key:a},i.createElement("img",{src:l(a),alt:"User icon",className:bte,style:d(a)}),i.createElement("span",{className:_te},a===t?"You":null==(r=e[a])?void 0:r.name)):null})),a.length>n&&i.createElement("div",{className:wte},i.createElement(Qt,{className:Tte}),i.createElement("span",{className:_te},"+ ",a.length-n," more")))},oae=({isMobile:e})=>{const{commentsOpen:t,userPermissions:a,canWrite:o}=tr((e=>({commentsOpen:e.comments.commentsOpen,userPermissions:e.userPermissions,canWrite:e.userPermissions.canWrite})),m.exports.shallowEqual),n=m.exports.useDispatch(),s=oe(),l=r.exports.useRef(null);r.exports.useEffect((()=>{const e=Object.keys(a).length>0,t=new URLSearchParams(s.search);(e&&!a.canWrite||"true"===t.get(h9.COMMENT))&&n(Bw(!0))}),[n,s.search,a,e]);return i.createElement("div",{className:`${t?ute:cte} ${Dte} ${o?"":Ite}`,onClick:()=>{o&&(n(Bw(!t)),e&&n(Bu(!t)))},ref:l,"data-cy":"header-comments-button"},i.createElement(Zt,{className:Fte}),i.createElement("span",{className:Ote},"Comments"))},nae=({disabled:e=!1})=>i.createElement("div",{className:`${dte}\n      ${Rte}\n      ${e?ate:""}`,onClick:t=>{e||(iT("/studio/editor/settings"),t.stopPropagation())},"data-cy":"header-settings-button"},i.createElement(ea,{className:xte}),i.createElement("span",{className:Lte},"Settings")),rae=({disabled:e})=>i.createElement("div",{className:`${dte}\n      ${Nte}\n      ${e?ate:""}`,onClick:t=>{e||(ij(),t.stopPropagation())},"data-cy":"header-subtitler-button"},i.createElement(ta,{className:mte}),i.createElement("span",{className:Pte},"Add Subtitles")),iae=e=>{const{currentUser:t}=e,a=tr((e=>e.currentUser)),o=t||a,[n,s]=r.exports.useState(!1);return sc(o)?i.createElement("div",{className:pte,onClick:e=>{null==en||en.push({pathname:"/home",state:{openModal:EJ.account}}),e.stopPropagation()},"data-cy":"account-nav-button"},i.createElement(SQ,{absoluteWidth:30,absoluteHeight:30})):i.createElement(i.Fragment,null,i.createElement("div",{className:`${dte} ${gte}`,onClick:()=>{s(!0)},onTouchStart:()=>{s(!0)},"data-cy":"signin-nav-button"},"Sign In"),n&&i.createElement(ZF,{hideSignIn:()=>{s(!1)},onSuccess:WL}))},sae=({disabled:e})=>i.createElement("div",{className:`${dte}\n      ${Cte}\n      ${e?ate:""}`,onClick:t=>{e||(iT("/studio/editor/overlay/upload"),t.stopPropagation())},"data-cy":"header-upload-button"},i.createElement(aa,{className:mte}),i.createElement("span",{className:Ate},"Upload")),lae=({currentFolderId:e})=>{let t="/";return e&&(t=`/folder/${e}`),i.createElement("div",{className:hte,onClick:e=>{null==en||en.push(t),e.stopPropagation()}},i.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/gdu-kapwing-logo-transparent.webp",className:ote,alt:"Kapwing Logo","data-cy":"studio-header-logo"}))},dae="KapwingInput-module_inputText_ECzwK",cae="KapwingInput-module_text_ly3QW",uae="KapwingInput-module_editPencil_x2W85",mae="KapwingInput-module_inputEl_2ljqq",pae="KapwingInput-module_tooltipName_SKd6d",hae=({onEdit:e,onSave:t,value:a,showPencil:o,showTooltip:n})=>{const[s,l]=r.exports.useState(!1),[d,c]=r.exports.useState(a);r.exports.useEffect((()=>{c(a)}),[a]);const u=async()=>{const e=d.trim();l(!1),e&&e.length&&e!==a?t(e):c(a)};return s?i.createElement("input",{onKeyUp:e=>{"Enter"===e.key&&u()},className:mae,value:d,onChange:e=>c(e.target.value),onBlur:u,autoFocus:!0}):i.createElement(se,{delayDuration:0},i.createElement(le,{asChild:!0},i.createElement("div",{className:dae,onClick:()=>{e&&e(),l(!0)}},i.createElement("span",{className:cae},d),o&&i.createElement("div",{className:uae},i.createElement(oa,null)))),n&&i.createElement(de,null,i.createElement(ce,null,i.createElement("div",{className:pae},d))))},gae=()=>{const e=r.exports.useRef(new AbortController);return r.exports.useEffect((()=>{const t=e.current;return()=>t.abort()}),[]),e.current},yae=(e,t=20)=>{const[a,o]=r.exports.useState({take:t,skip:0}),n=gae(),[i,s]=r.exports.useState(!1),[l,d]=r.exports.useState(),[c,u]=r.exports.useState(),m=r.exports.useCallback((async()=>{s(!0);try{const t=await hu(e,{signal:n.signal,params:{skip:a.skip,take:a.take}});d(t),s(!1)}catch(t){let e="An error occurred";t&&"object"==typeof t&&"error"in t?e=String(t.error):t instanceof Error?e=t.message:t&&(e=String(t)),u(e),s(!1)}}),[e,n.signal,a.take,a.skip]);r.exports.useEffect((()=>{m()}),[m]);const p=r.exports.useCallback((async()=>{i||m()}),[i,m]);return r.exports.useEffect((()=>{o({take:t,skip:0})}),[e,t]),{isLoading:i,error:c,refetch:p,data:l,pagination:{paginationDisplay:(null==l?void 0:l.totalCount)?`${a.skip+1}-${Math.min(a.skip+a.take,(null==l?void 0:l.totalCount)||0)} of ${null==l?void 0:l.totalCount}`:void 0,paginationOptions:a,firstPage:()=>{o((e=>({...e,skip:0})))},lastPage:()=>{o((e=>({...e,skip:(null==l?void 0:l.totalCount)?Math.floor((l.totalCount-1)/e.take)*e.take:0})))},nextPage:()=>{o((e=>({...e,skip:e.skip+e.take})))},prevPage:()=>{o((e=>({...e,skip:e.skip-e.take})))},gotoPage:e=>{e<1||e>Math.ceil(((null==l?void 0:l.totalCount)||0)/t||0)?o((e=>({...e,skip:0}))):o((t=>({...t,skip:(e-1)*t.take})))}}}},fae=e=>{const t=gae(),[a,o]=r.exports.useState(!1),[n,i]=r.exports.useState(),[s,l]=r.exports.useState(),d=r.exports.useCallback((async()=>{if(e){o(!0);try{const a=await hu(e,{signal:t.signal});i(a),o(!1)}catch(a){let e="An error occurred";a&&"object"==typeof a&&"error"in a?e=String(a.error):a instanceof Error?e=a.message:a&&(e=String(a)),l(e),o(!1)}}}),[e,t.signal]);r.exports.useEffect((()=>{d()}),[d]);const c=r.exports.useCallback((async()=>{a||d()}),[a,d]);return{isLoading:a,data:n,error:s,refetch:c}},Eae="FinalVideoHeader-module_wrapper_yD-7a",vae="FinalVideoHeader-module_brand_-WaEu",wae="FinalVideoHeader-module_kapwing_mJmoE",bae="FinalVideoHeader-module_displayedProjectName_2GeX-",_ae="FinalVideoHeader-module_projectName_IoVI1",Tae="FinalVideoHeader-module_headerContainer_ye2YZ",Sae="FinalVideoHeader-module_requestToEditButton_LrazX",Iae=()=>{var e;const[t,a]=r.exports.useState(!0),{currentVideo:o,currentUser:n,canWrite:s,videoId:l}=tr((e=>({currentVideo:e.currentVideo,videoId:e.currentVideo._id,currentUser:e.currentUser,canWrite:e.userPermissions.canWrite})),ar),[d,c]=r.exports.useState(),{data:u,refetch:m,isLoading:p,error:h}=(({videoId:e,snapshotId:t})=>{const a=t?`/api/v2/snapshots/${t}/snapshotPreview`:`/api/v2/videos/${e}/snapshotPreview`,{isLoading:o,data:n,error:r,refetch:i}=fae(e||t?a:void 0);return{isLoading:o,data:n,error:r,refetch:i}})({videoId:l,snapshotId:d});r.exports.useEffect((function(){var e;(null==(e=null==u?void 0:u.snapshot)?void 0:e._id)&&c(u.snapshot._id)}),[null==(e=null==u?void 0:u.snapshot)?void 0:e._id]),r.exports.useEffect((()=>{let e=!0;return(async()=>{if(o.workspaceId){const t=await gP(o.workspaceId);e&&a(t===Jr.personal)}})(),()=>{e=!1}}),[o.workspaceId]);const g=o.isStudio&&o.creatorId&&s,y=(null==u?void 0:u.snapshot)&&!g&&!t;return i.createElement("div",{className:Eae},i.createElement("div",{className:vae},i.createElement(lae,null),i.createElement(at,{className:wae,to:"/"},"KAPWING")),i.createElement("div",{className:Eae},i.createElement("div",{className:_ae,"data-cy":"displayed-project-name"},h?i.createElement("span",null,o.projectName):p&&!(null==u?void 0:u.snapshot)?i.createElement(Aee,null):y?i.createElement("span",null,(null==u?void 0:u.snapshot)?u.snapshot.name||"Untitled Export":o.projectName):(null==u?void 0:u.snapshot)?i.createElement(hae,{value:u.snapshot.name||"Untitled Export",onSave:async e=>{await gu(`/api/v2/snapshots/${null==u?void 0:u.snapshot._id}/rename`,{body:{name:e}}),m()}}):i.createElement("span",null,o.projectName),y&&i.createElement("div",{className:Sae},i.createElement(M6,null)))),i.createElement("div",null,i.createElement(iae,{currentUser:n})))};function xae(){return{type:"RESET_STATE_PRESERVE_USER"}}function kae(e){return{type:"UPDATE_ENTIRE_STATE",newStateProperties:e}}const Cae=e=>{const t={};if((null==e?void 0:e.build)&&!j.exports.isEmpty(null==e?void 0:e.build)){const{outputByteSize:a,outputExt:o,outputWidth:n,outputHeight:r}=e.build,{exportQuality:i}=e;if(!a||!o)return null;t.filesize=(e=>{const t=e/1e3;if(t<1e3)return`${(Math.round(10*t)/10).toFixed(1)} KB`;const a=t/1e3;if(a<1e3)return`${(Math.round(10*a)/10).toFixed(1)} MB`;const o=a/1e3;return`${(Math.round(10*o)/10).toFixed(1)} GB`})(a),t.format=o.toUpperCase(),"mp3"!==o&&n&&r&&(t.resolution=`${n}x${r}`),t.quality=i}return t},Aae="VideoPrivacyOptions-module_container_cbXry",Nae="VideoPrivacyOptions-module_inVideoContainer_LoSh3",Pae="VideoPrivacyOptions-module_currentPrivacy_VJSp4",Rae="VideoPrivacyOptions-module_changePrivacy_Khz-X",Lae="VideoPrivacyOptions-module_privacyIcon_IVDeO",Dae=({videoId:e,userHasAccess:t,privacy:a,inVideoContainer:o,downloadUrl:n})=>{const r=m.exports.useDispatch(),s=HU(),l=XD(Ps.CHANGE_PRIVACY);if(!t)return null;const d=zd(n);return i.createElement("div",{className:o?Nae:Aae},i.createElement("div",{className:Pae},a?i.createElement(na,{className:Lae,color:"white"}):i.createElement(ra,{className:Lae,color:"white"}),`This ${d} is ${a===ii.private?si.private:si.unlisted}`),i.createElement("div",{className:Rae,onClick:async()=>{if(!l)return void s((()=>null),{action:Rs.PRIVACY})();const t=a===ii.private?ii.unlisted:ii.private;try{const a=await yu(`/api/v1/videos/${e}/privacy`,{params:{privacy:t}});r(lR(a))}catch(YEe){Iu({description:"Error changing video privacy",error:YEe})}}},`Make ${d} ${a===ii.private?si.unlisted:si.private}`,!l&&i.createElement(Pn,null)))},Oae={home:"VideoContainer-module_home_vETFx",homeHowBackgroundWhite:"VideoContainer-module_homeHowBackgroundWhite_xUNro",largeButton:"VideoContainer-module_largeButton_8dU5G",sectionContent:"VideoContainer-module_sectionContent_r4SDQ",sectionHeader:"VideoContainer-module_sectionHeader_Jpb2G",spacer:"VideoContainer-module_spacer_P2Cri",chevron:"VideoContainer-module_chevron_wtOP0",splashText:"VideoContainer-module_splashText_y0TlB",splashSubtext:"VideoContainer-module_splashSubtext_hpFoO",aboutSection:"VideoContainer-module_aboutSection_GvCac",mobile:"VideoContainer-module_mobile_ETFyI",desktop:"VideoContainer-module_desktop_CFpyx",screenReaderOnlyLabel:"VideoContainer-module_screenReaderOnlyLabel_xQIVF",disabled:"VideoContainer-module_disabled_iVGkq",noScrollBar:"VideoContainer-module_noScrollBar_IyWON",textOverflowEllipsis:"VideoContainer-module_textOverflowEllipsis_-8PpN",genericButtonBlue:"VideoContainer-module_genericButtonBlue_A5Opa",wrapper:"VideoContainer-module_wrapper_jTNOz",mobileCommentsWrapper:"VideoContainer-module_mobileCommentsWrapper_Po8OY",container:"VideoContainer-module_container_4yrzu",mobileCommentsContainer:"VideoContainer-module_mobileCommentsContainer_A4H-5",header:"VideoContainer-module_header_JML-D",metaDataContainer:"VideoContainer-module_metaDataContainer_fHszF",metaDataRow:"VideoContainer-module_metaDataRow_SsKO2",metaDataLabel:"VideoContainer-module_metaDataLabel_d79EI",metaDataDescription:"VideoContainer-module_metaDataDescription_t2IO3",actions:"VideoContainer-module_actions_KnIel",videoActionButtonWrapper:"VideoContainer-module_videoActionButtonWrapper_cQ9sD",actionButton:"VideoContainer-module_actionButton_WBruA",videoActionButton:"VideoContainer-module_videoActionButton_E4ZMo",actionIcon:"VideoContainer-module_actionIcon_uYB7L",description:"VideoContainer-module_description_Gs8Fb",reportAProblemButton:"VideoContainer-module_reportAProblemButton_9lPUX",openInStudio:"VideoContainer-module_openInStudio_xwI51",upsellBlock:"VideoContainer-module_upsellBlock_btc9R",buttonWrapper:"VideoContainer-module_buttonWrapper_kh9Fo",overlay:"VideoContainer-module_overlay_x1GzY",overlayBackground:"VideoContainer-module_overlayBackground_vhcxF",finalVideoContainer:"VideoContainer-module_finalVideoContainer_-snrS",finalVideoPreviewContainer:"VideoContainer-module_finalVideoPreviewContainer_XqKGP",socialDescription:"VideoContainer-module_socialDescription_p0WPR",youtubeChannelLink:"VideoContainer-module_youtubeChannelLink_-NVGO",viewAndOptionsContainer:"VideoContainer-module_viewAndOptionsContainer_oDlgG",loadingWrapper:"VideoContainer-module_loadingWrapper_qW6py",finalVideoVideoContainer:"VideoContainer-module_finalVideoVideoContainer_4GNCk",commentsFinalVideoContainer:"VideoContainer-module_commentsFinalVideoContainer_-mG8R",topEditButtonContainer:"VideoContainer-module_topEditButtonContainer_L1S-s",privacyAndSocialWrapper:"VideoContainer-module_privacyAndSocialWrapper_JSqWY",topEditLeft:"VideoContainer-module_topEditLeft_rnVLD",topEditRight:"VideoContainer-module_topEditRight_tnjnu",commentsMetaDataIconContainer:"VideoContainer-module_commentsMetaDataIconContainer_K1zoz",commentsMetaDataFileSize:"VideoContainer-module_commentsMetaDataFileSize_E7zW4",commentsMetaDataIcon:"VideoContainer-module_commentsMetaDataIcon_hR10J",commentsMetaDataContainer:"VideoContainer-module_commentsMetaDataContainer_-Bl-H",topTooltip:"VideoContainer-module_topTooltip_qknIa",commentsContainerWrapper:"VideoContainer-module_commentsContainerWrapper_6KkLk",commentsSharingWrapper:"VideoContainer-module_commentsSharingWrapper_GJ6Fw",videoContainerContent:"VideoContainer-module_videoContainerContent_kYsvH",commentingVideoContainerContent:"VideoContainer-module_commentingVideoContainerContent_dyij1",adminSectionWrapper:"VideoContainer-module_adminSectionWrapper_ikRiy",emailMessageContainer:"VideoContainer-module_emailMessageContainer_pfbva",emailMessageDiv:"VideoContainer-module_emailMessageDiv_2CVRr",watermarkUpsell:"VideoContainer-module_watermarkUpsell_fALh5",blackBackground:"VideoContainer-module_blackBackground_uilU9"},Fae="VideoPageButton-module_actionButton_-OxGR",Mae="VideoPageButton-module_actionButtonText_xXwn9",Uae=({label:e,icon:t,onClick:a,disabled:o,dataCy:n})=>i.createElement("button",{type:"button",className:Fae,onClick:a,disabled:o,"data-cy":n},i.createElement("span",null,t),i.createElement("span",{className:Mae},e)),Bae=()=>{const e=Ie(),t=m.exports.useDispatch(),{origin:a,editorPath:o}=tr((e=>({origin:e.currentVideo.origin,editorPath:e.currentVideo.editorPath})),ar),n=()=>{if(!a)return o;if(["","edit-in-studio","re-edit"].includes(a))return o;if("video-maker"===a)return"/video-maker";if("memeMaker"===a)return"/meme-maker";const e=(e=>{let t;t="addText"===e?"/tools/add-text":"addImageVideo"===e?"/tools/add-image":`/tools/${(e=>{const t=e[0];if(!t)return e;let a=t.toLowerCase()+e.slice(1);return a=a.replace("GIF","Gif"),a.replace(/[A-Z]/g,(e=>`-${e.toLowerCase()}`))})(e)}`;const a=k0.find((e=>e.url===t));return(a||!!a)&&t})(a);return e||o};return i.createElement(Uae,{label:"Start a new project",icon:i.createElement(ia,null),dataCy:"start-new-project",onClick:()=>{t({type:"RESET_STUDIO"}),vc("Start New Project from Final Video");const a=n()||"/";e.push(a)}})},Wae="OptionsContainer-module_wrapper_8vlNC",Vae="OptionsContainer-module_mobileCommentsWrapper_cT5hy",jae="OptionsContainer-module_container_f7sEv",Gae="OptionsContainer-module_mobileCommentsContainer_KNypL",Hae="OptionsContainer-module_metaDataContainer_Tw--1",zae="OptionsContainer-module_metaDataRow_aOAOd",$ae="OptionsContainer-module_metaDataLabel_rFGA1",Kae="OptionsContainer-module_metaDataDescription_2zhXY",Yae="OptionsContainer-module_actionButton_AUJMV",qae="OptionsContainer-module_actionIcon_3woF7",Xae="OptionsContainer-module_description_AUQtk",Jae="OptionsContainer-module_reportAProblemButton_6ekr-",Qae="OptionsContainer-module_upsellBlock_AptWG",Zae="OptionsContainer-module_buttonWrapper_5PB8F",eoe=({text:e,commentingView:t,projectId:a,entryPoint:o,isCopyDisabled:n})=>{const r=Ie(),s=Hte();return i.createElement("button",{type:"button",className:`${n?pZ.disabled:""} edit-video-menu-link ${t?Oae.videoActionButton:Yae}`,onClick:async()=>{const{copiedProject:e}=await s(a,{entryPoint:o});r.push(`/${e.videoId}/studio/editor`)},disabled:n,"data-cy":"copy-and-edit-button"},i.createElement(sa,{className:t?Oae.actionIcon:qae}),i.createElement("span",null,e))},toe=({isEditDisabled:e,videoId:t,setReEditOrigin:a,commentingView:o})=>{const n=Ie();return i.createElement(Uae,{label:"Edit this project",icon:o?i.createElement(la,null):i.createElement(da,null),dataCy:"edit-video-button",disabled:e,onClick:()=>{a&&a(),n.push(`/${t}/studio/editor`)}})},aoe=async e=>{if(e)try{const t=document.createElement("a");t.href=e,document.body.appendChild(t),t.click(),document.body.removeChild(t)}catch(t){Iu({description:"Error downloading the file, please try again later",error:t})}},ooe=({onDownload:e,downloadUrl:t,entryPoint:a})=>{const o=m.exports.useDispatch(),{currentUser:n,currentVideo:r}=tr((e=>({currentUser:e.currentUser,currentVideo:e.currentVideo})),ar);return i.createElement(Uae,{label:"Download file",icon:i.createElement(ca,null),dataCy:"download-final-video-button",onClick:i=>{if(!sc(n))return i.preventDefault(),void o({type:"SHOW_SIGN_IN"});aoe(t||tT(r,"fullPath")),N4(sc(n),a),e&&e()}})},noe=(e,t)=>{if(!e||!t)return null;const a=null==e?void 0:e.find((e=>e._id===t));return(null==a?void 0:a.parentId)||(null==a?void 0:a._id)},roe=e=>{if(!e||s.exports.isEmpty(e))return null;const t=[{label:"Format",value:e.format||""}];return"MP4"!==e.format&&"GIF"!==e.format||!e.quality||t.push({label:"Quality",value:e.quality}),"MP3"!==e.format&&e.resolution&&t.push({label:"Resolution",value:e.resolution}),e.filesize&&t.push({label:"File Size",value:e.filesize}),t},ioe=e=>{e.preventDefault();const t=e.clipboardData.getData("text/plain");if(window.getSelection){const e=window.getSelection();if((null==e?void 0:e.getRangeAt)&&e.rangeCount){const a=e.getRangeAt(0);a.deleteContents(),a.insertNode(document.createTextNode(t)),a.collapse(!1)}}},soe=async e=>{const{dispatch:t}=tn(),a=await loe(e);a&&t(Mw(a))};async function loe(e){let t,a=[];try{for(;;){const o={pageSize:500};t&&(o.lastId=t);const n=await hu(`/api/v1/videos/${e}/comments`,{params:o});if(!(null==n?void 0:n.length))break;if(t=n[n.length-1]._id,n.sort(((e,t)=>e._id<t._id?-1:1)),a=[...n,...a],n.length<500)break}}catch(YEe){const t=YEe instanceof Error?YEe.message:"";console.error(`Error while fetching comments: ${t}`)}return a}const doe=()=>{const{dispatch:e,state:t}=tn();t.userPermissions.canWrite&&(e(Uw("")),e(Bw(!1)))},coe=e=>{var t;return!!(null==(t=e.comments.comments)?void 0:t.length)},uoe=e=>e.user?null:{name:"Deleted user"},moe=({metadata:e,tooltipPosition:t="bottom"})=>{const[a,o]=r.exports.useState(!1),n=roe(e);return i.createElement("div",{className:Oae.commentsMetaDataIconContainer},i.createElement("div",{className:Oae.commentsMetaDataFileSize},(null==e?void 0:e.filesize)||""),i.createElement(ua,{className:Oae.commentsMetaDataIcon,onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1)}),a&&n&&i.createElement("div",{className:`${Oae.commentsMetaDataContainer} ${"top"===t&&Oae.topTooltip}`},n.map((({label:e,value:t})=>i.createElement("div",{className:zae,key:e},i.createElement("div",{className:$ae},`${e}:`),i.createElement("div",{className:Kae},t))))))};class poe extends r.exports.Component{constructor(){super(...arguments),a(this,"state",{loading:!1}),a(this,"setReEditOrigin",(()=>{const{currentVideo:e}=this.props;e._id&&this.props.setOrigin("re-edit")}))}render(){const{currentVideo:e,commentingView:t,onDownload:a,local_url:o,canWrite:n}=this.props,{creatorId:r}=e,s=!e._id||this.state.loading,l=this.state.loading,d=e.isStudio&&r&&n;let c=d?"Copy project and edit":"Edit a copy";if(t&&(c="Make a copy"),t){const n=Cae(e);return i.createElement(i.Fragment,null,i.createElement("div",{className:Oae.topEditLeft},d&&e._id?i.createElement("div",{className:Oae.buttonWrapper},i.createElement(toe,{videoId:e._id,setReEditOrigin:this.setReEditOrigin,isEditDisabled:s,commentingView:t})):null,e.projectId&&i.createElement(eoe,{isCopyDisabled:l,text:c,commentingView:t,projectId:e.projectId,entryPoint:Kte.FINAL_VIDEO_PAGE}),i.createElement(Bae,null)),i.createElement("div",{className:Oae.topEditRight},n&&i.createElement(moe,{metadata:n}),i.createElement(ooe,{onDownload:a,downloadUrl:o,entryPoint:$te.FINAL_VIDEO_PAGE})))}return!d&&e.projectId?i.createElement(eoe,{isCopyDisabled:l,text:c,commentingView:t,projectId:e.projectId,entryPoint:Kte.FINAL_VIDEO_PAGE}):i.createElement(i.Fragment,null,!!e._id&&i.createElement("div",{className:Oae.buttonWrapper},i.createElement(toe,{videoId:e._id,setReEditOrigin:this.setReEditOrigin,isEditDisabled:s,commentingView:t})),e.projectId&&i.createElement(eoe,{isCopyDisabled:l,text:c,commentingView:t,projectId:e.projectId,entryPoint:Kte.FINAL_VIDEO_PAGE}))}}const hoe=we(m.exports.connect((e=>({currentVideo:e.currentVideo,currentUser:e.currentUser,workspaces:e.workspaces,currentFolderId:e.workspaces.selectedWorkspace,selectedTeamId:e.teams.selectedTeamId,canWrite:e.userPermissions.canWrite})),(e=>me({setOrigin:q_,setCurrentFolder:yv},e)))(poe));function goe(e,t){vc(Bd.SHARE_FINAL_VIDEO,{type:t,entryPoint:$te.FINAL_VIDEO_PAGE})}function yoe(e,t=!1){const{token:a,user:o}=tn().state.currentUser||{},{_id:n}=o||{};return yu(`/api/v1/videos/${e}/share`,{body:{token:a,userId:n,write:t}})}const foe=e=>{const t=tr((t=>t.projects.byId[e])),[a,o]=r.exports.useState(null==t?void 0:t.content.code),n=null==t?void 0:t.content._id;return r.exports.useEffect((()=>{a||(async()=>{if(!n)return;const e=await yu(`/api/v2/videos/${n}/share`);o(e.code)})()}),[n,a]),{code:a}},Eoe="Sharing-module_container_5srG3",voe="Sharing-module_commentViewContainer_E1YFf",woe="Sharing-module_header_vzZb-",boe="Sharing-module_copyLinkButton_4kRMS",_oe="Sharing-module_input_eIlfs",Toe="Sharing-module_moreContainer_zdB4V",Soe="Sharing-module_embedButton_3tra-",Ioe="Sharing-module_embedButtonIcon_YWWH0",xoe="Sharing-module_socialMediaButtons_VEL7u",koe="Sharing-module_socialOptionIcon_jsbGH",Coe=e=>{const{showEmbedModal:t,inCommentView:a}=e,[o,n]=r.exports.useState(!1),s=r.exports.useRef(null),l=m.exports.useDispatch(),d=tr((e=>e.currentVideo)),c=tr((e=>e.projectName)),u=`https://www.kapwing.com/videos/${d._id}`;r.exports.useEffect((()=>{const e=window.location.search,t=new URLSearchParams(e).get("tiktokstatus");t&&l(Su("success"===t?{description:"Shared succesfully - Check the TikTok app to finish posting your video",type:"success"}:{description:`Something went wrong. ${t}`,type:"error"}))}),[l]);const p=()=>{const{_id:e}=d||{};return e&&goe(0,"Twitter"),Promise.resolve()},h=()=>{const{_id:e}=d||{};return e&&goe(0,"Facebook"),Promise.resolve()},g=(e,t=navigator.language)=>{const[a,...o]=e;return void 0===a?e:a.toLocaleUpperCase(t)+o.join("")};return d&&d._id?i.createElement("div",{className:a?voe:Eoe},i.createElement("div",{className:woe},i.createElement("div",null,"Share this"),i.createElement("div",null,i.createElement("div",{className:boe,onClick:()=>{n(!0),setTimeout((()=>{n(!1)}),1500);const{_id:e}=d||{};e&&goe(0,"Link");navigator.clipboard.writeText(u).then((()=>{var e;if(s.current){const t=s.current;null==(e=null==window?void 0:window.getSelection())||e.selectAllChildren(t)}}))}},o?"Copied!":"Copy link"))),i.createElement("div",{className:_oe,ref:s},u),i.createElement("div",{className:Toe},i.createElement("div",{className:xoe},(()=>{const e=g(c);return i.createElement(lt,{beforeOnClick:p,hashtags:["kapwing"],title:`${e} made with Kapwing`,url:u,via:"kapwingapp"},i.createElement(pa,{className:koe}))})(),(()=>{const e=g(c);return i.createElement(it,{beforeOnClick:h,"data-cy":"facebook-share-button",quote:`${e} made with Kapwing`,url:u},i.createElement(ha,{className:koe}))})()),i.createElement("div",{className:Soe,onClick:()=>{const{_id:e}=d||{};t(),e&&goe(0,"Embed")}},i.createElement(ma,{className:Ioe})," Embed"))):null},Aoe="ExportNotificationOptions-module_exportNotificationOptionsContainer_KS-0K",Noe="ExportNotificationOptions-module_bellIcon_5Sq-i",Poe="ExportNotificationOptions-module_bellIconRightSidebar_n65KN",Roe="ExportNotificationOptions-module_changeOption_lN9FM",Loe=({inRightSidebar:e=!1})=>{const t=tr((e=>e.currentUser)),{muteExportCompleteNotificationSound:a}=t.user,o=m.exports.useDispatch(),n=a?ga:ya,r=`A notification chime will${a?" not":""} play when the export finishes`,s=a?"Turn it on":"Turn it off";return i.createElement("div",{className:Aoe},i.createElement("div",null,i.createElement(n,{className:e?Poe:Noe}),r),i.createElement("div",{className:Roe,onClick:()=>o(function(e){return(t,a)=>{const{user:o}=a().currentUser||{};return t(wf({...o,muteExportCompleteNotificationSound:e})),o._id?gu("/api/v1/users/updateProfile/muteExportCompleteNotificationSound",{body:{muteExportCompleteNotificationSound:e},parseJSON:!1}).then((()=>vf())):new Promise((()=>{}))}}(!a))},s))},Doe=["isMuted","isTrimmedOnly"];class Ooe extends r.exports.Component{constructor(){super(...arguments),a(this,"resetCreator",(async()=>{var e;const{currentVideo:t}=this.props;if(this.props.resetStatePreserveUser(),this.props.setOrigin("edit-in-studio"),Doe.some((e=>e in t))){if(null==(e=t.sourceVideo)?void 0:e.url){const{url:e}=t.sourceVideo,a=e.split("?",1)[0].split("/").pop(),o=await XH(e,{name:a});ZH(o,{selectLayerInCreator:!1,currentVideo:t})}}else if("mp3"===t.convertOption)(async(e={})=>{const{asset:t,cmlFile:a}=await BG(e._id);HH(t,a);const{dispatch:o}=tn();o(B_("400:400")),o({type:"SHOW_STUDIO_CANVAS"}),hT()})(t);else if(t.fullPath){const{asset:e,cmlFile:a}=await BG(t._id);HH(e,a);const{blob_name:o}=e,n=await hY(e),r=await XH(n,{name:o,asset_id:e._id});a&&(r.cmlFileId=a.id),ZH(r)}})),a(this,"resetProject",(()=>{const{resetStudio:e}=this.props;e(),vc("Start New Project from Final Video")})),a(this,"renderBackToWorkspace",(()=>{const{currentUser:e}=this.props;return i.createElement(at,{to:"/",onClick:this.resetProject},i.createElement("div",{className:Yae},i.createElement(fa,{className:qae}),i.createElement("span",null,sc(e)?"Return to workspace":"Return to Kapwing")))})),a(this,"renderDescription",(()=>{const{showReportIssueModal:e}=this.props,t=JD(Ps.REPORT_ISSUE);return i.createElement("div",{className:Xae},"Tag ",i.createElement("strong",null,"#kapwing")," so we can find you on social media!"," ",t&&i.createElement("span",null,"Any issues?"," ",i.createElement("button",{type:"button",className:Jae,onClick:()=>e()},"Report a problem")," ","and let us know."))}))}renderOpenInStudio(){return i.createElement(at,{to:"/studio/editor",onClick:this.resetCreator},i.createElement("button",{type:"button",className:Yae},i.createElement(Ea,{className:qae}),"Open in Studio"))}renderMetaData(){const e=Cae(this.props.currentVideo),t=roe(e);return t?i.createElement("div",{className:Hae},t.map((({label:e,value:t},a)=>i.createElement("div",{className:zae,key:a},i.createElement("div",{className:$ae},`${e}:`),i.createElement("div",{className:Kae},t))))):null}render(){const{currentUser:e,currentVideo:t,showEmbedModal:a,showTikTokModal:o,local_url:n,mobileCommentsView:r}=this.props;let l=!1;return s.exports.isEmpty(t)||t.isCreator&&t.isStudio||(l=!0),i.createElement("div",{className:r?Vae:Wae,"data-cy":"options-container"},i.createElement("div",{className:r?Gae:jae},i.createElement("div",{className:Qae},i.createElement(f9,null)),i.createElement(S9,{className:Qae}),i.createElement(Coe,{showEmbedModal:a,showTikTokModal:o}),i.createElement(hoe,{local_url:n}),i.createElement("div",{className:Zae},i.createElement(ooe,{onDownload:this.props.onDownload,downloadUrl:this.props.local_url,inRightSidebar:!0,entryPoint:$te.FINAL_VIDEO_PAGE})),i.createElement("div",null,(null==t?void 0:t._id)&&t.fullPath&&i.createElement(Dae,{videoId:t._id,privacy:t.privacy,downloadUrl:t.fullPath,userHasAccess:!!t.workspaceId&&nP(t.workspaceId)})),l?this.renderOpenInStudio():null,i.createElement("div",{className:Zae},i.createElement(Bae,null)),this.renderBackToWorkspace(),i.createElement(Loe,{inRightSidebar:!0}),this.renderDescription(),this.renderMetaData(),dc(e)?i.createElement(c5,null):null))}}const Foe=we(m.exports.connect((e=>({currentVideo:e.currentVideo,currentUser:e.currentUser,projectName:e.projectName,imageType:e.studio.imageType})),(e=>me({setOrigin:q_,resetStatePreserveUser:xae,resetStudio:oR},e)))(Ooe));function Moe(e=!0){const{hostname:t}=window.location;return function(e,t=!0){return"localhost"===e?t?"localhost:5000":"kapwing-dev.com":e}(t,e)}function Uoe(e,t="c",a=!0){const{protocol:o}=window.location;return`${o}//${Moe(a)}/${t}/${e}`}function Boe(e){if(null==e||!e.length)throw new Error("Missing short code for sharing.");const{protocol:t}=window.location;return`${t}//${function(e=!0){let{hostname:t}=window.location;return"localhost"===t&&(t=e?"localhost:5000":"www.kapwing-dev.com"),t}()}/e/${e}`}const Woe="ShareEmbed-module_container_O0ZG3",Voe="ShareEmbed-module_closeContainer_UE6SZ",joe="ShareEmbed-module_title_PsHo9",Goe="ShareEmbed-module_description_r6vpF",Hoe="ShareEmbed-module_contentContainer_6Z0uj",zoe="ShareEmbed-module_copyContainer_S9hDz",$oe="ShareEmbed-module_linkContainer_aD1BY",Koe="ShareEmbed-module_linkText_ueJke",Yoe="ShareEmbed-module_copyLink_oNI9z",qoe="ShareEmbed-module_optionsContainer_UdM-V",Xoe="ShareEmbed-module_autoplay_PaRRW";class Joe extends r.exports.Component{constructor(e){super(e),a(this,"copyTimeout"),a(this,"getEmbedText",(()=>{const{_id:e,height:t=1,width:a=1}=this.props.currentVideo||{},{autoplay:o}=this.state,n=Boe(e),r=t/a*100;let i=`height: 0; padding-bottom: ${`calc(${r.toFixed(2)}%)`}; position:relative; width: 100%;`;if(r>100){const e=300;i=`height: ${(e*t/a).toFixed(2)}px; width: ${e.toFixed(2)}px; position:relative;`}return`<div style="${i}">${`<iframe allow="autoplay; gyroscope;" allowfullscreen height="100%" referrerpolicy="strict-origin" src="${n}${o?"?autoplay=true":""}" style="border:0; height:100%; left:0; overflow:hidden; position:absolute; top:0; width:100%" title="Embedded content made on Kapwing" width="100%"></iframe>`}</div><p style="font-size: 12px; text-align: right;">Video edited on <a href="https://www.kapwing.com/video-editor">Kapwing</a></p>`})),a(this,"onCopied",(()=>{this.setState({copiedEmbed:!0}),setTimeout((()=>this.setState({copiedEmbed:!1})),3e3)})),a(this,"onClickCopyContent",(e=>{e.target.setSelectionRange(0,e.target.value.length)})),a(this,"renderClose",(()=>i.createElement("div",{className:Voe},i.createElement(pe,{onClick:this.props.hideOverlay})))),this.state={autoplay:!1,copiedEmbed:!1}}componentWillUnmount(){this.copyTimeout&&clearTimeout(this.copyTimeout)}renderCopyEmbed(){const{copiedEmbed:e,autoplay:t}=this.state,a=this.getEmbedText();return i.createElement("div",{className:zoe},i.createElement("div",{className:$oe},i.createElement("textarea",{className:Koe,id:"embed-text",onClick:this.onClickCopyContent,value:a,readOnly:!0}),i.createElement("div",{className:qoe},i.createElement(va,{className:Yoe,"data-clipboard-target":"#embed-text",onSuccess:this.onCopied},e?"Copied!":"Copy"),i.createElement("label",{className:Xoe},i.createElement("input",{type:"checkbox",checked:t,onChange:()=>{this.setState({autoplay:!t})}}),"Autoplay video"))))}renderContent(){return i.createElement("div",{className:Hoe},this.renderCopyEmbed())}renderDescription(){return i.createElement("div",{className:Goe},"Copy and paste the following code into your website or blog to embed this video.")}render(){return i.createElement("div",{className:Woe},this.renderClose(),i.createElement("div",{className:joe},"Embed Content"),this.renderDescription(),this.renderContent())}}const Qoe=m.exports.connect((e=>({currentVideo:e.currentVideo})))(Joe),Zoe="ShareLink-module_container_45cOO",ene="ShareLink-module_loadingContainer_SEZGJ",tne="ShareLink-module_loader_2ehy3",ane="ShareLink-module_closeContainer_6WCvs",one="ShareLink-module_title_WPALv",nne="ShareLink-module_contentContainer_OZc9b",rne="ShareLink-module_linkContainer_NGdcl",ine="ShareLink-module_linkText_ifgbp",sne="ShareLink-module_copyLink_j-lXz";class lne extends r.exports.Component{constructor(e){super(e),a(this,"copyTimeout"),a(this,"getShortLink",(()=>{const{currentVideo:e}=this.props,{code:t}=e||{};try{return Uoe(t)}catch(a){return Iu({description:"Failed to get share link",error:a}),"n/a"}})),a(this,"onCopied",(()=>{this.setState({copiedShortLink:!0}),setTimeout((()=>this.setState({copiedShortLink:!1})),3e3)})),a(this,"onClickLink",(e=>{e.target.setSelectionRange(0,e.target.value.length)})),a(this,"renderClose",(()=>i.createElement("div",{className:ane},i.createElement(pe,{onClick:this.props.hideOverlay})))),this.state={copiedShortLink:!1}}componentWillUnmount(){this.copyTimeout&&clearTimeout(this.copyTimeout)}renderShortLink(){const{copiedShortLink:e}=this.state;return i.createElement("div",null,i.createElement("div",{className:rne},i.createElement("input",{className:ine,id:"short-link",onClick:this.onClickLink,readOnly:!0,value:this.getShortLink()}),i.createElement(va,{className:sne,"data-clipboard-target":"#short-link",onSuccess:this.onCopied},e?"Copied":"Copy")))}renderContent(){return i.createElement("div",{className:nne},this.renderShortLink())}render(){const{code:e}=this.props.currentVideo||{};return null==e?i.createElement("div",{className:ene},this.renderClose(),i.createElement("div",{className:tne},i.createElement(CO,null))):i.createElement("div",{className:Zoe},this.renderClose(),i.createElement("div",{className:one},"Share a link"),this.renderContent())}}const dne=m.exports.connect((e=>({currentVideo:e.currentVideo})))(lne),cne="VideoPlayer-module_videoPlayerContainer_-xB76",une="VideoPlayer-module_videoPlayerLandscape_tQRnz",mne="VideoPlayer-module_videoPlayerPortrait_LNLpK",pne="VideoPlayer-module_videoPlayerImage_HfG6k",hne=i.memo((({autoPlay:e=!0,currentVideo:t,local_url:a,loop:o=!1,maxHeight:n,maxWidth:s,minHeight:l,muted:d=!1,showControls:c=!0,setCurrentVideoRef:u})=>{const{isProjectFetched:p}=tr((e=>({isProjectFetched:e.studioLocal.isProjectFetched})),m.exports.shallowEqual),[h,g]=r.exports.useState(!0),[y,f]=r.exports.useState(!1),E=r.exports.useRef(null),[v,w]=r.exports.useState(!1),b=r.exports.useRef(""),_=wa(),T=oe(),S={};n&&(S.maxHeight=600,S.height="100%"),s&&(S.maxWidth=600,S.width="100%");const I=zd(t.fullPath);r.exports.useEffect((()=>{E.current&&(null==u||u(E))}),[y,u]);return r.exports.useEffect((()=>{if(t._id===_.id){if(b.current.startsWith("blob:"))return;b.current=tT(t,"fullPath"),g(!1)}}),[t,p,_.id]),h?i.createElement(CO,{text:"Getting url...",textStyles:{color:"#eee",fontWeight:600}}):i.createElement("div",{className:cne},"image"===I||"gif"===I||t.isImage?(()=>{const e={};return l&&(e.minHeight=l),i.createElement("img",{alt:"Final",src:a||tT(t,"fullPath"),style:e,className:pne,"data-cy":"final-image",loading:"lazy",onError:()=>Ec(Bd.ACCESS_EXPIRED_EXPORT,{videoId:t._id,entryPoint:$te.FINAL_VIDEO_PAGE})})})():i.createElement("video",{id:"final-video","data-cy":"final-video",onLoadedMetadata:()=>{if(console.debug("onloadedmetadata"),!E.current)return;if(!("videoWidth"in E.current))return;const{videoWidth:e,videoHeight:t}=E.current;t>e&&w(!0);if("true"===new URLSearchParams(T.search).get(h9.COMMENT)){const e=jc.get("VIDEO_TIME_BEFORE_SIGN_IN",{disabled:0});e&&(E.current.currentTime=Number(e),console.debug("about to remove video time",e),jc.remove("VIDEO_TIME_BEFORE_SIGN_IN"))}},ref:e=>{E.current=e,f(!0)},autoPlay:e,className:(()=>{let e="";return e+=v?` ${mne}`:` ${une}`,e})(),controls:c,loop:o,muted:d,playsInline:!0,preload:"auto",src:t.fullPath,style:S,controlsList:"nodownload",onError:()=>Ec(Bd.ACCESS_EXPIRED_EXPORT,{videoId:t._id,entryPoint:$te.FINAL_VIDEO_PAGE})}))}));var gne=(e=>(e.DOWNLOAD="download",e))(gne||{});const yne="VideoProgress-module_proBadge_qakM6",fne="VideoProgress-module_videoProgressWrapper_4WpNs",Ene="VideoProgress-module_videoProgressContainer_2sVh-",vne="VideoProgress-module_videoProgressBg_1HUcb",wne="VideoProgress-module_videoBgThumbnail_QotEq",bne="VideoProgress-module_progressOverlay_M1ceQ",_ne="VideoProgress-module_topProcessingText_DmGha",Tne="VideoProgress-module_bottomProcessingText_-Pxhc",Sne="VideoProgress-module_processingTextLine_pfrZA",Ine="VideoProgress-module_processingLink_7aBM-",xne="VideoProgress-module_processingTextHeader_W0LFH",kne="VideoProgress-module_progressContainer_N-Mj3",Cne="VideoProgress-module_progressPercentage_f9MN5",Ane="VideoProgress-module_progressBarWrapper_yMpGY",Nne="VideoProgress-module_checkmark_fhTPm",Pne="VideoProgress-module_progressBar_tuAUp",Rne="VideoProgress-module_errorIcon_Eubye",Lne="VideoProgress-module_videoErrorContainer_-sGRX",Dne="VideoProgress-module_videoErrorTop_Bd83q",One="VideoProgress-module_videoErrorBottom_ZmGDY",Fne="VideoProgress-module_videoErrorContainerRight_QwZPY",Mne="VideoProgress-module_videoErrorHeader_HDthA",Une="VideoProgress-module_videoErrorDescription_ynvFj",Bne="VideoProgress-module_errorButtonContainer_m6sy6",Wne="VideoProgress-module_studioBackButton_J-tLG",Vne="VideoProgress-module_reportProblemButton_WAGD-",jne="VideoProgress-module_progressInfo_77uL2",Gne=e=>{const{progressDict:t}=e,{stageNum:a,numStages:o,stagePercentage:n,stageName:r}=t,s=a/o*100-100/o+n/100*(100/o);return i.createElement("div",{className:Ane},i.createElement(i.Fragment,null,i.createElement("div",{className:Cne,style:{marginLeft:"clamp(2%, 3%, 87%)",width:`clamp(2%, ${s}%, 95%)`,minWidth:220}},i.createElement("div",{className:jne},i.createElement("div",null,"Stage ",i.createElement("span",null,a||1)," of"," ",i.createElement("span",null,o||1),": ",i.createElement("span",null,r||"")),i.createElement("div",null,i.createElement("span",{translate:"no"},Math.min(99,Math.ceil(n)||51)),"% complete"))),i.createElement("div",{className:kne,id:"progress-container"},i.createElement("div",{className:Pne,style:{display:"block",width:`${s}%`,height:"100%"}}))))},Hne=we((({currentVideo:e,currentUser:t,currentFolderId:a,thumbnailUrl:o,onFirstProgressLoad:n,onFinishedVideo:s,match:l})=>{const d=m.exports.useDispatch(),[c,u]=r.exports.useState(null),[p,h]=r.exports.useState(!1),[g,y]=r.exports.useState(!1),f=r.exports.useRef(e.pendingProcessOnClient),E=r.exports.useRef(null),v=r.exports.useRef(!1),w=sd(),b=XD(Ps.FAST_EXPORT),_=["Loading ...","Initializing servers ...","Setting up connection ...","Getting your export ready ...","Reaching server ...","Checking settings ...","mp3"===e.videoType?"Arranging bits ... ":"Lining up pixels ..."];let T=0;const[S,I]=r.exports.useState(_[T]||"Loading ..."),x=Oq((t=>{e._id===l.params.id&&e.clientSideProcessingInProgress&&(t.preventDefault(),t.returnValue="Are you sure you want to leave the page? Your current progress will be lost.")})),k=r.exports.useCallback((()=>{E.current&&clearInterval(E.current),E.current=null}),[]),C=Oq((async()=>{if(e._id&&v.current){I(_[T%_.length]||"Loading ..."),T+=1;try{const a=await d((t=e._id,()=>hu(`/api/v1/videos/${t}/progress`,{params:{id:t}})));if(P(a))return s(),h(!0),void k();if(a.hasError)return s(),y(!0),void k();if(a.done)return k(),u({stageNum:5,numStages:5,stagePercentage:100,stageName:"Upload"}),void(await N());if(console.debug("Checking progress!"),a.progressDict){c||n();const e=JSON.parse(a.progressDict);u({...e})}}catch(a){console.error(a)}var t}})),A=r.exports.useCallback((()=>{k(),E.current=window.setInterval(C,3500)}),[C,k]);r.exports.useEffect((function(){return v.current=!0,e.local_url||A(),window.addEventListener("beforeunload",x),()=>{k(),window.removeEventListener("beforeunload",x),v.current=!1}}),[A,k,e.local_url,x]),r.exports.useEffect((function(){!e.pendingProcessOnClient&&f.current&&A()}),[A,e.pendingProcessOnClient,c]);const N=async()=>{k();try{await d(wR({id:e._id,preserveId:!0})),s()}catch(t){if(t&&"object"==typeof t&&"statusCode"in t&&"number"==typeof t.statusCode&&[403,404,410].includes(t.statusCode)){const{message:e}=xu(t);d(Su({description:e,type:"error"}))}else A()}},P=t=>{var a,o,n;if(!t.hasError||!e.isCreator)return!1;if(t.explainedErrorKind===gne.DOWNLOAD){if(null==(o=null==(a=t.explainedErrorParams)?void 0:a.layer_ids)?void 0:o.length){const a=US(null!=(n=e.scenes)?n:[],t.explainedErrorParams.layer_ids);if(a.length)return YG(a,!1),!0}return!1}return!1};return i.createElement("div",{className:fne},i.createElement("div",{className:Ene,"data-cy":"video-progress-container"},i.createElement("div",{className:vne},o&&i.createElement("img",{className:wne,src:o,alt:"Project thumbnail"})),i.createElement("div",{className:bne},i.createElement("div",{className:_ne},!sc(t)&&i.createElement(i.Fragment,null,i.createElement("div",{className:xne},"Just a minute..."),i.createElement("div",{className:Sne},"Your content is being exported and will appear here automatically when complete.")),w.planTier===vs.Pro&&i.createElement("div",{className:yne},"PRO"),b&&i.createElement("div",{className:Sne},i.createElement(Te,{className:Nne}),"Fast processing"),!e.watermark&&i.createElement("div",{className:Sne},i.createElement(Te,{className:Nne}),"Watermark-free")),(()=>{if(e.clientSideProcessingInProgress)return i.createElement(CO,{text:"Hang tight.",secondaryText:"Please don't refresh or close this tab.",textStyles:{color:"#fff"},wrapperStyles:{maxWidth:"250px"}});if(p||g){const t=p?"Looks like there's an invalid layer.":"Oops, an error occurred with your video.",a=p?" There was an issue fully downloading one of your provided media files. Go back to Studio to remove the layer and try re-exporting.":"";return i.createElement("div",{className:Lne},i.createElement("div",{className:Dne},i.createElement("div",null,i.createElement(_a,{className:Rne})),i.createElement("div",{className:Fne},i.createElement("div",{className:Mne},t),i.createElement("div",{className:Une},a))),i.createElement("div",{className:One},i.createElement("a",{href:"https://www.kapwing.com/help/export-troubleshooting-tips/",target:"_blank",rel:"noopener noreferrer"},i.createElement("div",{className:Bne},i.createElement("div",{className:Vne},"Video Troubleshooting"))),p&&i.createElement("div",{className:Bne},i.createElement(at,{to:`/editor/videos/${e._id}`},i.createElement("div",{className:Wne},"Back to Studio")))))}return c?i.createElement(Gne,{progressDict:c}):i.createElement(CO,{textStyles:{color:"#fff"},text:S})})(),i.createElement("div",{className:Tne},sc(t)&&a&&!e.clientSideProcessingInProgress?i.createElement("div",{className:Sne},"This content will be saved to your"," ",i.createElement(at,{className:Ine,to:`/folder/${a}`},"Workspace"),"."):i.createElement("div",{className:Sne},"Want to learn more about editing on Kapwing? Check out the Kapwing"," ",i.createElement("a",{className:Ine,href:"https://www.youtube.com/channel/UCR5GrKMeaZJxPKVMdEgKIKA?sub_confirmation=1",target:"blank",rel:"noopener noreferrer"},"Youtube Channel")," ",i.createElement(ba,null))))))})),zne="ReportIssueModal-module_prompt_5DH6w",$ne="ReportIssueModal-module_issueSelect_SN3dt",Kne="ReportIssueModal-module_commentArea_Eih4Q",Yne="ReportIssueModal-module_emailInput_ddkLa",qne=["Can’t download or play video.","Wrong duration or timing issues.","Text size, position or appearance is wrong.","Audio is missing or is out of sync.","Quality or resolution of output isn’t correct.","Image, shape or video position/appearance is wrong.","Can’t upload media.","Issue saving work or progress.","Layers (e.g. image, video, text, subtitles) are missing.","Subscription or billing issue.","Sharing or managing a Team.","Issues with our Brand Kit.","Finding a project.","Other"],Xne=m.exports.connect((e=>({state:e,currentUser:e.currentUser,currentVideo:e.currentVideo})),(e=>me({showToast:Su},e))),Jne=Xne((({hide:e,currentUser:t,state:a,currentVideo:o,videoId:n,showToast:i,fromVideoProgress:s=!1,fromWorkspace:l})=>{var d;const{currentFolderId:c}=tr((e=>({currentFolderId:e.workspaces.selectedWorkspace})),ar),{user:u}=t,m=id(),p=sd(),h=t$(a,!1),[g,y]=r.exports.useState(""),[f,E]=r.exports.useState(""),[v,w]=r.exports.useState(""),[b,_]=r.exports.useState(!1),T=null==(d=null==o?void 0:o.build)?void 0:d.canaryCluster,S=g&&((null==u?void 0:u._id)||v.includes("@"))&&!b&&f.length>0;return r.exports.createElement(_O,{unsetCancelModal:b?void 0:e,confirmButtonOptions:{confirmFn:async()=>{var a,r;_(!0);const d={selectedIssue:g,comment:f,email:v,fromVideoProgress:s,pageURL:window.location.href,currentUser:t,snapshotVideo:h,teamId:m._id,currentFolderId:c},y=null!=(a=null==u?void 0:u.email)?a:v;try{vc("Report a Problem",{Email:y,"Signed In":!!u,"Pro User":p.is(vs.Pro),"Video ID":n,"Link to Video":`kapwing.com/videos/${n}`,"Video Finished":o.done,"Video Build Error":null==(r=o.build)?void 0:r.error,"Error Reason":g,Details:f,Timestamp:(new Date).toISOString(),"From Video Progress":s,"Run On Canary":T,"Current Plan":Js(m.planTier),"Folder ID":c}),l?await gu("/api/v1/videos/reportProblem",{body:d}):await gu(`/api/v1/videos/${n}/reportProblem`,{body:d}),i({description:"This issue has been logged and our team will look into it. We’ll follow up with you at the email address associated with your account.",link:{text:"Read our Video Processing FAQ for troubleshooting advice.",href:"https://www.kapwing.com/help/video-processing-faq/"},type:"success"})}catch(YEe){Iu({description:"Failed to submit report",error:YEe})}e()},disabled:!S,confirmText:"Submit"}},r.exports.createElement(_O.Header,null,"Report a Problem"),r.exports.createElement("label",{className:zne},"What went wrong?",r.exports.createElement("select",{className:$ne,value:g,onChange:e=>y(e.target.value)},r.exports.createElement("option",{value:""},"Select an Issue"),qne.map((e=>r.exports.createElement("option",{key:e,value:e},e))))),!(null==u?void 0:u._id)&&r.exports.createElement("label",{className:zne},"Email",r.exports.createElement("input",{className:Yne,type:"email",value:v,onChange:e=>w(e.target.value)})),r.exports.createElement("label",{className:zne},"Details",r.exports.createElement("textarea",{value:f,onChange:e=>E(e.target.value),placeholder:"Please add as much information (including any steps we can use to reproduce your issue) as possible.",className:Kne})))})),Qne="ShareTikTok-module_container_AJ3Xd",Zne="ShareTikTok-module_closeContainer_3ozxp",ere="ShareTikTok-module_contentContainer_Lucoi",tre="ShareTikTok-module_title_EdbbH",are="ShareTikTok-module_icon_eH2VA",ore="ShareTikTok-module_context_sFzTX",nre="ShareTikTok-module_button_UKE07",rre=({hideOverlay:e})=>{let t;const a=()=>{const{location:{protocol:e,host:a,pathname:o}={}}=window;t=`${e}//${a}${o}${(null==o?void 0:o.endsWith("/"))?"":"/"}logintiktok`,window.location.href=t};return i.createElement("div",{className:Qne},i.createElement("img",{src:"https://i.imgur.com/Axk8BiL.png",alt:"Kapwing and TikTok"}),i.createElement("div",{className:Zne},i.createElement(pe,{onClick:e})),i.createElement("div",{className:ere},i.createElement("div",{className:tre},"Share to TikTok"),i.createElement("div",{className:ore},"After clicking the share button you will be redirected to TikTok's website, where you will be prompted to sign in and then authorize Kapwing to share videos for you. Then, you will be able to complete sharing from the TikTok app."),i.createElement("button",{type:"button",className:nre,onClick:a},i.createElement(xt,{className:are})," Share to TikTok")))},ire="FollowUsOnTwitter-module_container_L8NU6",sre="FollowUsOnTwitter-module_closeContainer_TvtZD",lre="FollowUsOnTwitter-module_contentContainer_bexQN",dre="FollowUsOnTwitter-module_title_9CFvO",cre="FollowUsOnTwitter-module_icon_e1CLr",ure="FollowUsOnTwitter-module_context_cVGau",mre="FollowUsOnTwitter-module_twitterButton_gMTFv",pre="FollowUsOnTwitter-module_followButton_hUy9P",hre=({hideOverlay:e})=>{r.exports.useEffect((()=>{const e=document.createElement("script");e.src="https://platform.twitter.com/widgets.js",e.charset="utf-8",document.body.appendChild(e)}),[]);return i.createElement("div",{className:ire},i.createElement("div",{className:sre},i.createElement(pe,{onClick:e})),i.createElement("div",{className:dre},i.createElement(Ta,{className:cre})," Your download has started!"),i.createElement("div",{className:lre},i.createElement(i.Fragment,null,i.createElement("div",{className:ure},"Your content has started downloading. Please check your downloads folder for your exported file."),i.createElement("div",{className:ure},"We'd love to connect with you on social media. Follow us to get the latest information on product changes, feature updates, and social media trends."),i.createElement("div",{className:pre},i.createElement("a",{href:"https://twitter.com/KapwingApp?ref_src=twsrc%5Etfw",className:`twitter-follow-button ${mre}`,"data-size":"large","data-show-count":"false"},"Follow @KapwingApp")))))},gre="CommentSection-module_commentSection_XqVp7",yre="CommentSection-module_mobileCommentSection_E-5Ff",fre="CommentSection-module_studioCommentSection_LLY3e",Ere="CommentSection-module_commentsTitle_-tDSv",vre="CommentSection-module_emptyCommentMessage_mT1aX",wre="CommentSection-module_commentsContent_RqN-c",bre="CommentSection-module_selectedCommentsContent_YCFF0",_re="CommentSection-module_videoCommentsContent_JFT65",Tre="CommentSection-module_videoCommentSection_JM301",Sre="CommentSection-module_commentPostContainer_plgkT",Ire="CommentSection-module_selectedCommentPostContainer_6B-Kb",xre="CommentSection-module_commentThreadContainer_bsn99",kre="CommentSection-module_fillMaxHeight_dz4SB",Cre="CommentSection-module_signInLink_BFHBN",Are="CommentSection-module_emptyCommentContainer_-kuet",Nre="Timestamp-module_timestamp_3o0bP",Pre="Timestamp-module_staticTimestamp_taL8V",Rre="Timestamp-module_timestampContainer_ticJR",Lre="Timestamp-module_timestampEditableContainer_1-9nG",Dre="Timestamp-module_staticTimestampInEditContainer_eQIjO",Ore="Timestamp-module_disabledTimestampContainer_EPdfn",Fre="Timestamp-module_staticTimestampContainer_4ufKX",Mre="Timestamp-module_timestampEditable_pOXSY",Ure=({videoTimestamp:e,isEditable:t,maxTime:a,disabled:o,inEditModeComment:n,seekOnCurrentVideo:r})=>{const{hours:s,minutes:l,seconds:d}=(e=>{let t=e;const a=Math.floor(t/3600);return t%=3600,{hours:a,minutes:Math.floor(t/60),seconds:Math.floor(t%60)}})(e),c=e=>{e.target.type="text",e.target.setSelectionRange(0,e.target.value.length),e.target.type="number"},u=(e,t)=>{const o=parseInt(e.target.value),n=("seconds"===t?o:d)+60*("minutes"===t?o:l)+3600*("hours"===t?o:s),i=Math.min(n,a);r(i)};return t?i.createElement("div",{className:`${Lre} ${o?Ore:""}`,"data-cy":"comment-post-timestamp"},!!s&&i.createElement(i.Fragment,null,i.createElement("input",{className:Mre,type:"number",name:"hours",value:s.toString().padStart(2,"0"),placeholder:s.toString(),onFocus:c,onChange:e=>u(e,"hours"),"data-cy":"comment-post-timestamp-hours"}),i.createElement("span",{className:Nre},":")),i.createElement("input",{className:Mre,type:"number",name:"minutes",value:l.toString().padStart(2,"0"),placeholder:l.toString(),onFocus:c,onChange:e=>u(e,"minutes"),"data-cy":"comment-post-timestamp-seconds"}),i.createElement("span",{className:Nre},":"),i.createElement("input",{className:Mre,type:"number",name:"seconds",value:d.toString().padStart(2,"0"),placeholder:d.toString(),onFocus:c,onChange:e=>u(e,"seconds"),"data-cy":"comment-post-timestamp-seconds"})):i.createElement("div",{className:`${Rre} ${n?Dre:Fre} ${o?Ore:""}`,onClick:t=>{t.stopPropagation(),r(e)}},i.createElement("div",{className:Pre},!!s&&`${s.toString().padStart(2,"0")}:`,l.toString().padStart(2,"0"),":",d.toString().padStart(2,"0")))},Bre="CommentPost-module_commentPostContainer_vy9lg",Wre="CommentPost-module_replyPostContainer_GEP9e",Vre="CommentPost-module_commentPostRow_FpBer",jre="CommentPost-module_commentPostRow2_-0CaE",Gre="CommentPost-module_commentPostContainerInputFocused_xa4qj",Hre="CommentPost-module_timeStampAndInputContainer_qRvs7",zre="CommentPost-module_postTextBox_xlPKW",$re="CommentPost-module_disabledPostTextBox_mexvv",Kre="CommentPost-module_postTextBoxWithTimestamp_MJanO",Yre="CommentPost-module_postTextBoxWithLongTimestamp_sob2Y",qre="CommentPost-module_checkboxContainer_ZEcpy",Xre="CommentPost-module_postButton_A5lUy",Jre="CommentPost-module_disabledPostButton_Y0gkn",Qre="CommentPost-module_inlinePostButton_6u0CQ",Zre="CommentPost-module_invisibleTranslatablePlaceholder_eNauQ",eie="Checkbox-module_container_dJwO5",tie="Checkbox-module_checkboxContainer_zcwNm",aie="Checkbox-module_label_xYViQ",oie=({label:e,checked:t,onChange:a,disabled:o})=>i.createElement("div",{className:eie,onClick:()=>!o&&a(!t),style:{opacity:o?.5:1}},i.createElement("div",{className:tie},i.createElement(Sa,{size:16,style:{opacity:t?1:0}})),i.createElement("div",{className:aie},e)),nie=({currentVideoTime:e,userCanPostComment:t,maxTime:a,disabled:o,mobileView:n,replyPost:s,onPostSuccess:l,location:d,seekOnCurrentVideo:c,commentContainerRef:u,inputBoxRef:p,setCommentFromLocalStorage:h,handleSignInToComment:g})=>{var y;const{selectedCommentParentId:f,currentVideo:E,currentUser:v}=tr((e=>{const{selectedCommentId:t,comments:a}=e.comments;return{selectedCommentParentId:noe(a,t),currentVideo:e.currentVideo,currentUser:e.currentUser}}),m.exports.shallowEqual),w=s?f:void 0,[b,_]=r.exports.useState(!1),[T,S]=r.exports.useState(!1),[I,x]=r.exports.useState(!1),[k,C]=r.exports.useState(!s),A=r.exports.useRef(null),N=m.exports.useDispatch(),P=oe(),R=o||!I||T;r.exports.useEffect((function(){"true"===new URLSearchParams(P.search).get(h9.COMMENT)&&p.current&&(h(),x(!!p.current.innerText.trim()))}),[p,P.search,h]);const L=async()=>{if(!sc(v))return void g(!1);S(!0);const t=p.current.innerText.trim();if(!t)return void N(Su({description:"Please enter a comment.",type:"error"}));const a=E._id;if(a){try{const o={content:t,videoTime:k?e:void 0,submittedAt:E.submittedAt,location:d,parentId:w},r=await gu(`/api/v1/videos/${a}/addComment`,{body:o});Mc(w?"reply":"new comment",d,{includeTimestamp:k,teamId:E.teamId,creatorId:E.creatorId}),n&&p.current&&p.current.blur(),N(Vw(r.newComment)),null==l||l(),w&&N(Uw(r.newComment._id))}catch(YEe){Iu({description:"Failed to post comment.",error:YEe})}p.current&&(p.current.innerText="",x(!1)),S(!1)}else N(Su({description:"There was an error with getting the id of the current video.",type:"error"}))};let D=w?"Type your reply":"Type something";t?o&&(D="Exporting in progress... you can leave a comment after the export is complete"):D="Sign in to comment.";const O=()=>{p.current.blur(),g(!0,JF.INPUT_CLICK)},F=[];F.push([!o&&t?zre:$re]),void 0!==e&&k&&(e>=3600?F.push(Yre):F.push(Kre));const M=i.createElement("div",{className:R?Jre:Xre,"data-cy":"comment-post-button","data-testid":"comment-post-button",onClick:L},s?"Reply":"Comment");return i.createElement("div",{className:`${s?Wre:Bre} ${n&&b?Gre:""}`,ref:e=>{if(e&&s){if(!u.current)return;const t=u.current.getBoundingClientRect(),a=e.getBoundingClientRect();(a.bottom>t.bottom||a.top<t.top)&&e.scrollIntoView({block:"end",behavior:"smooth"})}},"data-cy":s?"comment-reply-box":"comment-post-box"},i.createElement("div",{className:Zre,ref:A,translate:"yes"},D),i.createElement("div",{className:Vre},i.createElement("div",{className:Hre},void 0!==e&&k&&i.createElement(Ure,{key:"commentTimeStamp",videoTimestamp:e,isEditable:!o,maxTime:a,seekOnCurrentVideo:c}),i.createElement("div",{className:F.join(" "),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),L())},onKeyUp:e=>{const t=e.target.innerText||"";x(!!t.trim().length)},onBlur:e=>{e.target.innerText.trim().length||(e.target.innerText=""),n&&_(!1)},onClick:()=>{!n&&!s||t?QF(JF.INPUT_CLICK):O()},ref:p,"data-placeholder":(null==(y=A.current)?void 0:y.textContent)||D,contentEditable:!o,onPaste:e=>{o||ioe(e)},"data-cy":"comments-input-field","data-testid":"comments-input-field"})),void 0===e&&i.createElement("div",{className:Qre},M)),void 0!==e&&i.createElement("div",{className:jre},i.createElement("div",{className:qre},i.createElement(oie,{disabled:o,label:"Include timestamp",checked:k,onChange:()=>{!n&&!s||t?C(!k):O()}})),M))},rie="CommentElement-module_commentContainer_qXF8U",iie="CommentElement-module_selectedCommentContainer_KqbuK",sie="CommentElement-module_threadParentComment_du-w2",lie="CommentElement-module_childCommentContainer_l-gVR",die="CommentElement-module_commentHeader_J1VYT",cie="CommentElement-module_timestampAndCommentContainer_grCab",uie="CommentElement-module_editingTimestampAndCommentContainer_tm4X5",mie="CommentElement-module_commentContent_z4IMo",pie="CommentElement-module_userName_EWcnK",hie="CommentElement-module_profilePic_8p5FX",gie="CommentElement-module_dateText_ia47-",yie="MoreOptions-module_moreOptions_93QzE",fie="MoreOptions-module_moreOptionsIcon_VVJh9",Eie="MoreOptions-module_buttonContainer_oRiF2",vie="MoreOptions-module_buttonLabel_SLQvg",wie="MoreOptions-module_buttonText_gVjm9",bie="MoreOptions-module_buttonIcon_hjLoZ",_ie=({handleEditing:e,handleDeleteComment:t})=>{const[a,o]=r.exports.useState(!1),n=r.exports.useRef(null),s=r.exports.useRef(null),l=e=>{e.stopPropagation(),o((e=>!e))};return r.exports.useEffect((function(){const e=e=>{var t,a;(null==(t=s.current)?void 0:t.contains(e.target))||(null==(a=n.current)?void 0:a.contains(e.target))||o(!1)};if(a)return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[a]),i.createElement("div",{ref:n,className:yie},i.createElement(Ia,{size:22,className:fie,onClick:e=>{l(e)},"data-cy":"comment-options-toggle"}),a&&n.current&&i.createElement("div",{className:Eie,ref:e=>{null==e||e.scrollIntoView({block:"nearest"}),s.current=e}},t&&i.createElement("div",{className:vie,onClick:e=>{l(e),t()},"data-cy":"delete-comment-button"},i.createElement(xa,{className:bie}),i.createElement("span",{className:wie},"Delete")),e&&i.createElement("div",{className:vie,onClick:t=>{l(t),e()},"data-cy":"edit-comment-button"},i.createElement(ka,{className:bie}),i.createElement("span",{className:wie},"Edit"))))},Tie="CommentEdit-module_editTextBox_gMXmK",Sie="CommentEdit-module_editTextBoxLongTimestamp_Q3wjB",Iie="CommentEdit-module_editButtonsContainer_G8-tI",xie="CommentEdit-module_saveButton_S69Q6",kie="CommentEdit-module_cancelButton_6FJFJ",Cie="CommentEdit-module_buttonText_IFvqV",Aie="CommentEdit-module_disabledSaveButton_6SVDO",Nie=({comment:e,setEditMode:t,location:a})=>{const o=m.exports.useDispatch(),n=r.exports.useRef(!1),[s,l]=r.exports.useState(e.content);async function d(){try{await yu(`/api/v1/comments/${e._id}`,{body:{content:s}}),Mc("edited comment",a),o(jw({commentId:e._id,updates:{content:s}})),t(!1)}catch(YEe){Iu({description:"Failed to edit the comment",error:YEe})}}const c=s.trim().length>0;return i.createElement(i.Fragment,null,i.createElement("div",{className:`${Tie} ${(e.videoTime||0)>=3600?Sie:""}`,onKeyUp:e=>{l(e.target.innerText)},onClick:e=>e.stopPropagation(),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),d())},ref:e=>{if(e&&n.current){null==e||e.focus();const t=document.createRange();t.selectNodeContents(e),t.collapse(!1);const a=window.getSelection();a&&(a.removeAllRanges(),a.addRange(t)),n.current=!1}},onPaste:ioe,contentEditable:!0,suppressContentEditableWarning:!0},e.content),i.createElement("div",{className:Iie,ref:e=>{null==e||e.scrollIntoView({block:"nearest",behavior:"smooth"})}},i.createElement("button",{className:kie,type:"submit",onClick:a=>{a.stopPropagation(),l(e.content),t(!1)}},i.createElement("span",{className:Cie},"Cancel")),i.createElement("button",{className:`${xie} ${c?"":Aie}`,type:"submit",disabled:!c,onClick:e=>{e.stopPropagation(),c&&d()}},i.createElement("span",{className:Cie},"Save"))))},Pie="DeleteCommentDialog-module_deleteDialogContainer_jUz0E",Rie="DeleteCommentDialog-module_header_c-s1v",Lie="DeleteCommentDialog-module_description_Ioldc",Die="DeleteCommentDialog-module_buttonsContainer_yJ-Vf",Oie=({onDelete:e,hideDelete:t,hasReplies:a})=>{const[o,n]=r.exports.useState(!1);let s="Delete Comment",l="Are you sure you want to delete this comment?";return a&&(s+=" Thread",l+=" Deleting this comment will delete all replies in the thread."),i.createElement(_O,{unsetCancelModal:t,overlayContainerSmaller:!0,usePortal:!0},i.createElement("div",{className:Pie},i.createElement("div",{className:Rie},s),i.createElement("div",{className:Lie},l),i.createElement("div",{className:Die},i.createElement(iO,{cancelFn:t,confirmFn:async()=>{n(!0),e(),n(!1),t()},loadingMsg:o?"Deleting...":void 0,stopClickPropogation:!0,cancelStyle:{color:"black"}}))))},Fie="CommentReplyCount-module_container_TAje5",Mie="CommentReplyCount-module_profilePic_4R9dC",Uie=({commentReplies:e})=>{const t=[],a=new Set;for(const{_id:o,user:n}of e){const e=null==n?void 0:n.picture;if(e){if(a.has(e))continue;if(t.push(i.createElement(SQ,{key:o,user:n,className:Mie})),a.add(e),t.length>3)break}}return i.createElement("div",{className:Fie},t,i.createElement("span",null,e.length>1?`${e.length} replies`:"1 reply"))},Bie=({comment:e,replies:t,maxTime:a,disableTimeStamp:o,isChild:n,location:s,onCommentSelected:l,onCommentEditStart:d,seekOnCurrentVideo:c,threadParent:u})=>{var p,h;const{selectedCommentId:g,currentUser:y,currentVideo:f}=tr((e=>({selectedCommentId:e.comments.selectedCommentId,currentUser:e.currentUser,currentVideo:e.currentVideo})),m.exports.shallowEqual),E=g===e._id,[v,w]=r.exports.useState(!1),[b,_]=r.exports.useState(!1),T=r.exports.useRef(!1),S=m.exports.useDispatch();r.exports.useEffect((function(){E&&null!==e.videoTime&&c(e.videoTime)}),[]);const x=e.creatorId===y.user._id,k=x||!!f.creatorId&&f.creatorId===y.user._id,C=Object.keys(null!=(p=e.user)?p:{}).length>0?null==(h=e.user)?void 0:h.name:"Deleted user";return i.createElement("div",{className:(()=>{const e=[rie];return n&&e.push(lie),E&&e.push(iie),u&&e.push(sie),e.join(" ")})(),onClick:()=>{E?S(Uw("")):(S(Uw(e._id)),l(e._id,e.videoTime))},spellCheck:!1,key:e._id,"data-cy":"video-comment"},i.createElement("div",{className:die},i.createElement(SQ,{user:e.user,className:hie,custom:uoe(e)}),i.createElement("div",{className:pie,translate:"no"},C),i.createElement("span",{className:gie},(A=e.createdAt,I(A).format("h:mma MMMM Do"))),(x||k)&&i.createElement(_ie,{handleEditing:x?()=>{d(e.videoTime),T.current=!0,w(!0)}:void 0,handleDeleteComment:k?()=>_(!0):void 0})),i.createElement("div",{className:`${cie} ${v?uie:""}`},null!==e.videoTime&&i.createElement(Ure,{videoTimestamp:e.videoTime,isEditable:!1,maxTime:a,disabled:o,inEditModeComment:v,seekOnCurrentVideo:c}),i.createElement("span",{translate:"no"},v?i.createElement(Nie,{comment:e,setEditMode:w,location:s}):i.createElement("div",{className:mie},e.content))),(null==t?void 0:t.length)&&i.createElement(Uie,{commentReplies:t}),b&&i.createElement(Oie,{hideDelete:()=>_(!1),onDelete:async()=>{try{await pu(`/api/v1/comments/${e._id}`,{}),Mc("deleted comment",s,{teamId:f.teamId,creatorId:f.creatorId}),S(Gw(e._id))}catch(YEe){Iu({description:"Failed to delete comment",error:YEe})}},hasReplies:!!(null==t?void 0:t.length)}));var A},Wie="CommentThread-module_commentList_XIyop",Vie=({parentComment:e,replies:t,onCommentSelected:a,onCommentEditStart:o,maxTime:n,seekOnCurrentVideo:r,location:s})=>i.createElement("div",{className:Wie},i.createElement(Bie,{key:e._id,comment:e,disableTimeStamp:!!(e.videoTime&&e.videoTime>n),maxTime:n,onCommentSelected:a,onCommentEditStart:o,seekOnCurrentVideo:r,threadParent:!0,location:s}),null==t?void 0:t.map((e=>i.createElement(Bie,{key:e._id,comment:e,disableTimeStamp:!!(e.videoTime&&e.videoTime>n),maxTime:n,isChild:!0,onCommentSelected:a,onCommentEditStart:o,seekOnCurrentVideo:r,location:s})))),jie="MobileSelectedCommentHeader-module_commentsThreadHeader_v4seU",Gie="MobileSelectedCommentHeader-module_commentsThreadHeaderLeft_YgaqH",Hie="MobileSelectedCommentHeader-module_commentsThreadHeaderRight_UIeKO",zie="MobileSelectedCommentHeader-module_commentsThreadBackIcon_gWJft",$ie="MobileSelectedCommentHeader-module_disabled_NxyTE",Kie=()=>{const{selectedCommentId:e,comments:t}=tr((e=>({selectedCommentId:e.comments.selectedCommentId,comments:e.comments.comments})),m.exports.shallowEqual),a=m.exports.useDispatch(),[o,n]=r.exports.useState([]),[s,l]=r.exports.useState(0);return r.exports.useEffect((function(){const a=noe(t,e),o=(null==t?void 0:t.filter((e=>!e.parentId)))||[];n(o.map((({_id:e})=>e))),l(o.findIndex((({_id:e})=>e===a)))}),[t,e]),i.createElement("div",{className:jie,"data-cy":"mobile-selected-comment-header"},i.createElement("div",{className:Gie,onClick:()=>{a(Uw())}},i.createElement(Ca,{size:22,className:zie}),"All Comments"),o.length>1&&s+1<=o.length&&i.createElement("div",{className:Hie},i.createElement(Aa,{size:22,className:0===s?$ie:"",onClick:()=>{const e=s-1;e>=0&&a(Uw(o[e]))}}),s+1," of ",o.length,i.createElement(Na,{size:22,className:s+1===o.length?$ie:"",onClick:()=>{const e=s+1;e<o.length&&a(Uw(o[e]))}})))},Yie=({maxTime:e,currentVideoTime:t,onCommentEditStart:a,onCommentSelected:o,contentExporting:n,userCanPostComment:s,mobileView:l,location:d,onCommentPostSuccess:c,seekOnCurrentVideo:u,commentsLoading:p})=>{const h=m.exports.useDispatch(),g=Si(),{comments:y,selectedCommentId:f,selectedComment:E}=tr((e=>{const{comments:t,selectedCommentId:a}=e.comments,o=null==t?void 0:t.find((e=>e._id===a));return{comments:t,selectedCommentId:a,selectedComment:o}}),m.exports.shallowEqual),[v,w]=r.exports.useState([]),[b,_]=r.exports.useState({}),T=r.exports.useRef(null),[S,I]=r.exports.useState(!1),x=oe(),k=r.exports.useRef(null),C=r.exports.useRef(null),A=r.exports.useRef(null);qte(k,(()=>h(Uw(""))),"mouseup");const N=(null==E?void 0:E.parentId)||(null==E?void 0:E._id);r.exports.useEffect((function(){const e=[],t={};null==y||y.forEach((a=>{var o;const{parentId:n}=a;n?(t[n]||(t[n]=[]),null==(o=t[n])||o.push(a)):e.push(a)})),w(e),_(t)}),[y]);const P=()=>{T.current&&T.current.scrollTo({top:T.current.scrollHeight,behavior:"smooth"})},R=r.exports.useCallback((()=>{const e=jc.get("COMMENT_BEFORE_SIGN_IN",{disabled:""});e&&C.current&&(C.current.innerText=e,jc.remove("COMMENT_BEFORE_SIGN_IN"))}),[C]),L=(e=!1,a)=>{var o,n,r;e&&a&&QF(a),(null==(n=null==(o=C.current)?void 0:o.innerText)?void 0:n.trim().length)&&jc.set("COMMENT_BEFORE_SIGN_IN",null==(r=C.current)?void 0:r.innerText.trim()),t&&jc.set("VIDEO_TIME_BEFORE_SIGN_IN",t),I(!0)},D=!!(l&&f&&E);return i.createElement("div",{className:`${l?yre:gre} ${d===mh.Studio?fre:Tre}`,"data-cy":"comments-section","data-testid":"comment-section"},!l&&i.createElement("div",{className:Ere},"Comments"),D&&i.createElement(Kie,null),i.createElement("div",{className:D?bre:d===mh.Studio?wre:_re,ref:T,"data-cy":"comments-list-div",id:"comments-content-list"},p&&i.createElement(CO,{wrapperStyles:{marginTop:20}}),!p&&D&&i.createElement("div",{className:xre},i.createElement(Vie,{maxTime:e,parentComment:E,replies:b[f],onCommentSelected:o,onCommentEditStart:a,seekOnCurrentVideo:u,location:d})),!p&&!D&&(v.length?v.map((n=>n._id===N?i.createElement("div",{key:n._id,ref:k},i.createElement(Vie,{maxTime:e,parentComment:n,replies:b[n._id],onCommentSelected:o,onCommentEditStart:a,seekOnCurrentVideo:u,location:d}),i.createElement("div",null,i.createElement(nie,{currentVideoTime:t,userCanPostComment:s,maxTime:e,mobileView:l,location:d,replyPost:!0,onPostSuccess:c,seekOnCurrentVideo:u,commentContainerRef:T,inputBoxRef:A,setCommentFromLocalStorage:R,handleSignInToComment:L,setShowSignIn:I}))):i.createElement(Bie,{location:d,comment:n,maxTime:e,replies:b[n._id],onCommentSelected:o,onCommentEditStart:a,seekOnCurrentVideo:u,key:n._id}))):s?i.createElement("div",{className:vre},"No comments yet."):i.createElement("div",{className:Are},!g&&i.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/KVH-comment-bubbles.webp",alt:"comment-bubble"}),i.createElement("div",{className:vre},"No comments yet."," ",i.createElement("span",{className:Cre,onClick:()=>L(!0,JF.EMPTY_COMMENT_PANE),"data-testid":"comments-sign-in-link"},"Sign in")," ","and be the first to say something!"))),l&&i.createElement("div",{className:kre})),i.createElement("div",{className:l&&f?Ire:Sre},i.createElement(nie,{currentVideoTime:t,disabled:n,userCanPostComment:s,maxTime:e,mobileView:l,onPostSuccess:()=>{setTimeout(P,0),null==c||c()},location:d,replyPost:D,seekOnCurrentVideo:u,commentContainerRef:T,inputBoxRef:C,setCommentFromLocalStorage:R,handleSignInToComment:L,setShowSignIn:I})),S&&i.createElement(ZF,{hideSignIn:()=>I(!1),onSuccess:()=>{R()},immediateRedirectPathname:`${x.pathname}?comment=true`}))},qie=({currentVideoRef:e,contentExporting:t,mobileView:a})=>{var o,n,s;const{id:l,commentId:d}=wa(),c=m.exports.useDispatch(),u=sc(tr((e=>e.currentUser))),p=r.exports.useRef(!1),h=r.exports.useRef(!1),[g,y]=r.exports.useState(null==(o=null==e?void 0:e.current)?void 0:o.currentTime);r.exports.useEffect((function(){return p.current=!0,()=>{p.current=!1}}),[]),r.exports.useEffect((function(){function t(e){y(this.currentTime)}if(null==e?void 0:e.current){const a=e.current;return a.addEventListener("timeupdate",t),()=>{a.removeEventListener("timeupdate",t)}}return()=>{}}),[e]);const f=async()=>{if(!l||h.current)return;h.current=!0;const e=await loe(l);p.current&&(c(Mw(e)),h.current=!1)};r.exports.useEffect((function(){f()}),[l,u]),r.exports.useEffect((function(){c(Uw(d))}),[d]);const E=(t,a)=>{var o,n;void 0!==(null==(o=null==e?void 0:e.current)?void 0:o.currentTime)&&void 0!==(null==(n=null==e?void 0:e.current)?void 0:n.duration)&&(e.current.currentTime="number"!=typeof e.current.duration||isNaN(e.current.duration)?t:Math.min(t,e.current.duration),a&&e.current.pause())},v=(null==(n=null==e?void 0:e.current)?void 0:n.duration)||0;return i.createElement(Yie,{maxTime:(null==(s=null==e?void 0:e.current)?void 0:s.duration)||0,currentVideoTime:g,contentExporting:t,userCanPostComment:u,mobileView:a,onCommentSelected:(e,t)=>"number"==typeof t&&E(t),onCommentEditStart:e=>"number"==typeof e&&E(e,!0),onCommentPostSuccess:f,seekOnCurrentVideo:e=>{e<=v&&E(e)},location:mh.Export})},Xie="ProductHuntAnnouncement-module_container_At2vc",Jie="ProductHuntAnnouncement-module_closeContainer_OZxbB",Qie="ProductHuntAnnouncement-module_contentContainer_uqChs",Zie="ProductHuntAnnouncement-module_title_LGphD",ese="ProductHuntAnnouncement-module_icon_U7p-g",tse="ProductHuntAnnouncement-module_context_HuiYS",ase="ProductHuntAnnouncement-module_button_8CR3A",ose="ProductHuntAnnouncement-module_buttonText_DTYHf",nse="ProductHuntAnnouncement-module_buttonIcon_WFJiZ",rse="ProductHuntAnnouncement-module_image_E6t-b",ise=({hideOverlay:e})=>i.createElement("div",{className:Xie},i.createElement("div",{className:Jie},i.createElement(pe,{onClick:e})),i.createElement("div",{className:Zie},i.createElement(Ta,{className:ese})," Your download has started!"),i.createElement("div",{className:Qie},(()=>{const e="https://www.producthunt.com/posts/magic-subtitles";return i.createElement(i.Fragment,null,i.createElement("div",{className:tse},"By the way, we launched ",i.createElement("b",null,"Magic Subtitles")," on Product Hunt!"),i.createElement("div",{className:tse},i.createElement("a",{href:e,target:"_blank",rel:"noreferrer"},i.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/RWR-4k-g0zxE-image.webp",alt:"Magic Subtitles Launch",className:rse}))),i.createElement("div",{className:tse},"If you enjoy using Kapwing, would you please consider supporting us on Product Hunt?"),i.createElement("div",null,i.createElement("a",{href:e,target:"_blank",rel:"noreferrer"},i.createElement("div",{className:ase},i.createElement("span",{className:ose},"Support us on Product Hunt"," "),i.createElement(Pa,{className:nse})))))})())),sse={height:630,width:1200};class lse extends r.exports.Component{constructor(e){super(e),a(this,"_mounted",!1),a(this,"serverProcessedVideoShown",!1),a(this,"sensor",null),a(this,"startedCheckingExportNotif",!1),a(this,"exportCheckCondition"),a(this,"getVideoUserPermissions",(async()=>{const{currentVideo:e={}}=this.props,t=e._id;t&&await NL(t)})),a(this,"getVideoLockStatus",(async()=>{const{currentVideo:e}=this.props,t=null==e?void 0:e._id;if(t)try{(await hu("/api/v1/videos/locked",{params:{id:t}})).locked&&this.setState({locked:!0})}catch(YEe){console.error("Error getting video lock status:",YEe)}})),a(this,"fetchVideo",(async()=>{const{match:e,fetchVideo:t,history:a,showToast:o}=this.props,{numRetries:n}=this.state,r=e.params.id;if(r!==this.state.fetchingVideoId){this.setState({fetchingVideoId:r});try{await t({id:r,preserveId:!0})}catch(i){let e,t=!1;if(i instanceof cu)switch(i.status){case 403:e=i.message,t=!0;break;case 404:e="Content couldn't be found.",t=!0;break;case 410:e="Content has been deleted.",t=!0}t||n>=10?(o({description:e||xu(i).message,type:"error"}),a.push("/")):n<10&&setTimeout((()=>this.setState({numRetries:n+1})),2e3)}finally{this._mounted&&this.setState({fetchingVideoId:void 0})}}})),a(this,"hideOverlay",(()=>{this.setState({overlay:void 0})})),a(this,"showOverlay",(e=>{this.setState({overlay:e})})),a(this,"hideReportIssueModal",(()=>{this.setState({showReportIssueModal:!1})})),a(this,"showReportIssueModal",(e=>{this.setState({showReportIssueModal:!0,showReportIssueSource:e})})),a(this,"onDownload",(()=>{const{currentUser:e}=this.props,t=ld();!function(e){if(!sc(e))return!1;const{accountType:t}=e.user;return t===di.student}(e)&&t.isFree&&Math.floor(11*Math.random())>=6&&this.showOverlay("follow-us-on-twitter")})),a(this,"showLinkModal",(()=>{this.showOverlay("share-link")})),a(this,"showEmbedModal",(()=>{this.showOverlay("share-embed")})),a(this,"showTikTokModal",(()=>{this.showOverlay("share-tik-tok")})),a(this,"setCurrentVideoRef",(e=>{this.setState({currentVideoRef:e})})),a(this,"checkShowExportEmailMessage",(async()=>{var e,t;const a=null==(e=this.props.currentVideo)?void 0:e._id,o=!!(null==(t=this.props.currentUser.user.optOutEmails)?void 0:t.includes(nn.Export));if(this.startedCheckingExportNotif||!sc(this.props.currentUser)||o||!a)return;this.startedCheckingExportNotif=!0;const n=async e=>{const t=(new Date).getTime();if("stop"===this.exportCheckCondition||t-e>18e4)return;let o="lastCheck"!==this.exportCheckCondition;try{const{jobExists:e,userExporter:t}=await hu(`/api/v1/videos/${a}/emailOnExport`);t&&this.setState({showEmailMessage:!0}),(t||e)&&(o=!1)}catch(YEe){console.error("Error while checking show export email message",YEe)}o&&setTimeout((()=>n(e)),5e3)};n((new Date).getTime())})),this.state={numRetries:0,showReportIssueModal:!1,showReportIssueSource:"",currentVideoRef:null,showEmailMessage:!1,locked:!1}}componentDidMount(){const{currentVideo:e={},updateCurrentVideo:t,resetCurrentVideo:a,selectTab:o,location:n}=this.props,r=window.innerWidth<=1024;this.setState({commentsMobileSize:r}),e._id!==this.props.match.params.id&&a(),e&&e.local_url&&(this.setState({fetchingVideoId:void 0,local_url:e.local_url}),t({local_url:e.local_url})),this.getVideoUserPermissions(),this.getVideoLockStatus();(()=>{const{hydratedServerSide:e}=window;return!!e&&(window.hydratedServerSide=!1,!0)})()&&!s.exports.isEmpty(e)||this.fetchVideo(),e._id&&Xf(e),(async e=>{var t,a;const{state:o}=tn(),{workspaces:n}=o,r=e.workspaceId,i=n.allWorkspaces.find((e=>e._id===r));let s,l=null==i?void 0:i.type;try{!i&&r&&(l=await gP(r))}catch(YEe){console.error("Failed to fetch folder type",YEe)}switch(l){case Jr.personal:s="Private";break;case Jr.team:s="Team"}const d={"Is Team Member":Yd(null!=(t=e.teamId)?t:""),"Is Project Owner":Kd(null!=(a=e.creatorId)?a:"")};s&&(d["Project Location"]=s),vc(Bd.ACCESS_FINAL_VIDEO_PAGE,d)})(e),this._mounted=!0,this.sensor=new wt.ResizeSensor(document.body,(()=>{this.setState({commentsMobileSize:window.innerWidth<=1024})}));const i=new URLSearchParams(n.search);(this.props.match.params.commentId||"true"===i.get(h9.COMMENT))&&o({tabId:"Comments",tabContainerId:UR})}componentDidUpdate(e,t){var a,o;const{match:n,currentVideo:r={},userPermissions:i}=this.props,{numRetries:s,local_url:l}=this.state,{numRetries:d}=t;r._id===n.params.id&&d===s||(this.fetchVideo(),this.getVideoLockStatus()),r._id&&!(null==(a=e.currentVideo)?void 0:a._id)&&Xf(r),0===Object.keys(i).length&&this.getVideoUserPermissions(),r.local_url&&r.local_url!==l&&(this.setState({local_url:r.local_url}),this.serverProcessedVideoShown=!1),!r.done&&(null==(o=e.currentVideo)?void 0:o.done)&&(this.serverProcessedVideoShown=!1),this.state.commentsMobileSize&&!t.commentsMobileSize&&this.props.match.params.commentId&&VR({tabId:"Comments",tabContainerId:UR})}componentWillUnmount(){var e;const{resetState:t}=this.props;t(),null==(e=this.sensor)||e.detach(),this._mounted=!1}getGifDimensions(){const{adjusted_height:e,adjusted_width:t,height:a,width:o}=this.props.currentVideo||{};let n=a||e||1,r=o||t||1;return r>=n?(n=200*n/r,r=200):(r=200*r/n,n=200),[n,r]}getVideoDimensions(){const{adjusted_height:e,adjusted_width:t,height:a,width:o}=this.props.currentVideo||{},n=a||e||1,r=o||t||1;let i=Math.min(Math.max(1280,n),1920),s=Math.min(Math.max(1280,r),1920);return s>=i?i=s*n/r:s=i*r/n,[i,s]}getHelmetDimensions(e){const{privacy:t}=this.props.currentVideo||{};if(t)return sse;const[a,o]="gif"===e?this.getGifDimensions():this.getVideoDimensions();return{height:a,width:o}}getUrl(){let{hostDomain:e}=this.props;const{currentVideo:t={}}=this.props,{_id:a}=t;return e||(e=document&&document.domain),`https://${e}/videos/${a}`}getImageUrl(){const{currentVideo:e={}}=this.props,{privacy:t}=e;return t?"https://cdn-useast1.kapwing.com/static/jQ9-og-image-(1).webp":tT(e,"image_url")}getVideoUrl(e){const{currentVideo:t}=this.props,{privacy:a,video_url:o}=t||{};if("image"!==e&&!a)return"gif"===e&&o?o:tT(t,"fullPath")}getImageTags({height:e,width:t}){const a=this.getImageUrl();return[i.createElement("meta",{key:"ogImage",property:"og:image",content:a}),i.createElement("meta",{key:"ogImageHeight",property:"og:image:height",content:e}),i.createElement("meta",{key:"ogImageSecureUrl",property:"og:image:secure_url",content:a}),i.createElement("meta",{key:"ogImageUrl",property:"og:image:url",content:a}),i.createElement("meta",{key:"ogImageWidth",property:"og:image:width",content:t}),i.createElement("meta",{key:"twitterImage",property:"twitter:image",content:a})]}getVideoTags({content:e="video/mp4",height:t,outputType:a,width:o}){const n=this.getVideoUrl(a);return n?[i.createElement("meta",{key:"ogType",property:"og:type",content:"video"}),i.createElement("meta",{key:"ogVideo",property:"og:video",content:n}),i.createElement("meta",{key:"ogVideoHeight",property:"og:video:height",content:t}),i.createElement("meta",{key:"ogVideoSecureUrl",property:"og:video:secure_url",content:n}),i.createElement("meta",{key:"ogVideoType",property:"og:video:type",content:e}),i.createElement("meta",{key:"ogVideoWidth",property:"og:video:width",content:o})]:null}showingVideoProgress(e,t){const{convertOption:a,currentVideo:o={},ffmpegReducer:n}=e,{done:r}=o,{fetchingVideoId:i,local_url:s}=t;return!(s||r||this.serverProcessedVideoShown||"FULFILLED"===n.ffmpegStatus&&void 0!==n.outputFileUrl&&"mp4"===a||i)}renderHelmet(){const{currentVideo:e={},facebookAppId:t,projectName:a}=this.props,{fullPath:o}=e,n=zd(o),{height:r,width:s}=this.getHelmetDimensions(n),l=e=>{const t=e.toLowerCase();return t.charAt(0).toUpperCase()+t.slice(1)};let d=`${l(n)} — Kapwing`;a&&(d=`${a} — Kapwing`);const c=`${l(n)} made on Kapwing`;return i.createElement(rt,null,i.createElement("title",null,d),i.createElement("meta",{name:"description",content:c}),i.createElement("meta",{property:"fb:app_id",content:t}),i.createElement("meta",{property:"og:description",content:c}),i.createElement("meta",{property:"og:title",content:a}),i.createElement("meta",{property:"og:url",content:this.getUrl()}),i.createElement("meta",{name:"robots",content:"noindex, nofollow"}),this.getImageTags({height:r,width:s}),this.getVideoTags({height:r,outputType:n,width:s}))}renderFinalVideo(e){const{currentVideo:t={}}=this.props;return i.createElement(hne,{autoPlay:!1,setCurrentVideoRef:this.setCurrentVideoRef,currentVideo:t,local_url:e})}renderVideoProgress(){const{currentUser:e,currentVideo:t,currentFolderId:a,thumbnailUrl:o}=this.props;return i.createElement(Hne,{currentUser:e,currentVideo:t||{},currentFolderId:a,hideReportIssueModal:this.hideReportIssueModal,showReportIssueModal:()=>this.showReportIssueModal("progress"),thumbnailUrl:o,onFinishedVideo:()=>{if(!e.user.muteExportCompleteNotificationSound){new Audio("/export-notification-chime.mp3").play()}this.exportCheckCondition="stop"},onFirstProgressLoad:()=>{this.exportCheckCondition="lastCheck"}})}renderBody(){const{convertOption:e,currentVideo:t={},ffmpegReducer:a,currentUser:o,canWrite:n}=this.props,{done:r}=t,{fetchingVideoId:s,local_url:l,currentVideoRef:d,commentsMobileSize:c=!1,showEmailMessage:u}=this.state,m=ld(),p=void 0===n;let h,g=!1,y=!1;const f=t.creatorId===o.user._id,E=i.createElement("div",{className:Oae.loadingWrapper},i.createElement(CO,{text:"Loading content...",textStyles:{color:"#eee",fontWeight:600}}));l?(h=this.renderFinalVideo(l),g=!0):r||this.serverProcessedVideoShown?(h=this.renderFinalVideo(l),this.serverProcessedVideoShown=!0,g=!0):"FULFILLED"===a.ffmpegStatus&&void 0!==a.outputFileUrl&&"mp4"===e?(h=this.renderFinalVideo(a.outputFileUrl),g=!0):s?(h=E,y=!0):h=this.renderVideoProgress();let v=null,w=!1;return t._id&&!t.creatorId?v=i.createElement(Foe,{hideOverlay:this.hideOverlay,local_url:l,onDownload:this.onDownload,showEmbedModal:this.showEmbedModal,showLinkModal:this.showLinkModal,showReportIssueModal:()=>this.showReportIssueModal("options"),showTikTokModal:this.showTikTokModal}):p?v=i.createElement("div",{className:Oae.commentsContainerWrapper},i.createElement("div",{className:jae})):c?v=i.createElement("div",null,f?i.createElement(F5,{cyPrefix:UR,id:UR,tabTitles:["Actions","Comments"],mobileCommentsView:!0},i.createElement(Foe,{hideOverlay:this.hideOverlay,local_url:l,onDownload:this.onDownload,showEmbedModal:this.showEmbedModal,showLinkModal:this.showLinkModal,showReportIssueModal:()=>this.showReportIssueModal("options"),showTikTokModal:this.showTikTokModal,mobileCommentsView:!0}),i.createElement(qie,{currentVideoRef:d,contentExporting:!g,mobileView:!0})):i.createElement(F5,{cyPrefix:UR,id:UR,tabTitles:["Comments","Actions"],mobileCommentsView:!0},i.createElement(qie,{currentVideoRef:d,contentExporting:!g,mobileView:!0}),i.createElement(Foe,{hideOverlay:this.hideOverlay,local_url:l,onDownload:this.onDownload,showEmbedModal:this.showEmbedModal,showLinkModal:this.showLinkModal,showReportIssueModal:()=>this.showReportIssueModal("options"),showTikTokModal:this.showTikTokModal,mobileCommentsView:!0}))):(w=!y,v=i.createElement("div",{className:Oae.commentsContainerWrapper},i.createElement("div",{className:Oae.commentsSharingWrapper},i.createElement(f9,null),i.createElement(S9,{className:Oae.upsellBlock}),i.createElement(Coe,{showEmbedModal:this.showEmbedModal,showTikTokModal:this.showTikTokModal,inCommentView:!0})),i.createElement(qie,{currentVideoRef:d,contentExporting:!g}),dc(o)?i.createElement("div",{className:Oae.adminSectionWrapper},i.createElement(c5,{commentingView:!0})):null)),i.createElement("div",{className:Oae.finalVideoContainer},i.createElement("div",{className:Oae.finalVideoPreviewContainer},w&&i.createElement("div",{className:Oae.topEditButtonContainer},i.createElement(hoe,{local_url:l,onDownload:this.onDownload,commentingView:!0})),i.createElement("div",{className:Oae.commentsFinalVideoContainer},i.createElement("div",{className:w?Oae.commentingVideoContainerContent:Oae.videoContainerContent},h)),u&&this.showingVideoProgress(this.props,this.state)&&this.renderEmailMessage(),w&&i.createElement("div",{className:Oae.privacyAndSocialWrapper},i.createElement("div",null,t._id&&t.fullPath&&i.createElement(Dae,{videoId:t._id,downloadUrl:t.fullPath,privacy:t.privacy,userHasAccess:!!t.workspaceId&&nP(t.workspaceId),inVideoContainer:!0})),i.createElement("div",{className:`${Xae} ${Oae.socialDescription}`},"Tag ",i.createElement("strong",null,"#kapwing")," so we can find you on social media!"," ",m.isPaid&&i.createElement("span",null,"Any issues?"," ",i.createElement("button",{type:"button",className:Jae,onClick:()=>this.showReportIssueModal("options")},"Report a problem")," ","and let us know.")))),v)}renderOverlay(){let e;switch(this.state.overlay){case"share-embed":e=i.createElement(Qoe,{hideOverlay:this.hideOverlay});break;case"share-link":e=i.createElement(dne,{hideOverlay:this.hideOverlay});break;case"share-tik-tok":e=i.createElement(rre,{hideOverlay:this.hideOverlay});break;case"follow-us-on-twitter":e=i.createElement(hre,{hideOverlay:this.hideOverlay});break;case"product-hunt-announcement":e=i.createElement(ise,{hideOverlay:this.hideOverlay});break;default:return null}return i.createElement("div",{className:Oae.overlay},i.createElement("div",{className:Oae.overlayBackground,onClick:this.hideOverlay}),e)}renderEmailMessage(){return i.createElement("div",{className:Oae.emailMessageContainer},i.createElement("div",{className:Oae.emailMessageDiv},i.createElement("p",null,i.createElement("b",null,"Taking too long? You can close this page.")),i.createElement("p",null,"We will send you an email with a download link when your project is ready.")))}renderLocked(){const{locked:e}=this.state;if(!e)return null;const t={action:Rs.STORAGE_LIMIT,closeable:!1};return i.createElement(WU,{...t})}render(){const{match:e}=this.props,{showReportIssueModal:t,showReportIssueSource:a}=this.state,o="progress"===a;return i.createElement("div",null,this.renderHelmet(),i.createElement(Iae,null),this.renderBody(),this.renderLocked(),i.createElement(DJ,null),this.renderOverlay(),t&&i.createElement(Jne,{hide:()=>this.hideReportIssueModal(),videoId:e.params.id,fromVideoProgress:o}))}}const dse=we(m.exports.connect(((e,t)=>{const{match:a}=t,{id:o}=a.params,n=e.currentVideo._id&&e.currentVideo._id===o,r=e.studio._id&&e.studio._id===o;let i;return n?i=e.currentVideo:r&&(i=e.studio),{currentUser:e.currentUser,currentVideo:i,currentFolderId:e.workspaces.selectedWorkspace,facebookAppId:e.config.FACEBOOK_APP_ID,projectName:e.projectName,editorPath:e.editorPath,projectId:null==i?void 0:i.projectId,ffmpegReducer:e.ffmpegReducer,convertOption:e.convertOption,thumbnailUrl:e.studio.image_url,surveyEligible:r,canWrite:e.userPermissions.canWrite,userPermissions:e.userPermissions}}),(e=>me({fetchVideo:wR,updateCurrentVideo:dR,resetState:PR,resetCurrentVideo:mR,selectTab:VR,showToast:Su},e)))(lse)),cse="DeleteDialog-module_deleteDialogBackground_KjRMs",use="DeleteDialog-module_deleteButton_--UFm",mse="DeleteDialog-module_override_8SR2y",pse="DeleteDialog-module_deleteDialogContainer_ErvIj",hse="DeleteDialog-module_dark_WXXot",gse="DeleteDialog-module_header_Ex1yj",yse="DeleteDialog-module_description_l93jw",fse="DeleteDialog-module_deleteCloseContainer_S3Gqz",Ese="DeleteDialog-module_buttonsContainer_oBRrT",vse=({hideDelete:e,delete:t,headerTitle:a,description:o,theme:n="light",confirmButtonText:s="Delete"})=>{const[l,d]=r.exports.useState(!1),c=()=>{d(!0),t(),e()},u=()=>i.createElement(i.Fragment,null,i.createElement("div",{className:cse,onClick:e}),i.createElement("div",{className:`${pse} ${"dark"===n?hse:""}`},i.createElement("div",{className:fse,onClick:e},i.createElement(pe,null)),i.createElement("div",{className:gse},a),i.createElement("div",{className:yse},o),i.createElement("div",{className:Ese},i.createElement(iO,{cancelFn:e,confirmFn:c,confirmText:s,cancelText:"Cancel",loadingMsg:l?"Deleting...":void 0,confirmButtonClassName:`${use} ${mse}`})))),m=document.querySelector(".app-container");return m?he.createPortal(u(),m):u()},wse=(e,{plural:t=!1,extraText:a=""}={})=>`Are you sure you want to delete ${t?"these":"this"} ${e}? ${a}`,bse=we((({hideDelete:e,delete:t,multiple:a=!1})=>{const o={extraText:"You will not be able to edit or download a project after it has been deleted."},n=a?wse("projects",{...o,plural:!0}):wse("project",{...o});return i.createElement(vse,{hideDelete:e,delete:t,headerTitle:a?"Delete Projects":"Delete Project",description:n})})),_se="Snapshots-module_actionButton_lPAz7",Tse="Snapshots-module_actionIcon_Yg5zF",Sse="Snapshots-module_actions_jRx9w",Ise="Snapshots-module_background_LweQL",xse="Snapshots-module_snapshotTile_VEGp6",kse="Snapshots-module_mediaContainer_sLXJV",Cse=we((({match:e,snapshot:t,history:a,showDelete:o,projectId:n})=>{const r=zte(),s=e.params.id,l=tT(t,"fullPath"),d={maxWidth:300,maxHeight:300},c=t.created_on||"unknown",u=t.content.scenes.length,m=t.content.scenes.reduce(((e,t)=>e+t.layers.length),0),p=1===u?"scene":"scenes",h=1===m?"layer":"layers";return i.createElement("div",{className:xse},i.createElement("div",{className:kse},(()=>{var e,a;if(null==(a=null==(e=t.content)?void 0:e.fullPath)?void 0:a.endsWith("mp4"))return i.createElement("video",{src:l,style:d,controls:!0,playsInline:!0,preload:"auto"});const{image_url:o}=t.content;return o?i.createElement("img",{src:o,style:d,alt:""}):i.createElement(Ra,{size:300})})()),i.createElement("div",{className:Sse},i.createElement("div",null,"Snapshot Type: ",t.snapshot_type),i.createElement("div",null,"Version Number: ",t.version_number),i.createElement("div",null,"Exported: ",t.export.toString()),"Created on ",c,i.createElement("div",null,u," ",p," / ",m," ",h),i.createElement("div",{onClick:async()=>{const{copiedProject:e}=await r(t.id,n,{entryPoint:Kte.ADMIN_DEBUG_PAGE});e&&a.push(`/${e.videoId}/studio/editor`)}},i.createElement("button",{type:"button",className:_se},i.createElement(sa,{className:Tse}),"Fork")),i.createElement("div",{onClick:async()=>{a.push(`/videos/${s}/snapshots/${t.id}/debug`)}},i.createElement("button",{type:"button",className:_se},i.createElement(sa,{className:Tse}),"View Debug Page")),i.createElement("div",{onClick:()=>o(t.id)},i.createElement("button",{type:"button",className:_se},i.createElement(sa,{className:Tse}),"Delete"))))})),Ase=we((e=>{var t,a;const{match:o}=e,n=o.params.id,[s,l]=r.exports.useState(!0),[d,c]=r.exports.useState(null),[u,m]=r.exports.useState([]),[p,h]=r.exports.useState(""),[g,y]=r.exports.useState(!1),f=e=>{h(e),y(!0)},E=()=>{h(""),y(!1)};r.exports.useEffect((()=>{n$(n).then((e=>m(e.reverse()))).catch((e=>{console.error(e),c(e)})).finally((()=>l(!1)))}),[]);const v=null==(a=null==(t=u.find((e=>{var t;return null==(t=e.content)?void 0:t.projectId})))?void 0:t.content)?void 0:a.projectId;return i.createElement("div",{className:Ise},i.createElement("h1",null,"Snapshots"),s&&i.createElement("div",null,"Loading snapshots..."),!s&&0===u.length&&i.createElement("div",null,"No snapshots found"),d&&i.createElement("div",null,"Error: ",JSON.stringify(d)),u.map(((e,t)=>i.createElement(Cse,{projectId:v,snapshot:e,showDelete:f,key:t}))),g&&i.createElement(bse,{hideDelete:E,delete:async()=>{await async function(e,t){try{return await pu(`/api/v1/snapshots/${e}/${t}`)}catch(YEe){throw console.error(YEe),YEe}}(n,p);const e=await n$(n);m(e.reverse()),E()}}))}));function Nse(e){return{type:"SET_CONFIG",config:e}}const Pse={home:"PasteLink-module_home_UPQqz",homeHowBackgroundWhite:"PasteLink-module_homeHowBackgroundWhite_5KQ96",largeButton:"PasteLink-module_largeButton_EFzOG",sectionContent:"PasteLink-module_sectionContent_PuecO",sectionHeader:"PasteLink-module_sectionHeader_Suz0S",spacer:"PasteLink-module_spacer_RJx0R",chevron:"PasteLink-module_chevron_zD5mb",splashText:"PasteLink-module_splashText_28pjN",splashSubtext:"PasteLink-module_splashSubtext_4U6pJ",aboutSection:"PasteLink-module_aboutSection_l5Fsp",mobile:"PasteLink-module_mobile_FzSNu",desktop:"PasteLink-module_desktop_2QKES",screenReaderOnlyLabel:"PasteLink-module_screenReaderOnlyLabel_-hb1P",disabled:"PasteLink-module_disabled_HUr0n",noScrollBar:"PasteLink-module_noScrollBar_O-EfO",textOverflowEllipsis:"PasteLink-module_textOverflowEllipsis_308O8",genericButtonBlue:"PasteLink-module_genericButtonBlue_MefRJ",container:"PasteLink-module_container_RIHGR",input:"PasteLink-module_input_fU4WY",lightInput:"PasteLink-module_lightInput_-EZBn",newTimelineInputMobile:"PasteLink-module_newTimelineInputMobile_IF4aK",oneOffContainer:"PasteLink-module_oneOffContainer_1m1sV",newTimelineInputDesktop:"PasteLink-module_newTimelineInputDesktop_qDA14"},Rse=new Set(["https://www.youtube.com/watch?app=desktop","https://www.png","https://www.youtube.com","https://www.youtube.com/","https://www.youtube.com/watch?reload=9","https://www.google.com/url?sa=t",""]),Lse=/^https:\/\/www.kapwing.com\/videos.*/;class Dse extends r.exports.Component{constructor(e){super(e),a(this,"handleChange",(async e=>{var t;const{audiogramUpload:a,disallowVideo:o,handleFinish:n,projectName:r,setProgressText:i,setProjectName:s,stopUpload:l,videoId:d,audiogramUploadStart:c,isMediaLibraryUpload:u,analyticsUploadSource:m}=this.props;let p=e.target.value,h={didError:!1,stage:dh.PreExtractValidation,pastedUrl:p,uploadSource:m,isMediaLibraryUpload:u};if(!QJ(p)){const e=`${p} is not a valid URL`;return void this.logPastedLinkUploadFinish(h,e)}if(p.includes("www.kapwing.com")&&!Lse.test(p)){const e=`${p} is not a valid URL. Try a link to a specific video instead such as https://www.kapwing.com/videos/63503f4177ecc9008b7011a3`;return void this.logPastedLinkUploadFinish(h,e)}if(Rse.has(p)){const e=`${p} is not a valid URL. Try a link to a specific video instead such as https://www.youtube.com/shorts/EwAsLiM3vgs`;return void this.logPastedLinkUploadFinish(h,e)}if(oF(p)){const e="MPD files are not currently supported. Please try a different file format.";return void this.logPastedLinkUploadFinish({...h,fileType:"mpd"},e)}p.includes("instagram.com/reel/")&&(p=p.replace("/reel/","/p/")),(p.includes("youtu.be/")||p.includes("youtube.com/"))&&(p=this.cleanUpYoutubeUrl(p));let g=p.substring(0,Math.min(50,p.length));p.length>50&&(g+=" ..."),i(`Fetching ${g} ...`),a&&(null==c||c()),r&&""!==r||s("Studio Draft");const y=e=>{h={...h,...e}};try{h.stage=dh.Extraction;const e=tn().state.studioLocal.localProjectId,{asset:r,cmlFile:s,extractInfo:l}=await ZJ({acceptAudio:!o||a||!1,acceptVideo:!o,additionalAssetParams:{video_id:d},progressCallback:i,analyticsCallback:y,url:p,doDuplicateHandling:!0});h.stage=dh.LayerCreation;const c=await(async(e,t,a,o,n,r)=>{const i=await hF(n.url,{name:n.url,type:n.mime}),s=null==i?void 0:i.type;if(!s)throw Error("Could not identify media type");const l=(null==o?void 0:o.duplicate)||n.hasUploadedAssetDuplicate?"upload":"pastedLink",d={...YH(),name:zH(),asset_id:a._id,conversion_id:a.conversion_id||n.conversion_id,mime:n.mime,pastedUrl:e,requireConversion:n.requireConversion,conversion_type:n.conversion_type,soundUrl:n.soundUrl,source:l,url:n.url,objectFit:"cover",isMediaLibraryUpload:r,...i,type:s};return Rr(d),o&&(d.cmlFileId=o.id),r||bc(d.type,"paste link"),n.thumbnailUrl&&(d.thumbnailUrl=n.thumbnailUrl),d})(p,0,r,s,l,!!u);c.requireConversion&&c.conversion_type&&c.conversion_type.includes("gif-to")&&(c.type=ln.Video),(null==(t=c.url)?void 0:t.includes("googlevideo.com/video"))&&(c.assetSource="Youtube");const m=tn().state.studioLocal.localProjectId;if(m!==e)return;h.stage=dh.HandleFinish,n(c,{singleFileUpload:!0}),i(""),h.stage=dh.Finish;const g=!!(null==s?void 0:s.duplicate);vc("Add from Pasted Link",{...h,isDuplicate:g})}catch(f){console.error(f);const e=f instanceof cu&&422===f.status;e||(h.didError=!0),h.errorMessage=xu(f).message;const t=e?"Sorry, we don't support that URL, please try a different one":`Sorry, that pasted URL (${g}) didn't work. ${h.errorMessage}`;this.logPastedLinkUploadFinish(h,t),l()}})),a(this,"cleanUpYoutubeUrl",(e=>{let t=e;if((t.includes("/shorts/")||t.includes("/live/"))&&(t=this.convertYtLinkToWatchLink(t)),t.includes("/youtu.be/")){const e=t.split("/")[3];return e?`https://www.youtube.com/watch?v=${e.split("?")[0]}`:t}return t.includes("app=")&&(t=`${t.split("app=")[0]}${t.split("&")[1]}`),t.split("&")[0]})),a(this,"logPastedLinkUploadFinish",((e,t)=>{const{showToast:a}=this.props;t&&a({description:t,type:"error"}),vc("Add from Pasted Link",{...e})})),a(this,"renderPlaceholder",(()=>{const{audioUpload:e}=this.props;return e?"Paste an audio or video URL (e.g. https://www.youtube.com/watch?v=C0DPdy98e4c)":"Paste an image or video URL (e.g. https://www.youtube.com/watch?v=C0DPdy98e4c)"})),a(this,"renderShortPlaceholder",(()=>{const{audioUpload:e}=this.props;return e?"Paste audio or video URL":"Paste image or video URL"})),this.state={pastedLink:""}}convertYtLinkToWatchLink(e){const t=e.split("/shorts/")[1]||e.split("/live/")[1];return`https://www.youtube.com/watch?v=${null==t?void 0:t.split("?")[0]}`}render(){const{pastedLink:e}=this.state,{classNames:t,isTimeline:a,lightTheme:o}=this.props,n=`upload-link-input-${y()}`,r=[Pse.input];t&&r.push(t),o&&r.push(Pse.lightInput);const s={className:r.join(" "),type:"url",value:e,onChange:this.handleChange},l={...s,placeholder:this.renderPlaceholder(),className:[...r,Pse.newTimelineInputDesktop].join(" ")},d={...s,placeholder:this.renderShortPlaceholder(),className:[...r,Pse.newTimelineInputMobile].join(" ")};return i.createElement("div",{className:Pse.container},a?i.createElement(i.Fragment,null,i.createElement("input",{...l,"data-cy":"pasted-link-input"}),i.createElement("input",{...d,"data-cy":"pasted-link-input"})):i.createElement("label",{htmlFor:n},i.createElement("span",{className:Pse.screenReaderOnlyLabel},"Paste a URL"),i.createElement("input",{placeholder:this.renderPlaceholder(),id:n,...s,"data-cy":"pasted-link-input"})))}}const Ose=m.exports.connect((e=>({videoId:e.studio._id,projectName:e.projectName,currentUser:e.currentUser})),(e=>me({setProjectName:JP,setSnapInTimelineBasedOnLandingPage:nw,showToast:Su},e)))(Dse),Fse="FolderUpload-module_uploadDialogBackground_JOaNN",Mse="FolderUpload-module_uploadDialogContainer_aedxy",Use="FolderUpload-module_uploadCloseDialog_y2-kO",Bse="FolderUpload-module_uploadTypesContainer_nAoHO",Wse="FolderUpload-module_header_g7S4H",Vse="FolderUpload-module_dragHeader_n6bFw",jse="FolderUpload-module_or_D7tWX",Gse="FolderUpload-module_uploading_uFE9x",Hse="FolderUpload-module_loadingText_IhzrO",zse="FolderUpload-module_darkText_hkfw5",$se="Upload-module_screenReaderOnlyLabel_baMDH",Kse="Upload-module_uploadContainer_MYAJF",Yse="Upload-module_uploadTextContainer_kXzce",qse="Upload-module_uploadText_stEqd",Xse="Upload-module_uploadButton_NxLkR",Jse="Upload-module_uploadLabel_yZj96",Qse="Upload-module_uploadLabelHeader_e0noq",Zse="Upload-module_uploadLabelSubheader_m-oZq",ele="Upload-module_uploadIcon_wjPHn",tle=({handleMultiFileUpload:e,multiple:t,acceptedFileTypes:a,uploadText:o="Click to Upload",uploadSubtext:n="or, drag and drop a file here"})=>{const r=`upload-button-input-${y()}`;return i.createElement("div",{className:Kse},i.createElement("label",{htmlFor:r,className:Jse},i.createElement("span",{className:$se},o),i.createElement("input",{"data-cy":"upload-input","data-testid":"upload-input",id:r,className:Xse,accept:a,onChange:t=>{var a;return e(null==(a=null==t?void 0:t.target)?void 0:a.files)},type:"file",multiple:t}),i.createElement("div",{className:Yse},i.createElement("div",{className:qse},i.createElement("div",{className:Qse},o,i.createElement(La,{className:ele})),i.createElement("div",{className:Zse},n)))))},ale=e=>{const{hideDialog:t,handleMultiFileUpload:a,startUpload:o,stopUpload:n,handlePasteLinkFinish:s,returnAccepts:l,hidePasteLink:d=!1,headerText:c="Upload an image or video"}=e,[u,m]=r.exports.useState(""),p=tr((e=>e.theme.darkMode));return i.createElement(i.Fragment,null,i.createElement("div",{className:Fse,onClick:t}),i.createElement("div",{className:Mse,"data-cy":"workspace-overlay"},i.createElement("div",{className:Use,onClick:t},i.createElement(pe,null)),i.createElement("div",{className:Wse},c),u?i.createElement("div",{className:Gse},i.createElement(CO,{text:u}),i.createElement("div",{className:Hse},"Closing this dialog will not interrupt your upload")):i.createElement("div",{className:Bse},i.createElement(tle,{returnAccepts:l,multiple:!0,handleMultiFileUpload:a}),!d&&i.createElement(i.Fragment,null,i.createElement("div",{className:jse}," "),i.createElement(Ose,{startUpload:o,stopUpload:n,setProgressText:m,handleFinish:s,lightTheme:!p,workspaceUpload:!0})))))};we(ale);const ole=e=>new Promise((t=>setTimeout((()=>t()),e))),nle=m.exports.connect((e=>{var t;const a=nd(e);return{currentUser:e.currentUser,showUploadDialog:e.workspaces.showUploadDialog,showDragUploadDialog:e.workspaces.showDragUploadDialog,privacy:(null==(t=null==a?void 0:a.settings)?void 0:t.defaultPrivacy)||ii.unlisted,currentFolderId:e.workspaces.selectedWorkspace,workspaceUploadFiles:e.workspaces.workspaceUploadFiles,selectedTeamId:e.teams.selectedTeamId,currentTeam:a}}),(e=>me({hideUploadDialog:xv,hideDragUploadDialog:Cv,createFolderUploadVideo:B4,setWorkspaceUploadStatus:Av,addWorkspaceUploadFile:Nv,setWorkspaceFileUploadProgress:Pv,clearWorkspaceUploadFiles:Lv,addWorkspaceUploadProject:Rv,updateWorkspaceUploadFile:Fv,removeWorkspaceUploadFile:Dv,markUploadAsCreated:Mv,setProjectName:JP,showToast:Su},e)))((e=>{const{showUploadDialog:t,hideUploadDialog:a,showDragUploadDialog:o,hideDragUploadDialog:n,showToast:s,privacy:l,currentUser:d,currentFolderId:c,createFolderUploadVideo:u,setWorkspaceUploadStatus:m,addWorkspaceUploadFile:p,setWorkspaceFileUploadProgress:h,clearWorkspaceUploadFiles:g,addWorkspaceUploadProject:f,workspaceUploadFiles:E,updateWorkspaceUploadFile:v,removeWorkspaceUploadFile:w,markUploadAsCreated:b,setProjectName:_,selectedTeamId:T}=e,S=XD(Ps.UNLIMITED_EXPORT_DURATION_LIMIT),I=r.exports.useCallback((async e=>{if(b(e.id),e.conversion_id){let t=!1;for(;!t;){await ole(5e3);const a=await d$(e.conversion_id);a.status!==Zi.failed&&a.status!==Zi.completed||(t=!0,Object.assign(e,{asset_id:a.asset_id,bucket:Or,created:a.created,modified:a.modified,source:"upload",uploadedAt:new Date,url:a.output_url}))}const a=await hF(e.url,e);a&&Object.assign(e,a)}const t=await u({currentUser:d,newLayer:e,teamId:T}),a={_id:t._id,isStudio:!0,name:t.projectName,submittedAt:t.submittedAt,draft:!1,done:!1,duration:t.duration,pendingWorkspaceUpload:!0,workspaceId:t.workspaceId};f(a),h(e.id,"uploaded")}),[f,u,d,b,h,T]);r.exports.useEffect((()=>{g()}),[g]),r.exports.useEffect((()=>{Object.keys(E).forEach((e=>{const t=E[e];t&&t.asset_id&&!t.uploadCancelled&&!t.startedVideoCreation&&"100%"===t.uploadProgress&&I(t)}))}),[I,E]);const x=()=>"image/*,video/mp4,video/webm,video/*,video/3gpp,video/avi,video/x-flv,.mkv,video/x-ms-wmv",k=e=>{"upload"===e&&(a(),n()),m("started")},C=()=>{a()},A=async e=>{const t=aF(e);if(t){if(nF(t)||rF(t)||TF(t)){if((e.size||0)>6442450944)throw vc("Rejected Upload",{Origin:"Workspace","File Size":e.size}),new Error("Your content must be under 6GB.");return e.id=y(),e}throw vc("Rejected Upload",{Origin:"Workspace","File Type":t}),new Error("Your file format is not currently supported. Currently we only support .gif, .jpg, .png, .mp4, .mov, .webm, avi, flv, wmv, mkv, .ogg, .mpeg formats.")}throw vc("Rejected Upload",{Origin:"Workspace"}),new Error("Your upload has an invalid type. Please choose a video or image to upload, and make sure your file has a correct extension.")},N=async(e,t)=>{var a;let o,n={source:"workspaceUpload",projectName:t};const r=await bF(e,e);return r?(o={...e},n={...n,...e,type:"image"===(null==(a=e.mime)?void 0:a.split("/")[0])?"image":"video",width:400,height:400,position:{x:"0%",y:"0%",width:"100%",height:"100%",rotation:0}},r&&"image/gif"===e.mime&&(n.type="video",n.mime=Rl()?"video/quicktime":"video/webm",n.isTrimmed=!1)):(o=await hF(e.url||"",e),n={...n,...e,...o,objectFit:"cover",position:{x:"0%",y:"0%",width:"100%",height:"100%",rotation:0}}),{newLayer:n,mediaInfo:o}},P=(e,t={},a="")=>{let o=e;e||(o="An error occurred while uploading. Please try again later."),s({description:o,type:"error"}),Uv(t.id),w(t.id)},R=(e,t,a,o,n=0)=>{n<=5?0===e||503===e?U(t,a,o,n+1):D(t,a,o,{},n+1):P("An error occurred during upload. Please try again later.",o,"onUploadError")},L=async(e,t,a)=>{if(200!==e.status)return void P(e.statusText||"An error occurred during upload. Please try again.",a,"onUploadFinish");m("finished");const[o,n]=Yz(t),r={blob_name:n,bucket:o||Or,name:n,size:a.size,mime:a.type},i={read_uri:t};l||(i.skipSigning=!0);const{asset:s,cmlFile:d}=await UG(r,i);HH(s,d);const u=tF(a.url,a.type),p=await qH(a,{});let h;await bF(a,p)&&(h=await l$({asset_id:s._id,resource:r.name,type:"blob",conversion_type:u}));const g={...r,asset_id:s._id,source:"workspaceUpload",url:t,workspaceId:c,conversion_id:h};s.ffprobeData&&(g.ffprobeData=s.ffprobeData),a.id&&(g.id=a.id),a.type.includes("video")&&(g.duration=a.duration);const y=NF(a.name||"");_(y);const{newLayer:f}=await N(g,y);v(g.id,f)},D=async(e,t,a,o={},n=0)=>{const r=new XMLHttpRequest;r.open("PUT",e,!0),r.onerror=o=>{o&&console.error("upload error",o||null),R(r.status,e,t,a,n)},r.onload=async()=>{L(r,t,a)},r.upload.onprogress=e=>((e,t)=>{if(e.lengthComputable){const a=`${Math.round(e.loaded/e.total*100).toString()}%`;h(t.id,a)}})(e,a),r.setRequestHeader("Content-Type",a.type);for(const[i,s]of Object.entries(o))r.setRequestHeader(i,s);r.send(a)},O=e=>{const t={name:e.name,id:e.id||"",workspaceId:c,uploadProgress:"0%"};p(t),(async e=>{const t=l===ii.private,a=await vE({files:[{file:e}],isPrivate:t}),{read_uri:o,upload_uri:n}=a.uris[0];D(n,o,e)})(e)},F=async t=>{const o=await ZO(t,void 0,P);try{o.local_url=URL.createObjectURL(o);"video"===o.type.split("/")[0]?(t=>{const{currentTeam:a}=e,o=document.createElement("video");o.src=t.local_url||"",o.onerror=()=>{O(t)},o.onloadedmetadata=()=>{var e,n;if(t.duration=o.duration,!a)throw new Error("Error during file upload, no team found.");const r=(null!=(n=null==(e=a.limits)?void 0:e.cumulativeExportDuration)?n:0)+t.duration;return!S&&r>10800?(s({description:"You've reached your publishing limit of 3 hours of video this month. Upgrade to publish unlimited videos.",type:"error"}),vc("Paywalled Upload",{"Paywall Type":"Total Video Duration Limit",Origin:"Workspace"}),void w(t.id)):!S&&t.duration>420?(vc("Rejected Upload",{Origin:"Workspace","File Duration":t.duration,"Workspace Type":S?"Pro":"Basic"}),s({description:"Upgrade your workspace to upload files over 7 minutes (up to 2 hour) long.",type:"error"}),void w(t.id)):t.duration>7200?(vc("Rejected Upload",{Origin:"Workspace","File Duration":t.duration,"Workspace Type":S?"Pro":"Basic"}),s({description:"Your content must be under 2 hour long.",type:"error"}),void w(t.id)):void O(t)}})(o):O(o)}catch(YEe){P("An error occurred during upload. Please make sure your media is a compatible format.",t,"checkFileAndUpload"),a()}},M=async e=>{if(!e||e.length<=0)s({description:"Please choose a file!",type:"error"});else if(e.length>15)s({description:"Please upload 15 or fewer files at a time.",type:"error"});else{k("upload");for(let t=0;t<e.length;t+=1)try{const a=await A(e[t]);if(!S&&(a.size||0)>262144e3)return vc("Rejected Upload",{Origin:"Workspace","File Size":a.size,"Workspace Type":S?"Pro":"Basic"}),void s({description:"Upgrade your workspace to upload files over 250MB up to 6GB.",type:"error"});F(a)}catch(YEe){const{message:t}=xu(YEe);s({description:t,type:"error"})}}},U=(e,t,a,o)=>{const n=new XMLHttpRequest;n.open("PUT",e,!0),n.onload=r=>{if(308===r.target.status){console.debug("gcs returned 308, try resuming upload");const r=n.getResponseHeader("Range");if(!r)return console.debug("no range returned, try again"),void D(e,t,a,{},o);const i=parseInt(r.split("-").pop(),10);if(i<0)return console.debug("Last uploaded byte < 0, try again from beginning"),void D(e,t,a,{},o);const s=i+1,l=a.size-1,d={"Content-Range":`bytes ${s}-${l}/${a.size}`};console.debug("Resuming upload, starting at byte ",i),D(e,t,a.slice(s,l+1),d,o)}else L(n,t,a)},n.onerror=()=>{R(n.status,e,t,a,o)},n.setRequestHeader("Content-Range",`bytes */${a.size}`),n.send()},B=async e=>{a();const t=e;t.mime&&t.mime.includes("image")&&(t.duration=0),t.name="Studio Project",t.workspaceId=c,t.id=y();const o=t.name;_(o);const{newLayer:n,mediaInfo:r}=await N(t,o);if(!r)throw Error("Could not determine upload type");return!S&&"duration"in r&&r.duration&&r.duration>420?(vc("Rejected Upload",{Origin:"Workspace","File Duration":t.duration,"Workspace Type":S?"Pro":"Basic"}),s({description:"Upgrade your workspace to upload files over 7 minutes (up to 2 hour) long.",type:"error"}),void w(t.id)):"duration"in r&&r.duration&&r.duration>7200?(vc("Rejected Upload",{Origin:"Workspace","File Duration":t.duration,"Workspace Type":S?"Pro":"Basic"}),s({description:"Your content must be under 2 hour long.",type:"error"}),void w(t.id)):(p(n),m("pending"),void h(t.id,"100%"))};return i.createElement("div",null,t&&i.createElement(ale,{hideDialog:()=>a(),handleMultiFileUpload:M,startUpload:k,stopUpload:C,handlePasteLinkFinish:B,returnAccepts:x}),o&&i.createElement($J,{hideDragUploadDialog:n,handleDragUpload:M,showDragUploadDialog:!0,dragUpload:!0},i.createElement("div",{className:Vse},"Upload video or image"),i.createElement(JJ,{returnAccepts:x,handleMultiFileUpload:M,multiple:!0,labelClassNames:zse})))})),rle="LogoRedesigns-module_wrapper_5Er59",ile="LogoRedesigns-module_container_8iWJM",sle="LogoRedesigns-module_content_4IcCx",lle="LogoRedesigns-module_headerImage_UsZ8C",dle="LogoRedesigns-module_date_RkkN1",cle="LogoRedesigns-module_header_mF84A",ule="LogoRedesigns-module_firstP_5Ls7w",mle="LogoRedesigns-module_p_pnYqE",ple=()=>{const e="A strong logo can undergo a revamp without losing its essence. But can it resist being dominated by one of graphic design's cornerstone styles? To find out, we've recreated six iconic logos in six essential art styles.";return i.createElement(i.Fragment,null,i.createElement(rt,null,i.createElement("title",null,"Logo Redesigns — Kapwing"),i.createElement("meta",{name:"description",content:e}),i.createElement("meta",{name:"keywords",content:"logo redesign, graphic design, art styles, logo styles"}),i.createElement("meta",{property:"og:title",content:"Logo Redesigns — Kapwing"}),i.createElement("meta",{property:"og:description",content:e}),i.createElement("meta",{property:"og:image",content:"https://cdn-useast1.kapwing.com/static/neomam/logo-og-image.jpeg"}),i.createElement("meta",{property:"twitter:image",content:"https://cdn-useast1.kapwing.com/static/neomam/logo-og-image.jpeg"}),i.createElement("link",{rel:"canonical",href:"https://www.kapwing.com/logo-redesigns"})),i.createElement(QQ,null),i.createElement("div",{className:rle},i.createElement("div",{className:ile},i.createElement("div",{className:sle},i.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/Header_6-Famous-Logos-Designed-In-6-Graphic-Design-Styles.a38085c9.png",alt:"Trading in Trademarks",className:lle}),i.createElement("div",{className:dle},"16 January 2022"),i.createElement("h1",{className:cle},"Six Famous Logos Designed in Six Graphic Design Styles"),i.createElement("p",{className:ule},"A brand's logo has a lot of heavy lifting to do. The logo should hint at the product type and ooze the brand's spirit. It should be stylish yet timeless. And it should do all this without looking quite like"," ",i.createElement("a",{href:"https://www.creativebloq.com/features/8-famous-logos-that-look-unbelievably-similar",target:"_blank",rel:"noopener noreferrer"},"anything else"),"."),i.createElement("p",{className:mle},"Yet a logo needs to be light as a feather. If the consumer needs to think about it, it's dead in the water. A logo should be eloquent, effortless, effervescent."),i.createElement("p",{className:mle},"When a graphic designer begins a new logo, they balance the need for originality against the need for instant recognition. Rather than choosing a graphic design style, they should wield a"," ",i.createElement("a",{href:"https://99designs.co.uk/blog/logo-branding/famous-logos/",target:"_blank",rel:"noopener noreferrer"},"deep knowledge")," ","of the looks that have gone before and understand the connotations of those styles today."),i.createElement("p",{className:mle},"A strong logo can undergo a revamp without losing its essence. But can it resist being dominated by one of graphic design's cornerstone styles? To find out — and provide a graphic design style primer — the team at"," ",i.createElement("a",{href:"https://www.kapwing.com",target:"_blank",rel:"noopener noreferrer"},"Kapwing"),", has recreated ",i.createElement("strong",null,"six iconic logos")," in these"," ",i.createElement("strong",null,"six essential styles"),":"," "),i.createElement("ul",null,i.createElement("li",null,i.createElement("strong",null,"Art nouveau.")," An elegant, sinuous, romantic style from the turn of the 20th century."),i.createElement("li",null,i.createElement("strong",null,"Bauhaus.")," An avant-garde design school that favored functionalism, geometrics, and space."),i.createElement("li",null,i.createElement("strong",null,"Psychedelic.")," Acid-colored patterns and stream-of-conscious lines that have bedazzled beholders since the 1960s."),i.createElement("li",null,i.createElement("strong",null,"Pop art.")," Kitsch, comic-style pop culture references channeling 1950s Americana through Andy Warhol's eyes."),i.createElement("li",null,i.createElement("strong",null,"Retro '80s.")," The grids, vector curves, clipart, and blocky fonts of 1980s computer graphics sprinkled with that weird '80s sense of glamor."),i.createElement("li",null,i.createElement("strong",null,"3D design.")," Playful renders popping out of the screen with more or less fidelity to realism.")),i.createElement("p",{className:mle},"Scroll on for a closer look at each brand logo."),i.createElement("a",{href:"https://cdn-useast1.kapwing.com/static/neomam/01_Famous-Logos-Designed-In-Graphic-Design-Styles_Poster.png",target:"_blank",rel:"noopener noreferrer"},i.createElement("img",{alt:"Famous Logos Redesigned",src:"https://cdn-useast1.kapwing.com/static/neomam/01_Famous-Logos-Designed-In-Graphic-Design-Styles_Poster.png"})),i.createElement("h2",{id:"Apple"},"Apple"),i.createElement("p",{className:mle},"The apple: so simple, you don't even need typography. There are many theories for that bite, though. It could reference Alan Turing, the gay war hero who invented \"",i.createElement("a",{href:"https://www.newscientist.com/people/alan-turing/",target:"_blank",rel:"noreferrer noopener"},"the computer"),'" and who ate an apple laced with poison after the feds chemically castrated him. Or it could reference the forbidden knowledge of actually opening up a Mac to see how it works. However, designer Touraj Saberivand'," ",i.createElement("a",{href:"https://inkbotdesign.com/apple-logo-design/",target:"_blank",rel:"noreferrer noopener"},"explains"),': "to make it look more like an apple and not some other round fruit, I did what one does with an apple. I took a bite out of it."'),i.createElement("a",{href:"https://cdn-useast1.kapwing.com/static/neomam/02_Apple-Logo-Designed-In-Graphic-Design-Styles.png",target:"_blank",rel:"noopener noreferrer"},i.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/02_Apple-Logo-Designed-In-Graphic-Design-Styles.png",alt:"Apple Logo"})),i.createElement("p",{className:mle},"Our art nouveau take on the Apple logo is not far from the brand's original 1976 artwork — a woodblock print of an apple gravitating towards Isaac Newton's head with the words “Apple Computer Co.” wrapped around it. But the Bauhaus version most clearly articulates Steve Jobs' vision: clear, artistic —"," ",i.createElement("a",{href:"https://www.forbes.com/sites/stevedenning/2011/11/17/the-lost-interview-steve-jobs-tells-us-what-really-matters",target:"_blank",rel:"noreferrer noopener"},"a tool to amplify your abilities"),"."),i.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/Apple-compressed-animation.a2530daa.gif",alt:"Apple animation"}),i.createElement("h2",{id:"McDonald's"},"McDonald's"),i.createElement("p",{className:mle},"It's hard to imagine McDonald's without the golden arches. But when it was just the McDonald brothers in their shack with a fryer, they favored a jaunty comic script atop their then-mascot, the troubling burger chef,"," ",i.createElement("a",{href:"https://www.creativebloq.com/logo-design/mcdonalds-logo-short-11135325",target:"_blank",rel:"noreferrer noopener"},"Speedee"),". Troubling because Speedee was both a burger and a chef."," "),i.createElement("a",{href:"https://cdn-useast1.kapwing.com/static/neomam/03_McDonalds-Logo-Designed-In-Graphic-Design-Styles.png",target:"_blank",rel:"noopener noreferrer"},i.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/03_McDonalds-Logo-Designed-In-Graphic-Design-Styles.png",alt:"McDonald's Logo"})),i.createElement("p",{className:mle},"The ghost of Speedee haunts the rock 'n roll quiffed burger boy of our 1950s pop art style McD's logo. But the versions that retain prominent arches demonstrate the power of a simple motif to conjure a brand's aftertaste in your mouth. McDonald's is going through a big"," ",i.createElement("a",{href:"https://www.vox.com/22736636/mcdonalds-design-aesthetic-look-buildings",target:"_blank",rel:"noreferrer noopener"},"identity crisis")," ","lately, not least"," ",i.createElement("a",{href:"https://www.mashed.com/680053/the-hilarious-reason-mcdonalds-just-changed-its-twitter-handle/",target:"_blank",rel:"noreferrer noopener"},"rebranding its Twitter handle")," ","in the style of South Korean boy band phenomenon BTS. Can the arches bear the strain?"),i.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/McDonalds-compressed-animation.f2ecf0b5.gif",alt:"McDonald's animation"}),i.createElement("h2",{id:"Instagram"},"Instagram"),i.createElement("p",{className:mle},"Cole Rise threw the old Instagram logo together in under 45 minutes. Deadline met, he refined it over the next few months. The polished version represented the app for five years. Rise's 2010 design followed the"," ",i.createElement("a",{href:"https://blog.hubspot.com/website/skeuomorphism",target:"_blank",rel:"noreferrer noopener"},"skeuomorphic")," ","design trend of the day, making the logo look like an actual Instamatic camera (actually a Bell & Howell)."),i.createElement("a",{href:"https://cdn-useast1.kapwing.com/static/neomam/04_Instagram-Logo-Designed-In-Graphic-Design-Styles.png",target:"_blank",rel:"noopener noreferrer"},i.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/04_Instagram-Logo-Designed-In-Graphic-Design-Styles.png",alt:"Instagram Logo"})),i.createElement("p",{className:mle},"When Instagram decided it was time to simplify and"," ",i.createElement("a",{href:"https://www.interaction-design.org/literature/topics/flat-design",target:"_blank",rel:"noreferrer noopener"},'"flatten"')," ","its logo like everyone else, they asked every staff member to draw Rise's logo from memory. “That gave us a sense of what was burned in,”"," ",i.createElement("a",{href:"https://www.fastcompany.com/3059740/an-exclusive-look-at-instagrams-new-app-icon",target:"_blank",rel:"noreferrer noopener"},"said Ian Spalter"),", head of design. Our re-styled versions demonstrate just how hot the square-and-concentric-circles brand burns."),i.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/Instagram-compressed-animation.75de683f.gif",alt:"Instagram animation"}),i.createElement("h2",{id:"Google"},"Google"),i.createElement("p",{className:mle},"The Google brand has thrived on minimalism even as the company explores ever more diverse avenues (its next move is"," ",i.createElement("a",{href:"https://www.nytimes.com/2021/04/30/technology/google-back-to-office-workers.html",target:"_blank",rel:"noreferrer noopener"},"“Ikea meets Lego”"),"). The uncluttered search page and no-frills logo are as much an element of Google's early success as its algorithms. But the original logo featured an exclamation mark and a"," ",i.createElement("a",{href:"https://sweeney.agency/shedding-some-light-on-the-drop-shadow/",target:"_blank",rel:"noreferrer noopener"},"drop shadow")," ","that'll make you cry. Not so much 'simple' as 'basic.'"),i.createElement("a",{href:"https://cdn-useast1.kapwing.com/static/neomam/05_Google-Logo-Designed-In-Graphic-Design-Styles.png",target:"_blank",rel:"noopener noreferrer"},i.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/05_Google-Logo-Designed-In-Graphic-Design-Styles.png",alt:"Google Logo"})),i.createElement("p",{className:mle},"The simplicity of the post-exclamation, post-drop shadow logo has allowed for infinite variations via the regularly-changing"," ",i.createElement("a",{href:"https://www.google.com/doodles/about",target:"_blank",rel:"noreferrer noopener"},"Google Doodle"),". So, while none of our redesigns look implausible, the two that are most evocative are those that imagine Google in a realistic alternative timeline: either the vaporwave look of our"," ",i.createElement("a",{href:"https://www.rediscoverthe80s.com/2020/02/what-the-internet-was-like-in-the-80s.html",target:"_blank",rel:"noreferrer noopener"},"dial-up era")," ","1980s logo or the augmented-reality bubbles of the 3D version."),i.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/Google-compressed-animation.180e4c5b.gif",alt:"Google animation"}),i.createElement("h2",{id:"NASA"},"NASA"),i.createElement("p",{className:mle},"The NASA logo is pretty busy by today's standards, but when your main beholders are space aliens, it makes sense to communicate your purpose in full. The planet-shaped, star-studded, red aeronautics-themed dash logo has a mundane nickname among Earth-dwellers, even at NASA: the meatball."),i.createElement("a",{href:"https://cdn-useast1.kapwing.com/static/neomam/06_NASA-Logo-Designed-In-Graphic-Design-Styles.png",target:"_blank",rel:"noopener noreferrer"},i.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/06_NASA-Logo-Designed-In-Graphic-Design-Styles.png",alt:"NASA Logo"})),i.createElement("p",{className:mle},"NASA already has a '1980s version' of its logo. Their"," ",i.createElement("a",{href:"https://www.nasa.gov/audience/forstudents/5-8/features/symbols-of-nasa.html",target:"_blank",rel:"noreferrer noopener"},"looping, red, text-only logo")," ","known as the 'worm' did most of the work between 1975 — 1992 (and recently made another comeback). So our 1980s version imagines the best of both worlds: a meatball in the decade that gave us the bubblegum heroics of ",i.createElement("i",null,"Explorers and Flight of the Navigator"),"."),i.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/NASA-compressed-animation.15def524.gif",alt:"NASA animation"}),i.createElement("h2",{id:"WWF"},"WWF"),i.createElement("p",{className:mle},"The choice of a panda for WWF’s icon is a masterstroke of clear thinking. The simplicity of a black and white design that works in silhouette; the precarity of the panda as symbolic of World Wildlife Fund’s efforts; and the cute factor that convinces supporters to part with their money. The panda design has prevailed almost unchanged since 1961 (thankfully the World Wrestling Federation didn’t choose a panda for its logo)."),i.createElement("a",{href:"https://cdn-useast1.kapwing.com/static/neomam/07_WWF-Logo-Designed-In-Graphic-Design-Styles.png",target:"_blank",rel:"noopener noreferrer"},i.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/07_WWF-Logo-Designed-In-Graphic-Design-Styles.png",alt:"WWF Logo"})),i.createElement("p",{className:mle},"Our Bauhaus-style redesign of the WWF logo adds a splash of color while simplifying the form. And it maintains the cuteness without resorting to the child appeal of our 1980s version. Scientists say the power of cute can be used to ‘",i.createElement("a",{href:"https://www.ox.ac.uk/research/how-cute-things-hijack-our-brains-and-drive-behaviour",target:"_blank",rel:"noreferrer noopener"},"hijack our brains"),",’ which makes it a useful tool for marketing – but it’s essential not to"," ",i.createElement("a",{href:"https://99designs.co.uk/blog/creative-inspiration/cute-logos/",target:"_blank",rel:"noreferrer noopener"},"compromise")," ","the seriousness of your brand."),i.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/WWF-compressed-animation.c7be7ece.gif",alt:"WWF animation"}),i.createElement("p",{className:mle},"When"," ",i.createElement("a",{href:"https://www.creativebloq.com/features/5-logos-by-famous-designers-and-why-they-work",target:"_blank",rel:"noreferrer noopener"},"Chupa Chups")," ","needed a logo, the boss asked his friend Salvador Dali to sketch one on an old newspaper that was lying around. Yet a logo needn't be high art. Right now, supermarket brands are giving"," ",i.createElement("a",{href:"https://www.designweek.co.uk/what-is-normcore-and-how-will-it-affect-design/",target:"_blank",rel:"noreferrer noopener"},"normcore")," ","its"," ",i.createElement("a",{href:"https://plato.stanford.edu/entries/postmodernism/",target:"_blank",rel:"noreferrer noopener"},"post-modernist")," ","moment, splashing their basic but powerful logos over nerdy knits to create"," ",i.createElement("a",{href:"https://www.theguardian.com/lifeandstyle/2021/dec/04/how-the-mundane-trend-is-bringing-some-christmas-sparkle-for-everyday-brands",target:"_blank",rel:"noreferrer noopener"},"highly coveted"),", semi-ironic streetwear. They may be ugly, but they carry a lot of emotional baggage."),i.createElement("p",{className:mle},"The lesson for logo designers? Draw inspiration from style movements but remain boldly true to the brand. It takes integrity and flair to create an icon that sears itself into the world's retinas."),i.createElement("hr",null),i.createElement("p",{className:mle},"Did you enjoy this collection of logo redesigns? Our team at Kapwing, an"," ",i.createElement("a",{href:"https://www.kapwing.com/video-editor",target:"_blank",rel:"noreferrer noopener"},"online video editor"),", loves putting out amazing content related to visual design. Learn and read much more on our"," ",i.createElement("a",{href:"https://www.kapwing.com/resources",target:"_blank",rel:"noreferrer noopener"},"resources section")," ","and"," ",i.createElement("a",{href:"https://www.kapwing.com/blog",target:"_blank",rel:"noreferrer noopener"},"blog"),".")))),i.createElement(DJ,null))},hle="TwitchStreamers-module_wrapper_NJGqb",gle="TwitchStreamers-module_container_M3p03",yle="TwitchStreamers-module_content_9kfTu",fle="TwitchStreamers-module_headerImage_K7nx9",Ele="TwitchStreamers-module_date_pmO97",vle="TwitchStreamers-module_header_zbyx0",wle="TwitchStreamers-module_firstP_D1c2V",ble="TwitchStreamers-module_p_qY6qC",_le="TwitchStreamers-module_iframeContainer_jo6-0",Tle="TwitchStreamers-module_iframe_pN7av",Sle="TwitchStreamers-module_bannerImage_REcA4",Ile="TwitchStreamers-module_longIframe_tzqyt",xle=()=>{const e="Enter your annual salary into this interactive tool, and we’ll compare your meager earnings to that of Twitch’s highest earner, RanbooLive. Then, while you’re drying your tears, scroll on to see the rest of our comparisons.";return i.createElement(i.Fragment,null,i.createElement(rt,null,i.createElement("title",null,"Which Twitch Streamers Earn the Most per Hour? — Kapwing"),i.createElement("meta",{name:"description",content:e}),i.createElement("meta",{name:"keywords",content:"twitch earnings, streamers income, twitch salary"}),i.createElement("meta",{property:"og:title",content:"Which Twitch Streamers Earn the Most per Hour? — Kapwing"}),i.createElement("meta",{property:"og:description",content:e}),i.createElement("meta",{property:"og:image",content:"https://cdn-useast1.kapwing.com/static/neomam/twitch/twitch-og-image-min.jpeg"}),i.createElement("meta",{property:"twitter:image",content:"https://cdn-useast1.kapwing.com/static/neomam/twitch/twitch-og-image-min.jpeg"}),i.createElement("link",{rel:"canonical",href:"https://www.kapwing.com/how-much-twitch-streamers-make"})),i.createElement(QQ,null),i.createElement("div",{className:hle},i.createElement("div",{className:gle},i.createElement("div",{className:yle},i.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/neomam/twitch/Header_Highest-Earning-Twitch-Streamers.86c050a1.png",alt:"Twitch Revenue Streams",className:fle}),i.createElement("div",{className:Ele},"24 January 2022"),i.createElement("h1",{className:vle},"Which Twitch Streamers Earn the Most per Hour?"),i.createElement("p",{className:wle},"Enter your annual salary into this interactive tool, and we’ll compare your meager earnings to that of Twitch’s highest earner,"," ",i.createElement("a",{href:"https://www.twitch.tv/ranboolive",target:"_blank",rel:"noopener noreferrer"},"RanbooLive"),". Then, while you’re drying your tears, scroll on to see the rest of our comparisons."),i.createElement("div",{className:_le},i.createElement("iframe",{title:"Twitch Income Calculator",frameBorder:0,src:"https://nnm-twitch-streamers.netlify.app/calculator/",scrolling:"no",className:Tle})),i.createElement("p",{className:ble},"Twitch is Amazon’s hugely popular games streaming platform. It’s a closed universe where semi-anonymous teens become low-key celebrities off the back of their charm and gaming prowess. But curtain-twitchers saw how the platform rewards its personalities when hackers stole a bunch of ‘",i.createElement("a",{href:"https://blog.twitch.tv/en/2021/10/15/updates-on-the-twitch-security-incident/",target:"_blank",rel:"noopener noreferrer"},"creator payout data"),"’ from the site in October 2021."),i.createElement("p",{className:ble},"The leak seems to reveal that half of the streamer earnings on Twitch go to just"," ",i.createElement("a",{href:"https://techcrunch.com/2021/10/07/twitch-streamers-respond-after-huge-leak-of-creator-payout-data/",target:"_blank",rel:"noopener noreferrer"},"10% of the streamers"),". According to some creators, this indicates that Twitch is more invested in driving viewers to superstar channels than boosting discoverability for up-and-coming talent – including marginalized groups."),i.createElement("p",{className:ble},"But those outside of the story are dizzied by the mindboggling earnings of the top streamers compared to the hours they spend streaming. For example,"," ",i.createElement("a",{href:"https://www.twitch.tv/pokimane",target:"_blank",rel:"noopener noreferrer"},"pokimane")," ","spent 2,177 hours online in the 15 months leading to October 2020, earning $1.53m – which works out at $702.02 per hour. A teacher would need to work 29 hours for every pokimane hour to earn that much."),i.createElement("p",{className:ble},"Well, nobody said that celebrities are supposed to earn normal salaries. But, our team at"," ",i.createElement("a",{href:"https://www.kapwing.com"},"Kapwing")," got curious about how these figures compare to more regular modes of employment. So, we figured out the effective hourly rates of Twitch’s 100 biggest earners and made some tools to help you visualize them."),i.createElement("h2",{id:"ranboolives-hourly-wage"},"RanbooLive has Twitch’s Highest ‘Hourly Wage’"),i.createElement("p",{className:ble},"When news of the Twitch leak dropped, Ranboo tweeted an image of some masking tape with the caption, “",i.createElement("a",{href:"https://twitter.com/ranboosaysstuff/status/1445763636849348609?lang=en",target:"_blank",rel:"noopener noreferrer"},"Dont worry everyone ill fix the leak."),"” With Twitch earnings of $2,401,021.84, he can afford a million rolls of tape if he even cares that folk know his income."),i.createElement("p",{className:ble},"Little else is known about the Minecraft-playing Twitch star, who wears a monochrome mask and shades to protect his privacy and cope with dysmorphia. However, he has teased a big reveal at 5 million followers (",i.createElement("a",{href:"https://twitter.com/Ranboosaysstuff/status/1465015825622962179",target:"_blank",rel:"noopener noreferrer"},"he’s just reached 4m"),"). Divided across his 1,001 hours of streaming, Ranboo earns $2,398.62/hour."),i.createElement("a",{href:"https://cdn-useast1.kapwing.com/static/neomam/twitch/01_Highest-Earning-Twitch-Streamers_Static_Top-20.2b421d3a.png",target:"_blank",rel:"noopener noreferrer"},i.createElement("img",{alt:"Which Twitch Streamers Earn the Most per Hour?",src:"https://cdn-useast1.kapwing.com/static/neomam/twitch/01_Highest-Earning-Twitch-Streamers_Static_Top-20.2b421d3a.png",className:Sle})),i.createElement("p",{className:ble},"Twitch’s 10 highest earners earn an average of $1,477 per hour of streaming. Even when you even the earnings out across the top 50, you still get an average rate of $732/hour. The top 10 streamed for an average of 2,709 hours (1st Aug 2019 - 1st Oct 2020), while the top 50 worked an average of 3,719 hours."),i.createElement("p",{className:ble},"Twitch’s partner scheme offers"," ",i.createElement("a",{href:"https://www.businessinsider.com/twitch-raises-incentives-for-creators-2017-4?r=US&IR=T",target:"_blank",rel:"noopener noreferrer"},"varying")," ","splits on subscription earnings, depending on the popularity of the streamer. Some claim that highly popular streamers can negotiate this split, which may be how the highest earners capitalize on streaming for relatively few hours."),i.createElement("h2",{id:"it-takes-a-doctor-67-hours"},"RanbooLive has Twitch’s Highest ‘Hourly Wage’"),i.createElement("p",{className:ble},"Next, we figured out how RanbooLive’s effective hourly rate compares to that of more common American jobs. For example, a doctor earns $35.90/hour on average. They would need to work 67 hours to match what Ranboo earns from an hour of streaming. Looked at another way, in the time it takes Ranboo to earn $35.90, a doctor earns just 54 cents."),i.createElement("a",{href:"https://cdn-useast1.kapwing.com/static/neomam/twitch/02_Highest-Earning-Twitch-Streamers_Static_Table-US.e07e6a40.png",target:"_blank",rel:"noopener noreferrer"},i.createElement("img",{alt:"Hourly Pay of Twitch's Top Streamer vs. Common US Professions",src:"https://cdn-useast1.kapwing.com/static/neomam/twitch/02_Highest-Earning-Twitch-Streamers_Static_Table-US.e07e6a40.png",className:Sle})),i.createElement("p",{className:ble},"And that’s for a doctor. Waiting staff earn an average of $15/hour, so they’d need to work 160 hours to match Ranboo. Teachers – trusted with the future of our children and our culture – need to put in 99 hours at $24.34 to earn a Ranboo hour. The problem is not so much the freak earnings of Ranboo, but the low compensation to the mass of America’s workers,"," ",i.createElement("a",{href:"https://www.brookings.edu/blog/the-avenue/2019/11/21/low-wage-work-is-more-pervasive-than-you-think-and-there-arent-enough-good-jobs-to-go-around/",target:"_blank",rel:"noopener noreferrer"},"nearly half")," ","of whom earn less than it takes to achieve ‘economic security.’"),i.createElement("h2",{id:"the-boss-of-it-all"},"The Boss of It All"),i.createElement("p",{className:ble},"The highest earner in the Twitchosphere is the owner of its parent company, Amazon. But does anyone care what Jeff Bezos earns anymore? Like picturing the universe, imagining Bezos’ income is an tough task."),i.createElement("p",{className:ble},"Still, Amazon’s payroll remains of interest. Not just the company’s"," ",i.createElement("a",{href:"https://www.nytimes.com/2021/10/24/technology/amazon-employee-leave-errors.html",target:"_blank",rel:"noopener noreferrer"},"failure")," ","to honor even the low wages of its regular workers, but the distribution of wealth and opportunity across Twitch’s creator community. And what it means for the rest of us average Joe’s, who would love to earn $2k doing what we love for an hour or so…"),i.createElement("p",{className:ble},"For our full analysis of the leaked Twitch streamer earnings, check out the table below."),i.createElement("div",{className:_le},i.createElement("iframe",{title:"Twitch Income Calculator",frameBorder:0,src:"https://nnm-twitch-streamers.netlify.app/table/",scrolling:"yes",className:Ile})),i.createElement("h2",{id:"methodology-&-sources"},"Methodology & Sources"),i.createElement("p",{className:ble},"We used data from the recent"," ",i.createElement("a",{href:"https://twitter.com/Sinoc229/status/1445639738707251200",target:"_blank",rel:"noopener noreferrer"},"Twitch data leak")," ","to discover the top 100 earning Twitch streamers. Then we used"," ",i.createElement("a",{href:"https://twitchtracker.com/xqcow/statistics",target:"_blank",rel:"noopener noreferrer"},"Twitch Tracker")," ","to find out how long each Twitch streamer spent streaming during the time period used for the leaked figures (August 2019 to October 2021). We took the earnings for each streamer and divided it by the number of hours streamed. The average earnings for UK and US professions came from"," ",i.createElement("a",{href:"https://uk.talent.com/",target:"_blank",rel:"noopener noreferrer"},"Talent.com"),"."),i.createElement("hr",null),i.createElement("p",{className:ble},"Did you enjoy this deep dive into the incomes of popular Twitch streamers? Our team at Kapwing, an"," ",i.createElement("a",{href:"https://www.kapwing.com/video-editor",target:"_blank",rel:"noreferrer noopener"},"online video editor"),", loves creating content related to video and internet culture. Learn and read much more on our"," ",i.createElement("a",{href:"https://www.kapwing.com/resources",target:"_blank",rel:"noreferrer noopener"},"resources section")," ","and"," ",i.createElement("a",{href:"https://www.kapwing.com/blog",target:"_blank",rel:"noreferrer noopener"},"blog"),".")))),i.createElement(DJ,null))},kle=({statusCode:e=301,to:t,...a})=>i.createElement(ft,{render:({staticContext:o})=>(o&&Object.assign(o,{statusCode:e,to:t}),i.createElement(Da,{to:t,...a}))}),Cle=()=>{ys();!function(e){amplitude.getInstance().setUserProperties({...e,maxExportDurationNonPro:420})}(hs())},Ale="TeamLinkInviteAccept-module_backgroundContainer_ncF5H",Nle="TeamLinkInviteAccept-module_contentContainer_DtXl1",Ple="TeamLinkInviteAccept-module_bodyContainer_Ntb5H",Rle="TeamLinkInviteAccept-module_logoContainer_skM6n",Lle="TeamLinkInviteAccept-module_logoHeader_edtB7",Dle="TeamLinkInviteAccept-module_header_zJTEC",Ole="TeamLinkInviteAccept-module_description_bgeDF",Fle="TeamLinkInviteAccept-module_acceptButton_ocHBo",Mle="TeamLinkInviteAccept-module_acceptLoading_dlxau";var Ule=(e=>(e.LINK="Copied Link",e.EMAIL="Email Invite Link",e))(Ule||{});const Ble=async(e,t,a)=>{const{dispatch:o,history:n,state:r}=tn(),{currentUser:{user:i}}=r;await o(jE()),o(LE(e));const s=await o(gR("",e));n.push(`/folder/${s}`);const l=nd();l&&Qf(i,t,i.email,a,l)},Wle=()=>{const e=Ie(),t=m.exports.useDispatch(),a=wa(),o=tr((e=>e.currentUser)),[n,s]=r.exports.useState(!1),[l,d]=r.exports.useState(!0),[c,u]=r.exports.useState(""),[p,h]=r.exports.useState(""),[g,y]=r.exports.useState(!0),[f,E]=r.exports.useState(!1),v=oe(),w="from-joining"===new URLSearchParams(v.search).get("redirect");r.exports.useEffect((function(){(async()=>{const n=a.id,{user:r}=o;try{const a=await(async e=>hu(`/api/v1/team-invite-links/invite/${e}`))(n);if(a.canAccess){t(LE(a.teamId));const o=await t(gR("",a.teamId));e.push(`/folder/${o}`)}else u(a.name),h(a.inviterEmail),y(!1),t(ME(a.inviterEmail)),t(UE(a.teamId)),Jf(r,a.teamId,a.inviterEmail,"Copied Link")}catch(YEe){console.error(YEe),d(!1),y(!1)}})()}),[o,t,e,a.id]);const b=r.exports.useCallback((async()=>{if(sc(o)){E(!0);try{const e=await(async e=>gu("/api/v1/team-invite-links/accept",{body:{teamId:e}}))(a.id);e.teamId?await Ble(e.teamId,p,Ule.LINK):(E(!1),t(Su({description:"No team id.",type:"error"})))}catch(e){E(!1),Iu({description:"There was an issue joining the team, please try again.",error:e})}}else s(!0)}),[o,t,a.id,p]);r.exports.useEffect((function(){w&&!g&&b()}),[b,w,g]);return i.createElement(i.Fragment,null,i.createElement(QQ,null),i.createElement("div",{className:Ale},i.createElement("div",{className:Nle},g?i.createElement(CO,null):i.createElement("div",{className:Ple},i.createElement("div",{className:Rle},i.createElement("img",{alt:"Kapwing Logo",className:Lle,src:"https://cdn-useast1.kapwing.com/static/9_y-transparent-logo.webp"})),l?i.createElement(i.Fragment,null,i.createElement("div",{className:Dle},"You've been invited to join ",i.createElement("strong",null,c)," on Kapwing"),i.createElement("div",{className:Ole},"Kapwing works better as a team. By joining this team workspace, you'll be able to create new content and view, edit, and delete existing content. You can also invite new members and collaborate on content together."),i.createElement("div",{className:Ole},sc(o)?i.createElement(i.Fragment,null,"By continuing, you will join this workspace with the account"," ",i.createElement("b",null,o.user.email),"."):"By continuing, you will sign in and become a member of this workspace."),f?i.createElement("div",{className:Mle},i.createElement(CO,null)):i.createElement("div",{className:Fle,onClick:b,id:"join-button"},"Join Team Workspace"),n?i.createElement(ZF,{hideSignIn:()=>{s(!1)},onSuccess:b,immediateRedirectPathname:`${v.pathname}?redirect=from-joining`}):null):i.createElement(i.Fragment,null,i.createElement("div",{className:Dle},"Invite link is invalid"),i.createElement("div",{className:Ole},"This invite link seems to be broken. It's possible that the team has been moved or that you no longer have permission to access this workspace. Reach out to the team admin for a new link or a new invitation via email."),i.createElement(at,{to:"/"},i.createElement("div",{className:Fle,"data-cy":"home-button"},"Go Home")))))),i.createElement(DJ,null))},Vle="TeamEmailInviteAccept-module_backgroundContainer_Ioq8R",jle="TeamEmailInviteAccept-module_contentContainer_PEggh",Gle="TeamEmailInviteAccept-module_bodyContainer_oc0GP",Hle="TeamEmailInviteAccept-module_logoContainer_T-4Qu",zle="TeamEmailInviteAccept-module_logoHeader_pHn-x",$le="TeamEmailInviteAccept-module_header_ov2-8",Kle="TeamEmailInviteAccept-module_description_15PWB",Yle="TeamEmailInviteAccept-module_acceptButton_IsW6e",qle="TeamEmailInviteAccept-module_acceptLoading_rE3XC",Xle=we((({history:e,match:t})=>{const a=m.exports.useDispatch(),o=tr((e=>e.currentUser)),[n,s]=r.exports.useState(!1),[l,d]=r.exports.useState(!0),[c,u]=r.exports.useState(""),[p,h]=r.exports.useState(""),[g,y]=r.exports.useState(!0),[f,E]=r.exports.useState(!1),v=oe(),w="from-joining"===new URLSearchParams(v.search).get("redirect");r.exports.useEffect((function(){(async()=>{if(f)return;const{inviteKey:n}=t.params,{user:r}=o||{};try{const t=await(async e=>hu("/api/v1/invites/teams/checkLink",{params:{inviteKey:e}}))(n);if(t.alreadyInTeam){a(LE(t.teamId));const o=await a(gR());e.push(`/folder/${o}`)}else u(t.name),h(t.inviterEmail),y(!1),a(ME(t.inviterEmail)),a(UE(t.teamId)),Jf(r,t.teamId,t.inviterEmail,"Email Invite Link")}catch(YEe){console.error(YEe),d(!1),y(!1)}})()}),[o,a,e,f,t.params]);const b=r.exports.useCallback((async()=>{if(sc(o)){E(!0);try{const e=await(async e=>gu("/api/v1/invites/teams/accept",{body:{inviteKey:e}}))(t.params.inviteKey);e.teamId?await Ble(e.teamId,p,Ule.EMAIL):(E(!1),a(Su({description:"Join response errored.",type:"error"})))}catch(e){E(!1),Iu({description:"There was an issue joining the team, please try again.",error:e})}}else s(!0)}),[o,a,t.params.inviteKey,p]);r.exports.useEffect((function(){!w||g||f||(E(!0),b())}),[b,w,g,f]);return i.createElement(i.Fragment,null,i.createElement(QQ,null),i.createElement("div",{className:Vle},i.createElement("div",{className:jle},g?i.createElement(CO,null):i.createElement("div",{className:Gle},i.createElement("div",{className:Hle},i.createElement("img",{alt:"Kapwing Logo",className:zle,src:"https://cdn-useast1.kapwing.com/static/9_y-transparent-logo.webp"})),l?i.createElement(i.Fragment,null,i.createElement("div",{className:$le},"You've been invited to join ",i.createElement("strong",null,c)," on Kapwing"),i.createElement("div",{className:Kle},"Kapwing works better as a team. By joining this team workspace, you'll be able to create new content and view, edit, and delete existing content. You can also invite new members and collaborate on content together."),i.createElement("div",{className:Kle},sc(o)?i.createElement(i.Fragment,null,"By continuing, you will join this workspace with the account"," ",i.createElement("b",null,o.user.email),"."):"By continuing, you will sign in and become a member of this workspace."),f?i.createElement("div",{className:qle},i.createElement(CO,null)):i.createElement("div",{className:Yle,onClick:b},"Join Team Workspace"),n?i.createElement(ZF,{hideSignIn:()=>{s(!1)},onSuccess:b,immediateRedirectPathname:`${v.pathname}?redirect=from-joining`}):null):i.createElement(i.Fragment,null,i.createElement("div",{className:$le},"Invite link is invalid"),i.createElement("div",{className:Kle},"This invite link seems to be broken. It's possible that the team has been moved or that you no longer have permission to access this workspace. Reach out to the team admin for a new link or a new invitation via email."),i.createElement(at,{to:"/"},i.createElement("div",{className:Yle},"Go Home")))))),i.createElement(DJ,null))})),Jle="InstalledPWAHome-module_background_ya0I9",Qle="InstalledPWAHome-module_backgroundImage_SC592",Zle="InstalledPWAHome-module_signInContainer_LEoHq",ede="InstalledPWAHome-module_signInLogoContainer_6PvKS",tde="InstalledPWAHome-module_signInLogo_8Xyag",ade="InstalledPWAHome-module_signInText_VotiI",ode="InstalledPWAHome-module_text_CQ2oc",nde=()=>i.createElement(i.Fragment,null,i.createElement(rt,null,i.createElement("link",{rel:"canonical",href:"https://www.kapwing.com/"})),i.createElement("div",{className:Jle},i.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/home/Frame%202.png",alt:"",className:Qle}),i.createElement("div",{className:Zle},i.createElement("div",{className:ede},i.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/9XE-logo-small.webp",className:tde,alt:"Kapwing Logo"})," ","KAPWING"),i.createElement("div",{className:ade},i.createElement("div",{className:ode},"Trusted by millions of users, Kapwing makes content creation and video editing smart, accessible, and collaborative. Sign in below to continue to the official Play Store app.")),i.createElement(jF,null))));class rde extends r.exports.Component{render(){const{currentUser:e,currentFolderId:t,showToast:a}=this.props;return sc(e)?t?i.createElement(Da,{to:{pathname:`/folder/${t}`,state:this.props.location.state}}):i.createElement(Da,{to:{pathname:"/home",state:this.props.location.state}}):"undefined"!=typeof window?["4000"].includes(window.location.port)?(a({description:"You're developing locally on localhost:4000. In prod, this page would refresh and show the NextJS home page as you are not currently signed in. If you want to test this behavior, run 'yarn nginx' in the root directory and use port 3000.",type:"warning"}),i.createElement(Da,{to:"/signin"})):(window.location.reload(),null):i.createElement(oJ,null)}}const ide=we(m.exports.connect((e=>({currentUser:e.currentUser,currentFolderId:e.workspaces.selectedWorkspace})),(e=>me({showToast:Su},e)))(rde)),sde=e=>{let{planTier:t}=e;t||(t=vs.Free);return!(!Gs(t).isPaid||e.stripeId)},lde="EllipsesAnimation-module_ellipsisAnim_klIWe",dde=()=>i.createElement("span",{className:lde},i.createElement("span",null,"."),i.createElement("span",null,"."),i.createElement("span",null,".")),cde="ChargeNote-module_memberPaymentNote_Izhpz",ude=()=>i.createElement("div",{className:cde},i.createElement("strong",null,"Note:")," You will be charged for each team member who joins your workspace."," ",i.createElement("a",{href:"/help/subscription-faq/",target:"_blank",rel:"noopener noreferrer"},"Visit our FAQ")," ","to learn more about how your plan is billed."),mde={home:"Modal-module_home_4JMQJ",homeHowBackgroundWhite:"Modal-module_homeHowBackgroundWhite_8TCy1",largeButton:"Modal-module_largeButton_s6TVh",sectionContent:"Modal-module_sectionContent_oVv0S",sectionHeader:"Modal-module_sectionHeader_OOdDr",spacer:"Modal-module_spacer_Scsus",chevron:"Modal-module_chevron_V4qbo",splashText:"Modal-module_splashText_KNYtI",splashSubtext:"Modal-module_splashSubtext_f5BhF",aboutSection:"Modal-module_aboutSection_hvla1",mobile:"Modal-module_mobile_wYOc2",desktop:"Modal-module_desktop_G7Esl",screenReaderOnlyLabel:"Modal-module_screenReaderOnlyLabel_rpv-L",disabled:"Modal-module_disabled_THaXg",noScrollBar:"Modal-module_noScrollBar_GuuPP",textOverflowEllipsis:"Modal-module_textOverflowEllipsis_0JTtf",genericButtonBlue:"Modal-module_genericButtonBlue_jktwV",background:"Modal-module_background_AyKkN",contentContainer:"Modal-module_contentContainer_GaQSZ",mainContent:"Modal-module_mainContent_0KWDi",inputLabel:"Modal-module_inputLabel_b07lz",secondary:"Modal-module_secondary_0Ym5E",container:"Modal-module_container_GfihW",header:"Modal-module_header_ioGmE",description:"Modal-module_description_SwK-3",descriptionBold:"Modal-module_descriptionBold_HAKUx",closeContainer:"Modal-module_closeContainer_cLsYb",logoPreview:"Modal-module_logoPreview_z2kQp",removeLogo:"Modal-module_removeLogo_unzw-",uploadLogoContainer:"Modal-module_uploadLogoContainer_Q4RgM",uploadLogoInput:"Modal-module_uploadLogoInput_WXliW",uploadLabelHeader:"Modal-module_uploadLabelHeader_IwwPS",buttonsContainer:"Modal-module_buttonsContainer_XBJne",textInput:"Modal-module_textInput_--jAO",form:"Modal-module_form_SuMGf",disabledConfirmButtonMessage:"Modal-module_disabledConfirmButtonMessage_GXt0q",createNewWorkspaceTile:"Modal-module_createNewWorkspaceTile_UQnXf",modal:"Modal-module_modal_jBkFq",modalWithImageContainer:"Modal-module_modalWithImageContainer_ILKVt",right:"Modal-module_right_ajESI",left:"Modal-module_left_5Q4sE",modalPrimaryButton:"Modal-module_modalPrimaryButton_YC3fT",exit:"Modal-module_exit_2hgpP",dark:"Modal-module_dark_Vr6wu",light:"Modal-module_light_WFFRk",modalConfirmButtons:"Modal-module_modalConfirmButtons_gy-8f",modalFlowButtons:"Modal-module_modalFlowButtons_zMLWC",firstStep:"Modal-module_firstStep_nZSiX",continue:"Modal-module_continue_eUkC0",back:"Modal-module_back_hO4-S",dots:"Modal-module_dots_yO7ST",dot:"Modal-module_dot_dgrmi",selected:"Modal-module_selected_fWDG-",mTop16:"Modal-module_mTop16_H6TIY",mTop32:"Modal-module_mTop32_HqUtA",input:"Modal-module_input_HZ2eN"},pde=i.createContext({goToNextModal:()=>{},goToPreviousModal:()=>{},goToModalIndex:()=>{},onClose:()=>{},currentModalIndex:-1,modalSteps:[],exists:!1}),hde=({onClick:e,primaryButtonText:t="Next",secondaryButtonText:a="Back",primaryButtonDisabled:o=!1,loadingText:n})=>{const s=r.exports.useContext(pde),l=0===s.currentModalIndex;return i.createElement("div",{className:`${mde.modalFlowButtons} ${l&&mde.firstStep}`},i.createElement(s9,{buttonText:a,className:mde.back,onClick:s.goToPreviousModal,testId:"modal-flow-back-button"}),i.createElement("div",{className:mde.dots},s.modalSteps.map(((e,t)=>i.createElement("div",{className:`${mde.dot} ${s.currentModalIndex===t&&mde.selected}`,key:t,onClick:()=>s.goToModalIndex(t)})))),i.createElement(s9,{buttonText:n||t,className:`${mde.continue} ${o&&mde.disabled}`,onClick:()=>{e?e():s.goToNextModal()},testId:"modal-flow-next-button"}))},gde=({modalSteps:e,onClose:t,onFlowComplete:a=(()=>{}),onFlowDismissed:o=(()=>{})})=>{const[n,s]=r.exports.useState(0),l=n===e.length-1,d=0===n,c=r.exports.useCallback((()=>{o(),t()}),[t,o]),u=r.exports.useCallback((()=>{const o=e[n];(null==o?void 0:o.onNext)&&o.onNext(),l?(a(),t()):s((e=>e+1))}),[l,a,n,t,e]),m=r.exports.useCallback((()=>{d||s((e=>e-1))}),[d]),p=e=>{s(e)},h=r.exports.useMemo((()=>({goToNextModal:u,goToPreviousModal:m,goToModalIndex:p,onClose:c,modalSteps:e,currentModalIndex:n,exists:!0})),[u,m,c,e,n]);return i.createElement(pde.Provider,{value:h},(()=>{const t=e[n];return null==t?void 0:t.modal})())},yde="TeamInviteByEmail-module_inputLabel_JDsDR",fde="TeamInviteByEmail-module_emaillControlsContainer_JKa7k",Ede="TeamInviteByEmail-module_emailControl_0yxNM",vde="TeamInviteByEmail-module_emailControlError_PIRxp",wde="TeamInviteByEmail-module_emailInput_HemF7",bde="TeamInviteByEmail-module_emailControlErrorMessage_PHHI-",_de=({name:e,placeholder:t,value:a,isValid:o=!0,readOnly:n=!1,readOnlyMessage:r="",errorMessage:s="Invalid email address added. Please double check the entered email",onChange:l})=>i.createElement("div",{className:wde},!o&&i.createElement("p",{className:bde},s),i.createElement("input",{className:(()=>{let e=Ede;return o||(e=`${e} ${vde}`),e})(),type:"text",name:e,key:e,placeholder:t,value:n?`${a} - ${r}`:a,readOnly:n,onChange:l,autoComplete:"do-not-autocomplete","data-cy":"team-invite-member-email-input"})),Tde=({emails:e,setEmails:t,emailsPlaceholder:a,validateInviteEmail:o,emailExists:n})=>{const s=e=>n&&n(e.email)?"User is already a member of this workspace.":"Invalid email address added. Please double check the entered email.";return r.exports.useEffect((function(){if(e.length<3){const a=Array(3-e.length).fill(void 0).map((()=>({email:""})));t([...e,...a])}}),[e,t]),i.createElement(i.Fragment,null,i.createElement("div",{className:yde},"Invite by email"),i.createElement("div",{className:fde,"data-testid":"email-fields-container"},e.map(((n,r)=>i.createElement(_de,{key:r,name:`invite-by-email-input-${r}`,placeholder:a,value:n.email,isValid:n.isValid,readOnly:n.invited,readOnlyMessage:"invite pending",onChange:({target:a})=>{const{value:i}=a;n.email=i,!1===n.isValid&&(n.isValid=!i||o(i)),e[r]=n,t([...e])},errorMessage:s(n)})))))};function Sde(e){return navigator.clipboard.writeText(e)}const Ide="SmallLoader-module_loader_lyWGb",xde="SmallLoader-module_lightLoader_cL5zg",kde=({darkMode:e=!1})=>{const t=e?Ide:xde;return i.createElement("div",{className:t})},Cde="TeamInviteByLink-module_inputLabel_iPidK",Ade="TeamInviteByLink-module_linkContainer_3FyBt",Nde="TeamInviteByLink-module_inviteLink_qQL3C",Pde="TeamInviteByLink-module_copyButton_OtV6H",Rde="TeamInviteByLink-module_loaderWrapper_GZvOI",Lde=({onCopy:e,teamId:t,disabled:a=!1})=>{const o=m.exports.useDispatch(),n=xD(),[s,l]=r.exports.useState(""),d=r.exports.useRef(null),c=()=>{if(!s)return"";const{hostname:e}=window.location;return`${"localhost"===e?"localhost:3000":`https://${e}`}/team/sharing/${s}`},u=async e=>{Sde(e).then((()=>o(Su({description:"Invite link added to clipboard.",type:"success"})))).catch((e=>{Iu({description:"Copy failed",error:e})}))};return r.exports.useEffect((function(){(async()=>{const e=await function(e){return hu(`/api/v1/team-invite-links/team/${e}`)}(t);n.current&&l(e.inviteLink)})()}),[t,n]),a?null:i.createElement(i.Fragment,null,e&&i.createElement("div",{className:Cde},"Invite by link"),i.createElement("div",{className:Ade},i.createElement("div",{className:Nde,onClick:()=>{var t,a,o;u((null==(t=d.current)?void 0:t.innerHTML)||"");const n=document.createRange();d.current&&n.selectNode(d.current),null==(a=window.getSelection())||a.removeAllRanges(),null==(o=window.getSelection())||o.addRange(n),e&&e()},id:"inviteLink",ref:d,"data-testid":"invite-link-url"},c()),i.createElement("div",{className:Pde,onClick:()=>{s&&u(c()),e&&e()}},s?"Copy Link":i.createElement("div",{className:Rde},i.createElement(kde,null)))))},Dde=({entryPoint:e,onClose:t=(()=>{}),setPendingInvites:a})=>{const o=m.exports.useDispatch(),{executeRecaptcha:n}=fe(),s=id(),l=sd(),{currentUser:d,selectedTeamId:c,recaptchaKeyV3:u,recaptchaKeyV2:p}=tr((e=>({currentUser:e.currentUser,selectedTeamId:e.teams.selectedTeamId,recaptchaKeyV3:e.config.RECAPTCHA_V3_SITEKEY,recaptchaKeyV2:e.config.RECAPTCHA_V2_SITEKEY})),ar),{token:h,user:{_id:g}}=d,[y,f]=r.exports.useState(!1),E=r.exports.useRef(),[v,w]=r.exports.useState(!1),[b,_]=r.exports.useState([]),T=r.exports.useContext(pde),S=T.exists,I=b.some((e=>!1===e.isValid)),x=e=>{var t;for(const a of null!=(t=null==s?void 0:s.users)?t:[])if(e===a.email)return!0;return!1},k=e=>Mf(e)&&!x(e),C=()=>{var t;s&&tE({teamId:s._id,inviterEmail:null==(t=null==d?void 0:d.user)?void 0:t.email,origin:e,shareType:"copy link"})},A=async()=>{var t;if(b.length>0){const r=b.map((e=>({...e,isValid:!e.email||k(e.email)})));if(r.some((e=>!e.isValid)))return _(r),!1;const i=r.filter((e=>e.email&&!e.invited)).map((e=>e.email));i.length&&(w(!0),await(async e=>{var t;if(e.length<=0)return;if(v)return void o(Su({description:"Please wait for pending sent emails to load first.",type:"error"}));if(!n)return void o(Su({description:"Recaptcha has not been loaded. Please wait a few seconds and try again.",type:"error"}));const r=await n("teamInvite"),i=null==(t=E.current)?void 0:t.getValue(),l={emails:e,token:h,teamId:null==s?void 0:s._id,v3CaptchaToken:r,v2CaptchaToken:i,recaptchaKeyV3:u,recaptchaKeyV2:p};if(window.Cypress){try{await gu("/api/v1/invites/teams",{body:{emails:e,token:h,userId:g,teamId:"641b74d390ea88312c239c0b",cypress:!0}})}catch(YEe){console.error(YEe)}return o(Su({description:"Invites were sent successfully",type:"success"})),void(a&&a([{_id:"randomId",email:"testinvite@kapwing.com"}]))}try{const t=await gu("/api/v1/invites/teams",{body:l});if(o(Su({description:"Invites were sent successfully",type:"success"})),_(b.map((({email:t,isValid:a,invited:o})=>({email:t,isValid:a,invited:o?!!o:e.includes(t)})))),t.notifError&&(o(Su({description:"Invites created but there was an error sending the notifications",type:"warning"})),console.error(`Error sending team invite notifications: ${t.notifError}`)),a){const e=await RE(s._id);a(e.invites)}}catch(YEe){zf(YEe)&&f(!0),Iu({description:"An error has occurred when sending invites!",error:YEe})}})(i),w(!1),s&&tE({teamId:s._id,inviterEmail:null==(t=null==d?void 0:d.user)?void 0:t.email,origin:e,shareType:"send email"}))}return!0},N=async e=>{null==e||e.preventDefault(),await A()&&(S?T.goToNextModal():t())},P=()=>i.createElement("div",{className:mde.modalWithImageContainer,"data-cy":"add-members-modal"},i.createElement("div",{className:mde.left},i.createElement("div",{className:`${mde.header} ${mde.textOverflowEllipsis}`},"Add Members to: ",null==s?void 0:s.name),i.createElement("p",null,"Team members will gain access to all projects in Team Folders and your Brand Kit. Manage member roles and permissions in your"," ",i.createElement("a",{href:`/team/${c}/members`},"Settings.")),!l.isFree&&!sde(s)&&i.createElement(ude,null),i.createElement("form",{className:mde.form,onSubmit:N},i.createElement(Tde,{emails:b,setEmails:_,emailsPlaceholder:"name@company.com",validateInviteEmail:k,emailExists:x}),i.createElement(Lde,{teamId:c,onCopy:C,disabled:!s.settings.inviteByLink}),S?i.createElement(hde,{primaryButtonDisabled:I,primaryButtonText:"Next",onClick:N}):i.createElement(s9,{className:`${mde.modalPrimaryButton} ${v||I?mde.disabled:""}`,onClick:N,testId:"continue-button",buttonText:v?i.createElement(dde,null):"Invite Members"}))),i.createElement("div",{className:mde.right,style:{backgroundImage:'url(\n            "https://cdn-useast1.kapwing.com/static/zS3-invite-members-modal.webp"\n          )'}}),i.createElement("div",{className:`${mde.exit} ${mde.dark}`,onClick:S?T.onClose:t},i.createElement(pe,null)));return S?i.createElement(i.Fragment,null,y&&i.createElement(ve,{sitekey:p,ref:E}),P()):i.createElement(_O,{noCloseButton:!1,usePortal:!0,noScrollBar:!0,noPadding:!0,unsetCancelModal:t},y&&i.createElement(ve,{sitekey:p,ref:E}),P())},Ode="LogoUpload-module_logoContainer_PFAev",Fde="LogoUpload-module_replaceLogoButton_56dvm",Mde="LogoUpload-module_updating_pMm5U",Ude="LogoUpload-module_logoUploadContainer_xjrlc",Bde="LogoUpload-module_defaultLogosText_hvAqu",Wde="LogoUpload-module_defaultLogos_gIK9X",Vde="LogoUpload-module_logoWrapper_BwCK0",jde=({entryPoint:e,hasPermission:t=!0})=>{const a=m.exports.useDispatch(),o=id(),[n,s]=r.exports.useState(!1),[l,d]=r.exports.useState(null==o?void 0:o.picture),c=async e=>{const t=null==e?void 0:e[0];if(t&&o&&(e=>{const t=e[0];if(!t)return!1;const o=aF(t);return!!(null==o?void 0:o.includes("image"))||(a(Su({description:`Your file type ${o} is not supported. Please upload an image.`,type:"error"})),!1)})(e)){const e=`team_assets/${o.name}-${z.v4()}-${t.name}`,a=new File([t],e,{type:t.type});u(a)}},u=async t=>{s(!0);try{await AE(t,o._id),await a(jE()),a(LE(o._id)),vc("Added Workspace Logo",{Origin:e}),d(t.name)}catch(YEe){Iu({description:"There was an error updating your logo. Please try again.",error:YEe})}finally{s(!1)}},p=()=>i.createElement("div",{className:Ode},n?i.createElement("div",{className:Mde},"Updating..."):i.createElement(SQ,{suggestedWidth:120,suggestedHeight:120,team:o}),t&&i.createElement("div",{className:Fde,onClick:()=>d(void 0),"data-testid":"logo-remove-button","data-cy":"logo-remove-button"},i.createElement(pe,null)));return t?l||n?p():i.createElement("div",{className:Ude,"data-testid":"logo-upload","data-cy":"logo-upload"},i.createElement(tle,{handleMultiFileUpload:c,acceptedFileTypes:PF({logoUpload:!0}),multiple:!0}),i.createElement("div",{className:Bde},"Or, select an icon from our sample library:"),i.createElement("div",{className:Wde,"data-testid":"default-logos"},ni.map(((e,t)=>i.createElement("div",{className:Vde,onClick:()=>(async e=>{const t=await fetch(e).then((e=>e.blob())),n=`team_assets/${o.name}-${z.v4()}-${e}`,r=new File([t],n,{type:t.type});a({type:"UPDATE_TEAM_LOGO",id:o._id,picture:e}),d(e),await AE(r,o._id),await GE()})(e),style:{backgroundImage:`url(${e})`},key:t}))))):p()},Gde={home:"Team-module_home_9Lybd",homeHowBackgroundWhite:"Team-module_homeHowBackgroundWhite_n8imj",largeButton:"Team-module_largeButton_Jnrfp",sectionContent:"Team-module_sectionContent_kEdU-",sectionHeader:"Team-module_sectionHeader_BuUSv",spacer:"Team-module_spacer_SAgVv",chevron:"Team-module_chevron_lEUW7",splashText:"Team-module_splashText_m2qf6",splashSubtext:"Team-module_splashSubtext_-2EHm",aboutSection:"Team-module_aboutSection_jf8PD",mobile:"Team-module_mobile_JTOsw",desktop:"Team-module_desktop_ZE7i5",screenReaderOnlyLabel:"Team-module_screenReaderOnlyLabel_PT6eb",disabled:"Team-module_disabled_8vItG",noScrollBar:"Team-module_noScrollBar_t3Wy0",textOverflowEllipsis:"Team-module_textOverflowEllipsis_HELwI",genericButtonBlue:"Team-module_genericButtonBlue_1u-wX",tooltip:"Team-module_tooltip_MWVES",tooltipBubble:"Team-module_tooltipBubble_GSKAY",permissionsTooltip:"Team-module_permissionsTooltip_f3mho",tooltipTextBottomAlignRight:"Team-module_tooltipTextBottomAlignRight_sWAK-",tooltipTextBottomAlignLeft:"Team-module_tooltipTextBottomAlignLeft_tJB7T",tooltipTextSlightTop:"Team-module_tooltipTextSlightTop_g2yQV",tooltipTextTop:"Team-module_tooltipTextTop_vZH6G",keyboardShortcut:"Team-module_keyboardShortcut_6bGY1",keyboardShortcutWithOutline:"Team-module_keyboardShortcutWithOutline_dv3R-",defaultFont:"Team-module_defaultFont_PnVVr",subItem:"Team-module_subItem_ufTH6",fullWidthSubItem:"Team-module_fullWidthSubItem_hybxr",contentContainer:"Team-module_contentContainer_elU1F",sectionWrapper:"Team-module_sectionWrapper_iPHqF",inviteSection:"Team-module_inviteSection_2lgES",openSeats:"Team-module_openSeats_vwzQ-",inviteText:"Team-module_inviteText_o6ePO",pendingInviteSection:"Team-module_pendingInviteSection_mZWzh",sectionContainer:"Team-module_sectionContainer_agcEv",secondaryButton:"Team-module_secondaryButton_3kpZR",leftSecondaryButton:"Team-module_leftSecondaryButton_SM4qc",tabContainer:"Team-module_tabContainer_rCoCl",tabHeader:"Team-module_tabHeader_Y-Xvr",selectedTab:"Team-module_selectedTab_SjwLF",inlineBtnContainer:"Team-module_inlineBtnContainer_y9NDG",membersContainer:"Team-module_membersContainer_gIWxV",profileImage:"Team-module_profileImage_Pkaaw",fullName:"Team-module_fullName_DqYcU",email:"Team-module_email_MQyBY",role:"Team-module_role_6-MCd",roleOption:"Team-module_roleOption_xG-VE",pendingRole:"Team-module_pendingRole_gyNLg",roleTitle:"Team-module_roleTitle_ElFzU",requestControlButtons:"Team-module_requestControlButtons_jKYiu",requestButton:"Team-module_requestButton_ZZmsF",hotpink:"Team-module_hotpink_eFj7B",blue:"Team-module_blue_28JqR",closeIcon:"Team-module_closeIcon_k3Fww",removeIcon:"Team-module_removeIcon_-r-u-",removeButton:"Team-module_removeButton_FY7uw",disabledTab:"Team-module_disabledTab_Qa94M",dropdownWrapper:"Team-module_dropdownWrapper_v3Owp",inviteMembersButtonContainer:"Team-module_inviteMembersButtonContainer_AJwS-",inviteMembersButton:"Team-module_inviteMembersButton_Hstc7",discoverabilityDropdown:"Team-module_discoverabilityDropdown_j9-48",header:"Team-module_header_gZdQw",copy:"Team-module_copy_-qOH1",radioSubHeader:"Team-module_radioSubHeader_2py9R",radioCopy:"Team-module_radioCopy_kcmAi",previewContainer:"Team-module_previewContainer_IwBzd",optionContainer:"Team-module_optionContainer_DGyHl",selected:"Team-module_selected_QDFTs",dropdownOptions:"Team-module_dropdownOptions_0pO79"},Hde="TeamMemberControls-module_loadingDiscoverabilityContainer_Ku49k",zde="TeamMemberControls-module_loadingDiscoverabilityText_UqTLn",$de=()=>{var e,t,a;const o=m.exports.useDispatch(),n=id(),[s,l]=r.exports.useState(null==(e=n.settings)?void 0:e.discoverability),[d,c]=r.exports.useState(""),[u,p]=r.exports.useState(!1),h={[wn.AlwaysInvitationOnly]:{header:"Invitation only",copy:"Only users who have been invited with a link or email can find and join this workspace when they log in.",discoverabilitySetting:wn.AlwaysInvitationOnly},[wn.InvitationOnly]:{header:"Invitation only",copy:"Only users who have been invited with a link or email can find and join this workspace when they log in.",discoverabilitySetting:wn.InvitationOnly},[wn.RequestToJoin]:{header:`Anyone at ${null!=(t=n.emailDomain)?t:"your email domain"} can request to join`,copy:"Only users in your domain can find your workspace when they log in. They can request to join but need approval from an admin.",discoverabilitySetting:wn.RequestToJoin},[wn.AnyoneCanJoin]:{header:`Anyone at ${null!=(a=n.emailDomain)?a:"your email domain"} can join`,copy:"Only users in your domain can find your workspace when they log in. They can join your workspace without approval.",discoverabilitySetting:wn.AnyoneCanJoin}},g=[h[0],h[1],h[2]];if(r.exports.useEffect((function(){void 0===s&&(async()=>{const e=await ZE(n._id,wn.RequestToJoin);e.discoverability&&(l(e.discoverability),await o(GE()))})()}),[]),void 0===s)return null;if(s===wn.AlwaysInvitationOnly)return i.createElement("div",{"data-testid":"discoverability-settings"},i.createElement("div",{className:Gde.header},"Invitation Only"),i.createElement("div",{className:Gde.copy},"Only users with an invite link or email can join this workspace"));const y=async e=>{p(!1),l(e),await ZE(n._id,e),c("Updated discoverability!"),setTimeout((()=>{c("")}),2e3)},f=({...e})=>i.createElement(Fa.ValueContainer,{...e},i.createElement("div",{className:Gde.previewContainer,onClick:()=>p((e=>!e))},i.createElement("div",{className:Gde.header},h[s].header,u?i.createElement(Ma,null):i.createElement(Ua,null)),i.createElement("div",{className:Gde.copy},h[s].copy))),E=e=>i.createElement("div",{id:`discoverability-radio-button-${e.discoverabilitySetting}`,className:`${Gde.optionContainer} ${s===e.discoverabilitySetting?Gde.selected:""}`,onClick:()=>(async e=>{e.discoverabilitySetting===wn.AnyoneCanJoin?(await y(e.discoverabilitySetting),await GE()):await y(e.discoverabilitySetting)})(e)},i.createElement("div",{className:Gde.header},e.header),i.createElement("div",{className:Gde.copy},e.copy)),v={control:()=>({}),option:()=>({}),menu:e=>({...e,maxWidth:"700px"}),menuList:()=>({}),indicatorSeparator:()=>({display:"none"}),menuPortal:e=>({...e}),dropdownIndicator:()=>({display:"none"}),valueContainer:()=>({padding:0})};return i.createElement("div",{"data-testid":"discoverability-settings"},i.createElement(Oa,{value:h[s],options:g,formatOptionLabel:E,styles:v,menuIsOpen:u,menuPlacement:"auto",isSearchable:!1,components:{ValueContainer:f},controlShouldRenderValue:!1}),d&&i.createElement("div",{className:Hde},i.createElement("span",{className:zde},d)))},Kde="CustomizeWorkspaceModal-module_textOverflowEllipsis_gtPCe",Yde="CustomizeWorkspaceModal-module_previewContainer_XHrGZ",qde="CustomizeWorkspaceModal-module_container_LYinw",Xde="CustomizeWorkspaceModal-module_sidebar_xA35h",Jde="CustomizeWorkspaceModal-module_logo_XCNcl",Qde="CustomizeWorkspaceModal-module_placeholder_eeViF",Zde="CustomizeWorkspaceModal-module_app_h9vIO",ece="CustomizeWorkspaceModal-module_header_pHkXZ",tce="CustomizeWorkspaceModal-module_teamInfo_w79--",ace="CustomizeWorkspaceModal-module_name_0Efjh",oce="CustomizeWorkspaceModal-module_members_AWZAo",nce="CustomizeWorkspaceModal-module_filler_XhQiO",rce="CustomizeWorkspaceModal-module_group1_2VCDw",ice="CustomizeWorkspaceModal-module_one_nSfYi",sce="CustomizeWorkspaceModal-module_two_USP6M",lce="CustomizeWorkspaceModal-module_three_M0tql",dce="CustomizeWorkspaceModal-module_darkGray_89UNg",cce="CustomizeWorkspaceModal-module_divider_JCGsl",uce="CustomizeWorkspaceModal-module_group2_RK4Sq",mce="CustomizeWorkspaceModal-module_four_p4rU1",pce="CustomizeWorkspaceModal-module_five_BIc4n",hce="CustomizeWorkspaceModal-module_six_INIBz",gce=({entryPoint:e,onClose:t=(()=>{})})=>{const a=m.exports.useDispatch(),{isQualifiedLead:o,currentUser:n}=tr((e=>{var t;return{currentUser:e.currentUser,isQualifiedLead:null==(t=e.workspaces.suggestedWorkspaces)?void 0:t.isQualifiedLead}}),ar),s=id(),[l,d]=r.exports.useState("My Workspace"===s.name?"":s.name),c=r.exports.useContext(pde);r.exports.useEffect((()=>{lv(e)}),[e]);const u=c.exists,p=e=>{d(e.target.value)},h=e=>{""===e.target.value&&d(xE(n.user.firstName,o,s.emailDomain))},g=async()=>{await(async()=>{if(l!==(null==s?void 0:s.name))try{const t=""===l?xE(n.user.firstName,o,s.emailDomain):l;a(FE(s._id,t)),a($E(s._id,{name:t})),t!==xE(n.user.firstName,o,s.emailDomain)&&oE(e)}catch(YEe){Iu({description:"Couldn't update team name.",error:YEe})}})()},y=async e=>{null==e||e.preventDefault(),await g(),u?c.goToNextModal():t()},f=()=>i.createElement("div",{className:mde.modalWithImageContainer,"data-cy":"customize-workspace-modal","data-testid":"customize-workspace-modal"},i.createElement("div",{className:mde.left},i.createElement("div",{className:mde.header},"Customize Your Team Workspace"),i.createElement("form",{className:mde.form,onSubmit:y},i.createElement(i.Fragment,null,i.createElement("label",{className:mde.inputLabel,htmlFor:"new-team-name"},"Name your workspace"),i.createElement("input",{id:"new-team-name",type:"text",className:mde.textInput,value:l||"",onChange:p,onBlur:h,placeholder:xE(n.user.firstName,o,s.emailDomain),autoFocus:!0,required:!0,"data-testid":"new-team-name-input"})),i.createElement(i.Fragment,null,i.createElement("label",{className:mde.inputLabel,htmlFor:"upload-logo"},"Set your workspace icon",i.createElement("div",{className:mde.secondary},"This helps future members recognize your workspace")),i.createElement("div",{className:mde.uploadLogoContainer},i.createElement(jde,{entryPoint:e}))),o&&i.createElement("div",{className:mde.mTop32},i.createElement("label",{className:mde.inputLabel,htmlFor:"upload-logo"},"Set who can discover your team workspace"),i.createElement("div",{className:mde.mTop16},i.createElement($de,null))),u?i.createElement(hde,{onClick:y}):i.createElement(s9,{className:mde.modalPrimaryButton,onClick:()=>y(),testId:"customize-workspace-modal-confirm-button",buttonText:"Update Team"}))),i.createElement("div",{className:`${mde.right} ${Yde}`},i.createElement("div",{className:qde},i.createElement("div",{className:Xde},i.createElement(SQ,{team:s,className:Jde}),i.createElement("div",{className:Qde}),i.createElement("div",{className:Qde})),i.createElement("div",{className:Zde},i.createElement("div",{className:ece},i.createElement(SQ,{team:s,className:Jde}),i.createElement("div",{className:tce},i.createElement("div",{className:ace},i.createElement("div",{className:Kde},l||"Your Team Name")),i.createElement("div",{className:oce},i.createElement("div",null),i.createElement("span",null,"Members")))),i.createElement("div",{className:nce},i.createElement("div",{className:rce},i.createElement("div",{className:ice}),i.createElement("div",{className:sce}),i.createElement("div",{className:lce})),i.createElement("div",{className:dce}),i.createElement("div",{className:cce}),i.createElement("div",{className:uce},i.createElement("div",{className:ice}),i.createElement("div",{className:sce}),i.createElement("div",{className:lce}),i.createElement("div",{className:mce}),i.createElement("div",{className:pce}),i.createElement("div",{className:hce})))))),i.createElement("div",{className:`${mde.exit} ${mde.light}`,onClick:u?c.onClose:t},i.createElement(pe,null)));return u?f():i.createElement(_O,{noCloseButton:!0,usePortal:!0,noScrollBar:!0,noPadding:!0,unsetCancelModal:t},f())},yce="SuggestedWorkspacesModal-module_teamName_v3IDk",fce="SuggestedWorkspacesModal-module_numberCount_brjkW",Ece="SuggestedWorkspacesModal-module_teamContainer_D-e6v",vce="SuggestedWorkspacesModal-module_teamNameContainer_-CcXn",wce="SuggestedWorkspacesModal-module_center_OEdRQ",bce="SuggestedWorkspacesModal-module_primaryButton_z8bm2",_ce="SuggestedWorkspacesModal-module_secondaryButton_5iMey",Tce="SuggestedWorkspacesModal-module_tertiaryButton_mDz6U",Sce="SuggestedWorkspacesModal-module_profilePicture_0kb8H",Ice="SuggestedWorkspacesModal-module_pendingInvites_A-gge",xce="SuggestedWorkspacesModal-module_suggestedWorkspaces_YLvRg",kce=({team:e,buttonAction:t,isRequest:a})=>{const[o,n]=r.exports.useState("");r.exports.useEffect((function(){var t;if(a){switch(null==(t=e.settings)?void 0:t.discoverability){case wn.AnyoneCanJoin:n("Join now");break;case wn.InvitationOnly:break;case wn.RequestToJoin:default:n("Ask to join")}}else n("Accept invite")}),[]);return i.createElement("div",{className:Ece},i.createElement(SQ,{className:Sce,team:e,absoluteHeight:40,absoluteWidth:40})," ",i.createElement("div",{className:`${vce} ${e.numberOfUsers?"":wce}`},i.createElement("div",{className:yce},e.name),i.createElement("div",{className:fce},e.numberOfUsers?`${e.numberOfUsers} ${Qs("Member","Members",e.numberOfUsers)}`:"")),i.createElement("div",{className:`${(()=>{switch(o){case"Ask to join":return _ce;case"Request sent":return Tce;default:return bce}})()}`,onClick:()=>{"Request sent"!==o&&(t(),"Ask to join"===o&&n("Request sent"))}},"Request sent"===o&&i.createElement(Ba,null),o))},Cce=({exitOverlay:e=(()=>{})})=>{const t=m.exports.useDispatch(),{userTeamInvites:a,suggestedTeams:o,currentUser:n,currentTeam:s,selectedTeamId:l,suggestedWorkspaces:d,onboardingSurveyUsage:c,allTeams:u,pendingInvites:p,isQualifiedLead:h}=tr((e=>{var t,a,o,n,r;return{userTeamInvites:e.teams.userTeamInvites,suggestedTeams:null==(t=e.workspaces.suggestedWorkspaces)?void 0:t.teams,currentUser:e.currentUser,currentTeam:nd(e),selectedTeamId:e.teams.selectedTeamId,suggestedWorkspaces:e.workspaces.suggestedWorkspaces,onboardingSurveyUsage:null==(n=null==(o=null==(a=e.currentUser)?void 0:a.user.onboarding)?void 0:o.survey)?void 0:n.usage,allTeams:e.teams.allTeams,pendingInvites:e.teams.userTeamInvites,isQualifiedLead:null==(r=e.workspaces.suggestedWorkspaces)?void 0:r.isQualifiedLead}}),ar),g=r.exports.useContext(pde),y=g.exists;r.exports.useEffect((function(){o||XP(),mv({numPendingInvites:p?p.length:0,suggestedWorkspaces:d,entryPoint:pv.Onboarding,isQualifiedLead:h})}),[]),r.exports.useEffect((()=>{(async()=>{try{t(HE())}catch(YEe){Iu({description:"There was a problem fetching your invites. Please try again later.",error:YEe})}})()}),[t]);const f=()=>i.createElement(i.Fragment,null,i.createElement("div",{className:mde.inputLabel},"Pending Invites:"),i.createElement("div",{"data-testid":"sw-pending-invites-section",className:Ice},null==a?void 0:a.map((e=>i.createElement(kce,{key:e.team._id,team:e.team,buttonAction:()=>{(async e=>{var o;const{token:r,user:i}=n||{},{_id:s}=i||{},d={token:r,userId:s,inviteKey:e.inviteKey};try{const r=await gu("/api/v1/invites/teams/accept",{body:d});if(r.teamId){const i=`${l}`;t(Su({description:"Invite accepted.",type:"success"})),t(OE([...a].filter((t=>t._id!==e._id)))),await t(jE()),t(LE(r.teamId)),await CQ(r.teamId);const s=nd();s&&Qf(n.user,e.inviterEmail,n.email,"Suggested Workspaces Modal",s);const d=u.find((e=>e._id===i));$f()&&1===(null==(o=null==d?void 0:d.users)?void 0:o.length)&&t(YE(i))}}catch(c){Iu({description:"There was an issue joining the team, please try again",error:c})}})(e),t(Hv(Jv.None))}}))))),E=()=>{const e=o[0];return i.createElement(i.Fragment,null,i.createElement("div",{className:mde.inputLabel},"Suggested workspaces",e&&e.emailDomain?` for @${e.emailDomain}`:""),i.createElement("div",{"data-testid":"sw-suggested-teams-section",className:xce},null==o?void 0:o.map((e=>i.createElement(kce,{key:e._id,team:e,buttonAction:()=>{var a,o,r;(null==(a=e.settings)?void 0:a.discoverability)!==wn.RequestToJoin&&(null==(o=e.settings)?void 0:o.discoverability)||((async e=>{await $P(e)})(e._id),hv(pv.Onboarding,e._id,n)),(null==(r=e.settings)?void 0:r.discoverability)===wn.AnyoneCanJoin&&((async e=>{try{if(!(await gu(`/api/v2/teams/${e}/join`)).success)throw new Error;t(Hv(Jv.None)),$f()&&1===(null==s?void 0:s.users.length)&&await t(YE(l)),t(Su({description:"Successfully joined team.",type:"success"})),t(jE()),t(LE(e)),await CQ(e)}catch(a){Iu({description:"Something went wrong with joining the team, please try again later.",error:a})}})(e._id),t(Hv(Jv.None)))},isRequest:!0})))))},v=()=>{((e,t)=>{const{numAskToJoin:a,numOpenToJoin:o}=uv(t);vc("Dismiss Suggested Workspaces",{Domain:t.teams[0]?t.teams[0].emailDomain:"","Number Invite Workspaces":e,"Number Suggested Workspaces - Ask to Join":a,"Number Suggested Workspaces - Open to Join":o})})(a?a.length:0,null!=d?d:{teams:[],isQualifiedLead:!1}),y?g.goToNextModal():e()},w=()=>i.createElement("div",{className:mde.modalWithImageContainer},i.createElement("div",{className:mde.left},i.createElement("div",{className:mde.header},"Join your team workspace"),i.createElement("p",null,"Make collaboration easier when you store projects in the same workplace and share feedback with your team in real time"),a.length>0&&f(),(null==o?void 0:o.length)&&c!==yn.School&&E(),y?i.createElement(hde,null):i.createElement(s9,{className:mde.modalPrimaryButton,onClick:v,buttonText:"Continue"})),i.createElement("div",{className:mde.right,style:{backgroundImage:'url(\n            "https://cdn-useast1.kapwing.com/static/2qE-suggested-workspaces-modal.webp"\n          )'}}),i.createElement("div",{className:`${mde.exit} ${mde.dark}`,onClick:y?g.onClose:v},i.createElement(pe,null)));return y?w():i.createElement(_O,{unsetCancelModal:()=>{v()},usePortal:!0,noScrollBar:!0,noPadding:!0,style:{maxWidth:730}},w())},Ace="Ex: CEO",Nce="Ex: I want to collab on videos with my team",Pce="Ex: I'm creating podcasts",Rce="other (please specify below)",Lce=[...dl([{value:"hr",label:"HR"},{value:"marketing",label:"Marketing"},{value:"communications",label:"Communications"},{value:"media production",label:"Media Production"},{value:"creative agency",label:"Creative Agency"},{value:"sales",label:"Sales"},{value:"self-employed/freelance video creator",label:"Self-employed/Freelance Video Creator"}]),{value:"other (please specify below)",label:"Other (please specify below)"}],Dce=[{value:"student",label:"Student"},{value:"teacher",label:"Teacher"},{value:"admin or district leader",label:"Admin or District Leader"}],Oce=[...dl([{value:"I want to learn how to edit videos",label:"I want to learn how to edit videos"},{value:"I need an easier way to create content faster",label:"I need an easier way to create content faster"},{value:"I need to make content to sell more of my products/services",label:"I need to make content to sell more of my products/services"},{value:"I need my content and posts to be more engaging",label:"I need my content and posts to be more engaging"}]),{value:"other (please specify below)",label:"Other (please specify below)"}],Fce=[...dl([{value:"I'm creating videos from scratch",label:"I'm creating videos from scratch"},{value:"I'm repurposing my existing videos for other social media platforms",label:"I'm repurposing my existing videos for other social media platforms"},{value:"I'm creating images or GIFs",label:"I'm creating images or GIFs"}]),{value:"other (please specify below)",label:"Other (please specify below)"}],Mce=[...dl([{value:"Email",label:"Email"},{value:"YouTube",label:"YouTube"},{value:"Search engine (Google, Bing, etc.)",label:"Search engine (Google, Bing, etc.)"},{value:"Friend or co-worker",label:"Friend or co-worker"},{value:"Blog post or article",label:"Blog post or article"},{value:"TikTok",label:"TikTok"},{value:"Twitter",label:"Twitter"},{value:"LinkedIn",label:"LinkedIn"},{value:"Saw the watermark",label:"Saw the watermark"}]),{value:"other (please specify below)",label:"Other (please specify below)"}],Uce=150,Bce=250,Wce={control:e=>({...e,background:"white",cursor:"pointer"}),singleValue:e=>({...e,fontFamily:"Open Sans",fontStyle:"normal",fontWeight:"normal",fontSize:"14px",color:"black"}),indicatorSeparator:()=>({display:"none"}),option:(e,{isFocused:t})=>({...e,fontFamily:"Open Sans",fontStyle:"normal",fontWeight:"normal",fontSize:"14px",color:t?"white":"black",textAlign:"left",backgroundColor:t?"#0083e2":""}),menuPortal:e=>({...e,zIndex:100})},Vce=e=>({...e,colors:{...e.colors,primary:"#1fa2ff",primary50:"#1fa2ff"}}),jce=async(e,t,a,o,n,r,i,s,l)=>{const d=t.toLowerCase(),c=a.toLowerCase();((e,t,a,o,n,r,i)=>{const{state:s}=tn(),{currentUser:l}=s||{},{user:d}=l||{},{_id:c}=d||{},u={Usage:e,Occupation:t,"Project Usage":a,"User Goal":o,"Occupation Custom Response":n,"Project Usage Custom Response":r,"User Goal Custom Response":i};vc("Completed Onboarding Survey",u),c&&amplitude.getInstance().setUserId(c),amplitude.getInstance().setUserProperties(u)})(e,d,c,o.toLowerCase(),i,s,l),await async function(e,t){const{user:a}=t;if(!a._id)return;await gu("/api/v1/users/updateProfile/onboarding",{body:{onboarding:e},parseJSON:!1})}({...n||{},survey:{usage:e,occupation:d,projectUsage:c,date:new Date}},r),vf()};const Gce=({onClose:e})=>{const t=tr((e=>e.currentUser)),[a,o]=r.exports.useState(""),[n,s]=r.exports.useState(""),l=Si(),d=r.exports.useContext(pde);r.exports.useEffect((function(){vc("Begin how did you hear about us")}),[]);const c=document.querySelector(".app-container");if(!c){const e="Couldn't find .app-container to mount OnboardingDialog to.";return sl()?console.error(`${e} ${ll}`):console.error(e),null}const u=d.exists,m=async e=>{null==e||e.preventDefault(),((e,t)=>{const{state:a}=tn(),{currentUser:o}=a||{},{user:n}=o||{},{_id:r}=n||{},i={"Discovery Path":e,"Custom Response":t};r&&amplitude.getInstance().setUserId(r),amplitude.getInstance().setUserProperties(i),vc("Completed how did you hear about us",i)})(a,n),d.goToNextModal()},p=()=>i.createElement("div",{className:mde.modalWithImageContainer,"data-cy":"how-did-you-hear-about-us-modal"},i.createElement("div",{className:mde.left},i.createElement("div",{className:mde.header},"We're happy you're here"+((null==t?void 0:t.name)?`, ${t.name}`:".")),i.createElement("p",null,"You’re about to create content, quicker and easier. One last thing before we customize your workspace:"),i.createElement("div",null,i.createElement("div",{className:mde.inputLabel},"How did you hear about us?"),i.createElement(Oa,{"aria-label":"discovery-path-dropdown",onChange:e=>{o(e.value)},styles:Wce,options:Mce,placeholder:"",theme:e=>Vce(e),isSearchable:!l,maxMenuHeight:l?150:250,menuPortalTarget:c})),a===Rce&&(a===Rce?i.createElement("input",{className:mde.input,type:"text",name:"Discovery Path Custom Response",placeholder:"",value:n,onChange:({target:e})=>{s(e.value)},autoComplete:"do-not-autocomplete"}):null),i.createElement("form",{className:mde.form,onSubmit:m},i.createElement(s9,{className:mde.modalPrimaryButton,onClick:()=>m(),testId:"how-did-you-hear-about-us-continue-button",buttonText:"Continue"}))),i.createElement("div",{className:mde.right,style:{backgroundImage:'url(\n            "https://cdn-useast1.kapwing.com/static/nij-how-did-you-hear-about-us-modal.webp"\n          )'}}),i.createElement("div",{className:`${mde.exit} ${mde.dark}`,onClick:u?d.onClose:e},i.createElement(pe,null)));return u?i.createElement(i.Fragment,null,p()):i.createElement(_O,{noCloseButton:!1,usePortal:!0,noScrollBar:!0,noPadding:!0},p())},Hce=({onClose:e})=>{const t=tr((e=>e.workspaces.showOnboardingUpsell)),a=HU();let o=[];return t!==Jv.School&&t!==Jv.None&&t?(o=t===Jv.SuggestedWorkspaces?[{modal:i.createElement(Gce,null)},{modal:i.createElement(Cce,{exitOverlay:e})},{modal:i.createElement(gce,{entryPoint:eE.USER_ONBOARDING}),onNext:sv},{modal:i.createElement(Dde,{entryPoint:eE.USER_ONBOARDING})}]:[{modal:i.createElement(Gce,null),onNext:lv},{modal:i.createElement(gce,{entryPoint:eE.USER_ONBOARDING}),onNext:sv},{modal:i.createElement(Dde,{entryPoint:eE.USER_ONBOARDING})}],i.createElement(_O,{noCloseButton:!0,usePortal:!0,noScrollBar:!0,noPadding:!0,unsetCancelModal:e},i.createElement(gde,{modalSteps:o,onClose:e,onFlowDismissed:()=>a((()=>{}),{action:Rs.ONBOARDING_SURVEY})(),onFlowComplete:()=>{vc("Completed Onboarding Flow"),a((()=>{}),{action:Rs.ONBOARDING_SURVEY})()}}))):null},zce="CreateFolderModal-module_background_295bd",$ce="CreateFolderModal-module_contentContainer_5KSAF",Kce="CreateFolderModal-module_mainContent_Ui0LH",Yce="CreateFolderModal-module_inputLabel_zks-r",qce="CreateFolderModal-module_header_Hjfkx",Xce="CreateFolderModal-module_closeContainer_-R3ri",Jce="CreateFolderModal-module_buttonsContainer_uUsA0",Qce="CreateFolderModal-module_textInput_rYUva",Zce="CreateFolderModal-module_form_VAeB5";class eue extends r.exports.Component{constructor(e){super(e),a(this,"handleSubmit",(async()=>{const{folderType:e}=this.props,{newFolderName:t}=this.state,a=(await hP(t,e))._id;this.setState({newFolderId:a}),this.hide()})),a(this,"hide",(()=>{const{history:e,hide:t}=this.props,{newFolderId:a,sending:o}=this.state;o||(t(),a&&e.push(`/folder/${a}`))})),a(this,"handleNameChange",(e=>{this.setState({newFolderName:e.target.value})})),this.state={sending:!1,newFolderId:null,newFolderName:""}}innerContent(){const{sending:e}=this.state;return i.createElement("label",{className:Yce},i.createElement("form",{onSubmit:e=>{e.preventDefault(),this.handleSubmit()},className:Zce},i.createElement("input",{type:"text",className:Qce,value:this.state.newFolderName||"",onChange:this.handleNameChange,placeholder:"Untitled Folder",readOnly:e,autoFocus:!0,"data-cy":"new-workspace-input"})))}render(){const{sending:e}=this.state;return i.createElement(i.Fragment,null,i.createElement("div",{className:zce,onClick:this.hide}),i.createElement("div",{className:$ce},i.createElement("div",{className:Kce,"data-testid":this.props.folderType===Jr.personal?"workspace-create-folder-modal-personal":"workspace-create-folder-modal-team"},i.createElement("div",{className:qce},"Create a New Folder",i.createElement("div",{className:Xce,onClick:this.hide},i.createElement(pe,null))),this.innerContent()),i.createElement("div",{className:Jce},i.createElement(iO,{confirmFn:this.handleSubmit,loadingMsg:e?"Loading...":void 0,confirmText:"Finish",cancelText:"Back",cancelFn:void 0}))))}}const tue=we(m.exports.connect((e=>({allWorkspaces:e.workspaces.allWorkspaces,currentUser:e.currentUser,selectedTeamId:e.teams.selectedTeamId})))((({...e})=>{const t=".app-container",a=document.querySelector(t);return a?he.createPortal(i.createElement(eue,{...e}),a):(console.error(`Expected ${t} to exist in the DOM`),i.createElement(eue,{...e}))}))),aue="WorkspaceSideBar-module_tooltip_QieiF",oue="WorkspaceSideBar-module_addNewFolderToolTip_iz2SR",nue="WorkspaceSideBar-module_folderHeaderToolTip_gMbh-",rue="WorkspaceSideBar-module_scrollableContainer_lse77",iue="WorkspaceSideBar-module_sideBarContainer_tdEkP",sue="WorkspaceSideBar-module_sidenavSubitem_2J31m",lue="WorkspaceSideBar-module_sharedHeader_-4Bqy",due="WorkspaceSideBar-module_selSidenavSubitem_qKRsu",cue="WorkspaceSideBar-module_sideHeader_Oh4sm",uue="WorkspaceSideBar-module_sideHeaderCopy_d7Yds",mue="WorkspaceSideBar-module_lightgray_kUExU",pue="WorkspaceSideBar-module_moreSideHeader_bJdTm",hue="WorkspaceSideBar-module_hideOnShortScreens_iqzf8",gue="WorkspaceSideBar-module_selectedHeader_6R-17",yue="WorkspaceSideBar-module_sharedHeaderText_RkyE-",fue="WorkspaceSideBar-module_svgContainer_Q1UeI",Eue="WorkspaceSideBar-module_svgIcon_o0Xaj",vue="WorkspaceSideBar-module_svgFolderIcon_OU86G",wue="WorkspaceSideBar-module_sharedFolderSvg_EzcMC",bue="WorkspaceSideBar-module_svgAddFolderIcon_x1cDo",_ue="WorkspaceSideBar-module_divider_3WPKd",Tue="WorkspaceSideBar-module_spacer_I1ve9",Sue="WorkspaceSideBar-module_addNewFolderContainer_dpS3p",Iue="WorkspaceSideBar-module_svgSparkle_NIeRn",xue="WorkspaceSideBar-module_svgSparkleBrandkit_t3EGw",kue="WorkspaceSideBar-module_upsellBlock_NarqZ",Cue="WorkspaceSideBar-module_sidebarBlock_D7lu9",Aue=({onClose:e,entryPoint:t,setPendingInvites:a})=>{var o;const n=nd(),r=null==(o=null==n?void 0:n.users)?void 0:o.length,s=n&&IE(null==n?void 0:n._id),l=kE(null==s?void 0:s.role);if((null!=r?r:0)>1||!l)return i.createElement(Dde,{entryPoint:t,onClose:e,setPendingInvites:a});const d=[{modal:i.createElement(gce,{entryPoint:t})},{modal:i.createElement(Dde,{entryPoint:t,setPendingInvites:a})}];return i.createElement(_O,{noCloseButton:!0,usePortal:!0,noScrollBar:!0,noPadding:!0,unsetCancelModal:e},i.createElement(gde,{modalSteps:d,onClose:e}))};var Nue=(e=>(e.PersonalizeWorkspace="personalizeWorkspace",e.TwoWeekPostOnboarding="twoWeekPostOnboarding",e.BrandkitInfoBanner="brandkitInfoBanner",e.Survey="survey",e))(Nue||{});function Pue(){var e;const t=tr((e=>e.currentUser)),a=id(),o=null==(e=t.user)?void 0:e.upsells,n=r.exports.useCallback((e=>{if(o){if("personalizeWorkspace"===e){const t=`${e}_${a._id}`,n=o[t];if(!n||!n.dateShown)return;return new Date(String(n.dateShown))}{const t=o[e];if(!t||!t.dateShown)return;return new Date(String(t.dateShown))}}}),[a._id,o]),i=r.exports.useCallback((e=>{if(o){if("personalizeWorkspace"===e){const t=`${e}_${a._id}`,n=o[t];if(!n||!n.dateAcknowledged)return;return new Date(String(n.dateAcknowledged))}{const t=o[e];if(!t||!t.dateAcknowledged)return;return new Date(String(t.dateAcknowledged))}}}),[a._id,o]),s=r.exports.useCallback((async e=>{switch(e){case"personalizeWorkspace":{const t=`${e}_${a._id}`;await xf({...o,[t]:{dateShown:Zs}});break}default:await xf({...o,[e]:{dateShown:Zs}})}}),[a._id,o]);return{getUpsellDateShown:n,getUpsellDateAcknowledged:i,setUpsellAcknowledged:r.exports.useCallback((async e=>{if(o)switch(e){case"personalizeWorkspace":{const t=`${e}_${a._id}`;await xf({...o,[t]:{...o[t],dateAcknowledged:Zs}});break}default:{const t=o[e];if(!t||!t.dateShown)return;await xf({...o,[e]:{...t,dateAcknowledged:Zs}});break}}}),[a._id,o]),setUpsellShown:s}}const Rue="WorkspaceSidebarBlock-module_personalizeWorkspace_hQ4NQ",Lue="WorkspaceSidebarBlock-module_survey_C3oyb",Due="WorkspaceSidebarBlock-module_button_f1Bi5",Oue="WorkspaceSidebarBlock-module_leftImg_aqVH-";const Fue=i.memo((({upsell:e})=>{const t=function(){var e,t,a,o;const{setUpsellShown:n,getUpsellDateShown:r,setUpsellAcknowledged:s,getUpsellDateAcknowledged:l}=Pue(),d=id(),c=l(Nue.Survey),u=r(Nue.Survey),{isPaid:m}=sd(),{onboardingSurvey:p,currentUser:h}=tr((e=>{var t;return{currentUser:e.currentUser,onboardingSurvey:null==(t=e.currentUser.user.onboarding)?void 0:t.survey}}),ar),g=(null!=(t=null==(e=null==d?void 0:d.users)?void 0:e.length)?t:0)>=3&&m,y=(null==p?void 0:p.usage)===yn.Work&&("marketing"===(null==p?void 0:p.occupation)||"creative agency"===(null==p?void 0:p.occupation)),f=!c&&(g||y),E=null!=(o=null==(a=h.user)?void 0:a.firstName)?o:"",v=g?"https://4kaupuj99vi.typeform.com/to/RFRTVDCx":"https://4kaupuj99vi.typeform.com/to/lEwZMO0H";return{render:()=>f&&d?(u||n(Nue.Survey),i.createElement(Q4,{className:Lue,heading:E?`${E}, we want to hear from you!`:"We want to hear from you!",body:"We’d love to hear your thoughts in this quick 3 minute survey so we can make Kapwing better for you.",testId:`${Nue.Survey} Workspace Sidebar Block`,button:i.createElement(s9,{buttonText:"Complete the survey",className:`${Due}`,href:v,testId:`${Nue.Survey} CTA`,onClick:async()=>{vc("Clicked on the survey",{URL:v}),await s(Nue.Survey),await vf()}}),img:{imgSrc:"https://cdn-useast1.kapwing.com/static/8RJ-survey_image.webp",imgAlt:`${E}, we want to hear from you!`},onDismiss:async()=>{await s(Nue.Survey),await vf()}})):null,isTriggered:f}}(),a=function(){const{setUpsellShown:e,getUpsellDateShown:t,setUpsellAcknowledged:a,getUpsellDateAcknowledged:o}=Pue(),n=id(),s=CE(),l=o(Nue.PersonalizeWorkspace),d=t(Nue.PersonalizeWorkspace),[c,u]=r.exports.useState(!1),m=s&&"My Workspace"===n.name&&!l;return r.exports.useEffect((function(){m&&!d&&(vc(Bd.SHOWN_WORKSPACE_DETAILS_SIDEBAR_UPSELL),e(Nue.PersonalizeWorkspace))}),[d,m,e]),{isTriggered:m,render:()=>m?i.createElement(i.Fragment,null,c&&i.createElement(gce,{entryPoint:eE.WORKSPACE_SIDEBAR_UPSELL,onClose:()=>{u(!1)}}),i.createElement(Q4,{className:Rue,heading:"Personalize your team workspace",body:"Name your workspace and add a unique icon for others to recognize your team.",testId:`${Nue.PersonalizeWorkspace} Workspace Sidebar Block`,button:i.createElement(s9,{buttonText:"Add workspace details >",className:`${Due}`,onClick:()=>{u(!0)},testId:`${Nue.PersonalizeWorkspace} CTA`}),img:{imgSrc:"https://cdn-useast1.kapwing.com/static/24r-personalize-workspace-upsell.webp",imgAlt:"Personlize your workspace",className:Oue},onDismiss:async()=>{vc(Bd.DISMISSED_WORKSPACE_DETAILS_SIDEBAR_UPSELL),await a(Nue.PersonalizeWorkspace),await vf()}})):null}}(),{showOnboardingUpsell:o,onboarding:n}=tr((e=>({showOnboardingUpsell:e.workspaces.showOnboardingUpsell,onboarding:e.currentUser.user.onboarding})),ar);if(!n&&o===Jv.None||o!==Jv.None&&void 0!==o)return null;if(!e)return a.isTriggered?i.createElement(a.render,null):t.isTriggered?i.createElement(t.render,null):null;switch(e){case Nue.PersonalizeWorkspace:return i.createElement(a.render,null);case Nue.Survey:return i.createElement(t.render,null);default:return null}})),Mue={personal:"Only you have access to these folders. Projects in these folders are private unless you share them.",team:"All workspace members have access to these folders.",shared:"Folders and projects others have shared with you will appear here."},Uue=()=>i.createElement("svg",{className:wue,xmlns:"http://www.w3.org/2000/svg",height:"1em",viewBox:"0 0 24 24",width:"1em"},i.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),i.createElement("path",{d:"M20 6h-8l-2-2H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm0 12H4V6h5.17l2 2H20v10zm-5-5c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm-4 4h8v-1c0-1.33-2.67-2-4-2s-4 .67-4 2v1z"})),Bue=()=>{var e,t;const a=XD(Ps.BRANDKIT);return i.createElement("div",{className:(null==(t=null==(e=null==window?void 0:window.location)?void 0:e.href)?void 0:t.includes("/brandkit"))?due:sue,onClick:()=>iT("/brandkit"),"data-cy":"brandkit-button"},i.createElement(Va,{className:vue}),"Brand Kit"," ",!a&&i.createElement(Pn,{className:xue}))},Wue=({allWorkspaces:e,currentFolderId:t,openCreateFolderModal:a,sectionTitle:o,selectedTeamId:n,onMouseEnterHeader:r,onMouseLeaveHeader:s})=>{const l=SE(e,n),d=id(),c=XD(Ps.CHANGE_PRIVACY);return i.createElement(i.Fragment,null,i.createElement("div",{className:cue},i.createElement("span",{onMouseEnter:e=>r(e),onMouseLeave:s,"data-testid":"section-workspace-folders"},o),i.createElement("div",{onClick:()=>{c?a(Jr.team):zU((()=>{}),{action:Rs.CREATE_NEW_FOLDER,teamId:d._id})()},"data-cy":"new-workspace-button","data-testid":"workspace-new-folder-button-team",className:aue},i.createElement("div",{className:Sue},i.createElement(ja,{className:bue}),!c&&i.createElement(Pn,{className:Iue})),i.createElement("span",{className:oue,"data-testid":"workspace-new-folder-tooltip-team"},"Create a new workspace folder"))),l.map((e=>{var a;return i.createElement(jue,{id:e._id,name:e.name,currentFolderId:t,key:e._id,icon:d&&(null==(a=d.users)?void 0:a.length)>1?i.createElement(Uue,null):i.createElement(Ga,{className:vue})})})))},Vue=({currentFolderId:e,openCreateFolderModal:t,onMouseEnterHeader:a,onMouseLeaveHeader:o,personalFolders:n,sectionTitle:r})=>{const s=XD(Ps.CREATE_NEW_FOLDER),l=id(),d=n.length>0;return i.createElement(i.Fragment,null,i.createElement("div",{className:`${cue} ${d?"":mue}`},i.createElement("span",{onMouseEnter:e=>a(e),onMouseLeave:o},r),i.createElement("div",{onClick:()=>{s?t(Jr.personal):zU((()=>{}),{action:Rs.CREATE_NEW_FOLDER,teamId:l._id})()},"data-cy":"new-workspace-button-personal","data-testid":"workspace-new-folder-button-personal",className:aue},i.createElement("div",{className:Sue},i.createElement(ja,{className:bue}),!s&&i.createElement(Pn,{className:Iue})),i.createElement("span",{className:oue,"data-testid":"workspace-new-folder-tooltip-personal"},"Create a new personal folder"))),!d&&i.createElement("div",{className:uue},"Create your own private folder with projects only accessible to you unless you share them."),n.map((t=>i.createElement(jue,{id:t._id,name:t.name,currentFolderId:e,key:t._id,icon:i.createElement(Ga,{className:vue})}))))},jue=({id:e,name:t,currentFolderId:a,icon:o})=>{var n,r;return i.createElement("div",{className:e===a&&(null==(r=null==(n=null==window?void 0:window.location)?void 0:n.href)?void 0:r.includes("/folder"))?due:sue,onClick:()=>NQ(e),"data-cy":"workspace-sidebar-link",translate:"no"},i.createElement("div",{className:fue},o),i.createElement("div",null,t))},Gue=m.exports.connect((e=>({allWorkspaces:e.workspaces.allWorkspaces,currentUser:e.currentUser,currentFolderId:e.workspaces.selectedWorkspace,profile:e.currentUser.user,selectedTeamId:e.teams.selectedTeamId,workspaces:e.workspaces,userTeamInvites:e.teams.userTeamInvites})),(e=>me({setMenu:Sv},e))),Hue=we(Gue((({allWorkspaces:e,currentUser:t,currentFolderId:a,selectedTeamId:o,width:n})=>{var s;const l=r.exports.useRef(null),{workspaceIsInSelectionMode:d,allTeams:c,showOnboardingUpsell:u}=tr((e=>({workspaceIsInSelectionMode:e.workspaces.selectionMode,allTeams:e.teams.allTeams,showOnboardingUpsell:e.workspaces.showOnboardingUpsell})),ar),p=m.exports.useDispatch(),h=Ie(),g=id(),{subscription:y}=af(),[f,E]=r.exports.useState(!1),[v,w]=r.exports.useState((null==(s=h.location.state)?void 0:s.redirectSource)===S3.TEAMS),[b,_]=r.exports.useState(Jr.team),[T,S]=r.exports.useState(),I=r.exports.useRef(),[x,k]=r.exports.useState(!1),C=XD(Ps.CREATE_NEW_FOLDER);r.exports.useEffect((function(){!window.sessionStorage.getItem("TEAM_WORKSPACE_ACCESS_LOGGED")&&o&&"personal"!==o&&qf(o)})),r.exports.useEffect((()=>{var e,t;!a||(null==(t=null==(e=null==window?void 0:window.location)?void 0:e.href)?void 0:t.includes("/team"))||a!==mi&&!RQ(a)?k(!1):k(!0)}),[a,o]);const A=e=>{d||(E(!0),_(e))},N=(e,t)=>{var a,o,n;I.current&&clearTimeout(I.current);const r=(null==(n=null==(o=null==(a=e.target)?void 0:a.getBoundingClientRect)?void 0:o.call(a))?void 0:n.y)||0;I.current=window.setTimeout((()=>{S({headerYPos:r,headerType:t})}),350)},P=()=>{I.current&&clearTimeout(I.current),S(void 0)},R=TE(e,o);return i.createElement("div",{className:iue,style:{width:n},"data-cy":"workspace-sidebar-container"},T&&i.createElement("div",{className:nue,style:{bottom:window.innerHeight-T.headerYPos+5}},Mue[T.headerType]),g.stripeId&&i.createElement(S9,{className:kue}),!C&&!(null==y?void 0:y.cancel_at_period_end)&&i.createElement("div",{className:kue},i.createElement(p9,{action:Rs.SIDEBAR,topLeftImg:!0,testId:"workspace-sidebar-upsell-block"})),i.createElement("div",{className:rue},i.createElement(at,{to:`/team/${o}/members`},i.createElement("div",{className:window.location.href.includes("/members")?due:sue},i.createElement(za,{className:vue}),"Members")),i.createElement(Bue,null),i.createElement(at,{to:`/team/${o}/settings`,"data-cy":"team-settings-link","data-testid":"team-settings-link"},i.createElement("div",{className:window.location.href.includes("/team/")&&window.location.href.includes("/settings")?due:sue},i.createElement(Ha,{className:vue}),"Settings")),i.createElement(Wue,{allWorkspaces:e,currentFolderId:a,selectedTeamId:o,sectionTitle:"Team Folders",openCreateFolderModal:A,selectionModeIsActive:d,onMouseEnterHeader:e=>N(e,"team"),onMouseLeaveHeader:P}),i.createElement(Vue,{allTeams:c,currentFolderId:a,currentUser:t,onMouseEnterHeader:e=>N(e,"personal"),onMouseLeaveHeader:P,openCreateFolderModal:A,personalFolders:R,sectionTitle:"Private Folders",selectionModeIsActive:d}),i.createElement("div",{className:Cue},i.createElement(Fue,null))),i.createElement("div",{className:Tue}),i.createElement("div",{"data-testid":"workspace-sidebar-divider",className:_ue}),i.createElement("div",{className:`${lue} ${x?gue:""}`,"data-cy":"shared-with-me-nav",onClick:()=>PQ("Sidebar")},i.createElement("div",{className:fue},i.createElement(Wa,{className:Eue})),i.createElement("div",{className:yue,onMouseEnter:e=>N(e,"shared"),onMouseLeave:P},"Shared with Me")),i.createElement("div",{className:hue},i.createElement("div",{className:`${cue} ${pue}`},"More"),i.createElement("a",{href:"/tools","data-cy":"templates-sidebar-link"},i.createElement("div",{className:sue},i.createElement("div",{className:fue},i.createElement($a,{className:Eue})),"All Tools")),i.createElement("a",{href:"/ai","data-cy":"templates-sidebar-link"},i.createElement("div",{className:sue},i.createElement("div",{className:fue},i.createElement(Mt,{className:Eue})),"Kapwing AI")),i.createElement("a",{href:"/templates","data-cy":"templates-sidebar-link"},i.createElement("div",{className:sue},i.createElement("div",{className:fue},i.createElement(Ka,{className:Eue})),"Templates"))),i.createElement("div",{className:hue},i.createElement("a",{href:"https://www.kapwing.com/resources"},i.createElement("div",{className:sue},i.createElement("div",{className:fue},i.createElement(Ya,{className:Eue})),"Resources"))),f&&i.createElement(tue,{hide:()=>{var e;E(!1),null==(e=null==l?void 0:l.current)||e.scrollTo(0,0)},folderType:b}),v&&i.createElement(Aue,{onClose:()=>{w(!1)},entryPoint:eE.SIDEBAR}),u!==Jv.None&&i.createElement(Hce,{onClose:()=>p(Hv(Jv.None))}))}))),zue="PlanPill-module_pillWrapper_ZbfW3",$ue="PlanPill-module_planPillWrapper_h9j4J",Kue={freePlanContainer:"paywall-module_freePlanContainer_tYT5c",basicPlanContainer:"paywall-module_basicPlanContainer_Q-IM3",proPlanContainer:"paywall-module_proPlanContainer_60ldD",teamPlanContainer:"paywall-module_teamPlanContainer_v83K4",eduPlanContainer:"paywall-module_eduPlanContainer_Jh0jX",freeBackground:"paywall-module_freeBackground_IjRNI",basicBackground:"paywall-module_basicBackground_1sADa",proBackground:"paywall-module_proBackground_f0M-U",teamBackground:"paywall-module_teamBackground_vTqvg",eduBackground:"paywall-module_eduBackground_kf7eU"},Yue=({overrideTeam:e})=>{let t=sd();e&&(t=cd(e));const a=[$ue,Kue[`${t.planTier}PlanContainer`]];return i.createElement("div",{className:zue},i.createElement("div",{className:a.join(" ")},t.isEdu?"Edu Plan":`${t.name} Plan`))},que="WorkspaceNotifications-module_iconContainer_l0Qao",Xue="WorkspaceNotifications-module_bellIcon_tBeeA",Jue="WorkspaceNotifications-module_alertCircle_6kM8K",Que="WorkspaceNotifications-module_notifContainer_bnFNU",Zue="WorkspaceNotifications-module_mobileNotifContainer_TKKI0",eme="WorkspaceNotifications-module_notifHeader_rUAuJ",tme="WorkspaceNotifications-module_settingsGear_j9nXA",ame="WorkspaceNotifications-module_notifListContainer_WJ5Au",ome="WorkspaceNotifications-module_notification_fQI3Z",nme="WorkspaceNotifications-module_iconAndMessageConatiner_RY-6x",rme="WorkspaceNotifications-module_notifIconContainer_SUWHu",ime="WorkspaceNotifications-module_unreadNotifCircle_OqM3R",sme="WorkspaceNotifications-module_notifIcon_q0SUX",lme="WorkspaceNotifications-module_exportSuccessIcon_cf4XZ",dme="WorkspaceNotifications-module_exportFailureIcon_nNUC1",cme="WorkspaceNotifications-module_notifMessageContainer_P2wmh",ume="WorkspaceNotifications-module_exportMessage_R2W70",mme="WorkspaceNotifications-module_notifName_L0lrL",pme="WorkspaceNotifications-module_notifLink_RGLcK",hme="WorkspaceNotifications-module_notifTimeStamp_lmFtg",gme="WorkspaceNotifications-module_emptyNotifContainer_J-gL4",yme="WorkspaceNotifications-module_emptyIconContainer_tXhcm",fme="WorkspaceNotifications-module_emptyNotifIcon_zDL4t",Eme="WorkspaceNotifications-module_emptyNotifMessage_lqrnK",vme=({openAccountSettings:e})=>{const t=Ie(),a=m.exports.useDispatch(),o=Si(),n=tr((e=>e.notifications.notifications)),[s,l]=r.exports.useState(!1),d=r.exports.useRef([]),c=r.exports.useRef(null),u=r.exports.useRef(null);r.exports.useEffect((function(){const e=e=>{var t,a;(null==(t=c.current)?void 0:t.contains(e.target))||(null==(a=u.current)?void 0:a.contains(e.target))||l(!1)};return s?(document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}):()=>{}}),[s]);const p=r.exports.useCallback((()=>{d.current.length&&(a(ZR(d.current)),d.current=[])}),[a]);r.exports.useEffect((()=>{(async()=>{var e;if(s){const a=null==(e=null==n?void 0:n.filter((e=>e.state!==rn.read)))?void 0:e.map((e=>e._id));if(null==a?void 0:a.length)try{await uu("api/v1/notifsRead",{body:{notifIds:JSON.stringify(a)}})&&a.forEach((e=>d.current.push(e.toString())))}catch(t){console.error(t)}}else p()})()}),[a,n,s,p]);const h=(null==n?void 0:n.filter((e=>e.state!==rn.read)).length)||0;return i.createElement(i.Fragment,null,i.createElement("div",{className:que,ref:u,onClick:()=>{s||vc("Notifications Opened",{unreadNotifs:h,readNotifs:n?n.length-h:0}),l(!s)},"data-testid":"ws-header-notifs-icon"},!!h&&i.createElement("div",{className:Jue},h),i.createElement(ya,{className:Xue,size:18})),s&&i.createElement("div",{className:`${Que} ${o?Zue:""}`,ref:c},i.createElement("div",{className:eme},i.createElement("div",null,"Notifications"),i.createElement("div",null,i.createElement(qa,{className:tme,size:20,onClick:e}))),(null==n?void 0:n.length)?i.createElement("div",{className:ame},null==n?void 0:n.map((e=>i.createElement("div",{className:ome,key:e._id.toString(),onClick:()=>{p();const o={notificationType:e.info.type};if(e.info.type===nn.Invite&&(o.inviteType=e.info.inviteType),vc("Notification Clicked",o),e.info.type===nn.Invite&&e.info.inviteType===sn.project){const t=`${window.location.protocol}//${Moe()}${e.info.link} `;window.location.href=t}else e.info.type===nn.Request?(a(LE(e.info.teamId)),t.push(`/team/${e.info.teamId}/members`)):e.info.type===nn.Welcome?CQ(e.info.teamId):e.info.type===nn.Joined?t.push(e.info.teamSettingsPath):t.push(e.info.link)}},(e=>{let t,a;const o=e.createdAt?`${df(new Date(e.createdAt),"moments")} ago`:null;if(e.info.type===nn.Export)e.info.success?(a=i.createElement("span",{className:ume},"Your export"," ",i.createElement("span",{className:pme},e.info.projectName)," is finished"),t=i.createElement("div",{className:lme},i.createElement("span",null,"🎉"))):(a=i.createElement("span",{className:ume},"Your project"," ",i.createElement("span",{className:pme},e.info.projectName)," ","failed to export"),t=i.createElement("div",{className:dme},i.createElement("span",null,"🙁")));else if(e.info.type===nn.Comment){const{commenterName:o,projectName:n,commenterIcon:r,commentReply:s}=e.info;a=i.createElement(i.Fragment,null,i.createElement("span",{className:mme},o)," ",i.createElement("br",null),i.createElement("span",null,s?"replied to your comment on ":"commented on "),i.createElement("span",{className:pme},n)),t=i.createElement(SQ,{user:{name:o,picture:r,pending:!1},className:sme})}else if(e.info.type===nn.Invite){const{inviterName:o,inviterIcon:n,inviteType:r,sharedName:s}=e.info;a=i.createElement(i.Fragment,null,i.createElement("span",{className:mme},o),i.createElement("br",null),"invited you to ",r," ",i.createElement("span",{className:pme},s)),t=i.createElement(SQ,{user:{name:o,picture:n,pending:!1},className:sme})}else if(e.info.type===nn.Request){const{requestType:o,requesterName:n,requesterIcon:r,sharedName:s}=e.info;a=i.createElement(i.Fragment,null,i.createElement("span",{className:mme},n),i.createElement("br",null),"requested to join your ",o," ",i.createElement("span",{className:pme},s)),t=i.createElement(SQ,{user:{name:n||"",picture:r,pending:!1},className:sme})}else if(e.info.type===nn.Joined){const{info:{email:t,joinedFullName:o,teamName:n}}=e;a=i.createElement(i.Fragment,null," ",i.createElement("span",{className:mme},o,"(",t,")"),i.createElement("br",null)," joined ",i.createElement("span",{className:pme},n)," ")}else if(e.info.type===nn.Welcome){const{info:{teamName:t}}=e;a=i.createElement(i.Fragment,null," ",i.createElement("span",{className:mme},"Welcome to your new team:"),i.createElement("span",{className:pme},t)," ")}return i.createElement(i.Fragment,null,i.createElement("div",{className:nme},i.createElement("div",{className:rme},e.state!==rn.read&&i.createElement("div",{className:ime}),t),i.createElement("div",{className:cme},a)),i.createElement("div",{className:hme},i.createElement("span",null,o)))})(e))))):i.createElement("div",{className:gme},i.createElement("div",{className:yme},i.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/s5N-empty-notifs.svg",alt:"empty inbox icon",className:fme})),i.createElement("div",{className:Eme},"No notifications yet!"))))},wme="WorkspaceHeader-module_textOverflowEllipsis_eHQzX",bme="WorkspaceHeader-module_currentWorkspaceInfo_nUtay",_me="WorkspaceHeader-module_workspaceName_sWcam",Tme="WorkspaceHeader-module_profileImage_SRIjq",Sme="WorkspaceHeader-module_profileImageWithEmail_5GxPc",Ime="WorkspaceHeader-module_menuIcon_azxw-",xme="WorkspaceHeader-module_menu_C9Hhq",kme="WorkspaceHeader-module_headerLinkText_js9U8",Cme="WorkspaceHeader-module_headerActiveLinkText_Y9uvw",Ame="WorkspaceHeader-module_headerBarEmpty_9huxh",Nme="WorkspaceHeader-module_impersonating_v4SUA",Pme="WorkspaceHeader-module_headerRight_Tntbn",Rme="WorkspaceHeader-module_headerLeft_D4PsW",Lme="WorkspaceHeader-module_menuLogoImage_AnaRY",Dme="WorkspaceHeader-module_headerBarLogoText_Krr1R",Ome="WorkspaceHeader-module_signedInContainer_Fx3ej",Fme="WorkspaceHeader-module_accountName_YIPKI",Mme="WorkspaceHeader-module_accountNameWithEmail_dg3Mz",Ume="WorkspaceHeader-module_email_TnGZ8",Bme="WorkspaceHeader-module_accountLink_Q6V69",Wme="WorkspaceHeader-module_badges_G8a5R",Vme="WorkspaceHeader-module_pill_NUIqh",jme="WorkspaceHeader-module_mobilePills_im3Gc",Gme="WorkspaceHeader-module_workspaceThumbnail_eWp7l",Hme="WorkspaceHeader-module_members_fp3yC",zme="WorkspaceHeader-module_membersInfo_TYFHJ",$me="WorkspaceHeader-module_facePile_572DB",Kme="WorkspaceHeader-module_face_qcN5H",Yme="WorkspaceHeader-module_inviteMembersButton_-CS4o",qme="WorkspaceHeader-module_plusIcon_qqRFT",Xme=({users:e,url:t})=>{var a;const o=e.slice(0,5),n=null!=(a=e.length)?a:0;return i.createElement(at,{to:t},i.createElement("div",{className:zme},i.createElement("div",{className:$me,"data-testid":"facepile-container"},null==o?void 0:o.map((e=>i.createElement(SQ,{user:e,className:Kme,key:e._id})))),i.createElement("div",{"data-testid":"facepile-additional"},n>5?"+"+(n-5):"")))},Jme=({openAccountSettings:e})=>{const{currentUser:t,currentFolderId:a,selectedTeamId:o}=tr((e=>({currentUser:e.currentUser,currentFolderId:e.workspaces.selectedWorkspace,selectedTeamId:e.teams.selectedTeamId})),ar),[n,s]=r.exports.useState(!1),[l,d]=r.exports.useState(!1),c=Si(),u=r.exports.useRef(null),m=Ie(),p=oe(),h=sd(),g=id(),y=(()=>{const e=Ti("(max-width: 980px)"),t=Si(),[a,o]=r.exports.useState(e&&!t);return r.exports.useEffect((()=>{const n=e&&!t;n!==a&&o(n)}),[a,e,t]),a})();r.exports.useEffect((()=>{s(!1)}),[p]);const f=e=>{var t;const a=e.target;u&&u.current&&(null==(t=u.current)?void 0:t.contains(a))||s(!1)};r.exports.useEffect((()=>(document.addEventListener("mousedown",f),()=>{document.removeEventListener("mousedown",f)})),[]);const E=()=>sc(t)?a?`/folder/${a}`:"/home":"/",v=e=>{e.stopPropagation(),h.isFree&&zU((()=>null),{action:Rs.HEADER})(),m.push({pathname:`/team/${g._id}/billing`})},w=Ame+(Of(t)?` ${Nme}`:"");return i.createElement("div",{className:w},i.createElement("div",{className:Rme},c?i.createElement(i.Fragment,null,i.createElement(at,{to:E(),"data-testid":"ws-header-mobile-home-link"},i.createElement("img",{src:"https://cdn-useast1.kapwing.com/static/gdu-kapwing-logo-transparent.webp",alt:"Kapwing Logo",className:Lme,"data-cy":"header-logo",height:20})),n?i.createElement(pe,{"data-cy":"mobile-nav-menu-toggle",className:Ime,onClick:()=>{s(!n)}}):i.createElement(ut,{"data-cy":"mobile-nav-menu-toggle",className:Ime,onClick:()=>{s(!n)}}),n?i.createElement("div",{className:xme,ref:u},i.createElement(at,{className:Dme,to:E()},"KAPWING"),i.createElement(i.Fragment,null,i.createElement(pQ,null,sc(t)?i.createElement(ct,{className:kme,activeClassName:Cme,to:E(),"data-cy":"workspace-nav-link"},"Workspace"):null),i.createElement("a",{className:kme,href:"/tools","data-cy":"tools-nav-link"},"Tools"),i.createElement("a",{className:kme,href:"/templates","data-cy":"templates-nav-link"},"Templates"),i.createElement("a",{className:kme,href:"/pricing","data-cy":"pricing-nav-link"},"Pricing"),i.createElement("a",{className:kme,target:"_self",href:"https://www.kapwing.com/resources"},"Resources"),i.createElement("a",{className:kme,href:"/teams","data-cy":"teams-nav-link"},"Teams"))):null):i.createElement("div",{className:bme,"data-testid":"ws-header-left"},i.createElement("div",{onClick:()=>CQ(g._id),"data-testid":"team-workspace-logo"},i.createElement(SQ,{team:g,className:Gme})),i.createElement("div",{className:_me,"data-cy":"team-workspace-name","data-testid":"team-workspace-name",onClick:()=>CQ(g._id),translate:"no"},i.createElement("span",{className:wme},null==g?void 0:g.name)),i.createElement("div",{className:Wme},i.createElement("div",{"data-cy":"upgrade-label-header",className:Vme,onClick:v,"data-testid":"ws-header-plan-pill-container"},i.createElement(Yue,null)),i.createElement(wQ,{className:Vme}),h.showUpgrades&&i.createElement("div",{"data-testid":"ws-header-upgrade-container"},i.createElement(yQ,null))))),i.createElement(pQ,null,i.createElement("div",{className:Pme},i.createElement("div",{className:Hme},(null==g?void 0:g.users.length)&&i.createElement(Xme,{users:g.users,url:`/team/${o}/members`}),!h.isEdu&&i.createElement(s9,{buttonText:y?"":"Invite Members",icon:i.createElement("div",{className:qme},y?i.createElement(Ja,null):i.createElement(Xa,null)),onClick:()=>d(!0),className:Yme,testId:"ws-header-invite-members-button"})),c&&i.createElement("div",{className:jme,"data-testid":"ws-header-mobile-pills"},i.createElement("div",{className:Vme},i.createElement(Yue,null)),i.createElement(wQ,{className:Vme}),h.showUpgrades&&i.createElement("div",{className:Vme},i.createElement(yQ,null))),i.createElement(vme,{openAccountSettings:e}),(()=>{const a=mc(t),o=pc(t);return i.createElement("div",{className:Ome,"data-testid":"ws-header-signin-container"},i.createElement("div",{className:kme,"data-cy":"account-nav-link","data-testid":"ws-header-account-link",onClick:()=>{null==e||e()}},i.createElement("div",{className:Bme},!c&&i.createElement("div",null,i.createElement("div",{className:o?Mme:Fme,"data-testid":"ws-header-name-container"},i.createElement("span",{translate:"no"},a)||"My Account"),!c&&o&&i.createElement("div",{className:Ume,"data-testid":"ws-header-email-container"},o)),i.createElement("div",null,i.createElement(SQ,{suggestedWidth:300,suggestedHeight:300,className:o?Sme:Tme})))))})()),l&&i.createElement(Aue,{onClose:()=>{d(!1)},entryPoint:eE.WORKSPACE_HEADER})))},Qme="AccountSettings-module_container_5VbXV",Zme="AccountSettings-module_pageHeader_VXSX1",epe="AccountSettings-module_sectionHeader_OwDPi",tpe="AccountSettings-module_sectionContent_by-VJ",ape="AccountSettings-module_subItem_bahuF",ope="AccountSettings-module_deleteAccountLink_Mb-r9",npe=c((e=>{var t;return null==(t=e.teams.activeBrandkit)?void 0:t.projectId}),(e=>e.studio.projectId),((e,t)=>t===e)),rpe=c((e=>{var t;return null==(t=e.teams.activeBrandkit)?void 0:t.teamId}),(e=>e.teams.selectedTeamId),((e,t)=>e===t));c((e=>e.teams.allTeams),(e=>e.teams.selectedTeamId),((e,t)=>e.find((e=>e._id===t))));const ipe=e=>{const{allTeams:t}=e.teams;return t.some((e=>{var t;return(null==(t=e.users)?void 0:t.length)>1}))};c((e=>{const{allTeams:t,selectedTeamId:a}=e.teams;return t.find((e=>e._id===a))}),(e=>e.currentUser.user),((e,t)=>{var a;return null==(a=null==e?void 0:e.users)?void 0:a.find((e=>e.userId===t._id))}));const spe="NotificationSettings-module_notificationsTable_ec0zC",lpe="NotificationSettings-module_helpIcon_0BYJn",dpe="NotificationSettings-module_exportTooltip_rnuUR",cpe="NotificationSettings-module_disabledHeader_3PTr7",upe="NotificationSettings-module_disabledOption_nvRXx",mpe="NotificationSettings-module_switch_3MQ3k",ppe="NotificationSettings-module_slider_h8jlO",hpe=({checked:e,onSwitch:t,disabled:a})=>{const o=r.exports.useRef(!1);return i.createElement("label",{className:`${mpe} ${a?upe:""}`},i.createElement("input",{type:"checkbox",checked:e,onChange:async a=>{a.preventDefault(),o.current||(o.current=!0,await t(!e),o.current=!1)},disabled:a}),i.createElement("span",{className:ppe}))},gpe=()=>{var e,t,a,o,n,s,l,d;const c=tr((e=>e.currentUser.user)),u=tr(ipe),m=!!(null==c?void 0:c.email),[p,h]=r.exports.useState(!1);return i.createElement("table",{className:spe},i.createElement("thead",null,i.createElement("tr",null,i.createElement("th",null,"Notifications"),i.createElement("th",null,"IN APP"),i.createElement("th",{className:m?"":cpe},"EMAIL"))),i.createElement("tbody",null,i.createElement("tr",null,i.createElement("td",null,"Comment notifications"),i.createElement("td",null,i.createElement(hpe,{checked:!(null==(e=c.optOutNotifs)?void 0:e.includes(nn.Comment)),onSwitch:e=>_f(nn.Comment,e,on.InApp)})),i.createElement("td",null,i.createElement(hpe,{checked:m&&!(null==(t=c.optOutEmails)?void 0:t.includes(nn.Comment)),onSwitch:e=>_f(nn.Comment,e,on.Email),disabled:!m}))),i.createElement("tr",null,i.createElement("td",null,"Export finishes"," ",i.createElement(De,{size:16,className:lpe,onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1)}),p&&i.createElement("div",{className:dpe},"Notifications will only be sent out if project export fails or takes longer than 60 seconds to complete.")),i.createElement("td",null,i.createElement(hpe,{checked:!(null==(a=c.optOutNotifs)?void 0:a.includes(nn.Export)),onSwitch:e=>_f(nn.Export,e,on.InApp)})),i.createElement("td",null,i.createElement(hpe,{checked:m&&!(null==(o=c.optOutEmails)?void 0:o.includes(nn.Export)),onSwitch:e=>_f(nn.Export,e,on.Email),disabled:!m}))),i.createElement("tr",null,i.createElement("td",null,"Team Member Joined"),i.createElement("td",null,i.createElement(hpe,{checked:!(null==(n=c.optOutNotifs)?void 0:n.includes(nn.Joined)),onSwitch:e=>_f(nn.Joined,e,on.InApp)})),i.createElement("td",null,i.createElement(hpe,{checked:m&&!(null==(s=c.optOutEmails)?void 0:s.includes(nn.Joined)),onSwitch:e=>_f(nn.Joined,e,on.Email),disabled:!m}))),u&&i.createElement("tr",null,i.createElement("td",null,"Product updates"),i.createElement("td",null),i.createElement("td",null,i.createElement(hpe,{checked:m&&!(null==(l=c.optOutEmails)?void 0:l.includes(nn.Scheduled)),onSwitch:e=>_f(nn.Scheduled,e,on.Email),disabled:!m}))),i.createElement("tr",null,i.createElement("td",null,"Request notifications"),i.createElement("td",null),i.createElement("td",null,i.createElement(hpe,{checked:m&&!(null==(d=c.optOutEmails)?void 0:d.includes(nn.Request)),onSwitch:e=>_f(nn.Request,e,on.Email),disabled:!m})))))},ype="EditableProfilePictureEditor-module_wrapper_kc-FQ",fpe="EditableProfilePictureEditor-module_editor_VdqAy",Epe="EditableProfilePictureEditor-module_frameTop_svxIJ",vpe="EditableProfilePictureEditor-module_frameBottom_u6Gbr",wpe="EditableProfilePictureEditor-module_windowRow_Cm6Et",bpe="EditableProfilePictureEditor-module_frameLeft_rmRpu",_pe="EditableProfilePictureEditor-module_frameRight_Iye8W",Tpe="EditableProfilePictureEditor-module_image_t3MN-",Spe="EditableProfilePictureEditor-module_squareWindow_MV-Jm",Ipe="EditableProfilePictureEditor-module_controlsWrapper_-0jdE",xpe="EditableProfilePictureEditor-module_controlsHeader_s9AgJ",kpe="EditableProfilePictureEditor-module_controls_TyiHq",Cpe="EditableProfilePictureEditor-module_zoom_xHKPt",Ape="EditableProfilePictureEditor-module_position_6cBLJ",Npe="EditableProfilePictureEditor-module_label_NGo2n",Ppe="EditableProfilePictureEditor-module_button_G0nuo",Rpe="EditableProfilePictureEditor-module_arrow_3-yIm",Lpe="EditableProfilePictureEditor-module_footer_qC1qN",Dpe="EditableProfilePictureEditor-module_submit_9y1ps",Ope="EditableProfilePictureEditor-module_uploading_eaAOr",Fpe="EditableProfilePictureEditor-module_cancel_70r8X",Mpe=({inputFile:e,image:t,cancel:a})=>{const[o,n]=r.exports.useState({width:0,height:0,top:0,left:0}),[s,l]=r.exports.useState(0),[d,c]=r.exports.useState(!1),{token:u}=tr((e=>e.currentUser)),p=m.exports.useDispatch(),h=r.exports.useRef(null);r.exports.useEffect((()=>{const e=new Image;e.onload=()=>{n({...g(e.width,e.height)})},e.src=t}),[t]);const g=(e,t)=>{let a=200,o=200;e>t?a=Math.round(200*e/t):e<t&&(o=Math.round(200*t/e));let n=50,r=180;if(h&&h.current){const e=h.current.offsetWidth;n=(h.current.offsetHeight-o)/2,r=(e-a)/2}return{width:a,height:o,top:n,left:r}},y=()=>{let e=560,t=300;h&&h.current&&(e=h.current.offsetWidth,t=h.current.offsetHeight);const a=(e-200)/2,o=(t-200)/2;return{leftSide:a,rightSide:a+200,topSide:o,bottomSide:o+200}};return i.createElement("div",{className:ype},i.createElement("div",{className:fpe,ref:h},i.createElement("img",{src:t,className:Tpe,alt:"New Profile Pic",style:{...o}}),i.createElement("div",{className:Epe}),i.createElement("div",{className:wpe},i.createElement("div",{className:bpe}),i.createElement("div",{className:Spe}),i.createElement("div",{className:_pe})),i.createElement("div",{className:vpe})),i.createElement("div",{className:Ipe},i.createElement("div",{className:xpe},"Use the controls below to adjust your new profile image:"),i.createElement("div",{className:kpe},i.createElement("div",{className:Cpe},i.createElement("div",{className:Npe},"Zoom:"),i.createElement("div",{className:Ppe,onClick:()=>{const{width:e,height:t,top:a,left:r}=o,i=e+10,s=Math.round(t/e*i);n({width:i,height:s,top:a-(s-t)/2,left:r-5})}},i.createElement(Qa,null)," Zoom In"),i.createElement("div",{className:Ppe,onClick:()=>{const{width:e,height:t,top:a,left:r}=o,i=e-10,s=Math.round(t/e*i),l=a-(s-t)/2,d=r+5,{leftSide:c,rightSide:u,topSide:m,bottomSide:p}=y();d>c||d+i<u||l>m||l+s<p||n({width:i,height:s,top:l,left:d})}},i.createElement(Za,null)," Zoom Out")),i.createElement("div",{className:Ape},i.createElement("div",{className:Npe},"Position:"),i.createElement("div",{className:Ppe,onClick:()=>{const{top:e}=o;let t=e+10;const{topSide:a}=y();t>a&&(t=a),n((e=>({...e,top:t})))}},i.createElement(eo,{className:Rpe})),i.createElement("div",{className:Ppe,onClick:()=>{const{top:e,height:t}=o;let a=e-10;const{bottomSide:r}=y();a+t<r&&(a=r-t),n((e=>({...e,top:a})))}},i.createElement(to,{className:Rpe})),i.createElement("div",{className:Ppe,onClick:()=>{const{left:e}=o;let t=e+10;const{leftSide:a}=y();t>a&&(t=a),n((e=>({...e,left:t})))}},i.createElement(ao,{className:Rpe})),i.createElement("div",{className:Ppe,onClick:()=>{const{left:e,width:t}=o;let a=e-10;const{rightSide:r}=y();a+t<r&&(a=r-t),n((e=>({...e,left:a})))}},i.createElement(oo,{className:Rpe}))))),i.createElement("div",{className:Lpe},i.createElement("div",{className:Fpe,onClick:a},"Cancel"),d?i.createElement("div",{className:Ope},"Uploading ... ",s,"%"):i.createElement("div",{className:Dpe,onClick:async()=>{try{c(!0);const n=(e,t,a)=>fetch(e).then((e=>e.arrayBuffer())).then((e=>new File([e],t,{type:a}))),r=await n(t,e.name,e.type),i=new FormData;let s;if(i.append("file",r),h&&h.current){const{left:e,top:t,width:a,height:n}=o,r=h.current.offsetWidth,i=h.current.offsetHeight;s={relativeLeftCrop:(r-200)/2-e,relativeTopCrop:(i-200)/2-t,relativeWidth:a,relativeHeight:n}}i.append("cropInfo",JSON.stringify(s));const d=new XMLHttpRequest;await new Promise(((e,t)=>{d.upload.onprogress=e=>{e.lengthComputable&&l(Math.floor(e.loaded/e.total*100))},d.addEventListener("loadend",(()=>{l(0);const t=JSON.parse(d.response);e(t)})),d.onreadystatechange=()=>{4===d.readyState&&200!==d.status&&(c(!1),t(new Error(d.responseText)))},d.open("POST","/api/v1/users/uploadProfilePicture",!0),d.setRequestHeader("x-access-token",u),d.send(i)}))&&(p(Su({description:"Upload complete!",type:"success"})),c(!1),a(),vf(),vc("User Update",{property:"picture"}))}catch(YEe){Iu({description:"Error updating profile picture",error:YEe}),c(!1)}}},"Upload Image")))},Upe="EditableProfilePictureOverlay-module_container_vKLx-",Bpe="EditableProfilePictureOverlay-module_header_OKDhI",Wpe="EditableProfilePictureOverlay-module_uploader_d4k3-",Vpe="EditableProfilePictureOverlay-module_icon_2zLZD",jpe="EditableProfilePictureOverlay-module_filePickerButton_fOdAn",Gpe="EditableProfilePictureOverlay-module_filePickerInput_69zY6",Hpe="EditableProfilePictureOverlay-module_buttonSubheader_-IIDX",zpe=({closeModal:e})=>{const[t,a]=r.exports.useState(null),[o,n]=r.exports.useState(""),s=async e=>{if(e&&e.target&&e.target.files&&e.target.files.length){const t=e.target.files[0];a(t);const o=new FileReader;o.onload=e=>{if(e&&e.target&&e.target.result){const t=e.target.result;n(t)}},o.readAsDataURL(t)}};return i.createElement(_O,{overlayContainerSmall:!0,usePortal:!0,unsetCancelModal:e},i.createElement("div",{className:Upe},i.createElement("div",{className:Bpe},"Choose a new profile picture"),o?i.createElement(Mpe,{inputFile:t,image:o,cancel:e}):i.createElement("div",{className:Wpe},i.createElement("button",{type:"button",className:jpe},i.createElement("div",null,i.createElement(no,{className:Vpe})," Select an image"),i.createElement("div",{className:Hpe},"JPG, PNG, WEBP, GIF supported")),i.createElement("input",{type:"file",onChange:s,className:Gpe,accept:"image/jpeg, image/png, image/webp, image/gif"}))))},$pe="EditableProfilePicture-module_container_JTyhj",Kpe="EditableProfilePicture-module_containerOverlay_ufXRZ",Ype="EditableProfilePicture-module_profileImage_lfy1f",qpe=()=>{const[e,t]=r.exports.useState(!1);return i.createElement("div",null,i.createElement("div",{className:$pe,onClick:()=>{t(!0)}},i.createElement(SQ,{suggestedWidth:300,suggestedHeight:300,className:Ype}),i.createElement("div",{className:Kpe},i.createElement(ro,null))),e?i.createElement(zpe,{closeModal:()=>{t(!1)}}):null)},Xpe="ProfileInformation-module_container_ukgY6",Jpe="ProfileInformation-module_accountText_JBrMd",Qpe="ProfileInformation-module_editIcon_Oxj9B",Zpe="ProfileInformation-module_editableText_NLNEW",ehe="ProfileInformation-module_hovered_hFRfr",the="ProfileInformation-module_email_sJf09",ahe="ProfileInformation-module_fullName_Tfelb",ohe="ProfileInformation-module_overlayAltButton_dg4ti",nhe="ProfileInformation-module_overlayControls_u5d4b",rhe="ProfileInformation-module_overlayDescription_sbyXu",ihe="ProfileInformation-module_overlayForm_Q0nuV",she="ProfileInformation-module_overlayHeader_OBbE5",lhe="ProfileInformation-module_overlayInput_xFGJ4",dhe="ProfileInformation-module_overlayLabel_rQqSs",che="ProfileInformation-module_overlaySubmitButton_cjsiM",uhe="ProfileInformation-module_profileInformationContainer_Ml01l",mhe="ProfileInformation-module_signOutButton_cp5LP",phe="ProfileInformation-module_note_-y-KP",hhe=({closeOverlay:e})=>{const t=m.exports.useDispatch(),[a,o]=r.exports.useState(!1),[n,s]=r.exports.useState(!1),[l,d]=r.exports.useState(""),[c,u]=r.exports.useState(""),[p,h]=r.exports.useState(!1),g=sd(),{executeRecaptcha:y}=fe(),f=tr((e=>e.currentUser)),E=tr((e=>e.config.RECAPTCHA_V3_SITEKEY)),v=tr((e=>e.config.RECAPTCHA_V2_SITEKEY)),w=r.exports.useRef(null);return i.createElement(_O,{unsetCancelModal:e,overlayContainerSmall:!0,usePortal:!0},i.createElement("div",{className:Xpe},i.createElement("div",{className:she},"Update email"),i.createElement("div",{className:rhe},i.createElement("div",{className:phe},a?"Please enter the confirmation code we sent to your email to confirm you want to transfer account ownership to this address. If you did not receive your code, please check your spam folder.":i.createElement(i.Fragment,null,"Use this form to update the email address you use to log into your account."," ",i.createElement("span",null,g.isPaid&&"Please note that changing your account email will not update the billing email for your team. To update your billing email, please visit Billing settings.")))),i.createElement("form",{className:ihe},a?i.createElement("label",{htmlFor:"code-input",className:dhe},"Code:",i.createElement("input",{placeholder:"Code",className:lhe,value:l,onChange:e=>{return t=e.target.value,void d(t.toUpperCase());var t},id:"code-input"})):i.createElement("label",{htmlFor:"email-input",className:dhe},"New email:",i.createElement("input",{placeholder:"YourNewEmail@example.com",className:lhe,value:c,onChange:e=>u(e.target.value),id:"email-input"})),!a&&p&&i.createElement("div",{style:{marginBottom:"10px"}},i.createElement(ve,{sitekey:v,ref:w})),i.createElement("div",{className:nhe},i.createElement("button",{type:"submit",onClick:async n=>{var r;n.preventDefault();const{token:i,user:d}=f,{_id:u}=d||{};if(a){try{s(!0),await gu("/api/v1/users/updateProfile/email/validateCode",{body:{token:i,userId:u,email:c,code:l},parseJSON:!1}),vf(),t(Su({description:"Your email has been updated and you can now sign in with your new email.",type:"success"})),vc("User Update",{property:"email"}),e()}catch(m){Iu({description:"Error updating email",error:m})}s(!1)}else if(Mf(c)){try{if(!y)throw new Error("Recaptcha loading ... please try again in a few seconds.");const e=await y("updateEmail"),t=null==(r=w.current)?void 0:r.getValue();s(!0),await gu("/api/v1/users/email/signin",{body:{email:c,v3CaptchaToken:e,v2CaptchaToken:t,recaptchaKeyV3:E,recaptchaKeyV2:v}}),o(!0)}catch(m){Iu({description:"Error updating email",error:m}),zf(m)&&h(!0)}s(!1)}else t(Su({description:"Please input a valid email address.",type:"error"}))},className:che},n?"Loading...":a?"Submit confirmation code":"Update Email"),!n&&a&&i.createElement("button",{type:"button",onClick:e,className:ohe},"Never mind")))))},ghe=({closeOverlay:e,firstName:t,lastName:a})=>{const o=m.exports.useDispatch(),[n,s]=r.exports.useState(t||""),[l,d]=r.exports.useState(a||""),[c,u]=r.exports.useState(!1);return i.createElement(_O,{unsetCancelModal:e,overlayContainerSmall:!0,usePortal:!0},i.createElement("div",null,i.createElement("div",{className:she},"Update Your Name"),i.createElement("div",{className:rhe},"Use this form to update the name on your profile."),i.createElement("form",{className:ihe},i.createElement("label",{htmlFor:"first-name-input",className:dhe},"First Name",i.createElement("input",{placeholder:"First name",className:lhe,value:n,onChange:e=>s(e.target.value),id:"first-name-input"})),i.createElement("label",{htmlFor:"last-name-input",className:dhe},"Last Name",i.createElement("input",{placeholder:"Last name",className:lhe,value:l,onChange:e=>d(e.target.value),id:"last-name-input"})),i.createElement("div",{className:nhe},i.createElement("button",{type:"submit",onClick:async t=>{if(t.preventDefault(),!c){u(!0);try{await async function(e,t){const{state:a}=tn(),{token:o,user:n}=a.currentUser||{},{_id:r}=n||{};await gu("/api/v1/users/updateProfile/fullName",{body:{token:o,userId:r,firstName:e,lastName:t},parseJSON:!1}),await vf()}(n,l),vc("User Update",{property:"name"}),o(Su({description:"Your name has been updated.",type:"success"})),e()}catch(a){Iu({description:"Error updating name",error:a})}u(!1)}},className:che},c?"Loading...":"Set new account name"),!c&&i.createElement("button",{type:"button",onClick:e,className:ohe},"Never mind")))))},yhe=({className:e,children:t,editValue:a,alt:o})=>{const[n,s]=r.exports.useState(!1);return i.createElement("div",{className:n?`${e} ${Zpe} ${ehe}`:`${e} ${Zpe}`,onMouseEnter:()=>s(!0),onMouseLeave:()=>s(!1),onClick:a,translate:"no"},t||o,i.createElement(ro,{className:Qpe}))},fhe=({currentUser:e,email:t})=>{const a=m.exports.useDispatch(),o=Ie(),[n,s]=r.exports.useState(!1),[l,d]=r.exports.useState(!1);return i.createElement("div",{className:uhe},l&&i.createElement(ghe,{closeOverlay:()=>d(!1),firstName:e.user.firstName,lastName:e.user.lastName}),n&&i.createElement(hhe,{closeOverlay:()=>s(!1)}),i.createElement(qpe,null),i.createElement("div",{className:Jpe},i.createElement(yhe,{alt:"Add Your Name",className:ahe,editValue:()=>d(!0)},uc(e)),i.createElement(yhe,{alt:"Add Email Address",className:the,editValue:()=>s(!0)},t),i.createElement(wD,null)),i.createElement("div",{onClick:()=>{a(Jc()),TO(),window&&window.google&&window.google.accounts.id.disableAutoSelect(),o.push("/")},className:mhe,"data-cy":"sign-out-button"},"Sign Out"))},Ehe=()=>{const{currentUser:e,workspaces:t,currentFolderId:a}=tr((e=>{const t=e.teams.selectedTeamId,a=e.teams.allTeams.find((e=>e._id===t));return{currentUser:e.currentUser,workspaces:e.workspaces,currentFolderId:e.workspaces.selectedWorkspace,allTeams:e.teams.allTeams,currentTeam:a}}),m.exports.shallowEqual),o=Ie(),n=m.exports.useDispatch();r.exports.useState(),r.exports.useEffect((function(){!t.allWorkspaces.length&&a&&n(gR())}),[a,n,t.allWorkspaces.length]),r.exports.useEffect((()=>{sc(e)||o.push(`/folder/${a}`)}),[e,a,o]);const{user:s}=e||{},l=(null==s?void 0:s.email)||"Signed in with Facebook";return i.createElement("div",{className:Qme},i.createElement("div",{className:Zme,"data-testid":"account-settings-header"},"Account Settings"),i.createElement(fhe,{currentUser:e,email:l}),i.createElement(gpe,null),i.createElement("div",{className:epe},"Delete Account"),i.createElement("div",{className:tpe},i.createElement("div",{className:ape},i.createElement("button",{className:ope,type:"button","data-cy":"delete-account-link",onClick:()=>Pu({modalType:ku.DELETE_ACCOUNT})},"Delete account and all associated data stored in Kapwing."))))},vhe=({closeAccountSettings:e})=>i.createElement(_O,{usePortal:!0,unsetCancelModal:e},i.createElement(Ehe,null)),whe="Hub-module_hubContainer_1nL2t",bhe="Hub-module_sidebarSpacer_MjYqb",_he="Hub-module_bannerContainer_GkN8f",The="FloatingLinkMenu-module_tooltip_IZcex",She="FloatingLinkMenu-module_tooltipVisible_jzgc-",Ihe="FloatingLinkMenu-module_linkMenu_PYIwP",xhe="FloatingLinkMenu-module_linkSection_bDsk3",khe="FloatingLinkMenu-module_openButton_kD83u",Che=()=>{const[e,t]=r.exports.useState(!1),[a,o]=r.exports.useState(!1),n=cs(),s=sd(),l=[[{name:"Tools",href:"/tools",target:"_self"},{name:"Templates",href:"/templates",target:"_self"},{name:"Help Center",href:"https://www.kapwing.com/help"},{name:"Resources",href:"https://www.kapwing.com/resources"},{name:"Kapwing Youtube",href:"https://www.youtube.com/channel/UCR5GrKMeaZJxPKVMdEgKIKA?sub_confirmation=1"},{name:"Blog",href:"https://www.kapwing.com/blog"},{name:"Release Notes",href:"https://www.kapwing.com/help/tag/release-notes/"},{name:"Contact Us",href:"/contact-us"}],[{name:"Careers",href:"/careers"},{name:"Partnerships",href:"/partnerships"},{name:"Creators Fund",href:"/creators-fund"},{name:"Affiliates",href:"/partnerships"}],[{name:"Refund Policy",href:"/policies/refund"},{name:"Privacy Policy",href:"/policies/privacy"},{name:"Terms of Service",href:"/policies/terms-of-service"}]],d=r.exports.useRef(null),c=r.exports.useCallback((e=>{const{target:a}=e;d.current&&a instanceof Node&&d.current.contains(a)||t(!1)}),[]);r.exports.useEffect((()=>e?(document.addEventListener("mouseup",c),()=>document.removeEventListener("mouseup",c)):()=>{}),[c,e]);const u=(e,t)=>{const{name:a,href:o,target:n="_blank"}=e;return i.createElement("a",{key:t,target:n,rel:"noreferrer",href:o},a)},m=i.createElement("div",{className:Ihe},s.isPaid&&i.createElement("div",{className:xhe},i.createElement("div",{onClick:()=>{o(!0),t(!1)}},"Report a Problem")),l.map(((e,t)=>i.createElement("div",{className:xhe,key:t},e.map(u)))),i.createElement("span",null,"© ",(new Date).getFullYear()," Kapwing. Release ","v2023.06.13.1","—",n,".")),p=i.createElement("div",{className:She},"Help and Resources"),h=i.createElement("button",{className:`${khe} ${The}`,type:"button",onClick:()=>{t(!e)}},e?i.createElement(io,null):i.createElement(so,null),!e&&p);return i.createElement("div",{ref:d},a&&i.createElement(Jne,{hide:()=>o(!1),fromWorkspace:!0}),e&&m,h)};const Ahe="WorkspaceSelector-module_disabled_-SJyl",Nhe="WorkspaceSelector-module_wrapper_ENg9C",Phe="WorkspaceSelector-module_infoTooltip_fIEjw",Rhe="WorkspaceSelector-module_swTeamName_qFVs1",Lhe="WorkspaceSelector-module_teamName_-uFrR",Dhe="WorkspaceSelector-module_suggestedWorkspaceHeader_1EKFq",Ohe="WorkspaceSelector-module_workspaceContainer_iaAYC",Fhe="WorkspaceSelector-module_tooltip_jDT3i",Mhe="WorkspaceSelector-module_container_kqx6F",Uhe="WorkspaceSelector-module_mobileDropdown_dMJmz",Bhe="WorkspaceSelector-module_mobileDropdownItems_QvnIw",Whe="WorkspaceSelector-module_mobileInvites_rXrNz",Vhe="WorkspaceSelector-module_workspaceContainerMobile_cV6Kk",jhe="WorkspaceSelector-module_selected_1d40c",Ghe="WorkspaceSelector-module_workspaceInviteContainerMobile_gPofT",Hhe="WorkspaceSelector-module_workspaceThumbnail_ipcXR",zhe="WorkspaceSelector-module_currentWorkspaceInfo_k6moa",$he="WorkspaceSelector-module_iconChevronDown_Gn47T",Khe="WorkspaceSelector-module_iconPersonAdd_MJQsj",Yhe="WorkspaceSelector-module_inviteButton_bQWAy",qhe="WorkspaceSelector-module_profilePicture_QnIVa",Xhe="WorkspaceSelector-module_suggestedWorkspaceThumbnail_RNZ5z",Jhe="WorkspaceSelector-module_lightBulb_4bqgq",Qhe="WorkspaceSelector-module_workspaceInviteContainer_-3ils",Zhe="WorkspaceSelector-module_hidden_8DpEZ",ege="WorkspaceSelector-module_newBadge_Vs97P",tge="WorkspaceSelector-module_suggestedWorkspaceTooltip_LTQNb",age="WorkspaceSelector-module_swTeamsContainer_NutOy",oge="WorkspaceSelector-module_smallProfilePicture_oAoal",nge="WorkspaceSelector-module_smallBadge_5K7jS",rge="WorkspaceSelector-module_workspaceInvite_Kh4dP",ige="WorkspaceSelector-module_actionsContainer_8JtZ5",sge="WorkspaceSelector-module_suggestedWorkspaceButton_gun9k",lge="WorkspaceSelector-module_checkmark_V2cEV",dge="WorkspaceSelector-module_accept_7jVQs",cge="WorkspaceSelector-module_deleteSuggestionButton_v5kkl",uge="WorkspaceSelector-module_delete_BmSU7",mge="WorkspaceSelector-module_themeSwitch_M7rVw",pge=({invite:e,close:t,tooltipPosition:a={x:0,y:0}})=>{const o=m.exports.useDispatch(),{team:n}=e,s=Si();return r.exports.useEffect((()=>(s||document.addEventListener("click",t),()=>{s||document.removeEventListener("click",t)}))),i.createElement("div",{className:s?"":Phe,style:{left:a.x,top:a.y},onClick:e=>{s||e.stopPropagation()},"data-testid":"invite-actions"},!s&&i.createElement("div",{className:Lhe},n.name),i.createElement("div",{className:ige},i.createElement(s9,{testId:"invite-join-button",buttonText:"Join",className:dge,onClick:async()=>{await o(JE(e,XE.WorkspaceDropdown)),CQ(e.team._id)}}),i.createElement(s9,{buttonText:"Delete",className:uge,onClick:()=>{o(function(e){return async()=>{const{dispatch:t,state:a}=tn(),{teams:o}=a,{userTeamInvites:n}=o,r={inviteId:e._id};try{await pu("/api/v1/invites/teams",{body:r,parseJSON:!1}),t(OE([...n].filter((t=>t._id!==e._id))))}catch(YEe){console.error(YEe)}}}(e))}})))},hge=({invite:e})=>{const[t,a]=r.exports.useState(!1),{team:o}=e,n=Si(),[s,l]=r.exports.useState({x:0,y:0}),d=()=>i.createElement("div",{className:ege},"NEW!");return n?i.createElement("div",{className:Ghe},i.createElement("div",{className:Vhe},i.createElement("div",{className:rge},d(),i.createElement(SQ,{team:o,className:Hhe})),i.createElement("div",{className:Lhe},o.name)),!t&&i.createElement(pge,{invite:e,close:()=>{a(!1)}})):i.createElement("div",{className:Qhe,onMouseEnter:e=>{const t=e.currentTarget.getBoundingClientRect(),{x:a}=t,o=t.height/2+t.top;l({x:a+38,y:o})}},t&&i.createElement(pge,{invite:e,close:()=>{a(!1)},tooltipPosition:s}),i.createElement("div",{className:`${Fhe} ${t?Zhe:""}`,style:{left:s.x,top:s.y},"data-testid":"invite-tooltip"},"Click to see workspace invitation"),d(),i.createElement("div",{className:rge,"data-testid":"workspace-selector-invite-thumbnail",onClick:()=>{a(!t)}},i.createElement(SQ,{team:o,className:Hhe})))},gge=({onClose:e=(()=>{})})=>{const t=m.exports.useDispatch(),{refetchExplorer:a}=Du(),[o,n]=r.exports.useState(""),s=r.exports.useRef(""),l=r.exports.useContext(pde),[d,c]=r.exports.useState(!1),u=id(),{currentUser:p,isQualifiedLead:h}=tr((e=>{var t;return{currentUser:e.currentUser,isQualifiedLead:null==(t=e.workspaces.suggestedWorkspaces)?void 0:t.isQualifiedLead}}),ar),g=l.exists,y=e=>{n(e.target.value)},f=async()=>{var e;c(!0),s.current=await t((e=o,async(t,a)=>{const{currentUser:o,teams:n}=a(),{token:r,user:i}=o||{},{_id:s}=i||{},{allTeams:l}=n,d=e||xE(i.name);try{const{team:e}=await gu("/api/v1/teams/create",{body:{token:r,userId:s,name:d}});return t(DE([e,...l])),t(LE(e._id)),vc("Create Team",{"Team ID":e._id,Email:o.user.email,"Name of Team":e.name}),e._id}catch(c){Iu({description:"There was a problem creating your team. Please try again.",error:c})}return""})),a(),c(!1)},E=async t=>{null==t||t.preventDefault(),await f(),s.current&&(g?l.goToNextModal():e())},v=()=>i.createElement("div",{className:mde.modal},i.createElement("div",{className:mde.header},"Create New Team"),i.createElement("form",{className:mde.form,onSubmit:E},i.createElement(i.Fragment,null,i.createElement("p",null,"Name your new workspace before selecting your workspace subscription.",i.createElement("br",null),"We recommend using your team or organization name."),i.createElement("input",{id:"new-team-name",type:"text",className:mde.textInput,value:o||"",onChange:y,placeholder:xE(p.user.firstName,h,u.emailDomain),autoFocus:!0,"data-testid":"new-team-name-input","data-cy":"new-team-name-input"}))),i.createElement(iO,{confirmFn:E,confirmText:"Next",loadingMsg:d?"Creating...":void 0}),i.createElement("div",{className:`${mde.exit}`,onClick:g?l.onClose:e},i.createElement(pe,null)));return g?v():i.createElement(_O,{noCloseButton:!0,usePortal:!0,noScrollBar:!0,noPadding:!0,unsetCancelModal:e},v())},yge=({onClose:e})=>{const t=[{modal:i.createElement(gge,null)},{modal:i.createElement(gce,{entryPoint:eE.TEAM_CREATION})},{modal:i.createElement(Dde,{entryPoint:eE.TEAM_CREATION})}];return i.createElement(_O,{noCloseButton:!0,usePortal:!0,noScrollBar:!0,noPadding:!0,unsetCancelModal:e},i.createElement(gde,{modalSteps:t,onClose:e}))},fge=({allTeams:e,userTeamInvites:t,close:a,renderWorkspace:o})=>(r.exports.useEffect((()=>(document.addEventListener("click",a),()=>{document.removeEventListener("click",a)}))),i.createElement("div",{onClick:e=>e.stopPropagation(),className:Uhe},i.createElement("div",{className:Bhe},i.createElement("div",{className:Whe},null==t?void 0:t.map((e=>i.createElement(hge,{invite:e,key:e._id})))),null==e?void 0:e.map((e=>o(e)))))),Ege=({suggestedWorkspaces:e,close:t,tooltipPosition:a={x:0,y:0}})=>{const{currentUser:o,teamEmailDomain:n}=tr((e=>{var t,a;return{currentUser:e.currentUser,teamEmailDomain:null==(a=null==(t=e.workspaces.suggestedWorkspaces)?void 0:t.teams[0])?void 0:a.emailDomain}}),ar),s=m.exports.useDispatch(),l=Si(),[d,c]=r.exports.useState([]),u=r.exports.useRef(null);r.exports.useEffect((function(){(async()=>{const e=await YP();c(e.map((e=>e.teamId)))})()}),[]);const p=async t=>{var a;try{const o=null==e?void 0:e.teams.filter((e=>e._id!==t));s(zv({isQualifiedLead:null!=(a=null==e?void 0:e.isQualifiedLead)&&a,teams:null!=o?o:[]})),await gu("/api/v2/teams/deleteSuggestion",{body:{teamId:t}})}catch(YEe){console.error(YEe)}},h=async t=>{await $P(t),hv(pv.Sidebar,t,o),(()=>{var a;const o=null==e?void 0:e.teams.map((e=>(e._id===t&&(e.requestSent=!0),e)));s(zv({teams:null!=o?o:[],isQualifiedLead:null!=(a=null==e?void 0:e.isQualifiedLead)&&a}))})(),c((e=>[...e,t])),setTimeout((()=>{p(t)}),3e3)},g=e=>{var a;switch(null==(a=e.settings)?void 0:a.discoverability){case wn.AnyoneCanJoin:return()=>(async e=>{try{if(!(await gu(`/api/v2/teams/${e}/join`)).success)throw new Error;s(Su({description:"Successfully joined team.",type:"success"})),s(jE()),s(LE(e)),await CQ(e),await p(e),t()}catch(a){Iu({description:"Something went wrong with joining the team, please try again later.",error:a})}})(e._id);case wn.RequestToJoin:default:return()=>h(e._id)}},y=e=>{var t;if(e.requestSent||d.includes(e._id))return i.createElement("div",null,i.createElement(Ba,{className:lge}),"Request Sent");switch(null==(t=e.settings)?void 0:t.discoverability){case wn.AnyoneCanJoin:return"Join";case wn.RequestToJoin:default:return"Ask to Join"}},f=e=>e.requestSent||d.includes(e._id)?Ahe:sge;r.exports.useEffect((()=>(l||document.addEventListener("click",t),()=>{l||document.removeEventListener("click",t)})),[]);return i.createElement("div",{className:l?"":Phe,style:{left:a.x,top:u.current?a.y-u.current.clientHeight/2<0?a.y+(u.current.clientHeight/2-20):a.y+u.current.clientHeight/2>window.innerHeight?a.y-(u.current.clientHeight/2-20):a.y:a.y},onClick:e=>{l||e.stopPropagation()},ref:u},i.createElement("div",{className:tge},i.createElement("div",{className:Dhe},"Suggested Workspaces ",n?`for ${n}`:""),e.teams.map((e=>i.createElement("div",{className:age,key:e._id},i.createElement(SQ,{team:e,className:oge}),i.createElement("div",{className:Rhe},e.name),i.createElement("div",{className:ige},i.createElement(s9,{buttonText:y(e),className:f(e),onClick:g(e)}),!e.requestSent&&i.createElement(s9,{icon:i.createElement(uo,null),className:cge,onClick:()=>p(e._id)})))))))},vge=({suggestedWorkspaces:e})=>{const{currentUser:t,allTeams:a,pendingInvites:o,isQualifiedLead:n}=tr((e=>{var t;return{currentUser:e.currentUser.user,allTeams:e.teams.allTeams,pendingInvites:e.teams.userTeamInvites,isQualifiedLead:null==(t=e.workspaces.suggestedWorkspaces)?void 0:t.isQualifiedLead}}),ar),[s,l]=r.exports.useState(!1),d=Si(),[c,u]=r.exports.useState({x:0,y:0}),m=t.upsells;r.exports.useEffect((function(){const t=null==e?void 0:e.teams.map((e=>e._id));a.some((e=>null==t?void 0:t.includes(e._id)))&&XP()}),[a,null==e?void 0:e.teams]);return!(null==e?void 0:e.isQualifiedLead)||d?null:i.createElement("div",{className:Qhe},i.createElement("div",{className:Xhe,onMouseEnter:e=>{const t=e.currentTarget.getBoundingClientRect(),{x:a}=t,o=t.height/2+t.top;u({x:a+38,y:o})},onClick:()=>{(null==m?void 0:m.suggestedWorkspacesSidebar)||(()=>{const e=new Date;xf({...m,suggestedWorkspacesSidebar:{dateShown:e}}),vf()})(),s?l(!1):(mv({numPendingInvites:o?o.length:0,suggestedWorkspaces:e,entryPoint:pv.Sidebar,isQualifiedLead:n}),l(!0))}},i.createElement("div",{className:`${Fhe} ${s?Zhe:""}`,style:{left:c.x+10,top:c.y}},"Click to see Suggested Workspaces"),i.createElement(Mt,{className:Jhe}),(null==m?void 0:m.suggestedWorkspacesSidebar)?null:i.createElement("div",{className:`${ege} ${nge}`},null==e?void 0:e.teams.length)),s&&i.createElement(Ege,{suggestedWorkspaces:e,close:()=>l(!1),tooltipPosition:c}))},wge=()=>{var e,t;const a=Si(),o=m.exports.useDispatch(),{allTeams:n,userTeamInvites:s,currentTeamId:l,notifications:d,suggestedWorkspaces:c,currentUser:u}=tr((e=>({currentTeamId:e.teams.selectedTeamId,allTeams:e.teams.allTeams,userTeamInvites:e.teams.userTeamInvites,notifications:e.notifications.notifications,suggestedWorkspaces:e.workspaces.suggestedWorkspaces,currentUser:e.currentUser.user})),ar),[p,h]=r.exports.useState(void 0),g=rd(l),[y,f]=r.exports.useState(!1),[E,v]=r.exports.useState(!1),[w,b]=r.exports.useState(!1),_=r.exports.useRef(!1),[T,S]=r.exports.useState({x:0,y:0}),I=(null==(t=null==(e=u.onboarding)?void 0:e.survey)?void 0:t.usage)===yn.School;r.exports.useEffect((()=>{(async()=>{try{o(HE())}catch(YEe){Iu({description:"There was a problem fetching your invites. Please try again later.",error:YEe})}})()}),[o,d]),r.exports.useEffect((function(){XP()}),[]),r.exports.useEffect((function(){var e;(null==c?void 0:c.isQualifiedLead)&&(e=c.isQualifiedLead,amplitude.getInstance().setUserProperties({"Is Qualified Lead":e,Domain:Kf()}))}),[null==c?void 0:c.isQualifiedLead]);const x=async e=>{if(!_.current){_.current=!0;try{await CQ(e)}catch(YEe){console.error(YEe)}finally{_.current=!1}}},k=e=>{const t=e._id===l;return a?i.createElement("div",{onClick:async()=>{x(e._id),f(!1)},className:`${Vhe} ${t?jhe:""}`,key:e._id},i.createElement("div",{className:`${Hhe} ${t?jhe:""}`},i.createElement(SQ,{team:e,className:qhe})),i.createElement("div",{className:Lhe},e.name)):i.createElement("div",{className:Ohe,key:e._id},i.createElement("div",{onClick:async()=>{x(e._id)},className:`${Hhe} ${t?jhe:""}`,onMouseEnter:t=>{const a=t.currentTarget.getBoundingClientRect(),{x:o}=a,n=a.height/2+a.top;h(e),S({x:o+38,y:n})},"data-testid":"workspace-selector-workspace-thumbnail"},i.createElement(SQ,{team:e,className:qhe})))},C=(null==c?void 0:c.isQualifiedLead)&&c.teams.length>0&&!I,A=()=>{v(!0)};return i.createElement(i.Fragment,null,E&&i.createElement(Aue,{onClose:()=>{v(!1)},entryPoint:eE.WORKSPACE_HEADER}),w&&i.createElement(yge,{onClose:()=>b(!1)}),a?i.createElement("div",{className:Nhe,"data-cy":"workspace-selector","data-testid":"workspace-selector"},i.createElement("div",{className:Mhe},i.createElement("div",{className:zhe,onClick:()=>{f(!y)}},i.createElement("div",{className:Hhe},i.createElement(SQ,{team:g,className:qhe})),i.createElement("div",{className:Lhe,"data-cy":"team-workspace-name"},null==g?void 0:g.name),i.createElement("div",{className:$he},y?i.createElement(lo,null):i.createElement(co,null))),i.createElement(s9,{icon:i.createElement("div",{className:Khe,onClick:A},i.createElement(Ja,null)),className:Yhe})),y&&a&&i.createElement(fge,{userTeamInvites:null!=s?s:[],allTeams:null!=n?n:[],renderWorkspace:k,close:()=>f(!1)})):i.createElement("div",{className:Nhe,"data-cy":"workspace-selector","data-testid":"workspace-selector"},i.createElement("div",{className:Mhe},null==s?void 0:s.map((e=>i.createElement(hge,{invite:e,key:e._id}))),null==n?void 0:n.map((e=>k(e))),C&&i.createElement(vge,{suggestedWorkspaces:c}),p?i.createElement("div",{className:Phe,style:{left:T.x,top:T.y},"data-testid":"workspace-tooltip"},i.createElement("div",null,i.createElement(Yue,{overrideTeam:p})),i.createElement("div",{className:Lhe,translate:"no"},p.name),i.createElement("div",null,"-"),i.createElement("div",null,null==(N=p.users)?void 0:N.length,i.createElement("span",null," Member"),(null==(P=p.users)?void 0:P.length)>1&&i.createElement("span",null,"s"))):null),i.createElement("div",{className:mge},i.createElement(wD,{vertical:!0,darkColorsOnly:!0}))));var N,P},bge="GenericHeroBanner-module_promptBanner_Sz541",_ge="GenericHeroBanner-module_container_zS1FD",Tge="GenericHeroBanner-module_head_szIEH",Sge="GenericHeroBanner-module_body_tB7IS",Ige="GenericHeroBanner-module_iconClose_ey5KI",xge="GenericHeroBanner-module_smallBody_hc95K",kge="GenericHeroBanner-module_img_iEtQi",Cge="GenericHeroBanner-module_smallImg_mm7ae",Age=({adminOnly:e,heroImg:t,body:a,heading:o,onDismiss:n,testId:r,small:s,buttonText:l,onClick:d})=>{const c=IE(tr((e=>e.currentUser)).user._id),u=kE(null==c?void 0:c.role);return e&&!u?null:i.createElement("div",{className:bge,"data-testid":r,"data-cy":r},i.createElement("img",{src:t.src,alt:t.alt,className:`${s?Cge:kge}`}),i.createElement("div",{className:_ge},i.createElement("div",null,i.createElement("div",{className:Tge},o),i.createElement("div",{className:s?xge:Sge},a)),l&&d&&i.createElement(kU,{overrideColor:"cyan",onClick:d},l),n&&i.createElement("div",{className:Ige,onClick:n},i.createElement(pe,null))))};var Nge=(e=>(e.ResetInviteLink="resetLink",e))(Nge||{});const Pge=()=>{const e=tr((e=>e.teams.activeTeamInvites)),t=sd(),a=tr((e=>e.teams.selectedTeamId)),{dispatch:o,history:n}=tn(),r=(()=>{const e=id();if(!e)return null;const t=e.prompts;if(!t)return null;for(const[a,o]of Object.entries(t))if(!o.dateAcknowledged)return a;return null})();if(!r)return null;if(r===Nge.ResetInviteLink){const r=()=>i.createElement("span",null,"Congrats on upgrading to the full Kapwing experience! You can now use all of our premium features.",i.createElement("br",null),i.createElement("br",null),"You’ll be billed ",i.createElement("b",null,"per member")," in your workspace, and all members will be able to use these features. You can"," ",i.createElement("b",null,"reset your join link")," so only members you invite going forward can join your workspace."," ",e.length?i.createElement("span",null,i.createElement("b",null,"You have ",e.length," pending"," ",Qs("invite","invites",e.length)," ","out"),"—to remove these, go to Workspace Settings."):null);return{heading:`Welcome to ${t.name}, ${Yf()}!`,heroImg:{src:"https://cdn-useast1.kapwing.com/static/BFg-welcome-to-pro-hero-img.webp",alt:`welcome to ${t.name}`},body:i.createElement(r,null),buttonText:"Go to settings",onClick:()=>{n.push(`/team/${a}/members`)},onDismiss:async()=>{await o($E(a,{"prompts.resetLink":{dateAcknowledged:new Date}})),o(GE())},adminOnly:!0}}return null},Rge=()=>{const e=xD(),{currentUser:t,currentFolderId:a,allFolders:o,teamId:n}=tr((e=>({currentUser:e.currentUser,currentFolderId:e.workspaces.selectedWorkspace,allFolders:e.workspaces.allWorkspaces,teamId:e.teams.selectedTeamId})),ar),s=Ee(),l=m.exports.useDispatch(),d=Ie(),c=oe(),u=Si(),p=gae(),[h,g]=r.exports.useState({}),[y,f]=r.exports.useState(""),[E,v]=r.exports.useState(!1),[w,b]=r.exports.useState(!1),[_,T]=r.exports.useState(!0),[S,I]=r.exports.useState(!1),[x,k]=r.exports.useState("");r.exports.useEffect((function(){sc(t)?C():(d.push(`/signin?next=${c.pathname}${c.search}`),l(Su({description:"You must be signed in to view this page.",type:"error"})))}),[]),r.exports.useEffect((function(){n&&RE(n)}),[n]),r.exports.useEffect((function(){const e=new URLSearchParams(c.search);if(e.has(hi.ScheduledMarketingEmail)){vc("Visit From Marketing Email",{"Template Id":e.get(hi.ScheduledMarketingEmail)||void 0})}}),[c.search]);const C=r.exports.useCallback((async()=>{const e=s.params.teamId||!1,t=s.path.includes(mi)?mi:s.params.id,o=!e&&(null!=t?t:a)||"";await l(jE());const n=await l(gR(o,e));["/brandkit","/team/request","/shared-with-me"].includes(s.url)||s.url.includes("/team/")||d.push({pathname:`/folder/${n}`,state:d.location.state,search:d.location.search}),T(!1),l(VE())}),[l,d,s.url]);r.exports.useEffect((function(){return()=>{l(bu())}}),[l]),r.exports.useEffect((()=>{I(!1)}),[n]),r.exports.useEffect((function(){var e;(null==(e=c.state)?void 0:e.openModal)===EJ.account&&b(!0)}),[c.state]),r.exports.useEffect((()=>{!async function(){var a;if(o.length<2)return void k(n);if(S||!n)return;I(!0);const{token:r,user:i}=t,s={token:r,userId:null==i?void 0:i._id,teamId:n};let l,d=!0;for(;d;){if(!e.current)return;let t;try{t=await hu("/api/v1/workspaces/loadVideos",{params:s,signal:p.signal})}catch(YEe){break}const o=t||[],n={};if(l=null==(a=o.slice(-1)[0])?void 0:a._id,s.lastId=l,o){o.forEach((e=>{const t=n[e.workspaceId];t?t.push(e):n[e.workspaceId]=[e]}));for(const e of Object.keys(n)){if(e===y)continue;const t=n[e];t&&P(t,e)}s.lastId||(d=!1)}else d=!1}k(n)}()}),[n,o,t]);r.exports.useEffect((()=>{(async(e,t)=>{var a,o;if(!e)return;v(!1);let n=!0;for(t.lastId="";n;){let i;try{e===mi?(i=await hu("/api/v1/sharedProjects",{params:t,signal:p.signal}),v(!0)):(i=await hu("/api/v1/home",{params:t,signal:p.signal}),v(!0))}catch(YEe){YEe instanceof Error&&(r=YEe,console.error(r),vc("Failed to load workspace",{message:BO(r),status:r instanceof cu?r.status:void 0}));break}const s=i.projects,d=null==(a=i.workspace)?void 0:a._id,{brandkitTemplates:c}=i;d!==y&&f(d),c&&l(WE(c)),s?(P(s,e),t.lastId=null==(o=s.slice(-1)[0])?void 0:o[d===mi?"sharedId":"_id"],(!t.lastId||s.length<50)&&(n=!1)):n=!1,e!==y&&(n=!1)}var r})(y,{...h})}),[y]),r.exports.useEffect((()=>{x&&function(e){if(iv.has(e))return;iv.add(e);const{workspaces:t,projects:a}=tn().state,{allWorkspaces:o}=t,n=new Set(o.filter((t=>t.teamId===e)).map((e=>e._id))),r=Object.keys(a.projectIdsByFolderId).filter((e=>n.has(e))).reduce(((e,t)=>e+Object.keys(t).length),0),i=n.size;vc("All Workspace Folders Loaded",{"Workspace ID":e,"Number of Projects":r,"Number of Folders":i})}(x)}),[x]);const A=r.exports.useCallback((async()=>{if(["/folder","/folder/"].includes(s.url))a?d.push(`/folder/${a}`):F();else if("/folder/:id"===s.path&&s.params.id){const t=s.params.id;if(t!==a&&!["invite","create"].includes(t))if(nP(t))l(yv(t));else{const a=await(e=t,e?hu(`/api/v1/workspaces/${e}`):null);if(a)CQ(a.teamId,t),l(yv(t));else{l(Su({description:`There was an error with navigating to folder ${t}.`,type:"error"}));const e=uP();l(yv(e)),d.push(`/folder/${e}`)}}}else["/shared-with-me","/shared-with-me/"].includes(s.url)&&a!==mi&&l(yv(mi));var e}),[s.url]);r.exports.useEffect((()=>{A()}),[A,s.url]);const N=(e,t)=>{g(t),f(e)},P=(e,t)=>{l(aL({projects:e,folderId:t}))},R=r.exports.useCallback((async e=>{if(!e)return;const t=(await hu("/api/v1/home",{params:e})).projects||[];if(!t)return;const{workspaceId:a}=e;l(aL({projects:t,folderId:a.toString()}))}),[l]),L=Pge(),D=()=>i.createElement(i.Fragment,null,L&&i.createElement("div",{className:_he},i.createElement(Age,{heading:L.heading,heroImg:L.heroImg,body:L.body,buttonText:L.buttonText,onClick:L.onClick,onDismiss:L.onDismiss,adminOnly:L.adminOnly||!1})),O()),O=r.exports.useCallback((()=>i.createElement(dJ,{fetchNewProjects:R,startFetchingProjects:N,initialProjectsLoaded:E})),[R,E]),F=r.exports.useCallback((async()=>{let e;T(!0);try{e=await l(gR("",n))}catch(YEe){console.error(YEe)}return e?(T(!1),d.push(`/folder/${e}`)):(l(Su({description:"There was an error loading your folders.",type:"error"})),l(LE("")),sc(t)?d.push("/home"):d.push("/signin"))}),[l,d,t,n]);return sc(t)?_?i.createElement(oJ,{title:"Loading your workspace..."}):i.createElement(i.Fragment,null,i.createElement(XQ,null),!u&&i.createElement(wge,null),i.createElement(Hue,{width:282,openAccountSettings:()=>b(!0)}),i.createElement(Che,null),i.createElement(Jme,{openAccountSettings:()=>b(!0)}),i.createElement("div",{className:whe},u&&i.createElement(wge,null),i.createElement("div",{className:bhe}),w&&i.createElement(vhe,{closeAccountSettings:()=>{b(!1),window.history.replaceState({},document.title)}}),i.createElement(yt,null,i.createElement(ft,{exact:!0,path:"/brandkit",component:cJ}),i.createElement(ft,{exact:!0,path:"/folder/:id",render:D}),i.createElement(ft,{exact:!0,path:"/folder/:id/rename",render:D}),i.createElement(ft,{exact:!0,path:"/folder/create",render:D}),i.createElement(ft,{exact:!0,path:"/folder/:id/create",render:D}),i.createElement(ft,{exact:!0,path:"/shared-with-me",render:D}),i.createElement(ft,{path:"/team/:id",component:iJ}),i.createElement(ft,{path:"/settings",component:sJ}),i.createElement(ft,{path:"/settings/folder/cancel",component:sJ})))):i.createElement(Da,{to:"/signin"})},Lge=()=>{const e=tr((e=>{var t;return null==(t=e.currentUser.user)?void 0:t._id})),t=m.exports.useDispatch(),a=r.exports.useRef(null);return r.exports.useEffect((function(){const o=(()=>{const{token:e}=tn().state.currentUser;return e})();if(o){const n=new mo(`${function(){let e;e=xn?xn.replace("http","ws"):`wss://notifications.${ru()||ou().includes("dev")?"kapwing-dev":"kapwing"}.com`;return`${e}/websocket`}()}?token=${o}&userId=${e}`,[],{maxReconnectionDelay:7e3});let r;n.addEventListener("open",(()=>{r=window.setInterval((()=>{n.send('{"keepAlive":"heartbeat"}')}),1e4)})),n.addEventListener("message",(e=>{const a=JSON.parse(e.data);a.userNotifs&&t(JR(a.userNotifs)),a.newNotifs&&t(QR(a.newNotifs))})),n.addEventListener("error",(e=>{console.error("Error connecting to notifications websocket",e),window.clearInterval(r)})),n.addEventListener("close",(()=>{window.clearInterval(r)})),a.current=n}return()=>{var e;null==(e=a.current)||e.close()}}),[t,e]),null},Dge="ActionDialog-module_section_gUotP",Oge="ActionDialog-module_sectionLabel_ZGnw6",Fge="ActionDialog-module_nameInput_hio-R",Mge="ActionDialog-module_buttonContainer_vCK2-",Uge="ActionDialog-module_actionButton_Ub-Ks",Bge=e=>tr((t=>{var a;if(!e||!e.length)return t.projectName||"Studio Project";if(e.length>1)return"Projects";const o=e[0];return t.projectName||o&&((null==(a=t.projects.byId[o])?void 0:a.name)||t.studio.projectName)||"Studio Project"})),Wge="TeamUserRow-module_userRow_9vAPY",Vge="TeamUserRow-module_userInfo_CUcTw",jge="TeamUserRow-module_profilePic_Mgzws",Gge="TeamUserRow-module_nameBlock_l3RWW",Hge="TeamUserRow-module_name_1XLhX",zge="TeamUserRow-module_email_5dzfn",$ge="TeamUserRow-module_role_-sZSl",Kge=({teamUser:e,onClick:t})=>{const{user:a}=e;return a?i.createElement("div",{className:Wge,onClick:t?()=>t(a):void 0},i.createElement("div",{className:Vge},i.createElement("div",{className:jge},i.createElement(SQ,{suggestedHeight:60,suggestedWidth:60,user:a})),i.createElement("div",{className:Gge},i.createElement("div",{className:Hge},a.name),i.createElement("div",{className:zge},a.email))),i.createElement("div",{className:$ge},e.role===li.admin?"Admin":"Editor")):null},Yge="Modal-module_modalContainer_5Unq-",qge="Modal-module_headerContainer_OyWj9",Xge="Modal-module_header_KC9qk",Jge="Modal-module_subheader_-DyNh",Qge=({title:e,subHeader:t})=>i.createElement("div",{className:qge},e&&i.createElement("div",{"data-cy":"modal-title",className:Xge},e),t&&i.createElement("div",{"data-cy":"modal-subheader",className:Jge},t)),Zge="Chooser-module_container_eRF4d",eye="Chooser-module_chooserBar_2mgUb",tye="Chooser-module_disabledBar_byZeP",aye="Chooser-module_team_h6hG0",oye="Chooser-module_name_PA6sa",nye="Chooser-module_nameText_dUjUJ",rye="Chooser-module_chooser_AZWDB",iye="Chooser-module_teamRow_PKkVd",sye="Chooser-module_folderName_RonTp",lye="Chooser-module_middleArrow_dES8C",dye="Chooser-module_dropdownChevron_X3e87",cye="Chooser-module_rotateChevron_Cn8Q5",uye="Chooser-module_chooserRow_KsiaA",mye="Chooser-module_selected_7Rpnw",pye="Chooser-module_nameIcon_RoXZA",hye="Chooser-module_chevron_l-HOJ",gye="Chooser-module_sectionTitle_ltcTl",yye="Chooser-module_explorerBodyWrapper_Rul90",fye="Chooser-module_show_LiUuA",Eye="Chooser-module_disabled_ROhdT",vye="Chooser-module_explorerBody_IUVk9",wye="Chooser-module_folderSection_haXPb",bye="Chooser-module_explorer_hos6-",_ye="Chooser-module_explorerHeader_0-UCB",Tye="Chooser-module_clickableArea_tqMod",Sye="Chooser-module_selectWorkspace_rjOcL",Iye="Chooser-module_loadingHeader_fVjHu",xye="Chooser-module_spinner_VCI5G",kye="Chooser-module_leftArrow_GZuaS",Cye="Chooser-module_userRow_NlpIA",Aye="Chooser-module_teamUserWrapper_Am94t",Nye="Chooser-module_permissionDialog_9vcVJ",Pye="Chooser-module_chooserFolderContainer_dFoSe",Rye=({onClick:e,selected:t,icon:a,label:o,chevron:n})=>i.createElement("div",{className:`${uye} ${t?mye:""}`,onClick:e},i.createElement("div",{className:oye},a?i.createElement("div",{className:pye},a):null,i.createElement("div",{className:nye},o)),n&&i.createElement("div",{className:hye},i.createElement(po,null))),Lye=({selectedTeam:e,setSelectedFolder:t,selectedFolderId:a,setSelectedTeam:o,show:n,disabled:r})=>{const{teams:s,teamFolders:l,privateFolders:d}=(e=>{const t=tr((e=>e.explorer.teams),ar),a=tr((t=>t.explorer.folders.filter((t=>t.teamId===e))),ar);return{teams:t,teamFolders:a.filter((e=>e.type===Jr.team)),privateFolders:a.filter((e=>e.type===Jr.personal))}})(null==e?void 0:e._id),c=(e,o)=>e.length?i.createElement("div",{className:wye},i.createElement("div",{className:gye},o),i.createElement("div",{"data-cy":"chooser-folder-container",className:Pye},e.map((e=>i.createElement(Rye,{key:e._id,label:e.name,icon:Ga({}),onClick:()=>t(e),selected:a===e._id}))))):null;return s&&s.length?i.createElement("div",{className:`${yye} ${n?fye:""} ${r?Eye:""}`},i.createElement("div",{className:_ye},!!e&&i.createElement("div",{className:aye},i.createElement("div",{className:`${Sye} ${Tye}`,onClick:()=>o(void 0)},i.createElement("span",{className:kye},i.createElement(ho,null)),"Select a different team workspace"))),i.createElement("div",{className:vye},e?i.createElement(i.Fragment,null,c(l,(null==e?void 0:e._id)===mi?"Shared Folders":"Team Folders"),c(d,"Private Folders")):i.createElement("div",{"data-cy":"chooser-folder-container",className:Pye},s.map((e=>i.createElement(Rye,{key:e._id,label:e.name,onClick:()=>o(e),icon:e._id===mi?i.createElement(go,{size:25}):i.createElement(SQ,{suggestedHeight:30,suggestedWidth:30,team:e}),chevron:!0})))))):i.createElement("div",null,"Loading...")},Dye="TeamRow-module_team_cY9aX",Oye="TeamRow-module_profilePic_K3D3u",Fye="TeamRow-module_name_WC82v",Mye=({team:e,onClick:t,short:a})=>i.createElement("div",{className:Dye,onClick:t?()=>t(e):void 0},i.createElement("div",{className:Oye},e._id===mi?i.createElement(go,{size:30}):i.createElement(SQ,{suggestedHeight:30,suggestedWidth:30,team:e})),!a&&i.createElement("div",{className:Fye},e.name)),Uye=({selectedTeam:e,folder:t,onTeamClick:a,setShowExplorer:o,showExplorer:n,disabled:r})=>{const s=Si();if(!e)return null;const l=n&&!!e;return i.createElement("div",{"data-cy":"folder-chooser-header",className:`${eye} ${r?tye:""}`,onClick:()=>!r&&o()},i.createElement("div",{className:rye},i.createElement("div",{className:iye,onClick:e=>l&&e.stopPropagation()},i.createElement(Mye,{team:e,onClick:l?a:void 0,short:s})),i.createElement("div",{className:lye},i.createElement(po,null)),t&&i.createElement("div",null,i.createElement("div",{className:sye},t.name))),i.createElement("div",{className:`${dye} ${n?cye:""}`},i.createElement(Jt,null)))},Bye=({setDestinationFolderId:e,disabled:t,startOpen:a})=>{const{showExplorer:o,setShowExplorer:n,selectedFolder:s,setSelectedFolder:l,selectedTeam:d,setSelectedTeam:c,isLoading:u}=((e,t)=>{Du(!0);const a=aP(),[o,n]=r.exports.useState(a),i=tr((e=>e.explorer.teams)),s=id(),[l,d]=r.exports.useState(i.find((e=>(null==a?void 0:a.teamId)?e._id===(null==a?void 0:a.teamId):e._id===(null==s?void 0:s._id)))),c=!i.length,[u,m]=r.exports.useState(!!t||!l),[p,h]=r.exports.useState(!0);r.exports.useEffect((()=>{e((null==o?void 0:o.teamId)?o._id:"")}),[null==o?void 0:o._id,null==o?void 0:o.teamId,e]);const g=tr((e=>{const t=e.explorer.folders.filter((e=>e.teamId===(null==l?void 0:l._id)));return 1===t.length?t[0]:void 0}));return r.exports.useEffect((function(){l?g&&n(g):n(void 0)}),[l,g]),{viewingFolder:p,setViewingFolder:h,showExplorer:u,setShowExplorer:m,selectedFolder:o,setSelectedFolder:n,selectedTeam:l,setSelectedTeam:d,isLoading:c}})(e,a);return i.createElement("div",{className:Zge},u?i.createElement("div",{className:Iye},i.createElement($t,{className:xye})):i.createElement(i.Fragment,null,!!d&&i.createElement(Uye,{disabled:t,selectedTeam:d,folder:s,onTeamClick:()=>{n(!0),c(void 0)},showExplorer:o,setShowExplorer:e=>n((t=>void 0!==e?e:!t))}),i.createElement("div",{className:bye},i.createElement(Lye,{disabled:t,show:o||!d,selectedTeam:d,setSelectedTeam:c,selectedFolderId:null==s?void 0:s._id,setSelectedFolder:l}))))},Wye="AdminMoveDialog-module_input_2j5CX",Vye=({setDestinationFolderId:e,setHideDropdown:t})=>{const[a,o]=r.exports.useState(""),n=Si();if(!dc(tr((e=>e.currentUser)))||n)return null;return i.createElement("input",{type:"text",className:Wye,value:a,onChange:a=>(a=>{t(!0);const n=a.target.value.trim();o(n),e(n)})(a),placeholder:"ADMIN: Enter folder ID to move project to"})},jye=(e,t,a,o)=>{const n=gae(),[s,l]=r.exports.useState(),[d,c]=r.exports.useState(!1),[u,m]=r.exports.useState(),[p,h]=r.exports.useState(),[g,y]=r.exports.useState(!1),{destinationFolder:f,currentUser:E}=tr((e=>({destinationFolder:e.explorer.folders.find((e=>e._id===s)),currentUser:e.currentUser})),ar),v=async()=>{if(!d&&s)try{if(c(!0),await t(s),n.signal.aborted)return;c(!1)}catch(YEe){Iu({description:"Error moving project",error:YEe}),c(!1)}};return{destinationFolderId:s,setDestinationFolderId:l,processing:d,showPermissions:g,permissionText:u,permissionUsers:p,handleSubmit:g?v:async()=>{if((()=>{const t=s&&24===s.length&&!f;return e===Tn.MOVE&&dc(E)&&t})())return void v();if(!s||!f||!(null==o?void 0:o.length))return;c(!0);const t=await gu("/api/v1/explorer/comparePermissions",{body:{projectIds:o,destinationFolderId:s}});t.permissionResult!==_n.SAME&&(t.permissionResult!==_n.CHANGE_TEAMS||t.destinationFolder.type!==Jr.personal||t.sourceFolder.type!==Jr.personal)&&(e!==Tn.COPY||t.destinationFolder.type!==Jr.personal&&t.permissionResult!==_n.SHARED_TO_PRIVATE)?(y(!0),m(((e,t,a,o)=>{var n,r;const{permissionResult:s}=t;if(s===_n.SAME)return;const{sourceTeam:l,destinationTeam:d}=t;if(s===_n.PRIVATE_TO_SHARED){if(!(null==(n=t.users)?void 0:n.length))throw new Error(`No users found - private to shared team:${t.destinationTeam._id}`);return i.createElement("span",null,i.createElement("span",null,e===Tn.COPY?"Copying":"Moving")," ","this project to"," ",i.createElement("strong",null,l._id===d._id?a:d.name)," ","will give access to ",null==(r=t.users)?void 0:r.length," ",Qs("collaborator","collaborators",t.users.length),":")}return s===_n.SHARED_TO_PRIVATE?i.createElement("span",null,"All members of ",i.createElement("strong",null,l.name)," will lose access unless the ",Qs("project has","projects have",o)," ","been explicitly shared with them"):i.createElement("span",null,e===Tn.MOVE&&i.createElement("span",null,"All members of ",i.createElement("strong",null,l.name)," will lose access unless the ",Qs("project has","projects have",o)," ","been explicitly shared with them."),i.createElement("span",null,"All members of ",i.createElement("strong",null,d.name)," will gain access."))})(e,t,null==f?void 0:f.name,o.length)),h(t.users),c(!1)):v()},handleBack:g?()=>{y(!1),m(""),h(void 0)}:a}},Gye=({actionType:e,children:t,submitText:a,header:o,onSubmit:n,onCancel:s=Nu,validationFunction:l,projectIds:d})=>{const{destinationFolderId:c,setDestinationFolderId:u,showPermissions:m,permissionText:p,permissionUsers:h,handleSubmit:g,handleBack:y,processing:f}=jye(e,n,s,d),[E,v]=r.exports.useState(!1);return i.createElement("div",{className:Nye,onKeyUp:e=>{"Enter"===e.key&&g()},tabIndex:0},i.createElement(Qge,{title:o,subHeader:p}),m?h&&h.length&&i.createElement("div",{className:Aye},h.map((e=>e.user&&i.createElement("div",{className:Cye,key:e._id},i.createElement(Kge,{teamUser:e}))))):i.createElement(i.Fragment,null,!!t&&t,i.createElement(Hye,{label:e===Tn.COPY?"Copy to:":"Move to:"},e===Tn.MOVE&&i.createElement(Vye,{setDestinationFolderId:u,setHideDropdown:v}),i.createElement(Bye,{disabled:f||E,setDestinationFolderId:u,startOpen:e===Tn.MOVE}))),i.createElement("div",{className:Dge},i.createElement("div",{className:Mge},i.createElement("div",{className:Uge},i.createElement(kU,{testId:"permission-confirm-button",disabled:l?f||!c||!l(c):f||!c,loading:f,fullWidth:!0,onClick:g},a||"Confirm")),i.createElement("div",{className:Uge},i.createElement(kU,{fullWidth:!0,overrideColor:"gray",onClick:y,disabled:f},m?"Back":"Cancel")))))},Hye=e=>{const{children:t,label:a}=e;return i.createElement("div",{className:Dge},i.createElement("div",{className:Oge},a),t)},zye=({projectId:e,onSubmit:t,name:a})=>{const o=Bge([e]),[n,s]=r.exports.useState(a||(e=>{var t;const a=e.match(/^(.*) \((\d+)\)$/);if(a)return`${a[1]} (${parseInt(null!=(t=a[2])?t:"0")+1})`;return`${e} (1)`})(o)),l=i.createElement("span",null,"Copy ",i.createElement("strong",null,a||o)," ");return i.createElement(Gye,{actionType:Tn.COPY,header:l,submitText:"Copy",onSubmit:e=>t({destinationFolderId:e,name:n}),projectIds:[e]},i.createElement(Hye,{label:"Name"},i.createElement("div",{className:Fge},i.createElement("input",{"data-cy":"copy-project-name-input",type:"text",value:n,onChange:e=>s(e.target.value)}))))};const $ye={home:"DeleteAccountDialog-module_home_Qy1p-",homeHowBackgroundWhite:"DeleteAccountDialog-module_homeHowBackgroundWhite_5vrqM",largeButton:"DeleteAccountDialog-module_largeButton_h2PKs",sectionContent:"DeleteAccountDialog-module_sectionContent_6qcDC",sectionHeader:"DeleteAccountDialog-module_sectionHeader_ItYW9",spacer:"DeleteAccountDialog-module_spacer_Y4qhY",chevron:"DeleteAccountDialog-module_chevron_naSaT",splashText:"DeleteAccountDialog-module_splashText_4nLL-",splashSubtext:"DeleteAccountDialog-module_splashSubtext_gZdO0",aboutSection:"DeleteAccountDialog-module_aboutSection_71h7k",mobile:"DeleteAccountDialog-module_mobile_2zyNO",desktop:"DeleteAccountDialog-module_desktop_aF2sB",screenReaderOnlyLabel:"DeleteAccountDialog-module_screenReaderOnlyLabel_XKEKm",disabled:"DeleteAccountDialog-module_disabled_4xGKa",noScrollBar:"DeleteAccountDialog-module_noScrollBar_46jsu",textOverflowEllipsis:"DeleteAccountDialog-module_textOverflowEllipsis_rOly5",genericButtonBlue:"DeleteAccountDialog-module_genericButtonBlue_piiJU",deleteDialogBackground:"DeleteAccountDialog-module_deleteDialogBackground_gA2AW",deleteDialogContainer:"DeleteAccountDialog-module_deleteDialogContainer_LJLDS",header:"DeleteAccountDialog-module_header_I1ivc",description:"DeleteAccountDialog-module_description_Ribr-",deleteCloseContainer:"DeleteAccountDialog-module_deleteCloseContainer_AVeX5",buttonsContainer:"DeleteAccountDialog-module_buttonsContainer_g-4V6",primaryButton:"DeleteAccountDialog-module_primaryButton_9jXzj",secondaryAction:"DeleteAccountDialog-module_secondaryAction_067Qv",loading:"DeleteAccountDialog-module_loading_WMwqn",checkBoxContainer:"DeleteAccountDialog-module_checkBoxContainer_OGqPY",checkBox:"DeleteAccountDialog-module_checkBox_8ZfOY",checkBoxText:"DeleteAccountDialog-module_checkBoxText_B6PNC",italicBold:"DeleteAccountDialog-module_italicBold_I-A-q"},Kye=()=>{const e=m.exports.useDispatch(),t=Ie(),[a,o]=r.exports.useState(!1),[n,s]=r.exports.useState(!0);r.exports.useEffect((function(){((e,t)=>{const{dispatch:a}=tn();a({type:Au.setModalTitle.type,payload:{title:e,subtitle:t}})})("Delete Account")}),[]);return i.createElement(i.Fragment,null,i.createElement("div",{className:$ye.description},i.createElement("p",null,"Deleting your account will delete"," ",i.createElement("b",null,"all private workspaces and content")," associated with your account — all links and embeds to existing content will no longer work. Shared workspaces will still exist for you and others who have access."),i.createElement("p",null,"To get help with your subscription or account, contact us at",i.createElement("a",{href:"mailto:help@kapwing.com"}," help@kapwing.com")," before deleting your data."),i.createElement("div",{className:$ye.checkBoxContainer},i.createElement("input",{type:"checkbox",className:$ye.checkBox,onClick:()=>s(!n)}),i.createElement("div",{className:$ye.checkBoxText},"I acknowledge that I will no longer receive support regarding my projects, workspaces, or subscription from Kapwing's customer support team. After deleting, I will not be eligible for any refund for past purchases or remaining subscription time.")),i.createElement("p",{className:$ye.italicBold},"This action cannot be undone. You will be signed out once your account deletion is complete. All data will be erased from Kapwing's database.")),i.createElement("div",{className:$ye.buttonsContainer},a?i.createElement("div",{className:$ye.loading},"Deleting..."):i.createElement(i.Fragment,null,i.createElement("div",{className:`${$ye.primaryButton} ${n?$ye.disabled:""}`,onClick:n?void 0:async()=>{o(!0);try{await e(((e,t)=>{const{user:a}=t().currentUser||{},{_id:o}=a||{};return pu("/api/v1/account",{params:{userId:o},parseJSON:!1})})),e(Su({description:"Your account has been successfully deleted and you have been signed out of Kapwing. Sign in again to create a new account.",type:"success"}))}catch(YEe){Iu({description:"There were errors when deleting your account. Not all of your content may be deleted.",error:YEe})}finally{e(Jc()),t.push("/"),jc.remove("state")}}},"Delete Account"),i.createElement("div",{onClick:()=>Nu(),className:$ye.secondaryAction},"Never mind"))))},Yye=({projectIds:e,onSubmit:t,onCancel:a})=>{const o=tr((e=>e.workspaces.selectedWorkspace)),n=Bge(e),r=i.createElement("span",null,"Move ",i.createElement("strong",null,n));return i.createElement(Gye,{actionType:Tn.MOVE,onSubmit:t,onCancel:a,validationFunction:e=>e!==o,header:r,projectIds:e,submitText:"Move"})},qye=()=>{Du();const{modalType:e,title:t,name:a,subtitle:o,projectIds:n,projectId:r,modalStyle:s,onSubmit:l,onCancel:d}=(()=>{const e=tr((e=>e.modal)),{title:t,subtitle:a}=e,{modalType:o,name:n,projectId:r,projectIds:i,teamId:s,onSubmit:l,onCancel:d,modalStyle:c}=e.modalProps;return{modalType:o,name:n,title:t,subtitle:a,projectId:r,projectIds:i,modalStyle:c,teamId:s,onSubmit:l,onCancel:d}})();if(!e)return null;return i.createElement(_O,{unsetCancelModal:d||Nu,usePortal:!0,noPadding:null==s?void 0:s.noPadding,noCloseButton:null==s?void 0:s.noClose,noWidth:null==s?void 0:s.noWidth},i.createElement("div",{className:(null==s?void 0:s.noPadding)?"":Yge,"data-cy":"kapwing-modal-overlay"},!!t&&i.createElement(Qge,{title:t,subHeader:o}),i.createElement("div",null,(()=>{switch(e){case ku.EMBED_CODE:return i.createElement(Qoe,{hideOverlay:Nu});case ku.COPY_PROJECT:if(r&&l&&d)return i.createElement(zye,{onSubmit:l,projectId:r,onCancel:d,name:a});break;case ku.MOVE_PROJECT:if((null==n?void 0:n.length)&&l&&d)return i.createElement(Yye,{onSubmit:l,onCancel:d,projectIds:n});break;case ku.DELETE_ACCOUNT:return i.createElement(Kye,null)}return i.createElement("div",null)})())))},Xye="ExamplesAdmin-module_container_OMUJg",Jye="ExamplesAdmin-module_thumbnailContainer_yYdpH",Qye="ExamplesAdmin-module_thumbnail_1AR1M",Zye="ExamplesAdmin-module_header_S1iUl";class efe extends r.exports.Component{constructor(e){super(e),a(this,"getTemplateChildren",(()=>{const{currentTemplate:e,getTemplateChildren:t}=this.props;t(e._id).then((e=>{this.setState({children:e,loading:!1})})).catch((e=>{console.error(e),this.setState({loading:!1})}))})),this.state={children:[],loading:!0}}componentDidMount(){this.getTemplateChildren()}renderChildren(){const{children:e}=this.state;return e.length?i.createElement(i.Fragment,null,e.map((e=>{const t=oT(e);return i.createElement(at,{className:Jye,key:e._id,to:`/videos/${e._id}`},i.createElement("img",{src:t,className:Qye,alt:"Thumbnail",loading:"lazy"}))}))):i.createElement("div",null,"No children found.")}render(){const{loading:e}=this.state;return i.createElement("div",{className:Xye},i.createElement("div",{className:Zye},"Content created with this template:"),i.createElement("div",null,"Click to view the content. Use the admin actions on the content page to add the selected video to this template's examples."),i.createElement("span",null,e?"Loading children...":this.renderChildren()))}}const tfe=we(m.exports.connect((e=>({currentVideo:e.currentVideo,currentUser:e.currentUser,currentTemplate:e.currentTemplate})),(e=>me({getTemplateChildren:K3},e)))(efe)),afe="TemplateActions-module_container_PvTei",ofe="TemplateActions-module_header_uhiup",nfe="TemplateActions-module_actions_RMikg",rfe="TemplateActions-module_button_xLXlv",ife="TemplateActions-module_monospace_5pLR3",sfe=we(m.exports.connect((e=>({currentTemplate:e.currentTemplate})),(e=>me({showToast:Su},e)))((e=>{const{currentTemplate:t}=e;return i.createElement("div",{className:afe},i.createElement("div",{className:ofe},"Template admin actions"),i.createElement("div",null,"This section is visible only to admin accounts. The current template ID is:"," ",i.createElement("span",{className:ife},'ObjectId("',t._id,'")')),i.createElement("div",{className:nfe},i.createElement("div",{className:rfe,onClick:()=>{const{history:t}=e;t.push("/admin/templates/update")}},"Edit template"),i.createElement("div",{className:rfe,onClick:()=>{const{showToast:t,history:a,currentTemplate:o}=e;window.confirm(`Are you sure you want to delete ${o.title}?`)&&X3(o).then((e=>{t({description:"Template deleted!",type:"success"}),a.push("/admin/templates")})).catch((e=>{Iu({description:"An error occurred while deleting template.",error:e})}))}},"Delete template"),i.createElement("div",{className:rfe,onClick:t=>{const{history:a,currentTemplate:o}=e,n=`/videos/${o.video_id}`;a.push(n)}},"View video asset"),i.createElement("div",{className:rfe,onClick:()=>{const{history:t}=e;t.push("/admin/templates")}},"Back to all templates")),i.createElement(tfe,null))})));var lfe=(e=>(e.LANDING_PAGE_GET_STARTED="LANDING_PAGE_GET_STARTED",e.LANDING_PAGE_ADD_SAMPLE="LANDING_PAGE_ADD_SAMPLE",e.PASTE_LINK="PASTE_LINK",e.UPLOAD_FILES="UPLOAD_FILES",e.EDIT_THIS_TEMPLATE="EDIT_THIS_TEMPLATE",e.WORKSPACE="WORKSPACE",e.HOME_PAGE="HOME_PAGE",e))(lfe||{});const dfe=({entry:e,template:t,defaultOrigin:a=""})=>{const{dispatch:o}=tn();setTimeout((()=>{switch(e){case"PASTE_LINK":A4({callToAction:gc.PasteALink});break;case"UPLOAD_FILES":A4({callToAction:gc.UploadFiles});break;case"WORKSPACE":A4({callToAction:gc.NewContentWorkspace});break;case"LANDING_PAGE_ADD_SAMPLE":A4({callToAction:gc.Sample,template:t,originOverride:a});break;case"EDIT_THIS_TEMPLATE":o(Q3("explore")),A4({callToAction:gc.EditThisTemplate,template:t});break;case"HOME_PAGE":case"LANDING_PAGE_GET_STARTED":o(q_(a)),A4({callToAction:gc.GetStarted,originOverride:a})}o(nw())})),o(hg())};async function cfe(e){if("templates"===e.origin)return;const{dispatch:t,state:a}=tn();if(!l9(a))return;const o=Object.keys(e.thisProjectCMLFiles||{});0!==o.length&&(await async function(e){return await gu("/api/v1/cloudMediaLibrary/myMedia/addFiles",{body:{cmlFileIds:e}})}(o),t(Ry(o)))}function ufe(e=!1){const{dispatch:t,state:{currentUser:a,projectName:o,studio:n},history:r}=tn();t(uR(!0));const i=!n._id;t(Lg("http")),t(D4({currentUser:a,publish:!1,auto:e,createLocation:`studio-save-${e}`})).then((s=>{if(t(Dg("http")),_v(s.projectId,{name:o},a),t(uR(!1)),i&&cfe(n),uT()){if(!e||i){const e=r.location.pathname,{search:t}=r.location;lT(e,t)}else t(cR(!1));s&&mfe(s._id)}})).catch((e=>{Iu({description:"Failed to save video",error:e})})).finally((()=>{t(uR(!1))}))}async function mfe(e=null){const{dispatch:t,state:{studio:a}}=tn(),{scenes:o,draft:n}=a;try{if(n&&e&&!function(e){for(const t of e)for(const e of t.layers)if(e.uploadPending&&"pastedLink"===e.source)return!0;return!1}(o)){const[o,n]=await S4(a,fh.Thumbnail),r=JO(o,n);c$([r],{eventHandlers:{handleFinish:a=>{t(F4(a.url));const o={image_url:a.url};e&&U4(e,o)}},uploadOptions:{analyticsUploadSource:"Thumbnail upload",omitFromMediaLibrary:!0,isThumbnail:!0,skipUploadStatusUpdates:!0,uploadSourceComponent:"Save"}})}}catch(r){if(r&&"object"==typeof r&&"noRemoveBgUrl"in r&&r.noRemoveBgUrl)return;console.error(r)}}const pfe="AdminLongTailAnalytics-module_container_8q1rk",hfe="AdminLongTailAnalytics-module_adminLabel_Mspap",gfe="AdminLongTailAnalytics-module_analyticsRow_Faemz",yfe="AdminLongTailAnalytics-module_box_kteIn",ffe="AdminLongTailAnalytics-module_metricName_RigA8",Efe="AdminLongTailAnalytics-module_metricValue_I-nX5";class vfe extends r.exports.Component{constructor(e){super(e),this.state={loaded:!1,error:void 0}}async componentDidMount(){var e;const{currentUser:t}=this.props;if(!dc(t))return;let a=new URLSearchParams(window.location.search).get("path");a||(a=window.location.pathname);const{token:o}=t,n={token:o,userId:null==(e=null==t?void 0:t.user)?void 0:e._id,path:a};try{const e=await hu("/api/v1/admin/longTailAnalytics",{params:n});this.setState({...e,loaded:!0})}catch(YEe){const t=YEe instanceof Error?YEe.message:"Unknown error";this.setState({error:t,loaded:!0})}}render(){const{currentUser:e}=this.props,{loaded:t,pageViews:a,bounceRate:o,avgTimeOnPage:n,error:r}=this.state;return dc(e)&&t?i.createElement("div",{className:pfe},i.createElement("span",{className:hfe},"Page Analytics - Last 7 Days (Only Admins See This)"),r&&i.createElement("span",null,r),!r&&i.createElement("div",{className:gfe},i.createElement("div",{className:yfe},i.createElement("span",{className:ffe},"Page Views"),i.createElement("span",{className:Efe},a)),i.createElement("div",{className:yfe},i.createElement("span",{className:ffe},"Bounce Rate"),i.createElement("span",{className:Efe},o&&o.toFixed(2),"%")),i.createElement("div",{className:yfe},i.createElement("span",{className:ffe},"Average Time on Page"),i.createElement("span",{className:Efe},n&&n.toFixed(2)," seconds")))):null}}const wfe=we(m.exports.connect((e=>({currentUser:e.currentUser})))(vfe)),bfe=Object.freeze(Object.defineProperty({__proto__:null,default:wfe},Symbol.toStringTag,{value:"Module"})),_fe="LetterLinks-module_letterLinksContainer_QwlZ6",Tfe="LetterLinks-module_letterLinksHeader_N5w6H",Sfe="LetterLinks-module_letterLink_MD-Ac",Ife="LetterLinks-module_selectedLetterLink_ETw7G",xfe="LetterLinks-module_more_IoQTr",kfe="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),Cfe=({className:e,keyword:t,routePrefix:a})=>{const{letter:o}=wa();let n="";return o&&(n=o.toUpperCase()),i.createElement("div",{className:`${_fe} ${e||""}`},i.createElement("div",{className:Tfe},"Browse ",t," starting with:"),kfe.map((e=>i.createElement("div",{className:n===e?Ife:Sfe,key:e,"data-cy":"letter-link"},i.createElement(at,{to:`/${a}/directory/${e}`},e)))),i.createElement("div",{className:"MORE"===n?Ife:Sfe,key:o},i.createElement(at,{to:`/${a}/directory/more`,className:xfe},"*")),i.createElement("div",{className:Sfe,key:"all"},i.createElement(at,{to:`/${a}`,className:xfe},"All ",t)))},Afe="ExploreTemplate-module_splash_NuUxD",Nfe="ExploreTemplate-module_subtext_sgdJk",Pfe="ExploreTemplate-module_makeItSubtext_zveaE",Rfe="ExploreTemplate-module_wrapper_HwPsJ",Lfe="ExploreTemplate-module_container_5quob",Dfe="ExploreTemplate-module_infoContainer_qWYEA",Ofe="ExploreTemplate-module_contentContainer_KEVeX",Ffe="ExploreTemplate-module_video_ImBWU",Mfe="ExploreTemplate-module_image_3pgvL",Ufe="ExploreTemplate-module_mobileButton_uDFmq",Bfe="ExploreTemplate-module_desktopButton_DHIl1",Wfe="ExploreTemplate-module_buttonText_-5p0O",Vfe="ExploreTemplate-module_browseContainer_y97Be",jfe="ExploreTemplate-module_keywordHeader_5M1P9",Gfe="ExploreTemplate-module_keywords_scFRn",Hfe="ExploreTemplate-module_keyword_IasdR",zfe="ExploreTemplate-module_infoRow_YXndy",$fe="ExploreTemplate-module_bullet_0k1ZV",Kfe="ExploreTemplate-module_genericDescription_cZeSt",Yfe="ExploreTemplate-module_row_TZTsE",qfe="ExploreTemplate-module_icon_SNoVK";class Xfe extends r.exports.Component{constructor(e){super(e),a(this,"loadImage",(e=>{const t=e.getAttribute("src"),a=e.getAttribute("data-src");if(a){if(t===a)return;e.setAttribute("src",e.getAttribute("data-src")),e.onload=()=>{e.removeAttribute("data-src")}}})),a(this,"updateCurrentTemplate",(()=>{const{fetchTemplate:e,match:t,history:a}=this.props,{params:o}=t,{slug:n}=o;this.setState({loading:!0}),e(n).then((e=>{this.setState({loading:!1}),this.loadTemplateFonts(e)})).catch((e=>{Iu({description:"Error loading template",error:e}),a.replace("/explore"),this.setState({loading:!1})}))})),a(this,"loadTemplateFonts",(e=>{var t;if(null==(t=null==e?void 0:e.video)?void 0:t.layers){const t=[];for(const a of e.video.layers)"text"===a.type&&a.fontFamily&&t.push(a.fontFamily);t.length>0&&uB(t)}})),a(this,"goToEditor",(async()=>{const{history:e,isSingleMedia:t,setTemplateSource:a,showToast:o,slug:n,title:r,video_id:i}=this.props;if(dfe(lfe.EDIT_THIS_TEMPLATE),this.setState({loadingTemplate:!0}),i)a("explore"),e.push(`/editor/videos/${i}`);else if(t){const{resetStudio:e,addLayers:t,singleMedia:o}=this.props,{url:n}=o;e();const r=await XH(n,{source:"upload"});a("explore"),t({layer:[r]}),hT()}else o({description:"The template could not be loaded. Please try again later.",type:"error"}),this.setState({loadingTemplate:!1})})),a(this,"isMp4",(e=>{if("string"!=typeof e)return!0;try{return new URL(e).pathname.endsWith(".mp4")}catch(YEe){return e.endsWith(".mp4")}})),this.state={loading:!1,loadingTemplate:!1},this.image=i.createRef()}componentDidMount(){const{setParentId:e,currentTemplate:t,match:a}=this.props,{params:o}=a,{slug:n}=o;(null==t?void 0:t._id)&&e(t._id),(s.exports.isEmpty(t)||t.slug!==n)&&this.updateCurrentTemplate();const r=this.image.current;r&&this.loadImage(r)}componentDidUpdate(e){const{_id:t,setParentId:a}=this.props;e._id!==t&&a(t);const o=this.image.current;o&&this.loadImage(o)}renderMedia(){const{title:e,thumbnail:t}=this.props,a=tT(this.props,"image_url"),o=tT(this.props,"video_url")||a,n=!this.isMp4(o);let r=a,l=480,d=480;if(!s.exports.isEmpty(t)){const{url:e,width:a,height:o}=t;r=e,a>=o?d=Math.round(o*l/a):l=Math.round(a*d/o)}return n?i.createElement("img",{src:r,"data-src":a,alt:e,className:Mfe,ref:this.image,width:l,height:d}):i.createElement("video",{className:Ffe,controls:!0,src:o,playsInline:!0,preload:"auto",poster:a,autoPlay:!0,muted:!0,width:l,height:d})}renderKeywords(){const{keywords:e,description:t}=this.props;if(t)return null;if(e&&e.length){const t=e.split(", ");return i.createElement("div",{className:Gfe},i.createElement("span",{className:jfe},"Keywords:"),t.map((e=>i.createElement("span",{className:Hfe,key:e},`${e} `))))}return null}renderGenericDescription(){return i.createElement("div",{className:Kfe},i.createElement("div",{className:Yfe},i.createElement("div",{className:qfe},i.createElement(yo,null)),i.createElement("div",null,"100% customizable online")),i.createElement("div",{className:Yfe},i.createElement("div",{className:qfe},i.createElement(fo,null)),i.createElement("div",null,"No watermarks (just sign in!)")),i.createElement("div",{className:Yfe},i.createElement("div",{className:qfe},i.createElement(Eo,null)),i.createElement("div",null,"Fast and powerful")),i.createElement("div",{className:Yfe},i.createElement("div",{className:qfe},i.createElement(vo,null)),i.createElement("div",null,"Edit and download from any device")),i.createElement("div",{className:Yfe},i.createElement("div",{className:qfe},i.createElement(wo,null)),i.createElement("div",null,"Add video, audio, and images")))}renderContent(){const{title:e,description:t,currentUser:a,height:o,width:n}=this.props,{loadingTemplate:r}=this.state,s=tT(this.props,"video_url");let l=!0;return s&&s.endsWith("mp4")&&(l=!1),i.createElement(i.Fragment,null,i.createElement("div",{className:Rfe,"data-cy":"explore-template-container"},i.createElement("div",{className:Lfe},i.createElement("div",{className:Dfe},i.createElement("h1",{className:Afe},e),i.createElement("div",{onClick:this.goToEditor,className:Ofe},this.renderMedia()),r?i.createElement("button",{type:"button",className:Ufe,disabled:!0},"Loading ..."):i.createElement("button",{type:"button",className:Ufe,"data-cy":"edit-template-button-mobile",onClick:this.goToEditor},i.createElement("div",{className:Wfe},"Edit This Template"),i.createElement(po,{className:"collage-chevron",size:18})),i.createElement("div",null,i.createElement("div",{className:zfe},o&&n&&i.createElement(i.Fragment,null,i.createElement("div",null,Math.round(n),"px × ",Math.round(o),"px"),i.createElement("div",{className:$fe},"•")),i.createElement("div",null,l?"Image Template":"Video Template")),t?i.createElement("h3",{className:Nfe,dangerouslySetInnerHTML:{__html:t}}):this.renderGenericDescription(),i.createElement("button",{type:"button",className:Bfe,"data-cy":"edit-template-button-desktop",disabled:r,onClick:this.goToEditor},r?"Loading...":i.createElement(i.Fragment,null,i.createElement("div",{className:Wfe},"Edit This Template"),i.createElement(po,{className:"collage-chevron",size:18}))),i.createElement("div",{className:Pfe},"Click above to edit this template directly in your browser. Easily remix this template with your own text, images, and videos."),this.renderKeywords())))),i.createElement("div",{className:Vfe},i.createElement(Cfe,{keyword:"templates",routePrefix:"explore"})),i.createElement(pQ,null,i.createElement(wfe,null),dc(a)&&i.createElement(sfe,null)))}render(){const{loading:e}=this.state,{title:t,description:a,keywords:o,currentTemplate:n}=this.props,{match:r}=this.props,{params:l}=r,{slug:d}=l;if(s.exports.isEmpty(n)||n.slug!==d)return i.createElement(oJ,null);const c=tT(this.props,"image_url");let u=a;return u||(u=`Use this customizable ${t} page as a starting point for your content. Create and edit this template for free in just a few clicks. Find and discover new content on Kapwing.`),i.createElement(i.Fragment,null,i.createElement(rt,null,i.createElement("title",null,t),i.createElement("meta",{name:"description",content:u}),i.createElement("meta",{name:"keywords",content:o}),i.createElement("meta",{property:"og:title",content:t}),i.createElement("meta",{property:"og:description",content:u}),i.createElement("meta",{property:"og:image",content:c}),i.createElement("meta",{property:"twitter:image",content:c}),i.createElement("link",{rel:"canonical",href:`https://www.kapwing.com/explore/${d}`})),i.createElement(QQ,null),e?i.createElement(oJ,null):this.renderContent(),i.createElement(DJ,null))}}const Jfe=we(m.exports.connect((e=>{var t,a,o,n,r,i,s,l,d,c,u,m,p,h,g;return{currentUser:e.currentUser,currentTemplate:e.currentTemplate,_id:null==(t=e.currentTemplate)?void 0:t._id,description:null==(a=e.currentTemplate)?void 0:a.description,keywords:null==(o=e.currentTemplate)?void 0:o.keywords,og_description:null==(n=e.currentTemplate)?void 0:n.og_description,image_url:null==(r=e.currentTemplate)?void 0:r.image_url,title:null==(i=e.currentTemplate)?void 0:i.title,video_id:null==(s=e.currentTemplate)?void 0:s.video_id,video_url:null==(l=e.currentTemplate)?void 0:l.video_url,video:null==(d=e.currentTemplate)?void 0:d.video,slug:null==(c=e.currentTemplate)?void 0:c.slug,height:null==(u=e.currentTemplate)?void 0:u.height,width:null==(m=e.currentTemplate)?void 0:m.width,thumbnail:null==(p=e.currentTemplate)?void 0:p.thumbnail,isSingleMedia:null==(h=e.currentTemplate)?void 0:h.isSingleMedia,singleMedia:null==(g=e.currentTemplate)?void 0:g.singleMedia}}),(e=>me({addLayers:bh,fetchTemplate:W3,setEditorPath:r0,setParentId:M3,setTemplateSource:Q3,resetStudio:oR,showToast:Su},e)))(Xfe)),Qfe="snapshot-body-module_snapshotContainer_MD-tQ",Zfe="snapshot-body-module_mobileButtons_gdnca",eEe="snapshot-body-module_buttonWrapper_NezeG",tEe="snapshot-body-module_desktopButtons_IG9xD",aEe="snapshot-body-module_leftButtonContainer_6AbI-",oEe="snapshot-body-module_rightButtonContainer_W8VpL",nEe="snapshot-body-module_mainContainer_-kmC5",rEe="snapshot-body-module_videoContainer_-xrtQ",iEe="snapshot-body-module_innerVideoContainer_Wq5ta",sEe="snapshot-body-module_video_BFs4Q",lEe="snapshot-body-module_image_bftEk",dEe="snapshot-body-module_bottomContainer_et9wx",cEe="snapshot-body-module_shareText_XUHep",uEe="snapshot-body-module_sidebarContainer_EtH2N",mEe="snapshot-body-module_mobileOnly_G65R3",pEe="snapshot-body-module_desktopOnly_R-QoI",hEe="snapshot-body-module_underButtons_npefi",gEe=r.exports.createContext({userInTeam:!1,team:{},snapshot:{},refetch:()=>{},isLoading:!0}),yEe=({snapshot:e,snapshotId:t,videoId:a})=>{var o;const n=Ie(),s=gae(),[l,d]=i.useState(0),[c,u]=i.useState(e);r.exports.useEffect((()=>{(async()=>{if(t&&!e){const e=await hu(`/api/v2/snapshots/${t}/snapshotPreview`,{signal:s.signal});(null==e?void 0:e.snapshot)&&u(e.snapshot)}else if(a&&!e&&!t){const e=await hu(`/api/v2/videos/${a}/snapshotPreview`,{signal:s.signal});(null==e?void 0:e.snapshot)&&u(e.snapshot)}})()}),[t,e,a,s.signal]);const m=()=>{if(!l)return d(1),void(c&&u({...c,downloadUrl:`${c.downloadUrl}&retry=1`}));e&&(Ec(Bd.ACCESS_EXPIRED_EXPORT,{videoId:e.videoId,snapshotId:e._id,entryPoint:$te.SNAPSHOT_PAGE}),n.push(`/videos/${e.videoId}`))};return c?!c.duration||(null==(o=c.downloadUrl)?void 0:o.includes(".gif"))?i.createElement("img",{alt:"Final",src:c.downloadUrl,className:lEe,"data-cy":"final-image",loading:"lazy",onError:m}):i.createElement("video",{className:sEe,controls:!0,playsInline:!0,preload:"auto",src:c.downloadUrl,controlsList:"nodownload",onError:m}):null},fEe=()=>{const e=Ie(),{snapshot:t}=r.exports.useContext(gEe),a=lc(),o=zte(),n=t=>i.createElement(Uae,{label:"Make a copy",icon:i.createElement(sa,null),dataCy:"copy-and-edit-button",onClick:async()=>{const{copiedProject:a,destinationFolder:n}=await o(t._id,t.projectId,{entryPoint:Kte.FINAL_VIDEO_PAGE,name:t.name});a&&n&&e.push(`/${a.videoId}/studio/editor`)}});return i.createElement("div",{className:Qfe},i.createElement("div",{className:nEe},t&&(s=t,i.createElement("div",{className:tEe},i.createElement("div",{className:aEe},a&&i.createElement(i.Fragment,null,i.createElement("div",{className:eEe},i.createElement(toe,{videoId:s.videoId,commentingView:!0})),i.createElement("div",{className:eEe},n(s))),i.createElement(Bae,null)),i.createElement("div",{className:oEe},i.createElement("div",{className:eEe},i.createElement(moe,{metadata:{filesize:s.filesize,quality:s.quality,format:s.format,resolution:s.resolution}})),i.createElement(ooe,{downloadUrl:s.downloadUrl,entryPoint:$te.SNAPSHOT_PAGE})))),i.createElement("div",{className:rEe},i.createElement("div",{className:iEe},t?i.createElement(yEe,{snapshot:t}):i.createElement(Aee,null))),i.createElement("div",{className:`${dEe} ${pEe}`},i.createElement("div",{className:cEe},"Tag ",i.createElement("strong",null,"#kapwing")," so we can find you on social media!"," "))),i.createElement("div",{className:uEe},t&&(t=>i.createElement("div",{className:Zfe},!!a&&i.createElement(i.Fragment,null,i.createElement("div",{className:eEe},i.createElement(toe,{videoId:t.videoId})),i.createElement("div",{className:eEe},n(t))),i.createElement("div",{className:eEe},i.createElement(ooe,{inRightSidebar:!0,downloadUrl:t.downloadUrl,entryPoint:$te.SNAPSHOT_PAGE})),i.createElement("div",{className:eEe},i.createElement(Bae,null)),i.createElement("div",{className:eEe},i.createElement(Uae,{label:"Return to workspace",icon:i.createElement(fa,null),onClick:()=>{e.push("/")}}))))(t),i.createElement(f9,null),i.createElement("div",{className:`${hEe} ${mEe}`},i.createElement("div",{className:cEe},"Tag ",i.createElement("strong",null,"#kapwing")," so we can find you on social media!"))));var s},EEe=()=>{const{snapshot:e,userInTeam:t,isLoading:a,refetch:o}=r.exports.useContext(gEe),n=!t;return i.createElement("div",{className:Eae},i.createElement("div",{className:vae},i.createElement(lae,null),i.createElement(at,{className:wae,to:"/"},"KAPWING")),i.createElement("div",{className:Eae},i.createElement("div",{className:_ae},!a&&e&&o?i.createElement("div",{className:bae},t?i.createElement(hae,{value:e.name||"Untitled Export",onSave:async t=>{await gu(`/api/v2/snapshots/${e._id}/rename`,{body:{name:t}}),o()}}):i.createElement("span",null,e.name||"Untitled Export")):i.createElement(Aee,null),n&&e&&i.createElement(M6,null))),i.createElement("div",{className:Tae},i.createElement(iae,null)))},vEe=()=>{const{snapshot_id:e}=wa(),{snapshotData:t}=(e=>{const t=m.exports.useDispatch(),a=Ie(),{data:o,refetch:n,isLoading:i,error:s}=fae(`/api/v2/snapshots/${e}/snapshotPreview`),[l,d]=r.exports.useState({isLoading:!0});return r.exports.useEffect((()=>{(null==o?void 0:o.snapshot._id)&&vc(Bd.ACCESS_SNAPSHOT_PAGE,Gd({snapshotId:null==o?void 0:o.snapshot._id,isTeamMember:null==o?void 0:o.userInTeam}))}),[null==o?void 0:o.snapshot._id,null==o?void 0:o.userInTeam]),r.exports.useEffect((function(){o&&o.snapshot||!s||(Iu({error:s,description:"Unable to load export"}),a.push("/")),(null==o?void 0:o.snapshot)&&o.team&&(d({...o,refetch:n,isLoading:i}),t(LE(o.team._id)))}),[o,n,i,s,a,t]),{data:o,snapshotData:l}})(e),a=tr((e=>e.config.FACEBOOK_APP_ID));return i.createElement(gEe.Provider,{value:t},(()=>{var e,o,n;const r=`${(null==(e=t.snapshot)?void 0:e.name)||"Export"} - Kapwing`,s=`${(null==(o=t.snapshot)?void 0:o.name)||"Export"} made on Kapwing`;return i.createElement(rt,null,i.createElement("title",null,r),i.createElement("meta",{name:"description",content:s}),i.createElement("meta",{property:"fb:app_id",content:a}),i.createElement("meta",{property:"og:description",content:s}),i.createElement("meta",{property:"og:title",content:(null==(n=t.snapshot)?void 0:n.name)||"Export"}),i.createElement("meta",{property:"og:url",content:`${window.location.href}`}),i.createElement("meta",{name:"robots",content:"noindex, nofollow"}))})(),i.createElement(EEe,null),i.createElement(fEe,null),i.createElement(DJ,null))},wEe="Toasts-module_viewport_k-GHD",bEe="Toast-module_toast_pIgA0",_Ee="Toast-module_iconContainer_Z2lS5",TEe="Toast-module_icon_iy6jw",SEe="Toast-module_body_HQtZr",IEe="Toast-module_header_-ZlZx",xEe="Toast-module_description_IfpLw",kEe="Toast-module_link_OXE-x",CEe="Toast-module_success_CHkuZ",AEe="Toast-module_warning_rPCnd",NEe="Toast-module_error_SPqoO",PEe="Toast-module_info_84tbL",REe="Toast-module_close_dYbI7",LEe={[yh.BROWSER_WARN]:()=>{jc.set("BROWSER_COOLDOWN_DATE",(new Date).toString())}},DEe=({id:e,toast:t})=>{const a=m.exports.useDispatch(),o=[bEe],{description:n,link:r,open:s,subDescription:l,type:d,callbackId:c}=t;function u(){(e=>{e&&LEe[e]()})(c),a(_u(e)),setTimeout((()=>{a(Tu(e))}),400)}let p,h,g;switch(d){case"success":o.push(CEe),p=Co,h=28,g="Success";break;case"warning":o.push(AEe),p=ko,h=24,g="Warning";break;case"error":o.push(NEe),p=xo,h=24,g="Error";break;case"info":o.push(PEe),p=It,h=24,g=""}const y=r?i.createElement("a",{href:r.href,className:kEe,target:"_blank",rel:"noopener noreferrer","data-testid":"toast__link"},r.text):null;return i.createElement(bo,{open:s,className:o.join(" "),onOpenChange:e=>{e||u()},duration:1e4,"data-cy":`${d}-toast`},i.createElement("div",{className:_Ee},i.createElement(p,{className:TEe,size:h})),i.createElement("div",{className:SEe},i.createElement(_o,{className:IEe},g),i.createElement(To,null,i.createElement("div",{className:xEe},n,(null==r?void 0:r.inline)&&y,l?` (${l})`:""),!(null==r?void 0:r.inline)&&y)),i.createElement(So,{className:REe,"data-testid":"toast__close"},i.createElement(Io,{size:16})))},OEe=()=>{const e=tr((e=>e.toasts));return i.createElement(i.Fragment,null,i.createElement(Ao,{className:wEe}),Object.entries(e).map((([e,t])=>i.createElement(DEe,{key:e,id:e,toast:t}))))},FEe={style:{verticalAlign:"middle"}};class MEe extends r.exports.Component{constructor(e){super(e),a(this,"refreshCurrentUser"),a(this,"checkBrowser",(()=>{var e;if(Cl()||(null==(e=xl().browser.name)?void 0:e.includes("Edge"))||Pl())return;const{location:t}=this.props,{pathname:a}=t,o=a.startsWith("/folder"),n=a.endsWith("/studio/editor");if(!o&&!n)return;const r=jc.get("BROWSER_COOLDOWN_DATE",{disabled:""});if(r){const e=I(r).add(14,"days").endOf("day");if(I().isBefore(e))return}const{showToast:i}=this.props;i({type:"warning",callbackId:yh.BROWSER_WARN,description:"For the best editing experience, please consider switching to the ",link:{inline:!0,text:"Google Chrome Browser.",href:"https://www.google.com/chrome/"}}),vc("Shown Browser Warning")})),a(this,"getCustomPageRedirects",(()=>{const e=[];return k0.forEach((t=>{if(t.redirect)if("string"==typeof t.redirect)e.push(i.createElement(kle,{key:t.redirect,from:t.redirect,exact:!0,to:t.url}));else if(Array.isArray(t.redirect))for(const a of t.redirect)e.push(i.createElement(kle,{key:a,from:a,exact:!0,to:t.url}))})),e})),a(this,"renderSwitch",(()=>{const{hostDomain:e}=this.props;return i.createElement(yt,null,hc()&&!this.props.currentUser.token&&i.createElement(kle,{exact:!0,from:"/",to:"/pwaHome"}),this.props.currentUser.token&&i.createElement(kle,{exact:!0,from:"/pwaHome",to:"/"}),i.createElement(ft,{exact:!0,path:"/",component:ide}),i.createElement(ft,{exact:!0,path:"/pwaHome",component:nde}),i.createElement(kle,{exact:!0,from:"/join",to:"/"}),i.createElement(kle,{exact:!0,from:"/join/:code",to:"/"}),i.createElement(ft,{path:"/admin",component:pJ}),i.createElement(ft,{path:"/videos/:id/debug",component:yJ}),i.createElement(ft,{path:"/videos/:id/snapshots",exact:!0,component:Ase}),i.createElement(ft,{path:"/exports/:snapshot_id",exact:!0,component:vEe}),i.createElement(ft,{path:"/videos/:id/snapshots/:snapshot_id/debug",render:()=>i.createElement(yJ,{snapshot:!0})}),i.createElement(ft,{exact:!0,path:"/videos/:id/comment/:commentId",render:()=>i.createElement(dse,{hostDomain:e})}),i.createElement(ft,{exact:!0,path:"/videos/:id",render:()=>i.createElement(dse,{hostDomain:e})}),i.createElement(ft,{path:"/handleCheckout",component:C0}),i.createElement(kle,{from:"/cartoonify/:id",to:"/videos/:id"}),i.createElement(kle,{from:"/workspace/:subpath",to:"/folder/:subpath"}),i.createElement(kle,{from:"/workspace",to:"/home"}),i.createElement(ft,{exact:!0,path:"/home",component:Rge}),i.createElement(ft,{exact:!0,path:"/brandkit",component:Rge}),i.createElement(ft,{exact:!0,path:"/folder",component:Rge}),i.createElement(ft,{exact:!0,path:"/folder/:id",component:Rge}),i.createElement(ft,{exact:!0,path:"/folder/:id/rename",component:Rge}),i.createElement(ft,{exact:!0,path:"/folder/create",component:Rge}),i.createElement(ft,{exact:!0,path:"/folder/:id/create",component:Rge}),i.createElement(ft,{exact:!0,path:"/shared-with-me",component:Rge}),i.createElement(kle,{from:"/my/videos",to:"/home"}),i.createElement(kle,{from:"/my/account",to:{pathname:"/home",state:{openModal:EJ.account}}}),i.createElement(Da,{exact:!0,path:"/settings/account",to:{pathname:"/home",state:{openModal:EJ.account}}}),i.createElement(Da,{exact:!0,path:"/settings/account/change",to:{pathname:"/home",state:{openModal:EJ.accountChange}}}),i.createElement(kle,{from:"/my",to:"/home"}),i.createElement(ft,{path:"/settings",component:Rge}),i.createElement(ft,{path:"/settings/folder/cancel",component:Rge}),i.createElement(ft,{exact:!0,path:"/team/sharing/:id",component:Wle}),i.createElement(ft,{exact:!0,path:"/team/invite/:inviteKey",component:Xle}),i.createElement(ft,{path:"/defaultTeamFolder/:teamId",component:Rge}),i.createElement(ft,{path:"/team/:teamId",component:Rge}),this.getCustomPageRedirects(),k0.map((e=>i.createElement(ft,{key:e.url,path:e.url,exact:!0,component:e.component}))),i.createElement(kle,{from:"/editor",exact:!0,to:"/"}),i.createElement(kle,{from:"/editor/trimmer",to:"/tools/trim-video"}),i.createElement(kle,{from:"/editor/subtitles",to:"/subtitles"}),i.createElement(kle,{from:"/editor/add-audio-to-video",to:"/tools/add-audio"}),i.createElement(kle,{from:"/editor/convert",to:"/tools/convert"}),i.createElement(kle,{from:"/editor/video-speed",to:"/tools/resize"}),i.createElement(kle,{from:"/editor/audio-trimmer",to:"/tools/trim-audio"}),i.createElement(kle,{from:"/editor/resize",to:"/tools/resize"}),i.createElement(ft,{path:"/editor/videos/:id",component:lJ}),i.createElement(ft,{path:"/editor/memes",component:uJ}),i.createElement(ft,{path:"/editor/watermarker",component:uJ}),i.createElement(ft,{path:"/editor/confirm",component:uJ}),i.createElement(ft,{path:"/editor/adjust",component:uJ}),i.createElement(ft,{path:"/editor/loop-video",component:uJ}),i.createElement(ft,{path:"/editor/filters",component:uJ}),i.createElement(ft,{path:"/editor/mute-video",component:uJ}),i.createElement(ft,{path:"/editor/image-to-video",component:uJ}),i.createElement(ft,{path:"/editor/add-text",component:uJ}),i.createElement(ft,{path:"/editor/rotate",component:uJ}),i.createElement(ft,{path:"/editor/volume-adjust",component:uJ}),i.createElement(ft,{path:"/editor/stop-motion",component:uJ}),i.createElement(ft,{path:"/editor/reverse",component:uJ}),i.createElement(kle,{from:"/:id?/studio/editor/layer/:layerId",to:"/:id?/studio/editor"}),i.createElement(ft,{path:"/:id?/studio/editor/sharing",component:mJ}),i.createElement(ft,{path:"/:id?/studio/editor/comment/:commentId",component:mJ}),i.createElement(ft,{path:"/:id?/studio/editor/",component:mJ}),i.createElement(ft,{path:"/explore/:slug",component:Jfe}),i.createElement(kle,{from:"/exploreall",exact:!0,to:"/explore"}),i.createElement(kle,{from:"/explore-all",to:"/explore"}),i.createElement(kle,{from:"/explore/directory",exact:!0,to:"/explore"}),i.createElement(kle,{statusCode:404,from:"/browse",to:"/404"}),i.createElement(kle,{statusCode:404,from:"/posts",to:"/404"}),i.createElement(kle,{from:"/maker",exact:!0,to:"/video-maker"}),i.createElement(kle,{exact:!0,from:"/maker/editor",to:"/studio/editor/scenes"}),i.createElement(kle,{from:"/maker",to:"/video-maker"}),i.createElement(ft,{path:"/startup-demo-videos",exact:!0,component:F3}),i.createElement(ft,{path:"/startup-demo-videos/:id",component:D3}),i.createElement(ft,{path:"/rick-roller",component:z1}),i.createElement(ft,{path:"/logo-redesigns",component:ple}),i.createElement(ft,{path:"/how-much-twitch-streamers-make",component:xle}),i.createElement(ft,{path:"/new-tab-stretches",component:O1}),i.createElement(ft,{path:"/museum-of-websites",exact:!0,component:EZ}),i.createElement(ft,{path:"/museum-of-websites/:id",component:bZ}),i.createElement(ft,{path:"/evolution-of-products",exact:!0,component:EZ}),i.createElement(ft,{path:"/evolution-of-products/:id",component:bZ}),i.createElement(ft,{path:"/mobile-mockup",component:L0}),i.createElement(ft,{path:"/cartoonify",exact:!0,component:mQ}),i.createElement(ft,{path:"/motion",component:f1}),i.createElement(ft,{path:"/sidedoor",component:E3}),i.createElement(ft,{path:"/404-illustrations",component:ZZ}),i.createElement(ft,{path:"/sonoma-county-fire-map",component:NZ}),i.createElement(ft,{path:"/sound-effects",component:P3}),i.createElement(ft,{path:"/off-site/long-tail-analytics",component:hJ}),i.createElement(ft,{path:"/edu/login",component:iZ}),i.createElement(ft,{path:"/edu/signup",component:cZ}),i.createElement(ft,{path:"/edu/admin-signup",component:uZ}),i.createElement(ft,{path:"/signin-redirect/",component:G1}),i.createElement(ft,{path:"/signin/onetap",component:E1}),i.createElement(ft,{path:"/signin",component:I3}),i.createElement(kle,{from:"/sign-in",to:"/sigin"}),i.createElement(kle,{from:"/gif-meme-generator",to:"/"}),i.createElement(kle,{from:"/editor/montage",to:"/maker/editor"}),i.createElement(kle,{from:"/create/editor",to:"/studio/editor"}),i.createElement(kle,{from:"/:id?/editor/subtitles",to:"/:id?/studio/editor"}),i.createElement(kle,{from:"/2020-election-meme-templates",to:"/explore/2020-new-york-times-election-needle-meme-template"}),i.createElement(kle,{from:"/blade-runner-generator",to:"/explore"}),i.createElement(kle,{from:"/tools/resources/video-editor-for-youtube/",to:"https://www.kapwing.com/resources/video-editor-for-youtube/"}),i.createElement(ft,{path:"/health",render:()=>"Success"}),i.createElement(ft,{path:"/404",render:({staticContext:e})=>(e&&(e.statusCode=404),i.createElement(j1,null))}),i.createElement(ft,{render:({staticContext:e})=>(e&&(e.statusCode=404),i.createElement(j1,null))}))}));const{config:t}=e;e.setConfig(t),this.refreshCurrentUser=s.exports.debounce(vf,3e3,{leading:!0,trailing:!1})}componentDidMount(){const{setKapwingInit:e,currentUser:t,resetCumulativeDurationLimit:a,resetTranscribeUsage:o}=this.props;if(e(),"undefined"!=typeof window&&(this.refreshCurrentUser().catch((e=>{Iu({description:"Failed to refresh user profile.",error:e})})),Cle(),this.checkBrowser()),sc(t)){JD(Ps.TRANSCRIBE)||((()=>{var e;const t=nd();if(!(null==t?void 0:t.limits))return!1;const a=yf(new Date(null==(e=t.limits)?void 0:e.lastUpdatedCumulativeDuration));return yf(new Date)>a})()&&a(),(()=>{var e;const t=nd();if(!(null==t?void 0:t.limits))return!1;const a=yf(new Date(null==(e=t.limits)?void 0:e.lastUpdatedTranscribe));return yf(new Date)>a})()&&o())}}componentDidUpdate(e){const{location:t}=this.props,{location:a}=e;t.pathname!==a.pathname&&this.onRouteChanged(a),"/pricing"!==t.pathname&&window.fcWidget&&window.fcWidget.hide()}onRouteChanged(e){const{location:t}=this.props,{pathname:a}=t,{pathname:o}=e;a.includes("/studio/editor")&&o.includes("/studio/editor")||this.refreshCurrentUser()}renderApp(){const{showSignIn:e}=this.props,t=nd(),a="Kapwing — Create more content in less time",o="Kapwing is a collaborative, online content creation platform that you can use to edit video and create content. Join over 10 million modern creators who trust Kapwing to create, edit, and grow their content on every channel.",n="https://cdn-useast1.kapwing.com/static/jQ9-og-image-(1).webp";return i.createElement("div",{className:Ni({"app-container":!0,"col-resize":this.props.isResizingMediabar})},i.createElement(rt,null,i.createElement("title",null,a),i.createElement("meta",{name:"description",content:o}),i.createElement("meta",{name:"keywords",content:"video editor, meme maker, video resizer, gif editor, video subtitles"}),i.createElement("meta",{property:"og:title",content:a}),i.createElement("meta",{property:"og:description",content:o}),i.createElement("meta",{property:"og:image",content:n}),i.createElement("meta",{property:"og:image:url",content:n}),i.createElement("meta",{property:"twitter:image",content:n}),i.createElement("meta",{property:"og:type",content:"website"}),i.createElement("meta",{property:"og:image:width",content:"1200"}),i.createElement("meta",{property:"og:image:height",content:"630"}),i.createElement("meta",{name:"twitter:card",content:"summary_large_image"}),i.createElement("link",{rel:"canonical",href:"https://www.kapwing.com/"})),i.createElement(OEe,null),i.createElement(jU,null),i.createElement(qye,null),this.renderSwitch(),i.createElement(pQ,null,e&&i.createElement(ZF,{hideSignIn:fA}),t&&i.createElement(nle,null),i.createElement(gJ,null),i.createElement(Lge,null),i.createElement("div",{style:{display:"none",position:"absolute",zIndex:-1}},i.createElement("canvas",{id:"canvas-scratchpad"}),i.createElement("div",{id:"scene-list-premount"})),i.createElement(fJ,null)))}render(){const{location:e}=this.props;return new URLSearchParams(e.search).get("isTWA")&&jc.set("isTWA","true"),i.createElement(No.Provider,{value:FEe},i.createElement(XX,null,i.createElement(bT,null,this.renderApp())))}}const UEe=we(m.exports.connect((e=>({showSignIn:e.studioLocal.showSignIn,currentUser:e.currentUser,isResizingMediabar:e.studioLocal.isResizingMediaBar})),(e=>me({setConfig:Nse,setKapwingInit:sR,resetCumulativeDurationLimit:ev,resetTranscribeUsage:av,showToast:Su},e)))(MEe)),BEe=Po((e=>{const{config:t,store:a}=e;return r.exports.useEffect((()=>{const e=document.createElement("script");e.src="https://connect.facebook.net/en_US/sdk.js",e.async=!0,setTimeout((()=>{document.body&&document.body.appendChild(e)}),3e3)}),[]),i.createElement(m.exports.Provider,{store:a},i.createElement(UO,{refreshOnError:!0},i.createElement(Ro,{reCaptchaKey:t.RECAPTCHA_V3_SITEKEY,useRecaptchaNet:!0,scriptProps:{async:!0,defer:!0}},i.createElement(nD,null,i.createElement(lD,null,i.createElement(Lo,{backend:Do,options:{enableMouseEvents:!0}},i.createElement(Oo,{history:en},i.createElement(KX,null),i.createElement(vD,null,i.createElement(YX,null,i.createElement(UEe,{config:t}))))))))))}));const WEe=["AbortError","FetchStatusError"],VEe=["The play() request was interrupted by a call to pause()","The element has no supported source","The request is not allowed by the user agent or the platform in the current context, possibly because the user denied permission","The operation is not supported.","Network request failed"];const jEe=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function GEe(e,t){navigator.serviceWorker.register(e).then((e=>{e.onupdatefound=()=>{const a=e.installing;null!=a&&(a.onstatechange=()=>{"installed"===a.state&&t&&t.onUpdate&&t.onUpdate(e)})}})).catch((e=>{console.error("Error during service worker registration:",e)}))}const{domain:HEe}=document,zEe=HEe.startsWith("localhost"),$Ee={CLOUD_FUNCTIONS_PREFIX:"",COMMIT:"a84754b9",FACEBOOK_APP_ID:"713985848677391",FRESH_CHAT_TOKEN:"6c78e084-ae7a-4b7b-8968-358ae3123d5b",GIPHY_SEARCH_KEY:"rfMjRmVqUkVPENBuewLHtXp6kXPjSBvq",GOOGLE_ANALYTICS_CODE:"UA-100629017-1",GOOGLE_PLUGINS_CLIENT_ID:"823730063895-iqn5t0hivtu1ss7c2mhpfdmh1ghlf9fa.apps.googleusercontent.com",GOOGLE_PLUGINS_KEY:"AIzaSyDi2438fC9BfPQygJUdixA3nq_NjihWTTQ",PAYPAL_CLIENT_ID:"ATpujmTF5jlQkGjb2cxW-cqabZzW5aPOyUhHCgiqRnDCMJR0PBuT3Hiz1MRlBpSAiCdPmSKDOzZfX71q",PAYPAL_MONTHLY_PLAN:"P-7M0707473Y698515YL25POSA",PAYPAL_YEARLY_PLAN:"P-1Y863133GV1165308L3B4QAY",RECAPTCHA_V2_SITEKEY:"6LdpYicdAAAAALsID-RPNNp91_n_4otjuyj-CG6U",RECAPTCHA_V3_SITEKEY:"6LciWYwhAAAAAP9IBiJn1FoBRXISf74l3U6TvAL8",SENTRY_ENV:"production",STRIPE_PUBLIC_KEY:"pk_live_2sDMAtDohnudYHgRDvCSQelo",UNSPLASH_KEY:"GzIAtsrV-zOLLJXWiLhxxd_2hcWz1JCHsIXWAYJ5rE0"};(HEe.endsWith(".kapwing-dev.com")||HEe.startsWith("kapwing-dev")&&HEe.endsWith(".herokuapp.com")||zEe&&["3000","4000","5000"].includes(window.location.port)||HEe.startsWith("192.")||HEe.startsWith("10.0.")||HEe.startsWith("10.1."))&&(Object.assign($Ee,{FACEBOOK_APP_ID:"2545197755522838",PAYPAL_CLIENT_ID:"ASFO5f-tT3sCvQTEyy3xsgvkgsESBNOxypAtrQ9nV9StFVEeNntRnpUC-oq8wBRodKRARO0fkxw_2ALM",PAYPAL_MONTHLY_PLAN:"P-1HB10053MC1801913L26DZEQ",PAYPAL_YEARLY_PLAN:"P-9FJ14294SG852114PL3DRKYI",RECAPTCHA_V2_SITEKEY:"6LdpYicdAAAAALsID-RPNNp91_n_4otjuyj-CG6U",RECAPTCHA_V3_SITEKEY:"6Leu-AgdAAAAADasOHy2VJPi1xbcAnWrI8mE8t0d",STRIPE_PUBLIC_KEY:"pk_test_7MMbY1maBR111EJDSqeWIhHR"}),window.Cypress||($Ee.CLOUD_FUNCTIONS_PREFIX="dev_"));try{!function(){if(window.SENTRY_ENV="production",Fo({enabled:!kn&&!window.Cypress,beforeSend:(e,t)=>{var a,o,n,r;if(null==(a=t.originalException)?void 0:a.__SKIP_SENTRY)return null;if(null==(o=e.extra)?void 0:o.__FORCE_SAMPLE)return e;const i=t.originalException&&"object"==typeof t.originalException&&"message"in t.originalException?null==(n=t.originalException)?void 0:n.message:"",s=t.originalException&&"object"==typeof t.originalException&&"name"in t.originalException?null==(r=t.originalException)?void 0:r.name:"";if(WEe.includes(s))return null;for(const l of VEe)if(i.includes(l))return null;return e},dsn:"https://a5bf03f4085d4c9eae3716d84c1869c4@sentry.io/267538",environment:"production",autoSessionTracking:!0,integrations:[new Mo,new Uo({routingInstrumentation:Bo(en)})],release:"v2023.06.13.1",normalizeDepth:7,maxBreadcrumbs:10}),"undefined"!=typeof window){let e=null;eD.subscribe((()=>{const t=eD.getState(),a=ld(),{_id:o}=t.currentUser.user||{},n=!!o&&a.isPaid;n!==e&&(Wo("pro",n),e=n)}))}}()}catch(qEe){console.error(qEe)}HEe.startsWith("localhost")||window.Cypress||!$Ee.SENTRY_ENV||console.log("%cLooking for a creative challenge? Come work at Kapwing - we're hiring. kapwing.com/careers","font-weight: bold; font-size: 16px; color: #0083e2;"),window.releaseVersion="v2023.06.13.1",window.commitHash=cs(),n.initialize($Ee.GOOGLE_ANALYTICS_CODE),n.pageview(window.location.pathname),eD.subscribe(s.exports.throttle((()=>{TO()}),3e3)),qt.extend(Vo),qt.extend(jo),qt.extend(Go);const KEe=he.hydrate;"undefined"==typeof window||en||window.location.replace("/404"),window.Buffer=Ho.Buffer,KEe(i.createElement(BEe,{config:$Ee,store:eD}),document.getElementById("root")),window.Cypress||"localhost"===window.location.hostname?"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((e=>{e.unregister()})).catch((e=>{console.error(e.message)})):function(e){if("serviceWorker"in navigator){if(new URL("/",window.location.href).origin!==window.location.origin)return;const t=()=>{const t="/service-worker.js";jEe?(function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((a=>{const o=a.headers.get("content-type");404===a.status||null!=o&&-1===o.indexOf("javascript")?navigator.serviceWorker.ready.then((e=>{e.unregister().then((()=>{window.location.reload()}))})):GEe(e,t)})).catch((()=>{console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):GEe(t,e)};window.addEventListener("load",t)}}({onUpdate:async e=>{console.info("New service worker will update on page refresh."),e&&e.waiting&&e.waiting.postMessage({type:"SKIP_WAITING"})}});export{uE as $,vf as A,sd as B,yge as C,Zf as D,Xv as E,SQ as F,s9 as G,gae as H,eE as I,Ree as J,ude as K,CO as L,iO as M,Lde as N,_O as O,Rs as P,NE as Q,fE as R,yE as S,ii as T,PE as U,XD as V,Ps as W,af as X,tl as Y,RE as Z,hi as _,HU as a,jc as a$,li as a0,Gde as a1,$de as a2,Aue as a3,Jd as a4,pu as a5,yu as a6,dE as a7,qE as a8,hu as a9,iE as aA,nE as aB,Si as aC,qte as aD,Pn as aE,Jr as aF,os as aG,PQ as aH,mi as aI,SE as aJ,TE as aK,hP as aL,yv as aM,lP as aN,iP as aO,LQ as aP,dP as aQ,cP as aR,zP as aS,ui as aT,dc as aU,sc as aV,oP as aW,rP as aX,gR as aY,pP as aZ,EJ as a_,gu as aa,gd as ab,vs as ac,m9 as ad,Ic as ae,tn as af,sde as ag,gf as ah,rc as ai,Xd as aj,fu as ak,mE as al,Ed as am,pE as an,CE as ao,Es as ap,Gr as aq,gE as ar,yd as as,Gs as at,rE as au,Ni as av,vc as aw,pc as ax,uc as ay,Js as az,QE as b,rl as b$,oJ as b0,wR as b1,mR as b2,xae as b3,kae as b4,LL as b5,vse as b6,pde as b7,XP as b8,sl as b9,foe as bA,Ou as bB,Gte as bC,Hte as bD,Lu as bE,Fc as bF,Uoe as bG,Sde as bH,Bd as bI,jte as bJ,Kte as bK,aoe as bL,Xz as bM,iL as bN,Yte as bO,ei as bP,$d as bQ,_v as bR,JD as bS,el as bT,uf as bU,Kv as bV,JP as bW,WU as bX,qv as bY,NQ as bZ,pf as b_,ll as ba,HE as bb,yn as bc,dde as bd,jce as be,Hv as bf,Jv as bg,Wce as bh,Lce as bi,Vce as bj,Uce as bk,Bce as bl,Rce as bm,Ace as bn,Dce as bo,Fce as bp,Pce as bq,Oce as br,Nce as bs,$v as bt,Yv as bu,tT as bv,nv as bw,Ns as bx,Of as by,aP as bz,tr as c,jP as c$,Vv as c0,jv as c1,mP as c2,uP as c3,nP as c4,pi as c5,sP as c6,qP as c7,dfe as c8,lfe as c9,wv as cA,Ev as cB,aL as cC,oL as cD,tv as cE,jL as cF,Yr as cG,hf as cH,js as cI,di as cJ,kU as cK,aw as cL,lp as cM,ID as cN,BE as cO,WE as cP,U4 as cQ,tle as cR,PF as cS,c$ as cT,oV as cU,pB as cV,lB as cW,Hu as cX,Vu as cY,ti as cZ,HG as c_,Gv as ca,mf as cb,zr as cc,Hr as cd,dv as ce,xf as cf,lf as cg,sf as ch,ld as ci,zU as cj,RQ as ck,rv as cl,bse as cm,rX as cn,Qs as co,oR as cp,MJ as cq,Sv as cr,Tv as cs,Iv as ct,kv as cu,Uv as cv,bv as cw,vv as cx,Ov as cy,Dv as cz,$ye as d,uj as d$,GG as d0,GP as d1,lh as d2,az as d3,ai as d4,FH as d5,Uk as d6,Mk as d7,Ok as d8,Ur as d9,MH as dA,sj as dB,Rd as dC,BS as dD,mW as dE,ri as dF,jy as dG,Ly as dH,qG as dI,Vy as dJ,Ry as dK,NH as dL,ln as dM,_E as dN,lL as dO,dL as dP,jY as dQ,iT as dR,iD as dS,dD as dT,vF as dU,xu as dV,qn as dW,Tz as dX,hT as dY,Kh as dZ,RB as d_,Mr as da,tG as db,oG as dc,Bm as dd,RD as de,jD as df,wse as dg,jm as dh,LD as di,vG as dj,CG as dk,HX as dl,SG as dm,Mz as dn,Up as dp,uG as dq,eh as dr,Rz as ds,rpe as dt,VE as du,kle as dv,p9 as dw,Yy as dx,tw as dy,up as dz,ar as e,Tg as e$,ZH as e0,zy as e1,Nr as e2,WG as e3,HH as e4,XH as e5,Is as e6,Ag as e7,zV as e8,VR as e9,Ay as eA,My as eB,U$ as eC,B$ as eD,mA as eE,ch as eF,ZF as eG,JG as eH,QG as eI,D4 as eJ,e0 as eK,t0 as eL,Jz as eM,cf as eN,o0 as eO,n0 as eP,UJ as eQ,v0 as eR,E0 as eS,f0 as eT,w0 as eU,ete as eV,Ci as eW,jr as eX,qee as eY,Yee as eZ,Kee as e_,El as ea,fl as eb,vr as ec,yg as ed,$J as ee,N7 as ef,Ose as eg,g$ as eh,xD as ei,Ky as ej,Wy as ek,qy as el,ez as em,Lr as en,Fk as eo,XG as ep,gh as eq,An as er,Cn as es,by as et,_y as eu,L$ as ev,R$ as ew,F$ as ex,O$ as ey,bc as ez,rd as f,Ei as f$,NM as f0,Bl as f1,Ml as f2,Gc as f3,$A as f4,Kc as f5,Rl as f6,zo as f7,Hc as f8,zc as f9,DS as fA,ji as fB,Vi as fC,Bi as fD,eB as fE,bQ as fF,_Q as fG,ci as fH,Gl as fI,Qr as fJ,yoe as fK,Mf as fL,tE as fM,nd as fN,Ts as fO,Cs as fP,eH as fQ,ZG as fR,tz as fS,_s as fT,ws as fU,bs as fV,As as fW,Hd as fX,YA as fY,Sx as fZ,sw as f_,lw as fa,dw as fb,rw as fc,iw as fd,eT as fe,npe as ff,Uy as fg,W$ as fh,Ny as fi,l9 as fj,_g as fk,BG as fl,pS as fm,kS as fn,iN as fo,lT as fp,jS as fq,Jl as fr,Cw as fs,Pw as ft,bw as fu,px as fv,Rn as fw,uw as fx,TA as fy,RA as fz,IE as g,wc as g$,Tx as g0,ow as g1,jF as g2,lae as g3,iae as g4,Al as g5,cu as g6,b4 as g7,Nl as g8,aA as g9,dY as gA,pl as gB,Sd as gC,FK as gD,MK as gE,Hq as gF,Td as gG,Fl as gH,YI as gI,BI as gJ,kd as gK,v_ as gL,dn as gM,Eh as gN,SB as gO,zh as gP,MA as gQ,PB as gR,Cg as gS,_W as gT,QA as gU,TW as gV,kg as gW,Xl as gX,ST as gY,Wh as gZ,DI as g_,Mq as ga,EA as gb,vA as gc,f4 as gd,JO as ge,LB as gf,Kn as gg,Df as gh,US as gi,mr as gj,_h as gk,_T as gl,Wl as gm,hI as gn,yI as go,fI as gp,gI as gq,Uw as gr,Bw as gs,uoe as gt,kT as gu,mg as gv,OH as gw,DH as gx,EI as gy,WK as gz,zE as h,nI as h$,TV as h0,xV as h1,Hh as h2,Sr as h3,cI as h4,Jw as h5,g_ as h6,vh as h7,_d as h8,vd as h9,bV as hA,fg as hB,Mb as hC,T_ as hD,zS as hE,pI as hF,$k as hG,aI as hH,tI as hI,__ as hJ,Dh as hK,CN as hL,o_ as hM,pW as hN,bN as hO,SN as hP,wN as hQ,kN as hR,mN as hS,xN as hT,Rc as hU,NC as hV,coe as hW,jT as hX,bW as hY,qi as hZ,Hk as h_,kI as ha,CI as hb,II as hc,GI as hd,YT as he,KT as hf,IB as hg,$q as hh,uI as hi,sg as hj,zK as hk,Vq as hl,dI as hm,Zq as hn,IT as ho,eI as hp,Dj as hq,zq as hr,Yq as hs,oI as ht,Kk as hu,Wq as hv,SV as hw,Gk as hx,vW as hy,VV as hz,kE as i,Bu as i$,vg as i0,uW as i1,Wk as i2,rI as i3,lI as i4,_I as i5,Xi as i6,JC as i7,bC as i8,qV as i9,wW as iA,NN as iB,jk as iC,mj as iD,Xn as iE,Jn as iF,Sq as iG,xq as iH,kq as iI,pee as iJ,iI as iK,pG as iL,WA as iM,Gh as iN,cg as iO,wr as iP,jh as iQ,lg as iR,G_ as iS,ug as iT,ag as iU,od as iV,ad as iW,Ol as iX,pZ as iY,Fg as iZ,er as i_,rj as ia,GV as ib,oj as ic,vI as id,Oq as ie,_c as ig,Eg as ih,ng as ii,eg as ij,mI as ik,zk as il,fW as im,sI as io,aj as ip,gV as iq,OV as ir,Aq as is,cW as it,j$ as iu,V$ as iv,G$ as iw,M$ as ix,Yk as iy,Vk as iz,LE as j,WL as j$,TI as j0,wI as j1,bI as j2,dg as j3,Tf as j4,Kr as j5,as as j6,jK as j7,Z_ as j8,or as j9,bh as jA,xW as jB,zB as jC,Ig as jD,bg as jE,Sg as jF,lF as jG,$G as jH,zG as jI,bn as jJ,lc as jK,hA as jL,Pee as jM,hae as jN,Zr as jO,Gd as jP,$te as jQ,op as jR,N4 as jS,gne as jT,YG as jU,Iee as jV,xee as jW,BR as jX,nz as jY,ZP as jZ,_ee as j_,hb as ja,VA as jb,HA as jc,cT as jd,qS as je,XS as jf,Y_ as jg,K_ as jh,$_ as ji,Oh as jj,TT as jk,G6 as jl,Zm as jm,pA as jn,uh as jo,jX as jp,Aee as jq,cw as jr,ep as js,mee as jt,xc as ju,UH as jv,YH as jw,kW as jx,qH as jy,nR as jz,AQ as k,_V as k$,dee as k0,pn as k1,P4 as k2,dR as k3,TO as k4,yi as k5,c4 as k6,gi as k7,d4 as k8,s$ as k9,Ph as kA,Hz as kB,B_ as kC,eR as kD,bf as kE,Pr as kF,yr as kG,rR as kH,$g as kI,wg as kJ,ZB as kK,sh as kL,CH as kM,hn as kN,KG as kO,Rr as kP,BT as kQ,XO as kR,ki as kS,LA as kT,yX as kU,rN as kV,dA as kW,lS as kX,cA as kY,kB as kZ,HW as k_,QP as ka,tp as kb,fi as kc,See as kd,Ln as ke,Fn as kf,On as kg,l$ as kh,d$ as ki,Zi as kj,sF as kk,oH as kl,kH as km,xH as kn,xB as ko,SH as kp,TH as kq,p$ as kr,hY as ks,zH as kt,h$ as ku,pT as kv,hF as kw,$y as kx,IA as ky,VG as kz,jde as l,Ug as l$,OA as l0,pX as l1,DA as l2,Iq as l3,jf as l4,hX as l5,wi as l6,DW as l7,XA as l8,WW as l9,jj as lA,YS as lB,VY as lC,WT as lD,$S as lE,LT as lF,ZA as lG,cN as lH,uN as lI,Dn as lJ,dq as lK,rx as lL,lN as lM,WI as lN,wS as lO,yx as lP,gx as lQ,Jh as lR,dN as lS,cS as lT,MX as lU,HY as lV,gY as lW,Kb as lX,tK as lY,jC as lZ,pC as l_,mX as la,MV as lb,H_ as lc,Pg as ld,Rg as le,LW as lf,OW as lg,AX as lh,vP as li,hl as lj,bS as lk,H$ as ll,gG as lm,Oz as ln,WB as lo,Zb as lp,doe as lq,gT as lr,Dq as ls,og as lt,Cq as lu,qT as lv,_A as lw,mT as lx,_X as ly,AW as lz,sE as m,h_ as m$,xk as m0,Mg as m1,Ax as m2,NW as m3,oS as m4,sS as m5,Bg as m6,Xj as m7,lC as m8,iA as m9,lj as mA,cj as mB,CW as mC,hx as mD,_q as mE,hh as mF,UP as mG,xi as mH,kA as mI,AA as mJ,xA as mK,CA as mL,cp as mM,HL as mN,BX as mO,Wi as mP,fx as mQ,CB as mR,NA as mS,wx as mT,kf as mU,Sf as mV,Dr as mW,gN as mX,yN as mY,fN as mZ,Qb as m_,PA as ma,vx as mb,zY as mc,dT as md,OR as me,LV as mf,Ch as mg,Ah as mh,Nh as mi,eN as mj,tN as mk,MB as ml,il as mm,Xw as mn,jl as mo,fr as mp,sN as mq,yW as mr,Sj as ms,hW as mt,IW as mu,IV as mv,cee as mw,hee as mx,uee as my,dj as mz,FE as n,pj as n$,t_ as n0,TN as n1,_N as n2,BA as n3,SA as n4,GA as n5,Ss as n6,vee as n7,_x as n8,Ld as n9,YB as nA,FG as nB,YK as nC,KK as nD,$K as nE,CV as nF,kV as nG,wV as nH,RV as nI,WV as nJ,UV as nK,Xk as nL,Ad as nM,Pi as nN,UA as nO,TS as nP,XT as nQ,JI as nR,sK as nS,eK as nT,pK as nU,ZI as nV,ex as nW,tx as nX,ax as nY,ox as nZ,ux as n_,XI as na,bB as nb,_B as nc,VI as nd,wK as ne,tq as nf,EB as ng,qA as nh,TB as ni,w_ as nj,pN as nk,IN as nl,qI as nm,Ir as nn,NI as no,KI as np,Sn as nq,ix as nr,QI as ns,_S as nt,QB as nu,Qd as nv,qB as nw,Yn as nx,GB as ny,KB as nz,$E as o,_i as o$,F5 as o0,D5 as o1,A_ as o2,C_ as o3,e_ as o4,aB as o5,k_ as o6,SD as o7,uz as o8,qg as o9,Ak as oA,Nk as oB,Pk as oC,Xh as oD,x_ as oE,UK as oF,BK as oG,UI as oH,fB as oI,gW as oJ,ac as oK,hs as oL,PH as oM,gA as oN,Oi as oO,Di as oP,Mi as oQ,Fi as oR,Ui as oS,ks as oT,kl as oU,Ll as oV,Zd as oW,R_ as oX,L_ as oY,tg as oZ,yA as o_,tB as oa,Lj as ob,IL as oc,Zv as od,XB as oe,ew as of,Uc as og,Cr as oh,Wv as oi,Bv as oj,fw as ok,JW as ol,tV as om,uB as on,eV as oo,Rj as op,Pj as oq,bi as or,pV as os,mV as ot,_L as ou,SL as ov,TL as ow,nV as ox,rV as oy,iV as oz,oE as p,Tl as p$,N_ as p0,$b as p1,nx as p2,P_ as p3,Li as p4,Aw as p5,Nw as p6,Sw as p7,kw as p8,Lw as p9,PD as pA,BD as pB,VD as pC,Dm as pD,MD as pE,im as pF,Mm as pG,xm as pH,hC as pI,DC as pJ,ZV as pK,t$ as pL,i$ as pM,zte as pN,r$ as pO,qr as pP,aR as pQ,yae as pR,MR as pS,ul as pT,MG as pU,Xee as pV,If as pW,kx as pX,OD as pY,DD as pZ,$r as p_,_w as pa,ww as pb,Tw as pc,Ew as pd,vw as pe,xw as pf,Ri as pg,vV as ph,UO as pi,wA as pj,Ex as pk,iz as pl,S4 as pm,fh as pn,zL as po,oc as pp,d_ as pq,mC as pr,Uj as ps,Qu as pt,ek as pu,R5 as pv,Hm as pw,ND as px,Vm as py,nG as pz,Iu as q,O_ as q$,Sl as q0,P9 as q1,yT as q2,mG as q3,lV as q4,bD as q5,dG as q6,Wp as q7,cG as q8,lG as q9,_l as qA,bl as qB,q9 as qC,e8 as qD,Kg as qE,Z9 as qF,X9 as qG,_z as qH,kz as qI,vz as qJ,yz as qK,vl as qL,wl as qM,wz as qN,Iz as qO,Ez as qP,zd as qQ,Q3 as qR,G3 as qS,H3 as qT,z3 as qU,ss as qV,lz as qW,cs as qX,Gg as qY,ds as qZ,mz as q_,Mp as qa,LG as qb,bG as qc,Dp as qd,kp as qe,xG as qf,ah as qg,Pz as qh,Az as qi,Zp as qj,zX as qk,Fz as ql,Nz as qm,Xp as qn,Hp as qo,c_ as qp,KA as qq,cq as qr,cz as qs,Sz as qt,xz as qu,cc as qv,B3 as qw,fz as qx,dz as qy,z$ as qz,GE as r,Vg as r$,yk as r0,ej as r1,jV as r2,Ck as r3,Bk as r4,nC as r5,sr as r6,Zk as r7,yC as r8,Pd as r9,Ek as rA,nl as rB,AC as rC,kk as rD,ZC as rE,Hg as rF,bk as rG,G9 as rH,LC as rI,QC as rJ,AB as rK,Cd as rL,Iw as rM,kr as rN,hk as rO,Lh as rP,BL as rQ,UL as rR,Lb as rS,ij as rT,fk as rU,rT as rV,gz as rW,Ul as rX,Wg as rY,Hi as rZ,Gi as r_,xs as ra,Rf as rb,Ji as rc,Ik as rd,oC as re,eC as rf,fC as rg,PC as rh,xr as ri,Cx as rj,fn as rk,vn as rl,En as rm,vk as rn,cl as ro,wC as rp,KC as rq,GC as rr,ol as rs,YV as rt,KV as ru,YC as rv,RC as rw,VC as rx,es as ry,ts as rz,mde as s,N8 as s$,zi as s0,$i as s1,Yie as s2,mh as s3,RH as s4,ig as s5,pg as s6,Ac as s7,Oy as s8,Dy as s9,Ej as sA,wj as sB,_j as sC,ES as sD,yS as sE,bj as sF,vj as sG,gj as sH,fj as sI,dx as sJ,OC as sK,RT as sL,A7 as sM,_F as sN,OJ as sO,pw as sP,hw as sQ,gw as sR,yw as sS,rz as sT,Rw as sU,bx as sV,$h as sW,ns as sX,e7 as sY,a7 as sZ,Yg as s_,uH as sa,mH as sb,cH as sc,Wr as sd,Cc as se,cE as sf,ap as sg,Dc as sh,Oae as si,Q_ as sj,Ai as sk,kF as sl,oz as sm,NX as sn,iH as so,OL as sp,Cl as sq,ml as sr,ph as ss,fS as st,PV as su,rg as sv,JA as sw,zA as sx,FV as sy,yj as sz,hE as t,df as t$,t7 as t0,Qh as t1,Qz as t2,r0 as t3,O4 as t4,tR as t5,bu as t6,Rq as t7,Lq as t8,tae as t9,Nf as tA,Pf as tB,Hf as tC,cy as tD,Xr as tE,Af as tF,h9 as tG,ufe as tH,J_ as tI,Lg as tJ,Dg as tK,rs as tL,Vr as tM,j6 as tN,AF as tO,MP as tP,ov as tQ,tj as tR,is as tS,mfe as tT,jg as tU,gC as tV,Zee as tW,HK as tX,Er as tY,Dw as tZ,oT as t_,np as ta,Jne as tb,FA as tc,NL as td,DP as te,PP as tf,RP as tg,ny as th,_P as ti,Zh as tj,iR as tk,aV as tl,Xg as tm,Ww as tn,bR as to,TR as tp,_R as tq,Xf as tr,nu as ts,Vf as tt,ry as tu,HP as tv,soe as tw,Cf as tx,ER as ty,vR as tz,id as u,jQ as u0,zQ as u1,$3 as u2,K3 as u3,Y3 as u4,J3 as u5,W3 as u6,q3 as u7,Yue as u8,fae as u9,BH as uA,WH as uB,VH as uC,jH as uD,JB as uE,a_ as uF,GQ as ua,VQ as ub,FQ as uc,OQ as ud,DQ as ue,en as uf,nf as ug,BQ as uh,WQ as ui,MQ as uj,pR as uk,cd as ul,UQ as um,Eu as un,X3 as uo,QQ as up,DJ as uq,M4 as ur,ff as us,Ef as ut,yR as uu,hne as uv,si as uw,IH as ux,AH as uy,LH as uz,YE as v,lE as w,KE as x,Su as y,jE as z};
//# sourceMappingURL=index.95814bbb.js.map
